[{"title":"24251å¯’å‡","url":"/post/e4bd7c43.html","content":"<div class=\"hbe hbe-container\" id=\"hexo-blog-encrypt\" data-wpm=\"Oh, this is an invalid password. Check and try again, please.\" data-whm=\"OOPS, these decrypted content may changed, but you can still have a look.\">\n  <script id=\"hbeData\" type=\"hbeData\" data-hmacdigest=\"14008d64848da414d080e3b35befcf276b5591c31232813a49bc9f2c7259ee7c\">ff5bd91e40b47e4b70872304ecb021a0f48631c99d39f2c996a171dc89311f9ecdbcb5d6d267afa40933b80a1d6af52f64a2db48ba6f81fdfae537c44dd3f7987eca452b168a9ffafb85b2d1bd76297823ef2be11fd4db6700d1bc14f86fe29b4fffb4d2535fbd78afba4f9df7043593c41cbb14be4fa32758016c186f8c58beffeaba6df806164c97c50a510293e502b3e64774e1a19e4e01f84b004581e373f1be156d715696ca84b0d2255cf78db28c6d3cd95ed9659f2c9f8ff27bd64aae105d59434f7065bc59408ad307d1abd2ae1e19c3f11509f33c0ba9d63e92cd014c37969cee384e736b256329a19cea45cf0b9176fac7a4e135b684224aa989997b77858c8fc8e8547501470a17d5df66fc2a01c70f1450ad86bbe3fe730a3ccad70c39f8d7eb7e99fc8796c6ee02f4a9aa7c1674ba2cddbaa7787a7aa7791d8ec1cdfe473c007b4774dbadb713987663c9aa9e16a4f97304bc70fa9d5106f78f740c70ca73ea1a8114f90af4760f788a12c54505c8a4f1ba86a69289c45e9c048ab26d20a72afe7fbd4eb0514f079928c56d22d74a0bec66fd13cad555a5cbd2db3309e321a4435b5a026f5a7dbdc1fe8bcb3777f3a8d31ad6970d1b8e6ddb572c6c923b4f6118f6f2c7d1acc372723914dcc25dbb4c68acec1bffe03b286ff99a02ce45d0e25424f3877cd7d13e93ba0153669bd480204a16741fd53a66a6e55d68a7cf8d87e6044c632587623ab7da40523c17c95bd5597a2bac017011e849d05495fcee7581800626b13bed7c7644417658bc6e9e4a7259472342c7667154</script>\n  <div class=\"hbe hbe-content\">\n    <div class=\"hbe hbe-input hbe-input-default\">\n      <input class=\"hbe hbe-input-field hbe-input-field-default\" type=\"password\" id=\"hbePass\">\n      <label class=\"hbe hbe-input-label hbe-input-label-default\" for=\"hbePass\">\n        <span class=\"hbe hbe-input-label-content hbe-input-label-content-default\">Hey, password is required here.</span>\n      </label>\n    </div>\n  </div>\n</div>\n<script data-pjax src=\"/lib/hbe.js\"></script><link href=\"/css/hbe.style.css\" rel=\"stylesheet\" type=\"text/css\">","tags":["ç”Ÿæ´»"]},{"title":"AlexNet å›¾åƒåˆ†ç±»ï¼ˆPyTorchæ¡†æ¶ï¼‰","url":"/post/91cba6d6.html","content":"<h1><a href=\"https://www.cnblogs.com/xing9/p/18002038/AlexNet-PyTorch\" title=\"å‘å¸ƒäº 2024-02-03 14:16\">æ‰‹æ’¸ä»£ç ï¼šä»é›¶å¼€å§‹çš„ AlexNet å›¾åƒåˆ†ç±»ï¼ˆPyTorchæ¡†æ¶ï¼‰ </a></h1>\n<h2 id=\"æ‘˜è¦ï¼š\">æ‘˜è¦ï¼š</h2>\n<p>æœ¬æ–‡åœ¨ PyTorch æ¡†æ¶ä¸‹æ­å»ºäº† AlexNet ï¼Œå¹¶åœ¨ CIFAR10 ä¸Šå®Œæˆäº†å›¾ç‰‡åˆ†ç±»ã€‚åŒæ—¶ï¼Œæ›´æ­£äº†ä¸€äº›åŸè®ºæ–‡ä¸­çš„å°é”™è¯¯ï¼ˆå¦‚ï¼šè¾“å…¥å›¾åƒå°ºå¯¸ï¼‰ã€‚ç”±äº CIFAR10 æ²¡æœ‰éªŒè¯é›†ï¼Œæœ¬æ–‡å°†è®­ç»ƒé›†çš„ 10% å½“ä½œéªŒè¯é›†ã€‚</p>\n<p>å®Œæ•´ä»£ç å·²ä¸Šä¼ è‡³ GitHubï¼š<a href=\"https://github.com/TiezhuXing01/AlexNet_in_PyTorch\">https://github.com/TiezhuXing01/AlexNet_in_PyTorch</a></p>\n<hr>\n<h2 id=\"1-å¼•å…¥åº“\">1. å¼•å…¥åº“</h2>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> torch</span><br><span class=\"line\"><span class=\"keyword\">import</span> torch.nn <span class=\"keyword\">as</span> nn</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> torchvision <span class=\"keyword\">import</span> datasets</span><br><span class=\"line\"><span class=\"keyword\">from</span> torchvision <span class=\"keyword\">import</span> transforms</span><br><span class=\"line\"><span class=\"keyword\">from</span> torch.utils.data.sampler <span class=\"keyword\">import</span> SubsetRandomSampler</span><br></pre></td></tr></table></figure>\n<p><code>SubsetRandomSampler</code> æ˜¯ PyTorch ä¸­çš„ä¸€ä¸ªé‡‡æ ·å™¨ï¼ˆsamplerï¼‰ã€‚<br>\nå…·ä½“å¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« ï¼š<a href=\"https://www.cnblogs.com/xing9/articles/18004465/SubsetRandomSampler\">SubsetRandomSampler æ˜¯ä»€ä¹ˆï¼Ÿ</a></p>\n<hr>\n<h2 id=\"2-é€‰æ‹©è®¾å¤‡\">2. é€‰æ‹©è®¾å¤‡</h2>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">device = torch.device(<span class=\"string\">&#x27;cuda&#x27;</span> <span class=\"keyword\">if</span> torch.cuda.is_available() <span class=\"keyword\">else</span> <span class=\"string\">&#x27;cpu&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½ä¼šé€‰æ‹©åœ¨GPUä¸Šè®­ç»ƒç½‘ç»œæ¨¡å‹ï¼Œå› ä¸ºç¥ç»ç½‘ç»œçš„è®­ç»ƒéœ€è¦å¤§é‡çš„è®¡ç®—ï¼Œè€Œè‹±ä¼Ÿè¾¾çš„GPUæä¾›äº†CUDAï¼ˆä¸€ä¸ªåŠ é€Ÿè®¡ç®—åº“ï¼‰ã€‚ä½†å¦‚æœä½ çš„ç”µè„‘æ˜¾å¡æ˜¯AMDçš„ï¼Œé‚£ä¹ˆæœ‰å¾ˆå¤§æ¦‚ç‡ä¸æ”¯æŒä½¿ç”¨CUDAï¼Œæ­¤æ—¶åªèƒ½ç”¨CPUè®­ç»ƒã€‚ä½†åœ¨CPUä¸Šè®­ç»ƒæ¨¡å‹æ˜¯ååˆ†ç¼“æ…¢çš„ã€‚å¦‚æœä½ æš‚æ—¶æ²¡æ³•æ¢ç”µè„‘ï¼Œé‚£æˆ‘å»ºè®®ä½ å»ç§Ÿä¸€ä¸ªæœåŠ¡å™¨ã€‚æˆ–è€…ä½¿ç”¨é˜¿é‡Œäº‘ã€ç™¾åº¦é£æ¡¨ã€è°·æ­ŒColabç­‰å¹³å°ã€‚</p>\n<hr>\n<h2 id=\"3-åŠ è½½æ•°æ®é›†\">3. åŠ è½½æ•°æ®é›†</h2>\n<p>CIFAR-10 æ˜¯ä¸€ä¸ªç»å…¸çš„è®¡ç®—æœºè§†è§‰æ•°æ®é›†ï¼Œç”¨äºå›¾åƒåˆ†ç±»ä»»åŠ¡ã€‚å®ƒåŒ…å«äº†æ¥è‡ª 10 ä¸ªä¸åŒç±»åˆ«çš„ 60,000 å¼ å½©è‰²å›¾åƒï¼Œæ¯ä¸ªç±»åˆ«æœ‰ 6,000 å¼ å›¾åƒã€‚æ•°æ®é›†è¢«åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼Œå…¶ä¸­è®­ç»ƒé›†åŒ…å« 50,000 å¼ å›¾åƒï¼Œæµ‹è¯•é›†åŒ…å« 10,000 å¼ å›¾åƒã€‚æœ¬æ–‡æ‹¿å‡ºè®­ç»ƒé›†çš„ 10% ä½œä¸ºéªŒè¯é›†ã€‚</p>\n<h3 id=\"3-1-å®šä¹‰è·å–è®­ç»ƒé›†å’ŒéªŒè¯é›†çš„æ•°æ®åŠ è½½å™¨\">3.1 å®šä¹‰è·å–è®­ç»ƒé›†å’ŒéªŒè¯é›†çš„æ•°æ®åŠ è½½å™¨</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">get_train_val_loader</span>(<span class=\"params\">data_dir, batch_size, augment,</span></span><br><span class=\"line\"><span class=\"params\">                         random_seed, valid_size = <span class=\"number\">0.1</span>, shuffle = <span class=\"literal\">True</span></span>):</span><br><span class=\"line\"> </span><br><span class=\"line\">  <span class=\"comment\"># ------------- è®¾ç½®å›¾åƒå˜æ¢ ------------- #</span></span><br><span class=\"line\">  <span class=\"comment\"># (1) å½’ä¸€åŒ–</span></span><br><span class=\"line\">  normalize = transforms.Normalize(mean = [<span class=\"number\">0.4914</span>, <span class=\"number\">0.4822</span>, <span class=\"number\">0.4465</span>],</span><br><span class=\"line\">                                   std = [<span class=\"number\">0.2023</span>, <span class=\"number\">0.1994</span>, <span class=\"number\">0.2010</span>])</span><br><span class=\"line\">  <span class=\"comment\"># (2) éªŒè¯é›†å›¾åƒå˜æ¢</span></span><br><span class=\"line\">  val_transform = transforms.Compose([transforms.Resize(<span class=\"number\">227</span>),</span><br><span class=\"line\">                                   transforms.ToTensor(),</span><br><span class=\"line\">                                   normalize])</span><br><span class=\"line\">  <span class=\"comment\"># (3) è®­ç»ƒé›†æ˜¯å¦æ•°æ®å¢å¼º</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> augment:</span><br><span class=\"line\">    train_transform = transforms.Compose([transforms.RandomHorizontalFlip(),</span><br><span class=\"line\">                                      transforms.Resize(<span class=\"number\">227</span>),</span><br><span class=\"line\">                                      transforms.ToTensor(),</span><br><span class=\"line\">                                      normalize])</span><br><span class=\"line\">  <span class=\"keyword\">else</span>:</span><br><span class=\"line\">    train_transform = transforms.Compose([transforms.Resize(<span class=\"number\">227</span>),</span><br><span class=\"line\">                                       transforms.ToTensor(),</span><br><span class=\"line\">                                       normalize])</span><br><span class=\"line\">  <span class=\"comment\"># ---------- ğŸ‘† æ•°æ®å˜æ¢è®¾ç½®å®Œæ¯• -------------- #</span></span><br><span class=\"line\"> </span><br><span class=\"line\">  <span class=\"comment\"># ä¸‹è½½å¹¶åŠ è½½è®­ç»ƒé›†</span></span><br><span class=\"line\">  train_dataset = datasets.CIFAR10(root = data_dir,</span><br><span class=\"line\">                                  train = <span class=\"literal\">True</span>,</span><br><span class=\"line\">                                  download = <span class=\"literal\">True</span>,</span><br><span class=\"line\">                                  transform = train_transform)</span><br><span class=\"line\">  val_dataset = datasets.CIFAR10(root = data_dir,</span><br><span class=\"line\">                                  train = <span class=\"literal\">True</span>,</span><br><span class=\"line\">                                  download = <span class=\"literal\">True</span>,</span><br><span class=\"line\">                                  transform = val_transform)</span><br><span class=\"line\"> </span><br><span class=\"line\">  <span class=\"comment\"># ---------- åˆ’åˆ†éªŒè¯é›†å’Œè®­ç»ƒé›† ----------  #</span></span><br><span class=\"line\">  <span class=\"comment\"># (1) è®¡ç®—è®­ç»ƒé›†å›¾ç‰‡æ•°é‡</span></span><br><span class=\"line\">  num_train = <span class=\"built_in\">len</span>(train_dataset)</span><br><span class=\"line\">  <span class=\"comment\"># (2) è®¡ç®—éªŒè¯é›†æ•°é‡ï¼Œå¹¶å‘ä¸‹å–æ•´</span></span><br><span class=\"line\">  num_val = np.floor(valid_size * num_train)</span><br><span class=\"line\">  <span class=\"comment\"># (3) è®¾ç½®è®­ç»ƒé›†å’ŒéªŒè¯é›†çš„åˆ’åˆ†ç•Œé™</span></span><br><span class=\"line\">  split = <span class=\"built_in\">int</span>(num_val)</span><br><span class=\"line\">  <span class=\"comment\"># (4) ç”Ÿæˆä¸€ä¸ªåˆ—è¡¨ç´¢å¼•ï¼Œå…¶å†…å®¹ä¸º 0 ~ (num_train - 1) çš„å…¨éƒ¨æ•´æ•°</span></span><br><span class=\"line\">  indices = <span class=\"built_in\">list</span>(<span class=\"built_in\">range</span>(num_train))    <span class=\"comment\"># ä¸ºæ•°æ®&quot;æ´—ç‰Œ&quot;åšå‡†å¤‡</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> shuffle:</span><br><span class=\"line\">    np.random.seed(random_seed) <span class=\"comment\"># æ ¹æ®ç§å­ç”Ÿæˆéšæœºæ•°</span></span><br><span class=\"line\">    np.random.shuffle(indices)  <span class=\"comment\"># æ ¹æ®éšæœºæ•°æ‰“ä¹±å›¾ç‰‡</span></span><br><span class=\"line\">  <span class=\"comment\"># (5) åˆ’åˆ†éªŒè¯é›†å’Œè®­ç»ƒé›†(æ ¹æ®ç´¢å¼•åˆ—è¡¨ indices å’Œåˆ’åˆ†ç•Œé™ split åˆ’åˆ†)</span></span><br><span class=\"line\">  val_idx = indices[:split]     <span class=\"comment\"># éªŒè¯é›†ç´¢å¼•åˆ—åˆ«</span></span><br><span class=\"line\">  train_idx = indices[split:]   <span class=\"comment\"># è®­ç»ƒé›†ç´¢å¼•åˆ—è¡¨</span></span><br><span class=\"line\">  <span class=\"comment\"># (6) æ ¹æ®éªŒè¯é›†å’Œè®­ç»ƒé›†çš„ç´¢å¼•åˆ—è¡¨é‡‡æ ·æ•°æ®</span></span><br><span class=\"line\">  train_sampler = SubsetRandomSampler(train_idx)</span><br><span class=\"line\">  val_sampler = SubsetRandomSampler(val_idx)</span><br><span class=\"line\">  <span class=\"comment\"># ---------- ğŸ‘† è®­ç»ƒé›†å’ŒéªŒè¯é›†åˆ’åˆ†å®Œæ¯• ---------- #</span></span><br><span class=\"line\"> </span><br><span class=\"line\">  <span class=\"comment\"># è®¾ç½®æ•°æ®åŠ è½½å™¨</span></span><br><span class=\"line\">  train_loader = torch.utils.data.DataLoader(train_dataset,</span><br><span class=\"line\">                                             batch_size = batch_size,</span><br><span class=\"line\">                                             sampler = train_sampler)</span><br><span class=\"line\">  val_loader = torch.utils.data.DataLoader(val_dataset,</span><br><span class=\"line\">                                           batch_size = batch_size,</span><br><span class=\"line\">                                           sampler = val_sampler)</span><br><span class=\"line\"> </span><br><span class=\"line\">  <span class=\"keyword\">return</span> (train_loader, val_loader)</span><br></pre></td></tr></table></figure>\n<hr>\n<h3 id=\"3-2-å®šä¹‰è·å–æµ‹è¯•é›†çš„æ•°æ®åŠ è½½å™¨\">3.2 å®šä¹‰è·å–æµ‹è¯•é›†çš„æ•°æ®åŠ è½½å™¨</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">get_test_loader</span>(<span class=\"params\">data_dir, batch_size, shuffle = <span class=\"literal\">True</span></span>):</span><br><span class=\"line\"> </span><br><span class=\"line\">  <span class=\"comment\"># ------------- è®¾ç½®å›¾åƒå˜æ¢ ------------- #</span></span><br><span class=\"line\">  <span class=\"comment\"># å½’ä¸€åŒ–</span></span><br><span class=\"line\">  normalize = transforms.Normalize(mean=[<span class=\"number\">0.485</span>, <span class=\"number\">0.456</span>, <span class=\"number\">0.406</span>],</span><br><span class=\"line\">                                  std=[<span class=\"number\">0.229</span>, <span class=\"number\">0.224</span>, <span class=\"number\">0.225</span>],)</span><br><span class=\"line\">  <span class=\"comment\"># å›¾åƒå˜æ¢</span></span><br><span class=\"line\">  test_transform = transforms.Compose([transforms.Resize(<span class=\"number\">227</span>),</span><br><span class=\"line\">                                transforms.ToTensor(),</span><br><span class=\"line\">                                normalize])</span><br><span class=\"line\"> </span><br><span class=\"line\">  <span class=\"comment\"># ä¸‹è½½å¹¶åŠ è½½æµ‹è¯•é›†</span></span><br><span class=\"line\">  test_dataset = datasets.CIFAR10(root = data_dir,</span><br><span class=\"line\">                                  train = <span class=\"literal\">False</span>,</span><br><span class=\"line\">                                  download = <span class=\"literal\">True</span>,</span><br><span class=\"line\">                                  transform = test_transform)</span><br><span class=\"line\"> </span><br><span class=\"line\">  <span class=\"comment\"># åŠ è½½æµ‹è¯•æ•°æ®</span></span><br><span class=\"line\">  test_loader = torch.utils.data.DataLoader(test_dataset,</span><br><span class=\"line\">                                            batch_size = batch_size,</span><br><span class=\"line\">                                            shuffle = shuffle)</span><br><span class=\"line\"> </span><br><span class=\"line\">  <span class=\"keyword\">return</span> test_loader</span><br></pre></td></tr></table></figure>\n<hr>\n<h3 id=\"3-3-è°ƒç”¨å‡½æ•°ï¼ŒåŠ è½½æ•°æ®\">3.3 è°ƒç”¨å‡½æ•°ï¼ŒåŠ è½½æ•°æ®</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># è®¾ç½®æ•°æ®é›†ä¸‹è½½è·¯å¾„</span></span><br><span class=\"line\">data_dir = <span class=\"string\">&quot;./data&quot;</span></span><br><span class=\"line\"><span class=\"comment\"># è®¾ç½®æ‰¹å°ºå¯¸</span></span><br><span class=\"line\">batch_size = <span class=\"number\">64</span></span><br><span class=\"line\"><span class=\"comment\"># è°ƒç”¨è®­ç»ƒé›†å’ŒéªŒè¯é›†çš„ DataLoader</span></span><br><span class=\"line\">train_loader, val_loader = get_train_val_loader(data_dir = data_dir,</span><br><span class=\"line\">                                                batch_size = batch_size,</span><br><span class=\"line\">                                                augment = <span class=\"literal\">True</span>,</span><br><span class=\"line\">                                                random_seed = <span class=\"number\">1</span>)</span><br><span class=\"line\"><span class=\"comment\"># è°ƒç”¨æµ‹è¯•é›†çš„ DataLoader</span></span><br><span class=\"line\">test_loader = get_test_loader(data_dir = data_dir,</span><br><span class=\"line\">                              batch_size = batch_size,</span><br><span class=\"line\">                              shuffle = <span class=\"literal\">False</span>)</span><br></pre></td></tr></table></figure>\n<hr>\n<h2 id=\"4-è®¤è¯†ç½‘ç»œ\">4. è®¤è¯†ç½‘ç»œ</h2>\n<p><img src=\"https://s2.loli.net/2024/12/26/6yosugXcIEOVGFl.png\" alt=\"AlexNet ç»“æ„å›¾\"></p>\n<p>AlexNet æ˜¯å·ç§¯ç¥ç»ç½‘ç»œçš„å¥ åŸºä¹‹ä½œï¼Œå‘è¡¨æ—¶é—´è¾ƒæ—©ï¼Œæ‰€ä»¥ä»Šå¤©çœ‹æ¥æœ‰ä¸€äº›é”™è¯¯æˆ–è€…å±€é™æ€§ï¼š</p>\n<p>(1) åœ¨2012å¹´ AlexNet è¢«æå‡ºæ—¶ï¼ŒGPU çš„ç®—åŠ›ç›¸å¯¹ä»Šå¤©æ¥è¯´éå¸¸å°ã€‚ä¸ºäº†è®­ç»ƒè¿™ä¸ªç½‘ç»œï¼Œä»–ä»¬æŠŠ AlexNet <strong>ä»ä¸­é—´åˆ‡å¼€</strong>ï¼Œä½¿ç”¨å¤š GPU è®­ç»ƒï¼Œåˆ†åˆ«åœ¨ 2 å— GTX 580 3G ä¸ŠèŠ±äº†äº”ã€å…­å¤©æ—¶é—´ã€‚</p>\n<p>(2) è¿™ç§åˆ‡å‰²åªæ˜¯ä¸€ç§<strong>æŠ€æœ¯ç»†èŠ‚</strong>ï¼Œä»¥åå‡ å¹´çš„æ¨¡å‹å¤§å¤šéƒ½ä¸ä¼šè¿™ä¹ˆåˆ‡å‰²ï¼Œå¤š GPU è®­ç»ƒä¹Ÿä¸æ˜¯é€šè¿‡åˆ‡å‰²æ¨¡å‹æ¥å®ç°ã€‚æ‰€ä»¥æœ¬æ–‡çš„ä»£ç å¹¶<strong>æ²¡æœ‰åˆ‡å‰²</strong>ç½‘ç»œï¼Œä¹Ÿæ²¡æœ‰ç”¨åˆ°å¤š GPU è®­ç»ƒã€‚</p>\n<p>(3) è®ºæ–‡ä¸­å†™åˆ°ï¼Œè¾“å…¥å›¾ç‰‡çš„å°ºå¯¸æ˜¯ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>24</mn><mo>âˆ—</mo><mn>24</mn><mo>âˆ—</mo><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">24*24*3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">24</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">24</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span></span></span></span> ï¼Œå³ 3 ä¸ªé€šé“çš„ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>24</mn><mo>âˆ—</mo><mn>24</mn></mrow><annotation encoding=\"application/x-tex\">24*24</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">24</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">24</span></span></span></span> å›¾ç‰‡ã€‚ä½†äº‹å®ä¸Šï¼Œè¿™æ˜¯ä½œè€…çš„å°é”™è¯¯ã€‚æ­£ç¡®å°ºå¯¸åº”ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>27</mn><mo>âˆ—</mo><mn>27</mn><mo>âˆ—</mo><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">27*27*3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">27</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">27</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span></span></span></span> .</p>\n<p>å¦‚æœæŒ‰ç…§è®ºæ–‡è¯´çš„è¾“å…¥å°ºå¯¸åšï¼Œä¼šå‡ºç°é”™è¯¯ã€‚å¯ä»¥æ¥ç®—ä¸€ä¸‹ï¼Œ å·ç§¯è¾“å‡ºå°ºå¯¸å…¬å¼ä¸ºï¼š<br>\n<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>o</mi><mi>u</mi><mi>t</mi><mi>p</mi><mi>u</mi><mi>t</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo>=</mo><mfrac><mrow><mi>i</mi><mi>n</mi><mi>p</mi><mi>u</mi><mi>t</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo>âˆ’</mo><mi>k</mi><mi>e</mi><mi>r</mi><mi>n</mi><mi>e</mi><mi>l</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo>+</mo><mn>2</mn><mo>âˆ—</mo><mi>p</mi><mi>a</mi><mi>d</mi><mi>d</mi><mi>i</mi><mi>n</mi><mi>g</mi></mrow><mrow><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>d</mi><mi>e</mi></mrow></mfrac><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">output size=\\frac{input size-kernel size+2*padding}{stride}+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">tp</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">ze</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2772em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9322em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\">e</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.4461em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">in</span><span class=\"mord mathnormal mtight\">p</span><span class=\"mord mathnormal mtight\">u</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">ze</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">er</span><span class=\"mord mathnormal mtight\">n</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">ze</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">2</span><span class=\"mbin mtight\">âˆ—</span><span class=\"mord mathnormal mtight\">p</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">dd</span><span class=\"mord mathnormal mtight\">in</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">g</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span><br>\nç¬¬ä¸€æ¬¡å·ç§¯åï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>o</mi><mi>u</mi><mi>t</mi><mi>p</mi><mi>u</mi><mi>t</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo>=</mo><mfrac><mrow><mn>224</mn><mo>âˆ’</mo><mn>11</mn><mo>+</mo><mn>2</mn><mo>âˆ—</mo><mn>0</mn></mrow><mn>4</mn></mfrac><mo>+</mo><mn>1</mn><mo>=</mo><mn>54.25</mn></mrow><annotation encoding=\"application/x-tex\">output size=\\frac{224-11+2*0}{4}+1=54.25</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">tp</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">ze</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">4</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">224</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">11</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">2</span><span class=\"mbin mtight\">âˆ—</span><span class=\"mord mtight\">0</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">54.25</span></span></span></span> å‡ºç°å°æ•°äº†ã€‚</p>\n<hr>\n<p>åœ¨ä¸€å— GPU ä¸Šè®­ç»ƒçš„æ­£ç¡® AlexNet ç»“æ„åŠå…¶è¾“å…¥è¾“å‡ºå°ºå¯¸åº”ä¸ºä¸‹è¡¨ã€‚</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n<th></th>\n<th></th>\n<th></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>æ“ä½œ</strong><br><strong>åç§°</strong></td>\n<td><strong>è¾“å…¥</strong><br><strong>é€šé“</strong></td>\n<td><strong>è¾“å‡º</strong><br><strong>é€šé“</strong></td>\n<td><strong>æ ¸å°ºå¯¸</strong></td>\n<td><strong>æ­¥å¹…</strong></td>\n<td><strong>å¡«å……</strong></td>\n<td><strong>è¾“å‡ºå°ºå¯¸</strong><br><strong>è¾“å…¥: 227Ã—227Ã—3</strong></td>\n</tr>\n<tr>\n<td>conv1</td>\n<td>3</td>\n<td>96</td>\n<td>11Ã—11</td>\n<td>4</td>\n<td>0</td>\n<td>55Ã—55Ã—96</td>\n</tr>\n<tr>\n<td>pool</td>\n<td></td>\n<td></td>\n<td>3 Ã— 3</td>\n<td>2</td>\n<td></td>\n<td>27Ã—27Ã—96</td>\n</tr>\n<tr>\n<td>conv2</td>\n<td>96</td>\n<td>256</td>\n<td>5 Ã— 5</td>\n<td>1</td>\n<td>2</td>\n<td>27Ã—27Ã—256</td>\n</tr>\n<tr>\n<td>pool</td>\n<td></td>\n<td></td>\n<td>3 Ã— 3</td>\n<td>2</td>\n<td></td>\n<td>13Ã—13Ã—256</td>\n</tr>\n<tr>\n<td>conv3</td>\n<td>256</td>\n<td>384</td>\n<td>3 Ã— 3</td>\n<td>1</td>\n<td>1</td>\n<td>13Ã—13Ã—384</td>\n</tr>\n<tr>\n<td>conv4</td>\n<td>384</td>\n<td>384</td>\n<td>3 Ã— 3</td>\n<td>1</td>\n<td>1</td>\n<td>13Ã—13Ã—384</td>\n</tr>\n<tr>\n<td>conv5</td>\n<td>384</td>\n<td>256</td>\n<td>3 Ã— 3</td>\n<td>1</td>\n<td>1</td>\n<td>13Ã—13Ã—256</td>\n</tr>\n<tr>\n<td>pool</td>\n<td></td>\n<td></td>\n<td>3 Ã— 3</td>\n<td>2</td>\n<td></td>\n<td>6Ã—6Ã—256</td>\n</tr>\n<tr>\n<td>fc1</td>\n<td></td>\n<td></td>\n<td></td>\n<td></td>\n<td></td>\n<td>9216</td>\n</tr>\n<tr>\n<td>fc2</td>\n<td></td>\n<td></td>\n<td></td>\n<td></td>\n<td></td>\n<td>4096</td>\n</tr>\n<tr>\n<td>fc3</td>\n<td></td>\n<td></td>\n<td></td>\n<td></td>\n<td></td>\n<td>num_classes(=10)</td>\n</tr>\n</tbody>\n</table>\n<hr>\n<h2 id=\"5-æ­å»ºç½‘ç»œ\">5. æ­å»ºç½‘ç»œ</h2>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">AlexNet</span>(nn.Module):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, num_classes=<span class=\"number\">10</span></span>):</span><br><span class=\"line\">        <span class=\"built_in\">super</span>(AlexNet, <span class=\"variable language_\">self</span>).__init__()</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.conv_block1 = nn.Sequential(</span><br><span class=\"line\">                        nn.Conv2d(<span class=\"number\">3</span>, <span class=\"number\">96</span>, kernel_size=<span class=\"number\">11</span>, stride=<span class=\"number\">4</span>, padding=<span class=\"number\">0</span>),</span><br><span class=\"line\">                        nn.BatchNorm2d(<span class=\"number\">96</span>),</span><br><span class=\"line\">                        nn.ReLU()</span><br><span class=\"line\">                        )</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.conv_block2 = nn.Sequential(</span><br><span class=\"line\">                        nn.Conv2d(<span class=\"number\">96</span>, <span class=\"number\">256</span>, kernel_size=<span class=\"number\">5</span>, stride=<span class=\"number\">1</span>, padding=<span class=\"number\">2</span>),</span><br><span class=\"line\">                        nn.BatchNorm2d(<span class=\"number\">256</span>),</span><br><span class=\"line\">                        nn.ReLU()</span><br><span class=\"line\">                        )</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.conv_block3 = nn.Sequential(</span><br><span class=\"line\">                        nn.Conv2d(<span class=\"number\">256</span>, <span class=\"number\">384</span>, kernel_size=<span class=\"number\">3</span>, stride=<span class=\"number\">1</span>, padding=<span class=\"number\">1</span>),</span><br><span class=\"line\">                        nn.BatchNorm2d(<span class=\"number\">384</span>),</span><br><span class=\"line\">                        nn.ReLU()</span><br><span class=\"line\">                        )</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.conv_block4 = nn.Sequential(</span><br><span class=\"line\">                        nn.Conv2d(<span class=\"number\">384</span>, <span class=\"number\">384</span>, kernel_size=<span class=\"number\">3</span>, stride=<span class=\"number\">1</span>, padding=<span class=\"number\">1</span>),</span><br><span class=\"line\">                        nn.BatchNorm2d(<span class=\"number\">384</span>),</span><br><span class=\"line\">                        nn.ReLU()</span><br><span class=\"line\">                        )</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.conv_block5 = nn.Sequential(</span><br><span class=\"line\">                        nn.Conv2d(<span class=\"number\">384</span>, <span class=\"number\">256</span>, kernel_size=<span class=\"number\">3</span>, stride=<span class=\"number\">1</span>, padding=<span class=\"number\">1</span>),</span><br><span class=\"line\">                        nn.BatchNorm2d(<span class=\"number\">256</span>),</span><br><span class=\"line\">                        nn.ReLU()</span><br><span class=\"line\">                        )</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.pool = nn.MaxPool2d(kernel_size = <span class=\"number\">3</span>, stride = <span class=\"number\">2</span>)</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.fc1 = nn.Sequential(nn.Dropout(<span class=\"number\">0.5</span>),nn.Linear(<span class=\"number\">9216</span>, <span class=\"number\">4096</span>),nn.ReLU())</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.fc2 = nn.Sequential(nn.Dropout(<span class=\"number\">0.5</span>),nn.Linear(<span class=\"number\">4096</span>, <span class=\"number\">4096</span>),nn.ReLU())</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.fc3 = nn.Sequential(nn.Linear(<span class=\"number\">4096</span>, num_classes))</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">forward</span>(<span class=\"params\">self, x</span>):</span><br><span class=\"line\">        out = <span class=\"variable language_\">self</span>.conv_block1(x)</span><br><span class=\"line\">        out = <span class=\"variable language_\">self</span>.pool(out)</span><br><span class=\"line\">        out = <span class=\"variable language_\">self</span>.conv_block2(out)</span><br><span class=\"line\">        out = <span class=\"variable language_\">self</span>.pool(out)</span><br><span class=\"line\">        out = <span class=\"variable language_\">self</span>.conv_block3(out)</span><br><span class=\"line\">        out = <span class=\"variable language_\">self</span>.conv_block4(out)</span><br><span class=\"line\">        out = <span class=\"variable language_\">self</span>.conv_block5(out)</span><br><span class=\"line\">        out = <span class=\"variable language_\">self</span>.pool(out)</span><br><span class=\"line\">        out = out.reshape(out.size(<span class=\"number\">0</span>), -<span class=\"number\">1</span>)</span><br><span class=\"line\">        out = <span class=\"variable language_\">self</span>.fc1(out)</span><br><span class=\"line\">        out = <span class=\"variable language_\">self</span>.fc2(out)</span><br><span class=\"line\">        out = <span class=\"variable language_\">self</span>.fc3(out)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> out</span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>Dropout</code>ï¼šè®©ä¸€éƒ¨åˆ†ç¥ç»å…ƒè¾“å‡ºä¸º0. ç›®å‰è®¤ä¸ºå®ƒæ˜¯ä¸€ä¸ªæ­£åˆ™é¡¹ï¼Œé˜²æ­¢è¿‡æ‹Ÿåˆã€‚ç”±äºç›®å‰å¾ˆå°‘ä½¿ç”¨å…¨è¿æ¥äº†ï¼Œæ‰€ä»¥<code>Dropout</code>ä¸æ˜¯é‚£ä¹ˆé‡è¦äº†ã€‚</li>\n</ul>\n<hr>\n<h2 id=\"6-è®¾ç½®è¶…å‚æ•°\">6. è®¾ç½®è¶…å‚æ•°</h2>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">num_classes = <span class=\"number\">10</span></span><br><span class=\"line\">epochs = <span class=\"number\">20</span></span><br><span class=\"line\">learning_rate = <span class=\"number\">0.005</span></span><br><span class=\"line\"> </span><br><span class=\"line\">model = AlexNet(num_classes).to(device)</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\"># è®¾ç½®æŸå¤±å‡½æ•°</span></span><br><span class=\"line\">cost = nn.CrossEntropyLoss()</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\"># è®¾ç½®ä¼˜åŒ–å™¨</span></span><br><span class=\"line\">optimizer = torch.optim.SGD(model.parameters(),     <span class=\"comment\"># SGD éšæœºæ¢¯åº¦ä¸‹é™</span></span><br><span class=\"line\">                            lr = learning_rate,</span><br><span class=\"line\">                            weight_decay = <span class=\"number\">0.005</span>,   <span class=\"comment\"># æ­£åˆ™åŒ–é¡¹çš„æƒé‡æ˜¯ 0.005</span></span><br><span class=\"line\">                            momentum = <span class=\"number\">0.9</span>)</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\"># ä¸€ä¸ª epoch è®­ç»ƒçš„æ€» step æ•°</span></span><br><span class=\"line\">train_step = <span class=\"built_in\">len</span>(train_loader)</span><br></pre></td></tr></table></figure>\n<ul>\n<li>\n<p><code>len(train_loader)</code>è¿”å›åŠ è½½å™¨ä¸­çš„æ‰¹æ¬¡æ•°é‡ã€‚<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><mrow><mn>5000</mn><mo>âˆ—</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo>âˆ’</mo><mn>0.1</mn><mo stretchy=\"false\">)</mo></mrow><mn>64</mn></mfrac><mo>=</mo><mn>703.125</mn></mrow><annotation encoding=\"application/x-tex\">\\frac{5000*(1-0.1)}{64}=703.125</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.355em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.01em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">64</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.485em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">5000</span><span class=\"mbin mtight\">âˆ—</span><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">1</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">0.1</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">703.125</span></span></span></span>ï¼Œç»“æœå‡ºç°å°æ•°ï¼Œå‘ä¸Šå–æ•´ä¸º704.</p>\n</li>\n<li>\n<p>éšæœºæ¢¯åº¦ä¸‹é™ï¼ˆSGDï¼‰ç°åœ¨æ˜¯æ·±åº¦å­¦ä¹ æœ€ä¸»æµçš„ä¼˜åŒ–ç®—æ³•ï¼Œå› ä¸ºå…¶å†…éƒ¨çš„å™ªå£°ä½¿æ¨¡å‹æœ‰æ›´å¥½çš„æ³›åŒ–èƒ½åŠ›ã€‚</p>\n</li>\n<li>\n<p><code>weight_decay</code>ï¼šæ˜¯ L2 çš„æ­£åˆ™é¡¹ã€‚</p>\n</li>\n<li>\n<p><strong>æ­£åˆ™åŒ–</strong>ï¼šåœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œæ­£åˆ™åŒ–æ˜¯ä¸€ç§ç”¨äº<strong>é˜²æ­¢è¿‡æ‹Ÿåˆ</strong>çš„æŠ€æœ¯ã€‚é™åˆ¶æ¨¡å‹çš„å¤æ‚æ€§ï¼Œé˜²æ­¢æ¨¡å‹å¯¹è®­ç»ƒæ•°æ®ä¸­çš„å™ªå£°è¿‡äºæ•æ„Ÿï¼Œä»è€Œæé«˜å…¶åœ¨æœªçŸ¥æ•°æ®ä¸Šçš„æ³›åŒ–èƒ½åŠ›ã€‚åœ¨ AlexNet æå‡ºé‚£å¹´ï¼ˆ2012ï¼‰ï¼Œäººä»¬æ™®éè®¤ä¸ºæ­£åˆ™åŒ–å¯¹è§£å†³æ¨¡å‹è¿‡æ‹Ÿåˆé—®é¢˜æ˜¯å¾ˆé‡è¦çš„ã€‚ä½†åœ¨åæœŸï¼Œè¿™ä¸ªè§‚ç‚¹è¢«æ¨ç¿»äº†ã€‚å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œç½‘ç»œçš„<strong>è®¾è®¡</strong>å¯¹é˜²æ­¢è¿‡æ‹Ÿåˆæ›´é‡è¦çš„ã€‚</p>\n</li>\n<li>\n<p><code>momentum</code>ï¼šåŠ¨é‡æ˜¯ä¸€ç§ä¼˜åŒ–ç®—æ³•ä¸­å¸¸ç”¨çš„æŠ€æœ¯ï¼Œé€šå¸¸ä¸éšæœºæ¢¯åº¦ä¸‹é™ï¼ˆSGDï¼‰ç»“åˆä½¿ç”¨ï¼Œç”¨äºåŠ é€Ÿæ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ã€‚å®ƒçš„åŠŸèƒ½æ˜¯ <strong>é¿å…å› ä¸‹é™æ›²çº¿ä¸å¹³æ»‘è€Œè½å…¥å±€éƒ¨æœ€ä¼˜è§£ä¸­ã€‚</strong> åŠ¨é‡çš„å¼•å…¥ä¸»è¦æ˜¯ä¸ºäº†è§£å†³éšæœºæ¢¯åº¦ä¸‹é™çš„ä¸€äº›é—®é¢˜ï¼Œä¾‹å¦‚åœ¨æ¢¯åº¦æ›´æ–°ä¸­å­˜åœ¨çš„éœ‡è¡å’Œæ”¶æ•›é€Ÿåº¦æ…¢çš„é—®é¢˜ã€‚åŠ¨é‡ç®—æ³•å¼•å…¥äº†ä¸€ä¸ªæŒ‡æ•°è¡°å‡çš„ç´¯ç§¯å˜é‡ï¼Œç”¨æ¥æŒç»­è·Ÿè¸ªæ¢¯åº¦çš„å†å²ä¿¡æ¯ã€‚è¿™ä¸ªç´¯ç§¯å˜é‡å°±æ˜¯åŠ¨é‡ã€‚åŠ¨é‡åœ¨æ›´æ–°å‚æ•°æ—¶ä¸ä»…è€ƒè™‘å½“å‰æ¢¯åº¦ï¼Œè¿˜è€ƒè™‘äº†ä¹‹å‰æ¢¯åº¦çš„æ–¹å‘ã€‚è¿™æœ‰åŠ©äºå¹³æ»‘æ›´æ–°è¿‡ç¨‹ï¼Œå‡å°‘å‚æ•°æ›´æ–°çš„éœ‡è¡ï¼Œæé«˜æ¨¡å‹è®­ç»ƒçš„ç¨³å®šæ€§å’Œé€Ÿåº¦ã€‚</p>\n</li>\n</ul>\n<hr>\n<h2 id=\"7-è®­ç»ƒå’ŒéªŒè¯\">7. è®­ç»ƒå’ŒéªŒè¯</h2>\n<p>è®­ç»ƒéœ€è¦ 2 ä¸ªå¾ªç¯çš„åµŒå¥—ï¼šå¤–éƒ¨å¾ªç¯ç”¨äºå¾ªç¯ epoch ï¼›å†…éƒ¨å¾ªç¯ç”¨äºå¾ªç¯æ¯ä¸ª epoch ä¸­çš„æ¯ä¸ª batch çš„å›¾ç‰‡ï¼Œä¸€ä¸ª batch ä¸€æ­¥ï¼ˆstepï¼‰ã€‚</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> epoch <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(epochs):</span><br><span class=\"line\">  <span class=\"keyword\">for</span> i, (images, labels) <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(train_loader):</span><br><span class=\"line\">    images = images.to(device)</span><br><span class=\"line\">    labels = labels.to(device)</span><br><span class=\"line\"> </span><br><span class=\"line\">    outputs = model(images)</span><br><span class=\"line\">    loss = cost(outputs, labels)</span><br><span class=\"line\"> </span><br><span class=\"line\">    optimizer.zero_grad()</span><br><span class=\"line\">    loss.backward()</span><br><span class=\"line\">    optimizer.step()</span><br><span class=\"line\"> </span><br><span class=\"line\">  <span class=\"built_in\">print</span>(<span class=\"string\">&quot;Epoch [&#123;&#125;/&#123;&#125;], Step [&#123;&#125;/&#123;&#125;], Loss:&#123;:.4f&#125;&quot;</span>.<span class=\"built_in\">format</span>(</span><br><span class=\"line\">      epoch+<span class=\"number\">1</span>, epochs, i+<span class=\"number\">1</span>, train_step, loss.item()))   <span class=\"comment\"># lossæ˜¯å¼ é‡ï¼Œéœ€è¦.item()è½¬ä¸ºæµ®ç‚¹å‹</span></span><br><span class=\"line\"> </span><br><span class=\"line\">  <span class=\"comment\"># ä¸€ä¸ªepochå®Œæˆä¹‹åï¼Œè¿›å…¥éªŒè¯</span></span><br><span class=\"line\">  <span class=\"keyword\">with</span> torch.no_grad():</span><br><span class=\"line\">    correct = <span class=\"number\">0</span></span><br><span class=\"line\">    total = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> images, labels <span class=\"keyword\">in</span> val_loader:</span><br><span class=\"line\">      images = images.to(device)</span><br><span class=\"line\">      labels = labels.to(device)</span><br><span class=\"line\">      outputs = model(images)</span><br><span class=\"line\">      _, predicted = torch.<span class=\"built_in\">max</span>(outputs.data, <span class=\"number\">1</span>)</span><br><span class=\"line\">      total += labels.size(<span class=\"number\">0</span>)</span><br><span class=\"line\">      correct += (predicted == labels).<span class=\"built_in\">sum</span>().item()</span><br><span class=\"line\">      <span class=\"comment\"># del images, labels, outputs   # åˆ é™¤å˜é‡ä»¥é‡Šæ”¾å†…å­˜</span></span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"comment\"># è¾“å‡ºéªŒè¯ç»“æœ</span></span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;Accuracy on validation: &#123;&#125; %&quot;</span>.<span class=\"built_in\">format</span>(<span class=\"number\">100</span> * (correct / total)))</span><br></pre></td></tr></table></figure>\n<ul>\n<li>\n<p><strong>æ³¨æ„</strong>ï¼š<code>enumerate(train_loader)</code> è¿”å›çš„æ˜¯ <code>(index, (images, labels))</code> çš„å…ƒç»„ï¼Œæ‰€ä»¥<code>for i, images, labels in enumerate(train_loader):</code>æ˜¯é”™çš„ï¼Œåº”è¯¥ä¸º<code>for i, (images, labels) in enumerate(train_loader):</code>. ç›¸å…³æ–‡ç« ï¼š<a href=\"https://www.cnblogs.com/xing9/articles/18004447/enumerate\">enumerate(train_loader) è¿”å›ä»€ä¹ˆï¼Ÿ</a></p>\n</li>\n<li>\n<p><code>torch.max(outputs.data, 1)</code>è¿”å›æ¯ä¸€è¡Œçš„æœ€å¤§å€¼ä»¥åŠè¿™äº›æœ€å¤§å€¼æ‰€åœ¨çš„ç´¢å¼•ã€‚ç¬¬ä¸€ä¸ªè¿”å›å€¼ï¼ˆ<code>_</code>ï¼‰æ˜¯æœ€å¤§å€¼ï¼Œç¬¬äºŒä¸ªè¿”å›å€¼ï¼ˆ<code>predicted</code>ï¼‰æ˜¯æœ€å¤§å€¼çš„ç´¢å¼•ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªå…³å¿ƒç´¢å¼•ï¼Œå› ä¸ºå®ƒè¡¨ç¤ºäº†æ¨¡å‹çš„é¢„æµ‹ç±»åˆ«ã€‚</p>\n</li>\n<li>\n<p><code>labels.size(0)</code>è¿”å›çš„æ˜¯å½“å‰æ‰¹æ¬¡ä¸­æ ‡ç­¾çš„æ•°é‡ã€‚<a href=\"https://www.cnblogs.com/xing9/articles/18004411/labels_size\">å¦‚ä½•ç†è§£ labels.size(0)</a></p>\n</li>\n<li>\n<p><code>del images, labels, outputs</code> æ˜¯æ‰‹åŠ¨åˆ é™¤å˜é‡ä»¥é‡Šæ”¾å†…å­˜ã€‚åœ¨Pythonä¸­ï¼Œè¿™é€šå¸¸æ˜¯ä¸å¿…è¦çš„ï¼Œå› ä¸ºPythonçš„åƒåœ¾å›æ”¶å™¨ä¼šè‡ªåŠ¨å¤„ç†ä¸å†ä½¿ç”¨çš„å¯¹è±¡ã€‚</p>\n</li>\n<li>\n<p><code>for images, labels in val_loader:</code>ä¸éœ€è¦<code>numerate(val_loader)</code>æ˜¯å› ä¸ºéªŒè¯é˜¶æ®µä¸éœ€è¦ç´¢å¼•ï¼Œçœ‹çš„æ˜¯éªŒè¯é›†æ•´ä½“çš„å‡†ç¡®åº¦ã€‚</p>\n</li>\n</ul>\n<p>è®­ç»ƒç»“æœå¦‚ä¸‹å›¾ï¼š<br>\n<img src=\"https://s2.loli.net/2024/12/26/sT6eduMPiQboJXZ.png\" alt=\"\"></p>\n<hr>\n<h2 id=\"8-æµ‹è¯•\">8.æµ‹è¯•</h2>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">with</span> torch.no_grad():</span><br><span class=\"line\">  correct = <span class=\"number\">0</span></span><br><span class=\"line\">  total = <span class=\"number\">0</span></span><br><span class=\"line\">  <span class=\"keyword\">for</span> images, labels <span class=\"keyword\">in</span> test_loader:</span><br><span class=\"line\">    images = images.to(device)</span><br><span class=\"line\">    labels = labels.to(device)</span><br><span class=\"line\">    outputs = model(images)</span><br><span class=\"line\">    _, predicted = torch.<span class=\"built_in\">max</span>(outputs.data, <span class=\"number\">1</span>)</span><br><span class=\"line\">    total += labels.size(<span class=\"number\">0</span>)</span><br><span class=\"line\">    correct += (predicted == labels).<span class=\"built_in\">sum</span>().item()</span><br><span class=\"line\">    <span class=\"comment\"># del images, labels, outputs   # åˆ é™¤å˜é‡ä»¥é‡Šæ”¾å†…å­˜</span></span><br><span class=\"line\"> </span><br><span class=\"line\">  <span class=\"comment\"># è¾“å‡ºæµ‹è¯•ç»“æœ</span></span><br><span class=\"line\">  <span class=\"built_in\">print</span>(<span class=\"string\">&quot;Accuracy on test: &#123;&#125; %&quot;</span>.<span class=\"built_in\">format</span>(<span class=\"number\">100</span> * (correct / total)))</span><br></pre></td></tr></table></figure>\n<p>æµ‹è¯•ç»“æœå¦‚ä¸‹å›¾ï¼š<br>\n<img src=\"https://s2.loli.net/2024/12/26/Ut3OzesQmKc8wJI.png\" alt=\"\"></p>\n<hr>\n<p>ä»¥ä¸Šï¼Œå°±æ˜¯ AlexNet å®ç°å›¾åƒåˆ†ç±»çš„å…¨éƒ¨å†…å®¹ã€‚</p>\n","tags":["AlexNet","PyTorch"]},{"title":"Cè¯­è¨€æ‰‹å†™Httpdç½‘ç«™æœåŠ¡å™¨","url":"/post/c29c4a94.html","content":"<hr>\n<h2 id=\"æ‰§è¡ŒWEBæœåŠ¡å‰çš„å‡†å¤‡å·¥ä½œ\">æ‰§è¡ŒWEBæœåŠ¡å‰çš„å‡†å¤‡å·¥ä½œ</h2>\n<h3 id=\"åˆ›å»ºé¡¹ç›®\">åˆ›å»ºé¡¹ç›®</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// åˆå§‹åŒ–ç½‘ç»œå¹¶åˆ›å»ºæœåŠ¡ç«¯çš„å¥—æ¥å­—</span></span><br><span class=\"line\"><span class=\"type\">int</span> <span class=\"title function_\">startup</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">short</span>* port)</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">int</span> <span class=\"title function_\">main</span><span class=\"params\">(<span class=\"type\">void</span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//httpdé»˜è®¤çš„ç«¯å£æ˜¯80ï¼Œè¿™é‡ŒæŒ‡å®šäº†8000ç«¯å£ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å…¶å®ƒç«¯å£</span></span><br><span class=\"line\">    <span class=\"type\">unsigned</span> <span class=\"type\">short</span> port = <span class=\"number\">8000</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// åˆå§‹åŒ–ç½‘ç»œï¼Œå¹¶ä½¿ç”¨æŒ‡å®šç«¯å£æ¥åˆ›å»ºæœåŠ¡ç«¯çš„å¥—æ¥å­—</span></span><br><span class=\"line\">    <span class=\"type\">int</span> server_sock = startup(&amp;port);</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;httpd running on port %d\\n&quot;</span>, port);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"ç½‘ç»œé€šä¿¡åˆå§‹åŒ–\">ç½‘ç»œé€šä¿¡åˆå§‹åŒ–</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//ç½‘ç»œé€šä¿¡éœ€è¦åŒ…å«çš„å¤´æ–‡ä»¶ã€éœ€è¦åŠ è½½çš„åº“æ–‡ä»¶</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;winsock2.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">pragma</span> comment (lib, <span class=\"string\">&quot;WS2_32.lib&quot;</span>)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// åˆå§‹åŒ–ç½‘ç»œå¹¶åˆ›å»ºæœåŠ¡ç«¯çš„å¥—æ¥å­—</span></span><br><span class=\"line\"><span class=\"type\">int</span> <span class=\"title function_\">startup</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">short</span>* port)</span> &#123;</span><br><span class=\"line\">    WSADATA wsaData; <span class=\"comment\">// ç½‘ç»œé€šä¿¡ç›¸å…³çš„ç‰ˆæœ¬ç­‰ä¿¡æ¯</span></span><br><span class=\"line\">    <span class=\"type\">int</span> ret = WSAStartup( <span class=\"comment\">// WSAStartup ç½‘ç»œé€šä¿¡åˆå§‹åŒ–ï¼Œ</span></span><br><span class=\"line\">        MAKEWORD(<span class=\"number\">1</span>, <span class=\"number\">1</span>),   <span class=\"comment\">// æŒ‡å®šä½¿ç”¨Windows Socketsè§„èŒƒçš„1.1ç‰ˆæœ¬</span></span><br><span class=\"line\">        &amp;wsaData);        <span class=\"comment\">// å­˜å‚¨åˆå§‹åŒ–åçš„ç‰ˆæœ¬ç­‰ä¿¡æ¯ç»“æœ</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (ret) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"åˆ›å»ºå¥—æ¥å­—\">åˆ›å»ºå¥—æ¥å­—</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">error_die</span><span class=\"params\">(<span class=\"type\">const</span> <span class=\"type\">char</span>* sc)</span> &#123;</span><br><span class=\"line\">    perror(sc); <span class=\"comment\">//æ‰“å°é”™è¯¯åŸå› </span></span><br><span class=\"line\">    <span class=\"built_in\">exit</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// åˆå§‹åŒ–ç½‘ç»œå¹¶åˆ›å»ºæœåŠ¡ç«¯çš„å¥—æ¥å­—</span></span><br><span class=\"line\"><span class=\"type\">int</span> <span class=\"title function_\">startup</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">short</span>* port)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> server_socket = socket(PF_INET, <span class=\"comment\">//å¥—æ¥å­—çš„ç±»å‹ï¼ˆç½‘ç»œå¥—æ¥å­—ã€æ–‡ä»¶å¥—æ¥å­—ï¼Œæ­¤å¤„æ˜¯å‰è€…ï¼‰</span></span><br><span class=\"line\">        SOCK_STREAM,  <span class=\"comment\">//æ•°æ®åŒ…çš„ç±»å‹ï¼ˆæ•°æ®æµã€æ•°æ®æŠ¥ï¼Œæ­¤å¤„æ˜¯å‰è€…ï¼‰               </span></span><br><span class=\"line\">        IPPROTO_TCP); <span class=\"comment\">//å…·ä½“åè®®</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (server_socket == <span class=\"number\">-1</span>) &#123; <span class=\"comment\">//æ‰“å°é”™è¯¯æç¤ºï¼Œå¹¶ç»“æŸç¨‹åº</span></span><br><span class=\"line\">        error_die(<span class=\"string\">&quot;socket&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"è®¾ç½®å¥—æ¥å­—å±æ€§â€“ç«¯å£å¯å¤ç”¨\">è®¾ç½®å¥—æ¥å­—å±æ€§â€“ç«¯å£å¯å¤ç”¨</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// åˆå§‹åŒ–ç½‘ç»œå¹¶åˆ›å»ºæœåŠ¡ç«¯çš„å¥—æ¥å­—</span></span><br><span class=\"line\"><span class=\"type\">int</span> <span class=\"title function_\">startup</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">short</span>* port)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//è®¾ç½®ç«¯å£å¯å¤ç”¨ï¼ˆç«¯å£å¤ç”¨ï¼‰</span></span><br><span class=\"line\">    <span class=\"type\">int</span> opt = <span class=\"number\">1</span>;</span><br><span class=\"line\">    ret = setsockopt(server_socket, SOL_SOCKET, SO_REUSEADDR, (<span class=\"type\">const</span> <span class=\"type\">char</span>*)&amp;opt, <span class=\"keyword\">sizeof</span>(opt));</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (ret == <span class=\"number\">-1</span>) &#123;</span><br><span class=\"line\">        error_die(<span class=\"string\">&quot;setsockopt&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"ç»‘å®šå¥—æ¥å­—å’Œç½‘ç»œåœ°å€\">ç»‘å®šå¥—æ¥å­—å’Œç½‘ç»œåœ°å€</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">int</span> <span class=\"title function_\">startup</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">short</span>* port)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//é…ç½®æœåŠ¡å™¨çš„ç½‘ç»œåœ°å€</span></span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">sockaddr_in</span> <span class=\"title\">server_addr</span>;</span></span><br><span class=\"line\">    <span class=\"built_in\">memset</span>(&amp;server_addr, <span class=\"number\">0</span>, <span class=\"keyword\">sizeof</span>(server_addr));</span><br><span class=\"line\">    server_addr.sin_family = AF_INET;</span><br><span class=\"line\">    server_addr.sin_port = htons(*port);</span><br><span class=\"line\">    server_addr.sin_addr.s_addr = htonl(INADDR_ANY);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">//ç»‘å®šå¥—æ¥å­—</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (bind(server_socket, (<span class=\"keyword\">struct</span> sockaddr*)&amp;server_addr, <span class=\"keyword\">sizeof</span>(server_addr)) &lt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        error_die(<span class=\"string\">&quot;[bind]&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"è·å–åŠ¨æ€ç«¯å£\">è·å–åŠ¨æ€ç«¯å£</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">int</span> <span class=\"title function_\">startup</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">short</span>* port)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// åŠ¨æ€åˆ†é…ç«¯å£</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (*port == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> namelen = <span class=\"keyword\">sizeof</span>(server_addr);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (getsockname(server_socket, (<span class=\"keyword\">struct</span> sockaddr*)&amp;server_addr, &amp;namelen) &lt;<span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            error_die(<span class=\"string\">&quot;getsockname&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        *port = ntohs(server_addr.sin_port);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> server_socket;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"åˆ›å»ºç›‘å¬é˜Ÿåˆ—\">åˆ›å»ºç›‘å¬é˜Ÿåˆ—</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">int</span> <span class=\"title function_\">startup</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">short</span>* port)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//åˆ›å»ºç›‘å¬é˜Ÿåˆ—</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (listen(server_socket, <span class=\"number\">5</span>) &lt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        error_die(<span class=\"string\">&quot;listen&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> server_socket;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","tags":["c","æœåŠ¡å™¨"]},{"title":"Cè¯­è¨€æ‰‹å†™æ¤ç‰©å¤§æˆ˜åƒµå°¸","url":"/post/7d572acd.html","content":"<hr>\n<h2 id=\"Cè¯­è¨€æ‰‹å†™æ¤ç‰©å¤§æˆ˜åƒµå°¸\">Cè¯­è¨€æ‰‹å†™æ¤ç‰©å¤§æˆ˜åƒµå°¸</h2>\n<h3 id=\"åˆ›å»ºä¸»åœºæ™¯\">åˆ›å»ºä¸»åœºæ™¯</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;graphics.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> WIN_WIDTH 900</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> WIN_HEIGHT 600</span></span><br><span class=\"line\"></span><br><span class=\"line\">IMAGE imgBg;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//æ¸¸æˆåˆå§‹åŒ–</span></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">gameInit</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\tloadimage(&amp;imgBg, <span class=\"string\">&quot;res/bg.jpg&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">\tinitgraph(WIN_WIDTH, WIN_HEIGHT);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//æ›´æ–°çª—å£</span></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">updateWindow</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\tputimage(<span class=\"number\">0</span>, <span class=\"number\">0</span>, &amp;imgBg);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">int</span> <span class=\"title function_\">main</span><span class=\"params\">(<span class=\"type\">void</span>)</span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//æ¸¸æˆåˆå§‹åŒ–</span></span><br><span class=\"line\">\tgameInit();</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//æ›´æ–°çª—å£</span></span><br><span class=\"line\">\tupdateWindow();</span><br><span class=\"line\"></span><br><span class=\"line\">\tsystem(<span class=\"string\">&quot;pause&quot;</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"å®ç°æ¤ç‰©å¡ç‰Œ\">å®ç°æ¤ç‰©å¡ç‰Œ</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;tools.h&quot;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//#define ZHI_WU_CUNT 3</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">enum</span> &#123;</span> WAN_DOU, XIANG_RI_KUI, ZHI_WU_COUNT &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">IMAGE imgBar;</span><br><span class=\"line\">IMAGE imgCards[ZHI_WU_COUNT];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">gameInit</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\tloadimage(&amp;imgBar, <span class=\"string\">&quot;res/bar.png&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//åˆå§‹åŒ–æ¤ç‰©å¡ç‰Œ</span></span><br><span class=\"line\">\t<span class=\"type\">char</span> name[<span class=\"number\">64</span>];</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; ZHI_WU_COUNT; i++) &#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">//ç”Ÿæˆæ¤ç‰©å¡ç‰Œçš„æ–‡ä»¶å</span></span><br><span class=\"line\">\t\tsprintf_s(name, <span class=\"keyword\">sizeof</span>(name), <span class=\"string\">&quot;res/Cards/card_%d.png&quot;</span>, i + <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\tloadimage(&amp;imgCards[i], name);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">updateWindow</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//putimage(250, 0, &amp;imgBar); //æœ‰é»‘è¾¹</span></span><br><span class=\"line\">\tputimagePNG(<span class=\"number\">250</span>, <span class=\"number\">0</span>, &amp;imgBar);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; ZHI_WU_COUNT; i++) &#123;</span><br><span class=\"line\">\t\t<span class=\"type\">int</span> x = <span class=\"number\">338</span> + i * <span class=\"number\">65</span>;</span><br><span class=\"line\">\t\t<span class=\"type\">int</span> y = <span class=\"number\">6</span>;</span><br><span class=\"line\">\t\tputimage(x, y, &amp;imgCards[i]);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"å®ç°æ¤ç‰©çš„é€‰æ‹©å’Œæ‹–åŠ¨\">å®ç°æ¤ç‰©çš„é€‰æ‹©å’Œæ‹–åŠ¨</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\">IMAGE* imgZhiWu[ZHI_WU_COUNT][<span class=\"number\">20</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">int</span> curX, curY; <span class=\"comment\">//å½“å‰é€‰ä¸­çš„æ¤ç‰©ï¼Œåœ¨ç§»åŠ¨è¿‡ç¨‹ä¸­çš„ä½ç½®</span></span><br><span class=\"line\"><span class=\"type\">int</span> curZhiWu; <span class=\"comment\">//0:æ²¡æœ‰é€‰ä¸­ï¼Œ1:é€‰æ‹©äº†ç¬¬ä¸€ç§æ¤ç‰© etc.</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">bool</span> <span class=\"title function_\">fileExist</span><span class=\"params\">(<span class=\"type\">const</span> <span class=\"type\">char</span>* name)</span> &#123;</span><br><span class=\"line\">\tFILE* fp = fopen(name, <span class=\"string\">&quot;r&quot;</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (fp == <span class=\"literal\">NULL</span>) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\tfclose(fp);</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">gameInit</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\t<span class=\"built_in\">memset</span>(imgZhiWu, <span class=\"number\">0</span>, <span class=\"keyword\">sizeof</span>(imgZhiWu));</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//åˆå§‹åŒ–æ¤ç‰©å¡ç‰Œ</span></span><br><span class=\"line\">\t<span class=\"type\">char</span> name[<span class=\"number\">64</span>];</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; ZHI_WU_COUNT; i++) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt; <span class=\"number\">20</span>; j++) &#123;</span><br><span class=\"line\">\t\t\tsprintf_s(name, <span class=\"keyword\">sizeof</span>(name), <span class=\"string\">&quot;res/zhiwu/%d/%d.png&quot;</span>, i, j + <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t<span class=\"comment\">//å…ˆåˆ¤æ–­è¿™ä¸ªæ–‡ä»¶æ˜¯å¦å­˜åœ¨</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (fileExist(name)) &#123;</span><br><span class=\"line\">\t\t\t\timgZhiWu[i][j] = new IMAGE;</span><br><span class=\"line\">\t\t\t\tloadimage(imgZhiWu[i][j], name);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tcurZhiWu = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"comment\">//åˆ›å»ºæ¸¸æˆçš„å›¾å½¢çª—å£</span></span><br><span class=\"line\">\tinitgraph(WIN_WIDTH, WIN_HEIGHT, <span class=\"number\">1</span>); <span class=\"comment\">//åŠ ä¸€ä¸ªå‚æ•°1ï¼Œä¿ç•™åå°ç•Œé¢ï¼Œæ–¹ä¾¿è°ƒè¯•</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">updateWindow</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\tBeginBatchDraw(); <span class=\"comment\">//å¼€å§‹ç¼“å†²ï¼ˆå…ˆæ‰“å°åˆ°å†…å­˜ä¸­ï¼‰</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//æ¸²æŸ“ æ‹–åŠ¨è¿‡ç¨‹ä¸­çš„æ¤ç‰©</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (curZhiWu &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">\t\tIMAGE* img = imgZhiWu[curZhiWu - <span class=\"number\">1</span>][<span class=\"number\">0</span>];</span><br><span class=\"line\">\t\tputimagePNG(curX - img-&gt;getwidth() / <span class=\"number\">2</span>, curY - img-&gt;getheight() / <span class=\"number\">2</span>, img);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tEndBatchDraw(); <span class=\"comment\">//ç»“æŸåŒç¼“å†²ï¼ˆå†ä¸€æ¬¡æ€§æ‰“å°åˆ°çª—å£ï¼‰</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">userClick</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\tExMessage msg;</span><br><span class=\"line\">\t<span class=\"type\">static</span> <span class=\"type\">int</span> status = <span class=\"number\">0</span>;<span class=\"comment\">//çŠ¶æ€å˜é‡ï¼ˆå…ˆç‚¹å‡»å†æ‹–åŠ¨ï¼‰</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (peekmessage(&amp;msg)) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (msg.message == WM_LBUTTONDOWN) &#123; <span class=\"comment\">//å·¦å‡»æŒ‰ä¸‹</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (msg.x &gt; <span class=\"number\">338</span> &amp;&amp; msg.x &lt; <span class=\"number\">338</span> + <span class=\"number\">65</span> * ZHI_WU_COUNT &amp;&amp; msg.y &lt; <span class=\"number\">96</span>) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"type\">int</span> index = (msg.x - <span class=\"number\">338</span>) / <span class=\"number\">65</span>; <span class=\"comment\">//é€‰æ‹©å¡ç‰Œåºå·</span></span><br><span class=\"line\">\t\t\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d\\n&quot;</span>, index);</span><br><span class=\"line\">\t\t\t\tstatus = <span class=\"number\">1</span>; <span class=\"comment\">//å¯ä»¥æ‹–åŠ¨</span></span><br><span class=\"line\">\t\t\t\tcurZhiWu = index + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (msg.message == WM_MOUSEMOVE &amp;&amp; status == <span class=\"number\">1</span>) &#123; <span class=\"comment\">//é¼ æ ‡ç§»åŠ¨</span></span><br><span class=\"line\">\t\t\tcurX = msg.x;</span><br><span class=\"line\">\t\t\tcurY = msg.y;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (msg.message == WM_LBUTTONUP) &#123; <span class=\"comment\">//å·¦é”®æŠ¬èµ·</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"type\">int</span> main(<span class=\"type\">void</span>) &#123;</span><br><span class=\"line\">\tgameInit();</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">while</span> (<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">\t\tuserClick();</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tupdateWindow();</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tsystem(<span class=\"string\">&quot;pause&quot;</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"å®ç°æ¤ç‰©çš„ç§æ¤\">å®ç°æ¤ç‰©çš„ç§æ¤</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">zhiwu</span> &#123;</span></span><br><span class=\"line\">\t<span class=\"type\">int</span> type;\t\t<span class=\"comment\">//0:æ²¡æœ‰é€‰ä¸­ï¼Œ1:ç¬¬ä¸€ç§æ¤ç‰©\tetc.\t\t\t\t</span></span><br><span class=\"line\">\t<span class=\"type\">int</span> frameIndex; <span class=\"comment\">//åºåˆ—å¸§çš„åºå·</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">zhiwu</span> <span class=\"title\">map</span>[3][9];</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">gameInit</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\t<span class=\"built_in\">memset</span>(<span class=\"built_in\">map</span>, <span class=\"number\">0</span>, <span class=\"keyword\">sizeof</span>(<span class=\"built_in\">map</span>));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">updateWindow</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">3</span>; i++) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt; <span class=\"number\">9</span>; j++) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (<span class=\"built_in\">map</span>[i][j].type &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"type\">int</span> x = <span class=\"number\">256</span> + j * <span class=\"number\">81</span>;</span><br><span class=\"line\">\t\t\t\t<span class=\"type\">int</span> y = <span class=\"number\">179</span> + i * <span class=\"number\">102</span> + <span class=\"number\">14</span>;</span><br><span class=\"line\">\t\t\t\t<span class=\"type\">int</span> zhiWuType = <span class=\"built_in\">map</span>[i][j].type - <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\t\t<span class=\"type\">int</span> index = <span class=\"built_in\">map</span>[i][j].frameIndex;</span><br><span class=\"line\">\t\t\t\tputimagePNG(x, y, imgZhiWu[zhiWuType][index]);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">userClick</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (peekmessage(&amp;msg)) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (msg.message == WM_LBUTTONUP) &#123; <span class=\"comment\">//å·¦é”®æŠ¬èµ·</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (msg.x &gt; <span class=\"number\">256</span> &amp;&amp; msg.y &gt; <span class=\"number\">179</span> &amp;&amp; msg.y &lt; <span class=\"number\">489</span>) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"type\">int</span> row = (msg.y - <span class=\"number\">179</span>) / <span class=\"number\">102</span>;</span><br><span class=\"line\">\t\t\t\t<span class=\"type\">int</span> col = (msg.x - <span class=\"number\">256</span>) / <span class=\"number\">81</span>;</span><br><span class=\"line\">\t\t\t\t<span class=\"comment\">//printf(&quot;%d, %d\\n&quot;, row, col);</span></span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (<span class=\"built_in\">map</span>[row][col].type == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"built_in\">map</span>[row][col].type = curZhiWu;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"built_in\">map</span>[row][col].frameIndex = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\tcurZhiWu = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\tstatus = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"å®ç°æ¤ç‰©çš„æ‘‡æ‘†\">å®ç°æ¤ç‰©çš„æ‘‡æ‘†</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//æ›´æ–°æ¸¸æˆç›¸å…³æ•°æ®</span></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">updateGame</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">3</span>; i++) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt; <span class=\"number\">9</span>; j++) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (<span class=\"built_in\">map</span>[i][j].type &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"built_in\">map</span>[i][j].frameIndex++;</span><br><span class=\"line\">\t\t\t\t<span class=\"type\">int</span> zhiWuType = <span class=\"built_in\">map</span>[i][j].type - <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\t\t<span class=\"type\">int</span> index = <span class=\"built_in\">map</span>[i][j].frameIndex;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (imgZhiWu[zhiWuType][index] == <span class=\"literal\">NULL</span>) &#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"built_in\">map</span>[i][j].frameIndex = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">int</span> <span class=\"title function_\">main</span><span class=\"params\">(<span class=\"type\">void</span>)</span> &#123;</span><br><span class=\"line\">\tgameInit();</span><br><span class=\"line\">\t<span class=\"keyword\">while</span> (<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">\t\tuserClick();</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tupdateWindow();</span><br><span class=\"line\">\t\tupdateGame(); <span class=\"comment\">//æ›´æ–°æ¸¸æˆç›¸å…³æ•°æ®</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t\tSleep(<span class=\"number\">10</span>);<span class=\"comment\">//å¸§ç­‰å¾…</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tsystem(<span class=\"string\">&quot;pause&quot;</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"ä¼˜åŒ–æ¸¸æˆå¾ªç¯å’Œæ¸¸æˆæ¸²æŸ“å¾ªåº\">ä¼˜åŒ–æ¸¸æˆå¾ªç¯å’Œæ¸¸æˆæ¸²æŸ“å¾ªåº</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">updateWindow</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\tBeginBatchDraw(); <span class=\"comment\">//å¼€å§‹ç¼“å†²</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//æ¸²æŸ“ æ‹–åŠ¨è¿‡ç¨‹ä¸­çš„æ¤ç‰©ï¼ˆæ”¾åˆ°äº†æœ€åï¼‰</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (curZhiWu &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">\t\tIMAGE* img = imgZhiWu[curZhiWu - <span class=\"number\">1</span>][<span class=\"number\">0</span>];</span><br><span class=\"line\">\t\tputimagePNG(curX - img-&gt;getwidth() / <span class=\"number\">2</span>, curY - img-&gt;getheight() / <span class=\"number\">2</span>, img);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tEndBatchDraw(); <span class=\"comment\">//ç»“æŸåŒç¼“å†²</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">int</span> <span class=\"title function_\">main</span><span class=\"params\">(<span class=\"type\">void</span>)</span> &#123;</span><br><span class=\"line\">\tgameInit();</span><br><span class=\"line\">\t<span class=\"type\">int</span> timer = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"type\">bool</span> flag = <span class=\"literal\">true</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">while</span> (<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">\t\tuserClick();</span><br><span class=\"line\">\t\ttimer += getDelay();</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (timer &gt; <span class=\"number\">20</span>) &#123;</span><br><span class=\"line\">\t\t\tflag = <span class=\"literal\">true</span>;</span><br><span class=\"line\">\t\t\ttimer = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (flag) &#123;</span><br><span class=\"line\">\t\t\tflag = <span class=\"literal\">false</span>;</span><br><span class=\"line\">\t\t\tupdateWindow();</span><br><span class=\"line\">\t\t\tupdateGame();</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tsystem(<span class=\"string\">&quot;pause&quot;</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"åˆ¶ä½œå¯åŠ¨èœå•\">åˆ¶ä½œå¯åŠ¨èœå•</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">startUI</span><span class=\"params\">()</span> &#123; <span class=\"comment\">//å¯åŠ¨èœå•</span></span><br><span class=\"line\">\tIMAGE imgBg,imgMenu1,imgMenu2;</span><br><span class=\"line\">\tloadimage(&amp;imgBg, <span class=\"string\">&quot;res/menu.png&quot;</span>);</span><br><span class=\"line\">\tloadimage(&amp;imgMenu1, <span class=\"string\">&quot;res/menu1.png&quot;</span>);</span><br><span class=\"line\">\tloadimage(&amp;imgMenu2, <span class=\"string\">&quot;res/menu2.png&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"type\">int</span> flag = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">while</span> (<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">\t\tBeginBatchDraw();</span><br><span class=\"line\">\t\tputimage(<span class=\"number\">0</span>, <span class=\"number\">0</span>, &amp;imgBg);</span><br><span class=\"line\">\t\tputimagePNG(<span class=\"number\">474</span>, <span class=\"number\">75</span>, flag ? &amp;imgMenu2: &amp;imgMenu1);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tExMessage msg;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (peekmessage(&amp;msg)) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (msg.message == WM_LBUTTONDOWN&amp;&amp;</span><br><span class=\"line\">\t\t\t\t\tmsg.x&gt;<span class=\"number\">474</span>&amp;&amp;msg.x&lt;<span class=\"number\">474</span>+<span class=\"number\">300</span>&amp;&amp;</span><br><span class=\"line\">\t\t\t\t\tmsg.y&gt;<span class=\"number\">75</span>&amp;&amp;msg.y&lt;<span class=\"number\">75</span>+<span class=\"number\">140</span>)&#123;</span><br><span class=\"line\">\t\t\t\tflag = <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\t\t<span class=\"comment\">//EndBatchDraw();</span></span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (msg.message == WM_LBUTTONUP&amp;&amp;flag) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\tEndBatchDraw();</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">int</span> <span class=\"title function_\">main</span><span class=\"params\">(<span class=\"type\">void</span>)</span> &#123;</span><br><span class=\"line\">\tgameInit();</span><br><span class=\"line\"></span><br><span class=\"line\">\tstartUI();</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"type\">int</span> timer = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"type\">bool</span> flag = <span class=\"literal\">true</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">while</span> (<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">\t\tuserClick();</span><br><span class=\"line\">\t\ttimer += getDelay();</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (timer &gt; <span class=\"number\">20</span>) &#123;</span><br><span class=\"line\">\t\t\tflag = <span class=\"literal\">true</span>;</span><br><span class=\"line\">\t\t\ttimer = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (flag) &#123;</span><br><span class=\"line\">\t\t\tflag = <span class=\"literal\">false</span>;</span><br><span class=\"line\">\t\t\tupdateWindow();</span><br><span class=\"line\">\t\t\tupdateGame();</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tSleep(<span class=\"number\">10</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tsystem(<span class=\"string\">&quot;pause&quot;</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"åˆ›å»ºéšæœºé˜³å…‰\">åˆ›å»ºéšæœºé˜³å…‰</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;time.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">sunshineBall</span> &#123;</span></span><br><span class=\"line\">\t<span class=\"type\">int</span> x, y; <span class=\"comment\">//é˜³å…‰çƒåœ¨é£˜è½è¿‡ç¨‹ä¸­çš„åæ ‡ä½ç½®ï¼ˆxä¸å˜ï¼‰</span></span><br><span class=\"line\">\t<span class=\"type\">int</span> frameIndex; <span class=\"comment\">//å½“å‰æ˜¾ç¤ºçš„å›¾ç‰‡å¸§çš„åºå·</span></span><br><span class=\"line\">\t<span class=\"type\">int</span> destY; <span class=\"comment\">//é£˜è½çš„ç›®æ ‡ä½ç½®çš„yåæ ‡</span></span><br><span class=\"line\">\t<span class=\"type\">bool</span> used; <span class=\"comment\">//æ˜¯å¦åœ¨ä½¿ç”¨</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//é˜³å…‰æ± </span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">sunshineBall</span> <span class=\"title\">balls</span>[10];</span></span><br><span class=\"line\">IMAGE imgSunshineBall[<span class=\"number\">29</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">gameInit</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\t<span class=\"built_in\">memset</span>(balls, <span class=\"number\">0</span>, <span class=\"keyword\">sizeof</span>(balls));</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">29</span>; i++) &#123;</span><br><span class=\"line\">\t\tsprintf_s(name, <span class=\"keyword\">sizeof</span>(name), <span class=\"string\">&quot;res/sunshine/%d.png&quot;</span>, i + <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\tloadimage(&amp;imgSunshineBall[i], name);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//é…ç½®éšæœºç§å­</span></span><br><span class=\"line\">\tsrand(time(<span class=\"literal\">NULL</span>));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">creatSunshine</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\t<span class=\"type\">static</span> <span class=\"type\">int</span> count = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"type\">static</span> <span class=\"type\">int</span> fre = <span class=\"number\">400</span>;</span><br><span class=\"line\">\tcount++;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (count &gt;= fre) &#123; <span class=\"comment\">//æ¯freå¸§åˆ›å»ºä¸€ä¸ªé˜³å…‰ï¼Œfreéšæœºæ”¹å˜</span></span><br><span class=\"line\">\t\tfre = <span class=\"number\">200</span> + rand() % <span class=\"number\">200</span>;</span><br><span class=\"line\">\t\tcount = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"comment\">//ä»é˜³å…‰æ± ä¸­å–ä¸€ä¸ªå¯ä»¥ä½¿ç”¨çš„</span></span><br><span class=\"line\">\t\t<span class=\"type\">int</span> ballMax = <span class=\"keyword\">sizeof</span>(balls) / <span class=\"keyword\">sizeof</span>(balls[<span class=\"number\">0</span>]);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"type\">int</span> i;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (i = <span class=\"number\">0</span>; i &lt; ballMax &amp;&amp; balls[i].used; i++);</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (i &gt;= ballMax) <span class=\"keyword\">return</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tballs[i].used = <span class=\"literal\">true</span>;</span><br><span class=\"line\">\t\tballs[i].frameIndex = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\tballs[i].x = <span class=\"number\">260</span> + rand() % (<span class=\"number\">900</span> - <span class=\"number\">260</span>);</span><br><span class=\"line\">\t\tballs[i].y = <span class=\"number\">60</span>;</span><br><span class=\"line\">\t\tballs[i].destY = <span class=\"number\">200</span> + (rand() % <span class=\"number\">4</span>) * <span class=\"number\">90</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">updateGame</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\tcreatSunshine();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"æ˜¾ç¤ºéšæœºé˜³å…‰\">æ˜¾ç¤ºéšæœºé˜³å…‰</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">sunshineBall</span> &#123;</span></span><br><span class=\"line\">\t<span class=\"type\">int</span> x, y; <span class=\"comment\">//é˜³å…‰çƒåœ¨é£˜è½è¿‡ç¨‹ä¸­çš„åæ ‡ä½ç½®ï¼ˆxä¸å˜ï¼‰</span></span><br><span class=\"line\">\t<span class=\"type\">int</span> frameIndex; <span class=\"comment\">//å½“å‰æ˜¾ç¤ºçš„å›¾ç‰‡å¸§çš„åºå·</span></span><br><span class=\"line\">\t<span class=\"type\">int</span> destY; <span class=\"comment\">//é£˜è½çš„ç›®æ ‡ä½ç½®çš„yåæ ‡</span></span><br><span class=\"line\">\t<span class=\"type\">bool</span> used; <span class=\"comment\">//æ˜¯å¦åœ¨ä½¿ç”¨</span></span><br><span class=\"line\">\t<span class=\"type\">int</span> timer; <span class=\"comment\">//è®¡æ—¶å™¨</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">updateWindow</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> ballMax = <span class=\"keyword\">sizeof</span>(balls) / <span class=\"keyword\">sizeof</span>(balls[<span class=\"number\">0</span>]);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; ballMax; i++) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (balls[i].used) &#123;</span><br><span class=\"line\">\t\t\tIMAGE* img = &amp;imgSunshineBall[balls[i].frameIndex];</span><br><span class=\"line\">\t\t\tputimagePNG(balls[i].x, balls[i].y, img);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">creatSunshine</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (count &gt;= fre) &#123;</span><br><span class=\"line\">\t\tballs[i].timer = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">updateSunshine</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> ballMax = <span class=\"keyword\">sizeof</span>(balls) / <span class=\"keyword\">sizeof</span>(balls[<span class=\"number\">0</span>]);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; ballMax; i++) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (balls[i].used) &#123;</span><br><span class=\"line\">\t\t\tballs[i].frameIndex = (balls[i].frameIndex + <span class=\"number\">1</span>) % <span class=\"number\">29</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (balls[i].timer == <span class=\"number\">0</span>) &#123; <span class=\"comment\">//æœªåˆ°è¾¾åœ°é¢</span></span><br><span class=\"line\">\t\t\t\tballs[i].y += <span class=\"number\">2</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (balls[i].y &gt;= balls[i].destY) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"comment\">//balls[i].used = false;</span></span><br><span class=\"line\">\t\t\t\tballs[i].timer++;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (balls[i].timer &gt; <span class=\"number\">100</span>) &#123; <span class=\"comment\">//æ‰åˆ°åœ°é¢100å¸§ä¹‹å</span></span><br><span class=\"line\">\t\t\t\t\tballs[i].used = <span class=\"literal\">false</span>;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">updateGame</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\tcreatSunshine(); <span class=\"comment\">//åˆ›å»ºé˜³å…‰</span></span><br><span class=\"line\">\tupdateSunshine(); <span class=\"comment\">//æ›´æ–°é˜³å…‰çš„çŠ¶æ€</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"æ”¶é›†é˜³å…‰ã€æ˜¾ç¤ºé˜³å…‰å€¼\">æ”¶é›†é˜³å…‰ã€æ˜¾ç¤ºé˜³å…‰å€¼</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;mmsystem.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">pragma</span> comment(lib,<span class=\"string\">&quot;winmm.lib&quot;</span>)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">int</span> sunshine; <span class=\"comment\">//æ€»é˜³å…‰å€¼</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">gameInit</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\tsunshine = <span class=\"number\">150</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//è®¾ç½®å­—ä½“</span></span><br><span class=\"line\">\tLOGFONT f;</span><br><span class=\"line\">\tgettextstyle(&amp;f);                     <span class=\"comment\">// è·å–å½“å‰å­—ä½“è®¾ç½®</span></span><br><span class=\"line\">\tf.lfHeight = <span class=\"number\">30</span>;                      <span class=\"comment\">// è®¾ç½®å­—ä½“é«˜åº¦ä¸º 48</span></span><br><span class=\"line\">\tf.lfWidth = <span class=\"number\">15</span>;</span><br><span class=\"line\">\t<span class=\"built_in\">strcpy</span>(f.lfFaceName, <span class=\"string\">&quot;Segoe UI Black&quot;</span>); </span><br><span class=\"line\">\tf.lfQuality = ANTIALIASED_QUALITY;    <span class=\"comment\">// è®¾ç½®è¾“å‡ºæ•ˆæœä¸ºæŠ—é”¯é½¿  </span></span><br><span class=\"line\">\tsettextstyle(&amp;f);                     <span class=\"comment\">// è®¾ç½®å­—ä½“æ ·å¼</span></span><br><span class=\"line\">\tsetbkmode(TRANSPARENT);\t\t\t\t  <span class=\"comment\">//èƒŒæ™¯æ¨¡å¼é€æ˜</span></span><br><span class=\"line\">\tsetcolor(BLACK);\t\t\t\t\t  <span class=\"comment\">//å­—ä½“é¢œè‰²</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">updateWindow</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\t<span class=\"type\">char</span> scoreText[<span class=\"number\">8</span>];</span><br><span class=\"line\">\tsprintf_s(scoreText, <span class=\"keyword\">sizeof</span>(scoreText), <span class=\"string\">&quot;%d&quot;</span>, sunshine);</span><br><span class=\"line\">\touttextxy(<span class=\"number\">276</span>, <span class=\"number\">67</span>, scoreText); <span class=\"comment\">//åœ¨æŒ‡å®šä½ç½®è¾“å‡ºæ–‡æœ¬--åˆ†æ•°</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">collectSunshine</span><span class=\"params\">(ExMessage* msg)</span> &#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> count = <span class=\"keyword\">sizeof</span>(balls) / <span class=\"keyword\">sizeof</span>(balls[<span class=\"number\">0</span>]);</span><br><span class=\"line\">\t<span class=\"type\">int</span> w = imgSunshineBall[<span class=\"number\">0</span>].getwidth(); <span class=\"comment\">//é˜³å…‰çƒå®½åº¦</span></span><br><span class=\"line\">\t<span class=\"type\">int</span> h = imgSunshineBall[<span class=\"number\">0</span>].getheight();<span class=\"comment\">//é˜³å…‰çƒé«˜åº¦</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; count; i++) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (balls[i].used) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"type\">int</span> x = balls[i].x;</span><br><span class=\"line\">\t\t\t<span class=\"type\">int</span> y = balls[i].y;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (msg-&gt;x &gt; x &amp;&amp; msg-&gt;x &lt; x + w &amp;&amp; msg-&gt;y &gt; y &amp;&amp; msg-&gt;y &lt; y + h) &#123;</span><br><span class=\"line\">\t\t\t\tballs[i].used = <span class=\"literal\">false</span>;</span><br><span class=\"line\">\t\t\t\tsunshine += <span class=\"number\">25</span>;</span><br><span class=\"line\">\t\t\t\tmciSendString(<span class=\"string\">&quot;play res/sunshine.mp3&quot;</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>); <span class=\"comment\">//æ·»åŠ éŸ³æ•ˆ</span></span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">userClick</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\tExMessage msg;</span><br><span class=\"line\">\t<span class=\"type\">static</span> <span class=\"type\">int</span> status = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (peekmessage(&amp;msg)) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (msg.message == WM_LBUTTONDOWN) &#123; <span class=\"comment\">//å·¦å‡»æŒ‰ä¸‹</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (msg.x &gt; <span class=\"number\">338</span> &amp;&amp; msg.x &lt; <span class=\"number\">338</span> + <span class=\"number\">65</span> * ZHI_WU_COUNT &amp;&amp; msg.y &lt; <span class=\"number\">96</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\t\tcollectSunshine(&amp;msg);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","tags":["c","PvZ"]},{"title":"Hackathonå†³èµ›","url":"/post/5cfdd183.html","content":"<p>æœ¬æ¬¡æ‰€é€‰å·¥ç¨‹é¢˜ç›®å¯¹äºæˆ‘ä»¬æ¥è¯´éš¾åº¦è¿˜æ˜¯å¤ªå¤§äº†ã€‚æ‰€ä»¥å†³å®šå…ˆå»è§‚å…‰ä¸€ä¸‹åä¸ºæ¬§æ´²å°é•‡å§~</p>\n<center>\n<img src=\"https://s2.loli.net/2024/10/26/dDNqeRghP17isKX.jpg\" width=\"100%\" />\n<p>Figure 1</p>\n</center>\n<p>æ„æ–™ä¹‹å¤–è·å¾—â€œå®‰æ…°å¥–â€ã€‚</p>\n<center>\n<img src=\"https://s2.loli.net/2024/10/29/xtLy9h3d5SHAeuZ.jpg\" width=\"100%\" />\n<p>Figure 2</p>\n</center>\n<p>è¿”ç¨‹é£æœºä¸Šçš„ä½“éªŒæ„Ÿè¿˜ä¸é”™ã€‚</p>\n<center>\n<img src=\"https://s2.loli.net/2024/10/29/UOLH8Fyaf7lPsI6.jpg\" width=\"100%\" />\n<p>Figure 3</p>\n</center>","tags":["Hackathon","åä¸º","æ¯”èµ›","ä½“éªŒ"]},{"title":"Gitç‰ˆæœ¬æ§åˆ¶","url":"/post/4257a649.html","content":"<h1>æ–¹å¼ä¸€</h1>\n<p>hexoæ˜¯å½“å‰æœ€ç«çš„é™æ€åšå®¢æ¡†æ¶ï¼Œæ”¯æŒMarkdownæ ¼å¼æ–‡ç« ç¼–è¾‘å¹¶è‡ªåŠ¨ç”Ÿæˆå¯¹åº”çš„é™æ€ç½‘é¡µï¼Œç®€å•é«˜æ•ˆä»¤äººçˆ±ä¸é‡Šæ‰‹ã€‚<br>\nä½¿ç”¨hexoå†™åšå®¢çš„æµç¨‹é€šå¸¸æ˜¯ï¼Œ</p>\n<ol>\n<li>é€šè¿‡<code>hexo new post_name</code>å‘½ä»¤ï¼Œä¼šè‡ªåŠ¨åœ¨<code>source/_post</code>ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªå¾…å†™çš„<code>post_name.md</code>æ–‡ä»¶</li>\n<li>ç¼–å†™å®Œè¯¥mdæ–‡ä»¶åï¼Œç”¨<code>hexo generate</code>ç¼–è¯‘ç”Ÿæˆå¯¹åº”çš„HTMLæ–‡ä»¶</li>\n<li>å‘å¸ƒä¹‹å‰ï¼Œå¯ä»¥ç”¨<code>hexo s</code>æœ¬åœ°é¢„è§ˆï¼Œç„¶åé€šè¿‡<code>hexo deploy</code>å‘å¸ƒåˆ°è¿œç¨‹ä»“åº“çš„<strong>main</strong>åˆ†æ”¯ï¼Œç„¶åä½ çš„ä¸ªäººç«™ç‚¹å°±èƒ½çœ‹åˆ°åˆšæ‰æ–°åŠ çš„æ–‡ç« äº†</li>\n</ol>\n<p><a href=\"\"></a></p>\n<h2 id=\"å›°æ‰°\"><a href=\"#%E5%9B%B0%E6%89%B0\" title=\"å›°æ‰°\"></a>å›°æ‰°</h2>\n<p>ç„¶è€Œï¼Œä½¿ç”¨è¿‡hexoæ­å»ºä¸ªäººåšå®¢çš„æœ‹å‹ä»¬æƒ³å¿…éƒ½ä¼šé‡åˆ°åšå®¢æºç ä¿å­˜çš„é—®é¢˜ã€‚å³è¿œç¨‹ä»“åº“åªä¼šä¿å­˜hexoå‘å¸ƒåçš„é™æ€HTMLæ–‡ä»¶ï¼Œä½ çš„åšå®¢mdæºæ–‡ä»¶ã€ä¸»é¢˜é…ç½®ç­‰è¿˜åœ¨æœ¬åœ°ï¼Œä¸€æ—¦ç”µè„‘ç£ç›˜åäº†æˆ–è€…æ¢äº†ç”µè„‘ï¼Œå°±æ— æ³•åœ¨ä¹‹å‰ä»“åº“çš„åŸºç¡€ä¸Šç»§ç»­å†™åšå®¢ã€‚é’ˆå¯¹æ­¤é—®é¢˜ï¼Œæœ‰ä¸å°‘åšä¸»ä¼šåœ¨githubä¸Šå•ç‹¬å¦èµ·ä¸€ä¸ª<strong>repository</strong>æ¥ä¸“é—¨ä¿å­˜åšå®¢æºæ–‡ä»¶ï¼Œæ¯æ¬¡å‘å¸ƒå®Œæ–°æ–‡ç« ï¼Œéœ€è¦æ‰‹åŠ¨åœ°å°†<code>source/post</code>ä¸‹çš„mdæ–‡ä»¶ä¸Šä¼ åˆ°æºæ–‡ä»¶å¯¹åº”çš„<strong>repository</strong>ï¼Œç¡®å®ä¹Ÿèƒ½è§£å†³é—®é¢˜ï¼Œä½†æ€»å½’æ˜¯éº»çƒ¦ã€‚åæ¥å¶ç„¶çœ‹åˆ°èªæ˜çš„ç½‘å‹å€ŸåŠ©gitåˆ†æ”¯æ¥å·§å¦™åœ°å®ç°ç”¨åŒä¸€ä¸ªä»“åº“ä¿å­˜é™æ€ç½‘é¡µå’Œåšå®¢æºç ï¼Œè‡ªå·±è¯•äº†ä¸‹ç¡®å®å¾ˆèµï¼Œæ•…æ€»ç»“ä¹‹ã€‚</p>\n<h2 id=\"è§£å†³åŠæ³•\"><a href=\"#%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95\" title=\"è§£å†³åŠæ³•\"></a>è§£å†³åŠæ³•</h2>\n<h3 id=\"æ–°å»ºgitåˆ†æ”¯\"><a href=\"#%E6%96%B0%E5%BB%BAgit%E5%88%86%E6%94%AF\" title=\"æ–°å»ºgitåˆ†æ”¯\"></a>æ–°å»ºgitåˆ†æ”¯</h3>\n<p>å› Github Pageè¦æ±‚ä½¿ç”¨mainåˆ†æ”¯ä½œä¸ºå‘å¸ƒç½‘ç«™çš„æºä»£ç ï¼Œæˆ‘ä»¬åªèƒ½ç”¨mainåˆ†æ”¯æ¥ä¿å­˜hexoç”Ÿæˆçš„é™æ€ç½‘é¡µï¼Œå¯¹äºåšå®¢æºç ï¼Œå¯ä»¥æ–°å»ºä¸€ä¸ªsourceåˆ†æ”¯æ¥å­˜å‚¨ã€‚åœ¨githubä¸Šæ‰“å¼€Pageså¯¹åº”çš„ä»“åº“ï¼Œä¹Ÿå°±æ˜¯ä»¥â€<a href=\"http://username.github.io\">username.github.io</a>â€å‘½åçš„ä»“åº“ï¼Œç„¶åå»ºç«‹ä¸€ä¸ªsourceåˆ†æ”¯ï¼Œå¦‚ä¸‹å›¾ï¼š</p>\n<p><img src=\"/2019/06/29/save-hexo-source-post-with-git-branch/create_branch.png\" alt=\"createbranch\"></p>\n<p>å› ä¸ºæˆ‘å·²ç»åˆ›å»ºè¿‡sourceåˆ†æ”¯ï¼Œæ•…ä¸‹æ–¹ä¼šæ˜¾ç¤ºç›®å‰è¯¥ä»“åº“ä¸Šæœ‰mainå’Œsourceä¸¤ä¸ªåˆ†æ”¯ã€‚å…¶ä¸­sourceåˆ†æ”¯æ˜¾ç¤ºæ‰“é’©ï¼Œè¡¨ç¤ºå½“å‰ä»“åº“çš„é»˜è®¤åˆ†æ”¯å·²ç»æ˜¯sourceè€Œä¸æ˜¯mainäº†ï¼Œä¸‹é¢ä¼šè®²ã€‚</p>\n<h3 id=\"æ›´æ”¹ä»“åº“çš„é»˜è®¤åˆ†æ”¯\"><a href=\"#%E6%9B%B4%E6%94%B9%E4%BB%93%E5%BA%93%E7%9A%84%E9%BB%98%E8%AE%A4%E5%88%86%E6%94%AF\" title=\"æ›´æ”¹ä»“åº“çš„é»˜è®¤åˆ†æ”¯\"></a>æ›´æ”¹ä»“åº“çš„é»˜è®¤åˆ†æ”¯</h3>\n<p>githubä¸Šçš„ä»“åº“åˆå§‹éƒ½ä¼šæœ‰ä¸ªmainåˆ†æ”¯ï¼Œä¹Ÿå°±æ˜¯é»˜è®¤åˆ†æ”¯ã€‚å¯¹äºä¸€ä¸ªä»“åº“<code>project_name</code>ï¼Œå½“æˆ‘ä»¬é€šè¿‡<code>git clone https://github.com/sherlockyb/project_name.git</code>ä¸‹è½½ä»£ç æ—¶ï¼Œå®é™…æ‹‰å–çš„æ˜¯é»˜è®¤åˆ†æ”¯mainå¯¹åº”çš„ä»£ç ã€‚è€Œæˆ‘ä»¬ç”¨hexoå†™åšå®¢æ—¶ï¼Œé€šå¸¸æ˜¯ä¸mdæºæ–‡ä»¶æ‰“äº¤é“ï¼Œå¯¹äºdeployç”Ÿæˆçš„mainåˆ†æ”¯ä»£ç å¹¶ä¸éœ€è¦æˆ‘ä»¬å…³æ³¨ï¼Œå› æ­¤å¯å°†ä»“åº“çš„é»˜è®¤åˆ†æ”¯æ”¹ä¸ºä¿å­˜æºç çš„sourceåˆ†æ”¯ï¼Œè¿™æ ·é€šè¿‡<code>git clone</code>æ‹‰å–çš„å°±æ˜¯sourceåˆ†æ”¯ä»£ç äº†ã€‚</p>\n<p>åœ¨ä»“åº“çš„ä¸»é¡µé¢ï¼Œé€šè¿‡Settings -&gt; Branchsï¼Œå¯ä»¥çœ‹åˆ°<strong>Default branch</strong>çš„Tabï¼Œæ˜¾ç¤ºçš„é»˜è®¤åˆ†æ”¯æ˜¯mainï¼Œå¯ä»¥å‹¾é€‰sourceï¼Œç„¶åupdateå³å¯å°†é»˜è®¤åˆ†æ”¯è®¾ç½®ä¸ºsourceï¼Œå¦‚ä¸‹å›¾ï¼š</p>\n<p><img src=\"/2019/06/29/save-hexo-source-post-with-git-branch/default_branch.png\" alt=\"switchdefaultbranch\"></p>\n<h3 id=\"å°†æœ¬åœ°hexoç›®å½•ä¸è¿œç¨‹ä»“åº“å…³è”\"><a href=\"#%E5%B0%86%E6%9C%AC%E5%9C%B0hexo%E7%9B%AE%E5%BD%95%E4%B8%8E%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93%E5%85%B3%E8%81%94\" title=\"å°†æœ¬åœ°hexoç›®å½•ä¸è¿œç¨‹ä»“åº“å…³è”\"></a>å°†æœ¬åœ°hexoç›®å½•ä¸è¿œç¨‹ä»“åº“å…³è”</h3>\n<p>è¿›å…¥åˆ°æœ¬åœ°hexoå·¥ç¨‹ç›®å½•ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬é€šå¸¸æ‰§è¡Œ<code>hexo new post</code>ç­‰å‘½ä»¤çš„ç›®å½•ï¼Œæ‰§è¡Œå¦‚ä¸‹æ“ä½œï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">git remote add origin https://github.com/sherlockyb/sherlockyb.github.io.git</span><br></pre></td></tr></table></figure>\n<h3 id=\"æ¨é€åšå®¢æºç \"><a href=\"#%E6%8E%A8%E9%80%81%E5%8D%9A%E5%AE%A2%E6%BA%90%E7%A0%81\" title=\"æ¨é€åšå®¢æºç \"></a>æ¨é€åšå®¢æºç </h3>\n<p>å°†æœ¬åœ°çš„mdæºæ–‡ä»¶ã€ç«™ç‚¹é…ç½®æ–‡ä»¶ç­‰æ¨é€åˆ°sourceåˆ†æ”¯ã€‚<br>\nå› ä¸ºæˆ‘ä»¬åªéœ€è¦ä¿ç•™åšå®¢æºç ï¼Œå…¶ä»–æ— å…³çš„æ–‡ä»¶å¹¶ä¸å¸Œæœ›æ¨é€ï¼Œéœ€è¦ç¡®ä¿é…å¥½äº†<code>.gitignore</code>æ–‡ä»¶ï¼Œé€šå¸¸å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">.DS_Store</span><br><span class=\"line\">Thumbs.db</span><br><span class=\"line\">db.json</span><br><span class=\"line\">*.log</span><br><span class=\"line\">node_modules/</span><br><span class=\"line\">public/</span><br><span class=\"line\">.deploy*/</span><br></pre></td></tr></table></figure>\n<p>ç„¶åä¾æ¬¡æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">git add .</span><br><span class=\"line\">git commit -m &#x27;hexo source post&#x27;</span><br><span class=\"line\">git push origin source</span><br></pre></td></tr></table></figure>\n<h3 id=\"åˆ é™¤publicç­‰æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰\"><a href=\"#%E5%88%A0%E9%99%A4public%E7%AD%89%E6%96%87%E4%BB%B6%EF%BC%88%E5%8F%AF%E9%80%89%EF%BC%89\" title=\"åˆ é™¤publicç­‰æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰\"></a>åˆ é™¤publicç­‰æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰</h3>\n<p>å› ä¸ºsourceåˆ†æ”¯æ˜¯ä»mainåˆ†æ”¯æ–°å»ºçš„ï¼Œåˆå§‹ä»£ç å®é™…å°±æ˜¯mainçš„æ‹·è´ï¼Œå› è€Œmainä¸­å·²æœ‰çš„publicç­‰deployç”Ÿæˆçš„æ–‡ä»¶ä¹Ÿä¼šä¸€èµ·å¸¦è¿‡æ¥ï¼Œè¿™äº›éƒ½ä¸ç®—æ˜¯åšå®¢æºæ–‡ä»¶ï¼Œå¦‚æœä½ ä¹Ÿè§‰ç€sourceåˆ†æ”¯è¿˜å­˜ç€è¿™äº›æœ‰äº›åˆ«æ‰­ï¼Œå°±å¯ä»¥å…ˆåœ¨æœ¬åœ°æŠŠå®ƒåˆ æ‰ï¼Œç„¶åæ‰§è¡Œï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">git add .</span><br><span class=\"line\">git commit -m &#x27;DEL: public things which only for deploy&#x27;</span><br><span class=\"line\">git push origin source</span><br></pre></td></tr></table></figure>\n<p>æ‰§è¡Œå®Œä¹‹åï¼Œä½ çš„ä»“åº“å¤§æ¦‚å°±æ˜¯é•¿è¿™ä¸ªæ ·å­ï¼š</p>\n<p><img src=\"/2019/06/29/save-hexo-source-post-with-git-branch/source_files.png\" alt=\"sourcefiles\"></p>\n<p>åç»­å³ä¾¿ä½ å†å‘å¸ƒåšå®¢æ—¶ï¼Œdeployç”Ÿæˆpublicæ–‡ä»¶ï¼Œåœ¨æäº¤åšå®¢æºç æ—¶ï¼Œä¹Ÿä¸ä¼šå°†å…¶å¸¦ä¸Šå»ï¼Œå› ä¸ºæœ‰<code>.gitignore</code>å°†å…¶å¿½ç•¥äº†ã€‚</p>\n<h2 id=\"æ–°ç¯å¢ƒ\"><a href=\"#%E6%96%B0%E7%8E%AF%E5%A2%83\" title=\"æ–°ç¯å¢ƒ\"></a>æ–°ç¯å¢ƒ</h2>\n<p>å‡è®¾æˆ‘ä»¬æ¢ç”µè„‘äº†ï¼Œè¦åœ¨æ–°ç¯å¢ƒç»§ç»­åœ¨åŸæœ‰ä»“åº“åŸºç¡€ä¸Šæ’¸æ–‡ç« ï¼Œæ­¤æ—¶é€šè¿‡<code>git clone</code>å°†åšå®¢æºç æ‹‰åˆ°æœ¬åœ°ï¼Œç„¶åå®‰è£…ã€åˆå§‹åŒ–hexoå°±èƒ½æå®šï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">git clone https://github.com/sherlockyb/sherlockyb.github.io.git sherlockyb</span><br><span class=\"line\">cd sherlockyb</span><br><span class=\"line\">npm install hexo</span><br><span class=\"line\">npm install hexo-deployer-git -save</span><br><span class=\"line\"></span><br><span class=\"line\">// åˆ«å¿˜äº†å®‰è£…ç›¸å…³ä¾èµ–çš„ NodeJS åŒ…ï¼Œä¹Ÿå°±æ˜¯ _config.xml ä¸­ç”¨åˆ°çš„ä¸€äº›æ’ä»¶</span><br><span class=\"line\">npm install hexo-wordcount</span><br><span class=\"line\">...</span><br><span class=\"line\"></span><br><span class=\"line\">// hexoç¯å¢ƒé…ç½®å¥½åï¼Œç»§ç»­åƒä¹‹å‰ä¸€æ ·</span><br><span class=\"line\">hexo new post_name</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n<h2 id=\"æ³¨æ„äº‹é¡¹\"><a href=\"#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9\" title=\"æ³¨æ„äº‹é¡¹\"></a>æ³¨æ„äº‹é¡¹</h2>\n<p>ç¡®ä¿<code>hexo deploy</code>æ¨é€çš„æ˜¯mainåˆ†æ”¯ï¼Œhexoç›®å½•ä¸‹çš„_config.ymlæ–‡ä»¶é€šå¸¸ä¼šé…ç½®deployæ¨é€çš„ç›®æ ‡åœ°å€ï¼Œè¿™ä¸ªä¸€èˆ¬åœ¨æœ€åˆä½¿ç”¨hexoæ—¶ï¼Œå°±ä¼šé…ç½®ä¸ºmainï¼Œä¸ç”¨æ”¹åŠ¨ï¼š</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Deployment</span></span><br><span class=\"line\"><span class=\"comment\">## Docs: https://hexo.io/docs/deployment.html</span></span><br><span class=\"line\"><span class=\"attr\">deploy:</span></span><br><span class=\"line\">  <span class=\"attr\">type:</span> <span class=\"string\">git</span></span><br><span class=\"line\">  <span class=\"attr\">repo:</span> <span class=\"string\">https://github.com/sherlockyb/sherlockyb.github.io.git</span></span><br><span class=\"line\">  <span class=\"attr\">branch:</span> <span class=\"string\">main</span></span><br></pre></td></tr></table></figure>\n<h1>æ–¹å¼äºŒ</h1>\n<h2 id=\"æ–°å»ºä»“åº“\">æ–°å»ºä»“åº“</h2>\n<img src=\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/Gitç‰ˆæœ¬æ§åˆ¶/1.png\" width=\"70%\" />\n<p>è‹¥æˆåŠŸåˆ›å»ºä»“åº“å°†å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>\n<img src=\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/Gitç‰ˆæœ¬æ§åˆ¶/2.png\" width=\"70%\" />\n<h2 id=\"åˆ›å»º-gitignoreæ–‡ä»¶\">åˆ›å»º<code>.gitignore</code>æ–‡ä»¶</h2>\n<p>åšå®¢æ ¹ç›®å½•ä¸‹åˆ›å»º<code>.gitignore</code>æ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">.DS_Store</span><br><span class=\"line\">Thumbs.db</span><br><span class=\"line\">db.json</span><br><span class=\"line\">*.log</span><br><span class=\"line\">node_modules/</span><br><span class=\"line\">public/</span><br><span class=\"line\">.deploy*/</span><br><span class=\"line\">_multiconfig.yml</span><br><span class=\"line\">.vscode/</span><br><span class=\"line\">.idea/</span><br><span class=\"line\">/.idea/</span><br><span class=\"line\">.deploy_git*/</span><br><span class=\"line\">.idea</span><br><span class=\"line\">themes/butterfly/.git</span><br></pre></td></tr></table></figure>\n<h2 id=\"æœ¬åœ°Gitä»“åº“åˆå§‹åŒ–\">æœ¬åœ°Gitä»“åº“åˆå§‹åŒ–</h2>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">git init</span><br></pre></td></tr></table></figure>\n<p>å‡ºç°å¦‚ä¸‹æç¤ºï¼Œè¯´æ˜åˆå§‹åŒ–æˆåŠŸã€‚</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">Initialized empty Git repository <span class=\"keyword\">in</span> your/blog<span class=\"string\">&#x27;s/path/.git/</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">git add .</span><br><span class=\"line\">git commit -m &quot;first commit&quot;</span><br><span class=\"line\">git branch -M main</span><br><span class=\"line\">git remote add origin https://github.com/HaydenZHY/Blog.git</span><br><span class=\"line\">git push -u origin main</span><br></pre></td></tr></table></figure>\n<p>æˆåŠŸä¸Šä¼ åˆ°GitHubåï¼ŒGitHubä¸Šçš„ä»“åº“å°†å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>\n<img src=\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/Gitç‰ˆæœ¬æ§åˆ¶/3.png\" width=\"70%\" />","tags":["Git"]},{"title":"Java ç»¼åˆå®æˆ˜ï¼ˆä¸€ï¼‰","url":"/post/70803326.html","content":"<hr>\n<h2 id=\"Java-ç»¼åˆå®æˆ˜ï¼ˆä¸€ï¼‰\">Java ç»¼åˆå®æˆ˜ï¼ˆä¸€ï¼‰</h2>\n<h3 id=\"å¥åº·è®¡ç®—å™¨\">å¥åº·è®¡ç®—å™¨</h3>\n<p><strong>éœ€æ±‚ï¼šå¼€å‘ä¸€ä¸ªç®€å•çš„å¥åº·è®¡ç®—å™¨åº”ç”¨ç¨‹åºï¼Œå®ƒå¯ä»¥æ¥å—ç”¨æˆ·çš„è¾“å…¥ï¼ˆå¦‚å¹´é¾„ã€æ€§åˆ«ã€ä½“é‡ã€èº«é«˜ï¼‰ï¼Œå¹¶è®¡ç®—å‡ºç”¨æˆ·çš„ BMIï¼ˆèº«ä½“è´¨é‡æŒ‡æ•°ï¼‰å’Œ BMRï¼ˆåŸºç¡€ä»£è°¢ç‡ï¼‰ã€‚</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> test;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Scanner;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">test</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        Scanner sc=<span class=\"keyword\">new</span> <span class=\"title class_\">Scanner</span>(System.in);</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;è¯·æ‚¨è¾“å…¥æ‚¨çš„èº«é«˜ï¼š&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">double</span> height=sc.nextDouble();</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;è¯·æ‚¨è¾“å…¥æ‚¨çš„ä½“é‡ï¼š&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">double</span> weight=sc.nextDouble();</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;è¯·æ‚¨è¾“å…¥æ‚¨çš„æ€§åˆ«ï¼ˆç”·/å¥³ï¼‰ï¼š&quot;</span>);</span><br><span class=\"line\">        String sex=sc.next();</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;è¯·æ‚¨è¾“å…¥æ‚¨çš„å¹´é¾„ï¼š&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">int</span> age=sc.nextInt();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">double</span> bmi=calcBMI(height,weight);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;æ‚¨çš„BMIå€¼ä¸ºï¼š&quot;</span>+bmi);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">double</span> bmr=calcBMR(height,weight,age,sex);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;æ‚¨çš„BMRå€¼ä¸ºï¼š&quot;</span>+bmr);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"type\">double</span> <span class=\"title function_\">calcBMI</span><span class=\"params\">(<span class=\"type\">double</span> height,<span class=\"type\">double</span> weight)</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> weight/(height*height);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"type\">double</span> <span class=\"title function_\">calcBMR</span><span class=\"params\">(<span class=\"type\">double</span> height,<span class=\"type\">double</span> weight,<span class=\"type\">int</span> age,String sex)</span>&#123;</span><br><span class=\"line\">        <span class=\"type\">double</span> bmr=<span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(sex.equals(<span class=\"string\">&quot;ç”·&quot;</span>))&#123;</span><br><span class=\"line\">            bmr=<span class=\"number\">88.362</span>+<span class=\"number\">13.397</span>*weight+<span class=\"number\">4.799</span>*height-<span class=\"number\">5.677</span>*age;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">            bmr=<span class=\"number\">447.593</span>+<span class=\"number\">9.247</span>*weight+<span class=\"number\">3.098</span>*height-<span class=\"number\">4.330</span>*age;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> bmr;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"ç®€å•è®¡ç®—å™¨\">ç®€å•è®¡ç®—å™¨</h3>\n<p><strong>éœ€æ±‚ï¼šè®¾è®¡ä¸€ä¸ªå¯ä»¥æ‰§è¡ŒåŸºæœ¬æ•°å­¦è¿ç®—ï¼ˆåŠ ã€å‡ã€ä¹˜ã€é™¤ï¼‰çš„è®¡ç®—å™¨ç¨‹åºã€‚</strong><br>\n<strong>åŠŸèƒ½æè¿°ï¼šç”¨æˆ·è¾“å…¥ä¸¤ä¸ªæ•°å­—ã€ä¸€ä¸ªè¿ç®—ç¬¦ï¼ˆ+ã€-ã€*ã€/ï¼‰ã€‚æ ¹æ®æ‰€é€‰è¿ç®—ç¬¦æ‰§è¡Œç›¸åº”çš„æ•°å­¦è¿ç®—ï¼Œæ˜¾ç¤ºè¿ç®—ç»“æœã€‚</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> test1;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Scanner;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">test1</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        Scanner sc=<span class=\"keyword\">new</span> <span class=\"title class_\">Scanner</span>(System.in);</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;è¯·è¾“å…¥ç¬¬ä¸€ä¸ªæ•°å­—ï¼š&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">double</span> num1=sc.nextDouble();</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;è¯·è¾“å…¥ç¬¬äºŒä¸ªæ•°å­—ï¼š&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">double</span> num2=sc.nextDouble();</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;è¯·è¾“å…¥è¿ç®—ç¬¦ï¼ˆ+ã€-ã€*ã€/ï¼‰ï¼š&quot;</span>);</span><br><span class=\"line\">        String operator=sc.next();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">double</span> result=calculate(num1,num2,operator);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;è®¡ç®—ç»“æœä¸ºï¼š&quot;</span>+result);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"type\">double</span> <span class=\"title function_\">calculate</span><span class=\"params\">(<span class=\"type\">double</span> num1,<span class=\"type\">double</span> num2,String operator)</span>&#123;</span><br><span class=\"line\">        <span class=\"type\">double</span> result=<span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">switch</span> (operator)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> <span class=\"string\">&quot;+&quot;</span>:</span><br><span class=\"line\">                result=num1+num2;</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> <span class=\"string\">&quot;-&quot;</span>:</span><br><span class=\"line\">                result=num1-num2;</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> <span class=\"string\">&quot;*&quot;</span>:</span><br><span class=\"line\">                result=num1*num2;</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> <span class=\"string\">&quot;/&quot;</span>:</span><br><span class=\"line\">                result=num1/num2;</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">default</span>:</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;è¾“å…¥çš„è¿ç®—ç¬¦æœ‰è¯¯ï¼&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"çŒœæ•°å­—å°æ¸¸æˆ\">çŒœæ•°å­—å°æ¸¸æˆ</h3>\n<p><strong>éœ€æ±‚ï¼šéšæœºç”Ÿæˆä¸€ä¸ª1-100ä¹‹é—´çš„æ•°æ®ï¼Œæç¤ºç”¨æˆ·çŒœæµ‹ï¼ŒçŒœå¤§æç¤ºè¿‡å¤§ï¼ŒçŒœå°æç¤ºè¿‡å°ï¼Œç›´åˆ°çŒœä¸­ç»“æŸæ¸¸æˆã€‚</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> test1;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Random;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Scanner;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">test2</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        guessNumber();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">guessNumber</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">/*æ–¹æ³•ä¸€*/</span></span><br><span class=\"line\">        <span class=\"comment\">//Math.random()è¿”å›[0,1)ä¹‹é—´çš„éšæœºå°æ•°</span></span><br><span class=\"line\">        <span class=\"comment\">//(int)(Math.random()*100)==&gt;[0,100)çš„æ•´æ•°==&gt;[0,99]+1==&gt;[1,100]</span></span><br><span class=\"line\">        <span class=\"comment\">//int number=(int)(Math.random()*100)+1;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/*æ–¹æ³•äºŒ*/</span></span><br><span class=\"line\">        Random r=<span class=\"keyword\">new</span> <span class=\"title class_\">Random</span>();</span><br><span class=\"line\">        <span class=\"type\">int</span> number=r.nextInt(<span class=\"number\">100</span>)+<span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        Scanner sc=<span class=\"keyword\">new</span> <span class=\"title class_\">Scanner</span>(System.in);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">while</span>(<span class=\"literal\">true</span>)&#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;è¯·è¾“å…¥ä¸€ä¸ª1~100ä¹‹é—´çš„æ•°å­—ï¼š&quot;</span>);</span><br><span class=\"line\">            <span class=\"type\">int</span> guess=sc.nextInt();</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(guess&lt;number)&#123;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;çŒœå°äº†ï¼Œå†è¯•è¯•å§ï¼&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(guess&gt;number)&#123;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;çŒœå¤§äº†ï¼Œå†è¯•è¯•å§ï¼&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;æ­å–œä½ çŒœå¯¹äº†ï¼&quot;</span>);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"å¼€å‘ä¸€ä¸ªéªŒè¯ç \">å¼€å‘ä¸€ä¸ªéªŒè¯ç </h3>\n<p><strong>éœ€æ±‚ï¼šå¼€å‘ä¸€ä¸ªç¨‹åºï¼Œå¯ä»¥ç”ŸæˆæŒ‡å®šä½æ•°çš„éªŒè¯ç ï¼Œæ¯ä½å¯ä»¥æ˜¯æ•°å­—ï¼Œå¤§å°å†™å­—æ¯ã€‚</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> test1;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">test3</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        System.out.println(getCode(<span class=\"number\">6</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title function_\">getCode</span><span class=\"params\">(<span class=\"type\">int</span> n)</span>&#123;</span><br><span class=\"line\">        String code=<span class=\"string\">&quot;&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;n;i++)&#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> type=(<span class=\"type\">int</span>)(Math.random()*<span class=\"number\">3</span>); <span class=\"comment\">//æ•°å­—0/å¤§å†™1/å°å†™2</span></span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"keyword\">switch</span>(type)&#123;</span><br><span class=\"line\">                <span class=\"keyword\">case</span> <span class=\"number\">0</span>:</span><br><span class=\"line\">                    <span class=\"type\">int</span> num=(<span class=\"type\">int</span>)(Math.random()*<span class=\"number\">10</span>);</span><br><span class=\"line\">                    code+=num;</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                <span class=\"keyword\">case</span> <span class=\"number\">1</span>:</span><br><span class=\"line\">                    <span class=\"type\">int</span> num1=(<span class=\"type\">int</span>)(Math.random()*<span class=\"number\">26</span>)+<span class=\"number\">65</span>;</span><br><span class=\"line\">                    code+=(<span class=\"type\">char</span>)num1;</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                <span class=\"keyword\">case</span> <span class=\"number\">2</span>:</span><br><span class=\"line\">                    <span class=\"type\">int</span> num2=(<span class=\"type\">int</span>)(Math.random()*<span class=\"number\">26</span>)+<span class=\"number\">97</span>;</span><br><span class=\"line\">                    code+=(<span class=\"type\">char</span>)num2;</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> code;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"æ‰¾ç´ æ•°\">æ‰¾ç´ æ•°</h3>\n<p><strong>éœ€æ±‚ï¼šè¾“å‡º101-200ä¹‹é—´çš„æ‰€æœ‰ç´ æ•°ä»¥åŠæ€»ä¸ªæ•°ã€‚</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> test1;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">test4</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">//ç›®æ ‡ï¼šæ‰¾å‡º101-200ä¹‹é—´çš„å…¨éƒ¨ç´ æ•°</span></span><br><span class=\"line\">        <span class=\"type\">int</span> count=<span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">101</span>;i&lt;=<span class=\"number\">200</span>;i++)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(isPrime(i))&#123;</span><br><span class=\"line\">                System.out.println(i);</span><br><span class=\"line\">                count++;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;ç´ æ•°çš„ä¸ªæ•°ä¸ºï¼š&quot;</span>+count);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"type\">boolean</span> <span class=\"title function_\">isPrime</span><span class=\"params\">(<span class=\"type\">int</span> num)</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">2</span>;i*i&lt;=num;i++)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(num%i==<span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"æ–—åœ°ä¸»æ¸¸æˆ\">æ–—åœ°ä¸»æ¸¸æˆ</h3>\n<p><strong>éœ€æ±‚ï¼šå¼€å‘ä¸€ä¸ªç®€æ˜“ç‰ˆçš„æ–—åœ°ä¸»æ¸¸æˆï¼Œè¦æ±‚åªå®Œæˆåšç‰Œï¼ˆå­˜å‚¨54å¼ ç‰Œï¼‰ã€æ´—ç‰Œã€‚</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> test2;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">test1</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">       start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">start</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        String[] poker=<span class=\"keyword\">new</span> <span class=\"title class_\">String</span>[<span class=\"number\">54</span>];</span><br><span class=\"line\">        String[] colors=&#123;<span class=\"string\">&quot;â™ &quot;</span>,<span class=\"string\">&quot;â™¥&quot;</span>,<span class=\"string\">&quot;â™£&quot;</span>,<span class=\"string\">&quot;â™¦&quot;</span>&#125;;</span><br><span class=\"line\">        String[] nums=&#123;<span class=\"string\">&quot;2&quot;</span>,<span class=\"string\">&quot;3&quot;</span>,<span class=\"string\">&quot;4&quot;</span>,<span class=\"string\">&quot;5&quot;</span>,<span class=\"string\">&quot;6&quot;</span>,<span class=\"string\">&quot;7&quot;</span>,<span class=\"string\">&quot;8&quot;</span>,<span class=\"string\">&quot;9&quot;</span>,<span class=\"string\">&quot;10&quot;</span>,<span class=\"string\">&quot;J&quot;</span>,<span class=\"string\">&quot;Q&quot;</span>,<span class=\"string\">&quot;K&quot;</span>,<span class=\"string\">&quot;A&quot;</span>&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">int</span> index=<span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;colors.length;i++)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">0</span>;j&lt;nums.length;j++)&#123;</span><br><span class=\"line\">                poker[index++]=colors[i]+nums[j];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        poker[index++]=<span class=\"string\">&quot;Big Joker&quot;</span>;</span><br><span class=\"line\">        poker[index++]=<span class=\"string\">&quot;Small Joker&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//æ‰“å°ç‰Œ</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;poker.length;i++)&#123;</span><br><span class=\"line\">            System.out.print(poker[i]+<span class=\"string\">&quot;\\t&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//æ´—ç‰Œ</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;poker.length;i++)&#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> j=(<span class=\"type\">int</span>)(Math.random()*poker.length);</span><br><span class=\"line\">            String temp=poker[i];</span><br><span class=\"line\">            poker[i]=poker[j];</span><br><span class=\"line\">            poker[j]=temp;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;æ´—ç‰Œåï¼š&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;poker.length;i++)&#123;</span><br><span class=\"line\">            System.out.print(poker[i]+<span class=\"string\">&quot;\\t&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"çŸ³å¤´è¿·é˜µæ¸¸æˆ\">çŸ³å¤´è¿·é˜µæ¸¸æˆ</h3>\n<p><strong>éœ€æ±‚ï¼šåªéœ€å®Œæˆæ•°æ®åˆå§‹åŒ–</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> test2;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">test2</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        start(<span class=\"number\">5</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">start</span><span class=\"params\">(<span class=\"type\">int</span> n)</span> &#123;</span><br><span class=\"line\">       <span class=\"type\">int</span>[][] arr=<span class=\"keyword\">new</span> <span class=\"title class_\">int</span>[n][n];</span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"type\">int</span> count=<span class=\"number\">1</span>;</span><br><span class=\"line\">       <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;n;i++)&#123;</span><br><span class=\"line\">           <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">0</span>;j&lt;n;j++)&#123;</span><br><span class=\"line\">               arr[i][j]=count++;</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">       print(arr);</span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"comment\">//æ‰“ä¹±äºŒç»´æ•°ç»„ä¸­çš„å…ƒç´ é¡ºåº</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;arr.length;i++)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">0</span>;j&lt;arr[i].length;j++)&#123;</span><br><span class=\"line\">                <span class=\"type\">int</span> x=(<span class=\"type\">int</span>)(Math.random()*arr.length);</span><br><span class=\"line\">                <span class=\"type\">int</span> y=(<span class=\"type\">int</span>)(Math.random()*arr[i].length);</span><br><span class=\"line\">                <span class=\"type\">int</span> temp=arr[i][j];</span><br><span class=\"line\">                arr[i][j]=arr[x][y];</span><br><span class=\"line\">                arr[x][y]=temp;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;------------------&quot;</span>);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;æ‰“ä¹±åï¼š&quot;</span>);</span><br><span class=\"line\">        print(arr);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">print</span><span class=\"params\">(<span class=\"type\">int</span>[][] arr)</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;arr.length;i++)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">0</span>;j&lt;arr[i].length;j++)&#123;</span><br><span class=\"line\">                System.out.print(arr[i][j]+<span class=\"string\">&quot;\\t&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            System.out.println();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","tags":["Java"]},{"title":"Markdown è¯­æ³•","url":"/post/78e09c9c.html","content":"<h2 id=\"Markdown-æ ‡é¢˜\">Markdown æ ‡é¢˜</h2>\n<figure class=\"highlight markdown\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"section\"># ä¸€çº§æ ‡é¢˜</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"section\">## äºŒçº§æ ‡é¢˜</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"section\">### ä¸‰çº§æ ‡é¢˜</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"section\">#### å››çº§æ ‡é¢˜</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"section\">##### äº”çº§æ ‡é¢˜</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"section\">###### å…­çº§æ ‡é¢˜</span></span><br></pre></td></tr></table></figure>\n<p>Â <strong>æˆ–è€…åœ¨æ–‡æœ¬ä¸‹æ–¹æ·»åŠ ä»»æ„æ•°é‡çš„ = æˆ– - åˆ†åˆ«ç”¨äºè¡¨ç¤ºä¸€çº§æ ‡é¢˜æˆ–äºŒçº§æ ‡é¢˜</strong></p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"section\">ä¸€çº§æ ‡é¢˜</span></span><br><span class=\"line\"><span class=\"section\">=========</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"section\">äºŒçº§æ ‡é¢˜</span></span><br><span class=\"line\"><span class=\"section\">---------</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"Markdown-å­—ä½“\">Markdown å­—ä½“</h2>\n<figure class=\"highlight markdown\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"emphasis\">*æ–œä½“æ–‡å­—*</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"emphasis\">_æ–œä½“æ–‡å­—_</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"strong\">**ç²—ä½“æ–‡å­—**</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"strong\">__ç²—ä½“æ–‡å­—__</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"strong\">**<span class=\"emphasis\">*ç²—æ–œä½“æ–‡å­—*</span>**</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"strong\">__<span class=\"emphasis\">_ç²—æ–œä½“æ–‡å­—_</span>__</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"Markdown-å¼•ç”¨\">Markdown å¼•ç”¨</h2>\n<figure class=\"highlight markdown\"><table><tr><td class=\"code\"><pre><span class=\"line\">&gt;è¿™æ˜¯å¼•ç”¨çš„å†…å®¹</span><br><span class=\"line\"></span><br><span class=\"line\">&gt;&gt;è¿™æ˜¯å¼•ç”¨çš„å†…å®¹</span><br><span class=\"line\"></span><br><span class=\"line\">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;è¿™æ˜¯å¼•ç”¨çš„å†…å®¹</span><br></pre></td></tr></table></figure>\n<h2 id=\"Markdown-åˆ†å‰²çº¿\">Markdown åˆ†å‰²çº¿</h2>\n<p>Â <strong>ä¸‰ä¸ªæˆ–è€…ä¸‰ä¸ªä»¥ä¸Šçš„ - æˆ–è€… * æˆ–è€… _ éƒ½å¯ä»¥</strong></p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"code\"><pre><span class=\"line\">---</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"strong\">****</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"strong\">____</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"Markdown-ä¸‹åˆ’çº¿\">Markdown ä¸‹åˆ’çº¿</h2>\n<figure class=\"highlight markdown\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">u</span>&gt;</span></span>å¸¦ä¸‹åˆ’çº¿æ–‡æœ¬<span class=\"language-xml\"><span class=\"tag\">&lt;/<span class=\"name\">u</span>&gt;</span></span>   </span><br></pre></td></tr></table></figure>\n<h2 id=\"Markdown-åˆ é™¤çº¿\">Markdown åˆ é™¤çº¿</h2>\n<figure class=\"highlight markdown\"><table><tr><td class=\"code\"><pre><span class=\"line\">~~tencent.com~~</span><br></pre></td></tr></table></figure>\n<h2 id=\"Markdown-å›¾ç‰‡\">Markdown å›¾ç‰‡</h2>\n<h3 id=\"æ’å…¥äº’è”ç½‘ä¸Šå›¾ç‰‡\">æ’å…¥äº’è”ç½‘ä¸Šå›¾ç‰‡</h3>\n<figure class=\"highlight markdown\"><table><tr><td class=\"code\"><pre><span class=\"line\">![<span class=\"string\">å›¾ç‰‡æè¿°</span>](<span class=\"link\">å›¾ç‰‡é“¾æ¥ &#x27;&#x27;å›¾ç‰‡title&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>å›¾ç‰‡æè¿°å°±æ˜¯æ˜¾ç¤ºåœ¨å›¾ç‰‡ä¸‹é¢çš„æ–‡å­—ï¼Œç›¸å½“äºå¯¹å›¾ç‰‡å†…å®¹çš„è§£é‡Šã€‚<br>\nå›¾ç‰‡titleæ˜¯å›¾ç‰‡çš„æ ‡é¢˜ï¼Œå½“é¼ æ ‡ç§»åˆ°å›¾ç‰‡ä¸Šæ—¶æ˜¾ç¤ºçš„å†…å®¹ã€‚<br>\næ³¨æ„ï¼štitleå¯åŠ å¯ä¸åŠ ï¼Œå›¾ç‰‡æè¿°å¯å†™å¯ä¸å†™ã€‚</p>\n</blockquote>\n<h3 id=\"æ’å…¥æœ¬åœ°å›¾ç‰‡\">æ’å…¥æœ¬åœ°å›¾ç‰‡</h3>\n<figure class=\"highlight markdown\"><table><tr><td class=\"code\"><pre><span class=\"line\">![<span class=\"string\">å›¾ç‰‡æè¿°</span>](<span class=\"link\">å›¾ç‰‡æœ¬åœ°è·¯å¾„ &#x27;&#x27;å›¾ç‰‡title&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>å›¾ç‰‡æè¿°å°±æ˜¯æ˜¾ç¤ºåœ¨å›¾ç‰‡ä¸‹é¢çš„æ–‡å­—ï¼Œç›¸å½“äºå¯¹å›¾ç‰‡å†…å®¹çš„è§£é‡Šã€‚<br>\nå›¾ç‰‡titleæ˜¯å›¾ç‰‡çš„æ ‡é¢˜ï¼Œå½“é¼ æ ‡ç§»åˆ°å›¾ç‰‡ä¸Šæ—¶æ˜¾ç¤ºçš„å†…å®¹ã€‚<br>\næ³¨æ„ï¼štitleå¯åŠ å¯ä¸åŠ ï¼Œå›¾ç‰‡æè¿°å¯å†™å¯ä¸å†™ã€‚</p>\n</blockquote>\n<h2 id=\"Markdown-è¶…é“¾æ¥\">Markdown è¶…é“¾æ¥</h2>\n<figure class=\"highlight markdown\"><table><tr><td class=\"code\"><pre><span class=\"line\">[<span class=\"string\">è¶…é“¾æ¥å</span>](<span class=\"link\">è¶…é“¾æ¥åœ°å€ &quot;è¶…é“¾æ¥title&quot;</span>)</span><br></pre></td></tr></table></figure>\n<p>Â <strong>æ³¨ï¼štitleå¯åŠ å¯ä¸åŠ </strong></p>\n<h2 id=\"Markdown-åˆ—è¡¨\">Markdown åˆ—è¡¨</h2>\n<h3 id=\"æ— åºåˆ—è¡¨\">æ— åºåˆ—è¡¨</h3>\n<p>Â <strong>æ— åºåˆ—è¡¨ç”¨ - + * ä»»ä½•ä¸€ç§éƒ½å¯ä»¥</strong></p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"bullet\">*</span> ç¬¬ä¸€é¡¹</span><br><span class=\"line\"><span class=\"bullet\">*</span> ç¬¬äºŒé¡¹</span><br><span class=\"line\"><span class=\"bullet\">*</span> ç¬¬ä¸‰é¡¹</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"bullet\">+</span> ç¬¬ä¸€é¡¹</span><br><span class=\"line\"><span class=\"bullet\">+</span> ç¬¬äºŒé¡¹</span><br><span class=\"line\"><span class=\"bullet\">+</span> ç¬¬ä¸‰é¡¹</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"bullet\">-</span> ç¬¬ä¸€é¡¹</span><br><span class=\"line\"><span class=\"bullet\">-</span> ç¬¬äºŒé¡¹</span><br><span class=\"line\"><span class=\"bullet\">-</span> ç¬¬ä¸‰é¡¹</span><br></pre></td></tr></table></figure>\n<h3 id=\"æœ‰åºåˆ—è¡¨\">æœ‰åºåˆ—è¡¨</h3>\n<figure class=\"highlight markdown\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"bullet\">1.</span> ç¬¬ä¸€é¡¹</span><br><span class=\"line\"><span class=\"bullet\">2.</span> ç¬¬äºŒé¡¹</span><br><span class=\"line\"><span class=\"bullet\">3.</span> ç¬¬ä¸‰é¡¹</span><br></pre></td></tr></table></figure>\n<h3 id=\"åµŒå¥—åˆ—è¡¨\">åµŒå¥—åˆ—è¡¨</h3>\n<p>Â <strong>ä¸Šä¸€çº§å’Œä¸‹ä¸€çº§ä¹‹é—´æ•²ä¸€ä¸ªTabé”®å³å¯</strong></p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"bullet\">1.</span> ç¬¬ä¸€é¡¹ï¼š</span><br><span class=\"line\"><span class=\"bullet\">    -</span> ç¬¬ä¸€é¡¹åµŒå¥—çš„ç¬¬ä¸€ä¸ªå…ƒç´ </span><br><span class=\"line\"><span class=\"bullet\">    -</span> ç¬¬ä¸€é¡¹åµŒå¥—çš„ç¬¬äºŒä¸ªå…ƒç´ </span><br><span class=\"line\"><span class=\"bullet\">2.</span> ç¬¬äºŒé¡¹ï¼š</span><br><span class=\"line\"><span class=\"bullet\">    -</span> ç¬¬äºŒé¡¹åµŒå¥—çš„ç¬¬ä¸€ä¸ªå…ƒç´ </span><br><span class=\"line\"><span class=\"bullet\">    -</span> ç¬¬äºŒé¡¹åµŒå¥—çš„ç¬¬äºŒä¸ªå…ƒç´ </span><br></pre></td></tr></table></figure>\n<h2 id=\"Markdown-è¡¨æ ¼\">Markdown è¡¨æ ¼</h2>\n<figure class=\"highlight markdown\"><table><tr><td class=\"code\"><pre><span class=\"line\">|è¡¨å¤´|è¡¨å¤´|è¡¨å¤´|</span><br><span class=\"line\">|---|:--:|---:|</span><br><span class=\"line\">|å†…å®¹|å†…å®¹|å†…å®¹|</span><br><span class=\"line\">|å†…å®¹|å†…å®¹|å†…å®¹|</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>ç¬¬äºŒè¡Œåˆ†å‰²è¡¨å¤´å’Œå†…å®¹<br>\n-æœ‰ä¸€ä¸ªå°±è¡Œï¼Œä¸ºäº†å¯¹é½ï¼Œå¤šåŠ äº†å‡ ä¸ª<br>\næ–‡å­—é»˜è®¤å±…å·¦<br>\n-ä¸¤è¾¹åŠ ï¼šè¡¨ç¤ºæ–‡å­—å±…ä¸­<br>\n-å³è¾¹åŠ ï¼šè¡¨ç¤ºæ–‡å­—å±…å³</p>\n</blockquote>\n<h2 id=\"Markdown-ä»£ç \">Markdown ä»£ç </h2>\n<h3 id=\"å•è¡Œä»£ç \">å•è¡Œä»£ç </h3>\n<figure class=\"highlight markdown\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"code\">`hello world`</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"ä»£ç å—\">ä»£ç å—</h3>\n<figure class=\"highlight markdown\"><table><tr><td class=\"code\"><pre><span class=\"line\">(<span class=\"code\">```)è¯­è¨€</span></span><br><span class=\"line\"><span class=\"code\">  ä»£ç å†…å®¹</span></span><br><span class=\"line\"><span class=\"code\">(```</span>)</span><br></pre></td></tr></table></figure>\n<h2 id=\"Markdown-æµç¨‹å›¾\">Markdown æµç¨‹å›¾</h2>\n<figure class=\"highlight markdown\"><table><tr><td class=\"code\"><pre><span class=\"line\">(<span class=\"code\">```)flow</span></span><br><span class=\"line\"><span class=\"code\">st=&gt;start: å¼€å§‹</span></span><br><span class=\"line\"><span class=\"code\">op=&gt;operation: My Operation</span></span><br><span class=\"line\"><span class=\"code\">cond=&gt;condition: Yes or No?</span></span><br><span class=\"line\"><span class=\"code\">e=&gt;end</span></span><br><span class=\"line\"><span class=\"code\">st-&gt;op-&gt;cond</span></span><br><span class=\"line\"><span class=\"code\">cond(yes)-&gt;e</span></span><br><span class=\"line\"><span class=\"code\">cond(no)-&gt;op</span></span><br><span class=\"line\"><span class=\"code\">(```</span>)</span><br></pre></td></tr></table></figure>\n<h2 id=\"Markdown-æ¢è¡Œ\">Markdown æ¢è¡Œ</h2>\n<figure class=\"highlight markdown\"><table><tr><td class=\"code\"><pre><span class=\"line\">è¿ç»­ä¸¤ä¸ªä»¥ä¸Šç©ºæ ¼+å›è½¦</span><br></pre></td></tr></table></figure>\n<p>Â <strong>æˆ–è€…</strong></p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"code\"><pre><span class=\"line\">ä½¿ç”¨htmlè¯­è¨€æ¢è¡Œæ ‡ç­¾<span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n<h2 id=\"Markdown-ç¼©è¿›å­—ç¬¦\">Markdown ç¼©è¿›å­—ç¬¦</h2>\n<figure class=\"highlight markdown\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"literal\">&amp;nbsp;</span>  ç¼©è¿›1/4ä¸­æ–‡</span><br><span class=\"line\"><span class=\"literal\">&amp;ensp;</span>  ç¼©è¿›åŠä¸ªä¸­æ–‡ï¼Œä¸€ä¸ªå­—ç¬¦</span><br><span class=\"line\"><span class=\"literal\">&amp;emsp;</span>  ç¼©è¿›ä¸€ä¸ªä¸­æ–‡ï¼Œ2ä¸ªå­—ç¬¦</span><br></pre></td></tr></table></figure>","tags":["Markdown"]},{"title":"LeNet5 å›¾åƒåˆ†ç±»ï¼ˆPyTorch æ¡†æ¶ï¼‰","url":"/post/1b5c5745.html","content":"<h1><a href=\"https://www.cnblogs.com/xing9/p/17997507/LeNet5-PyTorch\" title=\"å‘å¸ƒäº 2024-01-31 14:13\">æ‰‹æ’¸ä»£ç ï¼šä»é›¶å¼€å§‹çš„ LeNet5 å›¾åƒåˆ†ç±»ï¼ˆPyTorch æ¡†æ¶ï¼‰ </a></h1>\n<h2 id=\"æ‘˜è¦ï¼š\"><strong>æ‘˜è¦ï¼š</strong></h2>\n<p>æœ¬æ–‡ä»‹ç»äº†å¦‚ä½•ä»0å¼€å§‹æ„å»º LeNet5 å»è¯†åˆ«æ‰‹å†™æ•°å­—ï¼ˆåœ¨MNISTæ•°æ®é›†ä¸Šï¼‰ã€‚ä»£ç åŒ…æ‹¬ä¸‰å¤§éƒ¨åˆ†ï¼š<strong>ç½‘ç»œ</strong>ç»“æ„éƒ¨åˆ†ã€<strong>è®­ç»ƒ</strong>éƒ¨åˆ†ã€<strong>æµ‹è¯•</strong>éƒ¨åˆ†ã€‚åœ¨ç¼–LeNet5éƒ¨åˆ†ä»£ç ä¹‹å‰ï¼Œæœ¬æ–‡è¯¦ç»†åœ°æ¢³ç†äº†LeNet5çš„ç»“æ„ï¼Œå¯¹äºåˆå­¦è€…ååˆ†å‹å¥½ã€‚è®­ç»ƒå’Œæµ‹è¯•éƒ¨åˆ†ä¹Ÿéƒ½æœ‰è¯¦ç»†çš„ä»£ç è¯´æ˜ã€‚</p>\n<p>åœ¨å®ç° LeNet5 æ‰‹å†™æ•°å­—è¯†åˆ«çš„åŒæ—¶ï¼Œè¡¥å……äº†å¾ˆå¤šCNNçš„åŸºç¡€æ¦‚å¿µå’ŒPythonç¼–ç¨‹çŸ¥è¯†ã€‚åŒ…æ‹¬ï¼šPyTorchä¸­çš„å¸¸ç”¨åº“å’Œå…¶ä¸­çš„æ¨¡å—ï¼Œç‰¹å¾å›¾åœ¨å·ç§¯è¿‡ç¨‹ä¸­å°ºå¯¸å¦‚ä½•å˜åŒ–ï¼Œå¦‚ä½•æŠŠæ•°æ®åŠ è½½è¿›è®­ç»ƒç¨‹åºç­‰ã€‚</p>\n<p>æœ¬æ–‡ä¸æ˜¯é€šè¿‡å¤åˆ¶ç²˜è´´ä»£ç ä»‹ç»å¦‚ä½•å®ç° LeNet5 çš„æ‰‹å†™æ•°å­—è¯†åˆ«ï¼Œè€Œæ˜¯é€šè¿‡å†…åœ¨é€»è¾‘ï¼Œæ·±å±‚æ¬¡åœ°é˜è¿°è¿™ä¸€è¿‡ç¨‹ï¼ŒåŠ›æ±‚â€œçŸ¥å…¶ç„¶ï¼ŒçŸ¥å…¶æ‰€ä»¥ç„¶ã€‚â€</p>\n<p>å®Œæ•´ä»£ç å·²ç»ä¸Šä¼ è‡³GitHubï¼š<a href=\"https://github.com/TiezhuXing01/LeNet5_in_PyTorch.git\">https://github.com/TiezhuXing01/LeNet5_in_PyTorch.git</a></p>\n<hr>\n<p><strong>æ¸©é¦¨æç¤ºï¼š</strong><br>\nï¼ˆ1ï¼‰æœ¬æ–‡ä¸»è¦ä»‹ç»å¦‚ä½•ä»0å®ç°LeNet5ï¼Œæ³¨é‡ç¼–ç¨‹æ€è·¯çš„è®²è§£ï¼Œå¯¹äºä¸€äº›å‰ç½®çŸ¥è¯†ä¸åšèµ˜è¿°ã€‚<br>\nï¼ˆ2ï¼‰è¯·ç¡®ä¿ä½ å·²ç»<strong>é…ç½®å¥½</strong>å¹¶è¿›å…¥äº†æ·±åº¦å­¦ä¹ <strong>ç¯å¢ƒ</strong>ã€‚<br>\nï¼ˆ3ï¼‰ç›®å½•å¯¼èˆªè§é¡µé¢<strong>å³ä¸Šè§’</strong>é»„è‰²æ–¹å—ã€‚<br>\n<strong>å‰ç½®çŸ¥è¯†ï¼š</strong><br>\nï¼ˆ1ï¼‰æ¦‚å¿µï¼šPyTorchã€å·ç§¯ã€æ± åŒ–ã€å…¨è¿æ¥ã€ReLUã€å‰å‘ä¼ æ’­ã€åå‘ä¼ æ’­<br>\nï¼ˆ2ï¼‰å¯¹pythonè¯­æ³•æœ‰åŸºæœ¬çš„äº†è§£</p>\n<hr>\n<p>åœ¨ä»0å¼€å§‹ç¼–ç¨‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆæ€è€ƒä¸€ä¸‹ï¼Œä¸€ä¸ªç”±LeNet5å®Œæˆçš„å›¾åƒåˆ†ç±»ä»»åŠ¡ï¼ˆå¦‚ï¼šæ‰‹å†™æ•°å­—è¯†åˆ«ï¼‰ï¼Œéƒ½éœ€è¦å“ªäº›ç»„æˆéƒ¨åˆ†ï¼Ÿ</p>\n<p>é¦–å…ˆï¼Œè‚¯å®šè¦æœ‰<strong>LeNet5</strong>ç½‘ç»œç»“æ„çš„ä»£ç ã€‚<br>\nå…¶æ¬¡ï¼Œè¿˜è¦æœ‰åœ¨è®­ç»ƒé›†ä¸Š<strong>è®­ç»ƒ</strong>çš„ä»£ç ï¼Œè®©ç½‘ç»œå­¦ä¹ ç‰¹å¾è¡¨ç¤ºã€‚<br>\næœ€åï¼Œè®­ç»ƒå®Œè¦åœ¨æµ‹è¯•é›†ä¸Š<strong>æµ‹è¯•</strong>ï¼Œä¸ç„¶å’‹çŸ¥é“è®­ç»ƒå¾—æ•ˆæœæ€æ ·å‘¢ï¼Ÿ</p>\n<hr>\n<h2 id=\"1-å¼•å…¥åº“ï¼ˆImport-the-Librariesï¼‰\">1. å¼•å…¥åº“ï¼ˆImport the Librariesï¼‰</h2>\n<p>â€œåº“â€æ˜¯ä¸€ç»„å·²ç»å†™å¥½çš„ä»£ç ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªâ€œå·¥å…·ç®±â€ã€‚å¯¹äºæŸäº›åŠŸèƒ½çš„å®ç°ï¼Œå¼€å‘è€…å¯ä»¥ä»å¼•å…¥çš„â€œå·¥å…·ç®±â€ä¸­æ‹¿å‡ºå·¥å…·ç›´æ¥ä½¿ç”¨ï¼Œè€Œä¸æ˜¯ä»å¤´å¼€å§‹â€œé€ å·¥å…·â€ï¼ˆå³ç¼–ä»£ç ï¼‰ã€‚æ‰€ä»¥åœ¨æ‰€æœ‰å·¥ä½œä¹‹å‰ï¼Œè¦æŠŠâ€œå·¥å…·ç®±â€å¼•å…¥è¿›æ¥ï¼Œä»¥æ–¹ä¾¿åç»­ç¼–ç¨‹ã€‚ä½†æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬å¼•å…¥åº“æ—¶å¯èƒ½ä¼šæ¼æ‰ä¸€äº›åº“ï¼Œåœ¨ç¼–ç¨‹åˆ°åé¢æ‰æ„è¯†åˆ°ã€‚ä¸ç”¨æ‹…å¿ƒï¼Œæˆ‘ä»¬å†å›åˆ°å¼€å¤´è¿™é‡Œå¼•å…¥åº“å°±å¥½äº†ã€‚</p>\n<figure class=\"highlight haskell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> torch</span><br><span class=\"line\"><span class=\"keyword\">import</span> torch.nn <span class=\"keyword\">as</span> nn</span><br><span class=\"line\"><span class=\"keyword\">import</span> torchvision</span><br><span class=\"line\"><span class=\"keyword\">import</span> torchvision.transforms <span class=\"keyword\">as</span> transforms</span><br></pre></td></tr></table></figure>\n<ul>\n<li>\n<p><code>torch</code>åº“æä¾›äº†å„ç§ç”¨äºå¼ é‡ï¼ˆtensorï¼‰æ“ä½œã€ç¥ç»ç½‘ç»œæ­å»ºã€ä¼˜åŒ–ç®—æ³•ç­‰æ–¹é¢çš„å‡½æ•°ã€‚<br>\nä»€ä¹ˆæ˜¯å¼ é‡ï¼Ÿå¦‚æœä½ å¯¹å¼ é‡ï¼ˆtensorï¼‰ä¸äº†è§£ï¼Œä¸ç”¨æ‹…å¿ƒï¼Œä½ åªéœ€è¦è®°ä½è¿™æ˜¯å›¾ç‰‡ç»è¿‡æŸç§å¤„ç†ä¹‹åçš„ä¸€ç§å½¢å¼ï¼Œå°±åƒä½ å·²çŸ¥çš„å›¾ç‰‡æœ‰.jpgå’Œ.pngæ ¼å¼ä¸€æ ·ã€‚ä½†å¯¹äº.jpgå’Œ.pngæ ¼å¼çš„å›¾åƒï¼Œç¥ç»ç½‘ç»œå¹¶ä¸å–œæ¬¢ï¼Œæ— æ³•ç›´æ¥å¤„ç†å®ƒä»¬ã€‚è€Œå¼ é‡ï¼ˆtensorï¼‰è¿™ç§å½¢å¼ï¼Œé€‚ç”¨äºç¥ç»ç½‘ç»œçš„å¤„ç†ã€‚</p>\n</li>\n<li>\n<p><code>torch.nn</code>åº“å¯ä»¥ç†è§£ä¸ºå¤§å·¥å…·ç®±<code>torch</code>é‡Œé¢çš„å°å·¥å…·ç®±<code>nn</code>ã€‚è¿™ä¸ªæ¨¡å—é‡ŒåŒ…å«æ„å»ºç¥ç»ç½‘ç»œå±‚å’Œæ¨¡å‹çš„ç±»å’Œå‡½æ•°ã€‚<code>import torch.nn as nn</code>è¡¨ç¤ºï¼Œå¼•å…¥ä¹‹åï¼Œæ¨¡å—<code>torch.nn</code>çš„åå­—å°±å¯ä»¥ç®€ç§°<code>nn</code>äº†ã€‚</p>\n</li>\n<li>\n<p><code>torchvision</code>åº“æä¾›äº†ä¸€ç³»åˆ—ç”¨äºå›¾åƒå¤„ç†ã€è®¡ç®—æœºè§†è§‰æ•°æ®é›†åŠ è½½ã€å›¾åƒå˜æ¢ã€ä»¥åŠè®¸å¤šæµè¡Œçš„è®¡ç®—æœºè§†è§‰æ¨¡å‹çš„å®ç°ã€‚</p>\n</li>\n<li>\n<p><code>torchvision.transforms</code>æ¨¡å—ç”¨äºè¿›è¡Œå›¾åƒçš„å˜æ¢å’Œé¢„å¤„ç†ã€‚è¿™ä¸ªæ¨¡å—åŒ…å«äº†ä¸€ç³»åˆ—ç”¨äºå¤„ç†å›¾åƒçš„è½¬æ¢å‡½æ•°ï¼Œå¯ç”¨äºæ•°æ®å¢å¼ºã€æ•°æ®æ¸…ç†å’Œå‡†å¤‡å›¾åƒæ•°æ®ä»¥è¾“å…¥ç¥ç»ç½‘ç»œç­‰ä»»åŠ¡ã€‚</p>\n</li>\n</ul>\n<hr>\n<h2 id=\"2-é€‰æ‹©åœ¨å“ªä¸ªè®¾å¤‡ä¸Šè®­ç»ƒæ¨¡å‹ï¼ˆGPUæˆ–CPUï¼‰\">2. é€‰æ‹©åœ¨å“ªä¸ªè®¾å¤‡ä¸Šè®­ç»ƒæ¨¡å‹ï¼ˆGPUæˆ–CPUï¼‰</h2>\n<p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½ä¼šé€‰æ‹©åœ¨GPUä¸Šè®­ç»ƒç½‘ç»œæ¨¡å‹ï¼Œå› ä¸ºç¥ç»ç½‘ç»œçš„è®­ç»ƒéœ€è¦å¤§é‡çš„è®¡ç®—ï¼Œè€Œè‹±ä¼Ÿè¾¾çš„GPUæä¾›äº†CUDAï¼ˆä¸€ä¸ªåŠ é€Ÿè®¡ç®—åº“ï¼‰ã€‚ä½†å¦‚æœä½ çš„ç”µè„‘æ˜¾å¡æ˜¯AMDçš„ï¼Œé‚£ä¹ˆæœ‰å¾ˆå¤§æ¦‚ç‡ä¸æ”¯æŒä½¿ç”¨CUDAï¼Œæ­¤æ—¶åªèƒ½ç”¨CPUè®­ç»ƒã€‚ä½†åœ¨CPUä¸Šè®­ç»ƒæ¨¡å‹æ˜¯ååˆ†ç¼“æ…¢çš„ã€‚å¦‚æœä½ æš‚æ—¶æ²¡æ³•æ¢ç”µè„‘ï¼Œé‚£æˆ‘å»ºè®®ä½ å»ç§Ÿä¸€ä¸ªæœåŠ¡å™¨ã€‚æˆ–è€…ä½¿ç”¨é˜¿é‡Œäº‘ã€ç™¾åº¦é£æ¡¨ã€è°·æ­ŒColabç­‰å¹³å°ã€‚</p>\n<figure class=\"highlight ini\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">device</span> = torch.device(<span class=\"string\">&#x27;cuda&#x27;</span> if torch.cuda.is_available() else <span class=\"string\">&#x27;cpu&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<ul>\n<li>\n<p><code>torch.cuda.is_available()</code>å‡½æ•°çš„åŠŸèƒ½æ˜¯æ£€æŸ¥ç³»ç»Ÿä¸­æ˜¯å¦å®‰è£…äº†å¯ç”¨çš„ CUDAå¹¶ä¸” GPU æ˜¯å¯ç”¨çš„ã€‚å¦‚æœ GPU å¯ç”¨ï¼Œè¿”å› Trueï¼Œå¦åˆ™è¿”å› Falseã€‚</p>\n</li>\n<li>\n<p><code>'cuda' if torch.cuda.is_available() else 'cpu'</code>è¡¨ç¤ºå¦‚æœGPUå¯ç”¨ï¼Œåˆ™è¿”å›å­—ç¬¦ä¸²<code>'cuda'</code>ã€‚å¦‚æœä¸å¯ç”¨ï¼Œåˆ™è¿”å›å­—ç¬¦ä¸²<code>'cpu'</code>ã€‚</p>\n</li>\n<li>\n<p>å¦‚æœå‡½æ•°<code>torch.device(...)</code>æ¥æ”¶åˆ°çš„æ˜¯<code>'cuda'</code>ï¼Œåˆ™é€‰æ‹©åœ¨GPUä¸Šè®¡ç®—ï¼Œå¦‚æœæ¥æ”¶åˆ°çš„æ˜¯<code>'cpu'</code>ï¼Œåˆ™é€‰æ‹©åœ¨CPUä¸Šè¿›è¡Œè®¡ç®—ã€‚</p>\n</li>\n</ul>\n<hr>\n<h2 id=\"3-è®¤è¯†ç½‘ç»œ\">3. è®¤è¯†ç½‘ç»œ</h2>\n<p>å……åˆ†åœ°è®¤è¯†ç½‘ç»œï¼Œæ‰èƒ½åœ¨ç¼–ç¨‹æ—¶æ€è·¯æ¸…æ™°ã€æ¸¸åˆƒæœ‰ä½™ã€‚ä¸‹å›¾æ˜¯LeNet5çš„ç»“æ„å›¾ï¼Œè¯·ä½ ç›´è§‚åœ°è®¤è¯†ä¸€ä¸‹LeNet5ã€‚å¦‚æœä½ ä¸æƒ³äº†è§£ï¼Œå¯ä»¥ç›´æ¥å» 4. æ„å»ºç½‘ç»œï¼Œä¸è¿‡æˆ‘ä¸å»ºè®®ä½ è¿™æ ·ã€‚<br>\næœ¬ä¾‹ä¸­LeNet5å¤„ç†çš„MNISTæ•°æ®é›†å›¾ç‰‡å°ºå¯¸éƒ½æ˜¯32Ã—32. æ‰€ä»¥ä¸‹å›¾çš„è¾“å…¥å›¾ç‰‡æ˜¯32Ã—32.</p>\n<p><img src=\"https://s2.loli.net/2024/12/26/QN6wUGncvDbgiyY.png\" alt=\"\"></p>\n<p>æˆ‘æŠŠä¸Šå›¾çš„ç½‘ç»œç»“æ„å…·ä½“ä¸ºä¸‹é¢çš„è¡¨æ ¼ï¼Œä»¥ä¾¿æˆ‘ä»¬åç»­ç¼–ç¨‹ã€‚æ³¨æ„ï¼šç”»è¡¨æ ¼å¹¶ä¸æ˜¯ç¼–ç¨‹æ‰€éœ€çš„å¿…è¦æ­¥éª¤ï¼Œåªæ˜¯æˆ‘å¸Œæœ›è¡¨è¾¾å¾—æ›´æ¸…æ™°ã€‚</p>\n<table>\n<thead>\n<tr>\n<th>å±‚çš„åç§°</th>\n<th>å…·ä½“æ“ä½œ</th>\n<th>è¾“å…¥é€šé“æ•°</th>\n<th>è¾“å‡ºé€šé“æ•°</th>\n<th>æ ¸æˆ–æ± çš„å°ºå¯¸</th>\n<th>æ­¥å¹…</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>å·ç§¯å±‚1</td>\n<td>å·ç§¯</td>\n<td>1</td>\n<td>6</td>\n<td>5Ã—5</td>\n<td>1</td>\n</tr>\n<tr>\n<td></td>\n<td>æ‰¹å½’ä¸€åŒ–</td>\n<td>6</td>\n<td>6</td>\n<td>â€“</td>\n<td>â€“</td>\n</tr>\n<tr>\n<td></td>\n<td>ReLU</td>\n<td>6</td>\n<td>6</td>\n<td>â€“</td>\n<td>â€“</td>\n</tr>\n<tr>\n<td>ä¸‹é‡‡æ ·</td>\n<td>æœ€å¤§æ± åŒ–</td>\n<td>6</td>\n<td>6</td>\n<td>2Ã—2</td>\n<td>2</td>\n</tr>\n<tr>\n<td>å·ç§¯å±‚2</td>\n<td>å·ç§¯</td>\n<td>6</td>\n<td>16</td>\n<td>5Ã—5</td>\n<td>1</td>\n</tr>\n<tr>\n<td></td>\n<td>æ‰¹å½’ä¸€åŒ–</td>\n<td>16</td>\n<td>16</td>\n<td>â€“</td>\n<td>â€“</td>\n</tr>\n<tr>\n<td></td>\n<td>ReLU</td>\n<td>16</td>\n<td>16</td>\n<td>â€“</td>\n<td>â€“</td>\n</tr>\n<tr>\n<td>ä¸‹é‡‡æ ·</td>\n<td>æœ€å¤§æ± åŒ–</td>\n<td>16</td>\n<td>16</td>\n<td>2Ã—2</td>\n<td>2</td>\n</tr>\n<tr>\n<td>å…¨è¿æ¥å±‚1</td>\n<td>å…¨è¿æ¥</td>\n<td>400</td>\n<td>120</td>\n<td>â€“</td>\n<td>â€“</td>\n</tr>\n<tr>\n<td></td>\n<td>ReLU</td>\n<td>120</td>\n<td>120</td>\n<td>â€“</td>\n<td>â€“</td>\n</tr>\n<tr>\n<td>å…¨è¿æ¥å±‚2</td>\n<td>å…¨è¿æ¥</td>\n<td>120</td>\n<td>84</td>\n<td>â€“</td>\n<td>â€“</td>\n</tr>\n<tr>\n<td></td>\n<td>ReLU</td>\n<td>84</td>\n<td>84</td>\n<td>â€“</td>\n<td>â€“</td>\n</tr>\n<tr>\n<td>é«˜æ–¯è¿æ¥</td>\n<td>å…¨è¿æ¥</td>\n<td>84</td>\n<td>ç±»åˆ«æ€»æ•°10</td>\n<td>â€“</td>\n<td>â€“</td>\n</tr>\n</tbody>\n</table>\n<p>ä¸‹é¢æˆ‘ä»¬æ¢³ç†ä¸€ä¸‹LeNet5çš„è¯¦ç»†æµç¨‹ï¼Œè¿™æ ·åˆ°åé¢ç¼–ç¨‹çš„æ—¶å€™ä¸ä¼šæ‡µã€‚</p>\n<hr>\n<h3 id=\"ï¼ˆ1ï¼‰å·ç§¯å±‚1ï¼šæå–ä½çº§ç‰¹å¾\">ï¼ˆ1ï¼‰å·ç§¯å±‚1ï¼šæå–ä½çº§ç‰¹å¾</h3>\n<h4 id=\"a-ç¬¬ä¸€æ¬¡å·ç§¯\">a) ç¬¬ä¸€æ¬¡å·ç§¯</h4>\n<p>åœ¨å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œç¬¬ä¸€æ¬¡å·ç§¯æ“ä½œä¹‹åï¼Œä¸ä»…é€šé“<strong>ç”±1å˜6</strong>ï¼ŒåŸå›¾32Ã—32çš„å°ºå¯¸ä¹Ÿå˜æˆäº†28Ã—28ï¼Œè¿™ä¸å·ç§¯æ ¸å¤§å°ã€æ­¥å¹…å’Œ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mi>a</mi><mi>d</mi><mi>d</mi><mi>i</mi><mi>n</mi><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">padding</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">dd</span><span class=\"mord mathnormal\">in</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span> æœ‰å…³ï¼ˆLeNet5ä¸­ï¼Œ2æ¬¡å·ç§¯paddingéƒ½ä¸º0ï¼‰ã€‚è¾“å‡ºç‰¹å¾å›¾åƒå°ºå¯¸å…¬å¼å¦‚ä¸‹ï¼š<br>\n<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>o</mi><mi>u</mi><mi>t</mi><mi>p</mi><mi>u</mi><mi>t</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo>=</mo><mfrac><mrow><mi>W</mi><mo>âˆ’</mo><mi>k</mi><mi>e</mi><mi>r</mi><mi>n</mi><mi>e</mi><mi>l</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo>+</mo><mn>2</mn><mo>âˆ—</mo><mi>p</mi><mi>a</mi><mi>d</mi><mi>d</mi><mi>i</mi><mi>n</mi><mi>g</mi></mrow><mrow><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>d</mi><mi>e</mi></mrow></mfrac><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">output size=\\frac{W-kernel size+2*padding}{stride}+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">tp</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">ze</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2772em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9322em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\">e</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.4461em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">W</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">er</span><span class=\"mord mathnormal mtight\">n</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">ze</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">2</span><span class=\"mbin mtight\">âˆ—</span><span class=\"mord mathnormal mtight\">p</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">dd</span><span class=\"mord mathnormal mtight\">in</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">g</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span><br>\nå…¶ä¸­ï¼Œ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>W</mi></mrow><annotation encoding=\"application/x-tex\">W</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span></span></span></span> è¡¨ç¤ºè¾“å…¥å›¾åƒçš„å®½åº¦ã€‚</p>\n<p>å°†æ•°ä»£å…¥å…¬å¼ï¼š<br>\n<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>o</mi><mi>u</mi><mi>t</mi><mi>p</mi><mi>u</mi><mi>t</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo>=</mo><mfrac><mrow><mn>32</mn><mo>âˆ’</mo><mn>5</mn><mo>+</mo><mn>2</mn><mo>âˆ—</mo><mn>0</mn></mrow><mn>1</mn></mfrac><mo>+</mo><mn>1</mn><mo>=</mo><mn>28</mn></mrow><annotation encoding=\"application/x-tex\">output size=\\frac{32-5+2*0}{1}+1=28</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">tp</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">ze</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">32</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">5</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">2</span><span class=\"mbin mtight\">âˆ—</span><span class=\"mord mtight\">0</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">28</span></span></span></span></p>\n<h4 id=\"b-æ‰¹å½’ä¸€åŒ–\">b) æ‰¹å½’ä¸€åŒ–</h4>\n<p>æ‰¹å½’ä¸€åŒ– (Batch Normalization) æ˜¯ä¸€ç§ç”¨äºæé«˜ç¥ç»ç½‘ç»œè®­ç»ƒç¨³å®šæ€§å’ŒåŠ é€Ÿæ”¶æ•›çš„æ–¹æ³•ã€‚åœ¨å·ç§¯ç¥ç»ç½‘ç»œä¸­ï¼Œæ¯ä¸ªé€šé“éƒ½æœ‰ä¸€ä¸ªç‹¬ç«‹çš„å½’ä¸€åŒ–å‚æ•°ã€‚å› æ­¤è¾“å…¥æ˜¯6é€šé“ï¼Œè¾“å‡ºè¿˜æ˜¯<strong>6</strong>é€šé“ã€‚</p>\n<h4 id=\"c-ReLUæ¿€æ´»å‡½æ•°\">c) ReLUæ¿€æ´»å‡½æ•°</h4>\n<p>äº§ç”Ÿéçº¿æ€§æ˜ å°„ï¼Œé€šé“æ•°è¿˜æ˜¯<strong>6</strong>ï¼Œä¸å˜ã€‚</p>\n<hr>\n<h3 id=\"ï¼ˆ2ï¼‰ä¸‹é‡‡æ ·\">ï¼ˆ2ï¼‰ä¸‹é‡‡æ ·</h3>\n<p>æœ€å¤§æ± åŒ–ï¼Œé€šé“æ•°ä¸å˜ï¼Œè¿˜æ˜¯<strong>6</strong>ï¼Œç‰¹å¾å›¾å°ºå¯¸ç”±28Ã—28ä¸‹é™åˆ°14Ã—14. è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š<br>\n<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>o</mi><mi>u</mi><mi>t</mi><mi>p</mi><mi>u</mi><mi>t</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo>=</mo><mfrac><mrow><mi>W</mi><mo>âˆ’</mo><mi>p</mi><mi>o</mi><mi>o</mi><mi>l</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi></mrow><mrow><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>d</mi><mi>e</mi></mrow></mfrac><mo>+</mo><mn>1</mn><mo>=</mo><mfrac><mrow><mn>28</mn><mo>âˆ’</mo><mn>2</mn></mrow><mn>2</mn></mfrac><mo>+</mo><mn>1</mn><mo>=</mo><mn>14</mn></mrow><annotation encoding=\"application/x-tex\">output size=\\frac{W-pool size}{stride}+1=\\frac{28-2}{2}+1=14</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">tp</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">ze</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2772em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9322em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\">e</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.4461em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">W</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mathnormal mtight\">p</span><span class=\"mord mathnormal mtight\">oo</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">ze</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">28</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">14</span></span></span></span></p>\n<hr>\n<h3 id=\"ï¼ˆ3ï¼‰å·ç§¯å±‚2ï¼šæå–é«˜çº§ç‰¹å¾\">ï¼ˆ3ï¼‰å·ç§¯å±‚2ï¼šæå–é«˜çº§ç‰¹å¾</h3>\n<h4 id=\"a-ç¬¬äºŒæ¬¡å·ç§¯\">a) ç¬¬äºŒæ¬¡å·ç§¯</h4>\n<p>é€šé“ç”±6å˜<strong>16</strong>ï¼Œè¾“å‡ºç‰¹å¾å›¾å°ºå¯¸ä¸º10Ã—10.å…·ä½“è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š<br>\n<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>o</mi><mi>u</mi><mi>t</mi><mi>p</mi><mi>u</mi><mi>t</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo>=</mo><mfrac><mrow><mi>W</mi><mo>âˆ’</mo><mi>k</mi><mi>e</mi><mi>r</mi><mi>n</mi><mi>e</mi><mi>l</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo>+</mo><mn>2</mn><mo>âˆ—</mo><mi>p</mi><mi>a</mi><mi>d</mi><mi>d</mi><mi>i</mi><mi>n</mi><mi>g</mi></mrow><mrow><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>d</mi><mi>e</mi></mrow></mfrac><mo>+</mo><mn>1</mn><mo>=</mo><mfrac><mrow><mn>14</mn><mo>âˆ’</mo><mn>5</mn><mo>+</mo><mn>2</mn><mo>âˆ—</mo><mn>0</mn></mrow><mn>1</mn></mfrac><mo>+</mo><mn>1</mn><mo>=</mo><mn>10</mn></mrow><annotation encoding=\"application/x-tex\">output size=\\frac{W-kernel size+2*padding}{stride}+1=\\frac{14-5+2*0}{1}+1=10</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">tp</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">ze</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2772em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9322em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\">e</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.4461em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">W</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">er</span><span class=\"mord mathnormal mtight\">n</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">ze</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">2</span><span class=\"mbin mtight\">âˆ—</span><span class=\"mord mathnormal mtight\">p</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">dd</span><span class=\"mord mathnormal mtight\">in</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">g</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">14</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">5</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">2</span><span class=\"mbin mtight\">âˆ—</span><span class=\"mord mtight\">0</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">10</span></span></span></span></p>\n<h4 id=\"b-æ‰¹å½’ä¸€åŒ–-ReLU\">b) æ‰¹å½’ä¸€åŒ–+ReLU</h4>\n<p>è¾“å‡ºé€šé“è¿˜æ˜¯<strong>16</strong>ã€‚</p>\n<hr>\n<h3 id=\"ï¼ˆ4ï¼‰ä¸‹é‡‡æ ·\">ï¼ˆ4ï¼‰ä¸‹é‡‡æ ·</h3>\n<p>ç‰¹å¾å›¾å°ºå¯¸ç”±10Ã—10å˜æˆ5Ã—5ï¼Œè¾“å‡ºé€šé“è¿˜æ˜¯<strong>16</strong>ã€‚<br>\n<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>o</mi><mi>u</mi><mi>t</mi><mi>p</mi><mi>u</mi><mi>t</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo>=</mo><mfrac><mrow><mi>W</mi><mo>âˆ’</mo><mi>p</mi><mi>o</mi><mi>o</mi><mi>l</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi></mrow><mrow><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>d</mi><mi>e</mi></mrow></mfrac><mo>+</mo><mn>1</mn><mo>=</mo><mfrac><mrow><mn>10</mn><mo>âˆ’</mo><mn>2</mn></mrow><mn>2</mn></mfrac><mo>+</mo><mn>1</mn><mo>=</mo><mn>5</mn></mrow><annotation encoding=\"application/x-tex\">output size=\\frac{W-pool size}{stride}+1=\\frac{10-2}{2}+1=5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">tp</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">ze</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2772em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9322em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\">e</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.4461em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">W</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mathnormal mtight\">p</span><span class=\"mord mathnormal mtight\">oo</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">ze</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">10</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">5</span></span></span></span></p>\n<hr>\n<h3 id=\"ï¼ˆ5ï¼‰å…¨è¿æ¥å±‚1\">ï¼ˆ5ï¼‰å…¨è¿æ¥å±‚1</h3>\n<p>å°†è¾“å…¥ç»´åº¦ä¸º 400 çš„å‘é‡ï¼ˆä¸€ç»´æ•°ç»„ï¼‰æ˜ å°„åˆ°ç»´åº¦ä¸º 120 çš„è¾“å‡ºå‘é‡ã€‚<br>\nå…¶ä¸­ï¼Œ400ä¸º16ä¸ªé€šé“çš„5Ã—5å¤§å°çš„æ‰€æœ‰åƒç´ æ•°é‡ã€‚<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>16</mn><mo>âˆ—</mo><mn>5</mn><mo>âˆ—</mo><mn>5</mn><mo>=</mo><mn>400</mn></mrow><annotation encoding=\"application/x-tex\">16*5*5=400</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">16</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">5</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">5</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">400</span></span></span></span><br>\n120æ˜¯ç ”ç©¶äººå‘˜é€šè¿‡åœ¨å®éªŒä¸­ä¸æ–­è°ƒæ•´å¾—åˆ°çš„ã€‚</p>\n<h3 id=\"ï¼ˆ6ï¼‰å…¨è¿æ¥å±‚2\">ï¼ˆ6ï¼‰å…¨è¿æ¥å±‚2</h3>\n<p>å°†å‰ä¸€å±‚çš„ 120 ä¸ªèŠ‚ç‚¹æ˜ å°„åˆ° 84 ä¸ªèŠ‚ç‚¹ã€‚</p>\n<h3 id=\"ï¼ˆ7ï¼‰é«˜æ–¯è¿æ¥ï¼ˆå…¨è¿æ¥å±‚3ï¼‰\">ï¼ˆ7ï¼‰é«˜æ–¯è¿æ¥ï¼ˆå…¨è¿æ¥å±‚3ï¼‰</h3>\n<p>å°†84ä¸ªèŠ‚ç‚¹æ˜ å°„åˆ°10ä¸ªå…·ä½“ç±»åˆ«ä¸Šï¼Œå³0~9è¿™10ä¸ªæ•°å­—ä¸Šã€‚</p>\n<hr>\n<h2 id=\"4-æ­å»ºç½‘ç»œ\">4. æ­å»ºç½‘ç»œ</h2>\n<p>åœ¨æ­å»ºä¹‹å‰ï¼Œæˆ‘å°†ä»‹ç»ä¸€ä¸ªâ€œå·¥å…·â€ã€‚<code>nn.Sequential()</code>æ˜¯ PyTorch ä¸­ç”¨äºæ„å»ºå®¹å™¨ï¼ˆcontainerï¼‰çš„ç±»ã€‚é€šä¿—åœ°è®²ï¼Œè¿™ä¸ªå·¥å…·çš„ä½œç”¨å°±æ˜¯æŠŠå¥½å‡ ä¸ªæ“ä½œä¸²åˆ°ä¸€èµ·ï¼ŒæŒ‰é¡ºåºæ‰§è¡Œã€‚</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># å®šä¹‰åä¸º LeNet5 çš„ç±»ï¼Œè¯¥ç±»ç»§æ‰¿è‡ª nn.Module</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">LeNet5</span>(nn.Module):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, num_classes</span>):</span><br><span class=\"line\">        <span class=\"built_in\">super</span>(LeNet5, <span class=\"variable language_\">self</span>).__init__()</span><br><span class=\"line\">        <span class=\"comment\"># å·ç§¯å±‚ 1</span></span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.layer1 = nn.Sequential(</span><br><span class=\"line\">            nn.Conv2d(<span class=\"number\">1</span>, <span class=\"number\">6</span>, kernel_size=<span class=\"number\">5</span>, stride=<span class=\"number\">1</span>, padding=<span class=\"number\">0</span>),    <span class=\"comment\"># å·ç§¯</span></span><br><span class=\"line\">            nn.BatchNorm2d(<span class=\"number\">6</span>),      <span class=\"comment\"># æ‰¹å½’ä¸€åŒ–</span></span><br><span class=\"line\">            nn.ReLU(),)</span><br><span class=\"line\">        <span class=\"comment\"># ä¸‹é‡‡æ ·</span></span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.subsampel1 = nn.MaxPool2d(kernel_size = <span class=\"number\">2</span>, stride = <span class=\"number\">2</span>)     <span class=\"comment\"># æœ€å¤§æ± åŒ–</span></span><br><span class=\"line\">        <span class=\"comment\"># å·ç§¯å±‚ 2</span></span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.layer2 = nn.Sequential(</span><br><span class=\"line\">            nn.Conv2d(<span class=\"number\">6</span>, <span class=\"number\">16</span>, kernel_size=<span class=\"number\">5</span>, stride=<span class=\"number\">1</span>, padding=<span class=\"number\">0</span>),</span><br><span class=\"line\">            nn.BatchNorm2d(<span class=\"number\">16</span>),</span><br><span class=\"line\">            nn.ReLU(),)</span><br><span class=\"line\">        <span class=\"comment\"># ä¸‹é‡‡æ ·</span></span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.subsampel2 = nn.MaxPool2d(kernel_size = <span class=\"number\">2</span>, stride = <span class=\"number\">2</span>)</span><br><span class=\"line\">        <span class=\"comment\"># å…¨è¿æ¥</span></span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.L1 = nn.Linear(<span class=\"number\">400</span>, <span class=\"number\">120</span>)</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.relu = nn.ReLU()</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.L2 = nn.Linear(<span class=\"number\">120</span>, <span class=\"number\">84</span>)</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.relu1 = nn.ReLU()</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.L3 = nn.Linear(<span class=\"number\">84</span>, num_classes)</span><br><span class=\"line\">    <span class=\"comment\"># å‰å‘ä¼ æ’­</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">forward</span>(<span class=\"params\">self, x</span>):</span><br><span class=\"line\">        out = <span class=\"variable language_\">self</span>.layer1(x)</span><br><span class=\"line\">        out = <span class=\"variable language_\">self</span>.subsampel1(out)</span><br><span class=\"line\">        out = <span class=\"variable language_\">self</span>.layer2(out)</span><br><span class=\"line\">        out = <span class=\"variable language_\">self</span>.subsampel2(out)</span><br><span class=\"line\">        <span class=\"comment\"># å°†ä¸Šä¸€æ­¥è¾“å‡ºçš„16ä¸ª5Ã—5ç‰¹å¾å›¾ä¸­çš„400ä¸ªåƒç´ å±•å¹³æˆä¸€ç»´å‘é‡ï¼Œä»¥ä¾¿ä¸‹ä¸€æ­¥å…¨è¿æ¥</span></span><br><span class=\"line\">        out = out.reshape(out.size(<span class=\"number\">0</span>), -<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"comment\"># å…¨è¿æ¥</span></span><br><span class=\"line\">        out = <span class=\"variable language_\">self</span>.L1(out)</span><br><span class=\"line\">        out = <span class=\"variable language_\">self</span>.relu(out)</span><br><span class=\"line\">        out = <span class=\"variable language_\">self</span>.L2(out)</span><br><span class=\"line\">        out = <span class=\"variable language_\">self</span>.relu1(out)</span><br><span class=\"line\">        out = <span class=\"variable language_\">self</span>.L3(out)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> out</span><br></pre></td></tr></table></figure>\n<p>å‘ç°æ²¡æœ‰ï¼Ÿå¥—è·¯å°±æ˜¯ï¼šå…ˆself.å„ç§å±‚ï¼Œä¸€é¡¿å®šä¹‰ã€‚ç„¶ååˆ°å‰å‘ä¼ æ’­ï¼ˆ<code>forward</code>ï¼‰é‚£é‡Œï¼Œå¼€å§‹ç”¨ä¸Šä¸€æ­¥å®šä¹‰çš„<code>self.something()</code>ã€‚æœ€åï¼Œ<code>return out</code>è¿”å›è¾“å‡ºå€¼ã€‚</p>\n<p>å¯¹äºåˆå­¦è€…è€Œè¨€ï¼Œå¦‚æœPythonåŸºç¡€ä¸ç‰¢ï¼Œæœ€å¼€å§‹é‚£ä¸‰è¡Œä»£ç ç†è§£èµ·æ¥å¯èƒ½æ¯”è¾ƒåƒåŠ›ã€‚å…¶å®ç”¨å¤šäº†å°±ä¼šå‘ç°ï¼Œè¿™å°±æ˜¯ä¸ªå¥—è·¯ï¼Œä¸ç†è§£ä¹Ÿä¸è€½è¯¯ç¼–ç¨‹ã€‚</p>\n<hr>\n<p>æ­¤å¤„å±•å¼€å‰ä¸‰è¡Œä»£ç </p>\n<figure class=\"highlight haskell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"type\">LeNet5</span>(<span class=\"title\">nn</span>.<span class=\"type\">Module</span>):</span></span><br><span class=\"line\"><span class=\"class\">    def __init__(<span class=\"title\">self</span>, <span class=\"title\">num_classes</span>):</span></span><br><span class=\"line\"><span class=\"class\">        super(<span class=\"type\">LeNet5</span>, <span class=\"title\">self</span>).__init__()</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>\n<p>æˆ‘ä»¬æ¥çœ‹ç¬¬ä¸€è¡Œä»£ç ã€‚è¿™è¡Œä»£ç å®šä¹‰äº†ä¸€ä¸ªåä¸º <code>LeNet5</code> çš„ç±»ï¼Œå®ƒç»§æ‰¿è‡ª <code>nn.Module</code>ï¼ˆåˆ«å¿˜äº†ï¼Œåœ¨æœ€å¼€å§‹å¼•å…¥åº“æ—¶ï¼Œå¼•å…¥è¿‡<code>nn</code>ï¼‰ï¼Œè¯´æ˜è¿™æ˜¯ä¸€ä¸ª PyTorch æ¡†æ¶ä¸­ç¥ç»ç½‘ç»œæ¨¡å‹çš„åŸºç±»ã€‚æ‰€æœ‰çš„ç¥ç»ç½‘ç»œæ¨¡å‹éƒ½åº”è¯¥ç»§æ‰¿è‡ª <code>nn.Module</code>ï¼Œè¿™æ ·å®ƒä»¬å°±èƒ½å¤Ÿåˆ©ç”¨ PyTorch æä¾›çš„æ¨¡å‹ç®¡ç†å’Œè®­ç»ƒçš„åŠŸèƒ½ã€‚</p>\n</li>\n<li>\n<p>ç¬¬äºŒè¡Œä»£ç ï¼šæ˜¯ç±»çš„æ„é€ å‡½æ•°ï¼ˆinitializerï¼‰ã€‚æ„é€ å‡½æ•°ç”¨äºåˆå§‹åŒ–ç±»çš„å®ä¾‹ã€‚<code>num_classes</code>æ˜¯ç±»åˆ«æ•°ï¼Œè¿™é‡Œæ˜¯æˆ‘ä»¬æ„é€ çš„ç½‘ç»œæ‰€æ¥æ”¶çš„å‚æ•°ï¼Œåç»­è¦ç”¨åˆ°è¿™ä¸ªå‚æ•°ã€‚</p>\n</li>\n<li>\n<p>ç¬¬ä¸‰è¡Œä»£ç ï¼šè°ƒç”¨äº†çˆ¶ç±» <code>nn.Module</code> çš„æ„é€ å‡½æ•°ï¼Œç¡®ä¿æ­£ç¡®åœ°åˆå§‹åŒ– LeNet5 ç±»çš„çˆ¶ç±»éƒ¨åˆ†ã€‚è¿™æ˜¯ Python ä¸­ç”¨äºè°ƒç”¨çˆ¶ç±»æ–¹æ³•çš„ä¸€ç§æ–¹å¼ã€‚</p>\n</li>\n</ul>\n<p>å¦‚æœè¯»å®Œè¿™äº›è§£é‡Šè¿˜æ˜¯ä¸ç†è§£ï¼Œæ²¡å…³ç³»ï¼Œä½ å¯ä»¥æŠŠè¿™ä¸‰è¡Œå½“ä½œä¸€ä¸ªå¥—è·¯ï¼Œç”¨å¤šäº†è‡ªç„¶å°±ä¼šè®°ä½ã€‚</p>\n<p>å¥—è·¯å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight ruby\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> ç½‘ç»œåå­—(nn.<span class=\"title class_\">Module</span>):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\"><span class=\"variable language_\">self</span>, éœ€è¦æ¥å—çš„å‚æ•°</span>)ï¼š</span><br><span class=\"line\">        <span class=\"variable language_\">super</span>(ç½‘ç»œåå­—, <span class=\"variable language_\">self</span>).__init__()</span><br></pre></td></tr></table></figure>\n<hr>\n<h2 id=\"5-å‡†å¤‡ï¼ˆåŠ è½½ï¼‰æ•°æ®é›†\">5. å‡†å¤‡ï¼ˆåŠ è½½ï¼‰æ•°æ®é›†</h2>\n<p>åœ¨ä¸Šä¸€æ­¥ä¸­ï¼ŒLeNet5å·²ç»æ­å»ºå¥½äº†ï¼Œç°åœ¨è¯¥ç¼–å†™è®­ç»ƒéƒ¨åˆ†çš„ç¨‹åºäº†ã€‚ä½†æ˜¯åœ¨è¿™ä¹‹å‰æœ‰ä¸€æ­¥ä¸èƒ½è½ä¸‹ï¼Œé‚£å°±æ˜¯æ•°æ®åŠ è½½ã€‚</p>\n<p>è¦æŠŠæ•°æ®é›†é‡Œçš„ä¸€å †æ•°æ®â€œç å¥½â€äº†ï¼Œä¸€æ‰¹ä¸€æ‰¹åœ°â€œå–‚â€ç»™LeNet5.</p>\n<p>MNIST æ•°æ®é›†æ˜¯ä¸€ä¸ªæ‰‹å†™æ•°å­—å›¾åƒæ•°æ®é›†ï¼ŒåŒ…å«äº†å¤§é‡çš„æ‰‹å†™æ•°å­—å›¾ç‰‡ï¼Œæ¯å¼ å›¾ç‰‡éƒ½æ ‡æ³¨äº†å¯¹åº”çš„æ•°å­—ã€‚<br>\n<code>torchvision.datasets.MNIST(...)</code>æ˜¯ PyTorch ä¸­ç”¨äºåŠ è½½ MNIST æ•°æ®é›†çš„ç±»ã€‚<br>\n<code>torch.utils.data.DataLoader(...)</code> æ˜¯ PyTorch ä¸­ç”¨äºæ‰¹é‡åŠ è½½æ•°æ®çš„å·¥å…·ç±»ï¼Œæ˜¯ä¸€ä¸ªæ•°æ®åŠ è½½å™¨ã€‚</p>\n<p>æ³¨æ„ï¼šå‰è€…ç”¨äºåŠ è½½æ•°æ®<strong>é›†</strong>ï¼Œåè€…ç”¨äºåŠ è½½æ•°æ®ï¼Œä¸è¦æ··æ·†ã€‚</p>\n<p>æŠŠä¸€ä¸ªæ•°æ®é›†æ¯”ä½œä¸€å‰¯æ‰‘å…‹ç‰Œï¼Œé‚£ä¹ˆä¸€å¼ æ‰‘å…‹ç‰Œå°±æ˜¯ä¸€ä¸ªæ•°æ®ã€‚æŠŠDataLoaderæ¯”ä½œç¥ç»ç½‘ç»œçš„æ‰‹ï¼Œæ‰‹å»æŠ“ç‰Œã€‚ä¸€æ¬¡æŠ“å‡ å¼ ï¼ŒæŠ“ç‰Œæœ‰æ²¡æœ‰é¡ºåºï¼Œç­‰ç­‰ï¼Œè¿™äº›éƒ½æ˜¯é€šè¿‡è®¾ç½®DataLoaderçš„å‚æ•°å†³å®šçš„ã€‚batch_sizeç­‰äºå‡ å°±æ˜¯ä¸€æ¬¡æŠ“å‡ å¼ ç‰Œï¼Œå³ä¸€æ¬¡â€œå–‚â€ç»™ç¥ç»ç½‘ç»œå‡ å¼ å›¾ç‰‡ã€‚</p>\n<figure class=\"highlight ini\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># åŠ è½½è®­ç»ƒé›†</span></span><br><span class=\"line\"><span class=\"attr\">train_dataset</span> = torchvision.datasets.MNIST(root = <span class=\"string\">&#x27;./data&#x27;</span>, <span class=\"comment\"># æ•°æ®é›†ä¿å­˜è·¯å¾„</span></span><br><span class=\"line\">                                           <span class=\"attr\">train</span> = <span class=\"literal\">True</span>,    <span class=\"comment\"># æ˜¯å¦ä¸ºè®­ç»ƒé›†</span></span><br><span class=\"line\">                                           <span class=\"comment\"># æ•°æ®é¢„å¤„ç†</span></span><br><span class=\"line\">                                           <span class=\"attr\">transform</span> = transforms.Compose([</span><br><span class=\"line\">                                                  transforms.Resize((<span class=\"number\">32</span>,<span class=\"number\">32</span>)),</span><br><span class=\"line\">                                                  transforms.ToTensor(),</span><br><span class=\"line\">                                                  transforms.Normalize(mean = (<span class=\"number\">0.1307</span>,), </span><br><span class=\"line\">                                                                     std = (<span class=\"number\">0.3081</span>,))]),</span><br><span class=\"line\">                                           <span class=\"attr\">download</span> = <span class=\"literal\">True</span>) <span class=\"comment\">#æ˜¯å¦ä¸‹è½½</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åŠ è½½æµ‹è¯•é›†</span></span><br><span class=\"line\"><span class=\"attr\">test_dataset</span> = torchvision.datasets.MNIST(root = <span class=\"string\">&#x27;./data&#x27;</span>,</span><br><span class=\"line\">                                          <span class=\"attr\">train</span> = <span class=\"literal\">False</span>,</span><br><span class=\"line\">                                          <span class=\"attr\">transform</span> = transforms.Compose([</span><br><span class=\"line\">                                                  transforms.Resize((<span class=\"number\">32</span>,<span class=\"number\">32</span>)),</span><br><span class=\"line\">                                                  transforms.ToTensor(),</span><br><span class=\"line\">                                                  transforms.Normalize(mean = (<span class=\"number\">0.1325</span>,), </span><br><span class=\"line\">                                                                     std = (<span class=\"number\">0.3105</span>,))]),</span><br><span class=\"line\">                                          <span class=\"attr\">download</span>=<span class=\"literal\">True</span>)</span><br><span class=\"line\"><span class=\"comment\"># ä¸€æ¬¡æŠ“64å¼ ç‰Œ</span></span><br><span class=\"line\"><span class=\"attr\">batch_size</span> = <span class=\"number\">64</span></span><br><span class=\"line\"><span class=\"comment\"># åŠ è½½è®­ç»ƒæ•°æ®</span></span><br><span class=\"line\"><span class=\"attr\">train_loader</span> = torch.utils.data.DataLoader(dataset = train_dataset,</span><br><span class=\"line\">                                           <span class=\"attr\">batch_size</span> = batch_size,</span><br><span class=\"line\">                                           <span class=\"attr\">shuffle</span> = <span class=\"literal\">True</span>)  <span class=\"comment\"># æ˜¯å¦æ‰“ä¹±</span></span><br><span class=\"line\"><span class=\"comment\"># åŠ è½½æµ‹è¯•æ•°æ®</span></span><br><span class=\"line\"><span class=\"attr\">test_loader</span> = torch.utils.data.DataLoader(dataset = test_dataset,</span><br><span class=\"line\">                                           <span class=\"attr\">batch_size</span> = batch_size,</span><br><span class=\"line\">                                           <span class=\"attr\">shuffle</span> = <span class=\"literal\">False</span>) <span class=\"comment\"># æ˜¯å¦æ‰“ä¹±</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>\n<p>è®­ç»ƒé˜¶æ®µçš„<code>shuffle=True</code>ï¼šå°†æ•°æ®é›†æ‰“ä¹±é¡ºåºï¼Œæœ‰åŠ©äºæ¨¡å‹å­¦ä¹ æ›´æ³›åŒ–çš„ç‰¹å¾ã€‚é€šè¿‡æ‰“ä¹±æ•°æ®é¡ºåºï¼Œæ¨¡å‹åœ¨æ¯ä¸ª epoch ä¸­éƒ½èƒ½å¤Ÿçœ‹åˆ°ä¸åŒçš„æ ·æœ¬ï¼Œé˜²æ­¢æ¨¡å‹è¿‡åº¦æ‹Ÿåˆè®­ç»ƒé›†ä¸­çš„ç‰¹å®šé¡ºåºã€‚</p>\n</li>\n<li>\n<p>æµ‹è¯•é˜¶æ®µçš„<code>shuffle=False</code>ï¼šåœ¨æµ‹è¯•é˜¶æ®µï¼Œé€šå¸¸ä¸éœ€è¦æ‰“ä¹±æ•°æ®çš„é¡ºåºã€‚æµ‹è¯•æ—¶æ¨¡å‹æ˜¯åœ¨æœªè§è¿‡çš„æ•°æ®ä¸Šè¿›è¡Œè¯„ä¼°ï¼Œå› æ­¤å¸Œæœ›æ¨¡å‹çœ‹åˆ°çš„æ˜¯åŸå§‹æ•°æ®çš„æœ‰åºé¡ºåºï¼Œä»¥ä¾¿èƒ½å¤Ÿæ›´å¥½åœ°è¯„ä¼°æ¨¡å‹çš„æ³›åŒ–æ€§èƒ½ã€‚å¦‚æœåœ¨æµ‹è¯•æ—¶ä¹Ÿæ‰“ä¹±æ•°æ®ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ¨¡å‹åœ¨è¯„ä¼°æ—¶çœ‹åˆ°çš„æ•°æ®åˆ†å¸ƒä¸å®é™…åœºæ™¯ä¸ä¸€è‡´ã€‚ï¼ˆå…¶å®å¦‚æœæ˜¯<code>True</code>å½±å“ä¹Ÿä¸å¤§ï¼‰</p>\n</li>\n</ul>\n<hr>\n<h2 id=\"6-è®¾ç½®è¶…å‚æ•°\">6. è®¾ç½®è¶…å‚æ•°</h2>\n<p>åœ¨è®­ç»ƒä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®ä¸€äº›è¶…å‚æ•°ï¼Œä¸ºè®­ç»ƒé˜¶æ®µè¦ç”¨åˆ°çš„æ¨¡å‹ã€æŸå¤±å‡½æ•°ã€ä¼˜åŒ–å™¨åšå‡†å¤‡ã€‚</p>\n<h3 id=\"ï¼ˆ1ï¼‰åˆ›å»º-LeNet5-æ¨¡å‹\">ï¼ˆ1ï¼‰åˆ›å»º LeNet5 æ¨¡å‹</h3>\n<figure class=\"highlight ini\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">num_classes</span> = <span class=\"number\">10</span></span><br><span class=\"line\"><span class=\"attr\">model</span> = LeNet5(num_classes).to(device)</span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>LeNet5(num_classes)</code>ï¼šåˆ›å»ºä¸€ä¸ª LeNet5 ç±»çš„å®ä¾‹ã€‚è¿˜è®°å¾—ä¹ˆï¼Ÿå‰æ–‡æåˆ°è¿‡ï¼Œè¯¥ç±»æ˜¯ç»§æ‰¿è‡ª nn.Module çš„ç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œæ¥å— num_classes å‚æ•°ï¼Œè¡¨ç¤ºæ¨¡å‹è¾“å‡ºçš„ç±»åˆ«æ•°ç›®ã€‚</li>\n<li><code>to(device)</code>ï¼šå°†æ¨¡å‹ç§»åŠ¨åˆ°æŒ‡å®šçš„è®¾å¤‡ä¸Šï¼Œå…¶ä¸­ <code>device</code> æ˜¯ä¸€ä¸ªè®¾å¤‡å¯¹è±¡ï¼Œå¯ä»¥æ˜¯ <code>'cuda'</code>ï¼ˆGPUï¼‰æˆ–è€… <code>'cpu'</code>ã€‚è¿™ä¸€æ­¥æ˜¯ä¸ºäº†ç¡®ä¿æ¨¡å‹åœ¨è®­ç»ƒå’Œæ¨ç†æ—¶ä½¿ç”¨çš„æ˜¯æ­£ç¡®çš„è®¡ç®—è®¾å¤‡ã€‚</li>\n<li><code>model = ...</code>ï¼šå°†åˆ›å»ºå¹¶ç§»åŠ¨åˆ°æŒ‡å®šè®¾å¤‡çš„æ¨¡å‹èµ‹å€¼ç»™å˜é‡ modelï¼Œä»¥ä¾¿åç»­å¯¹æ¨¡å‹çš„å¼•ç”¨å’Œæ“ä½œã€‚</li>\n</ul>\n<h3 id=\"ï¼ˆ2ï¼‰åˆ›å»ºæŸå¤±å‡½æ•°\">ï¼ˆ2ï¼‰åˆ›å»ºæŸå¤±å‡½æ•°</h3>\n<p>åœ¨è¿™é‡Œï¼ŒæŸå¤±å‡½æ•°è®¾ç½®ä¸ºäº¤å‰ç†µæŸå¤±å‡½æ•°</p>\n<figure class=\"highlight ini\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">cost</span> = nn.CrossEntropyLoss()</span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>nn.CrossEntropyLoss()</code>æ˜¯ PyTorch ä¸­ç”¨äºè®¡ç®—å¤šç±»åˆ«äº¤å‰ç†µæŸå¤±çš„æŸå¤±å‡½æ•°ã€‚äº¤å‰ç†µæŸå¤±é€šå¸¸ç”¨äºåˆ†ç±»é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯å½“ç›®æ ‡æ˜¯å¤šç±»åˆ«æ ‡ç­¾æ—¶ã€‚å®ƒçš„è®¡ç®—æ¶‰åŠåˆ°æ¨¡å‹çš„é¢„æµ‹å€¼å’Œå®é™…ç±»åˆ«æ ‡ç­¾ä¹‹é—´çš„æ¯”è¾ƒï¼Œä»¥è¡¡é‡æ¨¡å‹è¾“å‡ºä¸çœŸå®æ ‡ç­¾ä¹‹é—´çš„å·®å¼‚ã€‚</li>\n</ul>\n<h3 id=\"ï¼ˆ3ï¼‰åˆ›å»ºä¼˜åŒ–å™¨\">ï¼ˆ3ï¼‰åˆ›å»ºä¼˜åŒ–å™¨</h3>\n<figure class=\"highlight ini\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">learning_rate</span> = <span class=\"number\">0.001</span></span><br><span class=\"line\"><span class=\"attr\">optimizer</span> = torch.optim.Adam(model.parameters(), lr=learning_rate)</span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>torch.optim.Adam</code>ï¼šè¿™æ˜¯ PyTorch ä¸­æä¾›çš„ Adam ä¼˜åŒ–å™¨çš„å®ç°ã€‚Adam æ˜¯ä¸€ç§å¸¸ç”¨çš„éšæœºæ¢¯åº¦ä¸‹é™ç®—æ³•çš„å˜ä½“ï¼Œå®ƒé€šè¿‡è‡ªé€‚åº”åœ°è°ƒæ•´å­¦ä¹ ç‡æ¥ä¼˜åŒ–æ¨¡å‹å‚æ•°ã€‚</li>\n<li><code>model.parameters()</code>ï¼šæŒ‡å®šè¦è¢«ä¼˜åŒ–çš„å‚æ•°ï¼Œå°±æ˜¯å‘Šè¯‰ä¼˜åŒ–å™¨å»ä¼˜åŒ–è°ï¼Œè¿™é‡Œé€‰æ‹©äº†æ¨¡å‹ model ä¸­çš„æ‰€æœ‰å‚æ•°ã€‚</li>\n<li><code>lr=learning_rate</code>ï¼šè®¾ç½®å­¦ä¹ ç‡ï¼Œå³æ¯æ¬¡å‚æ•°æ›´æ–°æ—¶çš„æ­¥è¿›å¤§å°ã€‚</li>\n</ul>\n<h3 id=\"ï¼ˆ4ï¼‰ç¡®å®šæ¯è½®å…±éœ€å‡ æ­¥\">ï¼ˆ4ï¼‰ç¡®å®šæ¯è½®å…±éœ€å‡ æ­¥</h3>\n<figure class=\"highlight ini\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">total_step</span> = len(train_loader)</span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>len(train_loader) </code>è¿”å›åŠ è½½å™¨ä¸­çš„æ‰¹æ¬¡æ•°é‡ã€‚</li>\n<li>MNISTæ•°æ®é›†ä¸­æœ‰ 60000 å¼ å›¾ç‰‡ä½œä¸ºè®­ç»ƒé›†ã€‚æˆ‘ä»¬æ¯æ¬¡æŠ“64å¼ ç‰Œï¼Œé‚£ä¹ˆä¸€å…±è¦æŠ“ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><mn>60000</mn><mn>64</mn></mfrac><mo>=</mo><mn>937.5</mn></mrow><annotation encoding=\"application/x-tex\">\\frac{60000}{64}=937.5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">64</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">60000</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">937.5</span></span></span></span> ï¼Œ937.5 å‘ä¸Šå–æ•´æ˜¯ 938 ä¸ªæ‰¹æ¬¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç”±äºæ•°æ®åŠ è½½å™¨DataLoaderçš„å­˜åœ¨ï¼ŒLeNet5 æŠŠè®­ç»ƒé›†æ‰€æœ‰å›¾ç‰‡éå†ä¸€éè¦ 938 æ­¥ï¼ˆstepï¼‰ã€‚è®­ç»ƒä¸€è½®ï¼ˆepochï¼‰éœ€è¦ 938 æ­¥ï¼ˆstepï¼‰ã€‚æ€»ç»“ä¸€ä¸‹ï¼Œä¸€è½®éœ€è¦å¾ˆå¤šæ­¥ï¼Œ<strong>ä¸€æ­¥å°±æ˜¯ä¸€ä¸ªæ‰¹æ¬¡</strong>ã€‚</li>\n</ul>\n<hr>\n<h2 id=\"7-è®­ç»ƒ\">7. è®­ç»ƒ</h2>\n<p>æˆ‘ä»¬å°†ç”¨ 2 ä¸ª for å¾ªç¯çš„åµŒå¥—æ¥å®ç°è®­ç»ƒè¿‡ç¨‹ã€‚</p>\n<p>å…ˆè®©æˆ‘ä»¬æ¢³ç†ä¸€ä¸‹åº”è¯¥å¦‚ä½•è®­ç»ƒã€‚é¦–å…ˆï¼Œè®­ç»ƒåˆ†å¾ˆå¤šè½®ï¼ˆepochï¼‰ï¼Œæ¯è½®è®­ç»ƒéƒ½éœ€è¦æŠŠå…¨éƒ¨è®­ç»ƒé›†è¿‡ä¸€éã€‚æ‰€ä»¥éœ€è¦ä¸€ä¸ª for å¾ªç¯ï¼Œä¸€è½®ä¸€è½®åœ°è¿›è¡Œå¾ªç¯ã€‚è¿™ä¸ªâ€œè¿‡ä¸€éâ€æ˜¯é€šè¿‡æ•°æ®åŠ è½½å™¨ DataLoader å®ç°çš„ã€‚å…¶æ¬¡ï¼Œåœ¨ä¸€è½®è®­ç»ƒä¸­ï¼Œå®Œæ•´éå†ä¸€æ¬¡è®­ç»ƒé›†éœ€è¦ä¸€ä¸ª for å¾ªç¯ï¼Œå»å¾ªç¯ä» DataLoader åŠ è½½è¿‡æ¥çš„æ¯ä¸ªæ‰¹æ¬¡çš„å›¾ç‰‡ï¼ˆæœ¬ä¾‹ä¸º64å¼ å›¾ï¼‰ã€‚</p>\n<p>åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘è®¾ç½®å…±è®­ç»ƒ 10 è½®ã€‚</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># è®¾ç½®ä¸€å…±è®­ç»ƒå‡ è½®ï¼ˆepochï¼‰</span></span><br><span class=\"line\">num_epochs = <span class=\"number\">10</span></span><br><span class=\"line\"><span class=\"comment\"># å¤–éƒ¨å¾ªç¯ç”¨äºéå†è½®æ¬¡</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> epoch <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(num_epochs):</span><br><span class=\"line\">    <span class=\"comment\"># å†…éƒ¨å¾ªç¯ç”¨äºéå†æ¯è½®ä¸­çš„æ‰€æœ‰æ‰¹æ¬¡</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i, (images, labels) <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(train_loader):  </span><br><span class=\"line\">        images = images.to(device)</span><br><span class=\"line\">        labels = labels.to(device)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># å‰å‘ä¼ æ’­</span></span><br><span class=\"line\">        outputs = model(images)   <span class=\"comment\"># é€šè¿‡æ¨¡å‹è¿›è¡Œå‰å‘ä¼ æ’­ï¼Œå¾—åˆ°æ¨¡å‹çš„é¢„æµ‹ç»“æœ outputs</span></span><br><span class=\"line\">        loss = cost(outputs, labels)    <span class=\"comment\"># è®¡ç®—æ¨¡å‹é¢„æµ‹ä¸çœŸå®æ ‡ç­¾ä¹‹é—´çš„æŸå¤±</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># åå‘ä¼ æ’­å’Œä¼˜åŒ–</span></span><br><span class=\"line\">        optimizer.zero_grad()   <span class=\"comment\"># æ¸…é›¶æ¢¯åº¦ï¼Œä»¥ä¾¿åœ¨ä¸‹ä¸€æ¬¡åå‘ä¼ æ’­ä¸­ä¸ç´¯ç§¯ä¹‹å‰çš„æ¢¯åº¦</span></span><br><span class=\"line\">        loss.backward()     <span class=\"comment\"># è¿›è¡Œåå‘ä¼ æ’­ï¼Œè®¡ç®—æ¢¯åº¦</span></span><br><span class=\"line\">        optimizer.step()    <span class=\"comment\"># æ ¹æ®æ¢¯åº¦æ›´æ–°ï¼ˆä¼˜åŒ–ï¼‰æ¨¡å‹å‚æ•°</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># å®šæœŸè¾“å‡ºè®­ç»ƒä¿¡æ¯</span></span><br><span class=\"line\">        <span class=\"comment\"># åœ¨æ¯ç»è¿‡ä¸€å®šæ•°é‡çš„æ‰¹æ¬¡åï¼Œè¾“å‡ºå½“å‰è®­ç»ƒè½®æ¬¡ã€æ€»å‘¨è½®æ•°ã€å½“å‰æ‰¹æ¬¡ã€æ€»æ‰¹æ¬¡æ•°å’ŒæŸå¤±å€¼</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (i+<span class=\"number\">1</span>) % <span class=\"number\">400</span> == <span class=\"number\">0</span>:</span><br><span class=\"line\">            <span class=\"built_in\">print</span> (<span class=\"string\">&#x27;Epoch [&#123;&#125;/&#123;&#125;], Step [&#123;&#125;/&#123;&#125;], Loss: &#123;:.4f&#125;&#x27;</span> </span><br><span class=\"line\">                           .<span class=\"built_in\">format</span>(epoch+<span class=\"number\">1</span>, num_epochs, i+<span class=\"number\">1</span>, total_step, loss.item()))</span><br></pre></td></tr></table></figure>\n<ul>\n<li>\n<p>åœ¨å†…éƒ¨å¾ªç¯<code>for i, (images, labels) in enumerate(train_loader):</code>ä¸­<code>enumerate(train_loader)</code> è¿”å›ä¸€ä¸ªå¯è¿­ä»£çš„å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«æ¯ä¸ªæ‰¹æ¬¡çš„å›¾åƒå’Œæ ‡ç­¾ã€‚</p>\n</li>\n<li>\n<p><code>images = images.to(device)</code> å’Œ <code>labels = labels.to(device)</code>ï¼šå°†åŠ è½½çš„å›¾åƒå’Œæ ‡ç­¾ç§»åŠ¨åˆ°è®¾å¤‡ï¼ˆé€šå¸¸æ˜¯ GPUï¼‰ï¼Œä»¥ä¾¿åœ¨è®¾å¤‡ä¸Šæ‰§è¡Œæ¨¡å‹çš„å‰å‘å’Œåå‘ä¼ æ’­ã€‚</p>\n</li>\n<li>\n<p>å¯¹åˆå­¦è€…è€Œè¨€ï¼Œâ€œå®šæœŸè¾“å‡ºè®­ç»ƒä¿¡æ¯â€éƒ¨åˆ†çš„ä»£ç ç”¨<code>print</code>è¾“å‡ºå³å¯ï¼ŒåæœŸç†Ÿç»ƒäº†å¯ä»¥å°è¯•ç”¨<code>tqdm</code>åº“æ˜¾ç¤ºè¿›åº¦æ¡ã€‚è¿™ä¸æ˜¯æœ¬æ–‡é‡ç‚¹ï¼Œæœ‰å…´è¶£çš„å¯ä»¥è‡ªè¡Œäº†è§£ã€‚</p>\n</li>\n</ul>\n<hr>\n<p>è®­ç»ƒæ—¶è¾“å‡ºçš„ç»“æœï¼š<br>\n<img src=\"https://s2.loli.net/2024/12/26/iecCf3X6SpkQIz4.png\" alt=\"\"></p>\n<p>938 è·Ÿæˆ‘ä»¬ä¹‹å‰æ‰‹åŠ¨è®¡ç®—çš„æ€»æ‰¹æ¬¡æ•°ï¼ˆæ­¥æ•°ï¼‰æ•°æ˜¯å»åˆçš„ã€‚</p>\n<h2 id=\"8-æµ‹è¯•\">8. æµ‹è¯•</h2>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">with</span> torch.no_grad():   <span class=\"comment\"># æŒ‡ç¤º PyTorch åœ¨æ¥ä¸‹æ¥çš„ä»£ç å—ä¸­ä¸è¦è®¡ç®—æ¢¯åº¦</span></span><br><span class=\"line\">    <span class=\"comment\"># åˆå§‹åŒ–è®¡æ•°å™¨</span></span><br><span class=\"line\">    correct = <span class=\"number\">0</span>     <span class=\"comment\"># æ­£ç¡®åˆ†ç±»çš„æ ·æœ¬æ•°</span></span><br><span class=\"line\">    total = <span class=\"number\">0</span>       <span class=\"comment\"># æ€»æ ·æœ¬æ•°</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># éå†æµ‹è¯•æ•°æ®é›†çš„æ¯ä¸ªæ‰¹æ¬¡</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> images, labels <span class=\"keyword\">in</span> test_loader:</span><br><span class=\"line\">        <span class=\"comment\"># å°†åŠ è½½çš„å›¾åƒå’Œæ ‡ç­¾ç§»åŠ¨åˆ°è®¾å¤‡ï¼ˆé€šå¸¸æ˜¯ GPUï¼‰ä¸Š</span></span><br><span class=\"line\">        images = images.to(device)</span><br><span class=\"line\">        labels = labels.to(device)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># æ¨¡å‹é¢„æµ‹</span></span><br><span class=\"line\">        outputs = model(images)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># è®¡ç®—å‡†ç¡®ç‡</span></span><br><span class=\"line\">        <span class=\"comment\"># ä»æ¨¡å‹è¾“å‡ºä¸­è·å–æ¯ä¸ªæ ·æœ¬é¢„æµ‹çš„ç±»åˆ«</span></span><br><span class=\"line\">        _, predicted = torch.<span class=\"built_in\">max</span>(outputs.data, <span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"comment\"># ç´¯ç§¯æ€»æ ·æœ¬æ•°</span></span><br><span class=\"line\">        total += labels.size(<span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"comment\"># ç´¯ç§¯æ­£ç¡®åˆ†ç±»çš„æ ·æœ¬æ•°</span></span><br><span class=\"line\">        correct += (predicted == labels).<span class=\"built_in\">sum</span>().item()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># è¾“å‡ºå‡†ç¡®ç‡ï¼Œæ­£ç¡®çš„ / æ€»çš„</span></span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;Accuracy of the network on the 10000 test images: &#123;&#125; %&#x27;</span>.<span class=\"built_in\">format</span>(<span class=\"number\">100</span> * correct / total))</span><br></pre></td></tr></table></figure>\n<ul>\n<li>\n<p>åœ¨æµ‹è¯•é˜¶æ®µï¼Œæˆ‘ä»¬é€šå¸¸ä¸éœ€è¦è®¡ç®—æ¢¯åº¦ï¼Œä»¥æé«˜å†…å­˜æ•ˆç‡ã€‚</p>\n</li>\n<li>\n<p>æ³¨æ„çœ‹ <code>_, predicted = torch.max(outputs.data, 1)</code> ä¸­çš„ <code>torch.max(xxx, 1)</code>è¡¨ç¤ºå¯¹äºæ¯ä¸ªè¾“å…¥ <code>xxx</code> è€Œè¨€ï¼Œ<code>torch.max</code> è¿”å›ä¸€ä¸ªå…ƒç»„ï¼Œå…¶ä¸­åŒ…å«ä¸¤ä¸ªå¼ é‡ï¼Œç¬¬ä¸€ä¸ªå¼ é‡æ˜¯æœ€å¤§å€¼ï¼Œç¬¬äºŒä¸ªå¼ é‡æ˜¯æœ€å¤§å€¼æ‰€åœ¨çš„ç´¢å¼•ï¼ˆä¹Ÿå°±æ˜¯å±äºå“ªä¸€ç±»ï¼‰ã€‚<br>\nä¸¾ä¸ªä¾‹å­ï¼Œåœ¨å›¾åƒå¤„ç†ä¸­ï¼Œç¥ç»ç½‘ç»œé€šå¸¸è¾“å‡ºä¸€ä¸ªäºŒç»´å¼ é‡ã€‚ä»€ä¹ˆæ ·çš„äºŒç»´å¼ é‡å‘¢ï¼Ÿåœ¨3åˆ†ç±»é—®é¢˜ä¸­è¾“å‡ºäºŒç»´å¼ é‡ï¼š</p>\n<figure class=\"highlight lua\"><table><tr><td class=\"code\"><pre><span class=\"line\">tensor(<span class=\"string\">[[0.1, 0.8, 0.3],</span></span><br><span class=\"line\"><span class=\"string\">        [0.4, 0.2, 0.9],</span></span><br><span class=\"line\"><span class=\"string\">        [0.7, 0.5, 0.2],</span></span><br><span class=\"line\"><span class=\"string\">        [0.6, 0.2, 0.4]]</span>)</span><br></pre></td></tr></table></figure>\n<p>ä¸Šé¢çš„äºŒç»´å¼ é‡ï¼Œç”± 4 ä¸ªé•¿åº¦ä¸º 3 çš„ä¸€ç»´å¼ é‡æ„æˆã€‚<code>torch.max(xxx, 1)</code>åœ¨æ¯ä¸€è¡Œä¸­å¯»æ‰¾æœ€å¤§å€¼ã€‚<br>\n<code>torch.max(xxx, 1)</code>è¿”å›ç»“æœä¸ºå…ƒç»„ï¼š</p>\n<figure class=\"highlight scss\"><table><tr><td class=\"code\"><pre><span class=\"line\">(tensor([<span class=\"number\">0.8</span>, <span class=\"number\">0.9</span>, <span class=\"number\">0.7</span>, <span class=\"number\">0.6</span>]), <span class=\"built_in\">tensor</span>([<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>]))</span><br></pre></td></tr></table></figure>\n<p>å…¶ä¸­ï¼Œ0.8, 0.9, 0.7, 0.6 åˆ†åˆ«ä¸ºå±äºç´¢å¼•ï¼ˆç±»åˆ«ï¼‰1, 2, 0, 0 çš„æ¦‚ç‡ï¼ˆæˆ–å¾—åˆ†ï¼‰ã€‚</p>\n</li>\n<li>\n<p>è€Œ <code>_, predicted = torch.max(outputs.data, 1)</code> ä¸­çš„ <code>_</code> ã€‚å®ƒæ˜¯ä¸€ä¸ªé€šå¸¸ç”¨ä½œå ä½ç¬¦çš„å˜é‡åã€‚åœ¨ Python ä¸­ï¼Œé€šå¸¸ä½¿ç”¨ <code>_</code> è¡¨ç¤ºä¸€ä¸ªä¸´æ—¶æˆ–ä¸ä½¿ç”¨çš„å˜é‡ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬ä¸è¦å±äºç´¢å¼•ï¼ˆç±»åˆ«ï¼‰çš„æ¦‚ç‡ï¼ˆæˆ–å¾—åˆ†ï¼‰ï¼Œåªè¦æœ€ç»ˆç»“æœï¼Œå³å±äºå“ªä¸ªç´¢å¼•ï¼ˆç±»åˆ«ï¼‰ï¼ŒæŠŠå®ƒçš„å€¼èµ‹ç»™<code>predicted</code><br>\næµ‹è¯•é˜¶æ®µè¿è¡Œçš„ç»“æœï¼š<br>\n<img src=\"https://s2.loli.net/2024/12/26/DI6rmZHU3cbkysE.png\" alt=\"\"><br>\nå¯ä»¥çœ‹åˆ°è¾¾åˆ°äº†99.12%</p>\n</li>\n</ul>\n<hr>\n<p>ä»¥ä¸Šï¼Œå°±æ˜¯ä»0å¼€å§‹æ•²LeNet5çš„å…¨éƒ¨è¿‡ç¨‹ã€‚</p>\n","tags":["PyTorch","LeNet5"]},{"title":"MiniMIPS32","url":"/post/dc2fe057.html","content":"<h2 id=\"æŒ‡ä»¤é›†ä»¿çœŸå™¨-â€“-TEMU\">æŒ‡ä»¤é›†ä»¿çœŸå™¨ â€“ TEMU</h2>\n<h3 id=\"å®éªŒç®€ä»‹\">å®éªŒç®€ä»‹</h3>\n<p>é‡‡ç”¨é«˜çº§è¯­è¨€ï¼ˆC/C++ã€Javaæˆ–Pythonç­‰ï¼‰è®¾è®¡é¢å‘32ä½MIPSæˆ–LoongArchæŒ‡ä»¤é›†å­é›†çš„æŒ‡ä»¤é›†ä»¿çœŸå™¨ â€“ TEMUï¼Œç”¨äºå®ç°å¯¹ç¨‹åºæ‰§è¡Œè¿‡ç¨‹çš„æ¨¡æ‹Ÿå’Œè°ƒè¯•ã€‚è¯¥æŒ‡ä»¤é›†ä»¿çœŸå™¨å¯æ¨¡æ‹Ÿå¸¸è§æŒ‡ä»¤ï¼Œæ”¯æŒå•æ­¥æ‰§è¡Œã€æ–­ç‚¹ã€æ˜¾ç¤ºå¯„å­˜å™¨ä¿¡æ¯ã€æ˜¾ç¤ºç‰¹å®šå­˜å‚¨å•å…ƒä¿¡æ¯ç­‰åŠŸèƒ½ï¼Œä¸ºåç»­çš„å¤„ç†å™¨è®¾è®¡å®éªŒæä¾›ä»¿çœŸæµ‹è¯•å·¥å…·ã€‚</p>\n","tags":["MiniMIPS32"]},{"title":"ICPCç®—æ³•æ¨¡ç‰ˆ","url":"/post/23b2b017.html","content":"<h1>Part 1. æ•°æ®ç»“æ„</h1>\n<h2 id=\"1-çº¿æ®µæ ‘ï¼ˆSegment-Trees\">1.çº¿æ®µæ ‘ï¼ˆSegment Trees)</h2>\n<p>å…³é”®è¯ï¼šå®šé•¿åºåˆ—æ“ä½œï¼ŒåŒºé—´ä¿®æ”¹ä¸æŸ¥è¯¢ã€‚</p>\n<p><strong>ACLibraryå¯¹æ‡’æ ‡è®°çº¿æ®µæ ‘é€‚é…çš„å®šä¹‰ï¼Œä¸æ¶‰åŠåŒºé—´æ‡’æ ‡è®°çš„æ™®é€šçº¿æ®µæ ‘æ²¡æœ‰<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi></mrow><annotation encoding=\"application/x-tex\">F</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span></span></span></span>çš„é™åˆ¶ï¼š</strong></p>\n<p>It is the data structure for the pair of a monoid <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mo>&lt;</mo><mi>S</mi><mo separator=\"true\">,</mo><mo>â‹…</mo><mo>&gt;</mo><mo>:</mo><mi>S</mi><mo>â‹…</mo><mi>S</mi><mo>â†’</mo><mi>S</mi><mo separator=\"true\">,</mo><mi>e</mi><mo>âˆˆ</mo><mi>S</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(&lt;S, \\cdot&gt;: S \\cdot S \\to S, e \\in S)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â†’</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mclose\">)</span></span></span></span> and a set <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi></mrow><annotation encoding=\"application/x-tex\">F</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span></span></span></span> of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mo>â†’</mo><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">S \\to S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â†’</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span>â€‹ mappings that satisfies the following properties.</p>\n<ol>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi></mrow><annotation encoding=\"application/x-tex\">F</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span></span></span></span> contains the identity map <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">i</mi><mi mathvariant=\"normal\">d</mi></mrow><annotation encoding=\"application/x-tex\">\\mathrm{id}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord\"><span class=\"mord mathrm\">id</span></span></span></span></span>, where the identity map is the map that satisfies <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mrow><mi mathvariant=\"normal\">i</mi><mi mathvariant=\"normal\">d</mi></mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathrm{id}(x) = x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathrm\">id</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> for all <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>âˆˆ</mo><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">x \\in S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span>.</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi></mrow><annotation encoding=\"application/x-tex\">F</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span></span></span></span> is closed under composition, i.e., <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo>âˆ˜</mo><mi>g</mi><mo>âˆˆ</mo><mi>F</mi></mrow><annotation encoding=\"application/x-tex\">f \\circ g \\in F</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ˜</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span></span></span></span> holds for all <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo separator=\"true\">,</mo><mi>g</mi><mo>âˆˆ</mo><mi>F</mi></mrow><annotation encoding=\"application/x-tex\">f, g \\in F</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span></span></span></span>â€‹.</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo>â‹…</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>â‹…</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(x \\cdot y) = f(x) \\cdot f(y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span> holds for all <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo>âˆˆ</mo><mi>F</mi></mrow><annotation encoding=\"application/x-tex\">f \\in F</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo>âˆˆ</mo><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">x, y \\in S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span>.</li>\n</ol>\n<p>Given an array <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span> of length <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>, it processes the following queries in <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>log</mi><mo>â¡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(\\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span> time.</p>\n<ol>\n<li>Acting the map <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo>âˆˆ</mo><mi>F</mi></mrow><annotation encoding=\"application/x-tex\">f\\in F</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span></span></span></span> (cf. <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x = f(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>) on all the elements of an interval</li>\n<li>Calculating the product of the elements of an interval</li>\n</ol>\n<p><strong>ä¸­æ–‡ç¿»è¯‘ï¼š</strong></p>\n<p>æ‡’æ ‡è®°çº¿æ®µæ ‘æ˜¯é€‚é…äºæ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„<em><strong>å¹ºåŠç¾¤</strong></em><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mo>&lt;</mo><mi>S</mi><mo separator=\"true\">,</mo><mo>â‹…</mo><mo>&gt;</mo><mo>:</mo><mi>S</mi><mo>â‹…</mo><mi>S</mi><mo>â†’</mo><mi>S</mi><mo separator=\"true\">,</mo><mi>e</mi><mo>âˆˆ</mo><mi>S</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(&lt;S, \\cdot&gt;: S \\cdot S \\to S, e \\in S)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â†’</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mclose\">)</span></span></span></span>å’Œå±äº<em><strong>çº¿æ€§ç©ºé—´</strong></em> <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi><mo>:</mo><mi>S</mi><mo>â†’</mo><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">V:S\\to S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â†’</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span>çš„å­ç©ºé—´<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi></mrow><annotation encoding=\"application/x-tex\">F</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span></span></span></span>:</p>\n<ol>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi></mrow><annotation encoding=\"application/x-tex\">F</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span></span></span></span>æœ‰å•ä½æ˜ å°„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo>âˆˆ</mo><mi>F</mi><mo separator=\"true\">,</mo><mi>s</mi><mi mathvariant=\"normal\">.</mi><mi>t</mi><mi mathvariant=\"normal\">.</mi><mtext>Â </mtext><mi mathvariant=\"normal\">âˆ€</mi><mi>x</mi><mo>âˆˆ</mo><mi>S</mi><mo separator=\"true\">,</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">f\\in F,s.t.\\ \\forall x\\in S, f(x)=x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord\">.</span><span class=\"mord mathnormal\">t</span><span class=\"mord\">.</span><span class=\"mspace\">Â </span><span class=\"mord\">âˆ€</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span></li>\n<li>ä»£æ•°ç³»ç»Ÿ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>&lt;</mo><mi>F</mi><mo separator=\"true\">,</mo><mo>âˆ˜</mo><mo>&gt;</mo></mrow><annotation encoding=\"application/x-tex\">&lt;F,\\circ&gt;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">âˆ˜</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span></span></span></span>å°é—­ï¼Œå…¶ä¸­<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>âˆ˜</mo></mrow><annotation encoding=\"application/x-tex\">\\circ</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4445em;\"></span><span class=\"mord\">âˆ˜</span></span></span></span>è¡¨å‡½æ•°å¤åˆï¼Œä¸æ»¡è¶³äº¤æ¢å¾‹ï¼Œå¤åˆé¡ºåºä»å³åˆ°å·¦ï¼Œå³<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mo>âˆ˜</mo><mi>g</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>g</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(f\\circ g)(x)=f(g(x))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ˜</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">))</span></span></span></span>â€‹</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi></mrow><annotation encoding=\"application/x-tex\">F</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span></span></span></span>å¿…é¡»æ˜¯çº¿æ€§ç©ºé—´ï¼Œå³<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">âˆ€</mi><mi>f</mi><mo>âˆˆ</mo><mi>F</mi><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">\\forall f \\in F,</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\">âˆ€</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mpunct\">,</span></span></span></span> $\\forall x, y \\in S, $  <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo>â‹…</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>â‹…</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(x \\cdot y) = f(x) \\cdot f(y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span>â€‹.</li>\n</ol>\n<p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>çš„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span>ç±»å‹çš„æ•°ç»„ï¼Œè¦æ±‚åœ¨<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mtext>Â </mtext><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(log\\ N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mspace\">Â </span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>çš„æ—¶é—´å†…å®Œæˆä»¥ä¸‹ç±»å‹æ“ä½œï¼š</p>\n<ol>\n<li>\n<p>å¯¹ä¸€ä¸ªæˆ–è€…ä¸€æ®µåŒºé—´çš„å€¼åº”ç”¨çº¿æ€§æ˜ å°„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>â€‹ï¼Œå¹¶æ”¹ä¸ºå¯¹åº”ç»“æœã€‚</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">âˆ€</mi><msub><mi>x</mi><mi>i</mi></msub><mo>âˆˆ</mo><mi>S</mi><mo separator=\"true\">,</mo><mtext>Â </mtext><mi>i</mi><mo>âˆˆ</mo><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mtext>Â </mtext><msub><mi>x</mi><mi>i</mi></msub><mo>:</mo><mo>=</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\forall x_i\\in S,\\ i\\in[l,r), \\ x_i:=f(x_i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\">âˆ€</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct\">,</span><span class=\"mspace\">Â </span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\">Â </span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></p>\n</li>\n<li>\n<p>æ±‚ä¸€ä¸ªæˆ–è€…ä¸€æ®µåŒºé—´çš„å€¼å¯¹å¹ºåŠç¾¤ä¹˜æ³• ï¼ˆ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>â‹…</mo></mrow><annotation encoding=\"application/x-tex\">\\cdot</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4445em;\"></span><span class=\"mord\">â‹…</span></span></span></span>ï¼‰ è¿ç®—çš„ç»“æœã€‚</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mstyle mathsize=\"1.2em\"><mi>a</mi><mi>n</mi><mi>s</mi><mo>=</mo><munderover><mo>âˆ</mo><mrow><mi>i</mi><mo>=</mo><mi>l</mi></mrow><mi>r</mi></munderover><msub><mi>x</mi><mi>i</mi></msub><mo>âˆˆ</mo><mi>S</mi></mstyle></mrow><annotation encoding=\"application/x-tex\">\\large ans=\\prod_{i=l}^r x_i \\in S\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5167em;\"></span><span class=\"mord mathnormal sizing reset-size6 size7\">an</span><span class=\"mord mathnormal sizing reset-size6 size7\">s</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel sizing reset-size6 size7\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.4992em;vertical-align:-1.5348em;\"></span><span class=\"mop op-limits sizing reset-size6 size7\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.637em;\"><span style=\"top:-2.021em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span><span style=\"top:-3.2em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ</span></span></span><span style=\"top:-4.45em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.279em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord sizing reset-size6 size7\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2897em;\"><span style=\"top:-2.65em;margin-left:0em;margin-right:0.0417em;\"><span class=\"pstrut\" style=\"height:2.8em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel sizing reset-size6 size7\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.82em;\"></span><span class=\"mord mathnormal sizing reset-size6 size7\" style=\"margin-right:0.05764em;\">S</span></span></span></span></span></p>\n</li>\n</ol>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"1-1-æ™®é€šçº¿æ®µæ ‘ï¼ˆé™æ€å¼€ç‚¹åŒºé—´åŠ ï¼Œæ°¸ä¹…åŒ–æ‡’æ ‡è®°ï¼Œå½“å¿ƒçˆ†æ ‡è®°é—®é¢˜ï¼Œç é‡å°ï¼‰\">1.1 æ™®é€šçº¿æ®µæ ‘ï¼ˆé™æ€å¼€ç‚¹åŒºé—´åŠ ï¼Œæ°¸ä¹…åŒ–æ‡’æ ‡è®°ï¼Œå½“å¿ƒçˆ†æ ‡è®°é—®é¢˜ï¼Œç é‡å°ï¼‰</h3>\n<p><strong>åˆ‡è®°å•ç‚¹ä¿®æ”¹çš„if-elseå¿…é¡»å†™å…¨ï¼ï¼ï¼</strong></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> int long long</span></span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">node</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> sum;</span><br><span class=\"line\">    <span class=\"type\">int</span> lazy;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">2e5</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\">node tree[maxn &lt;&lt; <span class=\"number\">2</span>];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"type\">int</span> pos, <span class=\"type\">int</span> val, <span class=\"type\">int</span> rt, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    tree[rt].sum += val;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cl == cr)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (pos &lt;= mid)</span><br><span class=\"line\">        <span class=\"built_in\">update</span>(pos, val, rt &lt;&lt; <span class=\"number\">1</span>, cl, mid);</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"built_in\">update</span>(pos, val, rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"type\">int</span> l, <span class=\"type\">int</span> r, <span class=\"type\">int</span> val, <span class=\"type\">int</span> rt, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    tree[rt].sum += val * (<span class=\"built_in\">min</span>(r, cr) - <span class=\"built_in\">max</span>(l, cl) + <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l &lt;= cl &amp;&amp; cr &lt;= r)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        tree[rt].lazy += val;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l &lt;= mid)</span><br><span class=\"line\">        <span class=\"built_in\">update</span>(l, r, val, rt &lt;&lt; <span class=\"number\">1</span>, cl, mid);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (r &gt; mid)</span><br><span class=\"line\">        <span class=\"built_in\">update</span>(l, r, val, rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">query</span><span class=\"params\">(<span class=\"type\">int</span> l, <span class=\"type\">int</span> r, <span class=\"type\">int</span> rt, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l &lt;= cl &amp;&amp; cr &lt;= r)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> tree[rt].sum;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> res = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l &lt;= mid)</span><br><span class=\"line\">        res += <span class=\"built_in\">query</span>(l, r, rt &lt;&lt; <span class=\"number\">1</span>, cl, mid);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (r &gt; mid)</span><br><span class=\"line\">        res += <span class=\"built_in\">query</span>(l, r, rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res + tree[rt].lazy * (<span class=\"built_in\">min</span>(r, cr) - <span class=\"built_in\">max</span>(l, cl) + <span class=\"number\">1</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"type\">int</span> q;</span><br><span class=\"line\">    cin &gt;&gt; q;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> x;</span><br><span class=\"line\">        cin &gt;&gt; x;</span><br><span class=\"line\">        <span class=\"built_in\">update</span>(i, x, <span class=\"number\">1</span>, <span class=\"number\">1</span>, n);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (q--)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> op;</span><br><span class=\"line\">        cin &gt;&gt; op;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (op == <span class=\"number\">1</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> l, r, d;</span><br><span class=\"line\">            cin &gt;&gt; l &gt;&gt; r &gt;&gt; d;</span><br><span class=\"line\">            <span class=\"built_in\">update</span>(l, r, d, <span class=\"number\">1</span>, <span class=\"number\">1</span>, n);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> l, r;</span><br><span class=\"line\">            cin &gt;&gt; l &gt;&gt; r;</span><br><span class=\"line\">            cout &lt;&lt; <span class=\"built_in\">query</span>(l, r, <span class=\"number\">1</span>, <span class=\"number\">1</span>, n) &lt;&lt; endl;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"1-2-æ™®é€šçº¿æ®µæ ‘-é™æ€å¼€ç‚¹åŒºé—´åŠ ï¼Œæ ‡è®°æ°¸ä¹…åŒ–\">1.2 æ™®é€šçº¿æ®µæ ‘(é™æ€å¼€ç‚¹åŒºé—´åŠ ï¼Œæ ‡è®°æ°¸ä¹…åŒ–)</h3>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> int long long</span></span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">node</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> sum;</span><br><span class=\"line\">    <span class=\"type\">int</span> lazy;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">2e5</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\">node tree[maxn &lt;&lt; <span class=\"number\">2</span>];</span><br><span class=\"line\"><span class=\"type\">int</span> a[maxn];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">pushup</span><span class=\"params\">(<span class=\"type\">int</span> rt)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    tree[rt].sum = tree[rt &lt;&lt; <span class=\"number\">1</span>].sum + tree[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>].sum;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">pushdown</span><span class=\"params\">(<span class=\"type\">int</span> rt, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (tree[rt].lazy)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        tree[rt &lt;&lt; <span class=\"number\">1</span>].lazy += tree[rt].lazy;</span><br><span class=\"line\">        tree[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>].lazy += tree[rt].lazy;</span><br><span class=\"line\">        tree[rt &lt;&lt; <span class=\"number\">1</span>].sum += tree[rt].lazy * (mid - cl + <span class=\"number\">1</span>);</span><br><span class=\"line\">        tree[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>].sum += tree[rt].lazy * (cr - mid);</span><br><span class=\"line\">        tree[rt].lazy = <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">build</span><span class=\"params\">(<span class=\"type\">int</span> rt, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cl == cr)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        tree[rt] = &#123;a[cl], <span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">build</span>(rt &lt;&lt; <span class=\"number\">1</span>, cl, mid);</span><br><span class=\"line\">    <span class=\"built_in\">build</span>(rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">    <span class=\"built_in\">pushup</span>(rt);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"type\">int</span> pos, <span class=\"type\">int</span> val, <span class=\"type\">int</span> rt, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cl == cr)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        tree[rt].sum += val;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (pos &lt;= mid)</span><br><span class=\"line\">        <span class=\"built_in\">update</span>(pos, val, rt &lt;&lt; <span class=\"number\">1</span>, cl, mid);</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"built_in\">update</span>(pos, val, rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">    <span class=\"built_in\">pushup</span>(rt);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"type\">int</span> l, <span class=\"type\">int</span> r, <span class=\"type\">int</span> val, <span class=\"type\">int</span> rt, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l &lt;= cl &amp;&amp; cr &lt;= r)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        tree[rt].sum += val * (cr - cl + <span class=\"number\">1</span>);</span><br><span class=\"line\">        tree[rt].lazy += val;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">pushdown</span>(rt, cl, cr);</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l &lt;= mid)</span><br><span class=\"line\">        <span class=\"built_in\">update</span>(l, r, val, rt &lt;&lt; <span class=\"number\">1</span>, cl, mid);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (r &gt; mid)</span><br><span class=\"line\">        <span class=\"built_in\">update</span>(l, r, val, rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">    <span class=\"built_in\">pushup</span>(rt);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">query</span><span class=\"params\">(<span class=\"type\">int</span> l, <span class=\"type\">int</span> r, <span class=\"type\">int</span> rt, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l &lt;= cl &amp;&amp; cr &lt;= r)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> tree[rt].sum;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">pushdown</span>(rt, cl, cr);</span><br><span class=\"line\">    <span class=\"type\">int</span> res = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l &lt;= mid)</span><br><span class=\"line\">        res += <span class=\"built_in\">query</span>(l, r, rt &lt;&lt; <span class=\"number\">1</span>, cl, mid);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (r &gt; mid)</span><br><span class=\"line\">        res += <span class=\"built_in\">query</span>(l, r, rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"type\">int</span> q;</span><br><span class=\"line\">    cin &gt;&gt; q;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> x;</span><br><span class=\"line\">        cin &gt;&gt; x;</span><br><span class=\"line\">        <span class=\"built_in\">update</span>(i, x, <span class=\"number\">1</span>, <span class=\"number\">1</span>, n);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (q--)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> op;</span><br><span class=\"line\">        cin &gt;&gt; op;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (op == <span class=\"number\">1</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> l, r, d;</span><br><span class=\"line\">            cin &gt;&gt; l &gt;&gt; r &gt;&gt; d;</span><br><span class=\"line\">            <span class=\"built_in\">update</span>(l, r, d, <span class=\"number\">1</span>, <span class=\"number\">1</span>, n);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> l, r;</span><br><span class=\"line\">            cin &gt;&gt; l &gt;&gt; r;</span><br><span class=\"line\">            cout &lt;&lt; <span class=\"built_in\">query</span>(l, r, <span class=\"number\">1</span>, <span class=\"number\">1</span>, n) &lt;&lt; endl;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"1-3-æ™®é€šçº¿æ®µæ ‘ï¼ˆé™æ€åŒºé—´åŠ ã€åŒºé—´ä¹˜ï¼Œéæ°¸ä¹…åŒ–ï¼‰\">1.3 æ™®é€šçº¿æ®µæ ‘ï¼ˆé™æ€åŒºé—´åŠ ã€åŒºé—´ä¹˜ï¼Œéæ°¸ä¹…åŒ–ï¼‰</h3>\n<p>è´´å‡ºæ¥è®°å¾—æ‡’æ ‡è®°é¡ºåºæ€è€ƒé—®é¢˜ã€‚æ³¨æ„ï¼Œæ‡’æ ‡è®°ä¸‹ä¼ çš„æ—¶å€™æ˜¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mrow><mi>r</mi><mi>t</mi></mrow></msub><mtext>Â </mtext><mo>âˆ˜</mo><mtext>Â </mtext><msub><mi>f</mi><mrow><mi>s</mi><mi>o</mi><mi>n</mi><mi>s</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">f_{rt}\\ \\circ \\ f_{sons}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\">Â </span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ˜</span><span class=\"mspace\">Â </span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">so</span><span class=\"mord mathnormal mtight\">n</span><span class=\"mord mathnormal mtight\">s</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>çš„å¤åˆå‡½æ•°é¡ºåºã€‚æ ¹æ®Segtrees.hæ€æƒ³æ€è€ƒã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;icpc-model/Modint.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> Modint;</span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> int long long</span></span><br><span class=\"line\"><span class=\"keyword\">using</span> mint = MLong&lt;<span class=\"number\">0</span>&gt;;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">node</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    mint sum;</span><br><span class=\"line\">    mint lazyadd = <span class=\"number\">0</span>;</span><br><span class=\"line\">    mint lazymul = <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">2e5</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\">node tree[maxn &lt;&lt; <span class=\"number\">2</span>];</span><br><span class=\"line\">mint a[maxn];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">pushup</span><span class=\"params\">(<span class=\"type\">int</span> rt)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    tree[rt].sum = tree[rt &lt;&lt; <span class=\"number\">1</span>].sum + tree[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>].sum;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">pushdown</span><span class=\"params\">(<span class=\"type\">int</span> rt, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// å„¿å­èŠ‚ç‚¹å·²æœ‰ax+b,ä¼ ä¸‹æ¥c(ax+b)+d=cax+cb+d);</span></span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (tree[rt].lazyadd != <span class=\"number\">0</span> || tree[rt].lazymul != <span class=\"number\">1</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        tree[rt &lt;&lt; <span class=\"number\">1</span>].lazyadd *= tree[rt].lazymul;</span><br><span class=\"line\">        tree[rt &lt;&lt; <span class=\"number\">1</span>].lazyadd += tree[rt].lazyadd;</span><br><span class=\"line\"></span><br><span class=\"line\">        tree[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>].lazyadd *= tree[rt].lazymul;</span><br><span class=\"line\">        tree[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>].lazyadd += tree[rt].lazyadd;</span><br><span class=\"line\"></span><br><span class=\"line\">        tree[rt &lt;&lt; <span class=\"number\">1</span>].lazymul *= tree[rt].lazymul;</span><br><span class=\"line\">        tree[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>].lazymul *= tree[rt].lazymul;</span><br><span class=\"line\"></span><br><span class=\"line\">        tree[rt &lt;&lt; <span class=\"number\">1</span>].sum = tree[rt &lt;&lt; <span class=\"number\">1</span>].sum * tree[rt].lazymul + tree[rt].lazyadd * (mid - cl + <span class=\"number\">1</span>);</span><br><span class=\"line\">        tree[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>].sum = tree[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>].sum * tree[rt].lazymul + tree[rt].lazyadd * (cr - mid);</span><br><span class=\"line\">        tree[rt].lazyadd = <span class=\"number\">0</span>;</span><br><span class=\"line\">        tree[rt].lazymul = <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">build</span><span class=\"params\">(<span class=\"type\">int</span> rt, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cl == cr)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        tree[rt].sum = a[cl];</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">build</span>(rt &lt;&lt; <span class=\"number\">1</span>, cl, mid);</span><br><span class=\"line\">    <span class=\"built_in\">build</span>(rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">    <span class=\"built_in\">pushup</span>(rt);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"type\">int</span> l, <span class=\"type\">int</span> r, <span class=\"type\">int</span> add, <span class=\"type\">int</span> mul, <span class=\"type\">int</span> rt, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l &lt;= cl &amp;&amp; cr &lt;= r)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        tree[rt].sum *= mul;</span><br><span class=\"line\">        tree[rt].sum += add * (cr - cl + <span class=\"number\">1</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        tree[rt].lazyadd *= mul;</span><br><span class=\"line\">        tree[rt].lazyadd += add;</span><br><span class=\"line\"></span><br><span class=\"line\">        tree[rt].lazymul *= mul;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">pushdown</span>(rt, cl, cr);</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l &lt;= mid)</span><br><span class=\"line\">        <span class=\"built_in\">update</span>(l, r, add, mul, rt &lt;&lt; <span class=\"number\">1</span>, cl, mid);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (r &gt; mid)</span><br><span class=\"line\">        <span class=\"built_in\">update</span>(l, r, add, mul, rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">    <span class=\"built_in\">pushup</span>(rt);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">mint <span class=\"title\">query</span><span class=\"params\">(<span class=\"type\">int</span> l, <span class=\"type\">int</span> r, <span class=\"type\">int</span> rt, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l &lt;= cl &amp;&amp; cr &lt;= r)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> tree[rt].sum;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">pushdown</span>(rt, cl, cr);</span><br><span class=\"line\">    mint res = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l &lt;= mid)</span><br><span class=\"line\">        res += <span class=\"built_in\">query</span>(l, r, rt &lt;&lt; <span class=\"number\">1</span>, cl, mid);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (r &gt; mid)</span><br><span class=\"line\">        res += <span class=\"built_in\">query</span>(l, r, rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"type\">int</span> q;</span><br><span class=\"line\">    cin &gt;&gt; q;</span><br><span class=\"line\">    <span class=\"type\">int</span> m;</span><br><span class=\"line\">    cin &gt;&gt; m;</span><br><span class=\"line\">    mint::<span class=\"built_in\">setMod</span>(m);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cin &gt;&gt; a[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">build</span>(<span class=\"number\">1</span>, <span class=\"number\">1</span>, n);</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (q--)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> op;</span><br><span class=\"line\">        cin &gt;&gt; op;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (op == <span class=\"number\">1</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> l, r, d;</span><br><span class=\"line\">            cin &gt;&gt; l &gt;&gt; r &gt;&gt; d;</span><br><span class=\"line\">            <span class=\"built_in\">update</span>(l, r, <span class=\"number\">0</span>, d, <span class=\"number\">1</span>, <span class=\"number\">1</span>, n);</span><br><span class=\"line\">            <span class=\"comment\">/*for (int i = 1; i &lt;= n; i++)</span></span><br><span class=\"line\"><span class=\"comment\">            &#123;</span></span><br><span class=\"line\"><span class=\"comment\">                cout &lt;&lt; query(i, i, 1, 1, n) &lt;&lt; &quot; &quot;;</span></span><br><span class=\"line\"><span class=\"comment\">            &#125;</span></span><br><span class=\"line\"><span class=\"comment\">            cout &lt;&lt; endl;*/</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (op == <span class=\"number\">2</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> l, r, d;</span><br><span class=\"line\">            cin &gt;&gt; l &gt;&gt; r &gt;&gt; d;</span><br><span class=\"line\">            <span class=\"built_in\">update</span>(l, r, d, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, n);</span><br><span class=\"line\">            <span class=\"comment\">/*for (int i = 1; i &lt;= n; i++)</span></span><br><span class=\"line\"><span class=\"comment\">            &#123;</span></span><br><span class=\"line\"><span class=\"comment\">                cout &lt;&lt; query(i, i, 1, 1, n) &lt;&lt; &quot; &quot;;</span></span><br><span class=\"line\"><span class=\"comment\">            &#125;</span></span><br><span class=\"line\"><span class=\"comment\">            cout &lt;&lt; endl;*/</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> l, r;</span><br><span class=\"line\">            cin &gt;&gt; l &gt;&gt; r;</span><br><span class=\"line\">            cout &lt;&lt; <span class=\"built_in\">query</span>(l, r, <span class=\"number\">1</span>, <span class=\"number\">1</span>, n) &lt;&lt; endl;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"1-4-Segtree-h-lazy-segtree\">1.4 Segtree.h/lazy_segtree</h3>\n<p>ACLibraryçº¿æ®µæ ‘ï¼Œéé€’å½’æ¨¡å¼ï¼Œçº¿æ®µæ ‘ä¸‹æ ‡ä»0å¼€å§‹ã€‚ä¸‹æ–‡æ‰€æåŠåŒºé—´é»˜è®¤å·¦é—­å³å¼€ã€‚</p>\n<p>å‡½æ•°åˆ—è¡¨</p>\n<p><code>bit_ceil</code> : å–æ¯”å‚æ•°å¤§çš„æœ€è¿‘çš„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">2^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span></p>\n<p><code>countr_zero</code> : å–å‚æ•°çš„äºŒè¿›åˆ¶ç»“å°¾æœ‰å¤šå°‘ä¸ª<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span></p>\n<p><code>pushup</code> : å­—é¢å«ä¹‰</p>\n<p><code>upd</code> : ä¿®æ”¹å®Œæ•´çº¿æ®µæ ‘èŠ‚ç‚¹æ‰€ä»£è¡¨åŒºé—´</p>\n<p><code>pushdown</code> ï¼š å­—é¢å«ä¹‰</p>\n<p><code>explicit lazy_segtree(const vector&lt;S&gt; &amp;v)</code> : æ„é€ å‡½æ•°</p>\n<p><code>void set(int p, S x)</code> : å•ç‚¹ä¿®æ”¹ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>ï¼ˆ<em><strong>å•ç‚¹æ”¹ä¸º</strong></em>ï¼‰</p>\n<p><code>S get(int p)</code> : å•ç‚¹æŸ¥è¯¢</p>\n<p><code>S query(int l, int r)</code> : æŸ¥è¯¢åŒºé—´<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">[l,r)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span></span></span></span>è¿›è¡Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>o</mi><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">op</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">p</span></span></span></span>çš„ç»“æœ</p>\n<p><code>void modify(int p, F f)</code> : å•ç‚¹åº”ç”¨ä¿®æ”¹ï¼ˆ<em><strong>å•ç‚¹åŠ </strong></em>ï¼‰</p>\n<p><code>void modify(int l, int r, F f)</code> : åŒºé—´<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">[l,r)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span></span></span></span>åº”ç”¨ä¿®æ”¹ (<em><strong>åŒºé—´åŠ </strong></em>)</p>\n<p><code>template &lt;bool (*g)(S)&gt; int max_right(int l)</code> : çº¿æ®µæ ‘äºŒåˆ†æŸ¥è¯¢ä»<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi></mrow><annotation encoding=\"application/x-tex\">l</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span></span></span></span>å¼€å§‹çš„æœ€å³ç«¯ç‚¹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span>ï¼Œæ»¡è¶³<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>o</mi><mi>p</mi><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>l</mi><mo>+</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><mstyle mathcolor=\"red\"><mi>r</mi><mo>âˆ’</mo><mn>1</mn></mstyle><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">)</mo><mo>=</mo><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi></mrow><annotation encoding=\"application/x-tex\">g(op[l,l+1,\\cdots,\\textcolor{red}{r-1}])=true</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;color:red;\">r</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\" style=\"color:red;\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\" style=\"color:red;\">1</span><span class=\"mclose\">])</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">e</span></span></span></span>.</p>\n<p><code>template &lt;bool (*g)(S)&gt; int min_left(int r)</code> : çº¿æ®µæ ‘äºŒåˆ†æŸ¥è¯¢åˆ°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span>çš„æœ€å·¦ç«¯ç‚¹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi></mrow><annotation encoding=\"application/x-tex\">l</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span></span></span></span>ï¼Œæ»¡è¶³<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>o</mi><mi>p</mi><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>l</mi><mo>+</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><mstyle mathcolor=\"red\"><mi>r</mi><mo>âˆ’</mo><mn>1</mn></mstyle><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">)</mo><mo>=</mo><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi></mrow><annotation encoding=\"application/x-tex\">g(op[l,l+1,\\cdots,\\textcolor{red}{r-1}])=true</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;color:red;\">r</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\" style=\"color:red;\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\" style=\"color:red;\">1</span><span class=\"mclose\">])</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">e</span></span></span></span>.</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">namespace</span> Segtrees</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">bit_ceil</span><span class=\"params\">(<span class=\"type\">int</span> n)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> x = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (x &lt; n)</span><br><span class=\"line\">            x *= <span class=\"number\">2</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> x;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">countr_zero</span><span class=\"params\">(<span class=\"type\">unsigned</span> <span class=\"type\">int</span> n)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> __builtin_ctz(n);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">template</span> &lt;<span class=\"keyword\">class</span> <span class=\"title class_\">S</span>,<span class=\"built_in\">S</span> (*op)(S, S),<span class=\"built_in\">S</span> (*e)(),<span class=\"keyword\">class</span> <span class=\"title class_\">F</span>,<span class=\"built_in\">S</span> (*mp)(F, S),<span class=\"built_in\">F</span> (*comp)(F, F),<span class=\"built_in\">F</span> (*id)()&gt;</span><br><span class=\"line\">    <span class=\"keyword\">struct</span> <span class=\"title class_\">lazy_segtree</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span>:</span><br><span class=\"line\">        <span class=\"type\">int</span> _n, size, log;</span><br><span class=\"line\">        vector&lt;S&gt; d;</span><br><span class=\"line\">        vector&lt;F&gt; lz;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">pushup</span><span class=\"params\">(<span class=\"type\">int</span> k)</span> </span>&#123; d[k] = <span class=\"built_in\">op</span>(d[k &lt;&lt; <span class=\"number\">1</span>], d[k &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>]); &#125;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">upd</span><span class=\"params\">(<span class=\"type\">int</span> k, F f)</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            d[k] = <span class=\"built_in\">mp</span>(f, d[k]);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (k &lt; size)</span><br><span class=\"line\">                lz[k] = <span class=\"built_in\">comp</span>(f, lz[k]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">pushdown</span><span class=\"params\">(<span class=\"type\">int</span> k)</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"built_in\">upd</span>(k &lt;&lt; <span class=\"number\">1</span>, lz[k]);</span><br><span class=\"line\">            <span class=\"built_in\">upd</span>(k &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>, lz[k]);</span><br><span class=\"line\">            lz[k] = <span class=\"built_in\">id</span>();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span>:</span><br><span class=\"line\">        <span class=\"built_in\">lazy_segtree</span>() : <span class=\"built_in\">lazy_segtree</span>(<span class=\"number\">0</span>) &#123;&#125;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">explicit</span> <span class=\"title\">lazy_segtree</span><span class=\"params\">(<span class=\"type\">int</span> n)</span> : lazy_segtree(vector&lt;S&gt;(n, e())) &#123;</span>&#125;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">explicit</span> <span class=\"title\">lazy_segtree</span><span class=\"params\">(<span class=\"type\">const</span> vector&lt;S&gt; &amp;v)</span> : _n(int(v.size()))</span></span><br><span class=\"line\"><span class=\"function\">        &#123;</span></span><br><span class=\"line\">            size = <span class=\"built_in\">bit_ceil</span>((_n));</span><br><span class=\"line\">            log = <span class=\"built_in\">countr_zero</span>(size);</span><br><span class=\"line\">            d = <span class=\"built_in\">vector</span>&lt;S&gt;(<span class=\"number\">2</span> * size, <span class=\"built_in\">e</span>());</span><br><span class=\"line\">            lz = <span class=\"built_in\">vector</span>&lt;F&gt;(size, <span class=\"built_in\">id</span>());</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; _n; i++)</span><br><span class=\"line\">                d[size + i] = v[i];</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = size - <span class=\"number\">1</span>; i &gt;= <span class=\"number\">1</span>; i--)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"built_in\">pushup</span>(i);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">set</span><span class=\"params\">(<span class=\"type\">int</span> p, S x)</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"built_in\">assert</span>(<span class=\"number\">0</span> &lt;= p &amp;&amp; p &lt; _n);</span><br><span class=\"line\">            p += size;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = log; i &gt;= <span class=\"number\">1</span>; i--)</span><br><span class=\"line\">                <span class=\"built_in\">pushdown</span>(p &gt;&gt; i);</span><br><span class=\"line\">            d[p] = x;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= log; i++)</span><br><span class=\"line\">                <span class=\"built_in\">pushup</span>(p &gt;&gt; i);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"function\">S <span class=\"title\">get</span><span class=\"params\">(<span class=\"type\">int</span> p)</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"built_in\">assert</span>(<span class=\"number\">0</span> &lt;= p &amp;&amp; p &lt; _n);</span><br><span class=\"line\">            p += size;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = log; i &gt;= <span class=\"number\">1</span>; i--)</span><br><span class=\"line\">                <span class=\"built_in\">pushdown</span>(p &gt;&gt; i);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> d[p];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">/*æŸ¥è¯¢åŒºé—´[l,r)çš„ç»“æœ,l=ræ—¶è¿”å›å¹ºå…ƒ*/</span></span><br><span class=\"line\">        <span class=\"function\">S <span class=\"title\">query</span><span class=\"params\">(<span class=\"type\">int</span> l, <span class=\"type\">int</span> r)</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"built_in\">assert</span>(<span class=\"number\">0</span> &lt;= l &amp;&amp; l &lt;= r &amp;&amp; r &lt;= _n);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (l == r)</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"built_in\">e</span>();</span><br><span class=\"line\">            l += size;</span><br><span class=\"line\">            r += size;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = log; i &gt;= <span class=\"number\">1</span>; i--)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (((l &gt;&gt; i) &lt;&lt; i) != l)</span><br><span class=\"line\">                    <span class=\"built_in\">pushdown</span>(l &gt;&gt; i);</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (((r &gt;&gt; i) &lt;&lt; i) != r)</span><br><span class=\"line\">                    <span class=\"built_in\">pushdown</span>((r - <span class=\"number\">1</span>) &gt;&gt; i);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            S sml = <span class=\"built_in\">e</span>(), smr = <span class=\"built_in\">e</span>();</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (l &lt; r)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (l &amp; <span class=\"number\">1</span>)</span><br><span class=\"line\">                    sml = <span class=\"built_in\">op</span>(sml, d[l++]);</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (r &amp; <span class=\"number\">1</span>)</span><br><span class=\"line\">                    smr = <span class=\"built_in\">op</span>(d[--r], smr);</span><br><span class=\"line\">                l &gt;&gt;= <span class=\"number\">1</span>;</span><br><span class=\"line\">                r &gt;&gt;= <span class=\"number\">1</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">op</span>(sml, smr);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"function\">S <span class=\"title\">all_query</span><span class=\"params\">()</span> </span>&#123; <span class=\"keyword\">return</span> d[<span class=\"number\">1</span>]; &#125;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">modify</span><span class=\"params\">(<span class=\"type\">int</span> p, F f)</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"built_in\">assert</span>(<span class=\"number\">0</span> &lt;= p &amp;&amp; p &lt; _n);</span><br><span class=\"line\">            p += size;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = log; i &gt;= <span class=\"number\">1</span>; i--)</span><br><span class=\"line\">                <span class=\"built_in\">pushdown</span>(p &gt;&gt; i);</span><br><span class=\"line\">            d[p] = <span class=\"built_in\">mp</span>(f, d[p]);</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= log; i++)</span><br><span class=\"line\">                <span class=\"built_in\">pushup</span>(p &gt;&gt; i);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">modify</span><span class=\"params\">(<span class=\"type\">int</span> l, <span class=\"type\">int</span> r, F f)</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"built_in\">assert</span>(<span class=\"number\">0</span> &lt;= l &amp;&amp; l &lt;= r &amp;&amp; r &lt;= _n);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (l == r)</span><br><span class=\"line\">                <span class=\"keyword\">return</span>;</span><br><span class=\"line\">            l += size;</span><br><span class=\"line\">            r += size;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = log; i &gt;= <span class=\"number\">1</span>; i--)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (((l &gt;&gt; i) &lt;&lt; i) != l)</span><br><span class=\"line\">                    <span class=\"built_in\">pushdown</span>(l &gt;&gt; i);</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (((r &gt;&gt; i) &lt;&lt; i) != r)</span><br><span class=\"line\">                    <span class=\"built_in\">pushdown</span>((r - <span class=\"number\">1</span>) &gt;&gt; i);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"type\">int</span> l2 = l, r2 = r;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (l &lt; r)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (l &amp; <span class=\"number\">1</span>)</span><br><span class=\"line\">                    <span class=\"built_in\">upd</span>(l++, f);</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (r &amp; <span class=\"number\">1</span>)</span><br><span class=\"line\">                    <span class=\"built_in\">upd</span>(--r, f);</span><br><span class=\"line\">                l &gt;&gt;= <span class=\"number\">1</span>;</span><br><span class=\"line\">                r &gt;&gt;= <span class=\"number\">1</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            l = l2;</span><br><span class=\"line\">            r = r2;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= log; i++)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (((l &gt;&gt; i) &lt;&lt; i) != l)</span><br><span class=\"line\">                    <span class=\"built_in\">pushup</span>(l &gt;&gt; i);</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (((r &gt;&gt; i) &lt;&lt; i) != r)</span><br><span class=\"line\">                    <span class=\"built_in\">pushup</span>((r - <span class=\"number\">1</span>) &gt;&gt; i);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">         * @brief çº¿æ®µæ ‘äºŒåˆ†ï¼ŒæŸ¥è¯¢åŒºé—´[l,n)æ»¡è¶³gçš„æœ€å³ç«¯ç‚¹r</span></span><br><span class=\"line\"><span class=\"comment\">         * @tparam G æŸ¥è¯¢å‡½æ•°gï¼Œå‚æ•°ç±»å‹S</span></span><br><span class=\"line\"><span class=\"comment\">         * @param l åŒºé—´å·¦ç«¯ç‚¹</span></span><br><span class=\"line\"><span class=\"comment\">         * @return åŒºé—´[l,n)æ»¡è¶³g( op([l,l+1,Â·Â·Â·,r) )çš„æœ€å³ç«¯ç‚¹r</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"keyword\">template</span> &lt;<span class=\"built_in\">bool</span> (*g)(S)&gt;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">max_right</span><span class=\"params\">(<span class=\"type\">int</span> l)</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">max_right</span>(l, [](S x)</span><br><span class=\"line\">                             &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">g</span>(x); &#125;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">template</span> &lt;<span class=\"keyword\">class</span> <span class=\"title class_\">G</span>&gt;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">max_right</span><span class=\"params\">(<span class=\"type\">int</span> l, G g)</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"built_in\">assert</span>(<span class=\"number\">0</span> &lt;= l &amp;&amp; l &lt;= _n);</span><br><span class=\"line\">            <span class=\"built_in\">assert</span>(<span class=\"built_in\">g</span>(<span class=\"built_in\">e</span>()));</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (l == _n)</span><br><span class=\"line\">                <span class=\"keyword\">return</span> _n;</span><br><span class=\"line\">            l += size;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = log; i &gt;= <span class=\"number\">1</span>; i--)</span><br><span class=\"line\">                <span class=\"built_in\">pushdown</span>(l &gt;&gt; i);</span><br><span class=\"line\">            S sm = <span class=\"built_in\">e</span>();</span><br><span class=\"line\">            <span class=\"keyword\">do</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">while</span> (l % <span class=\"number\">2</span> == <span class=\"number\">0</span>)</span><br><span class=\"line\">                    l &gt;&gt;= <span class=\"number\">1</span>;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (!<span class=\"built_in\">g</span>(<span class=\"built_in\">op</span>(sm, d[l])))</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">while</span> (l &lt; size)</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        <span class=\"built_in\">pushdown</span>(l);</span><br><span class=\"line\">                        l = (<span class=\"number\">2</span> * l);</span><br><span class=\"line\">                        <span class=\"keyword\">if</span> (<span class=\"built_in\">g</span>(<span class=\"built_in\">op</span>(sm, d[l])))</span><br><span class=\"line\">                        &#123;</span><br><span class=\"line\">                            sm = <span class=\"built_in\">op</span>(sm, d[l]);</span><br><span class=\"line\">                            l++;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> l - size;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                sm = <span class=\"built_in\">op</span>(sm, d[l]);</span><br><span class=\"line\">                l++;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">while</span> ((l &amp; -l) != l);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> _n;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">template</span> &lt;<span class=\"built_in\">bool</span> (*g)(S)&gt;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">min_left</span><span class=\"params\">(<span class=\"type\">int</span> r)</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">min_left</span>(r, [](S x)</span><br><span class=\"line\">                            &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">g</span>(x); &#125;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">template</span> &lt;<span class=\"keyword\">class</span> <span class=\"title class_\">G</span>&gt;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">min_left</span><span class=\"params\">(<span class=\"type\">int</span> r, G g)</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"built_in\">assert</span>(<span class=\"number\">0</span> &lt;= r &amp;&amp; r &lt;= _n);</span><br><span class=\"line\">            <span class=\"built_in\">assert</span>(<span class=\"built_in\">g</span>(<span class=\"built_in\">e</span>()));</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (r == <span class=\"number\">0</span>)</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            r += size;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = log; i &gt;= <span class=\"number\">1</span>; i--)</span><br><span class=\"line\">                <span class=\"built_in\">pushdown</span>((r - <span class=\"number\">1</span>) &gt;&gt; i);</span><br><span class=\"line\">            S sm = <span class=\"built_in\">e</span>();</span><br><span class=\"line\">            <span class=\"keyword\">do</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                r--;</span><br><span class=\"line\">                <span class=\"keyword\">while</span> (r &gt; <span class=\"number\">1</span> &amp;&amp; (r % <span class=\"number\">2</span>))</span><br><span class=\"line\">                    r &gt;&gt;= <span class=\"number\">1</span>;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (!<span class=\"built_in\">g</span>(<span class=\"built_in\">op</span>(d[r], sm)))</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">while</span> (r &lt; size)</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        <span class=\"built_in\">pushdown</span>(r);</span><br><span class=\"line\">                        r = (<span class=\"number\">2</span> * r + <span class=\"number\">1</span>);</span><br><span class=\"line\">                        <span class=\"keyword\">if</span> (<span class=\"built_in\">g</span>(<span class=\"built_in\">op</span>(d[r], sm)))</span><br><span class=\"line\">                        &#123;</span><br><span class=\"line\">                            sm = <span class=\"built_in\">op</span>(d[r], sm);</span><br><span class=\"line\">                            r--;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> r + <span class=\"number\">1</span> - size;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                sm = <span class=\"built_in\">op</span>(d[r], sm);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">while</span> ((r &amp; -r) != r);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"1-5-Segtree-h-segtree\">1.5 Segtree.h/segtree</h3>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">namespace</span> Segtrees</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">template</span> &lt;<span class=\"keyword\">class</span> <span class=\"title class_\">S</span>, <span class=\"built_in\">S</span> (*op)(S, S), <span class=\"built_in\">S</span> (*e)()&gt;</span><br><span class=\"line\">    <span class=\"keyword\">struct</span> <span class=\"title class_\">segtree</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span>:</span><br><span class=\"line\">        <span class=\"built_in\">segtree</span>() : <span class=\"built_in\">segtree</span>(<span class=\"number\">0</span>) &#123;&#125;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">explicit</span> <span class=\"title\">segtree</span><span class=\"params\">(<span class=\"type\">int</span> n)</span> : segtree(vector&lt;S&gt;(n, e())) &#123;</span>&#125;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">explicit</span> <span class=\"title\">segtree</span><span class=\"params\">(<span class=\"type\">const</span> vector&lt;S&gt; &amp;v)</span> : _n(v.size())</span></span><br><span class=\"line\"><span class=\"function\">        &#123;</span></span><br><span class=\"line\">            size = <span class=\"built_in\">bit_ceil</span>(_n);</span><br><span class=\"line\">            log = <span class=\"built_in\">countr_zero</span>(size);</span><br><span class=\"line\">            d = <span class=\"built_in\">vector</span>&lt;S&gt;(<span class=\"number\">2</span> * size, <span class=\"built_in\">e</span>());</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; _n; i++)</span><br><span class=\"line\">                d[size + i] = v[i];</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = size - <span class=\"number\">1</span>; i &gt;= <span class=\"number\">1</span>; i--)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"built_in\">pushup</span>(i);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">set</span><span class=\"params\">(<span class=\"type\">int</span> p, S x)</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"built_in\">assert</span>(<span class=\"number\">0</span> &lt;= p &amp;&amp; p &lt; _n);</span><br><span class=\"line\">            p += size;</span><br><span class=\"line\">            d[p] = x;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= log; i++)</span><br><span class=\"line\">                <span class=\"built_in\">pushup</span>(p &gt;&gt; i);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"function\">S <span class=\"title\">get</span><span class=\"params\">(<span class=\"type\">int</span> p)</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"built_in\">assert</span>(<span class=\"number\">0</span> &lt;= p &amp;&amp; p &lt; _n);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> d[p + size];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"function\">S <span class=\"title\">query</span><span class=\"params\">(<span class=\"type\">int</span> l, <span class=\"type\">int</span> r)</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"built_in\">assert</span>(<span class=\"number\">0</span> &lt;= l &amp;&amp; l &lt;= r &amp;&amp; r &lt;= _n);</span><br><span class=\"line\">            S sml = <span class=\"built_in\">e</span>(), smr = <span class=\"built_in\">e</span>();</span><br><span class=\"line\">            l += size;</span><br><span class=\"line\">            r += size;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">while</span> (l &lt; r)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (l &amp; <span class=\"number\">1</span>)</span><br><span class=\"line\">                    sml = <span class=\"built_in\">op</span>(sml, d[l++]);</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (r &amp; <span class=\"number\">1</span>)</span><br><span class=\"line\">                    smr = <span class=\"built_in\">op</span>(d[--r], smr);</span><br><span class=\"line\">                l &gt;&gt;= <span class=\"number\">1</span>;</span><br><span class=\"line\">                r &gt;&gt;= <span class=\"number\">1</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">op</span>(sml, smr);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"function\">S <span class=\"title\">all_query</span><span class=\"params\">()</span> <span class=\"type\">const</span> </span>&#123; <span class=\"keyword\">return</span> d[<span class=\"number\">1</span>]; &#125;</span><br><span class=\"line\">        <span class=\"keyword\">template</span> &lt;<span class=\"built_in\">bool</span> (*f)(S)&gt;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">max_right</span><span class=\"params\">(<span class=\"type\">int</span> l)</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">max_right</span>(l, [](S x)</span><br><span class=\"line\">                             &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">f</span>(x); &#125;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">template</span> &lt;<span class=\"keyword\">class</span> <span class=\"title class_\">F</span>&gt;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">max_right</span><span class=\"params\">(<span class=\"type\">int</span> l, F f)</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"built_in\">assert</span>(<span class=\"number\">0</span> &lt;= l &amp;&amp; l &lt;= _n);</span><br><span class=\"line\">            <span class=\"built_in\">assert</span>(<span class=\"built_in\">f</span>(<span class=\"built_in\">e</span>()));</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (l == _n)</span><br><span class=\"line\">                <span class=\"keyword\">return</span> _n;</span><br><span class=\"line\">            l += size;</span><br><span class=\"line\">            S sm = <span class=\"built_in\">e</span>();</span><br><span class=\"line\">            <span class=\"keyword\">do</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">while</span> (l % <span class=\"number\">2</span> == <span class=\"number\">0</span>)</span><br><span class=\"line\">                    l &gt;&gt;= <span class=\"number\">1</span>;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (!<span class=\"built_in\">f</span>(<span class=\"built_in\">op</span>(sm, d[l])))</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">while</span> (l &lt; size)</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        l = (<span class=\"number\">2</span> * l);</span><br><span class=\"line\">                        <span class=\"keyword\">if</span> (<span class=\"built_in\">f</span>(<span class=\"built_in\">op</span>(sm, d[l])))</span><br><span class=\"line\">                        &#123;</span><br><span class=\"line\">                            sm = <span class=\"built_in\">op</span>(sm, d[l]);</span><br><span class=\"line\">                            l++;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> l - size;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                sm = <span class=\"built_in\">op</span>(sm, d[l]);</span><br><span class=\"line\">                l++;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">while</span> ((l &amp; -l) != l);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> _n;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">template</span> &lt;<span class=\"built_in\">bool</span> (*f)(S)&gt;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">min_left</span><span class=\"params\">(<span class=\"type\">int</span> r)</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">min_left</span>(r, [](S x)</span><br><span class=\"line\">                            &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">f</span>(x); &#125;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">template</span> &lt;<span class=\"keyword\">class</span> <span class=\"title class_\">F</span>&gt;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">min_left</span><span class=\"params\">(<span class=\"type\">int</span> r, F f)</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"built_in\">assert</span>(<span class=\"number\">0</span> &lt;= r &amp;&amp; r &lt;= _n);</span><br><span class=\"line\">            <span class=\"built_in\">assert</span>(<span class=\"built_in\">f</span>(<span class=\"built_in\">e</span>()));</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (r == <span class=\"number\">0</span>)</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            r += size;</span><br><span class=\"line\">            S sm = <span class=\"built_in\">e</span>();</span><br><span class=\"line\">            <span class=\"keyword\">do</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                r--;</span><br><span class=\"line\">                <span class=\"keyword\">while</span> (r &gt; <span class=\"number\">1</span> &amp;&amp; (r % <span class=\"number\">2</span>))</span><br><span class=\"line\">                    r &gt;&gt;= <span class=\"number\">1</span>;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (!<span class=\"built_in\">f</span>(<span class=\"built_in\">op</span>(d[r], sm)))</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">while</span> (r &lt; size)</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        r = (<span class=\"number\">2</span> * r + <span class=\"number\">1</span>);</span><br><span class=\"line\">                        <span class=\"keyword\">if</span> (<span class=\"built_in\">f</span>(<span class=\"built_in\">op</span>(d[r], sm)))</span><br><span class=\"line\">                        &#123;</span><br><span class=\"line\">                            sm = <span class=\"built_in\">op</span>(d[r], sm);</span><br><span class=\"line\">                            r--;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> r + <span class=\"number\">1</span> - size;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                sm = <span class=\"built_in\">op</span>(d[r], sm);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">while</span> ((r &amp; -r) != r);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span>:</span><br><span class=\"line\">        <span class=\"type\">int</span> _n, size, log;</span><br><span class=\"line\">        vector&lt;S&gt; d;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">pushup</span><span class=\"params\">(<span class=\"type\">int</span> k)</span> </span>&#123; d[k] = <span class=\"built_in\">op</span>(d[<span class=\"number\">2</span> * k], d[<span class=\"number\">2</span> * k + <span class=\"number\">1</span>]); &#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"1-6-çº¿æ®µæ ‘åˆå¹¶\">1.6 çº¿æ®µæ ‘åˆå¹¶</h3>\n<p>åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘åˆå¹¶ï¼Œå¸¸å‡ºç°äºæ ‘ä¸Šé—®é¢˜ï¼Œçˆ¶äº²èŠ‚ç‚¹ç»§æ‰¿å­èŠ‚ç‚¹ä¿¡æ¯ã€‚æ ‘ä¸Šå·®åˆ†ç»“åˆçº¿æ®µæ ‘åˆå¹¶ç»´æŠ¤è·¯å¾„ä¸Šä¿¡æ¯ã€‚</p>\n<p>ç¤ºä¾‹æ˜¯éæ°¸ä¹…åŒ–æ ‡è®°çš„å†™æ³•ã€‚æ ¸å¿ƒå°±è¿™ä¸€ä¸ªï¼Œå…·ä½“å¯å‚è€ƒä¸»å¸­æ ‘å†™æ³•ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">merge</span><span class=\"params\">(<span class=\"type\">int</span> rt1, <span class=\"type\">int</span> rt2, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!rt1 || !rt2)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> rt1 | rt2;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cl == cr)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        tree[rt1].maxnum += tree[rt2].maxnum;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> rt1;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    tree[rt1].l = <span class=\"built_in\">merge</span>(tree[rt1].l, tree[rt2].l, cl, mid);</span><br><span class=\"line\">    tree[rt1].r = <span class=\"built_in\">merge</span>(tree[rt1].r, tree[rt2].r, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">    <span class=\"built_in\">pushup</span>(rt1);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> rt1;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>è£¸æ¨¡æ¿è§ä¸‹é¢çº¿æ®µæ ‘åˆ†è£‚ä¸­ï¼Œæœ‰çº¿æ®µæ ‘åˆå¹¶éƒ¨åˆ†ã€‚</p>\n<p>è‡ªå·±é£æ ¼çš„ä¸»å¸­æ ‘æ˜¯ç”¨çº¿æ®µæ ‘åˆå¹¶å†™çš„ï¼Œæ€è·¯æ›´æ¸…æ™°ã€‚</p>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"1-7-çº¿æ®µæ ‘åˆ†è£‚\">1.7 çº¿æ®µæ ‘åˆ†è£‚</h3>\n<p>å…«è¾ˆå­ç¢°ä¸ä¸Šä¸€ä¸ªã€‚</p>\n<p>ç»™å‡ºä¸€ä¸ªå¯é‡é›† <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>ï¼ˆç¼–å·ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>ï¼‰ï¼Œå®ƒæ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p>\n<p><code>0 p x y</code>ï¼šå°†å¯é‡é›† <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span></span></span></span> ä¸­å¤§äºç­‰äº <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> ä¸”å°äºç­‰äº <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span> çš„å€¼ç§»åŠ¨åˆ°ä¸€ä¸ªæ–°çš„å¯é‡é›†ä¸­ï¼ˆæ–°å¯é‡é›†ç¼–å·ä¸ºä» <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span> å¼€å§‹çš„æ­£æ•´æ•°ï¼Œæ˜¯ä¸Šä¸€æ¬¡äº§ç”Ÿçš„æ–°å¯é‡é›†çš„ç¼–å·+1ï¼‰ã€‚</p>\n<p><code>1 p t</code>ï¼šå°†å¯é‡é›† <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span> ä¸­çš„æ•°æ”¾å…¥å¯é‡é›† <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span></span></span></span>ï¼Œä¸”æ¸…ç©ºå¯é‡é›† <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>ï¼ˆæ•°æ®ä¿è¯åœ¨æ­¤åçš„æ“ä½œä¸­ä¸ä¼šå‡ºç°å¯é‡é›† <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>ï¼‰ã€‚</p>\n<p><code>2 p x q</code>ï¼šåœ¨ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span></span></span></span> è¿™ä¸ªå¯é‡é›†ä¸­åŠ å…¥ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> ä¸ªæ•°å­— <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span>ã€‚</p>\n<p><code>3 p x y</code>ï¼šæŸ¥è¯¢å¯é‡é›† <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span></span></span></span> ä¸­å¤§äºç­‰äº <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> ä¸”å°äºç­‰äº <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span> çš„å€¼çš„ä¸ªæ•°ã€‚</p>\n<p><code>4 p k</code>ï¼šæŸ¥è¯¢åœ¨ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span></span></span></span> è¿™ä¸ªå¯é‡é›†ä¸­ç¬¬ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>â€‹ å°çš„æ•°ï¼Œä¸å­˜åœ¨æ—¶è¾“å‡º <code>-1</code>ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// çº¿æ®µæ ‘åˆ†è£‚</span></span><br><span class=\"line\"><span class=\"comment\">// çº¿æ®µæ ‘åˆå¹¶é€†å‘æ“ä½œ</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> int long long</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IOS ios::sync_with_stdio(false), cin.tie(0), cout.tie(0);</span></span><br><span class=\"line\"><span class=\"comment\">// #define DEBUG 1</span></span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">3e5</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> n, m, tot = <span class=\"number\">0</span>, root[maxn], a[maxn];</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">node</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> l, r, sum;</span><br><span class=\"line\">    <span class=\"type\">int</span> cl, cr;</span><br><span class=\"line\">&#125; tree[maxn &lt;&lt; <span class=\"number\">5</span>];</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> ls(rt) tree[rt].l</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> rs(rt) tree[rt].r</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> rcl(rt) tree[rt].cl</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> rcr(rt) tree[rt].cr</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> sum(rt) tree[rt].sum</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">pushup</span><span class=\"params\">(<span class=\"type\">int</span> rt)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">sum</span>(rt) = <span class=\"built_in\">sum</span>(<span class=\"built_in\">ls</span>(rt)) + <span class=\"built_in\">sum</span>(<span class=\"built_in\">rs</span>(rt));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"type\">int</span> &amp;rt, <span class=\"type\">int</span> num, <span class=\"type\">int</span> pos, <span class=\"type\">int</span> cl = <span class=\"number\">1</span>, <span class=\"type\">int</span> cr = n)</span> <span class=\"comment\">// å•ç‚¹ä¿®æ”¹æƒå€¼çº¿æ®µæ ‘</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!rt)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        rt = ++tot;</span><br><span class=\"line\">        <span class=\"built_in\">rcl</span>(rt) = cl, <span class=\"built_in\">rcr</span>(rt) = cr;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cl == cr)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">sum</span>(rt) += num;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (pos &lt;= mid)</span><br><span class=\"line\">        <span class=\"built_in\">update</span>(<span class=\"built_in\">ls</span>(rt), num, pos, cl, mid);</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"built_in\">update</span>(<span class=\"built_in\">rs</span>(rt), num, pos, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">    <span class=\"built_in\">pushup</span>(rt);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">querykth</span><span class=\"params\">(<span class=\"type\">int</span> &amp;rt, <span class=\"type\">int</span> k, <span class=\"type\">int</span> cl = <span class=\"number\">1</span>, <span class=\"type\">int</span> cr = n)</span> <span class=\"comment\">// æŸ¥è¯¢åŒºé—´ç¬¬kå°ï¼Œçº¿æ®µæ ‘ä¸ŠäºŒåˆ†</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!rt)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cl == cr)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> cl;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1LL</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">sum</span>(<span class=\"built_in\">ls</span>(rt)) &gt;= k)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">querykth</span>(<span class=\"built_in\">ls</span>(rt), k, cl, mid);</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">querykth</span>(<span class=\"built_in\">rs</span>(rt), k - <span class=\"built_in\">sum</span>(<span class=\"built_in\">ls</span>(rt)), mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">queryinterval</span><span class=\"params\">(<span class=\"type\">int</span> &amp;rt, <span class=\"type\">int</span> l, <span class=\"type\">int</span> r, <span class=\"type\">int</span> cl = <span class=\"number\">1</span>, <span class=\"type\">int</span> cr = n)</span> <span class=\"comment\">// æŸ¥è¯¢å¤§äºç­‰äºxå°äºç­‰äºyçš„å…ƒç´ ä¸ªæ•°</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l &lt;= cl &amp;&amp; cr &lt;= r)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">sum</span>(rt);</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1LL</span>, ans = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l &lt;= mid)</span><br><span class=\"line\">        ans += <span class=\"built_in\">queryinterval</span>(<span class=\"built_in\">ls</span>(rt), l, r, cl, mid);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (r &gt; mid)</span><br><span class=\"line\">        ans += <span class=\"built_in\">queryinterval</span>(<span class=\"built_in\">rs</span>(rt), l, r, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">segmerge</span><span class=\"params\">(<span class=\"type\">int</span> &amp;rt1, <span class=\"type\">int</span> &amp;rt2, <span class=\"type\">int</span> cl = <span class=\"number\">1</span>, <span class=\"type\">int</span> cr = n)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!rt1 || !rt2)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">void</span>(rt1 = rt1 + rt2);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cl == cr)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">void</span>(<span class=\"built_in\">sum</span>(rt1) += <span class=\"built_in\">sum</span>(rt2));</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">segmerge</span>(<span class=\"built_in\">ls</span>(rt1), <span class=\"built_in\">ls</span>(rt2), cl, mid);</span><br><span class=\"line\">    <span class=\"built_in\">segmerge</span>(<span class=\"built_in\">rs</span>(rt1), <span class=\"built_in\">rs</span>(rt2), mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">    <span class=\"built_in\">pushup</span>(rt1);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">segsplit</span><span class=\"params\">(<span class=\"type\">int</span> &amp;rt1, <span class=\"type\">int</span> &amp;rt2, <span class=\"type\">int</span> l, <span class=\"type\">int</span> r, <span class=\"type\">int</span> cl = <span class=\"number\">1</span>, <span class=\"type\">int</span> cr = n)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!rt1)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l &lt;= cl &amp;&amp; cr &lt;= r)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        rt2 = rt1;</span><br><span class=\"line\">        rt1 = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!rt2)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        rt2 = ++tot;</span><br><span class=\"line\">        <span class=\"built_in\">rcl</span>(rt2) = cl, <span class=\"built_in\">rcr</span>(rt2) = cr;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l &lt;= mid)</span><br><span class=\"line\">        <span class=\"built_in\">segsplit</span>(<span class=\"built_in\">ls</span>(rt1), <span class=\"built_in\">ls</span>(rt2), l, r, cl, mid);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (r &gt; mid)</span><br><span class=\"line\">        <span class=\"built_in\">segsplit</span>(<span class=\"built_in\">rs</span>(rt1), <span class=\"built_in\">rs</span>(rt2), l, r, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">    <span class=\"built_in\">pushup</span>(rt1);</span><br><span class=\"line\">    <span class=\"built_in\">pushup</span>(rt2);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"type\">int</span> cnt = <span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cin &gt;&gt; a[i];</span><br><span class=\"line\">        <span class=\"built_in\">update</span>(root[<span class=\"number\">1</span>], a[i], i);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (m--)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> op, x, y, z;</span><br><span class=\"line\">        cin &gt;&gt; op;</span><br><span class=\"line\">        <span class=\"keyword\">switch</span> (op)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">0</span>:</span><br><span class=\"line\">            cnt++;</span><br><span class=\"line\">            cin &gt;&gt; x &gt;&gt; y &gt;&gt; z;</span><br><span class=\"line\">            <span class=\"built_in\">segsplit</span>(root[x], root[cnt], y, z);</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">1</span>:</span><br><span class=\"line\">            cin &gt;&gt; x &gt;&gt; y;</span><br><span class=\"line\">            <span class=\"built_in\">segmerge</span>(root[x], root[y]);</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">2</span>:</span><br><span class=\"line\">            cin &gt;&gt; x &gt;&gt; y &gt;&gt; z;</span><br><span class=\"line\">            <span class=\"built_in\">update</span>(root[x], y, z);</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">3</span>:</span><br><span class=\"line\">            cin &gt;&gt; x &gt;&gt; y &gt;&gt; z;</span><br><span class=\"line\">            cout &lt;&lt; <span class=\"built_in\">queryinterval</span>(root[x], y, z) &lt;&lt; endl;</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">4</span>:</span><br><span class=\"line\">            cin &gt;&gt; x &gt;&gt; y;</span><br><span class=\"line\">            cout &lt;&lt; <span class=\"built_in\">querykth</span>(root[x], y) &lt;&lt; endl;</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"1-8-æ‰«æçº¿\">1.8 æ‰«æçº¿</h3>\n<h4 id=\"1-8-1-æ±‚çŸ©å½¢é¢ç§¯çš„å¹¶\">1.8.1 æ±‚çŸ©å½¢é¢ç§¯çš„å¹¶</h4>\n<p>æ‰«æçº¿é—®é¢˜ <em><strong>åˆ‡è®°åˆ‡è®°</strong></em> ç»´æŠ¤å¥½<em><strong>ä»€ä¹ˆæ—¶å€™æ‰«è¿‡ï¼Œæ‰«è¿‡çš„éƒ¨åˆ†æ€ä¹ˆç®—ï¼Œå·²ç»æ‰«å®Œçš„éƒ¨åˆ†å¦‚ä½•åˆ é™¤çš„è¾¹ç•Œé—®é¢˜</strong></em>ï¼Œä¹Ÿæ˜¯é‡ç‚¹DEBUGéƒ¨åˆ†.</p>\n<p>æ±‚çŸ©å½¢é¢ç§¯çš„å¹¶æ¯æ¬¡æŸ¥è¯¢çš„æ˜¯æ•´ä¸ªåŒºé—´å†…çº¿æ®µçš„é•¿åº¦ã€‚</p>\n<p><em><strong>Codeforces</strong></em>ä¸Šæœ‰ä¸€é“ç»´æŠ¤çº¿æ®µçš„åŠ å…¥å’Œåˆ é™¤ï¼ŒåŒºé—´æŸ¥è¯¢æŸä¸ªåŒºé—´æ˜¯å¦æœ‰çº¿æ®µè¦†ç›–çš„é¢˜ï¼Œ<em><strong>æ³¨æ„ï¼Œå¦‚æœæ¶‰åŠåˆ°æ­¤é—®é¢˜</strong></em>ï¼Œ<strong>ä»…</strong>æ‰«æçº¿æ€æƒ³ä¸­<strong>æ ‡è®°ä¸ä¸‹ä¼ åªç»´æŠ¤å½“å‰çº¿æ®µæ ‘ç»“ç‚¹æ‰€è¡¨ç¤ºçš„å®Œæ•´åŒºé—´æ˜¯å¦æœ‰çº¿æ®µ</strong>çš„ç±»çº¿æ®µæ ‘åˆ†æ²»æ€æƒ³<em><strong>è¿˜éœ€è¦é¢å¤–åˆ¤å®šä»¥ä¸‹å†…å®¹ï¼š</strong></em></p>\n<p><em><strong>å¦‚æœç›®æ ‡åŒºé—´<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[l,r]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">]</span></span></span></span>å·²ç»è¢«æŸæ¡é•¿çº¿æ®µå®Œæ•´è¦†ç›–ï¼Œç›´æ¥è¿”å›<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi></mrow><annotation encoding=\"application/x-tex\">true</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">e</span></span></span></span>â€‹â€‹å³å¯ã€‚</strong></em></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// æ‰«æçº¿æ¨¡æ¿</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> i64 long long</span></span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">segtrees</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> l, r;</span><br><span class=\"line\">    i64 sum = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> tags = <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">4e5</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\">segtrees tree[maxn &lt;&lt; <span class=\"number\">2</span>];</span><br><span class=\"line\"><span class=\"type\">int</span> n, m;</span><br><span class=\"line\">i64 points[maxn];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"type\">int</span> rt, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (tree[rt].tags)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        tree[rt].sum = points[cr + <span class=\"number\">1</span>] - points[cl];</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    tree[rt].sum = tree[rt &lt;&lt; <span class=\"number\">1</span>].sum + tree[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>].sum;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">modifytags</span><span class=\"params\">(<span class=\"type\">int</span> l, <span class=\"type\">int</span> r, <span class=\"type\">int</span> d, <span class=\"type\">int</span> rt, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l &lt;= cl &amp;&amp; cr &lt;= r)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        tree[rt].tags += d;</span><br><span class=\"line\">        <span class=\"built_in\">update</span>(rt, cl, cr);</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l &lt;= mid)</span><br><span class=\"line\">        <span class=\"built_in\">modifytags</span>(l, r, d, rt &lt;&lt; <span class=\"number\">1</span>, cl, mid);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (r &gt; mid)</span><br><span class=\"line\">        <span class=\"built_in\">modifytags</span>(l, r, d, rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">    <span class=\"built_in\">update</span>(rt, cl, cr);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">node</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> x1, y1, x2, y2;</span><br><span class=\"line\">&#125; rem[maxn];</span><br><span class=\"line\">vector&lt;tuple&lt;<span class=\"type\">int</span>, <span class=\"type\">int</span>, <span class=\"type\">int</span>, <span class=\"type\">int</span>&gt;&gt; op;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"type\">int</span> cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> S = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> x1, y1, x2, y2;</span><br><span class=\"line\">        cin &gt;&gt; x1 &gt;&gt; y1 &gt;&gt; x2 &gt;&gt; y2;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (x1 &gt; x2)</span><br><span class=\"line\">            <span class=\"built_in\">swap</span>(x1, x2);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (y1 &gt; y2)</span><br><span class=\"line\">            <span class=\"built_in\">swap</span>(y1, y2);</span><br><span class=\"line\">        rem[i] = &#123;x1, y1, x2, y2&#125;;</span><br><span class=\"line\">        points[++cnt] = x1;</span><br><span class=\"line\">        points[++cnt] = x2;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">sort</span>(points + <span class=\"number\">1</span>, points + <span class=\"number\">1</span> + cnt);</span><br><span class=\"line\">    S = <span class=\"built_in\">unique</span>(points + <span class=\"number\">1</span>, points + <span class=\"number\">1</span> + cnt) - points - <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> x1 = <span class=\"built_in\">lower_bound</span>(points + <span class=\"number\">1</span>, points + <span class=\"number\">1</span> + S, rem[i].x1) - points;</span><br><span class=\"line\">        <span class=\"type\">int</span> x2 = <span class=\"built_in\">lower_bound</span>(points + <span class=\"number\">1</span>, points + <span class=\"number\">1</span> + S, rem[i].x2) - points;</span><br><span class=\"line\">        op.<span class=\"built_in\">push_back</span>(&#123;rem[i].y1, x1, x2 - <span class=\"number\">1</span>, <span class=\"number\">1</span>&#125;);</span><br><span class=\"line\">        op.<span class=\"built_in\">push_back</span>(&#123;rem[i].y2, x1, x2 - <span class=\"number\">1</span>, <span class=\"number\">-1</span>&#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">sort</span>(op.<span class=\"built_in\">begin</span>(), op.<span class=\"built_in\">end</span>());</span><br><span class=\"line\">    i64 ans = <span class=\"number\">0</span>;</span><br><span class=\"line\">    i64 last = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> [y, x1, x2, d] : op)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        ans += (y - last) * tree[<span class=\"number\">1</span>].sum;</span><br><span class=\"line\">        <span class=\"built_in\">modifytags</span>(x1, x2, d, <span class=\"number\">1</span>, <span class=\"number\">1</span>, S);</span><br><span class=\"line\">        last = y;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"1-8-2-ç»´æŠ¤çº¿æ®µçš„å¹¶\">1.8.2 ç»´æŠ¤çº¿æ®µçš„å¹¶</h4>\n<p>å…¶å®æœ‰ç‚¹åºŸè¯ï¼Œæœ¬è´¨ä¸Šä¸æ˜¯æ‰«æçº¿ï¼Œä½†æ˜¯ç¡®å®æ˜¯é€šè¿‡ç»´æŠ¤çº¿æ®µåŒºé—´çš„å¹¶åˆ¤æ–­æ­¤æ—¶æœ‰å¤šå°‘ä¸ªåˆæ³•æƒ…å†µï¼Œæ¥æºäºç‰›å®¢å¤šæ ¡çš„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>I</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>v</mi><mi>a</mi><mi>l</mi><mi>S</mi><mi>e</mi><mi>l</mi><mi>e</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">Interval Selection</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">er</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">lS</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">ec</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span></span></span></span>:</p>\n<p>æœ‰ä¸€ä¸ªé•¿åº¦ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> çš„æ•°ç»„ï¼Œå½“ä¸”ä»…å½“ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><mi>l</mi></msub><mo separator=\"true\">,</mo><msub><mi>a</mi><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator=\"true\">,</mo><mo>â€¦</mo><msub><mi>a</mi><mi>r</mi></msub></mrow><annotation encoding=\"application/x-tex\">a_l,a_{l+1},\\dots a_r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">â€¦</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> ä¸­çš„æ¯ä¸ªå…ƒç´ åœ¨å½“å‰åŒºé—´å†…æ°å¥½å‡ºç° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> æ¬¡æ—¶ï¼Œæ•°ç»„ä¸­çš„å­æ•°ç»„ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[l,r]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">]</span></span></span></span> æ‰æ˜¯å¥½æ•°ç»„ã€‚</p>\n<p>ä¾‹å¦‚ï¼Œå¯¹äº<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo>=</mo><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mn>3</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mn>3</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">a=[1,1,2,3,2,3,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">3</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">3</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>å’Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">k=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>ï¼ŒåŒºé—´<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1,2]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mclose\">]</span></span></span></span>ã€<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>3</mn><mo separator=\"true\">,</mo><mn>6</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[3,6]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">3</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">6</span><span class=\"mclose\">]</span></span></span></span>ã€<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>6</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1,6]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">6</span><span class=\"mclose\">]</span></span></span></span>ç­‰éƒ½æ˜¯å¥½çš„ã€‚ä½†æ˜¯ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>3</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1,3]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">3</span><span class=\"mclose\">]</span></span></span></span>ä¸ç¬¦åˆæ¡ä»¶ï¼Œå› ä¸ºå…ƒç´ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>åªå‡ºç°äº†ä¸€æ¬¡ï¼›<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>7</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1,7]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">7</span><span class=\"mclose\">]</span></span></span></span>ä¸ç¬¦åˆæ¡ä»¶ï¼Œå› ä¸ºå…ƒç´ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>å‡ºç°äº†<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span></span></span></span>æ¬¡ã€‚</p>\n<p>è¯·æ‰¾å‡ºå¯ä»¥é€‰æ‹©çš„å¥½åŒºé—´çš„ä¸ªæ•°ã€‚</p>\n<p>é€šè¿‡çº¿æ®µå¹¶ç»´æŠ¤ä¸åˆæ³•åŒºé—´æ•°é‡å³å¯ï¼Œçº¿æ®µäº¤è¿‡äºéš¾ä»¥ç»´æŠ¤ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> int long long</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> endl <span class=\"string\">&#x27;\\n&#x27;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IOS                      \\</span></span><br><span class=\"line\"><span class=\"meta\">    ios::sync_with_stdio(false); \\</span></span><br><span class=\"line\"><span class=\"meta\">    cin.tie(0);                  \\</span></span><br><span class=\"line\"><span class=\"meta\">    cout.tie(0);</span></span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">2e5</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> a[maxn], b[maxn];</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">node</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> l;</span><br><span class=\"line\">    <span class=\"type\">int</span> r;</span><br><span class=\"line\">    <span class=\"type\">int</span> cover;</span><br><span class=\"line\">    <span class=\"type\">int</span> sum;</span><br><span class=\"line\">&#125; tree[maxn &lt;&lt; <span class=\"number\">2LL</span>];</span><br><span class=\"line\"><span class=\"type\">int</span> n;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> ls(rt) tree[rt &lt;&lt; 1LL]</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> rs(rt) tree[rt &lt;&lt; 1LL | 1]</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> cover(rt) tree[rt].cover</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> sum(rt) tree[rt].sum</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> getl(rt) tree[rt].l</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> getr(rt) tree[rt].r</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">pushup</span><span class=\"params\">(<span class=\"type\">int</span> rt)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">cover</span>(rt))</span><br><span class=\"line\">        <span class=\"built_in\">sum</span>(rt) = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"built_in\">getl</span>(rt) == <span class=\"built_in\">getr</span>(rt))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">sum</span>(rt) = <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"built_in\">sum</span>(rt) = <span class=\"built_in\">sum</span>(rt &lt;&lt; <span class=\"number\">1LL</span>) + <span class=\"built_in\">sum</span>(rt &lt;&lt; <span class=\"number\">1LL</span> | <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">modify</span><span class=\"params\">(<span class=\"type\">int</span> l, <span class=\"type\">int</span> r, <span class=\"type\">int</span> d, <span class=\"type\">int</span> rt = <span class=\"number\">1</span>, <span class=\"type\">int</span> cl = <span class=\"number\">1</span>, <span class=\"type\">int</span> cr = n)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l &lt;= cl &amp;&amp; cr &lt;= r)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">cover</span>(rt) += d;</span><br><span class=\"line\">        <span class=\"built_in\">pushup</span>(rt);</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l &lt;= mid)</span><br><span class=\"line\">        <span class=\"built_in\">modify</span>(l, r, d, rt &lt;&lt; <span class=\"number\">1LL</span>, cl, mid);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (r &gt; mid)</span><br><span class=\"line\">        <span class=\"built_in\">modify</span>(l, r, d, rt &lt;&lt; <span class=\"number\">1LL</span> | <span class=\"number\">1</span>, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">    <span class=\"built_in\">pushup</span>(rt);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">querysum</span><span class=\"params\">(<span class=\"type\">int</span> l, <span class=\"type\">int</span> r, <span class=\"type\">int</span> rt = <span class=\"number\">1</span>, <span class=\"type\">int</span> cl = <span class=\"number\">1</span>, <span class=\"type\">int</span> cr = n)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">cover</span>(rt))</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l &lt;= cl &amp;&amp; cr &lt;= r)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">sum</span>(rt);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> ans = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l &lt;= mid)</span><br><span class=\"line\">        ans += <span class=\"built_in\">querysum</span>(l, r, rt &lt;&lt; <span class=\"number\">1LL</span>, cl, mid);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (r &gt; mid)</span><br><span class=\"line\">        ans += <span class=\"built_in\">querysum</span>(l, r, rt &lt;&lt; <span class=\"number\">1LL</span> | <span class=\"number\">1</span>, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">build</span><span class=\"params\">(<span class=\"type\">int</span> rt = <span class=\"number\">1</span>, <span class=\"type\">int</span> l = <span class=\"number\">1</span>, <span class=\"type\">int</span> r = n)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">getl</span>(rt) = l;</span><br><span class=\"line\">    <span class=\"built_in\">getr</span>(rt) = r;</span><br><span class=\"line\">    <span class=\"built_in\">cover</span>(rt) = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l == r)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">sum</span>(rt) = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (l + r) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">build</span>(rt &lt;&lt; <span class=\"number\">1LL</span>, l, mid);</span><br><span class=\"line\">    <span class=\"built_in\">build</span>(rt &lt;&lt; <span class=\"number\">1LL</span> | <span class=\"number\">1</span>, mid + <span class=\"number\">1</span>, r);</span><br><span class=\"line\">    <span class=\"built_in\">pushup</span>(rt);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"type\">int</span> k;</span><br><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt; rem[maxn];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">solve</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; k;</span><br><span class=\"line\">    <span class=\"built_in\">build</span>();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cin &gt;&gt; a[i];</span><br><span class=\"line\">        b[i] = a[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">sort</span>(b + <span class=\"number\">1</span>, b + n + <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"type\">int</span> m = <span class=\"built_in\">unique</span>(b + <span class=\"number\">1</span>, b + n + <span class=\"number\">1</span>) - b - <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= m; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        rem[i].<span class=\"built_in\">clear</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        a[i] = <span class=\"built_in\">lower_bound</span>(b + <span class=\"number\">1</span>, b + m + <span class=\"number\">1</span>, a[i]) - b;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> ans = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (rem[a[i]].<span class=\"built_in\">empty</span>())</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            rem[a[i]].<span class=\"built_in\">push_back</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        rem[a[i]].<span class=\"built_in\">push_back</span>(i);</span><br><span class=\"line\">        <span class=\"type\">int</span> t = rem[a[i]].<span class=\"built_in\">size</span>() - <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> l = rem[a[i]][t - <span class=\"number\">1</span>] + <span class=\"number\">1</span>, r = rem[a[i]][t];</span><br><span class=\"line\">        <span class=\"built_in\">modify</span>(l, r, <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (t &gt;= k)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            l = rem[a[i]][t - k] + <span class=\"number\">1</span>;</span><br><span class=\"line\">            r = rem[a[i]][t - k + <span class=\"number\">1</span>];</span><br><span class=\"line\">            <span class=\"built_in\">modify</span>(l, r, <span class=\"number\">-1</span>);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (l &gt;= <span class=\"number\">2</span>)</span><br><span class=\"line\">                <span class=\"built_in\">modify</span>(<span class=\"number\">1</span>, l - <span class=\"number\">1</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\">            ans += <span class=\"built_in\">querysum</span>(l, r);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    IOS;</span><br><span class=\"line\">    <span class=\"type\">int</span> t = <span class=\"number\">1</span>;</span><br><span class=\"line\">    cin &gt;&gt; t;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (t--)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">solve</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"1-9-ä¸»å¸­æ ‘ï¼ˆé™æ€åŒºé—´ç¬¬kå°ã€å°äºç­‰äºç¬¬kå°çš„å’Œã€å°äºç­‰äºå‰kå°æœ‰å¤šå°‘ä¸ªæ•°ï¼‰\">1.9 ä¸»å¸­æ ‘ï¼ˆé™æ€åŒºé—´ç¬¬kå°ã€å°äºç­‰äºç¬¬kå°çš„å’Œã€å°äºç­‰äºå‰kå°æœ‰å¤šå°‘ä¸ªæ•°ï¼‰</h3>\n<p>è®°ä½ä¸»å¸­æ ‘çš„æ ¹æœ¬æ€æƒ³åœ¨äºç»´æŠ¤å‰ç¼€å’Œã€‚</p>\n<p>å¦å¤–ï¼Œä¸»å¸­æ ‘å¤æ‚åº¦<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>K</mi><mi>n</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(Knlogn)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>ï¼Œå¸¸æ•°è¾ƒå¤§ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>â‰¤</mo><mn>5</mn><mi>e</mi><mn>5</mn></mrow><annotation encoding=\"application/x-tex\">n\\le 5e5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">5</span><span class=\"mord mathnormal\">e</span><span class=\"mord\">5</span></span></span></span>æ—¶å¦‚æœç¡®å®šå¿…é¡»ç”¨åˆ°ä¸»å¸­æ ‘ï¼Œç®—æ³•å¤æ‚åº¦å¿…é¡»ä¸¥æ ¼çº¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(nlogn)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><msup><mi>g</mi><mn>2</mn></msup><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(nlog^2n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>å¯èƒ½ä¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle mathcolor=\"red\"><mi>T</mi><mi>L</mi><mi>E</mi></mstyle></mrow><annotation encoding=\"application/x-tex\">\\color{red}TLE</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;color:red;\">T</span><span class=\"mord mathnormal\" style=\"color:red;\">L</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;color:red;\">E</span></span></span></span>â€‹</p>\n<p><em><strong>é™„è®®ï¼šå…¶å®ä¸»å¸­æ ‘æ ¹æœ¬å°±ä¸éœ€è¦ç¦»æ•£åŒ–ï¼ŒåŠ¨æ€å¼€ç‚¹çš„å±æ€§ç¡®ä¿äº†æ ‘æ·±åº¦æœ€å¤š <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">logV</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span>ï¼Œä¸€å…± <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding=\"application/x-tex\">10^5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span></span></span></span></span></span></span></span>çº§åˆ«çš„æ•°å­—ç¡®ä¿äº†æœ€å¤š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>V</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(nlogV)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mclose\">)</span></span></span></span>çš„ç©ºé—´å¤æ‚åº¦ï¼Œä¸€å®šä¸ä¼šè¶…ï¼Œå°±æ˜¯å¸¸æ•°ç¨å¾®å¤§ä¸€ç‚¹è€Œå·²ã€‚è¿™æ„å‘³ç€ä¸»å¸­æ ‘å¯ä»¥å®Œå…¨åšåˆ°å¹³æ›¿ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>01</mn><mi>T</mi><mi>r</mi><mi>i</mi><mi>e</mi></mrow><annotation encoding=\"application/x-tex\">01Trie</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">01</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">e</span></span></span></span>æ±‚å¼‚æˆ–æœ€å€¼é—®é¢˜ã€‚</strong></em></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> i64 long long</span></span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">node</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> l, r;</span><br><span class=\"line\">    i64 sum;</span><br><span class=\"line\">    i64 cnt;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"type\">int</span> tot = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">5e5</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\">i64 bs[maxn]; <span class=\"comment\">// ç¦»æ•£åŒ–æ•°ç»„ï¼Œä¸‹æ ‡ç¦»æ•£åŒ–ï¼Œå†…å­˜ä¸ºåŸæ•°å­—</span></span><br><span class=\"line\">i64 a[maxn];</span><br><span class=\"line\">node tree[maxn &lt;&lt; <span class=\"number\">5</span>];</span><br><span class=\"line\"><span class=\"type\">int</span> root[maxn];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">init</span><span class=\"params\">(<span class=\"type\">int</span> n)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        root[i] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    tot = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">newnode</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    tot++;</span><br><span class=\"line\">    tree[tot] = &#123;<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> tot;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"type\">int</span> &amp;rt, <span class=\"type\">int</span> pos, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!rt)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        rt = <span class=\"built_in\">newnode</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    tree[rt].cnt++;</span><br><span class=\"line\">    tree[rt].sum += bs[pos];</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cl == cr)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (pos &lt;= mid)</span><br><span class=\"line\">        <span class=\"built_in\">update</span>(tree[rt].l, pos, cl, mid);</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"built_in\">update</span>(tree[rt].r, pos, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">merge</span><span class=\"params\">(<span class=\"type\">int</span> &amp;rt1, <span class=\"type\">int</span> &amp;rt2, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!rt1 || !rt2)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        rt1 |= rt2;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    tree[rt1].cnt += tree[rt2].cnt;</span><br><span class=\"line\">    tree[rt1].sum += tree[rt2].sum;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cl == cr)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">merge</span>(tree[rt1].l, tree[rt2].l, cl, mid);</span><br><span class=\"line\">    <span class=\"built_in\">merge</span>(tree[rt1].r, tree[rt2].r, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">tuple&lt;i64, i64, <span class=\"type\">int</span>&gt; <span class=\"title\">querykth</span><span class=\"params\">(<span class=\"type\">int</span> rt1, <span class=\"type\">int</span> rt2, <span class=\"type\">int</span> k, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cl == cr)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> &#123;bs[cl], tree[rt2].sum - tree[rt1].sum, tree[rt2].cnt - tree[rt1].cnt&#125;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> nowcnt = tree[tree[rt2].l].cnt - tree[tree[rt1].l].cnt;</span><br><span class=\"line\">    i64 nowsum = tree[tree[rt2].l].sum - tree[tree[rt1].l].sum;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (nowcnt &gt;= k)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">querykth</span>(tree[rt1].l, tree[rt2].l, k, cl, mid);</span><br><span class=\"line\">    <span class=\"keyword\">auto</span> [kthrl, rsum, rcnt] = <span class=\"built_in\">querykth</span>(tree[rt1].r, tree[rt2].r, k - nowcnt, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> &#123;kthrl, nowsum + rsum, nowcnt + rcnt&#125;;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"type\">int</span> sz = <span class=\"number\">0</span>;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<p>é™„ï¼šå…³äºä¸»å¸­æ ‘çš„å†…å­˜å›æ”¶é—®é¢˜</p>\n<p>éœ€è¦æ‰“æ ‡è®°ï¼Œä¸€ä¸ªæƒ³åˆ é™¤çš„ç‚¹å¯ä»¥è¢«åˆ é™¤å½“ä¸”ä»…å½“ä»»ä½•ç‰ˆæœ¬éƒ½æ²¡æœ‰å†ä½¿ç”¨è¿™ä¸ªç‚¹ã€‚å°¤å…¶æ³¨æ„<code>merge</code>å‡½æ•°çš„å¤„ç†é—®é¢˜ã€‚ç†è®ºä¸Šæ¶‰åŠä¸»å¸­æ ‘è€ç‰ˆæœ¬åˆ é™¤åˆ é™¤çš„é¢˜ç›®ï¼Œä¸åº”å½“åœ¨å†…å­˜ä¸Šè¿›è¡Œå¡åˆ¶æ— å†…å­˜å›æ”¶æ— æ³•é€šè¿‡çš„æ•°æ®ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">newnode</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (tot + <span class=\"number\">1</span> &lt; inf)</span><br><span class=\"line\">        tot++;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        tot = qs.<span class=\"built_in\">front</span>(), qs.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">    viscnt[tot]++;</span><br><span class=\"line\">    tree[tot] = &#123;<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> tot;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">del_tree</span><span class=\"params\">(<span class=\"type\">int</span> rt)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!rt)</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    <span class=\"built_in\">del_tree</span>(tree[rt].l);</span><br><span class=\"line\">    <span class=\"built_in\">del_tree</span>(tree[rt].r);</span><br><span class=\"line\">    viscnt[rt]--;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!viscnt[rt])</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        qs.<span class=\"built_in\">push</span>(rt);</span><br><span class=\"line\">        tree[rt] = &#123;<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"1-10-ä¸»å¸­æ ‘ç»´æŠ¤åŒºé—´æœ¬è´¨ä¸åŒçš„å…ƒç´ ä¸ªæ•°ï¼ˆHHçš„é¡¹é“¾ï¼‰\">1.10 ä¸»å¸­æ ‘ç»´æŠ¤åŒºé—´æœ¬è´¨ä¸åŒçš„å…ƒç´ ä¸ªæ•°ï¼ˆHHçš„é¡¹é“¾ï¼‰</h3>\n<p>ç»™å®šæ•°ç»„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>ï¼Œæ¯æ¬¡è¯¢é—®<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[l,r]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">]</span></span></span></span>ä¸­æœ‰å¤šå°‘ä¸ªä¸åŒå…ƒç´ çš„å€¼å‡ºç°ï¼Ÿ</p>\n<p>ä¸€ä¸ª<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mi>r</mi><mi>i</mi><mi>v</mi><mi>a</mi><mi>l</mi></mrow><annotation encoding=\"application/x-tex\">trival</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span></span></span></span>çš„åšæ³•æ˜¯æ•°æ¯ä¸ªå…ƒç´ æœ€åä¸€æ¬¡å‡ºç°çš„é‚£ä¸€ä¸ªã€‚ä¸»å¸­æ ‘ä¸‹æ ‡å¼€ä½ç½®ï¼Œè®°å½•è¯¥ä½ç½®æ˜¯å¦æœ‰é¢œè‰²ã€‚</p>\n<p>è®°å½•<em><strong>é¢œè‰²<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mi>r</mi><msub><mi>e</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">pre_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></strong></em>ï¼Œå½“å‰ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>ä½ç½®ï¼Œé¢œè‰²ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>ï¼Œåˆ™å°†<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mi>o</mi><mi>s</mi><mo>=</mo><mi>p</mi><mi>r</mi><msub><mi>e</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">pos=pre_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">os</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ä½ç½®çš„çº¿æ®µæ ‘èŠ‚ç‚¹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">âˆ’</span><span class=\"mord\">1</span></span></span></span>è¡¨ç¤ºè¯¥ä½ç½®ä¸å†è®¡ç®—ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mi>o</mi><mi>s</mi><mo>=</mo><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">pos=i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">os</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>ä½ç½®èŠ‚ç‚¹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">+</span><span class=\"mord\">1</span></span></span></span>è¡¨ç¤ºè¯¥èŠ‚ç‚¹è®¡ç®—é¢œè‰²ï¼Œæ›´æ–°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mi>r</mi><msub><mi>e</mi><mi>k</mi></msub><mo>=</mo><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">pre_k=i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>ã€‚è¯¢é—®<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[l,r]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">]</span></span></span></span>æ—¶æŸ¥è¯¢<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi><mo stretchy=\"false\">[</mo><mi>r</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">root[r]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">roo</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">]</span></span></span></span>ç‰ˆæœ¬ä¸»å¸­æ ‘ã€‚</p>\n<p>ç¬¬ä¸€ç§åšæ³•æœ‰ç‚¹åƒæ ‘çŠ¶æ•°ç»„ç¦»çº¿æ‰«æçº¿ï¼Œä¸å†å†™ã€‚</p>\n<p><em><strong>ç¬¬äºŒä¸ªæ›´Trivalçš„ä¸»å¸­æ ‘åšæ³•</strong></em>ï¼š</p>\n<p>æ•°æ¯ä¸ªå…ƒç´ æ•°æœ€å·¦ä¾§å‡ºç°çš„é‚£ä¸€ä¸ªã€‚æ€è€ƒï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[l,r]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">]</span></span></span></span>ä¸­ä½ç½®<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>ä¸Šçš„å…ƒç´ å¦‚æœåšå‡ºè´¡çŒ®ï¼Œé‚£ä¹ˆè®°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mi>r</mi><msub><mi>e</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">pre_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ä¸º<em><strong>ä½ç½® <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>ä¸Šçš„é¢œè‰²åœ¨ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>å‰æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®</strong></em>ï¼Œç¬¬ä¸€æ¬¡å‡ºç°æ—¶è®°ä½œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mi>r</mi><msub><mi>e</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">pre_i=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>ï¼Œåˆ™å¿…ç„¶æœ‰<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mi>r</mi><msub><mi>e</mi><mi>i</mi></msub><mo>&lt;</mo><mi>l</mi></mrow><annotation encoding=\"application/x-tex\">pre_i&lt;l</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span></span></span></span>.</p>\n<p>å¯¹ä½ç½®å¼€æƒå€¼æ ‘æ¡¶ï¼Œç»´æŠ¤<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mi>r</mi><mi>e</mi></mrow><annotation encoding=\"application/x-tex\">pre</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">re</span></span></span></span>æ•°ç»„ä¸­å€¼<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi><mo>=</mo><mi>p</mi><mi>r</mi><mi>e</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">v=pre[i]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">re</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span></span></span></span>å‡ºç°äº†å¤šå°‘æ¬¡ã€‚æŸ¥è¯¢åŒºé—´<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[l,r]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">]</span></span></span></span>ï¼Œåˆ™ä¸»å¸­æ ‘æŸ¥è¯¢<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi><mo stretchy=\"false\">[</mo><mi>l</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">root[l-1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">roo</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>å’Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi><mo stretchy=\"false\">[</mo><mi>r</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">root[r]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">roo</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">]</span></span></span></span>çš„å·®ä¸­ï¼Œå°äº<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi></mrow><annotation encoding=\"application/x-tex\">l</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span></span></span></span>çš„å€¼çš„å’Œã€‚æ³¨æ„ï¼Œæƒæ ‘ä¸‹æ ‡ä»<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>å¼€å§‹ï¼Œå› ä¿è¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mi>r</mi><msub><mi>e</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">pre_i=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>è¡¨ç¤ºä½ç½®<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>â€‹â€‹ä¸Šçš„é¢œè‰²åœ¨æ•´ä¸ªåºåˆ—ä¸­ç¬¬ä¸€æ¬¡å‡ºç°ã€‚</p>\n<p>ç¬¬äºŒç§æ–¹æ³•æ›´æ–¹ä¾¿äºç»´æŠ¤ä¸€äº›è¢«æ±‚å’Œçš„ä¸œè¥¿ã€‚</p>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"1-11-ä¸»å¸­æ ‘äºŒç»´æ•°ç‚¹ï¼ˆHEOI2017-SuperBigå¸¸æ•°ï¼Œä¸æ¨èï¼Œå»ºè®®ç¦»çº¿æ ‘çŠ¶æ•°ç»„æ‰«æçº¿ï¼Œè¿™é‡Œä¸»è¦è´´å‡ºæ¥ä¸»å¸­æ ‘æ„å»ºæ—¶æœ‰åŒºé—´updateæ ‡è®°æ°¸ä¹…åŒ–ï¼‰\">1.11 ä¸»å¸­æ ‘äºŒç»´æ•°ç‚¹ï¼ˆHEOI2017, SuperBigå¸¸æ•°ï¼Œä¸æ¨èï¼Œå»ºè®®ç¦»çº¿æ ‘çŠ¶æ•°ç»„æ‰«æçº¿ï¼Œè¿™é‡Œä¸»è¦è´´å‡ºæ¥ä¸»å¸­æ ‘æ„å»ºæ—¶æœ‰åŒºé—´updateæ ‡è®°æ°¸ä¹…åŒ–ï¼‰</h3>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> int long long</span></span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">Segtree_presistent</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">struct</span> <span class=\"title class_\">node</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> l = <span class=\"number\">0</span>, r = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> sum = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> lazy = <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    vector&lt;node&gt; t;</span><br><span class=\"line\">    vector&lt;<span class=\"type\">int</span>&gt; root;</span><br><span class=\"line\">    <span class=\"type\">int</span> cnt = <span class=\"number\">0</span>, n = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">init</span><span class=\"params\">(<span class=\"type\">int</span> _n)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        n = _n;</span><br><span class=\"line\">        cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\">        root.<span class=\"built_in\">assign</span>(n + <span class=\"number\">1</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        t.<span class=\"built_in\">assign</span>(<span class=\"number\">32</span> * n + <span class=\"number\">10</span>, <span class=\"built_in\">node</span>());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">modify</span><span class=\"params\">(<span class=\"type\">int</span> &amp;rt, <span class=\"type\">int</span> l, <span class=\"type\">int</span> r, <span class=\"type\">int</span> d, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!rt)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            rt = ++cnt;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        t[rt].sum += <span class=\"number\">1ll</span> * d * (<span class=\"built_in\">min</span>(r, cr) - <span class=\"built_in\">max</span>(l, cl) + <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (l &lt;= cl &amp;&amp; cr &lt;= r)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            t[rt].lazy += d;</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1ll</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (l &lt;= mid)</span><br><span class=\"line\">            <span class=\"built_in\">modify</span>(t[rt].l, l, r, d, cl, mid);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (r &gt; mid)</span><br><span class=\"line\">            <span class=\"built_in\">modify</span>(t[rt].r, l, r, d, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">query</span><span class=\"params\">(<span class=\"type\">int</span> rt, <span class=\"type\">int</span> l, <span class=\"type\">int</span> r, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!rt)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (l &lt;= cl &amp;&amp; cr &lt;= r)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> t[rt].sum;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1ll</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> res = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (l &lt;= mid)</span><br><span class=\"line\">            res += <span class=\"built_in\">query</span>(t[rt].l, l, r, cl, mid);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (r &gt; mid)</span><br><span class=\"line\">            res += <span class=\"built_in\">query</span>(t[rt].r, l, r, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res + <span class=\"number\">1ll</span> * (<span class=\"built_in\">min</span>(r, cr) - <span class=\"built_in\">max</span>(l, cl) + <span class=\"number\">1</span>) * t[rt].lazy;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">merge</span><span class=\"params\">(<span class=\"type\">int</span> &amp;rt1, <span class=\"type\">int</span> &amp;rt2, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!rt1 || !rt2)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            rt1 = rt1 + rt2;</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        t[rt1].sum += t[rt2].sum;</span><br><span class=\"line\">        t[rt1].lazy += t[rt2].lazy;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (cl == cr)</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1ll</span>;</span><br><span class=\"line\">        <span class=\"built_in\">merge</span>(t[rt1].l, t[rt2].l, cl, mid);</span><br><span class=\"line\">        <span class=\"built_in\">merge</span>(t[rt1].r, t[rt2].r, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">Segtree_presistent seg;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">1e6</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">interval</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> l, r;</span><br><span class=\"line\">    <span class=\"type\">int</span> w;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">Edge</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n;</span><br><span class=\"line\">    vector&lt;vector&lt;interval&gt;&gt; G;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">init</span><span class=\"params\">(<span class=\"type\">int</span> _n)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        n = _n;</span><br><span class=\"line\">        G.<span class=\"built_in\">assign</span>(n + <span class=\"number\">1</span>, <span class=\"built_in\">vector</span>&lt;interval&gt;());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">add_edge</span><span class=\"params\">(<span class=\"type\">int</span> u, <span class=\"type\">int</span> l, <span class=\"type\">int</span> r, <span class=\"type\">int</span> w)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        G[u].<span class=\"built_in\">push_back</span>(&#123;l, r, w&#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">Edge G;</span><br><span class=\"line\"><span class=\"type\">int</span> a[maxn];</span><br><span class=\"line\"><span class=\"type\">int</span> l[maxn], r[maxn];</span><br><span class=\"line\">stack&lt;<span class=\"type\">int</span>&gt; s;</span><br><span class=\"line\"><span class=\"type\">int</span> n, m, p, q;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; p &gt;&gt; q;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cin &gt;&gt; a[i];</span><br><span class=\"line\">        l[i] = <span class=\"number\">0</span>, r[i] = n + <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (!s.<span class=\"built_in\">empty</span>() &amp;&amp; a[s.<span class=\"built_in\">top</span>()] &lt; a[i])</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            s.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        l[i] = s.<span class=\"built_in\">empty</span>() ? <span class=\"number\">0ll</span> : s.<span class=\"built_in\">top</span>();</span><br><span class=\"line\">        s.<span class=\"built_in\">push</span>(i);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (!s.<span class=\"built_in\">empty</span>())</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        s.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = n; i &gt;= <span class=\"number\">1</span>; i--)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (!s.<span class=\"built_in\">empty</span>() &amp;&amp; a[s.<span class=\"built_in\">top</span>()] &lt; a[i])</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            s.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        r[i] = s.<span class=\"built_in\">empty</span>() ? <span class=\"number\">1ll</span> * n + <span class=\"number\">1</span> : s.<span class=\"built_in\">top</span>();</span><br><span class=\"line\">        s.<span class=\"built_in\">push</span>(i);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    seg.<span class=\"built_in\">init</span>(n);</span><br><span class=\"line\">    G.<span class=\"built_in\">init</span>(n);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (i != n)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            G.<span class=\"built_in\">add_edge</span>(i, i + <span class=\"number\">1</span>, i + <span class=\"number\">1</span>, p);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (l[i] &amp;&amp; r[i] &lt;= n)</span><br><span class=\"line\">            G.<span class=\"built_in\">add_edge</span>(l[i], r[i], r[i], p);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (l[i] &amp;&amp; i + <span class=\"number\">1</span> &lt;= r[i] - <span class=\"number\">1</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            G.<span class=\"built_in\">add_edge</span>(l[i], i + <span class=\"number\">1</span>, r[i] - <span class=\"number\">1</span>, q);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (r[i] &lt;= n &amp;&amp; l[i] + <span class=\"number\">1</span> &lt;= i - <span class=\"number\">1</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            G.<span class=\"built_in\">add_edge</span>(r[i], l[i] + <span class=\"number\">1</span>, i - <span class=\"number\">1</span>, q);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> [l, r, w] : G.G[i])</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            seg.<span class=\"built_in\">modify</span>(seg.root[i], l, r, w, <span class=\"number\">1</span>, seg.n);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        seg.<span class=\"built_in\">merge</span>(seg.root[i], seg.root[i - <span class=\"number\">1</span>], <span class=\"number\">1</span>, seg.n);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= m; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> l, r;</span><br><span class=\"line\">        cin &gt;&gt; l &gt;&gt; r;</span><br><span class=\"line\">        cout &lt;&lt; seg.<span class=\"built_in\">query</span>(seg.root[r], l, r, <span class=\"number\">1</span>, seg.n) - seg.<span class=\"built_in\">query</span>(seg.root[l - <span class=\"number\">1</span>], l, r, <span class=\"number\">1</span>, seg.n) &lt;&lt; endl;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"1-12-å¸¦ä¿®ä¸»å¸­æ ‘-æ ‘å¥—æ ‘ï¼ˆåŠ¨æ€åŒºé—´ç¬¬kå°ï¼Œå•ç‚¹ä¿®æ”¹ï¼‰\">1.12 å¸¦ä¿®ä¸»å¸­æ ‘/æ ‘å¥—æ ‘ï¼ˆåŠ¨æ€åŒºé—´ç¬¬kå°ï¼Œå•ç‚¹ä¿®æ”¹ï¼‰</h3>\n<h4 id=\"1-12-1-åŠ¨æ€åŒºé—´ç¬¬kå°\">1.12.1 åŠ¨æ€åŒºé—´ç¬¬kå°</h4>\n<p>è¿™ä¸ªçœ‹æ€ä¹ˆç†è§£äº†ï¼Œä¸¥æ ¼æ„ä¹‰ä¸Šæ ¹æœ¬ä¸ç®—ä¸»å¸­æ ‘ï¼Œå±äºæ ‘çŠ¶æ•°ç»„å¥—æƒå€¼çº¿æ®µæ ‘ã€‚ä½†æ˜¯å¦‚æœæŒ‰å‰ç¼€å’Œç†è§£ä¸»å¸­æ ‘ï¼Œ<code>merge</code>å‡½æ•°è§†ä½œå¯¹å„ä¸ªç‹¬ç«‹æ ¹çš„æ ‘æ±‚å‰ç¼€å’Œï¼Œæ ‘çŠ¶æ•°ç»„å°±åƒæ˜¯ä¹‹å‰æš´åŠ›é¢„å¤„ç†å‰ç¼€å’Œå˜æˆäº†å°†æ ‘ç›´æ¥ç»‘åœ¨æ ‘çŠ¶æ•°ç»„ä¸Šï¼Œç”¨æ ‘çŠ¶æ•°ç»„æ±‚å‰ç¼€å’Œï¼Œä¹Ÿç®—è¯´å¾—è¿‡å»ã€‚</p>\n<p>ç†è®ºä¸ŠåŒºé—´ä¿®æ”¹ä¹Ÿå¯ä»¥ï¼Ÿ</p>\n<p>æ³¨æ„æ½œåœ¨çš„ç©ºé—´çˆ†ç‚¸é—®é¢˜ã€‚</p>\n<p>(æ˜¾ç„¶å¯ä»¥ï¼Œå…·ä½“å®ç°å‚è€ƒ1.11åŒºé—´åŠ ï¼Œ1.2åŒºé—´ä¹˜ï¼Œç›¸åŒé€»è¾‘)</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">5e5</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> int long long</span></span><br><span class=\"line\"><span class=\"type\">int</span> n;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">node</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> l, r;</span><br><span class=\"line\">    <span class=\"type\">int</span> sum;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">node tree[maxn &lt;&lt; <span class=\"number\">5</span>];</span><br><span class=\"line\"><span class=\"type\">int</span> tot = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> root[maxn];</span><br><span class=\"line\"><span class=\"type\">int</span> sz;</span><br><span class=\"line\"><span class=\"type\">int</span> bs[maxn];</span><br><span class=\"line\"><span class=\"type\">int</span> a[maxn];</span><br><span class=\"line\"><span class=\"type\">int</span> q;</span><br><span class=\"line\"><span class=\"type\">int</span> cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">lowbit</span><span class=\"params\">(<span class=\"type\">int</span> x)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (x &amp; -x);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">newnode</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    tot++;</span><br><span class=\"line\">    tree[tot] = &#123;<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0ll</span>&#125;;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> tot;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">upd</span><span class=\"params\">(<span class=\"type\">int</span> &amp;rt, <span class=\"type\">int</span> pos, <span class=\"type\">int</span> val, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!rt)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        rt = <span class=\"built_in\">newnode</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    tree[rt].sum += val;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cl == cr)</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (pos &lt;= mid)</span><br><span class=\"line\">        <span class=\"built_in\">upd</span>(tree[rt].l, pos, val, cl, mid);</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"built_in\">upd</span>(tree[rt].r, pos, val, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"type\">int</span> realrt, <span class=\"type\">int</span> val)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = realrt; i &lt;= n; i += <span class=\"built_in\">lowbit</span>(i))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">upd</span>(root[i], a[realrt], val, <span class=\"number\">1</span>, sz);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">query</span><span class=\"params\">(vector&lt;<span class=\"type\">int</span>&gt; &amp;rt1s, vector&lt;<span class=\"type\">int</span>&gt; &amp;rt2s, <span class=\"type\">int</span> k, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cl == cr)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> cl;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> sums = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> j : rt2s)</span><br><span class=\"line\">        sums += tree[tree[j].l].sum;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> j : rt1s)</span><br><span class=\"line\">        sums -= tree[tree[j].l].sum;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (sums &gt;= k)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> &amp;j : rt2s)</span><br><span class=\"line\">            j = tree[j].l;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> &amp;j : rt1s)</span><br><span class=\"line\">            j = tree[j].l;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">query</span>(rt1s, rt2s, k, cl, mid);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> &amp;j : rt2s)</span><br><span class=\"line\">            j = tree[j].r;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> &amp;j : rt1s)</span><br><span class=\"line\">            j = tree[j].r;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">query</span>(rt1s, rt2s, k - sums, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">querykth</span><span class=\"params\">(<span class=\"type\">int</span> l, <span class=\"type\">int</span> r, <span class=\"type\">int</span> k)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    vector&lt;<span class=\"type\">int</span>&gt; rt1, rt2;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = r; i; i -= <span class=\"built_in\">lowbit</span>(i))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        rt<span class=\"number\">2.</span><span class=\"built_in\">push_back</span>(root[i]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = l - <span class=\"number\">1</span>; i; i -= <span class=\"built_in\">lowbit</span>(i))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        rt<span class=\"number\">1.</span><span class=\"built_in\">push_back</span>(root[i]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">query</span>(rt1, rt2, k, <span class=\"number\">1</span>, sz);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">qs</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> l, r, k;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">cs</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> pos, val;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; q;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cin &gt;&gt; a[i];</span><br><span class=\"line\">        bs[++cnt] = a[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    vector&lt;tuple&lt;<span class=\"type\">char</span>, qs, cs&gt;&gt; <span class=\"built_in\">v</span>(q + <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= q; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">char</span> c;</span><br><span class=\"line\">        cin &gt;&gt; c;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (c == <span class=\"string\">&#x27;Q&#x27;</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> l, r, k;</span><br><span class=\"line\">            cin &gt;&gt; l &gt;&gt; r &gt;&gt; k;</span><br><span class=\"line\">            v[i] = &#123;c, &#123;l, r, k&#125;, &#123;&#125;&#125;;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> pos, val;</span><br><span class=\"line\">            cin &gt;&gt; pos &gt;&gt; val;</span><br><span class=\"line\">            bs[++cnt] = val;</span><br><span class=\"line\">            v[i] = &#123;c, &#123;&#125;, &#123;pos, val&#125;&#125;;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">sort</span>(bs + <span class=\"number\">1</span>, bs + <span class=\"number\">1</span> + cnt);</span><br><span class=\"line\">    sz = <span class=\"built_in\">unique</span>(bs + <span class=\"number\">1</span>, bs + <span class=\"number\">1</span> + cnt) - bs - <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        a[i] = <span class=\"built_in\">lower_bound</span>(bs + <span class=\"number\">1</span>, bs + <span class=\"number\">1</span> + sz, a[i]) - bs;</span><br><span class=\"line\">        <span class=\"built_in\">update</span>(i, <span class=\"number\">1</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= q; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> [ch, qss, css] = v[i];</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (ch == <span class=\"string\">&#x27;Q&#x27;</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            cout &lt;&lt; bs[<span class=\"built_in\">querykth</span>(qss.l, qss.r, qss.k)] &lt;&lt; endl;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"built_in\">update</span>(css.pos, <span class=\"number\">-1</span>);</span><br><span class=\"line\">            a[css.pos] = <span class=\"built_in\">lower_bound</span>(bs + <span class=\"number\">1</span>, bs + <span class=\"number\">1</span> + sz, css.val) - bs;</span><br><span class=\"line\">            <span class=\"built_in\">update</span>(css.pos, <span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"1-12-2-é™æ€äºŒç»´çŸ©å½¢ç¬¬kå°\">1.12.2 é™æ€äºŒç»´çŸ©å½¢ç¬¬kå°</h4>\n<p>ç©ºé—´å¤æ‚åº¦æé«˜ã€‚çœ‹æ•°æ®èŒƒå›´æ˜¯å¦é€‰æ‹©èŒƒå›´åˆ†æ²»ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> i64 int</span></span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">node</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> l, r;</span><br><span class=\"line\">    <span class=\"type\">int</span> sum;</span><br><span class=\"line\">    <span class=\"type\">int</span> cnt;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">2e5</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\">node tree[maxn &lt;&lt; <span class=\"number\">7</span>];</span><br><span class=\"line\"><span class=\"type\">int</span> tot = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> sz = <span class=\"number\">1009</span>;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"type\">int</span> rt, <span class=\"type\">int</span> pos, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!rt)</span><br><span class=\"line\">        rt = ++tot;</span><br><span class=\"line\">    tree[rt].cnt++;</span><br><span class=\"line\">    tree[rt].sum += pos;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cl == cr)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> rt;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (pos &lt;= mid)</span><br><span class=\"line\">        tree[rt].l = <span class=\"built_in\">update</span>(tree[rt].l, pos, cl, mid);</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        tree[rt].r = <span class=\"built_in\">update</span>(tree[rt].r, pos, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> rt;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">querysum</span><span class=\"params\">(<span class=\"type\">int</span> &amp;rt, <span class=\"type\">int</span> l, <span class=\"type\">int</span> r, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!rt)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l &lt;= cl &amp;&amp; cr &lt;= r)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> tree[rt].sum;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> res = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l &lt;= mid)</span><br><span class=\"line\">        res += <span class=\"built_in\">querysum</span>(tree[rt].l, l, r, cl, mid);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (r &gt; mid)</span><br><span class=\"line\">        res += <span class=\"built_in\">querysum</span>(tree[rt].r, l, r, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">Fenwick</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"keyword\">private</span>:</span><br><span class=\"line\">    <span class=\"type\">int</span> n, m;</span><br><span class=\"line\">    vector&lt;vector&lt;i64&gt;&gt; c;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">lowbit</span><span class=\"params\">(<span class=\"type\">int</span> x)</span> </span>&#123; <span class=\"keyword\">return</span> x &amp; -x; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"built_in\">Fenwick</span>(<span class=\"type\">int</span> n, <span class=\"type\">int</span> m) : <span class=\"built_in\">n</span>(n), <span class=\"built_in\">m</span>(m), <span class=\"built_in\">c</span>(n + <span class=\"number\">1</span>, <span class=\"built_in\">vector</span>&lt;i64&gt;(m + <span class=\"number\">1</span>, <span class=\"number\">0</span>)) &#123;&#125;</span><br><span class=\"line\">    <span class=\"built_in\">Fenwick</span>() : <span class=\"built_in\">n</span>(<span class=\"number\">0</span>), <span class=\"built_in\">m</span>(<span class=\"number\">0</span>) &#123;&#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">init</span><span class=\"params\">(<span class=\"type\">int</span> n, <span class=\"type\">int</span> m)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>-&gt;n = n;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>-&gt;m = m;</span><br><span class=\"line\">        c.<span class=\"built_in\">assign</span>(n + <span class=\"number\">1</span>, <span class=\"built_in\">vector</span>&lt;i64&gt;(m + <span class=\"number\">1</span>, <span class=\"number\">0</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"type\">int</span> x, <span class=\"type\">int</span> y, i64 v)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = x; i &lt;= n; i += <span class=\"built_in\">lowbit</span>(i))</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = y; j &lt;= m; j += <span class=\"built_in\">lowbit</span>(j))</span><br><span class=\"line\">                c[i][j] = <span class=\"built_in\">update</span>(c[i][j], v, <span class=\"number\">1</span>, sz);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">query</span><span class=\"params\">(<span class=\"type\">int</span> x, <span class=\"type\">int</span> y)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        vector&lt;<span class=\"type\">int</span>&gt; res;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = x; i; i -= <span class=\"built_in\">lowbit</span>(i))</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = y; j; j -= <span class=\"built_in\">lowbit</span>(j))</span><br><span class=\"line\">                res.<span class=\"built_in\">push_back</span>(c[i][j]);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">querysum</span><span class=\"params\">(vector&lt;<span class=\"type\">int</span>&gt; &amp;rt)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> sum = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> j : rt)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        sum += tree[j].sum;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> sum;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">querycnt</span><span class=\"params\">(vector&lt;<span class=\"type\">int</span>&gt; &amp;rt)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> sum = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> j : rt)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        sum += tree[j].cnt;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> sum;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">queryrcnt</span><span class=\"params\">(vector&lt;<span class=\"type\">int</span>&gt; &amp;rt)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> sum = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> j : rt)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        sum += tree[tree[j].r].cnt;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> sum;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">queryrsum</span><span class=\"params\">(vector&lt;<span class=\"type\">int</span>&gt; &amp;rt)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> sum = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> j : rt)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        sum += tree[tree[j].r].sum;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> sum;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">didl</span><span class=\"params\">(vector&lt;<span class=\"type\">int</span>&gt; &amp;rt)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> &amp;j : rt)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        j = tree[j].l;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">didr</span><span class=\"params\">(vector&lt;<span class=\"type\">int</span>&gt; &amp;rt)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> &amp;j : rt)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        j = tree[j].r;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">queryans</span><span class=\"params\">(<span class=\"type\">int</span> h, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr,</span></span></span><br><span class=\"line\"><span class=\"params\"><span class=\"function\">             vector&lt;<span class=\"type\">int</span>&gt; &amp;rt1, vector&lt;<span class=\"type\">int</span>&gt; &amp;rt2, vector&lt;<span class=\"type\">int</span>&gt; &amp;rt3, vector&lt;<span class=\"type\">int</span>&gt; &amp;rt4, <span class=\"type\">int</span> cnts)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cl == cr)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> sums = <span class=\"built_in\">querysum</span>(rt1) + <span class=\"built_in\">querysum</span>(rt4) - <span class=\"built_in\">querysum</span>(rt2) - <span class=\"built_in\">querysum</span>(rt3);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (sums &gt;= h)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> nowcnt = <span class=\"built_in\">querycnt</span>(rt1) + <span class=\"built_in\">querycnt</span>(rt4) - <span class=\"built_in\">querycnt</span>(rt2) - <span class=\"built_in\">querycnt</span>(rt3);</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (nowcnt &amp;&amp; sums - cl &gt;= h)</span><br><span class=\"line\">                nowcnt--, sums -= cl;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> cnts + nowcnt;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> sum = <span class=\"built_in\">queryrsum</span>(rt1) + <span class=\"built_in\">queryrsum</span>(rt4) - <span class=\"built_in\">queryrsum</span>(rt2) - <span class=\"built_in\">queryrsum</span>(rt3);</span><br><span class=\"line\">    <span class=\"type\">int</span> newcnt = <span class=\"built_in\">queryrcnt</span>(rt1) + <span class=\"built_in\">queryrcnt</span>(rt4) - <span class=\"built_in\">queryrcnt</span>(rt2) - <span class=\"built_in\">queryrcnt</span>(rt3);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (sum &gt;= h)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">didr</span>(rt1), <span class=\"built_in\">didr</span>(rt2), <span class=\"built_in\">didr</span>(rt3), <span class=\"built_in\">didr</span>(rt4);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">queryans</span>(h, mid + <span class=\"number\">1</span>, cr, rt1, rt2, rt3, rt4, cnts);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">didl</span>(rt1), <span class=\"built_in\">didl</span>(rt2), <span class=\"built_in\">didl</span>(rt3), <span class=\"built_in\">didl</span>(rt4);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">queryans</span>(h - sum, cl, mid, rt1, rt2, rt3, rt4, cnts + newcnt);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">Fenwick fw;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">queryfinal</span><span class=\"params\">(<span class=\"type\">int</span> x1, <span class=\"type\">int</span> x2, <span class=\"type\">int</span> y1, <span class=\"type\">int</span> y2, <span class=\"type\">int</span> h)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    vector&lt;<span class=\"type\">int</span>&gt; rt1, rt2, rt3, rt4;</span><br><span class=\"line\">    rt1 = fw.<span class=\"built_in\">query</span>(x1 - <span class=\"number\">1</span>, y1 - <span class=\"number\">1</span>);</span><br><span class=\"line\">    rt2 = fw.<span class=\"built_in\">query</span>(x2, y1 - <span class=\"number\">1</span>);</span><br><span class=\"line\">    rt3 = fw.<span class=\"built_in\">query</span>(x1 - <span class=\"number\">1</span>, y2);</span><br><span class=\"line\">    rt4 = fw.<span class=\"built_in\">query</span>(x2, y2);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">queryans</span>(h, <span class=\"number\">1</span>, sz, rt1, rt2, rt3, rt4, <span class=\"number\">0</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n, m, k;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; k;</span><br><span class=\"line\">    fw.<span class=\"built_in\">init</span>(n + <span class=\"number\">10</span>, m + <span class=\"number\">10</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">1</span>; j &lt;= m; j++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> x;</span><br><span class=\"line\">            cin &gt;&gt; x;</span><br><span class=\"line\">            fw.<span class=\"built_in\">add</span>(i, j, x);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (k--)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> x1, x2, y1, y2, h;</span><br><span class=\"line\">        cin &gt;&gt; x1 &gt;&gt; y1 &gt;&gt; x2 &gt;&gt; y2 &gt;&gt; h;</span><br><span class=\"line\">        <span class=\"type\">int</span> ans = <span class=\"built_in\">queryfinal</span>(x1, x2, y1, y2, h);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (ans &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">            cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">            cout &lt;&lt; <span class=\"string\">&quot;Poor QLW&quot;</span> &lt;&lt; endl;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"1-13-ä¸»å¸­æ ‘å¯æŒä¹…åŒ–æ•°ç»„\">1.13 ä¸»å¸­æ ‘å¯æŒä¹…åŒ–æ•°ç»„</h3>\n<p>ç»´æŠ¤è¿™æ ·çš„ä¸€ä¸ªé•¿åº¦ä¸º $ N $ çš„æ•°ç»„ï¼Œæ”¯æŒå¦‚ä¸‹å‡ ç§æ“ä½œ</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">1. å¯¹äºæ“ä½œ1ï¼Œæ ¼å¼ä¸º$ v_i \\ 1 \\ &#123;loc&#125;_i \\ &#123;value&#125;_i $ï¼Œå³ä¸ºåœ¨ç‰ˆæœ¬$ v_i $çš„åŸºç¡€ä¸Šï¼Œå°† $ a_&#123;&#123;loc&#125;_i&#125; $ ä¿®æ”¹ä¸º $ &#123;value&#125;_i $ã€‚</span><br><span class=\"line\"></span><br><span class=\"line\">2. å¯¹äºæ“ä½œ2ï¼Œæ ¼å¼ä¸º$ v_i \\ 2 \\ &#123;loc&#125;_i $ï¼Œå³è®¿é—®ç‰ˆæœ¬$ v_i $ä¸­çš„ $ a_&#123;&#123;loc&#125;_i&#125; $çš„å€¼ï¼Œæ³¨æ„ï¼š**ç”Ÿæˆä¸€æ ·ç‰ˆæœ¬çš„å¯¹è±¡åº”ä¸º $v_i$**ã€‚</span><br></pre></td></tr></table></figure>\n<p>æ­¤å¤–ï¼Œæ¯è¿›è¡Œä¸€æ¬¡æ“ä½œï¼ˆ<strong>å¯¹äºæ“ä½œ2ï¼Œå³ä¸ºç”Ÿæˆä¸€ä¸ªå®Œå…¨ä¸€æ ·çš„ç‰ˆæœ¬ï¼Œä¸ä½œä»»ä½•æ”¹åŠ¨</strong>ï¼‰ï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„ç‰ˆæœ¬ã€‚ç‰ˆæœ¬ç¼–å·å³ä¸ºå½“å‰æ“ä½œçš„ç¼–å·ï¼ˆä»1å¼€å§‹ç¼–å·ï¼Œç‰ˆæœ¬0è¡¨ç¤ºåˆå§‹çŠ¶æ€æ•°ç»„ï¼‰</p>\n<p><em><strong>æ³¨æ„å’Œä¸»å¸­æ ‘ä¸ä¸€æ ·çš„åœ°æ–¹ï¼Œmergeå‡½æ•°ä¸èµ‹å€¼ï¼ˆå› ä¸ºæ˜¯æŠŠå‰©ä¸‹æœªå˜åŠ¨çš„éƒ¨åˆ†ç›´æ¥mergeè¿‡æ¥ï¼‰ï¼Œä¿®æ”¹æ—¶å…ˆæ”¹å†mergeï¼ŒæŸ¥è¯¢æ—¶å…ˆmergeå†æ”¹</strong></em></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> int long long</span></span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">2e6</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> tot = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> sz;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">node</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> l, r;</span><br><span class=\"line\">    <span class=\"type\">int</span> num;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">node tree[maxn &lt;&lt; <span class=\"number\">5</span>];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">newnode</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    tot++;</span><br><span class=\"line\">    tree[tot] = &#123;<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> tot;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">merge</span><span class=\"params\">(<span class=\"type\">int</span> &amp;rt1, <span class=\"type\">int</span> &amp;rt2, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!rt1 || !rt2)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        rt1 |= rt2;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cl == cr)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"comment\">// tree[rt1].num = tree[rt2].num;</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">merge</span>(tree[rt1].l, tree[rt2].l, cl, mid);</span><br><span class=\"line\">    <span class=\"built_in\">merge</span>(tree[rt1].r, tree[rt2].r, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"type\">int</span> &amp;rt, <span class=\"type\">int</span> pos, <span class=\"type\">int</span> val, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!rt)</span><br><span class=\"line\">        rt = <span class=\"built_in\">newnode</span>();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cl == cr)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        tree[rt].num = val;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (pos &lt;= mid)</span><br><span class=\"line\">        <span class=\"built_in\">update</span>(tree[rt].l, pos, val, cl, mid);</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"built_in\">update</span>(tree[rt].r, pos, val, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">query</span><span class=\"params\">(<span class=\"type\">const</span> <span class=\"type\">int</span> rt, <span class=\"type\">int</span> pos, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!rt)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cl == cr)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> tree[rt].num;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (pos &lt;= mid)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">query</span>(tree[rt].l, pos, cl, mid);</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">query</span>(tree[rt].r, pos, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">printtree</span><span class=\"params\">(<span class=\"type\">int</span> rt, <span class=\"type\">int</span> cl = <span class=\"number\">1</span>, <span class=\"type\">int</span> cr = sz)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!rt)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cout &lt;&lt; <span class=\"number\">0</span> &lt;&lt; endl;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cl == cr)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cout &lt;&lt; tree[rt].num &lt;&lt; endl;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">printtree</span>(tree[rt].l, cl, mid);</span><br><span class=\"line\">    <span class=\"built_in\">printtree</span>(tree[rt].r, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"type\">int</span> root[maxn];</span><br><span class=\"line\"><span class=\"type\">int</span> n, m;</span><br><span class=\"line\"><span class=\"type\">int</span> ver = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class=\"line\">    sz = n;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> val;</span><br><span class=\"line\">        cin &gt;&gt; val;</span><br><span class=\"line\">        <span class=\"built_in\">update</span>(root[<span class=\"number\">0</span>], i, val, <span class=\"number\">1</span>, sz);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (m--)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        ver++;</span><br><span class=\"line\">        <span class=\"type\">int</span> v, op, pos, val;</span><br><span class=\"line\">        cin &gt;&gt; v &gt;&gt; op &gt;&gt; pos;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (op == <span class=\"number\">1</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            cin &gt;&gt; val;</span><br><span class=\"line\">            <span class=\"built_in\">update</span>(root[ver], pos, val, <span class=\"number\">1</span>, sz);</span><br><span class=\"line\">            <span class=\"built_in\">merge</span>(root[ver], root[v], <span class=\"number\">1</span>, sz);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"built_in\">merge</span>(root[ver], root[v], <span class=\"number\">1</span>, sz);</span><br><span class=\"line\">            cout &lt;&lt; <span class=\"built_in\">query</span>(root[ver], pos, <span class=\"number\">1</span>, sz) &lt;&lt; endl;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"1-14-ä¸»å¸­æ ‘å¯æŒä¹…åŒ–å¹¶æŸ¥é›†\">1.14 ä¸»å¸­æ ‘å¯æŒä¹…åŒ–å¹¶æŸ¥é›†</h3>\n<p>ç»™å®š <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> ä¸ªé›†åˆï¼Œç¬¬ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> ä¸ªé›†åˆå†…åˆå§‹çŠ¶æ€ä¸‹åªæœ‰ä¸€ä¸ªæ•°ï¼Œä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>ã€‚</p>\n<p>æœ‰ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span> æ¬¡æ“ä½œã€‚æ“ä½œåˆ†ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span></span></span></span> ç§ï¼š</p>\n<ul>\n<li><code>1 a b</code> åˆå¹¶ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo separator=\"true\">,</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">a,b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span> æ‰€åœ¨é›†åˆï¼›</li>\n<li><code>2 k</code> å›åˆ°ç¬¬ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> æ¬¡æ“ä½œï¼ˆæ‰§è¡Œä¸‰ç§æ“ä½œä¸­çš„ä»»æ„ä¸€ç§éƒ½è®°ä¸ºä¸€æ¬¡æ“ä½œï¼‰ä¹‹åçš„çŠ¶æ€ï¼›</li>\n<li><code>3 a b</code> è¯¢é—® <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo separator=\"true\">,</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">a,b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span> æ˜¯å¦å±äºåŒä¸€é›†åˆï¼Œå¦‚æœæ˜¯åˆ™è¾“å‡º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>ï¼Œå¦åˆ™è¾“å‡º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>ã€‚</li>\n</ul>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>â‰¤</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup><mo separator=\"true\">,</mo><mi>m</mi><mo>â‰¤</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding=\"application/x-tex\">n\\le 10^5,m\\le 10^5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0085em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span></span></span></span></span></span></span></span></p>\n<p>åªéœ€æ³¨æ„ä¸€ä¸ªç‚¹ï¼Œè·¯å¾„å‹ç¼©å¹¶æŸ¥é›†å¤æ‚åº¦æ˜¯å‡æ‘Šçš„ï¼Œæ¶åŠ£æƒ…å†µä¸‹å•æ¬¡åˆå¹¶ä¼šæ˜¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>â€‹çš„å¤æ‚åº¦ã€‚æ‰€ä»¥è¦ä¸ŠæŒ‰ç§©åˆå¹¶ï¼ˆå¯å‘å¼åˆå¹¶ï¼‰</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> int long long</span></span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">2e5</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">presistent_array</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> tot = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> sz;</span><br><span class=\"line\">    <span class=\"keyword\">struct</span> <span class=\"title class_\">node</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> l, r;</span><br><span class=\"line\">        <span class=\"type\">int</span> num;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    node tree[maxn &lt;&lt; <span class=\"number\">5</span>];</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">newnode</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        tot++;</span><br><span class=\"line\">        tree[tot] = &#123;<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> tot;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">merge</span><span class=\"params\">(<span class=\"type\">int</span> &amp;rt1, <span class=\"type\">int</span> &amp;rt2, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!rt1 || !rt2)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            rt1 |= rt2;</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (cl == cr)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"comment\">// tree[rt1].num = tree[rt2].num;</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">merge</span>(tree[rt1].l, tree[rt2].l, cl, mid);</span><br><span class=\"line\">        <span class=\"built_in\">merge</span>(tree[rt1].r, tree[rt2].r, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"type\">int</span> &amp;rt, <span class=\"type\">int</span> pos, <span class=\"type\">int</span> val, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!rt)</span><br><span class=\"line\">            rt = <span class=\"built_in\">newnode</span>();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (cl == cr)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            tree[rt].num = val;</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (pos &lt;= mid)</span><br><span class=\"line\">            <span class=\"built_in\">update</span>(tree[rt].l, pos, val, cl, mid);</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">            <span class=\"built_in\">update</span>(tree[rt].r, pos, val, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">query</span><span class=\"params\">(<span class=\"type\">const</span> <span class=\"type\">int</span> rt, <span class=\"type\">int</span> pos, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!rt)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (cl == cr)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> tree[rt].num;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (pos &lt;= mid)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">query</span>(tree[rt].l, pos, cl, mid);</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">query</span>(tree[rt].r, pos, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">printtree</span><span class=\"params\">(<span class=\"type\">const</span> <span class=\"type\">int</span> rt)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= sz; i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            cout &lt;&lt; <span class=\"built_in\">query</span>(rt, i, <span class=\"number\">1</span>, sz) &lt;&lt; <span class=\"string\">&quot; &quot;</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        cout &lt;&lt; endl;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> root[maxn];</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">array&lt;<span class=\"type\">int</span>, 2&gt; vers[maxn];</span><br><span class=\"line\"><span class=\"type\">int</span> n, m;</span><br><span class=\"line\"><span class=\"type\">int</span> ver = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> verfa = <span class=\"number\">0</span>, versiz = <span class=\"number\">0</span>;</span><br><span class=\"line\">presistent_array fa, siz; <span class=\"comment\">// å¼€ä¸¤ä¸ªæ•°ç»„ï¼Œç›´æ¥å°±æ˜¯å¯æŒä¹…åŒ–æ•°ç»„å°èµ·æ¥</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">getfather</span><span class=\"params\">(<span class=\"type\">int</span> fart, <span class=\"type\">int</span> x)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> getf = fa.<span class=\"built_in\">query</span>(fart, x, <span class=\"number\">1</span>, n);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (x == getf)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> x;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">getfather</span>(fart, getf);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">bool</span> <span class=\"title\">same</span><span class=\"params\">(<span class=\"type\">int</span> fart, <span class=\"type\">int</span> u, <span class=\"type\">int</span> v)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">getfather</span>(fart, u) == <span class=\"built_in\">getfather</span>(fart, v);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class=\"line\">    fa.sz = siz.sz = n;</span><br><span class=\"line\">    vers[<span class=\"number\">0</span>] = &#123;<span class=\"number\">0</span>, <span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        fa.<span class=\"built_in\">update</span>(fa.root[vers[<span class=\"number\">0</span>][<span class=\"number\">0</span>]], i, i, <span class=\"number\">1</span>, n);</span><br><span class=\"line\">        siz.<span class=\"built_in\">update</span>(siz.root[vers[<span class=\"number\">0</span>][<span class=\"number\">1</span>]], i, <span class=\"number\">1</span>, <span class=\"number\">1</span>, n);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// fa.printtree(fa.root[0]);</span></span><br><span class=\"line\">    <span class=\"comment\">// siz.printtree(siz.root[0]);</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> (m--)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        ver++;</span><br><span class=\"line\">        vers[ver][<span class=\"number\">0</span>] = vers[ver][<span class=\"number\">1</span>] = ver;</span><br><span class=\"line\">        <span class=\"type\">int</span> op, k;</span><br><span class=\"line\">        cin &gt;&gt; op;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (op == <span class=\"number\">2</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            cin &gt;&gt; k;</span><br><span class=\"line\">            fa.<span class=\"built_in\">merge</span>(fa.root[vers[ver][<span class=\"number\">0</span>]], fa.root[vers[k][<span class=\"number\">0</span>]], <span class=\"number\">1</span>, n); <span class=\"comment\">// ç‰ˆæœ¬å›æ»š</span></span><br><span class=\"line\">            siz.<span class=\"built_in\">merge</span>(siz.root[vers[ver][<span class=\"number\">1</span>]], siz.root[vers[k][<span class=\"number\">1</span>]], <span class=\"number\">1</span>, n);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (op == <span class=\"number\">3</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> u, v;</span><br><span class=\"line\">            cin &gt;&gt; u &gt;&gt; v;</span><br><span class=\"line\">            fa.<span class=\"built_in\">merge</span>(fa.root[vers[ver][<span class=\"number\">0</span>]], fa.root[vers[ver - <span class=\"number\">1</span>][<span class=\"number\">0</span>]], <span class=\"number\">1</span>, n); <span class=\"comment\">// ç‰ˆæœ¬å¤åˆ¶</span></span><br><span class=\"line\">            siz.<span class=\"built_in\">merge</span>(siz.root[vers[ver][<span class=\"number\">1</span>]], siz.root[vers[ver - <span class=\"number\">1</span>][<span class=\"number\">1</span>]], <span class=\"number\">1</span>, n);</span><br><span class=\"line\">            cout &lt;&lt; <span class=\"built_in\">same</span>(fa.root[vers[ver][<span class=\"number\">0</span>]], u, v) &lt;&lt; endl;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> u, v;</span><br><span class=\"line\">            cin &gt;&gt; u &gt;&gt; v;</span><br><span class=\"line\">            u = <span class=\"built_in\">getfather</span>(fa.root[vers[ver - <span class=\"number\">1</span>][<span class=\"number\">0</span>]], u);</span><br><span class=\"line\">            v = <span class=\"built_in\">getfather</span>(fa.root[vers[ver - <span class=\"number\">1</span>][<span class=\"number\">0</span>]], v);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (u != v)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"type\">int</span> szu = siz.<span class=\"built_in\">query</span>(siz.root[vers[ver - <span class=\"number\">1</span>][<span class=\"number\">1</span>]], u, <span class=\"number\">1</span>, n);</span><br><span class=\"line\">                <span class=\"type\">int</span> szv = siz.<span class=\"built_in\">query</span>(siz.root[vers[ver - <span class=\"number\">1</span>][<span class=\"number\">1</span>]], v, <span class=\"number\">1</span>, n);</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (szu &lt; szv)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"built_in\">swap</span>(szu, szv);</span><br><span class=\"line\">                    <span class=\"built_in\">swap</span>(u, v);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                fa.<span class=\"built_in\">update</span>(fa.root[vers[ver][<span class=\"number\">0</span>]], v, u, <span class=\"number\">1</span>, n);           <span class=\"comment\">// fa[v]=u,å°å‘å¤§åˆå¹¶</span></span><br><span class=\"line\">                siz.<span class=\"built_in\">update</span>(siz.root[vers[ver][<span class=\"number\">1</span>]], u, szu + szv, <span class=\"number\">1</span>, n); <span class=\"comment\">// siz[u]+=sizv</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            fa.<span class=\"built_in\">merge</span>(fa.root[vers[ver][<span class=\"number\">0</span>]], fa.root[vers[ver - <span class=\"number\">1</span>][<span class=\"number\">0</span>]], <span class=\"number\">1</span>, n); <span class=\"comment\">// å…ˆæ”¹å†å¤åˆ¶</span></span><br><span class=\"line\">            siz.<span class=\"built_in\">merge</span>(siz.root[vers[ver][<span class=\"number\">1</span>]], siz.root[vers[ver - <span class=\"number\">1</span>][<span class=\"number\">1</span>]], <span class=\"number\">1</span>, n);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// fa.printtree(fa.root[vers[ver][0]]);</span></span><br><span class=\"line\">        <span class=\"comment\">// siz.printtree(siz.root[vers[ver][1]]);</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"1-15-Li-Chao-Tree\">1.15 Li-Chao Tree</h3>\n<p>è¦æ±‚åœ¨å¹³é¢ç›´è§’åæ ‡ç³»ä¸‹ç»´æŠ¤ä¸¤ä¸ªæ“ä½œï¼š</p>\n<ol>\n<li>åœ¨å¹³é¢ä¸ŠåŠ å…¥ä¸€æ¡çº¿æ®µã€‚è®°ç¬¬ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> æ¡è¢«æ’å…¥çš„çº¿æ®µçš„æ ‡å·ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>ã€‚</li>\n<li>ç»™å®šä¸€ä¸ªæ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>ï¼Œè¯¢é—®ä¸ç›´çº¿ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">x = k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> ç›¸äº¤çš„çº¿æ®µä¸­ï¼Œäº¤ç‚¹çºµåæ ‡æœ€å¤§çš„çº¿æ®µçš„ç¼–å·ã€‚</li>\n</ol>\n<p>å¯¹äº <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>100</mn><mi mathvariant=\"normal\">%</mi></mrow><annotation encoding=\"application/x-tex\">100\\%</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8056em;vertical-align:-0.0556em;\"></span><span class=\"mord\">100%</span></span></span></span> çš„æ•°æ®ï¼Œä¿è¯ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>n</mi><mo>â‰¤</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding=\"application/x-tex\">1 \\leq n \\leq 10^5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span></span></span></span></span></span></span></span>ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>k</mi><mo separator=\"true\">,</mo><msub><mi>x</mi><mn>0</mn></msub><mo separator=\"true\">,</mo><msub><mi>x</mi><mn>1</mn></msub><mo>â‰¤</mo><mn>39989</mn></mrow><annotation encoding=\"application/x-tex\">1 \\leq k, x_0, x_1 \\leq 39989</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">39989</span></span></span></span>ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><msub><mi>y</mi><mn>0</mn></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo>â‰¤</mo><mn>1</mn><msup><mn>0</mn><mn>9</mn></msup></mrow><annotation encoding=\"application/x-tex\">1 \\leq y_0, y_1 \\leq 10^9</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8304em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">9</span></span></span></span></span></span></span></span></span></span></span>â€‹ã€‚</p>\n<p>æè¶…æ ‘å¯ä»¥ä¼˜ç§€çš„ç»´æŠ¤å¹³é¢å†…æ·»åŠ çº¿æ€§å‡½æ•°çº¿æ®µä»¥åŠæŸ¥è¯¢<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mi>a</mi><mi>x</mi><mrow><msub><mi>f</mi><mi>i</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">max{f_i(x)}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">ma</span><span class=\"mord mathnormal\">x</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span></span>ï¼Œå¯ç”¨äºæ–œç‡ä¼˜åŒ–<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">dp</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">p</span></span></span></span>â€‹ç­‰ã€‚ä¸æ”¯æŒåŠ å…¥çº¿æ®µååˆ é™¤ï¼Œå¦‚æœ‰å¿…è¦ï¼Œè€ƒè™‘<em><strong>çº¿æ®µæ ‘åˆ†æ²»+æè¶…æ ‘å®ç°</strong></em>ã€‚</p>\n<p>æè¶…æ ‘çš„æ ¸å¿ƒä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mi>p</mi><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">upd</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">d</span></span></span></span>å‡½æ•°ï¼Œæ›´æ–°çº¿æ®µæ ‘<em><strong>å®Œæ•´èŠ‚ç‚¹</strong></em>åŒºé—´å†…çš„ä¿¡æ¯ã€‚</p>\n<p>å…·ä½“æ¥è¯´ï¼Œè®¾å½“å‰åŒºé—´çš„ä¸­ç‚¹ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mi>i</mi><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">mid</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">mi</span><span class=\"mord mathnormal\">d</span></span></span></span>ï¼Œæˆ‘ä»¬æ‹¿æ–°çº¿æ®µ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>åœ¨ä¸­ç‚¹å¤„çš„å€¼ä¸åŸæœ€ä¼˜çº¿æ®µ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>åœ¨ä¸­ç‚¹å¤„çš„å€¼ä½œæ¯”è¾ƒã€‚</p>\n<p>å¦‚æœæ–°çº¿æ®µ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>æ›´ä¼˜ï¼Œåˆ™å°†<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>å’Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>äº¤æ¢ã€‚é‚£ä¹ˆç°åœ¨è€ƒè™‘åœ¨ä¸­ç‚¹å¤„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>ä¸å¦‚<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>ä¼˜çš„æƒ…å†µï¼š</p>\n<ol>\n<li>è‹¥åœ¨å·¦ç«¯ç‚¹å¤„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>æ›´ä¼˜ï¼Œé‚£ä¹ˆ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>å’Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>å¿…ç„¶åœ¨å·¦åŠåŒºé—´ä¸­äº§ç”Ÿäº†äº¤ç‚¹ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>åªæœ‰åœ¨å·¦åŒºé—´æ‰å¯èƒ½ä¼˜äº <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>ï¼Œé€’å½’åˆ°å·¦å„¿å­ä¸­è¿›è¡Œä¸‹ä¼ ï¼›</li>\n<li>è‹¥åœ¨å³ç«¯ç‚¹å¤„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>æ›´ä¼˜ï¼Œé‚£ä¹ˆ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>å’Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>å¿…ç„¶åœ¨å³åŠåŒºé—´ä¸­äº§ç”Ÿäº†äº¤ç‚¹ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>åªæœ‰åœ¨å³åŒºé—´æ‰å¯èƒ½ä¼˜äº <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>ï¼Œé€’å½’åˆ°å³å„¿å­ä¸­è¿›è¡Œä¸‹ä¼ ï¼›</li>\n<li>è‹¥åœ¨å·¦å³ç«¯ç‚¹å¤„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>éƒ½æ›´ä¼˜ï¼Œé‚£ä¹ˆ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>ä¸å¯èƒ½æˆä¸ºç­”æ¡ˆï¼Œä¸éœ€è¦ç»§ç»­ä¸‹ä¼ ã€‚</li>\n</ol>\n<p>é™¤äº†è¿™ä¸¤ç§æƒ…å†µä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ç§æƒ…å†µæ˜¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>å’Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>åˆšå¥½äº¤äºä¸­ç‚¹ï¼Œåœ¨ç¨‹åºå®ç°æ—¶å¯ä»¥å½’å…¥ä¸­ç‚¹å¤„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>ä¸å¦‚<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>ä¼˜çš„çš„æƒ…å†µï¼Œç»“æœä¼šå¾€<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>æ›´ä¼˜çš„ä¸€ä¸ªç«¯ç‚¹è¿›è¡Œé€’å½’ä¸‹ä¼ ã€‚</p>\n<p>æœ€åå°†<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>ä½œä¸ºå½“å‰åŒºé—´çš„æ‡’æ ‡è®°ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> i64 long long</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> d64 long double</span></span><br><span class=\"line\"><span class=\"comment\">// #define MOD1 39989</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> MOD1 39989</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> MOD2 1000000000</span></span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">2e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">node</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">// int l, r;</span></span><br><span class=\"line\">    <span class=\"type\">int</span> bestcnt;</span><br><span class=\"line\">&#125; tree[maxn &lt;&lt; <span class=\"number\">2LL</span>];</span><br><span class=\"line\"><span class=\"type\">int</span> n, m;</span><br><span class=\"line\"><span class=\"type\">int</span> lastans = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">segments</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">// int l, r;</span></span><br><span class=\"line\">    d64 k, b;</span><br><span class=\"line\">&#125; segs[maxn];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">cmp</span><span class=\"params\">(d64 x, d64 y)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (x - y &gt; <span class=\"number\">1e-9</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (y - x &gt; <span class=\"number\">1e-9</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">d64 <span class=\"title\">calc</span><span class=\"params\">(<span class=\"type\">int</span> id, <span class=\"type\">int</span> x)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> segs[id].k * x + segs[id].b;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"type\">int</span> x0, <span class=\"type\">int</span> y0, <span class=\"type\">int</span> x1, <span class=\"type\">int</span> y1)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    cnt++;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (x0 == x1)</span><br><span class=\"line\">        segs[cnt].k = <span class=\"number\">0</span>, segs[cnt].b = <span class=\"built_in\">max</span>(y0, y1);</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        segs[cnt].k = <span class=\"number\">1.0</span> * (y1 - y0) / (x1 - x0), segs[cnt].b = y0 - segs[cnt].k * x0;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">upd</span><span class=\"params\">(<span class=\"type\">int</span> now, <span class=\"type\">int</span> rt, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1LL</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> &amp;v = tree[rt].bestcnt;</span><br><span class=\"line\">    <span class=\"type\">int</span> bmid = <span class=\"built_in\">cmp</span>(<span class=\"built_in\">calc</span>(now, mid), <span class=\"built_in\">calc</span>(v, mid));</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (bmid == <span class=\"number\">1</span> || (!bmid &amp;&amp; now &lt; v))</span><br><span class=\"line\">        <span class=\"built_in\">swap</span>(now, v);</span><br><span class=\"line\">    <span class=\"type\">int</span> bl = <span class=\"built_in\">cmp</span>(<span class=\"built_in\">calc</span>(now, cl), <span class=\"built_in\">calc</span>(v, cl)), br = <span class=\"built_in\">cmp</span>(<span class=\"built_in\">calc</span>(now, cr), <span class=\"built_in\">calc</span>(v, cr));</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (bl == <span class=\"number\">1</span> || (!bl &amp;&amp; now &lt; v))</span><br><span class=\"line\">        <span class=\"built_in\">upd</span>(now, rt &lt;&lt; <span class=\"number\">1LL</span>, cl, mid);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (br == <span class=\"number\">1</span> || (!br &amp;&amp; now &lt; v))</span><br><span class=\"line\">        <span class=\"built_in\">upd</span>(now, rt &lt;&lt; <span class=\"number\">1LL</span> | <span class=\"number\">1LL</span>, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"type\">int</span> now, <span class=\"type\">int</span> l, <span class=\"type\">int</span> r, <span class=\"type\">int</span> rt, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l &lt;= cl &amp;&amp; cr &lt;= r)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">upd</span>(now, rt, cl, cr);</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1LL</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l &lt;= mid)</span><br><span class=\"line\">        <span class=\"built_in\">update</span>(now, l, r, rt &lt;&lt; <span class=\"number\">1LL</span>, cl, mid);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (r &gt; mid)</span><br><span class=\"line\">        <span class=\"built_in\">update</span>(now, l, r, rt &lt;&lt; <span class=\"number\">1LL</span> | <span class=\"number\">1LL</span>, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">pair&lt;<span class=\"type\">double</span>, <span class=\"type\">int</span>&gt; <span class=\"title\">max</span><span class=\"params\">(pair&lt;<span class=\"type\">double</span>, <span class=\"type\">int</span>&gt; a, pair&lt;<span class=\"type\">double</span>, <span class=\"type\">int</span>&gt; b)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">cmp</span>(a.first, b.first) == <span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> a;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">cmp</span>(a.first, b.first) == <span class=\"number\">-1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> b;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> a.second &lt; b.second ? a : b;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">pair&lt;<span class=\"type\">double</span>, <span class=\"type\">int</span>&gt; <span class=\"title\">query</span><span class=\"params\">(<span class=\"type\">int</span> d, <span class=\"type\">int</span> rt, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cr &lt; d || cl &gt; d)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> &#123;<span class=\"number\">0</span>, <span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1LL</span>;</span><br><span class=\"line\">    <span class=\"type\">double</span> res = <span class=\"built_in\">calc</span>(tree[rt].bestcnt, d);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cl == cr)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> &#123;res, tree[rt].bestcnt&#125;;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">max</span>(&#123;res, tree[rt].bestcnt&#125;, <span class=\"built_in\">max</span>(<span class=\"built_in\">query</span>(d, rt &lt;&lt; <span class=\"number\">1LL</span>, cl, mid), <span class=\"built_in\">query</span>(d, rt &lt;&lt; <span class=\"number\">1LL</span> | <span class=\"number\">1LL</span>, mid + <span class=\"number\">1</span>, cr)));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin &gt;&gt; m;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= m; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> opt;</span><br><span class=\"line\">        cin &gt;&gt; opt;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (opt == <span class=\"number\">1</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> l, r, a, b;</span><br><span class=\"line\">            cin &gt;&gt; l &gt;&gt; a &gt;&gt; r &gt;&gt; b;</span><br><span class=\"line\">            l = (l + lastans - <span class=\"number\">1</span>) % MOD1 + <span class=\"number\">1</span>;</span><br><span class=\"line\">            r = (r + lastans - <span class=\"number\">1</span>) % MOD1 + <span class=\"number\">1</span>;</span><br><span class=\"line\">            a = (a + lastans - <span class=\"number\">1</span>) % MOD2 + <span class=\"number\">1</span>;</span><br><span class=\"line\">            b = (b + lastans - <span class=\"number\">1</span>) % MOD2 + <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (l &gt; r)</span><br><span class=\"line\">                <span class=\"built_in\">swap</span>(l, r), <span class=\"built_in\">swap</span>(a, b);</span><br><span class=\"line\">            <span class=\"built_in\">add</span>(l, a, r, b);</span><br><span class=\"line\">            <span class=\"built_in\">update</span>(cnt, l, r, <span class=\"number\">1</span>, <span class=\"number\">1</span>, MOD1);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> x;</span><br><span class=\"line\">            cin &gt;&gt; x;</span><br><span class=\"line\">            x = (x + lastans - <span class=\"number\">1</span>) % MOD1 + <span class=\"number\">1</span>;</span><br><span class=\"line\">            pair&lt;<span class=\"type\">double</span>, <span class=\"type\">int</span>&gt; ans = <span class=\"built_in\">query</span>(x, <span class=\"number\">1</span>, <span class=\"number\">1</span>, MOD1);</span><br><span class=\"line\">            cout &lt;&lt; ans.second &lt;&lt; endl;</span><br><span class=\"line\">            lastans = ans.second;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"1-16-ç±»Li-Chao-Tree-é€’å½’åŒºé—´åˆå¹¶\">1.16 ç±»Li-Chao Tree  /  é€’å½’åŒºé—´åˆå¹¶</h3>\n<p>æ€ç»´ï¼Œå’Œæè¶…æ ‘æ²¡æœ‰å…³ç³»ï¼Œåœ¨äºä¸¤ä¸ªåŒºé—´åˆå¹¶<code>pushup</code>çš„æ—¶å€™æ¯”è¾ƒå›°éš¾ï¼Œéœ€è¦åƒæè¶…æ ‘çš„<code>upd</code>ä¸€æ ·é€’å½’å¤„ç†çš„æƒ…å†µã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">pushup1</span><span class=\"params\">(<span class=\"type\">int</span> rt)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    tree[rt].maxn = <span class=\"built_in\">max</span>(tree[rt &lt;&lt; <span class=\"number\">1</span>].maxn, tree[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>].maxn);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">pushup2</span><span class=\"params\">(d32 tar, <span class=\"type\">int</span> rt, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (tree[rt].maxn &lt;= tar)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (a[cl] &gt; tar)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> tree[rt].len;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cl == cr)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> (a[cl] &gt; tar);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (tree[rt &lt;&lt; <span class=\"number\">1</span>].maxn &lt;= tar)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">pushup2</span>(tar, rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">pushup2</span>(tar, rt &lt;&lt; <span class=\"number\">1</span>, cl, mid) + tree[rt].len - tree[rt &lt;&lt; <span class=\"number\">1</span>].len;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">pushup</span><span class=\"params\">(<span class=\"type\">int</span> rt, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">pushup1</span>(rt);</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    tree[rt].len = tree[rt &lt;&lt; <span class=\"number\">1</span>].len + <span class=\"built_in\">pushup2</span>(tree[rt &lt;&lt; <span class=\"number\">1</span>].maxn, rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"1-17-çº¿æ®µæ ‘åˆ†æ²»\">1.17 çº¿æ®µæ ‘åˆ†æ²»</h3>\n<p>å‡å¦‚ä½ éœ€è¦ç»´æŠ¤ä¸€äº›ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯ä¼šåœ¨æŸä¸€ä¸ªæ—¶é—´æ®µå†…å‡ºç°ï¼Œè¦æ±‚åœ¨ç¦»çº¿çš„å‰æä¸‹å›ç­”æŸä¸€ä¸ªæ—¶åˆ»çš„ä¿¡æ¯å¹¶ï¼Œåˆ™å¯ä»¥è€ƒè™‘ä½¿ç”¨çº¿æ®µæ ‘åˆ†æ²»çš„æŠ€å·§ã€‚</p>\n<p>å®é™…ä¸Šçº¿æ®µæ ‘åˆ†æ²»å¸¸æœ‰ä»¥ä¸‹ç”¨é€”ï¼š</p>\n<ol>\n<li>ç”¨åŸæœ¬ä¸æ”¯æŒåˆ é™¤ä½†æ˜¯æ”¯æŒæ’¤é”€çš„æ•°æ®ç»“æ„æ¥æ¨¡æ‹Ÿåˆ é™¤æ“ä½œã€‚å¦‚æœ´ç´ çš„å¹¶æŸ¥é›†æ— æ³•é«˜æ•ˆæ”¯æŒåˆ è¾¹æ“ä½œã€‚</li>\n<li>ä¸åŒå±æ€§çš„æ•°æ®åˆ†åˆ«è®¡ç®—ã€‚å¦‚éœ€è¦æ±‚å‡ºé™¤äº†æŸä¸€ç§é¢œè‰²å¤–ï¼Œå…¶ä»–é¢œè‰²æ•°æ®çš„ç­”æ¡ˆã€‚</li>\n</ol>\n<p>é¦–å…ˆæˆ‘ä»¬å»ºç«‹ä¸€ä¸ªçº¿æ®µæ ‘æ¥ç»´æŠ¤æ—¶åˆ»ï¼Œæ¯ä¸€ä¸ªèŠ‚ç‚¹ç»´æŠ¤ä¸€ä¸ª <code>vector</code> æ¥å­˜å‚¨ä½äºè¿™ä¸€æ®µæ—¶åˆ»çš„ä¿¡æ¯ã€‚</p>\n<p>æ’å…¥ä¸€ä¸ªä¿¡æ¯åˆ°çº¿æ®µæ ‘ä¸­å’Œæ™®é€šçº¿æ®µæ ‘çš„åŒºé—´ä¿®æ”¹æ˜¯ç±»ä¼¼çš„ã€‚</p>\n<p>ç„¶åæˆ‘ä»¬è€ƒè™‘å¦‚ä½•å¤„ç†æ¯ä¸€ä¸ªæ—¶é—´æ®µçš„ä¿¡æ¯å¹¶ã€‚è€ƒè™‘ä»æ ¹èŠ‚ç‚¹å¼€å§‹åˆ†æ²»ï¼Œç»´æŠ¤å½“å‰çš„ä¿¡æ¯å¹¶ï¼Œç„¶åæ¯åˆ°ä¸€ä¸ªèŠ‚ç‚¹çš„æ—¶å€™å°†è¿™ä¸ªèŠ‚ç‚¹çš„æ‰€æœ‰ä¿¡æ¯è¿›è¡Œåˆå¹¶ã€‚å›æº¯æ—¶æ’¤é”€è¿™ä¸€éƒ¨åˆ†çš„è´¡çŒ®ã€‚æœ€ååˆ°è¾¾å¶å­èŠ‚ç‚¹æ—¶çš„ä¿¡æ¯å¹¶å°±æ˜¯å¯¹åº”çš„ç­”æ¡ˆã€‚</p>\n<p>å¦‚æœæ›´æ”¹ä¿¡æ¯çš„æ—¶é—´å¤æ‚åº¦ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>T</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(T(n))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">))</span></span></span></span>ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®ä¸€ä¸ªæ ˆä¿ç•™æ›´æ”¹ï¼Œä»¥<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>T</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(T(n))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">))</span></span></span></span>çš„æ—¶é—´å¤æ‚åº¦æ’¤é”€ã€‚æ’¤é”€ä¸ç»´æŒå‡æ‘Šå¤æ‚åº¦ã€‚</p>\n<p>æ•´ä¸ªåˆ†æ²»æµç¨‹çš„æ€»æ—¶é—´å¤æ‚åº¦æ˜¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>T</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>M</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(nlogn(T(n)+M(n)))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">n</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)))</span></span></span></span>çš„ï¼Œå…¶ä¸­<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>M</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(M(n))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">))</span></span></span></span>ä¸ºåˆå¹¶ä¿¡æ¯çš„æ—¶é—´å¤æ‚åº¦ï¼Œç©ºé—´å¤æ‚åº¦ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(nlogn)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>â€‹ã€‚</p>\n<p>å¹¶æŸ¥é›†ä¸å«Œéº»çƒ¦æœ€å¥½å†™å¯æŒä¹…åŒ–ï¼Œä¸ç”¨æ ˆï¼Œé€Ÿåº¦è¿˜åå¿«ä¸€ç‚¹,ç¼ºç‚¹æ˜¯ç é‡ç¡®å®é«˜ï¼Œè€Œä¸”ä¸€æ—¦æŠ„é”™äº†ä¸å¥½DEBUGã€‚<em><strong>å¦‚æœå†™æ™®é€šå¹¶æŸ¥é›†ï¼Œå¿…é¡»å†™æŒ‰ç§©åˆå¹¶ï¼Œè·¯å¾„å‹ç¼©å› ä¸ºå‡æ‘Šå¤æ‚åº¦ä¸è¢«æ”¯æŒ</strong></em>ã€‚æ’¤é”€æ—¶ï¼Œç›´æ¥é€šè¿‡æ ˆæ‰€è®°å½•çš„<code>merge</code>å‰çš„ä¿¡æ¯ç›´æ¥å¤åŸå³å¯ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> ls (i &lt;&lt; 1)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> rs (i &lt;&lt; 1 | 1)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> mid ((l + r) &gt;&gt; 1)</span></span><br><span class=\"line\"></span><br><span class=\"line\">vector&lt;Object&gt; tree[N &lt;&lt; <span class=\"number\">2</span>];  <span class=\"comment\">// çº¿æ®µæ ‘</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"type\">int</span> ql, <span class=\"type\">int</span> qr, Object obj, <span class=\"type\">int</span> i, <span class=\"type\">int</span> l, <span class=\"type\">int</span> r)</span> </span>&#123;  <span class=\"comment\">// æ’å…¥</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (ql &lt;= l &amp;&amp; r &lt;= qr) &#123;</span><br><span class=\"line\">    tree[i].<span class=\"built_in\">push_back</span>(obj);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (ql &lt;= mid) <span class=\"built_in\">update</span>(ql, qr, obj, ls, l, mid);</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (qr &gt; mid) <span class=\"built_in\">update</span>(ql, qr, obj, rs, mid + <span class=\"number\">1</span>, r);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">stack&lt;Object&gt; sta;  <span class=\"comment\">// ç”¨äºæ’¤é”€çš„æ ˆ</span></span><br><span class=\"line\">Object now;         <span class=\"comment\">// å½“å‰çš„ä¿¡æ¯å¹¶</span></span><br><span class=\"line\">Object ans[N];      <span class=\"comment\">// ç­”æ¡ˆ</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">solve</span><span class=\"params\">(<span class=\"type\">int</span> i, <span class=\"type\">int</span> l, <span class=\"type\">int</span> r)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">auto</span> lvl = sta.<span class=\"built_in\">size</span>();  <span class=\"comment\">// è®°å½•ä¸€ä¸‹åº”å½“æ’¤é”€åˆ°ç¬¬å‡ ä¸ª</span></span><br><span class=\"line\">  <span class=\"keyword\">for</span> (Object x : tree[i]) sta.<span class=\"built_in\">push</span>(now), now = <span class=\"built_in\">Merge</span>(now, x);  <span class=\"comment\">// åˆå¹¶ä¿¡æ¯</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (l == r)</span><br><span class=\"line\">    ans[i] = now;  <span class=\"comment\">// è®°å½•ä¸€ä¸‹ç­”æ¡ˆ</span></span><br><span class=\"line\">  <span class=\"keyword\">else</span></span><br><span class=\"line\">    <span class=\"built_in\">solve</span>(ls, l, mid), <span class=\"built_in\">solve</span>(rs, mid + <span class=\"number\">1</span>, r);  <span class=\"comment\">// åˆ†æ²»</span></span><br><span class=\"line\">  <span class=\"keyword\">while</span> (sta.<span class=\"built_in\">size</span>() != lvl) &#123;                  <span class=\"comment\">// æ’¤é”€ä¿¡æ¯</span></span><br><span class=\"line\">    now = sta.<span class=\"built_in\">top</span>();</span><br><span class=\"line\">    sta.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"1-18-çº¿æ®µæ ‘ç»´æŠ¤æœ€å¤§å­æ®µå’Œ\">1.18 çº¿æ®µæ ‘ç»´æŠ¤æœ€å¤§å­æ®µå’Œ</h3>\n<p>çº¿æ®µæ ‘ç»“ç‚¹ç»´æŠ¤åŒºé—´æœ€å€¼ï¼ŒåŒºé—´å‰ç¼€å’Œæœ€å€¼ï¼ŒåŒºé—´åç¼€å’Œæœ€å€¼ï¼ŒåŒºé—´<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>o</mi><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">op</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">p</span></span></span></span>â€‹â€‹çš„æ—¶å€™æ¯”è¾ƒä¸€ä¸‹ä¸¤ä¸ªåŒºé—´çš„åŒºé—´æœ€å¤§å­æ®µå’Œä»¥åŠå‰æ®µåç¼€+åæ®µå‰ç¼€çš„å’Œå³å¯ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> i64 long long</span></span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">5e5</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">segtree</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">struct</span> <span class=\"title class_\">node</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        i64 sum, pre, suf, maxans;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    node tree[maxn &lt;&lt; <span class=\"number\">2</span>];</span><br><span class=\"line\">    i64 a[maxn];</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">pushup</span><span class=\"params\">(<span class=\"type\">int</span> rt)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> lson = rt &lt;&lt; <span class=\"number\">1</span>, rson = rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>;</span><br><span class=\"line\">        i64 interval = tree[lson].suf + tree[rson].pre;</span><br><span class=\"line\">        tree[rt].sum = tree[lson].sum + tree[rson].sum;</span><br><span class=\"line\">        tree[rt].pre = <span class=\"built_in\">max</span>(tree[lson].pre, tree[lson].sum + tree[rson].pre);</span><br><span class=\"line\">        tree[rt].suf = <span class=\"built_in\">max</span>(tree[rson].suf, tree[rson].sum + tree[lson].suf);</span><br><span class=\"line\">        tree[rt].maxans = <span class=\"built_in\">max</span>(<span class=\"built_in\">max</span>(tree[lson].maxans, tree[rson].maxans), interval);</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">build</span><span class=\"params\">(<span class=\"type\">int</span> rt, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (cl == cr)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            tree[rt].sum = tree[rt].pre = tree[rt].suf = tree[rt].maxans = a[cl];</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">build</span>(rt &lt;&lt; <span class=\"number\">1</span>, cl, mid);</span><br><span class=\"line\">        <span class=\"built_in\">build</span>(rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">        <span class=\"built_in\">pushup</span>(rt);</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">modify</span><span class=\"params\">(<span class=\"type\">int</span> pos, <span class=\"type\">int</span> val, <span class=\"type\">int</span> rt, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (cl == cr)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            tree[rt].sum = tree[rt].pre = tree[rt].suf = tree[rt].maxans = val;</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (pos &lt;= mid)</span><br><span class=\"line\">            <span class=\"built_in\">modify</span>(pos, val, rt &lt;&lt; <span class=\"number\">1</span>, cl, mid);</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">            <span class=\"built_in\">modify</span>(pos, val, rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">        <span class=\"built_in\">pushup</span>(rt);</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">node <span class=\"title\">query</span><span class=\"params\">(<span class=\"type\">int</span> l, <span class=\"type\">int</span> r, <span class=\"type\">int</span> rt, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (l &lt;= cl &amp;&amp; cr &lt;= r)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> tree[rt];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (r &lt;= mid)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">query</span>(l, r, rt &lt;&lt; <span class=\"number\">1</span>, cl, mid);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (l &gt; mid)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">query</span>(l, r, rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">        node lson = <span class=\"built_in\">query</span>(l, r, rt &lt;&lt; <span class=\"number\">1</span>, cl, mid);</span><br><span class=\"line\">        node rson = <span class=\"built_in\">query</span>(l, r, rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">        node ret;</span><br><span class=\"line\">        i64 interval = lson.suf + rson.pre;</span><br><span class=\"line\">        ret.sum = lson.sum + rson.sum;</span><br><span class=\"line\">        ret.pre = <span class=\"built_in\">max</span>(lson.pre, lson.sum + rson.pre);</span><br><span class=\"line\">        ret.suf = <span class=\"built_in\">max</span>(rson.suf, rson.sum + lson.suf);</span><br><span class=\"line\">        ret.maxans = <span class=\"built_in\">max</span>(<span class=\"built_in\">max</span>(lson.maxans, rson.maxans), interval);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ret;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">segtree seg;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"type\">int</span> n, m;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cin &gt;&gt; seg.a[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    seg.<span class=\"built_in\">build</span>(<span class=\"number\">1</span>, <span class=\"number\">1</span>, n);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= m; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> op, x, y;</span><br><span class=\"line\">        cin &gt;&gt; op &gt;&gt; x &gt;&gt; y;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (op == <span class=\"number\">1</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (x &gt; y)</span><br><span class=\"line\">                <span class=\"built_in\">swap</span>(x, y);</span><br><span class=\"line\">            cout &lt;&lt; seg.<span class=\"built_in\">query</span>(x, y, <span class=\"number\">1</span>, <span class=\"number\">1</span>, n).maxans &lt;&lt; endl;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            seg.<span class=\"built_in\">modify</span>(x, y, <span class=\"number\">1</span>, <span class=\"number\">1</span>, n);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"1-19-æƒå€¼æ ‘ç»´æŠ¤åŒºé—´æœ‰å¤šå°‘ä¸ªä¸åŒçš„æ•°\">1.19 æƒå€¼æ ‘ç»´æŠ¤åŒºé—´æœ‰å¤šå°‘ä¸ªä¸åŒçš„æ•°</h3>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>H</mi><mi>H</mi></mrow><annotation encoding=\"application/x-tex\">HH</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">HH</span></span></span></span>çš„é¡¹é“¾ï¼Œç¢°åˆ°ç›¸åŒçš„æ•°å°±æŠŠå‰é¢é‚£ä¸ªå‡ºç°çš„ä½ç½®åˆ æ‰ï¼ˆæƒå€¼æ ‘-1ï¼‰ï¼Œåé¢æ–°å‡ºç°çš„ä½ç½®åŠ ä¸Šï¼ˆæƒå€¼æ ‘+1ï¼‰</p>\n<p>è¿™ç©æ„å„¿æ²¡æ±‚å‰ç¼€å’Œï¼Œä¸èƒ½ç®—ä¸»å¸­æ ‘ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">int</span> <span class=\"title\">read</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> x = <span class=\"number\">0</span>, f = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"type\">char</span> ch = <span class=\"built_in\">getchar</span>();</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (ch &lt; <span class=\"string\">&#x27;0&#x27;</span> || ch &gt; <span class=\"string\">&#x27;9&#x27;</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (ch == <span class=\"string\">&#x27;-&#x27;</span>)</span><br><span class=\"line\">            f = <span class=\"number\">-1</span>;</span><br><span class=\"line\">        ch = <span class=\"built_in\">getchar</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (ch &gt;= <span class=\"string\">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class=\"string\">&#x27;9&#x27;</span>)</span><br><span class=\"line\">        x = x * <span class=\"number\">10</span> + ch - <span class=\"string\">&#x27;0&#x27;</span>, ch = <span class=\"built_in\">getchar</span>();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> x * f;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">write</span><span class=\"params\">(<span class=\"type\">int</span> x)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (x &lt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"built_in\">putchar</span>(<span class=\"string\">&#x27;-&#x27;</span>), x = -x;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (x &gt; <span class=\"number\">9</span>)</span><br><span class=\"line\">        <span class=\"built_in\">write</span>(x / <span class=\"number\">10</span>);</span><br><span class=\"line\">    <span class=\"built_in\">putchar</span>(x % <span class=\"number\">10</span> + <span class=\"string\">&#x27;0&#x27;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">Persistant_segtree</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"keyword\">private</span>:</span><br><span class=\"line\">    <span class=\"keyword\">struct</span> <span class=\"title class_\">node</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> l = <span class=\"number\">0</span>, r = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> sum = <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    vector&lt;node&gt; tree;</span><br><span class=\"line\">    <span class=\"type\">int</span> tot;</span><br><span class=\"line\">    <span class=\"type\">int</span> n;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"built_in\">Persistant_segtree</span>(<span class=\"type\">int</span> n) : <span class=\"built_in\">n</span>(n), <span class=\"built_in\">tot</span>(<span class=\"number\">0</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        tree.<span class=\"built_in\">assign</span>((n &lt;&lt; <span class=\"number\">5</span>) + <span class=\"number\">9</span>, <span class=\"built_in\">node</span>());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">Persistant_segtree</span>() : <span class=\"built_in\">n</span>(<span class=\"number\">0</span>), <span class=\"built_in\">tot</span>(<span class=\"number\">0</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        tree.<span class=\"built_in\">clear</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">init</span><span class=\"params\">(<span class=\"type\">int</span> n)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>-&gt;n = n;</span><br><span class=\"line\">        tot = <span class=\"number\">0</span>;</span><br><span class=\"line\">        tree = <span class=\"built_in\">vector</span>&lt;node&gt;((n &lt;&lt; <span class=\"number\">5</span>) + <span class=\"number\">9</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"type\">int</span> &amp;rt1, <span class=\"type\">int</span> rt2, <span class=\"type\">int</span> pos, <span class=\"type\">int</span> val, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!rt1)</span><br><span class=\"line\">            rt1 = ++tot;</span><br><span class=\"line\">        tree[rt1].sum = tree[rt2].sum + val;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (cl == cr)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (pos &lt;= mid)</span><br><span class=\"line\">            <span class=\"built_in\">update</span>(tree[rt1].l, tree[rt2].l, pos, val, cl, mid), tree[rt1].r = tree[rt2].r;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">            <span class=\"built_in\">update</span>(tree[rt1].r, tree[rt2].r, pos, val, mid + <span class=\"number\">1</span>, cr), tree[rt1].l = tree[rt2].l;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">query</span><span class=\"params\">(<span class=\"type\">int</span> &amp;rt, <span class=\"type\">int</span> l, <span class=\"type\">int</span> r, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!rt)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (l &lt;= cl &amp;&amp; cr &lt;= r)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> tree[rt].sum;</span><br><span class=\"line\">        <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> res = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (l &lt;= mid)</span><br><span class=\"line\">            res += <span class=\"built_in\">query</span>(tree[rt].l, l, r, cl, mid);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (r &gt; mid)</span><br><span class=\"line\">            res += <span class=\"built_in\">query</span>(tree[rt].r, l, r, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">Persistant_segtree pst;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">1e6</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> a[maxn], lastpos[maxn], root[maxn];</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> endl <span class=\"string\">&#x27;\\n&#x27;</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n, m;</span><br><span class=\"line\">    n = <span class=\"built_in\">read</span>();</span><br><span class=\"line\">    pst.<span class=\"built_in\">init</span>(maxn);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">        a[i] = <span class=\"built_in\">read</span>();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (lastpos[a[i]])</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            pst.<span class=\"built_in\">update</span>(root[i], root[i - <span class=\"number\">1</span>], lastpos[a[i]], <span class=\"number\">-1</span>, <span class=\"number\">1</span>, n);</span><br><span class=\"line\">            pst.<span class=\"built_in\">update</span>(root[i], root[i], i, <span class=\"number\">1</span>, <span class=\"number\">1</span>, n);</span><br><span class=\"line\">            lastpos[a[i]] = i;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            pst.<span class=\"built_in\">update</span>(root[i], root[i - <span class=\"number\">1</span>], i, <span class=\"number\">1</span>, <span class=\"number\">1</span>, n);</span><br><span class=\"line\">            lastpos[a[i]] = i;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    m = <span class=\"built_in\">read</span>();</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (m--)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> l, r;</span><br><span class=\"line\">        l = <span class=\"built_in\">read</span>(), r = <span class=\"built_in\">read</span>();</span><br><span class=\"line\">        <span class=\"built_in\">write</span>(pst.<span class=\"built_in\">query</span>(root[r], l, r, <span class=\"number\">1</span>, n));</span><br><span class=\"line\">        <span class=\"built_in\">putchar</span>(endl);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"1-20-çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾\">1.20  çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾</h3>\n<p>é€šè¿‡çº¿æ®µæ ‘åŒºé—´çš„æ€§è´¨å®ç°çº¿æ®µæ ‘åŒºé—´è¿è¾¹å»ºå›¾ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä»åŒºé—´è¿å‡ºéœ€è¦èµ°å‡ºæ ‘ï¼Œå‘åŒºé—´è¿å…¥éœ€è¦èµ°å…¥æ ‘ï¼Œå¿…é¡»ä¿è¯å»ºç«‹ä¸¤æ£µæ ‘ï¼Œå‡ºæ ‘å‘æ ¹æœ‰å‘è¾¹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mi>o</mi><mi>n</mi><mi>s</mi><mo>â†’</mo><mi>f</mi><mi>a</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(sons\\to fa)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">so</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">s</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â†’</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span></span></span></span>ï¼Œå…¥æ ‘ä»æ ¹å‘ä¸‹æœ‰å‘è¾¹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>f</mi><mi>a</mi><mo>â†’</mo><mi>s</mi><mi>o</mi><mi>n</mi><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(fa\\to sons)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â†’</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">so</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span>ï¼Œä¸å¯ä»¥ä¸²è¡Œã€‚å¶å­ç»“ç‚¹ä¸¤æ£µæ ‘å€’æ˜¯å¯ä»¥å…±äº«ï¼Œä¸å…±äº«çš„è¯å¶å­ç»“ç‚¹è¦åšå¥½æ— å‘è¾¹è”é€šï¼Œè¯¦æƒ…è§ç¤ºä¾‹ã€‚</p>\n<img src=\"https://oi-wiki.org/ds/images/segt6.svg\" alt=\"å‡ºæ ‘\" style=\"zoom:50%;\" />\n<img src=\"https://oi-wiki.org/ds/images/segt5.svg\" alt=\"å…¥æ ‘\" style=\"zoom:50%;\" />\n<p>æœ‰<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>ä¸ªç‚¹ã€<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span>æ¬¡æ“ä½œã€‚æ¯ä¸€ç§æ“ä½œä¸ºä»¥ä¸‹ä¸‰ç§ç±»å‹ä¸­çš„ä¸€ç§:</p>\n<ol>\n<li>è¿ä¸€æ¡<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo>â†’</mo><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">uâ†’v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â†’</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>çš„æœ‰å‘è¾¹,æƒå€¼ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span>ã€‚</li>\n<li>å¯¹äºæ‰€æœ‰<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>âˆˆ</mo><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">iâˆˆ[l,r]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6986em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">]</span></span></span></span>è¿ä¸€æ¡<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo>â†’</mo><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">uâ†’i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â†’</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>çš„æœ‰å‘è¾¹,æƒå€¼ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Ï‰</mi></mrow><annotation encoding=\"application/x-tex\">Ï‰</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">Ï‰</span></span></span></span>ã€‚</li>\n<li>å¯¹äºæ‰€æœ‰<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>âˆˆ</mo><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">iâˆˆ[l,r]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6986em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">]</span></span></span></span>è¿ä¸€æ¡<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>â†’</mo><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">iâ†’u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â†’</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>çš„æœ‰å‘è¾¹,æƒå€¼ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Ï‰</mi></mrow><annotation encoding=\"application/x-tex\">Ï‰</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">Ï‰</span></span></span></span>ã€‚</li>\n</ol>\n<p>æ±‚ä»ç‚¹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>åˆ°å…¶ä»–ç‚¹çš„æœ€çŸ­è·¯ã€‚</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>n</mi><mo separator=\"true\">,</mo><mi>q</mi><mo>â‰¤</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup><mo separator=\"true\">,</mo><mn>1</mn><mo>â‰¤</mo><mi>w</mi><mo>â‰¤</mo><mn>1</mn><msup><mn>0</mn><mn>9</mn></msup></mrow><annotation encoding=\"application/x-tex\">1â‰¤n,qâ‰¤10^5,1â‰¤wâ‰¤10^9</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8304em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0085em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">9</span></span></span></span></span></span></span></span></span></span></span>â€‹ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾</span></span><br><span class=\"line\"><span class=\"comment\">// åŒºé—´å¯¹åŒºé—´è¿è¾¹ï¼ŒåŒºé—´å¯¹å•ç‚¹è¿è¾¹ï¼Œå•ç‚¹å¯¹åŒºé—´è¿è¾¹</span></span><br><span class=\"line\"><span class=\"comment\">// æ˜¾ç„¶çš„ï¼Œéœ€è¦åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘ï¼Œå»ºç«‹çš„è™šç‚¹å‚ä¸è·‘æœ€çŸ­è·¯</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> int long long</span></span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> INF = <span class=\"number\">1e18</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> tottree = <span class=\"number\">0</span>, cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> root1 = <span class=\"number\">0</span>, root2 = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> n;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">4e5</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> head[maxn &lt;&lt; <span class=\"number\">3LL</span>], to[maxn &lt;&lt; <span class=\"number\">3LL</span>], nxt[maxn &lt;&lt; <span class=\"number\">3LL</span>], w[maxn &lt;&lt; <span class=\"number\">3LL</span>];</span><br><span class=\"line\"><span class=\"type\">int</span> rtnum1[maxn], rtnum2[maxn];</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">node</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> l, r;</span><br><span class=\"line\">    <span class=\"type\">int</span> cl, cr;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">node tree[maxn &lt;&lt; <span class=\"number\">3LL</span>];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">add_edge</span><span class=\"params\">(<span class=\"type\">int</span> u, <span class=\"type\">int</span> v, <span class=\"type\">int</span> w)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    to[++cnt] = v;</span><br><span class=\"line\">    ::w[cnt] = w;</span><br><span class=\"line\">    nxt[cnt] = head[u];</span><br><span class=\"line\">    head[u] = cnt;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">build1</span><span class=\"params\">(<span class=\"type\">int</span> &amp;rt, <span class=\"type\">int</span> cl = <span class=\"number\">1</span>, <span class=\"type\">int</span> cr = n)</span> <span class=\"comment\">// å‡ºæ ‘ï¼ŒåŒºé—´è¿å‡º</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!rt)</span><br><span class=\"line\">        rt = ++tottree;</span><br><span class=\"line\">    tree[rt].cl = cl;</span><br><span class=\"line\">    tree[rt].cr = cr;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cl == cr)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        rtnum1[cl] = rt;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1LL</span>;</span><br><span class=\"line\">    <span class=\"built_in\">build1</span>(tree[rt].l, cl, mid);</span><br><span class=\"line\">    <span class=\"built_in\">build1</span>(tree[rt].r, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">    <span class=\"built_in\">add_edge</span>(tree[rt].l, rt, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">add_edge</span>(tree[rt].r, rt, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">build2</span><span class=\"params\">(<span class=\"type\">int</span> &amp;rt, <span class=\"type\">int</span> cl = <span class=\"number\">1</span>, <span class=\"type\">int</span> cr = n)</span> <span class=\"comment\">// å…¥æ ‘ï¼ŒåŒºé—´è¿å…¥</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!rt)</span><br><span class=\"line\">        rt = ++tottree;</span><br><span class=\"line\">    tree[rt].cl = cl;</span><br><span class=\"line\">    tree[rt].cr = cr;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cl == cr)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        rtnum2[cl] = rt;</span><br><span class=\"line\">        <span class=\"built_in\">add_edge</span>(rt, rtnum1[cl], <span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1LL</span>;</span><br><span class=\"line\">    <span class=\"built_in\">build2</span>(tree[rt].l, cl, mid);</span><br><span class=\"line\">    <span class=\"built_in\">build2</span>(tree[rt].r, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">    <span class=\"built_in\">add_edge</span>(rt, tree[rt].l, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">add_edge</span>(rt, tree[rt].r, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">update1</span><span class=\"params\">(<span class=\"type\">int</span> &amp;rt, <span class=\"type\">int</span> u, <span class=\"type\">int</span> vl, <span class=\"type\">int</span> vr, <span class=\"type\">int</span> w, <span class=\"type\">int</span> cl = <span class=\"number\">1</span>, <span class=\"type\">int</span> cr = n)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!rt)</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (vl &lt;= cl &amp;&amp; cr &lt;= vr)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">add_edge</span>(rtnum1[u], rt, w);</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1LL</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (vl &lt;= mid)</span><br><span class=\"line\">        <span class=\"built_in\">update1</span>(tree[rt].l, u, vl, vr, w, cl, mid);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (vr &gt; mid)</span><br><span class=\"line\">        <span class=\"built_in\">update1</span>(tree[rt].r, u, vl, vr, w, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">update2</span><span class=\"params\">(<span class=\"type\">int</span> &amp;rt, <span class=\"type\">int</span> v, <span class=\"type\">int</span> ul, <span class=\"type\">int</span> ur, <span class=\"type\">int</span> w, <span class=\"type\">int</span> cl = <span class=\"number\">1</span>, <span class=\"type\">int</span> cr = n)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!rt)</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (ul &lt;= cl &amp;&amp; cr &lt;= ur)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">add_edge</span>(rt, rtnum2[v], w);</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1LL</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (ul &lt;= mid)</span><br><span class=\"line\">        <span class=\"built_in\">update2</span>(tree[rt].l, v, ul, ur, w, cl, mid);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (ur &gt; mid)</span><br><span class=\"line\">        <span class=\"built_in\">update2</span>(tree[rt].r, v, ul, ur, w, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"type\">int</span> dist[maxn &lt;&lt; <span class=\"number\">3LL</span>];</span><br><span class=\"line\"><span class=\"type\">bool</span> vis[maxn &lt;&lt; <span class=\"number\">3LL</span>];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">updist</span><span class=\"params\">(<span class=\"type\">int</span> &amp;rt, <span class=\"type\">int</span> cl = <span class=\"number\">1</span>, <span class=\"type\">int</span> cr = n)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!rt)</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cl == cr)</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1LL</span>;</span><br><span class=\"line\">    dist[tree[rt].l] = <span class=\"built_in\">min</span>(dist[rt], dist[tree[rt].l]);</span><br><span class=\"line\">    dist[tree[rt].r] = <span class=\"built_in\">min</span>(dist[rt], dist[tree[rt].r]);</span><br><span class=\"line\">    <span class=\"built_in\">updist</span>(tree[rt].l, cl, mid);</span><br><span class=\"line\">    <span class=\"built_in\">updist</span>(tree[rt].r, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">dijkstra</span><span class=\"params\">(<span class=\"type\">int</span> s)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// memset(dist, 0x3f3f3f3f, sizeof(int) * (tottree + 10));</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= tottree + <span class=\"number\">10</span>; i++)</span><br><span class=\"line\">        dist[i] = INF, vis[i] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">struct</span> <span class=\"title class_\">qu</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> dis, pos;</span><br><span class=\"line\">        <span class=\"type\">bool</span> <span class=\"keyword\">operator</span>&lt;(<span class=\"type\">const</span> qu &amp;x) <span class=\"type\">const</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> x.dis &lt; dis;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    priority_queue&lt;qu&gt; q;</span><br><span class=\"line\">    dist[rtnum1[s]] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    q.<span class=\"built_in\">push</span>(&#123;<span class=\"number\">0</span>, rtnum1[s]&#125;);</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (!q.<span class=\"built_in\">empty</span>())</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> [disu, u] = q.<span class=\"built_in\">top</span>();</span><br><span class=\"line\">        q.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (vis[u])</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        vis[u] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = head[u]; i; i = nxt[i])</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> v = to[i];</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (dist[v] &gt; dist[u] + w[i])</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                dist[v] = dist[u] + w[i];</span><br><span class=\"line\">                q.<span class=\"built_in\">push</span>(&#123;dist[v], v&#125;);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// updist(root);</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">clear</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">memset</span>(head, <span class=\"number\">0</span>, <span class=\"built_in\">sizeof</span>(<span class=\"type\">int</span>) * (tottree + <span class=\"number\">10</span>));</span><br><span class=\"line\">    cnt = <span class=\"number\">0</span>, tottree = <span class=\"number\">0</span>;</span><br><span class=\"line\">    root1 = <span class=\"number\">0</span>, root2 = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">solve</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> q, s;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; q &gt;&gt; s;</span><br><span class=\"line\">    <span class=\"built_in\">build1</span>(root1);</span><br><span class=\"line\">    <span class=\"built_in\">build2</span>(root2);</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (q--)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> op;</span><br><span class=\"line\">        cin &gt;&gt; op;</span><br><span class=\"line\">        <span class=\"type\">int</span> u, v, w, l, r;</span><br><span class=\"line\">        <span class=\"keyword\">switch</span> (op)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">1</span>:</span><br><span class=\"line\">            cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class=\"line\">            <span class=\"built_in\">add_edge</span>(rtnum1[u], rtnum2[v], w);</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">2</span>:</span><br><span class=\"line\">            cin &gt;&gt; u &gt;&gt; l &gt;&gt; r &gt;&gt; w;</span><br><span class=\"line\">            <span class=\"built_in\">update1</span>(root2, u, l, r, w);</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">3</span>:</span><br><span class=\"line\">            cin &gt;&gt; v &gt;&gt; l &gt;&gt; r &gt;&gt; w;</span><br><span class=\"line\">            <span class=\"built_in\">update2</span>(root1, v, l, r, w);</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">dijkstra</span>(s);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (i == s)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            cout &lt;&lt; <span class=\"string\">&quot;0 &quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (dist[rtnum2[i]] == INF)</span><br><span class=\"line\">            cout &lt;&lt; <span class=\"string\">&quot;-1 &quot;</span>;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">            cout &lt;&lt; dist[rtnum2[i]] &lt;&lt; <span class=\"string\">&quot; &quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; endl;</span><br><span class=\"line\">    <span class=\"built_in\">clear</span>();</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"type\">int</span> t = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"comment\">// cin &gt;&gt; t;</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> (t--)</span><br><span class=\"line\">        <span class=\"built_in\">solve</span>();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"1-21-å‰å¸æœºçº¿æ®µæ ‘\">*1.21 å‰å¸æœºçº¿æ®µæ ‘</h3>\n<p>çº¿æ®µæ ‘ç»´æŠ¤åŒºé—´æœ€å€¼æ“ä½œä¸åŒºé—´å†å²æœ€å€¼çš„æ¨¡æ¿ã€‚</p>\n<p>ç»™å‡ºä¸€ä¸ªé•¿åº¦ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> çš„æ•°åˆ— <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>ï¼ŒåŒæ—¶å®šä¹‰ä¸€ä¸ªè¾…åŠ©æ•°ç»„ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span>ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span> å¼€å§‹ä¸ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span> å®Œå…¨ç›¸åŒã€‚æ¥ä¸‹æ¥è¿›è¡Œäº† <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span> æ¬¡æ“ä½œï¼Œæ“ä½œæœ‰äº”ç§ç±»å‹ï¼ŒæŒ‰ä»¥ä¸‹æ ¼å¼ç»™å‡ºï¼š</p>\n<ul>\n<li><code>1 l r k</code>ï¼šå¯¹äºæ‰€æœ‰çš„ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>âˆˆ</mo><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">i\\in[l,r]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6986em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">]</span></span></span></span>ï¼Œå°† <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">A_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> åŠ ä¸Š <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>ï¼ˆ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> å¯ä»¥ä¸ºè´Ÿæ•°ï¼‰ã€‚</li>\n<li><code>2 l r v</code>ï¼šå¯¹äºæ‰€æœ‰çš„ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>âˆˆ</mo><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">i\\in[l,r]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6986em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">]</span></span></span></span>ï¼Œå°† <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">A_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> å˜æˆ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>min</mi><mo>â¡</mo><mo stretchy=\"false\">(</mo><msub><mi>A</mi><mi>i</mi></msub><mo separator=\"true\">,</mo><mi>v</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\min(A_i,v)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">min</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mclose\">)</span></span></span></span>ã€‚</li>\n<li><code>3 l r</code>ï¼šæ±‚ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mi>l</mi></mrow><mi>r</mi></msubsup><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\sum_{i=l}^{r}A_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.104em;vertical-align:-0.2997em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8043em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ã€‚</li>\n<li><code>4 l r</code>ï¼šå¯¹äºæ‰€æœ‰çš„ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>âˆˆ</mo><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">i\\in[l,r]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6986em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">]</span></span></span></span>ï¼Œæ±‚ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">A_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> çš„æœ€å¤§å€¼ã€‚</li>\n<li><code>5 l r</code>ï¼šå¯¹äºæ‰€æœ‰çš„ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>âˆˆ</mo><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">i\\in[l,r]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6986em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">]</span></span></span></span>ï¼Œæ±‚ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>B</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">B_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> çš„æœ€å¤§å€¼ã€‚</li>\n</ul>\n<p>åœ¨æ¯ä¸€æ¬¡æ“ä½œåï¼Œæˆ‘ä»¬éƒ½è¿›è¡Œä¸€æ¬¡æ›´æ–°ï¼Œè®© <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>B</mi><mi>i</mi></msub><mo>â†</mo><mi>max</mi><mo>â¡</mo><mo stretchy=\"false\">(</mo><msub><mi>B</mi><mi>i</mi></msub><mo separator=\"true\">,</mo><msub><mi>A</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">B_i\\gets\\max(B_i,A_i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â†</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">max</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>ã€‚</p>\n<p>ä¿è¯ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>n</mi><mo separator=\"true\">,</mo><mi>m</mi><mo>â‰¤</mo><mn>5</mn><mo>Ã—</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding=\"application/x-tex\">1\\leq n,m\\leq 5\\times 10^5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8304em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">5</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span></span></span></span></span></span></span></span>,<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>âˆ’</mo><mn>5</mn><mo>Ã—</mo><mn>1</mn><msup><mn>0</mn><mn>8</mn></msup><mo>â‰¤</mo><msub><mi>A</mi><mi>i</mi></msub><mo>â‰¤</mo><mn>5</mn><mo>Ã—</mo><mn>1</mn><msup><mn>0</mn><mn>8</mn></msup></mrow><annotation encoding=\"application/x-tex\">-5\\times10^8\\leq A_i\\leq 5\\times10^8</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">âˆ’</span><span class=\"mord\">5</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9501em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">8</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">5</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">8</span></span></span></span></span></span></span></span></span></span></span>,</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>o</mi><mi>p</mi><mo>âˆˆ</mo><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>5</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">op\\in[1,5]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">5</span><span class=\"mclose\">]</span></span></span></span>,<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>l</mi><mo>â‰¤</mo><mi>r</mi><mo>â‰¤</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">1 \\leq l\\leq r \\leq n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8304em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>,<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>âˆ’</mo><mn>2000</mn><mo>â‰¤</mo><mi>k</mi><mo>â‰¤</mo><mn>2000</mn></mrow><annotation encoding=\"application/x-tex\">-2000\\leq k\\leq 2000</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">âˆ’</span><span class=\"mord\">2000</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8304em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2000</span></span></span></span>,</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>âˆ’</mo><mn>5</mn><mo>Ã—</mo><mn>1</mn><msup><mn>0</mn><mn>8</mn></msup><mo>â‰¤</mo><mi>v</mi><mo>â‰¤</mo><mn>5</mn><mo>Ã—</mo><mn>1</mn><msup><mn>0</mn><mn>8</mn></msup></mrow><annotation encoding=\"application/x-tex\">-5\\times10^8\\leq v\\leq 5\\times10^8</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">âˆ’</span><span class=\"mord\">5</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9501em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">8</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">5</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">8</span></span></span></span></span></span></span></span></span></span></span>â€‹â€‹ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> ll long long</span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">char</span> buf[<span class=\"number\">1</span>&lt;&lt;<span class=\"number\">21</span>],*p1=buf,*p2=buf,obuf[<span class=\"number\">1</span>&lt;&lt;<span class=\"number\">21</span>],*o=obuf;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> g()(p1==p2&amp;&amp;(p2=(p1=buf)+fread(buf,1,1&lt;&lt;21,stdin),p1==p2)?EOF:*p1++)</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">int</span> <span class=\"title\">read</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> s=<span class=\"number\">0</span>,f=<span class=\"number\">1</span>;<span class=\"type\">char</span> c=<span class=\"built_in\">g</span>();</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(;!<span class=\"built_in\">isdigit</span>(c);c=<span class=\"built_in\">g</span>())</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(c==<span class=\"string\">&#x27;-&#x27;</span>)f=<span class=\"number\">-1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(;<span class=\"built_in\">isdigit</span>(c);c=<span class=\"built_in\">g</span>())</span><br><span class=\"line\">        s=s*<span class=\"number\">10</span>+c-<span class=\"string\">&#x27;0&#x27;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> s*f;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">void</span> <span class=\"title\">write</span><span class=\"params\">(ll x)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">static</span> <span class=\"type\">char</span> buf[<span class=\"number\">20</span>];</span><br><span class=\"line\">    <span class=\"type\">static</span> <span class=\"type\">int</span> len=<span class=\"number\">-1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(x&lt;<span class=\"number\">0</span>)<span class=\"built_in\">putchar</span>(<span class=\"string\">&#x27;-&#x27;</span>),x=-x;</span><br><span class=\"line\">    <span class=\"keyword\">do</span> buf[++len]=x%<span class=\"number\">10</span>,x/=<span class=\"number\">10</span>;<span class=\"keyword\">while</span>(x);</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(len&gt;=<span class=\"number\">0</span>)<span class=\"built_in\">putchar</span>(buf[len--]+<span class=\"string\">&#x27;0&#x27;</span>);</span><br><span class=\"line\">    <span class=\"built_in\">putchar</span>(<span class=\"string\">&#x27;\\n&#x27;</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"type\">int</span> n,m,op,l,r,k,v;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">segment_tree</span>&#123;</span><br><span class=\"line\">    ll sum;</span><br><span class=\"line\">    <span class=\"type\">int</span> l,r,maxa,cnt,se,maxb;</span><br><span class=\"line\">    <span class=\"type\">int</span> add1,add2,add3,add4;</span><br><span class=\"line\">&#125;s[<span class=\"number\">2000005</span>];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">void</span> <span class=\"title\">push_up</span><span class=\"params\">(<span class=\"type\">int</span> p)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    s[p].sum=s[p*<span class=\"number\">2</span>].sum+s[p*<span class=\"number\">2</span><span class=\"number\">+1</span>].sum;</span><br><span class=\"line\">    s[p].maxa=<span class=\"built_in\">max</span>(s[p*<span class=\"number\">2</span>].maxa,s[p*<span class=\"number\">2</span><span class=\"number\">+1</span>].maxa);</span><br><span class=\"line\">    s[p].maxb=<span class=\"built_in\">max</span>(s[p*<span class=\"number\">2</span>].maxb,s[p*<span class=\"number\">2</span><span class=\"number\">+1</span>].maxb);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(s[p*<span class=\"number\">2</span>].maxa==s[p*<span class=\"number\">2</span><span class=\"number\">+1</span>].maxa)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        s[p].se=<span class=\"built_in\">max</span>(s[p*<span class=\"number\">2</span>].se,s[p*<span class=\"number\">2</span><span class=\"number\">+1</span>].se);</span><br><span class=\"line\">        s[p].cnt=s[p*<span class=\"number\">2</span>].cnt+s[p*<span class=\"number\">2</span><span class=\"number\">+1</span>].cnt;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(s[p*<span class=\"number\">2</span>].maxa&gt;s[p*<span class=\"number\">2</span><span class=\"number\">+1</span>].maxa)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        s[p].se=<span class=\"built_in\">max</span>(s[p*<span class=\"number\">2</span>].se,s[p*<span class=\"number\">2</span><span class=\"number\">+1</span>].maxa);</span><br><span class=\"line\">        s[p].cnt=s[p*<span class=\"number\">2</span>].cnt;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        s[p].se=<span class=\"built_in\">max</span>(s[p*<span class=\"number\">2</span>].maxa,s[p*<span class=\"number\">2</span><span class=\"number\">+1</span>].se);</span><br><span class=\"line\">        s[p].cnt=s[p*<span class=\"number\">2</span><span class=\"number\">+1</span>].cnt;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">build</span><span class=\"params\">(<span class=\"type\">int</span> l,<span class=\"type\">int</span> r,<span class=\"type\">int</span> p)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    s[p].l=l,s[p].r=r;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(l==r)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        s[p].sum=s[p].maxa=s[p].maxb=<span class=\"built_in\">read</span>();</span><br><span class=\"line\">        s[p].cnt=<span class=\"number\">1</span>,s[p].se=<span class=\"number\">-2e9</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid=(l+r)/<span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"built_in\">build</span>(l,mid,p*<span class=\"number\">2</span>);</span><br><span class=\"line\">    <span class=\"built_in\">build</span>(mid<span class=\"number\">+1</span>,r,p*<span class=\"number\">2</span><span class=\"number\">+1</span>);</span><br><span class=\"line\">    <span class=\"built_in\">push_up</span>(p);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">void</span> <span class=\"title\">change</span><span class=\"params\">(<span class=\"type\">int</span> k1,<span class=\"type\">int</span> k2,<span class=\"type\">int</span> k3,<span class=\"type\">int</span> k4,<span class=\"type\">int</span> p)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    s[p].sum+=<span class=\"number\">1ll</span>*k1*s[p].cnt<span class=\"number\">+1ll</span>*k2*(s[p].r-s[p].l<span class=\"number\">+1</span>-s[p].cnt);</span><br><span class=\"line\">    s[p].maxb=<span class=\"built_in\">max</span>(s[p].maxb,s[p].maxa+k3);</span><br><span class=\"line\">    s[p].maxa+=k1;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(s[p].se!=<span class=\"number\">-2e9</span>)s[p].se+=k2;</span><br><span class=\"line\">    s[p].add3=<span class=\"built_in\">max</span>(s[p].add3,s[p].add1+k3);</span><br><span class=\"line\">    s[p].add4=<span class=\"built_in\">max</span>(s[p].add4,s[p].add2+k4);</span><br><span class=\"line\">    s[p].add1+=k1,s[p].add2+=k2;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">void</span> <span class=\"title\">push_down</span><span class=\"params\">(<span class=\"type\">int</span> p)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> maxn=<span class=\"built_in\">max</span>(s[p*<span class=\"number\">2</span>].maxa,s[p*<span class=\"number\">2</span><span class=\"number\">+1</span>].maxa);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(s[p*<span class=\"number\">2</span>].maxa==maxn)</span><br><span class=\"line\">        <span class=\"built_in\">change</span>(s[p].add1,s[p].add2,s[p].add3,s[p].add4,p*<span class=\"number\">2</span>);</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"built_in\">change</span>(s[p].add2,s[p].add2,s[p].add4,s[p].add4,p*<span class=\"number\">2</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(s[p*<span class=\"number\">2</span><span class=\"number\">+1</span>].maxa==maxn)</span><br><span class=\"line\">        <span class=\"built_in\">change</span>(s[p].add1,s[p].add2,s[p].add3,s[p].add4,p*<span class=\"number\">2</span><span class=\"number\">+1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"built_in\">change</span>(s[p].add2,s[p].add2,s[p].add4,s[p].add4,p*<span class=\"number\">2</span><span class=\"number\">+1</span>);</span><br><span class=\"line\">    s[p].add1=s[p].add2=s[p].add3=s[p].add4=<span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">update_add</span><span class=\"params\">(<span class=\"type\">int</span> p)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(l&gt;s[p].r||r&lt;s[p].l)<span class=\"keyword\">return</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(l&lt;=s[p].l&amp;&amp;s[p].r&lt;=r)</span><br><span class=\"line\">    &#123;\t</span><br><span class=\"line\">        s[p].sum+=<span class=\"number\">1ll</span>*k*s[p].cnt<span class=\"number\">+1ll</span>*k*(s[p].r-s[p].l<span class=\"number\">+1</span>-s[p].cnt);</span><br><span class=\"line\">        s[p].maxa+=k;</span><br><span class=\"line\">        s[p].maxb=<span class=\"built_in\">max</span>(s[p].maxb,s[p].maxa);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(s[p].se!=<span class=\"number\">-2e9</span>)s[p].se+=k;</span><br><span class=\"line\">        s[p].add1+=k,s[p].add2+=k;</span><br><span class=\"line\">        s[p].add3=<span class=\"built_in\">max</span>(s[p].add3,s[p].add1);</span><br><span class=\"line\">        s[p].add4=<span class=\"built_in\">max</span>(s[p].add4,s[p].add2);</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">push_down</span>(p);</span><br><span class=\"line\">    <span class=\"built_in\">update_add</span>(p*<span class=\"number\">2</span>),<span class=\"built_in\">update_add</span>(p*<span class=\"number\">2</span><span class=\"number\">+1</span>);</span><br><span class=\"line\">    <span class=\"built_in\">push_up</span>(p);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">update_min</span><span class=\"params\">(<span class=\"type\">int</span> p)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(l&gt;s[p].r||r&lt;s[p].l||v&gt;=s[p].maxa)<span class=\"keyword\">return</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(l&lt;=s[p].l&amp;&amp;s[p].r&lt;=r&amp;&amp;s[p].se&lt;v)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> k=s[p].maxa-v;</span><br><span class=\"line\">        s[p].sum-=<span class=\"number\">1ll</span>*s[p].cnt*k;</span><br><span class=\"line\">        s[p].maxa=v,s[p].add1-=k;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">push_down</span>(p);</span><br><span class=\"line\">    <span class=\"built_in\">update_min</span>(p*<span class=\"number\">2</span>),<span class=\"built_in\">update_min</span>(p*<span class=\"number\">2</span><span class=\"number\">+1</span>);</span><br><span class=\"line\">    <span class=\"built_in\">push_up</span>(p);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">query_sum</span><span class=\"params\">(<span class=\"type\">int</span> p)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(l&gt;s[p].r||r&lt;s[p].l)<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(l&lt;=s[p].l&amp;&amp;s[p].r&lt;=r)<span class=\"keyword\">return</span> s[p].sum;</span><br><span class=\"line\">    <span class=\"built_in\">push_down</span>(p);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">query_sum</span>(p*<span class=\"number\">2</span>)+<span class=\"built_in\">query_sum</span>(p*<span class=\"number\">2</span><span class=\"number\">+1</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">query_maxa</span><span class=\"params\">(<span class=\"type\">int</span> p)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(l&gt;s[p].r||r&lt;s[p].l)<span class=\"keyword\">return</span> <span class=\"number\">-2e9</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(l&lt;=s[p].l&amp;&amp;s[p].r&lt;=r)<span class=\"keyword\">return</span> s[p].maxa;</span><br><span class=\"line\">    <span class=\"built_in\">push_down</span>(p);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">max</span>(<span class=\"built_in\">query_maxa</span>(p*<span class=\"number\">2</span>),<span class=\"built_in\">query_maxa</span>(p*<span class=\"number\">2</span><span class=\"number\">+1</span>));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">query_maxb</span><span class=\"params\">(<span class=\"type\">int</span> p)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(l&gt;s[p].r||r&lt;s[p].l)<span class=\"keyword\">return</span> <span class=\"number\">-2e9</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(l&lt;=s[p].l&amp;&amp;s[p].r&lt;=r)<span class=\"keyword\">return</span> s[p].maxb;</span><br><span class=\"line\">    <span class=\"built_in\">push_down</span>(p);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">max</span>(<span class=\"built_in\">query_maxb</span>(p*<span class=\"number\">2</span>),<span class=\"built_in\">query_maxb</span>(p*<span class=\"number\">2</span><span class=\"number\">+1</span>));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    n=<span class=\"built_in\">read</span>(),m=<span class=\"built_in\">read</span>();</span><br><span class=\"line\">    <span class=\"built_in\">build</span>(<span class=\"number\">1</span>,n,<span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(m--)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        op=<span class=\"built_in\">read</span>(),l=<span class=\"built_in\">read</span>(),r=<span class=\"built_in\">read</span>();</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(op==<span class=\"number\">1</span>)k=<span class=\"built_in\">read</span>(),<span class=\"built_in\">update_add</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(op==<span class=\"number\">2</span>)v=<span class=\"built_in\">read</span>(),<span class=\"built_in\">update_min</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(op==<span class=\"number\">3</span>)<span class=\"built_in\">write</span>(<span class=\"built_in\">query_sum</span>(<span class=\"number\">1</span>));</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(op==<span class=\"number\">4</span>)<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d\\n&quot;</span>,<span class=\"built_in\">query_maxa</span>(<span class=\"number\">1</span>));</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d\\n&quot;</span>,<span class=\"built_in\">query_maxb</span>(<span class=\"number\">1</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"1-22-æ ‘ä¸Šæ•°æ®ç»“æ„è­¦ç¤ºï¼ˆæ ‘ä¸Šçº¿æ®µæ ‘ï¼‰\">*1.22 æ ‘ä¸Šæ•°æ®ç»“æ„è­¦ç¤ºï¼ˆæ ‘ä¸Šçº¿æ®µæ ‘ï¼‰</h3>\n<p>ä¸€èˆ¬è€Œè¨€ï¼Œæ ‘ä¸Šæ•°æ®ç»“æ„ä¸»è¦æ˜¯æ ‘ä¸Šæƒå€¼æ ‘ä»¥åŠæ ‘ä¸ŠåŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘ã€‚è¿™é‡ŒæåŠä¸¤ä¸ª<strong>éœ€è¦æ³¨æ„çš„ç‚¹</strong></p>\n<ol>\n<li>\n<p>ä¸»å¸­æ ‘/çº¿æ®µæ ‘åˆå¹¶å†™æ³•çš„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>e</mi></mrow><annotation encoding=\"application/x-tex\">merge</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">er</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">e</span></span></span></span>å‡½æ•°åœ¨å‘çˆ¶èŠ‚ç‚¹åˆå¹¶çš„æ—¶å€™ä¼šæœ‰æ‹·è´èŠ‚ç‚¹ï¼ˆä¸»å¸­æ ‘åŸç†ï¼‰ï¼Œ**å¦‚æœæœ‰å¤šä¸ªå„¿å­èŠ‚ç‚¹ï¼Œè¿™ç§è¡Œä¸ºä¼šå¯¼è‡´çˆ¶èŠ‚ç‚¹ä¿¡æ¯åˆå¹¶å®Œå…¨ä¹‹åï¼Œå­èŠ‚ç‚¹çš„ä¸»å¸­æ ‘ä¿¡æ¯è¢«æ±¡æŸ“ã€‚**å¦‚æœè¦è¿™ä¹ˆåšï¼Œæ¶‰åŠåˆ°å­æ ‘ä¿¡æ¯æŸ¥è¯¢ï¼Œéœ€è¦åˆå¹¶dfsçš„åŒæ—¶è¿›è¡Œç¦»çº¿å¤„ç†ï¼Œä¿è¯æ±¡æŸ“ä¹‹åä¸å†æŸ¥è¯¢ã€‚</p>\n<p>è§£å†³æ–¹æ³•æ˜¯æ ‘é“¾å‰–åˆ†ï¼Œå°¤å…¶æ˜¯å­æ ‘ä¿¡æ¯ç»´æŠ¤ï¼Œæ›´æ˜¯æ ‘å‰–ä¸ºé‡ä¸­ä¹‹é‡ã€‚</p>\n<p>æ ‘ä¸Šå·®åˆ†ä¸ä¼šå› ä¸ºè¿™ä¸ªå—å½±å“çš„åŸå› åœ¨äºï¼Œæ ‘ä¸Šå·®åˆ†çš„ä¿¡æ¯åˆå¹¶æ˜¯çˆ¶èŠ‚ç‚¹å‘å­èŠ‚ç‚¹åˆå¹¶ï¼Œå­èŠ‚ç‚¹ç»§æ‰¿çˆ¶èŠ‚ç‚¹çš„ä¿¡æ¯ä»¥è®°å½•<strong>ä»è‡ªå·±ç›´åˆ°æ ¹</strong>è·¯å¾„ä¸Šçš„æ‰€æœ‰æ•°ä¿¡æ¯ï¼Œå­èŠ‚ç‚¹åªæœ‰ä¸€ä¸ªçˆ¶èŠ‚ç‚¹å¯ä»¥ç»§æ‰¿ï¼Œæ„å‘³ç€çˆ¶èŠ‚ç‚¹çš„ä¿¡æ¯ä¸ä¼šè¢«æ±¡æŸ“ã€‚</p>\n<p>ï¼ˆABC239E æ ‘ä¸Šå­æ ‘ç¬¬<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span>â€‹å¤§å› ä¸ºè¿™ä¸ªé—®é¢˜å¯¼è‡´WAï¼‰</p>\n</li>\n<li>\n<p>æ ‘ä¸Šåˆå¹¶ï¼Œ<strong>ä¸€å®šæ£€æŸ¥æœ‰æ²¡æœ‰å†™</strong><code>cl==cr</code>é‡Œé¢çš„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle mathcolor=\"red\"><mi>r</mi><mi>e</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>n</mi></mstyle></mrow><annotation encoding=\"application/x-tex\">\\color{red}return</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\" style=\"color:red;\">re</span><span class=\"mord mathnormal\" style=\"color:red;\">t</span><span class=\"mord mathnormal\" style=\"color:red;\">u</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;color:red;\">r</span><span class=\"mord mathnormal\" style=\"color:red;\">n</span></span></span></span></p>\n</li>\n</ol>\n<div style=\"page-break-after: always;\"></div>\n<h2 id=\"2-å †-Heap\">2.å †(Heap)</h2>\n<p>å…³é”®è¯ï¼šæœ‰åºåºåˆ—ï¼Œåªå…³å¿ƒæœ€å€¼</p>\n<h3 id=\"2-1-å¯å¹¶å †ï¼ˆå·¦åæ ‘ï¼‰\">2.1 å¯å¹¶å †ï¼ˆå·¦åæ ‘ï¼‰</h3>\n<p>å®šä¹‰å·¦åæ ‘ä¸­å·¦å„¿å­ç»“ç‚¹çš„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><msub><mi>t</mi><mi>l</mi></msub></mrow><annotation encoding=\"application/x-tex\">dist_l</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">s</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ä¸€å®šå¤§äºç­‰äºå³å„¿å­èŠ‚ç‚¹çš„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><msub><mi>t</mi><mi>r</mi></msub></mrow><annotation encoding=\"application/x-tex\">dist_r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">s</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>.</p>\n<p>å®šä¹‰æŸèŠ‚ç‚¹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>çš„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><msub><mi>t</mi><mi>u</mi></msub></mrow><annotation encoding=\"application/x-tex\">dist_u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">s</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ä¸ºå…¶åˆ°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>â€‹â€‹æ‰€åœ¨å­æ ‘ä¸­æœ€è¿‘çš„å¤–èŠ‚ç‚¹ï¼ˆæ²¡æœ‰å·¦å„¿å­æˆ–è€…å³å„¿å­ï¼‰çš„è·ç¦»ã€‚</p>\n<p>ä¸€å¼€å§‹æœ‰ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> ä¸ªå°æ ¹å †ï¼Œæ¯ä¸ªå †åŒ…å«ä¸”ä»…åŒ…å«ä¸€ä¸ªæ•°ã€‚æ¥ä¸‹æ¥éœ€è¦æ”¯æŒä¸¤ç§æ“ä½œï¼š</p>\n<ol>\n<li>\n<p><code>1 x y</code>ï¼šå°†ç¬¬ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> ä¸ªæ•°å’Œç¬¬ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span> ä¸ªæ•°æ‰€åœ¨çš„å°æ ¹å †åˆå¹¶ï¼ˆè‹¥ç¬¬ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> æˆ–ç¬¬ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span> ä¸ªæ•°å·²ç»è¢«åˆ é™¤æˆ–ç¬¬ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> å’Œç¬¬ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span> ä¸ªæ•°åœ¨åŒä¸€ä¸ªå †å†…ï¼Œåˆ™æ— è§†æ­¤æ“ä½œï¼‰ã€‚</p>\n</li>\n<li>\n<p><code>2 x</code>ï¼šè¾“å‡ºç¬¬ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> ä¸ªæ•°æ‰€åœ¨çš„å †æœ€å°æ•°ï¼Œå¹¶å°†è¿™ä¸ªæœ€å°æ•°åˆ é™¤ï¼ˆè‹¥æœ‰å¤šä¸ªæœ€å°æ•°ï¼Œä¼˜å…ˆåˆ é™¤å…ˆè¾“å…¥çš„ï¼›è‹¥ç¬¬ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> ä¸ªæ•°å·²ç»è¢«åˆ é™¤ï¼Œåˆ™è¾“å‡º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">âˆ’</span><span class=\"mord\">1</span></span></span></span>â€‹ å¹¶æ— è§†åˆ é™¤æ“ä½œï¼‰ã€‚</p>\n</li>\n</ol>\n<p><em><strong>æ³¨æ„ï¼Œè¿™ä¸ªé¢˜éœ€è¦æŸ¥æŸä¸ªæ•°åœ¨å“ªä¸ªå †ï¼Œéœ€è¦å¹¶æŸ¥é›†ï¼Œè€Œä¸”å› ä¸ºè·¯å¾„å‹ç¼©çš„ä¸æˆæ ·å­ï¼Œä½†å‡¡æ¶‰åŠåˆ°å¼¹å‡ºå †é¡¶ï¼Œå¿…é¡»è¿è¢«åˆ é™¤å…ƒç´ ä¸€èµ·è°ƒæ•´è€Œä¸æ˜¯å°†åˆ é™¤å…ƒç´ ç®€ç®€å•å•çš„ fa å½’0å°±å¯ä»¥ã€‚</strong></em></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">heap</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> dis, l, r, fa, val;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">1e5</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\">heap tr[maxn &lt;&lt; <span class=\"number\">5</span>];</span><br><span class=\"line\"><span class=\"type\">int</span> n, m;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">getfather</span><span class=\"params\">(<span class=\"type\">int</span> x)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> tr[x].fa == x ? x : tr[x].fa = <span class=\"built_in\">getfather</span>(tr[x].fa);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">merge</span><span class=\"params\">(<span class=\"type\">int</span> x, <span class=\"type\">int</span> y)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!x || !y)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> x | y;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (tr[x].val &gt; tr[y].val)</span><br><span class=\"line\">        <span class=\"built_in\">swap</span>(x, y);</span><br><span class=\"line\">    tr[x].r = <span class=\"built_in\">merge</span>(tr[x].r, y);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (tr[tr[x].l].dis &lt; tr[tr[x].r].dis)</span><br><span class=\"line\">        <span class=\"built_in\">swap</span>(tr[x].l, tr[x].r);</span><br><span class=\"line\">    tr[x].dis = tr[tr[x].r].dis + <span class=\"number\">1</span>;</span><br><span class=\"line\">    tr[tr[x].l].fa = tr[tr[x].r].fa = tr[x].fa = x;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> x;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">pop</span><span class=\"params\">(<span class=\"type\">int</span> x)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    tr[x].val = <span class=\"number\">-1</span>;</span><br><span class=\"line\">    tr[tr[x].l].fa = tr[x].l;</span><br><span class=\"line\">    tr[tr[x].r].fa = tr[x].r;</span><br><span class=\"line\">    tr[x].fa = <span class=\"built_in\">merge</span>(tr[x].l, tr[x].r);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; ++i)</span><br><span class=\"line\">        tr[i].fa = i, cin &gt;&gt; tr[i].val;</span><br><span class=\"line\">    <span class=\"type\">int</span> t, x, y;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= m; ++i)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cin &gt;&gt; t &gt;&gt; x;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (t == <span class=\"number\">1</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            cin &gt;&gt; y;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (tr[x].val == <span class=\"number\">-1</span> || tr[y].val == <span class=\"number\">-1</span>)</span><br><span class=\"line\">                <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">            <span class=\"type\">int</span> l = <span class=\"built_in\">getfather</span>(x), r = <span class=\"built_in\">getfather</span>(y);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (l != r)</span><br><span class=\"line\">                tr[l].fa = tr[r].fa = <span class=\"built_in\">merge</span>(l, r);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (tr[x].val == <span class=\"number\">-1</span>)</span><br><span class=\"line\">                cout &lt;&lt; <span class=\"number\">-1</span> &lt;&lt; endl;</span><br><span class=\"line\">            <span class=\"keyword\">else</span></span><br><span class=\"line\">                cout &lt;&lt; tr[<span class=\"built_in\">getfather</span>(x)].val &lt;&lt; endl, <span class=\"built_in\">pop</span>(<span class=\"built_in\">getfather</span>(x));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"2-2-å¸¦æ‡’æ ‡è®°å·¦åæ ‘\">2.2 å¸¦æ‡’æ ‡è®°å·¦åæ ‘</h3>\n<p>åƒåŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘ä¸€æ ·ï¼Œåˆå¹¶æ—¶æ³¨æ„æ ‡è®°ä¸‹ä¼ é—®é¢˜</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">node</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> dis, val; <span class=\"type\">int</span> ch[<span class=\"number\">2</span>]; <span class=\"type\">int</span> fa; <span class=\"type\">int</span> lazyadd = <span class=\"number\">0</span>, lazymul = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> id; <span class=\"type\">int</span> cnt; <span class=\"type\">int</span> lazyc = <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> &amp;<span class=\"title\">rs</span><span class=\"params\">(<span class=\"type\">int</span> rt)</span> </span>&#123;<span class=\"keyword\">return</span> tree[rt].ch[tree[tree[rt].ch[<span class=\"number\">0</span>]].dis &gt; tree[tree[rt].ch[<span class=\"number\">1</span>]].dis];<span class=\"comment\">/*æ³¨æ„rså†™æ³•*/</span>&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> &amp;<span class=\"title\">ls</span><span class=\"params\">(<span class=\"type\">int</span> rt)</span> </span>&#123;<span class=\"keyword\">return</span> tree[rt].ch[<span class=\"number\">1</span> ^ (tree[tree[rt].ch[<span class=\"number\">0</span>]].dis &gt; tree[tree[rt].ch[<span class=\"number\">1</span>]].dis)];<span class=\"comment\">/*æ›´æ³¨æ„lså†™æ³•*/</span>&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> &amp;<span class=\"title\">dis</span><span class=\"params\">(<span class=\"type\">int</span> rt)</span> </span>&#123;<span class=\"keyword\">return</span> tree[rt].dis;&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> &amp;<span class=\"title\">val</span><span class=\"params\">(<span class=\"type\">int</span> rt)</span> </span>&#123;<span class=\"keyword\">return</span> tree[rt].val;&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> &amp;<span class=\"title\">fa</span><span class=\"params\">(<span class=\"type\">int</span> rt)</span> </span>&#123;<span class=\"keyword\">return</span> tree[rt].fa;&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> &amp;<span class=\"title\">lazyadd</span><span class=\"params\">(<span class=\"type\">int</span> rt)</span> </span>&#123;<span class=\"keyword\">return</span> tree[rt].lazyadd;&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> &amp;<span class=\"title\">lazymul</span><span class=\"params\">(<span class=\"type\">int</span> rt)</span> </span>&#123;<span class=\"keyword\">return</span> tree[rt].lazymul;&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> &amp;<span class=\"title\">lazyc</span><span class=\"params\">(<span class=\"type\">int</span> rt)</span> </span>&#123;<span class=\"keyword\">return</span> tree[rt].lazyc;&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> &amp;<span class=\"title\">vcnt</span><span class=\"params\">(<span class=\"type\">int</span> rt)</span> </span>&#123;<span class=\"keyword\">return</span> tree[rt].cnt;&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> &amp;<span class=\"title\">id</span><span class=\"params\">(<span class=\"type\">int</span> rt)</span> </span>&#123;<span class=\"keyword\">return</span> tree[rt].id;&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">pushdown</span><span class=\"params\">(<span class=\"type\">int</span> rt)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!rt)</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">lazyadd</span>(rt) != <span class=\"number\">0</span> || <span class=\"built_in\">lazymul</span>(rt) != <span class=\"number\">1</span> || <span class=\"built_in\">lazyc</span>(rt) != <span class=\"number\">0</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"built_in\">ls</span>(rt))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"built_in\">val</span>(<span class=\"built_in\">ls</span>(rt)) = <span class=\"built_in\">val</span>(<span class=\"built_in\">ls</span>(rt)) * <span class=\"built_in\">lazymul</span>(rt) + <span class=\"built_in\">lazyadd</span>(rt);</span><br><span class=\"line\">            <span class=\"built_in\">vcnt</span>(<span class=\"built_in\">ls</span>(rt)) += <span class=\"built_in\">lazyc</span>(rt);</span><br><span class=\"line\">            <span class=\"built_in\">lazymul</span>(<span class=\"built_in\">ls</span>(rt)) *= <span class=\"built_in\">lazymul</span>(rt);</span><br><span class=\"line\">            <span class=\"built_in\">lazyadd</span>(<span class=\"built_in\">ls</span>(rt)) = <span class=\"built_in\">lazyadd</span>(<span class=\"built_in\">ls</span>(rt)) * <span class=\"built_in\">lazymul</span>(rt) + <span class=\"built_in\">lazyadd</span>(rt);</span><br><span class=\"line\">            <span class=\"built_in\">lazyc</span>(<span class=\"built_in\">ls</span>(rt)) += <span class=\"built_in\">lazyc</span>(rt);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"built_in\">rs</span>(rt))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"built_in\">val</span>(<span class=\"built_in\">rs</span>(rt)) = <span class=\"built_in\">val</span>(<span class=\"built_in\">rs</span>(rt)) * <span class=\"built_in\">lazymul</span>(rt) + <span class=\"built_in\">lazyadd</span>(rt);</span><br><span class=\"line\">            <span class=\"built_in\">vcnt</span>(<span class=\"built_in\">rs</span>(rt)) += <span class=\"built_in\">lazyc</span>(rt);</span><br><span class=\"line\">            <span class=\"built_in\">lazymul</span>(<span class=\"built_in\">rs</span>(rt)) *= <span class=\"built_in\">lazymul</span>(rt);</span><br><span class=\"line\">            <span class=\"built_in\">lazyadd</span>(<span class=\"built_in\">rs</span>(rt)) = <span class=\"built_in\">lazyadd</span>(<span class=\"built_in\">rs</span>(rt)) * <span class=\"built_in\">lazymul</span>(rt) + <span class=\"built_in\">lazyadd</span>(rt);</span><br><span class=\"line\">            <span class=\"built_in\">lazyc</span>(<span class=\"built_in\">rs</span>(rt)) += <span class=\"built_in\">lazyc</span>(rt);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">lazyadd</span>(rt) = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"built_in\">lazymul</span>(rt) = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">lazyc</span>(rt) = <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">merge</span><span class=\"params\">(<span class=\"type\">int</span> rt1, <span class=\"type\">int</span> rt2)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!rt1 || !rt2)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> rt1 | rt2;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">val</span>(rt1) &gt; <span class=\"built_in\">val</span>(rt2))</span><br><span class=\"line\">        <span class=\"built_in\">swap</span>(rt1, rt2);</span><br><span class=\"line\">    <span class=\"built_in\">pushdown</span>(rt1);</span><br><span class=\"line\">    <span class=\"type\">int</span> &amp;r = <span class=\"built_in\">rs</span>(rt1);</span><br><span class=\"line\">    r = <span class=\"built_in\">merge</span>(r, rt2);</span><br><span class=\"line\">    <span class=\"built_in\">fa</span>(r) = rt1;</span><br><span class=\"line\">    <span class=\"built_in\">dis</span>(rt1) = <span class=\"built_in\">dis</span>(<span class=\"built_in\">rs</span>(rt1)) + <span class=\"number\">1</span>; <span class=\"comment\">// ä¸¥ç¦ä½¿ç”¨pushupäºæ­¤ï¼Œpushupåªç”¨äºåˆ é™¤ä»»æ„éæ ¹èŠ‚ç‚¹æ—¶ä½¿ç”¨ï¼Œåˆ é™¤æ ¹èŠ‚ç‚¹è¦pop</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> rt1;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">pop</span><span class=\"params\">(<span class=\"type\">int</span> rt1)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">pushdown</span>(rt1);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">merge</span>(<span class=\"built_in\">ls</span>(rt1), <span class=\"built_in\">rs</span>(rt1));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"type\">int</span> tot = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">push</span><span class=\"params\">(<span class=\"type\">int</span> rt1, <span class=\"type\">int</span> val, <span class=\"type\">int</span> id)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    tree[++tot].val = val;</span><br><span class=\"line\">    tree[tot].id = id;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">merge</span>(rt1, tot);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"2-3-æ”¯æŒåˆ é™¤ä»»æ„èŠ‚ç‚¹å¯å¹¶å †\">*2.3 æ”¯æŒåˆ é™¤ä»»æ„èŠ‚ç‚¹å¯å¹¶å †</h3>\n<p>æ²¡æœ‰ä¸“é—¨çš„é¢˜ï¼Œæœ‰æ¶‰åŠåˆ°å¯å¹¶å †åˆ å¯¹åº”èŠ‚ç‚¹çš„ç†è®ºä¸Šä¸»å¸­æ ‘éƒ½å¯ä»¥åšï¼Œè€Œä¸”å¤æ‚åº¦æ˜¯ä¸€æ ·çš„ï¼Œä¼˜å…ˆå†™è‡ªå·±é¡ºæ‰‹çš„ã€‚</p>\n<p>è¿™é‡Œæ˜¯OI-wikiçš„</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">erase</span><span class=\"params\">(<span class=\"type\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"type\">int</span> y = <span class=\"built_in\">merge</span>(<span class=\"built_in\">ls</span>(x), <span class=\"built_in\">rs</span>(x));</span><br><span class=\"line\">  <span class=\"built_in\">fa</span>(y) = <span class=\"built_in\">fa</span>(x);</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"built_in\">ls</span>(<span class=\"built_in\">fa</span>(x)) == x)</span><br><span class=\"line\">    <span class=\"built_in\">ls</span>(<span class=\"built_in\">fa</span>(x)) = y;</span><br><span class=\"line\">  <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"built_in\">rs</span>(<span class=\"built_in\">fa</span>(x)) == x)</span><br><span class=\"line\">    <span class=\"built_in\">rs</span>(<span class=\"built_in\">fa</span>(x)) = y;</span><br><span class=\"line\">  <span class=\"built_in\">pushup</span>(<span class=\"built_in\">fa</span>(y));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-4-GNU-GCC-pb-dsåº“\">*2.4 GNU/GCC pb_dsåº“</h3>\n<p><code>pb_ds</code>åº“æä¾›äº†äº”ç§å¯å¹¶å †ï¼Œé»˜è®¤å¤§æ ¹å †ï¼Œ<code>greater</code>æ ‡ç­¾ä½¿ç”¨å’Œæ™®é€š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mi>T</mi><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">STL</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">ST</span><span class=\"mord mathnormal\">L</span></span></span></span>ä¸€è‡´ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;ext/pb_ds/priority_queue.hpp&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> __gnu_pbds;</span><br><span class=\"line\">__gnu_pbds::priority_queue&lt;<span class=\"type\">int</span>&gt;q;<span class=\"comment\">//å› ä¸ºæ”¾ç½®å’Œstdé‡å¤ï¼Œæ•…éœ€è¦å¸¦ä¸Šå‘½åç©ºé—´</span></span><br><span class=\"line\">__gnu_pbds::priority_queue&lt;<span class=\"type\">int</span>,greater&lt;<span class=\"type\">int</span>&gt;,pairing_heap_tag&gt; q;<span class=\"comment\">//æœ€å¿«</span></span><br><span class=\"line\">__gnu_pbds::priority_queue&lt;<span class=\"type\">int</span>,greater&lt;<span class=\"type\">int</span>&gt;,binary_heap_tag&gt; q;</span><br><span class=\"line\">__gnu_pbds::priority_queue&lt;<span class=\"type\">int</span>,greater&lt;<span class=\"type\">int</span>&gt;,binomial_heap_tag&gt; q;</span><br><span class=\"line\">__gnu_pbds::priority_queue&lt;<span class=\"type\">int</span>,greater&lt;<span class=\"type\">int</span>&gt;,rc_binomial_heap_tag&gt; q;</span><br><span class=\"line\">__gnu_pbds::priority_queue&lt;<span class=\"type\">int</span>,greater&lt;<span class=\"type\">int</span>&gt;,thin_heap_tag&gt; q;</span><br><span class=\"line\">__gnu_pbds::priority_queue&lt;<span class=\"type\">int</span>,greater&lt;<span class=\"type\">int</span>&gt; &gt; q;</span><br></pre></td></tr></table></figure>\n<p><code>pairing_heap_tag</code> : <code>push</code>å’Œ<code>join</code>ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>,å…¶ä½™ä¸ºå‡æ‘Š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(logn)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>ã€‚</p>\n<p><code>binary_heap_tag</code>:åªæ”¯æŒ<code>push</code>å’Œ<code>pop</code>,å‡ä¸ºå‡æ‘Š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(logn)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>ã€‚</p>\n<p><code>binomial_heap_tag</code>:<code>push</code>ä¸ºå‡æ‘Š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>,å…¶ä½™ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(logn)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>ã€‚</p>\n<p><code>rc_binomial_heap_tag</code>: <code>push</code>ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>,å…¶ä½™ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(logn)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>ã€‚</p>\n<p><code>thin_heap_tag</code>: <code>push</code>ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>,ä¸æ”¯æŒ<code>join</code>,å…¶ä½™ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(logn)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>;ä½†æ˜¯å¦‚æœåªæœ‰<code>increase_key</code>,é‚£ä¹ˆ<code>modify</code>ä¸ºå‡æ‘Š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>â€‹ã€‚â€œä¸æ”¯æŒâ€ä¸æ˜¯ä¸èƒ½ç”¨,è€Œæ˜¯ç”¨èµ·æ¥å¾ˆæ…¢</p>\n<p>æ“ä½œè¡¨ï¼š</p>\n<ul>\n<li>\n<p><code>size()</code>ç”¨æ³•åŒstd</p>\n</li>\n<li>\n<p><code>empty()</code>ç”¨æ³•åŒstd</p>\n</li>\n<li>\n<p><code>push(const_reference r_val)</code>æ³¨æ„<code>push</code>è¿”å›<code>point_iterator</code>ï¼Œè¢«<code>push</code>å…ƒç´ å…¥å †åä½ç½®</p>\n</li>\n<li>\n<p><code>top()</code>æ²¡åŒºåˆ«â€¦</p>\n</li>\n<li>\n<p><code>pop()</code>å¼¹å‡ºå †é¡¶</p>\n</li>\n<li>\n<p><code>point_iterator</code>å¯¹åº”æŸå…ƒç´ çš„è¿­ä»£å™¨</p>\n</li>\n<li>\n<p><code>erase(point_iterator it)</code>åˆ é™¤å¯¹åº”ç‚¹</p>\n</li>\n<li>\n<p><code>modify(point_iterator it,const_reference r_new_val)</code>ä¿®æ”¹å¯¹åº”ç‚¹çš„å€¼</p>\n<p>è¿™æ˜¯ä¼˜åŒ–<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>i</mi><mi>j</mi><mi>k</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">dijkstra</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">ijk</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">a</span></span></span></span>ç¥æ–¹æ³•,å‡æ‘Šå¤æ‚åº¦<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>â€‹</p>\n<p>ä¼˜åŒ–<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>i</mi><mi>j</mi><mi>k</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">dijkstra</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">ijk</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">a</span></span></span></span>çš„æ€è·¯å°±æ˜¯åœ¨å‰é¢æåˆ°çš„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mi>t</mi><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">std</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">d</span></span></span></span>ä¼˜å…ˆé˜Ÿåˆ—ä¼˜åŒ–çš„åŸºç¡€ä¸Š,ç»´æŠ¤ä¸€ä¸ª<code>point_iterator</code>æ•°ç»„,<code>push</code>çš„æ—¶å€™å­˜ä¸‹<code>push</code>æ—¶è¿”å›çš„è¿­ä»£å™¨,æ›´æ–°<code>dis</code>æ˜¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ­¤è¿­ä»£å™¨,è‹¥å­˜åœ¨<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span><code>modify</code>,ä¸å­˜åœ¨å‡æ‘Š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span><code>push</code></p>\n</li>\n<li>\n<p><code>clear()</code>åŸºæœ¬æ²¡ä»€ä¹ˆç”¨,è¿˜ä¸å¦‚é‡æ–°å®šä¹‰ä¸€ä¸ªâ€¦</p>\n</li>\n<li>\n<p><code>join(priority_queue &amp;other)</code>å¯å¹¶å †å•Š,è¿˜æ˜¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>çš„,æ³¨æ„åˆå¹¶å<code>other</code>ä¼šè¢«æ¸…ç©º</p>\n</li>\n<li>\n<p>å…¶ä»–è¿­ä»£å™¨åŒstd</p>\n</li>\n</ul>\n<p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;ext/pb_ds/priority_queue.hpp&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> int long long</span></span><br><span class=\"line\"><span class=\"keyword\">using</span> mergeable_priority_queue = __gnu_pbds::priority_queue&lt;<span class=\"type\">int</span>, less&lt;<span class=\"type\">int</span>&gt;, __gnu_pbds::pairing_heap_tag&gt;;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">2e5</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> ans = <span class=\"number\">0</span>;</span><br><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt; connects[maxn];</span><br><span class=\"line\">mergeable_priority_queue qs[maxn];</span><br><span class=\"line\"><span class=\"type\">int</span> sum[maxn];</span><br><span class=\"line\"><span class=\"type\">int</span> L[maxn];</span><br><span class=\"line\"><span class=\"type\">int</span> n, m;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"type\">int</span> u, <span class=\"type\">int</span> fa)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> v : connects[u])</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (v == fa)</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        <span class=\"built_in\">dfs</span>(v, u);</span><br><span class=\"line\">        qs[u].<span class=\"built_in\">join</span>(qs[v]);</span><br><span class=\"line\">        sum[u] += sum[v];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (!qs[u].<span class=\"built_in\">empty</span>() &amp;&amp; sum[u] &gt; m)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        sum[u] -= qs[u].<span class=\"built_in\">top</span>();</span><br><span class=\"line\">        qs[u].<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ans = <span class=\"built_in\">max</span>(ans, (<span class=\"type\">int</span>)(qs[u].<span class=\"built_in\">size</span>()) * L[u]);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> fa, c, l;</span><br><span class=\"line\">        cin &gt;&gt; fa &gt;&gt; c &gt;&gt; l;</span><br><span class=\"line\">        qs[i].<span class=\"built_in\">push</span>(c);</span><br><span class=\"line\">        sum[i] += c, L[i] = l;</span><br><span class=\"line\">        connects[fa].<span class=\"built_in\">push_back</span>(i);</span><br><span class=\"line\">        connects[i].<span class=\"built_in\">push_back</span>(fa);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">dfs</span>(<span class=\"number\">0</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h2 id=\"3-STè¡¨ï¼ˆSparse-Tableï¼‰\">3.STè¡¨ï¼ˆSparse Tableï¼‰</h2>\n<p>å…³é”®è¯ï¼šé™æ€åŒºé—´ï¼Œå¯é‡å¤è´¡çŒ®</p>\n<p>ç¨€ç–è¡¨ï¼Œå€å¢ï¼Œå¯ä»¥è§£å†³å¯é‡å¤è´¡çŒ®é—®é¢˜ï¼š</p>\n<p>ä»£æ•°ç³»ç»Ÿ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>&lt;</mo><mi>S</mi><mo separator=\"true\">,</mo><mo>â‹…</mo><mo>&gt;</mo></mrow><annotation encoding=\"application/x-tex\">&lt;S,\\cdot &gt;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span></span></span></span>æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p>\n<ol>\n<li>è¯¥ä»£æ•°ç³»ç»Ÿä¸ºåŠç¾¤ã€‚</li>\n<li>å¯¹äº<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">âˆ€</mi><mi>x</mi><mo>âˆˆ</mo><mi>S</mi><mo separator=\"true\">,</mo><mi>x</mi><mo>â‹…</mo><mi>x</mi><mo>=</mo><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">\\forall x\\in S,x\\cdot x=x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.0391em;\"></span><span class=\"mord\">âˆ€</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>â€‹ï¼ˆå¯é‡å¤è´¡çŒ®ï¼‰</li>\n</ol>\n<p>é™¤ RMQ ä»¥å¤–ï¼Œè¿˜æœ‰å…¶å®ƒçš„ã€Œå¯é‡å¤è´¡çŒ®é—®é¢˜ã€ã€‚ä¾‹å¦‚ã€ŒåŒºé—´æŒ‰ä½ä¸ã€ã€ã€ŒåŒºé—´æŒ‰ä½æˆ–ã€ã€ã€ŒåŒºé—´ GCDã€ï¼ŒST è¡¨éƒ½èƒ½é«˜æ•ˆåœ°è§£å†³ã€‚</p>\n<p>å¦‚æœç¢°åˆ°æ¶å¿ƒçš„å¡å†…å­˜çš„ï¼Œè€ƒè™‘STè¡¨å­˜å¯¹åº”ç­”æ¡ˆåœ¨åŸæ•°ç»„çš„ä¸‹æ ‡ï¼ŒèŠ‚çœç©ºé—´ã€‚</p>\n<h3 id=\"3-1-é™æ€åŒºé—´æœ€å€¼ï¼Œä¸€ç»´STè¡¨\">3.1 é™æ€åŒºé—´æœ€å€¼ï¼Œä¸€ç»´STè¡¨</h3>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// STè¡¨ï¼Œé™æ€åŒºé—´æœ€å¤§å€¼</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">getlog</span><span class=\"params\">(<span class=\"type\">int</span> n)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> ans = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (n)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        n &gt;&gt;= <span class=\"number\">1</span>;</span><br><span class=\"line\">        ans++;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ans - <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">5e5</span> + <span class=\"number\">10</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> st[maxn][<span class=\"number\">20</span>];</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> endl <span class=\"string\">&#x27;\\n&#x27;</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"literal\">false</span>);</span><br><span class=\"line\">    cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"type\">int</span> n;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"type\">int</span> q;</span><br><span class=\"line\">    cin &gt;&gt; q;</span><br><span class=\"line\">    <span class=\"type\">int</span> logn = <span class=\"built_in\">getlog</span>(n);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cin &gt;&gt; st[i][<span class=\"number\">0</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">1</span>; j &lt;= logn; j++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i + (<span class=\"number\">1</span> &lt;&lt; j) - <span class=\"number\">1</span> &lt;= n; i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            st[i][j] = <span class=\"built_in\">max</span>(st[i][j - <span class=\"number\">1</span>], st[i + (<span class=\"number\">1</span> &lt;&lt; (j - <span class=\"number\">1</span>))][j - <span class=\"number\">1</span>]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (q--)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> l, r;</span><br><span class=\"line\">        cin &gt;&gt; l &gt;&gt; r;</span><br><span class=\"line\">        <span class=\"type\">int</span> dis = r - l + <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> k = <span class=\"built_in\">getlog</span>(dis);</span><br><span class=\"line\">        cout &lt;&lt; <span class=\"built_in\">max</span>(st[l][k], st[r - (<span class=\"number\">1</span> &lt;&lt; k) + <span class=\"number\">1</span>][k]) &lt;&lt; endl;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"3-2-é™æ€åŒºé—´æœ€å€¼ï¼ŒäºŒç»´STè¡¨\">3.2 é™æ€åŒºé—´æœ€å€¼ï¼ŒäºŒç»´STè¡¨</h3>\n<p>ç±»æ¯”ä¸€ç»´<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">ST</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">ST</span></span></span></span> è¡¨ï¼Œæˆ‘ä»¬å®šä¹‰æ•°ç»„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mi>t</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><mi>j</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><mi>k</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><mi>p</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">st[i][j][k][p]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">]</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose\">]</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">p</span><span class=\"mclose\">]</span></span></span></span>è¡¨ç¤ºä»<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(i,j)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">i</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">)</span></span></span></span>å¾€ä¸‹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mi>k</mi></msup></mrow><annotation encoding=\"application/x-tex\">2^k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span></span></span></span>ä¸ªå…ƒç´ ï¼Œå¾€å³<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mi>p</mi></msup></mrow><annotation encoding=\"application/x-tex\">2^p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span></span></span></span></span></span></span></span>ä¸ªå…ƒç´ çš„æœ€å€¼ã€‚</p>\n<p>å»ºè¡¨çš„è¯ï¼ŒåŒæ ·ç±»æ¯”ä¸€ç»´<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">ST</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">ST</span></span></span></span>è¡¨ï¼Œå¤–å±‚ä¸¤ä¸ªå¾ªç¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> å’Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span></span></span></span> , ç„¶åå†…å±‚å–æœ€å€¼å°±è¡Œäº†ã€‚è¦æ³¨æ„çš„æ˜¯ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> å’Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span></span></span></span>è¦ä»<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>â€‹å¼€å§‹å¾ªç¯ï¼Œå› ä¸ºä¸€è¡Œæˆ–è€…ä¸€åˆ—çš„æƒ…å†µä¹Ÿè¦ç»´æŠ¤ã€‚</p>\n<p>å¤æ‚åº¦<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mn>2</mn></msup><mi>l</mi><mi>o</mi><msup><mi>g</mi><mn>2</mn></msup><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n^2log^2n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">build_st</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">9</span>; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt; <span class=\"number\">9</span>; j++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (i == <span class=\"number\">0</span> &amp;&amp; j == <span class=\"number\">0</span>)</span><br><span class=\"line\">                <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> k = <span class=\"number\">1</span>; k &lt;= n - (<span class=\"number\">1</span> &lt;&lt; i) + <span class=\"number\">1</span>; k++)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">for</span> (<span class=\"type\">int</span> p = <span class=\"number\">1</span>; p &lt;= n - (<span class=\"number\">1</span> &lt;&lt; j) + <span class=\"number\">1</span>; p++)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (i == <span class=\"number\">0</span>)</span><br><span class=\"line\">                        st[k][p][i][j] = <span class=\"built_in\">min</span>(st[k][p][i][j - <span class=\"number\">1</span>], st[k][p + (<span class=\"number\">1</span> &lt;&lt; j - <span class=\"number\">1</span>)][i][j - <span class=\"number\">1</span>]);</span><br><span class=\"line\">                    <span class=\"keyword\">else</span></span><br><span class=\"line\">                        st[k][p][i][j] = <span class=\"built_in\">min</span>(st[k][p][i - <span class=\"number\">1</span>][j], st[k + (<span class=\"number\">1</span> &lt;&lt; i - <span class=\"number\">1</span>)][p][i - <span class=\"number\">1</span>][j]);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">query</span><span class=\"params\">(<span class=\"type\">int</span> r1, <span class=\"type\">int</span> c1, <span class=\"type\">int</span> r2, <span class=\"type\">int</span> c2)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> k1 = <span class=\"built_in\">log2</span>(r2 - r1 + <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"type\">int</span> k2 = <span class=\"built_in\">log2</span>(c2 - c1 + <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">min</span>(st[r1][c1][k1][k2], <span class=\"built_in\">min</span>(st[r2 - (<span class=\"number\">1</span> &lt;&lt; k1) + <span class=\"number\">1</span>][c1][k1][k2], <span class=\"built_in\">min</span>(st[r1][c2 - (<span class=\"number\">1</span> &lt;&lt; k2) + <span class=\"number\">1</span>][k1][k2], st[r2 - (<span class=\"number\">1</span> &lt;&lt; k1) + <span class=\"number\">1</span>][c2 - (<span class=\"number\">1</span> &lt;&lt; k2) + <span class=\"number\">1</span>][k1][k2])));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"3-3-å€å¢STè¡¨æ±‚è§£LCAé—®é¢˜\">3.3 å€å¢STè¡¨æ±‚è§£LCAé—®é¢˜</h3>\n<p>å€å¢ä¼˜åŒ–æ±‚<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mi>C</mi><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">LCA</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord mathnormal\">A</span></span></span></span>ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>f</mi><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">dfs</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">df</span><span class=\"mord mathnormal\">s</span></span></span></span>é¢„å¤„ç†ç¥–å…ˆä¿¡æ¯ï¼Œç„¶åæŸ¥è¯¢æ—¶å…ˆè·³åˆ°åŒä¸€é«˜åº¦ï¼Œå†ä¸€èµ·æš´åŠ›å‘ä¸Šè·³ã€‚æš´åŠ›å‘ä¸Šè·³å¿…é¡»ä»å¤§å‘å°æšä¸¾ã€‚é¢„å¤„ç†<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(nlogn)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>ï¼Œå•æ¬¡æŸ¥è¯¢<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>.</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">1e6</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt; connects[maxn];</span><br><span class=\"line\"><span class=\"type\">int</span> fa[maxn][<span class=\"number\">21</span>];</span><br><span class=\"line\"><span class=\"type\">int</span> dep[maxn];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"type\">int</span> u, <span class=\"type\">int</span> fas)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    dep[u] = dep[fas] + <span class=\"number\">1</span>;</span><br><span class=\"line\">    fa[u][<span class=\"number\">0</span>] = fas;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">1</span>; j &lt;= <span class=\"number\">20</span>; j++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        fa[u][j] = fa[fa[u][j - <span class=\"number\">1</span>]][j - <span class=\"number\">1</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> v : connects[u])</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (v == fas)</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        <span class=\"built_in\">dfs</span>(v, u);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">int</span> <span class=\"title\">lca</span><span class=\"params\">(<span class=\"type\">int</span> u, <span class=\"type\">int</span> v)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (dep[u] &lt; dep[v])</span><br><span class=\"line\">        <span class=\"built_in\">swap</span>(u, v);</span><br><span class=\"line\">    <span class=\"type\">int</span> tmp = dep[u] - dep[v];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt;= <span class=\"number\">20</span>; j++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> ((tmp &gt;&gt; j) &amp; <span class=\"number\">1</span>)</span><br><span class=\"line\">            u = fa[u][j];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (u == v)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> u;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">20</span>; j &gt;= <span class=\"number\">0</span>; j--)</span><br><span class=\"line\">    &#123;\t\t</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (fa[u][j] != fa[v][j])</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            u = fa[u][j], v = fa[v][j];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> fa[u][<span class=\"number\">0</span>];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n, m, rt;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; rt;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt; n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> u, v;</span><br><span class=\"line\">        cin &gt;&gt; u &gt;&gt; v;</span><br><span class=\"line\">        connects[u].<span class=\"built_in\">push_back</span>(v);</span><br><span class=\"line\">        connects[v].<span class=\"built_in\">push_back</span>(u);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">dfs</span>(rt, rt);</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (m--)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> u, v;</span><br><span class=\"line\">        cin &gt;&gt; u &gt;&gt; v;</span><br><span class=\"line\">        cout &lt;&lt; <span class=\"built_in\">lca</span>(u, v) &lt;&lt; endl;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"3-4-æ¬§æ‹‰åºSTè¡¨æ±‚LCAé—®é¢˜\">3.4 æ¬§æ‹‰åºSTè¡¨æ±‚LCAé—®é¢˜</h3>\n<p>é—®é¢˜è½¬åŒ–æˆ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>f</mi><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">dfs</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">df</span><span class=\"mord mathnormal\">s</span></span></span></span>éå†è·¯å¾„è®°å½•ä¸‹ç»“ç‚¹çš„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>f</mi><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">dfn</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">df</span><span class=\"mord mathnormal\">n</span></span></span></span>åºå·ä¸Š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi><mi>M</mi><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">RMQ</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">RMQ</span></span></span></span>é—®é¢˜ï¼Œä¸¤ä¸ªèŠ‚ç‚¹çš„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mi>c</mi><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">lca</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">a</span></span></span></span>ä¸€å®šæ˜¯æ¬§æ‹‰åºéå†ä¸‹åºå·åŒºé—´å†…æ·±åº¦æœ€æµ…çš„ç»“ç‚¹ã€‚å¯ä»¥åšåˆ°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(nlogn)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>é¢„å¤„ç†ï¼Œå•æ¬¡è¯¢é—®<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>.</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">2e6</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt; connects[maxn];</span><br><span class=\"line\"><span class=\"type\">int</span> st[maxn &lt;&lt; <span class=\"number\">1</span>][<span class=\"number\">25</span>];</span><br><span class=\"line\"><span class=\"type\">int</span> dep[maxn];</span><br><span class=\"line\"><span class=\"type\">int</span> pos[maxn];</span><br><span class=\"line\"><span class=\"type\">int</span> logs[maxn &lt;&lt; <span class=\"number\">1</span>];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">add_edge</span><span class=\"params\">(<span class=\"type\">int</span> u, <span class=\"type\">int</span> v)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    connects[u].<span class=\"built_in\">push_back</span>(v);</span><br><span class=\"line\">    connects[v].<span class=\"built_in\">push_back</span>(u);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"type\">int</span> cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">dfs1</span><span class=\"params\">(<span class=\"type\">int</span> u, <span class=\"type\">int</span> fa)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    st[++cnt][<span class=\"number\">0</span>] = u;</span><br><span class=\"line\">    dep[u] = dep[fa] + <span class=\"number\">1</span>;</span><br><span class=\"line\">    pos[u] = cnt;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> v : connects[u])</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (v == fa)</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        <span class=\"built_in\">dfs1</span>(v, u);</span><br><span class=\"line\">        st[++cnt][<span class=\"number\">0</span>] = u;<span class=\"comment\">//æ¬§æ‹‰åºè®°å½•</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">build_st</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">1</span>; j &lt; <span class=\"number\">25</span>; j++)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i + (<span class=\"number\">1</span> &lt;&lt; j) - <span class=\"number\">1</span> &lt;= cnt; i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> l = st[i][j - <span class=\"number\">1</span>], r = st[i + (<span class=\"number\">1</span> &lt;&lt; (j - <span class=\"number\">1</span>))][j - <span class=\"number\">1</span>];<span class=\"comment\">//stç»´æŠ¤ç»“ç‚¹åºå·</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (dep[l] &lt; dep[r])</span><br><span class=\"line\">                st[i][j] = l;</span><br><span class=\"line\">            <span class=\"keyword\">else</span></span><br><span class=\"line\">                st[i][j] = r;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    logs[<span class=\"number\">1</span>] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">2</span>; i &lt;= cnt; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        logs[i] = logs[i / <span class=\"number\">2</span>] + <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">lcas</span><span class=\"params\">(<span class=\"type\">int</span> u, <span class=\"type\">int</span> v)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> l = pos[u], r = pos[v];</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l &gt; r)</span><br><span class=\"line\">        <span class=\"built_in\">swap</span>(l, r);</span><br><span class=\"line\">    <span class=\"type\">int</span> k = logs[r - l + <span class=\"number\">1</span>];</span><br><span class=\"line\">    <span class=\"type\">int</span> ansl = st[l][k];</span><br><span class=\"line\">    <span class=\"type\">int</span> ansr = st[r - (<span class=\"number\">1</span> &lt;&lt; k) + <span class=\"number\">1</span>][k];</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (dep[ansl] &lt; dep[ansr])</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ansl;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> ansr;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n, m, rt;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; rt;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt; n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> u, v;</span><br><span class=\"line\">        cin &gt;&gt; u &gt;&gt; v;</span><br><span class=\"line\">        <span class=\"built_in\">add_edge</span>(u, v);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">dfs1</span>(rt, rt);</span><br><span class=\"line\">    <span class=\"built_in\">build_st</span>();</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (m--)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> u, v;</span><br><span class=\"line\">        cin &gt;&gt; u &gt;&gt; v;</span><br><span class=\"line\">        cout &lt;&lt; <span class=\"built_in\">lcas</span>(u, v) &lt;&lt; endl;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h2 id=\"4-å¹¶æŸ¥é›†-Disjoint-Sets\">4.å¹¶æŸ¥é›†(Disjoint Sets)</h2>\n<p>å…³é”®è¯ï¼šåŒå±æ€§åˆ†ç±»</p>\n<h3 id=\"4-1-å¸¦æƒå¹¶æŸ¥é›†\">4.1 å¸¦æƒå¹¶æŸ¥é›†</h3>\n<p>ç»´æŠ¤è·¯å¾„æƒå€¼ä¿¡æ¯ï¼Œå¸¸è§ç”¨è·¯å¾„å‹ç¼©å‡æ‘Šå¤æ‚åº¦ã€‚mergeæ—¶æä¸æ¸…å°±ç”»å‘é‡å›¾è¡¨ç¤ºï¼Œä¸€ä¸‹å°±æ‡‚ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">getfather</span><span class=\"params\">(<span class=\"type\">int</span> x)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> fa = father[x];</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (x != father[x])</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        father[x] = <span class=\"built_in\">getfather</span>(father[x]);</span><br><span class=\"line\">        val[x] += val[fa];</span><br><span class=\"line\">        <span class=\"keyword\">return</span> father[x];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> x;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">merge</span><span class=\"params\">(<span class=\"type\">int</span> x, <span class=\"type\">int</span> y, <span class=\"type\">int</span> value)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> fx = <span class=\"built_in\">getfather</span>(x);</span><br><span class=\"line\">    <span class=\"type\">int</span> fy = <span class=\"built_in\">getfather</span>(y);</span><br><span class=\"line\">    father[fx] = fy;</span><br><span class=\"line\">    val[fx] = value + val[y] - val[x];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"4-2-ç§ç±»å¹¶æŸ¥é›†\">4.2 ç§ç±»å¹¶æŸ¥é›†</h3>\n<p>ä¸€ä¸ªç‚¹æ‹†æˆå¤šä¸ªç‚¹ç»´æŠ¤å¯¹ç«‹çŸ›ç›¾ç­‰ä¿¡æ¯ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;iostream&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;cstdlib&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">1e6</span> + <span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> father[maxn];</span><br><span class=\"line\"><span class=\"type\">int</span> ran[maxn];</span><br><span class=\"line\"><span class=\"type\">int</span> n;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">getfather</span><span class=\"params\">(<span class=\"type\">int</span> x)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (x == father[x])</span><br><span class=\"line\">        <span class=\"keyword\">return</span> x;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> father[x] = <span class=\"built_in\">getfather</span>(father[x]);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">merge</span><span class=\"params\">(<span class=\"type\">int</span> x, <span class=\"type\">int</span> y)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> fx = <span class=\"built_in\">getfather</span>(x);</span><br><span class=\"line\">    <span class=\"type\">int</span> fy = <span class=\"built_in\">getfather</span>(y);</span><br><span class=\"line\">    father[fx]=fy;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">eat</span><span class=\"params\">(<span class=\"type\">int</span> x, <span class=\"type\">int</span> y)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">merge</span>(x, n + y);</span><br><span class=\"line\">    <span class=\"built_in\">merge</span>(n + x, <span class=\"number\">2</span> * n + y);</span><br><span class=\"line\">    <span class=\"built_in\">merge</span>(<span class=\"number\">2</span> * n + x, y);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">same</span><span class=\"params\">(<span class=\"type\">int</span> x, <span class=\"type\">int</span> y)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">merge</span>(x, y);</span><br><span class=\"line\">    <span class=\"built_in\">merge</span>(n + x, n + y);</span><br><span class=\"line\">    <span class=\"built_in\">merge</span>(<span class=\"number\">2</span> * n + x, <span class=\"number\">2</span> * n + y);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">bool</span> <span class=\"title\">checkeat</span><span class=\"params\">(<span class=\"type\">int</span> x, <span class=\"type\">int</span> y)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">getfather</span>(x) == <span class=\"built_in\">getfather</span>(y + n) || <span class=\"built_in\">getfather</span>(x) == <span class=\"built_in\">getfather</span>(y + <span class=\"number\">2</span> * n); <span class=\"comment\">// æŸ¥è¯¢æ•é£Ÿå’Œè¢«æ•é£Ÿå…³ç³»</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">bool</span> <span class=\"title\">checksame</span><span class=\"params\">(<span class=\"type\">int</span> x, <span class=\"type\">int</span> y)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (<span class=\"built_in\">getfather</span>(x) == <span class=\"built_in\">getfather</span>(y)) || x == y;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">init</span><span class=\"params\">(<span class=\"type\">int</span> n)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= <span class=\"number\">3</span> * n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        father[i] = i;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"4-3-å¯æŒä¹…åŒ–å¹¶æŸ¥é›†\">4.3 å¯æŒä¹…åŒ–å¹¶æŸ¥é›†</h3>\n<p>è§1.14</p>\n<div style=\"page-break-after: always;\"></div>\n<h2 id=\"5-æ ‘çŠ¶æ•°ç»„-Fenwick-Trees\">5.æ ‘çŠ¶æ•°ç»„(Fenwick Trees)</h2>\n<p>å…³é”®è¯ï¼šäºŒè¿›åˆ¶æšä¸¾ï¼Œå‰ç¼€å’Œ</p>\n<p>æ ‘çŠ¶æ•°ç»„ç»´æŠ¤ç±»ä¼¼å‰ç¼€å’Œçš„ä¸œè¥¿ã€‚æ ¸å¿ƒæ“ä½œä¸ºlowbitã€‚</p>\n<h3 id=\"5-1-äºŒç»´æ ‘çŠ¶æ•°ç»„ï¼ˆæ¨¡æ¿ï¼Œå­çŸ©å½¢æ‰€æœ‰å…ƒç´ å’Œï¼‰\">5.1 äºŒç»´æ ‘çŠ¶æ•°ç»„ï¼ˆæ¨¡æ¿ï¼Œå­çŸ©å½¢æ‰€æœ‰å…ƒç´ å’Œï¼‰</h3>\n<p>ä¸€ç»´çš„æ ‘çŠ¶æ•°ç»„éƒ½ä¼šå†™ã€‚ä¸‹é¢çš„æ˜¯äºŒç»´çš„ã€‚ç»´æŠ¤çŸ©å½¢å‰ç¼€å’Œ</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// é«˜ä½æ ‘çŠ¶æ•°ç»„ï¼Œæ²¡å•¥å¤§åŒºåˆ«ï¼Œå¼€å¤šä¸ª</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> i64 int</span></span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">Fenwick</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"keyword\">private</span>:</span><br><span class=\"line\">    <span class=\"type\">int</span> n, m;</span><br><span class=\"line\">    vector&lt;vector&lt;i64&gt;&gt; c;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">lowbit</span><span class=\"params\">(<span class=\"type\">int</span> x)</span> </span>&#123; <span class=\"keyword\">return</span> x &amp; -x; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"built_in\">Fenwick</span>(<span class=\"type\">int</span> n, <span class=\"type\">int</span> m) : <span class=\"built_in\">n</span>(n), <span class=\"built_in\">m</span>(m), <span class=\"built_in\">c</span>(n + <span class=\"number\">1</span>, <span class=\"built_in\">vector</span>&lt;i64&gt;(m + <span class=\"number\">1</span>, <span class=\"number\">0</span>)) &#123;&#125;</span><br><span class=\"line\">    <span class=\"built_in\">Fenwick</span>() : <span class=\"built_in\">n</span>(<span class=\"number\">0</span>), <span class=\"built_in\">m</span>(<span class=\"number\">0</span>) &#123;&#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">init</span><span class=\"params\">(<span class=\"type\">int</span> n, <span class=\"type\">int</span> m)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>-&gt;n = n;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>-&gt;m = m;</span><br><span class=\"line\">        c.<span class=\"built_in\">assign</span>(n + <span class=\"number\">1</span>, <span class=\"built_in\">vector</span>&lt;i64&gt;(m + <span class=\"number\">1</span>, <span class=\"number\">0</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"type\">int</span> x, <span class=\"type\">int</span> y, i64 v)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = x; i &lt;= n; i += <span class=\"built_in\">lowbit</span>(i))</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = y; j &lt;= m; j += <span class=\"built_in\">lowbit</span>(j))</span><br><span class=\"line\">                c[i][j] += v;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">i64 <span class=\"title\">query</span><span class=\"params\">(<span class=\"type\">int</span> x, <span class=\"type\">int</span> y)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        i64 res = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = x; i; i -= <span class=\"built_in\">lowbit</span>(i))</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = y; j; j -= <span class=\"built_in\">lowbit</span>(j))</span><br><span class=\"line\">                res += c[i][j];</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"5-2-ç¦»çº¿äºŒç»´æ•°ç‚¹\">5.2 ç¦»çº¿äºŒç»´æ•°ç‚¹</h3>\n<p>æ±‚<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[l,r]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">]</span></span></span></span>å†…å°äºç­‰äº<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>çš„ç‚¹æœ‰å¤šå°‘ä¸ªã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// ç¦»çº¿äºŒç»´æ•°ç‚¹ï¼Œæ‰«æçº¿ç¦»çº¿ç‰ˆæœ¬</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> i64 int</span></span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">Fenwick</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"keyword\">private</span>:</span><br><span class=\"line\">    <span class=\"type\">int</span> _n;</span><br><span class=\"line\">    vector&lt;i64&gt; c;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">init</span><span class=\"params\">(<span class=\"type\">int</span> n)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        _n = n;</span><br><span class=\"line\">        c = <span class=\"built_in\">vector</span>&lt;i64&gt;(n + <span class=\"number\">1</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"type\">int</span> x, i64 d)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (; x &lt;= _n; x += (x &amp; -x))</span><br><span class=\"line\">            c[x] += d;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">i64 <span class=\"title\">query</span><span class=\"params\">(<span class=\"type\">int</span> x)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        i64 res = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (; x; x -= (x &amp; -x))</span><br><span class=\"line\">            res += c[x];</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">Fenwick fw;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">2e6</span> + <span class=\"number\">10</span>;</span><br><span class=\"line\">vector&lt;pair&lt;<span class=\"type\">int</span>, <span class=\"type\">int</span>&gt;&gt; mp[maxn];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"type\">int</span> n, q;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; q;</span><br><span class=\"line\">    <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">a</span><span class=\"params\">(n + <span class=\"number\">1</span>)</span></span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> maxs = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">        cin &gt;&gt; a[i], maxs = <span class=\"built_in\">max</span>(maxs, a[i]);</span><br><span class=\"line\">    vector&lt;tuple&lt;<span class=\"type\">int</span>, <span class=\"type\">int</span>, <span class=\"type\">int</span>&gt;&gt; <span class=\"built_in\">query</span>(q + <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">ans</span><span class=\"params\">(q + <span class=\"number\">1</span>)</span></span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= q; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> l, r, x;</span><br><span class=\"line\">        cin &gt;&gt; l &gt;&gt; r &gt;&gt; x;</span><br><span class=\"line\">        query[i] = &#123;l, r, x&#125;;</span><br><span class=\"line\">        mp[r].<span class=\"built_in\">push_back</span>(&#123;i, <span class=\"number\">1</span>&#125;);</span><br><span class=\"line\">        mp[l - <span class=\"number\">1</span>].<span class=\"built_in\">push_back</span>(&#123;i, <span class=\"number\">-1</span>&#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fw.<span class=\"built_in\">init</span>(maxs + <span class=\"number\">100</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        fw.<span class=\"built_in\">add</span>(a[i], <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> &amp;j : mp[i])</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            ans[j.first] += j.second * fw.<span class=\"built_in\">query</span>(<span class=\"built_in\">get</span>&lt;<span class=\"number\">2</span>&gt;(query[j.first]));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= q; i++)</span><br><span class=\"line\">        cout &lt;&lt; ans[i] &lt;&lt; <span class=\"string\">&#x27;\\n&#x27;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h2 id=\"6-å¹³è¡¡æ ‘ï¼ˆBindary-Search-AVL-Treeï¼‰\">6.å¹³è¡¡æ ‘ï¼ˆBindary Search AVL Treeï¼‰</h2>\n<p>å…³é”®è¯ï¼šæœ‰åºåºåˆ—ï¼ŒåŠ¨æ€æ’å…¥ä¸åˆ é™¤ã€‚</p>\n<h3 id=\"6-1-æ™®é€šå¹³è¡¡æ ‘\">6.1 æ™®é€šå¹³è¡¡æ ‘</h3>\n<p>è¯´å®è¯ï¼Œè£¸å¹³è¡¡æ ‘ç”¨çš„çœŸä¸å¤šï¼Œèƒ½ç”¨<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mi>e</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">set</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">se</span><span class=\"mord mathnormal\">t</span></span></span></span>ã€<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mi>u</mi><mi>l</mi><mi>t</mi><mi>i</mi><mi>s</mi><mi>e</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">multiset</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">lt</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">se</span><span class=\"mord mathnormal\">t</span></span></span></span>ç­‰<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mi>T</mi><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">STL</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">ST</span><span class=\"mord mathnormal\">L</span></span></span></span>â€‹â€‹å®ç°çš„ä¸œè¥¿ä¸ºå•¥è¦è‡ªå·±å†™ã€‚</p>\n<p>æ›´æ–°ï¼šéœ€è¦çŸ¥é“æ’åå°±åˆ«å°¼ç›æƒ³ä½ çš„multisetäº†ï¼Œèµ¶ç´§ç»™æˆ‘æ»šå»å†™<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi><mi>r</mi><mi>e</mi><mi>a</mi><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">Treap</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathnormal\">re</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">p</span></span></span></span>!</p>\n<p><em><strong>å¹³è¡¡æ ‘å¯æä¾›ä»¥ä¸‹æ“ä½œï¼š</strong></em></p>\n<ol>\n<li>æ’å…¥ä¸€ä¸ªæ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>ã€‚</li>\n<li>åˆ é™¤ä¸€ä¸ªæ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>ï¼ˆè‹¥æœ‰å¤šä¸ªç›¸åŒçš„æ•°ï¼Œåº”åªåˆ é™¤ä¸€ä¸ªï¼‰ã€‚</li>\n<li>å®šä¹‰<strong>æ’å</strong>ä¸ºæ¯”å½“å‰æ•°å°çš„æ•°çš„ä¸ªæ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">+</span><span class=\"mord\">1</span></span></span></span>ã€‚æŸ¥è¯¢ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> çš„æ’åã€‚</li>\n<li>æŸ¥è¯¢æ•°æ®ç»“æ„ä¸­æ’åä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> çš„æ•°ã€‚</li>\n<li>æ±‚ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> çš„å‰é©±ï¼ˆå‰é©±å®šä¹‰ä¸ºå°äº <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>ï¼Œä¸”æœ€å¤§çš„æ•°ï¼‰ã€‚</li>\n<li>æ±‚ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> çš„åç»§ï¼ˆåç»§å®šä¹‰ä¸ºå¤§äº <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>ï¼Œä¸”æœ€å°çš„æ•°ï¼‰ã€‚</li>\n</ol>\n<p>å¯¹äºæ“ä½œ 3,5,6ï¼Œ<strong>ä¸ä¿è¯</strong>å½“å‰æ•°æ®ç»“æ„ä¸­å­˜åœ¨æ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>n</mi><mo>â‰¤</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding=\"application/x-tex\">1\\le n \\le 10^5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span></span></span></span></span></span></span></span>.</p>\n<h4 id=\"6-1-1-æ›¿ç½ªç¾Šæ ‘ï¼ˆScapeGoat-Treeï¼‰\">6.1.1 æ›¿ç½ªç¾Šæ ‘ï¼ˆScapeGoat Treeï¼‰</h4>\n<p>æ›¿ç½ªç¾Šæ ‘æ˜¯ä¸€ä¸ªå¾ˆæš´åŠ›çš„æ€æƒ³ï¼Œæ¯æ¬¡æ’å…¥ä¸€ä¸ªæ•°åŠ¨æ€æ£€æŸ¥æ’å…¥åæŸäº›èŠ‚ç‚¹æ˜¯å¦éœ€è¦æš´åŠ›è¿›è¡Œå¹³è¡¡é‡æ„ã€‚ä¸€èˆ¬é€‰æ‹©å¹³è¡¡å› å­<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Î±</mi><mo>=</mo><mn>0.7</mn><mo>âˆ’</mo><mn>0.8</mn></mrow><annotation encoding=\"application/x-tex\">\\alpha=0.7-0.8</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">Î±</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">0.7</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.8</span></span></span></span>ã€‚å¦‚æœæŸä¸ªå­æ ‘çš„å·¦å„¿å­æ‰€ç®¡è¾–å­æ ‘å¤§å°å æ¯”ä¾‹è¶…è¿‡å¹³è¡¡å› å­å°±é‡æ„ã€‚é‡æ„å°±æ˜¯ä¸­åºéå†æš´åŠ›é‡æ„å³å¯ã€‚</p>\n<p>å¤æ‚åº¦å‡æ‘Š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(nlogn)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>ï¼Œæ ‘é«˜å‡æ‘Š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(logn)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span></p>\n<p>ä¸‹é¢ç¤ºä¾‹ä¸­ï¼Œé‡å¤ç‚¹ç®—ä½œæ–°å¼€ç‚¹ï¼Œç‚¹æ€»æ•°ä¸å¾—è¶…è¿‡<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mi>e</mi><mn>5</mn></mrow><annotation encoding=\"application/x-tex\">1e5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span><span class=\"mord mathnormal\">e</span><span class=\"mord\">5</span></span></span></span>çº§åˆ«ã€‚å¹³è¡¡æ ‘æ„å»ºæ—¶ï¼Œé»˜è®¤å·¦å„¿å­æƒå€¼å¿…é¡»ä¸¥æ ¼å°äºè‡ªèº«ï¼Œå³ç›¸åŒæƒå€¼ç»“ç‚¹å¿…å®šæ˜¯å…¨éƒ¨æŒ‚è½½äºå³å„¿å­ä¸Šã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> inf = (<span class=\"number\">1</span> &lt;&lt; <span class=\"number\">30</span>);</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"type\">long</span> <span class=\"type\">long</span> ll;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">1e6</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt; vec;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">node</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> ls, rs, w; <span class=\"comment\">// å·¦å„¿å­ï¼Œæœ‰å„¿å­ï¼ŒèŠ‚ç‚¹æƒå€¼</span></span><br><span class=\"line\">    <span class=\"type\">bool</span> exist;    <span class=\"comment\">// è¯¥èŠ‚ç‚¹æ‰€ä»£è¡¨å…ƒç´ æ˜¯å¦å­˜åœ¨</span></span><br><span class=\"line\">    <span class=\"type\">int</span> sizx;      <span class=\"comment\">// è¯¥èŠ‚ç‚¹ä¸‹å±å­æ ‘å¤§å°</span></span><br><span class=\"line\">    <span class=\"type\">int</span> fact;      <span class=\"comment\">// è¯¥èŠ‚ç‚¹ä¸‹å±å­æ ‘ä¸­å°šå­˜åœ¨å…ƒç´ ä¸ªæ•°</span></span><br><span class=\"line\">&#125; tr[maxn];</span><br><span class=\"line\"><span class=\"type\">int</span> cnt, root;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">pushup</span><span class=\"params\">(<span class=\"type\">int</span> now)</span> <span class=\"comment\">// ç»´æŠ¤èŠ‚ç‚¹ä¿¡æ¯</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    tr[now].sizx = tr[tr[now].ls].sizx + tr[tr[now].rs].sizx + <span class=\"number\">1</span>;</span><br><span class=\"line\">    tr[now].fact = tr[tr[now].ls].fact + tr[tr[now].rs].fact + <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">newnode</span><span class=\"params\">(<span class=\"type\">int</span> &amp;now, <span class=\"type\">int</span> w)</span> <span class=\"comment\">// å¼€æ–°ç‚¹</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    now = ++cnt;</span><br><span class=\"line\">    tr[now].w = w, tr[now].sizx = tr[now].fact = <span class=\"number\">1</span>;</span><br><span class=\"line\">    tr[now].exist = <span class=\"literal\">true</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">bool</span> <span class=\"title\">judge</span><span class=\"params\">(<span class=\"type\">int</span> now)</span> <span class=\"comment\">// åˆ¤æ–­æ˜¯å¦å¹³è¡¡</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">max</span>(tr[tr[now].ls].sizx, tr[tr[now].rs].sizx) &gt; tr[now].sizx * <span class=\"number\">0.75</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> ((tr[now].sizx - tr[now].fact) &gt; tr[now].sizx * <span class=\"number\">0.3</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">mds</span><span class=\"params\">(<span class=\"type\">int</span> now)</span> <span class=\"comment\">// ä¸­åºéå†</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!now)</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    <span class=\"built_in\">mds</span>(tr[now].ls);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (tr[now].exist)</span><br><span class=\"line\">        vec.<span class=\"built_in\">push_back</span>(now);</span><br><span class=\"line\">    <span class=\"built_in\">mds</span>(tr[now].rs);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">cre</span><span class=\"params\">(<span class=\"type\">int</span> L, <span class=\"type\">int</span> R, <span class=\"type\">int</span> &amp;now)</span> <span class=\"comment\">// æ„é€ æ ‡å‡†å¹³è¡¡æ ‘</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (L == R)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        now = vec[L];</span><br><span class=\"line\">        tr[now].ls = tr[now].rs = <span class=\"number\">0</span>;</span><br><span class=\"line\">        tr[now].sizx = tr[now].fact = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (L + R) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (L &lt; mid &amp;&amp; tr[vec[mid]].w == tr[vec[mid - <span class=\"number\">1</span>]].w)</span><br><span class=\"line\">        mid--;</span><br><span class=\"line\">    now = vec[mid];</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (L &lt; mid)</span><br><span class=\"line\">        <span class=\"built_in\">cre</span>(L, mid - <span class=\"number\">1</span>, tr[now].ls);</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        tr[now].ls = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"built_in\">cre</span>(mid + <span class=\"number\">1</span>, R, tr[now].rs);</span><br><span class=\"line\">    <span class=\"built_in\">pushup</span>(now);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"type\">int</span> now, <span class=\"type\">int</span> en)</span> <span class=\"comment\">// ç»´æŠ¤çˆ¶è¾ˆèŠ‚ç‚¹</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!now)</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (tr[now].w &gt; tr[en].w)</span><br><span class=\"line\">        <span class=\"built_in\">update</span>(tr[now].ls, en);</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"built_in\">update</span>(tr[now].rs, en);</span><br><span class=\"line\">    tr[now].sizx = tr[tr[now].ls].sizx + tr[tr[now].rs].sizx + <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">rebuild</span><span class=\"params\">(<span class=\"type\">int</span> &amp;now)</span> <span class=\"comment\">// é‡æ„æ ‘</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    vec.<span class=\"built_in\">clear</span>();</span><br><span class=\"line\">    <span class=\"built_in\">mds</span>(now);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (vec.<span class=\"built_in\">empty</span>())</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        now = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">cre</span>(<span class=\"number\">0</span>, vec.<span class=\"built_in\">size</span>() - <span class=\"number\">1</span>, now);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">check</span><span class=\"params\">(<span class=\"type\">int</span> &amp;now, <span class=\"type\">int</span> en)</span> <span class=\"comment\">// æ£€æŸ¥ï¼Œå¹¶é‡æ„å­æ ‘</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (now == en)</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">judge</span>(now))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">rebuild</span>(now);</span><br><span class=\"line\">        <span class=\"built_in\">update</span>(root, now);</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (tr[en].w &lt; tr[now].w)</span><br><span class=\"line\">        <span class=\"built_in\">check</span>(tr[now].ls, en);</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"built_in\">check</span>(tr[now].rs, en);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">inser</span><span class=\"params\">(<span class=\"type\">int</span> &amp;now, <span class=\"type\">int</span> w)</span> <span class=\"comment\">// æ’å…¥</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!now)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">newnode</span>(now, w);</span><br><span class=\"line\">        <span class=\"built_in\">check</span>(root, now);</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    tr[now].sizx++, tr[now].fact++;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (w &lt; tr[now].w)</span><br><span class=\"line\">        <span class=\"built_in\">inser</span>(tr[now].ls, w);</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"built_in\">inser</span>(tr[now].rs, w);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">del</span><span class=\"params\">(<span class=\"type\">int</span> now, <span class=\"type\">int</span> w)</span> <span class=\"comment\">// åˆ é™¤</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (tr[now].exist &amp;&amp; tr[now].w == w)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        tr[now].exist = <span class=\"literal\">false</span>;</span><br><span class=\"line\">        tr[now].fact--;</span><br><span class=\"line\">        <span class=\"built_in\">check</span>(root, now);</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    tr[now].fact--;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (w &lt; tr[now].w)</span><br><span class=\"line\">        <span class=\"built_in\">del</span>(tr[now].ls, w);</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"built_in\">del</span>(tr[now].rs, w);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">getrank</span><span class=\"params\">(<span class=\"type\">int</span> w)</span> <span class=\"comment\">// æ±‚wçš„æ’å</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> now = root, rank = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (now)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (w &lt;= tr[now].w)</span><br><span class=\"line\">            now = tr[now].ls;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            rank += tr[now].exist + tr[tr[now].ls].fact, now = tr[now].rs;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> rank;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">getnum</span><span class=\"params\">(<span class=\"type\">int</span> rank)</span> <span class=\"comment\">// æ±‚æ’åä¸ºrankçš„æ ‘æ•°</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> now = root;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (now)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tr[now].exist &amp;&amp; tr[tr[now].ls].fact + tr[now].exist == rank)</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (rank &lt;= tr[tr[now].ls].fact)</span><br><span class=\"line\">            now = tr[now].ls;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            rank -= tr[now].exist + tr[tr[now].ls].fact, now = tr[now].rs;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> tr[now].w;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"literal\">false</span>);</span><br><span class=\"line\">    cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"type\">int</span> n;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (n--)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> op, x;</span><br><span class=\"line\">        cin &gt;&gt; op &gt;&gt; x;</span><br><span class=\"line\">        <span class=\"keyword\">switch</span> (op)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">1</span>:</span><br><span class=\"line\">            <span class=\"built_in\">inser</span>(root, x);</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">2</span>:</span><br><span class=\"line\">            <span class=\"built_in\">del</span>(root, x);</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">3</span>:</span><br><span class=\"line\">            cout &lt;&lt; <span class=\"built_in\">getrank</span>(x) &lt;&lt; endl;</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">4</span>:</span><br><span class=\"line\">            cout &lt;&lt; <span class=\"built_in\">getnum</span>(x) &lt;&lt; endl;</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">5</span>:</span><br><span class=\"line\">            cout &lt;&lt; <span class=\"built_in\">getnum</span>(<span class=\"built_in\">getrank</span>(x) - <span class=\"number\">1</span>) &lt;&lt; endl;</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> <span class=\"number\">6</span>:</span><br><span class=\"line\"></span><br><span class=\"line\">            cout &lt;&lt; <span class=\"built_in\">getnum</span>(<span class=\"built_in\">getrank</span>(x + <span class=\"number\">1</span>)) &lt;&lt; endl;</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"6-1-2-æ ‘å †ï¼ˆTreapï¼‰\">6.1.2 æ ‘å †ï¼ˆTreapï¼‰</h4>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi><mi>r</mi><mi>e</mi><mi>a</mi><mi>p</mi><mo>=</mo><mi>T</mi><mi>r</mi><mi>e</mi><mi>e</mi><mo>+</mo><mi>H</mi><mi>e</mi><mi>a</mi><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">Treap=Tree+Heap</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathnormal\">re</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathnormal\">ree</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">He</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">p</span></span></span></span>ï¼Œæ˜¯ä¸€ç§å¼±å¹³è¡¡æ€§è´¨çš„å¹³è¡¡æ ‘ï¼Œ<em><strong>å‡æ‘Š</strong></em>æ ‘æ·±åº¦<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(logn)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>ã€‚</p>\n<p>æ¯ä¸€ä¸ªæ ‘èŠ‚ç‚¹å¤šèµ‹å€¼ä¸€ä¸ª<em><strong>éšæœº</strong></em>æƒå€¼ï¼Œä½¿å¾—è¯¥æ ‘<em><strong>æ—¢æ»¡è¶³å¹³è¡¡æ ‘æ€§è´¨</strong></em>ï¼ˆ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi><mi>a</mi><msub><mi>l</mi><mrow><mi>l</mi><mi>s</mi><mi>o</mi><mi>n</mi></mrow></msub><mo>&lt;</mo><mi>v</mi><mi>a</mi><msub><mi>l</mi><mrow><mi>r</mi><mi>t</mi></mrow></msub><mo>&lt;</mo><mi>v</mi><mi>a</mi><msub><mi>l</mi><mrow><mi>r</mi><mi>s</mi><mi>o</mi><mi>n</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">val_{lson}&lt;val_{rt}&lt; val_{rson}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\">a</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\">so</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\">a</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\">a</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">rso</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼‰ï¼Œ<em><strong>åˆæ»¡è¶³å †çš„æ€§è´¨</strong></em>ï¼ˆ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>w</mi><mrow><mi>l</mi><mi>s</mi><mi>o</mi><mi>n</mi></mrow></msub><mo>&lt;</mo><msub><mi>w</mi><mrow><mi>r</mi><mi>t</mi></mrow></msub><mo separator=\"true\">,</mo><msub><mi>w</mi><mrow><mi>r</mi><mi>t</mi></mrow></msub><mo>&gt;</mo><msub><mi>w</mi><mrow><mi>r</mi><mi>s</mi><mi>o</mi><mi>n</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">w_{lson}&lt;w_{rt},w_{rt}&gt;w_{rson}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6891em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\">so</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">rso</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>â€‹ï¼‰</p>\n<p>å¤æ‚åº¦æ­£ç¡®æ€§ç”±éšæœºæ•°ä¿è¯ã€‚</p>\n<p>å…³äºæ›´å¤šçš„Treapï¼Œè¯¦è§<em><strong>6.2 ç¬›å¡å°”æ ‘</strong></em></p>\n<p><em><strong>æ­¤å¤„çš„ç¤ºä¾‹å› é¢˜ç›®ä¿è¯å‰é©±åç»§å¿…å®šå­˜åœ¨æ•…æ²¡æœ‰ç‰¹åˆ¤ï¼Œå¦‚æœå‰é©±åç»§ä¸å­˜åœ¨å¯¹åº”å‡½æ•°å¿…å®šå¡æ­»ï¼Œè§£å†³æ–¹æ¡ˆå‚è§6.3.1å¯æŒä¹…åŒ–Treapä¸­çš„è§£å†³æ–¹å¼ã€‚</strong></em></p>\n<h5 id=\"6-1-2-1-æœ‰æ—‹Treap\">6.1.2.1 æœ‰æ—‹Treap</h5>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> MAXN = <span class=\"number\">100005</span>;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> inf = <span class=\"number\">0x3f3f3f3f</span>;</span><br><span class=\"line\"><span class=\"type\">unsigned</span> <span class=\"type\">int</span> seed;</span><br><span class=\"line\">random_device rd;</span><br><span class=\"line\">mt19937 ran;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">Treap</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">struct</span> <span class=\"title class_\">node</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> val, rnd, lc, rc, size, num;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"type\">int</span> cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\">    node tr[MAXN];</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">init</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> _rand()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        ran.<span class=\"built_in\">seed</span>(<span class=\"built_in\">rd</span>());</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">ran</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">pushup</span><span class=\"params\">(<span class=\"type\">int</span> p)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        tr[p].size = tr[tr[p].lc].size + tr[tr[p].rc].size + tr[p].num;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">right</span><span class=\"params\">(<span class=\"type\">int</span> &amp;k)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> tmp = tr[k].lc;</span><br><span class=\"line\">        tr[k].lc = tr[tmp].rc;</span><br><span class=\"line\">        tr[tmp].rc = k;</span><br><span class=\"line\">        tr[tmp].size = tr[k].size;</span><br><span class=\"line\">        <span class=\"built_in\">pushup</span>(k);</span><br><span class=\"line\">        k = tmp;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">left</span><span class=\"params\">(<span class=\"type\">int</span> &amp;k)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> tmp = tr[k].rc;</span><br><span class=\"line\">        tr[k].rc = tr[tmp].lc;</span><br><span class=\"line\">        tr[tmp].lc = k;</span><br><span class=\"line\">        tr[tmp].size = tr[k].size;</span><br><span class=\"line\">        <span class=\"built_in\">pushup</span>(k);</span><br><span class=\"line\">        k = tmp;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">insert</span><span class=\"params\">(<span class=\"type\">int</span> &amp;p, <span class=\"type\">int</span> x)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (p == <span class=\"number\">0</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            p = ++cnt;</span><br><span class=\"line\">            tr[p].val = x;</span><br><span class=\"line\">            tr[p].num = tr[p].size = <span class=\"number\">1</span>;</span><br><span class=\"line\">            tr[p].lc = tr[p].rc = <span class=\"number\">0</span>;</span><br><span class=\"line\">            tr[p].rnd = _rand();</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        ++tr[p].size;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (x == tr[p].val)</span><br><span class=\"line\">            ++tr[p].num;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (x &lt; tr[p].val)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"built_in\">insert</span>(tr[p].lc, x);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (tr[tr[p].lc].rnd &lt; tr[p].rnd)</span><br><span class=\"line\">                <span class=\"built_in\">right</span>(p);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (x &gt; tr[p].val)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"built_in\">insert</span>(tr[p].rc, x);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (tr[tr[p].rc].rnd &lt; tr[p].rnd)</span><br><span class=\"line\">                <span class=\"built_in\">left</span>(p);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">del</span><span class=\"params\">(<span class=\"type\">int</span> &amp;p, <span class=\"type\">int</span> x)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (p == <span class=\"number\">0</span>)</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tr[p].val == x)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (tr[p].num &gt; <span class=\"number\">1</span>)</span><br><span class=\"line\">                --tr[p].num, --tr[p].size;</span><br><span class=\"line\">            <span class=\"keyword\">else</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (tr[p].lc == <span class=\"number\">0</span> || tr[p].rc == <span class=\"number\">0</span>)</span><br><span class=\"line\">                    p = tr[p].lc + tr[p].rc;</span><br><span class=\"line\">                <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (tr[tr[p].lc].rnd &lt; tr[tr[p].rc].rnd)</span><br><span class=\"line\">                    <span class=\"built_in\">right</span>(p), <span class=\"built_in\">del</span>(p, x);</span><br><span class=\"line\">                <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (tr[tr[p].lc].rnd &gt; tr[tr[p].rc].rnd)</span><br><span class=\"line\">                    <span class=\"built_in\">left</span>(p), <span class=\"built_in\">del</span>(p, x);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (tr[p].val &lt; x)</span><br><span class=\"line\">            --tr[p].size, <span class=\"built_in\">del</span>(tr[p].rc, x);</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">            --tr[p].size, <span class=\"built_in\">del</span>(tr[p].lc, x);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">queryrnk</span><span class=\"params\">(<span class=\"type\">int</span> &amp;p, <span class=\"type\">int</span> x)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (p == <span class=\"number\">0</span>)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (tr[p].val == x)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> tr[tr[p].lc].size;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (tr[p].val &lt; x)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> tr[tr[p].lc].size + tr[p].num + <span class=\"built_in\">queryrnk</span>(tr[p].rc, x);</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">queryrnk</span>(tr[p].lc, x);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">querynum</span><span class=\"params\">(<span class=\"type\">int</span> &amp;p, <span class=\"type\">int</span> rnk)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (p == <span class=\"number\">0</span>)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tr[tr[p].lc].size &gt;= rnk)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">querynum</span>(tr[p].lc, rnk);</span><br><span class=\"line\">        rnk -= tr[tr[p].lc].size;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (rnk &lt;= tr[p].num)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> tr[p].val;</span><br><span class=\"line\">        rnk -= tr[p].num;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">querynum</span>(tr[p].rc, rnk);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">queryfront</span><span class=\"params\">(<span class=\"type\">int</span> &amp;p, <span class=\"type\">int</span> x)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (p == <span class=\"number\">0</span>)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> -inf;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tr[p].val &lt; x)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">max</span>(tr[p].val, <span class=\"built_in\">queryfront</span>(tr[p].rc, x));</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (tr[p].val &gt;= x)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">queryfront</span>(tr[p].lc, x);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">queryback</span><span class=\"params\">(<span class=\"type\">int</span> &amp;p, <span class=\"type\">int</span> x)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (p == <span class=\"number\">0</span>)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> inf;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tr[p].val &gt; x)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">min</span>(tr[p].val, <span class=\"built_in\">queryback</span>(tr[p].lc, x));</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (tr[p].val &lt;= x)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">queryback</span>(tr[p].rc, x);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"type\">int</span> pos;</span><br><span class=\"line\">Treap tr;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n;</span><br><span class=\"line\">    <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;n);</span><br><span class=\"line\">    <span class=\"type\">int</span> m, k;</span><br><span class=\"line\">    tr.<span class=\"built_in\">init</span>();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; ++i)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d&quot;</span>, &amp;m, &amp;k);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (m == <span class=\"number\">1</span>)</span><br><span class=\"line\">            tr.<span class=\"built_in\">insert</span>(pos, k);</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (m == <span class=\"number\">2</span>)</span><br><span class=\"line\">            tr.<span class=\"built_in\">del</span>(pos, k);</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (m == <span class=\"number\">3</span>)</span><br><span class=\"line\">            <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d\\n&quot;</span>, tr.<span class=\"built_in\">queryrnk</span>(pos, k) + <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (m == <span class=\"number\">4</span>)</span><br><span class=\"line\">            <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d\\n&quot;</span>, tr.<span class=\"built_in\">querynum</span>(pos, k));</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (m == <span class=\"number\">5</span>)</span><br><span class=\"line\">            <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d\\n&quot;</span>, tr.<span class=\"built_in\">queryfront</span>(pos, k));</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (m == <span class=\"number\">6</span>)</span><br><span class=\"line\">            <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d\\n&quot;</span>, tr.<span class=\"built_in\">queryback</span>(pos, k));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h5 id=\"6-1-2-2-æ— æ—‹Treapï¼ˆFHQ-Treap\">6.1.2.2 æ— æ—‹Treapï¼ˆFHQ-Treap)</h5>\n<p>æ— æ—‹è½¬<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi><mi>r</mi><mi>e</mi><mi>a</mi><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">Treap</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathnormal\">re</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">p</span></span></span></span>â€‹â€‹é€šè¿‡æ ‘åˆ†è£‚å’Œåˆå¹¶å®ç°èŠ‚ç‚¹çš„æ·»åŠ ä»¥åŠåˆ é™¤ã€‚å¯ä»¥æ”¯æŒå›ºå®šåŒºé—´æ“ä½œï¼Œæ”¯æŒå¯æŒä¹…åŒ–æ“ä½œã€‚</p>\n<h6 id=\"6-1-2-2-1-å•ä¸ªèŠ‚ç‚¹åªæœ‰ä¸€ä¸ªå€¼ï¼Œç›¸åŒå€¼ä½¿ç”¨å¤šä¸ªèŠ‚ç‚¹ï¼Œå¯æ”¯æŒsplit-sz\">6.1.2.2.1 å•ä¸ªèŠ‚ç‚¹åªæœ‰ä¸€ä¸ªå€¼ï¼Œç›¸åŒå€¼ä½¿ç”¨å¤šä¸ªèŠ‚ç‚¹ï¼Œå¯æ”¯æŒsplit_sz</h6>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\">random_device rd;</span><br><span class=\"line\"><span class=\"function\">mt19937 <span class=\"title\">ran</span><span class=\"params\">(rd())</span></span>;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">Treap</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">struct</span> <span class=\"title class_\">node</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> l, r;</span><br><span class=\"line\">        <span class=\"type\">int</span> w;</span><br><span class=\"line\">        <span class=\"type\">int</span> val;</span><br><span class=\"line\">        <span class=\"type\">int</span> sz;</span><br><span class=\"line\">        <span class=\"built_in\">node</span>() : <span class=\"built_in\">l</span>(<span class=\"number\">0</span>), <span class=\"built_in\">r</span>(<span class=\"number\">0</span>), <span class=\"built_in\">w</span>(<span class=\"number\">0</span>), <span class=\"built_in\">val</span>(<span class=\"number\">0</span>), <span class=\"built_in\">sz</span>(<span class=\"number\">0</span>) &#123;&#125;;</span><br><span class=\"line\">        <span class=\"built_in\">node</span>(<span class=\"type\">int</span> val) : <span class=\"built_in\">l</span>(<span class=\"number\">0</span>), <span class=\"built_in\">r</span>(<span class=\"number\">0</span>), <span class=\"built_in\">w</span>(<span class=\"built_in\">ran</span>()), <span class=\"built_in\">val</span>(val), <span class=\"built_in\">sz</span>(<span class=\"number\">1</span>) &#123;&#125;;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"type\">const</span> <span class=\"type\">static</span> <span class=\"type\">int</span> maxn = <span class=\"number\">5e5</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\">    node tree[maxn];</span><br><span class=\"line\">    <span class=\"type\">int</span> root;</span><br><span class=\"line\">    <span class=\"type\">int</span> tot = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">newnode</span><span class=\"params\">(<span class=\"type\">int</span> val)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        tot++;</span><br><span class=\"line\">        tree[tot] = <span class=\"built_in\">node</span>(val);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> tot;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">void</span> <span class=\"title\">pushup</span><span class=\"params\">(<span class=\"type\">int</span> rt)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        tree[rt].sz = tree[tree[rt].l].sz + tree[tree[rt].r].sz + <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">void</span> <span class=\"title\">split_val</span><span class=\"params\">(<span class=\"type\">const</span> <span class=\"type\">int</span> rt, <span class=\"type\">int</span> &amp;l, <span class=\"type\">int</span> &amp;r, <span class=\"type\">int</span> val)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!rt)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            l = r = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tree[rt].val &lt;= val) <span class=\"comment\">// å¶å­æƒå€¼æ¯”ç›®æ ‡å€¼å°ï¼Œå¿…å®šå±äºå·¦ä¾§ã€‚</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            l = rt;</span><br><span class=\"line\">            <span class=\"built_in\">split_val</span>(tree[rt].r, tree[rt].r, r, val);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            r = rt;</span><br><span class=\"line\">            <span class=\"built_in\">split_val</span>(tree[rt].l, l, tree[rt].l, val);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">pushup</span>(rt);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">void</span> <span class=\"title\">split_sz</span><span class=\"params\">(<span class=\"type\">const</span> <span class=\"type\">int</span> rt, <span class=\"type\">int</span> &amp;l, <span class=\"type\">int</span> &amp;r, <span class=\"type\">int</span> sz)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!rt)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            l = r = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tree[tree[rt].l].sz + <span class=\"number\">1</span> &lt;= sz)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            l = rt;</span><br><span class=\"line\">            <span class=\"built_in\">split_sz</span>(tree[rt].r, tree[rt].r, r, sz - (tree[tree[rt].l].sz + <span class=\"number\">1</span>));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            r = rt;</span><br><span class=\"line\">            <span class=\"built_in\">split_sz</span>(tree[rt].l, l, tree[rt].l, sz);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">pushup</span>(rt);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">void</span> <span class=\"title\">merge</span><span class=\"params\">(<span class=\"type\">int</span> &amp;rt, <span class=\"type\">const</span> <span class=\"type\">int</span> l, <span class=\"type\">const</span> <span class=\"type\">int</span> r)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!l || !r)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            rt = l | r;</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tree[l].w &gt; tree[r].w) <span class=\"comment\">// å¤§æ ¹å †å½¢å¼ï¼Œå°æ ¹å †æ¢ä¸ªå·å°±è¡Œ</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            rt = l;</span><br><span class=\"line\">            <span class=\"built_in\">merge</span>(tree[rt].r, tree[rt].r, r);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            rt = r;</span><br><span class=\"line\">            <span class=\"built_in\">merge</span>(tree[rt].l, l, tree[rt].l);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">pushup</span>(rt);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">void</span> <span class=\"title\">insert</span><span class=\"params\">(<span class=\"type\">int</span> x)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> rt1, rt2;</span><br><span class=\"line\">        <span class=\"built_in\">split_val</span>(root, rt1, rt2, x - <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"built_in\">merge</span>(rt1, rt1, <span class=\"built_in\">newnode</span>(x));</span><br><span class=\"line\">        <span class=\"built_in\">merge</span>(root, rt1, rt2);</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">void</span> <span class=\"title\">del</span><span class=\"params\">(<span class=\"type\">int</span> val)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> x, y, z;</span><br><span class=\"line\">        <span class=\"built_in\">split_val</span>(root, x, y, val);</span><br><span class=\"line\">        <span class=\"built_in\">split_val</span>(x, x, z, val - <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"built_in\">merge</span>(z, tree[z].l, tree[z].r);</span><br><span class=\"line\">        <span class=\"built_in\">merge</span>(x, x, z);</span><br><span class=\"line\">        <span class=\"built_in\">merge</span>(root, x, y);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">int</span> <span class=\"title\">rnk</span><span class=\"params\">(<span class=\"type\">int</span> val)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> x, y;</span><br><span class=\"line\">        <span class=\"built_in\">split_val</span>(root, x, y, val - <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"type\">int</span> ans = tree[x].sz + <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">merge</span>(root, x, y);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">int</span> <span class=\"title\">kth</span><span class=\"params\">(<span class=\"type\">int</span> root, <span class=\"type\">int</span> k)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> x = root;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (k == tree[tree[x].l].sz + <span class=\"number\">1</span>)</span><br><span class=\"line\">                <span class=\"keyword\">return</span> tree[x].val;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (k &lt;= tree[tree[x].l].sz)</span><br><span class=\"line\">                x = tree[x].l;</span><br><span class=\"line\">            <span class=\"keyword\">else</span></span><br><span class=\"line\">                k -= tree[tree[x].l].sz + <span class=\"number\">1</span>, x = tree[x].r;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">int</span> <span class=\"title\">kth</span><span class=\"params\">(<span class=\"type\">int</span> k)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">kth</span>(root, k);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">int</span> <span class=\"title\">pre</span><span class=\"params\">(<span class=\"type\">int</span> val)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> x, y;</span><br><span class=\"line\">        <span class=\"built_in\">split_val</span>(root, x, y, val - <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"type\">int</span> ans = <span class=\"built_in\">kth</span>(x, tree[x].sz);</span><br><span class=\"line\">        <span class=\"built_in\">merge</span>(root, x, y);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">int</span> <span class=\"title\">suf</span><span class=\"params\">(<span class=\"type\">int</span> val)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> x, y;</span><br><span class=\"line\">        <span class=\"built_in\">split_val</span>(root, x, y, val);</span><br><span class=\"line\">        <span class=\"type\">int</span> ans = <span class=\"built_in\">kth</span>(y, <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"built_in\">merge</span>(root, x, y);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">Treap tr;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (n--)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> op, x;</span><br><span class=\"line\">        cin &gt;&gt; op &gt;&gt; x;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (op == <span class=\"number\">1</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            tr.<span class=\"built_in\">insert</span>(x);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (op == <span class=\"number\">2</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            tr.<span class=\"built_in\">del</span>(x);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (op == <span class=\"number\">3</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            cout &lt;&lt; tr.<span class=\"built_in\">rnk</span>(x) &lt;&lt; endl;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (op == <span class=\"number\">4</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            cout &lt;&lt; tr.<span class=\"built_in\">kth</span>(x) &lt;&lt; endl;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (op == <span class=\"number\">5</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            cout &lt;&lt; tr.<span class=\"built_in\">pre</span>(x) &lt;&lt; endl;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">            cout &lt;&lt; tr.<span class=\"built_in\">suf</span>(x) &lt;&lt; endl;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h6 id=\"6-1-2-2-2-å•ä¸ªèŠ‚ç‚¹æœ‰å¤šä¸ªå€¼ï¼Œç›¸åŒå€¼ä½¿ç”¨åŒä¸€ä¸ªä¸ªèŠ‚ç‚¹ï¼Œä¸æ”¯æŒsplit-sz\">6.1.2.2.2 å•ä¸ªèŠ‚ç‚¹æœ‰å¤šä¸ªå€¼ï¼Œç›¸åŒå€¼ä½¿ç”¨åŒä¸€ä¸ªä¸ªèŠ‚ç‚¹ï¼Œä¸æ”¯æŒsplit_sz</h6>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\">random_device rd;</span><br><span class=\"line\"><span class=\"function\">mt19937 <span class=\"title\">ran</span><span class=\"params\">(rd())</span></span>;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">Treap</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">struct</span> <span class=\"title class_\">node</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> l, r;</span><br><span class=\"line\">        <span class=\"type\">int</span> val;</span><br><span class=\"line\">        <span class=\"type\">int</span> sz;</span><br><span class=\"line\">        <span class=\"type\">int</span> cnt;</span><br><span class=\"line\">        <span class=\"type\">int</span> w;</span><br><span class=\"line\">        <span class=\"built_in\">node</span>() : <span class=\"built_in\">l</span>(<span class=\"number\">0</span>), <span class=\"built_in\">r</span>(<span class=\"number\">0</span>), <span class=\"built_in\">val</span>(<span class=\"number\">0</span>), <span class=\"built_in\">sz</span>(<span class=\"number\">0</span>), <span class=\"built_in\">cnt</span>(<span class=\"number\">0</span>), <span class=\"built_in\">w</span>(<span class=\"number\">0</span>) &#123;&#125;;</span><br><span class=\"line\">        <span class=\"built_in\">node</span>(<span class=\"type\">int</span> val) : <span class=\"built_in\">l</span>(<span class=\"number\">0</span>), <span class=\"built_in\">r</span>(<span class=\"number\">0</span>), <span class=\"built_in\">val</span>(val), <span class=\"built_in\">sz</span>(<span class=\"number\">1</span>), <span class=\"built_in\">cnt</span>(<span class=\"number\">1</span>), <span class=\"built_in\">w</span>(<span class=\"built_in\">ran</span>()) &#123;&#125;;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"type\">const</span> <span class=\"type\">static</span> <span class=\"type\">int</span> N = <span class=\"number\">2e6</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> tot = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> root = <span class=\"number\">0</span>;</span><br><span class=\"line\">    node tree[N];</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">newnode</span><span class=\"params\">(<span class=\"type\">int</span> val)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        tot++;</span><br><span class=\"line\">        tree[tot] = <span class=\"built_in\">node</span>(val);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> tot;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">pushup</span><span class=\"params\">(<span class=\"type\">int</span> rt)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        tree[rt].sz = tree[tree[rt].l].sz + tree[tree[rt].r].sz + tree[rt].cnt;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">merge</span><span class=\"params\">(<span class=\"type\">int</span> &amp;rt, <span class=\"type\">const</span> <span class=\"type\">int</span> l, <span class=\"type\">const</span> <span class=\"type\">int</span> r)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!l || !r)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            rt = l | r;</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tree[l].w &gt; tree[r].w)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            rt = l;</span><br><span class=\"line\">            <span class=\"built_in\">merge</span>(tree[rt].r, tree[rt].r, r);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            rt = r;</span><br><span class=\"line\">            <span class=\"built_in\">merge</span>(tree[rt].l, l, tree[rt].l);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">pushup</span>(rt);</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">split_val</span><span class=\"params\">(<span class=\"type\">const</span> <span class=\"type\">int</span> rt, <span class=\"type\">int</span> &amp;l, <span class=\"type\">int</span> &amp;r, <span class=\"type\">int</span> val)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!rt)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            l = r = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tree[rt].val &lt;= val)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            l = rt;</span><br><span class=\"line\">            <span class=\"built_in\">split_val</span>(tree[rt].r, tree[rt].r, r, val);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            r = rt;</span><br><span class=\"line\">            <span class=\"built_in\">split_val</span>(tree[rt].l, l, tree[rt].l, val);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">pushup</span>(rt);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">void</span> <span class=\"title\">insert</span><span class=\"params\">(<span class=\"type\">int</span> x)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> rt1, rt2, rt3;</span><br><span class=\"line\">        <span class=\"built_in\">split_val</span>(root, rt1, rt2, x - <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"built_in\">split_val</span>(rt2, rt2, rt3, x);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!rt2)</span><br><span class=\"line\">            rt2 = <span class=\"built_in\">newnode</span>(x);</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">            tree[rt2].cnt++, tree[rt2].sz++;</span><br><span class=\"line\">        <span class=\"built_in\">merge</span>(rt2, rt2, rt3);</span><br><span class=\"line\">        <span class=\"built_in\">merge</span>(root, rt1, rt2);</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">void</span> <span class=\"title\">del</span><span class=\"params\">(<span class=\"type\">int</span> val)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> rt1, rt2, rt3;</span><br><span class=\"line\">        <span class=\"built_in\">split_val</span>(root, rt1, rt2, val);</span><br><span class=\"line\">        <span class=\"built_in\">split_val</span>(rt1, rt1, rt3, val - <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"built_in\">assert</span>(rt3 != <span class=\"number\">0</span>);</span><br><span class=\"line\">        tree[rt3].cnt--, tree[rt3].sz--;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!tree[rt3].cnt)</span><br><span class=\"line\">            <span class=\"built_in\">merge</span>(rt3, tree[rt3].l, tree[rt3].r);</span><br><span class=\"line\">        <span class=\"built_in\">merge</span>(rt1, rt1, rt3);</span><br><span class=\"line\">        <span class=\"built_in\">merge</span>(root, rt1, rt2);</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">int</span> <span class=\"title\">rnk</span><span class=\"params\">(<span class=\"type\">int</span> val)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> x, y;</span><br><span class=\"line\">        <span class=\"built_in\">split_val</span>(root, x, y, val - <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"type\">int</span> ans = tree[x].sz + <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">merge</span>(root, x, y);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">int</span> <span class=\"title\">kth</span><span class=\"params\">(<span class=\"type\">int</span> root, <span class=\"type\">int</span> k)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> x = root;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (k &lt;= tree[tree[x].l].sz)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                x = tree[x].l;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (k &gt; tree[tree[x].l].sz + tree[x].cnt)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                k -= (tree[tree[x].l].sz + tree[x].cnt);</span><br><span class=\"line\">                x = tree[x].r;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> tree[x].val;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">int</span> <span class=\"title\">kth</span><span class=\"params\">(<span class=\"type\">int</span> k)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">kth</span>(root, k);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">int</span> <span class=\"title\">pre</span><span class=\"params\">(<span class=\"type\">int</span> val)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> x, y;</span><br><span class=\"line\">        <span class=\"built_in\">split_val</span>(root, x, y, val - <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"type\">int</span> ans = <span class=\"built_in\">kth</span>(x, tree[x].sz);</span><br><span class=\"line\">        <span class=\"built_in\">merge</span>(root, x, y);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">int</span> <span class=\"title\">suf</span><span class=\"params\">(<span class=\"type\">int</span> val)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> x, y;</span><br><span class=\"line\">        <span class=\"built_in\">split_val</span>(root, x, y, val);</span><br><span class=\"line\">        <span class=\"type\">int</span> ans = <span class=\"built_in\">kth</span>(y, <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"built_in\">merge</span>(root, x, y);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">Treap tr;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"6-1-3-ä¼¸å±•æ ‘ï¼ˆSplay-Treeï¼‰\">6.1.3 ä¼¸å±•æ ‘ï¼ˆSplay Treeï¼‰</h4>\n<p>é€šè¿‡ <strong><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mi>p</mi><mi>l</mi><mi>a</mi><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">Splay</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">Spl</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>/ä¼¸å±•æ“ä½œ</strong> ä¸æ–­å°†æŸä¸ªèŠ‚ç‚¹æ—‹è½¬åˆ°æ ¹èŠ‚ç‚¹ï¼Œä½¿å¾—æ•´æ£µæ ‘ä»ç„¶æ»¡è¶³äºŒå‰æŸ¥æ‰¾æ ‘çš„æ€§è´¨ï¼Œèƒ½å¤Ÿåœ¨å‡æ‘Š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(logN)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>â€‹â€‹æ—¶é—´å†…å®Œæˆæ’å…¥ï¼ŒæŸ¥æ‰¾å’Œåˆ é™¤æ“ä½œï¼Œå¹¶ä¸”ä¿æŒå¹³è¡¡è€Œä¸è‡³äºé€€åŒ–ä¸ºé“¾ã€‚</p>\n<p>æ¯æ¬¡æ“ä½œä¹‹åï¼Œè¢«æ“ä½œæ•°å‡åœ¨æ ¹èŠ‚ç‚¹ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">constexpr</span> <span class=\"type\">int</span> N = <span class=\"number\">100005</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> rt, tot, fa[N], ch[N][<span class=\"number\">2</span>], val[N], cnt[N], sz[N];</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">Splay</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">maintain</span><span class=\"params\">(<span class=\"type\">int</span> x)</span> </span>&#123; sz[x] = sz[ch[x][<span class=\"number\">0</span>]] + sz[ch[x][<span class=\"number\">1</span>]] + cnt[x]; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">bool</span> <span class=\"title\">get</span><span class=\"params\">(<span class=\"type\">int</span> x)</span> </span>&#123; <span class=\"keyword\">return</span> x == ch[fa[x]][<span class=\"number\">1</span>]; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">clear</span><span class=\"params\">(<span class=\"type\">int</span> x)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        ch[x][<span class=\"number\">0</span>] = ch[x][<span class=\"number\">1</span>] = fa[x] = val[x] = sz[x] = cnt[x] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">rotate</span><span class=\"params\">(<span class=\"type\">int</span> x)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> y = fa[x], z = fa[y], chk = <span class=\"built_in\">get</span>(x);</span><br><span class=\"line\">        ch[y][chk] = ch[x][chk ^ <span class=\"number\">1</span>];</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (ch[x][chk ^ <span class=\"number\">1</span>])</span><br><span class=\"line\">            fa[ch[x][chk ^ <span class=\"number\">1</span>]] = y;</span><br><span class=\"line\">        ch[x][chk ^ <span class=\"number\">1</span>] = y;</span><br><span class=\"line\">        fa[y] = x;</span><br><span class=\"line\">        fa[x] = z;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (z)</span><br><span class=\"line\">            ch[z][y == ch[z][<span class=\"number\">1</span>]] = x;</span><br><span class=\"line\">        <span class=\"built_in\">maintain</span>(y);</span><br><span class=\"line\">        <span class=\"built_in\">maintain</span>(x);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">splay</span><span class=\"params\">(<span class=\"type\">int</span> x, <span class=\"type\">int</span> goal = <span class=\"number\">0</span>)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (goal == <span class=\"number\">0</span>)</span><br><span class=\"line\">            rt = x;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (fa[x] != goal)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> f = fa[x], g = fa[fa[x]];</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (g != goal)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (<span class=\"built_in\">get</span>(f) == <span class=\"built_in\">get</span>(x))</span><br><span class=\"line\">                    <span class=\"built_in\">rotate</span>(f);</span><br><span class=\"line\">                <span class=\"keyword\">else</span></span><br><span class=\"line\">                    <span class=\"built_in\">rotate</span>(x);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"built_in\">rotate</span>(x);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">ins</span><span class=\"params\">(<span class=\"type\">int</span> k)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!rt)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            val[++tot] = k;</span><br><span class=\"line\">            cnt[tot]++;</span><br><span class=\"line\">            rt = tot;</span><br><span class=\"line\">            <span class=\"built_in\">maintain</span>(rt);</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">int</span> cur = rt, f = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"number\">1</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (val[cur] == k)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                cnt[cur]++;</span><br><span class=\"line\">                <span class=\"built_in\">maintain</span>(cur);</span><br><span class=\"line\">                <span class=\"built_in\">maintain</span>(f);</span><br><span class=\"line\">                <span class=\"built_in\">splay</span>(cur);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            f = cur;</span><br><span class=\"line\">            cur = ch[cur][val[cur] &lt; k];</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!cur)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                val[++tot] = k;</span><br><span class=\"line\">                cnt[tot]++;</span><br><span class=\"line\">                fa[tot] = f;</span><br><span class=\"line\">                ch[f][val[f] &lt; k] = tot;</span><br><span class=\"line\">                <span class=\"built_in\">maintain</span>(tot);</span><br><span class=\"line\">                <span class=\"built_in\">maintain</span>(f);</span><br><span class=\"line\">                <span class=\"built_in\">splay</span>(tot);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">rk</span><span class=\"params\">(<span class=\"type\">int</span> k)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> res = <span class=\"number\">0</span>, cur = rt;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"number\">1</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (k &lt; val[cur])</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                cur = ch[cur][<span class=\"number\">0</span>];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                res += sz[ch[cur][<span class=\"number\">0</span>]];</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (!cur)</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> res + <span class=\"number\">1</span>;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (k == val[cur])</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"built_in\">splay</span>(cur);</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> res + <span class=\"number\">1</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                res += cnt[cur];</span><br><span class=\"line\">                cur = ch[cur][<span class=\"number\">1</span>];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">kth</span><span class=\"params\">(<span class=\"type\">int</span> k)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> cur = rt;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"number\">1</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (ch[cur][<span class=\"number\">0</span>] &amp;&amp; k &lt;= sz[ch[cur][<span class=\"number\">0</span>]])</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                cur = ch[cur][<span class=\"number\">0</span>];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                k -= cnt[cur] + sz[ch[cur][<span class=\"number\">0</span>]];</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (k &lt;= <span class=\"number\">0</span>)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"built_in\">splay</span>(cur);</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> val[cur];</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                cur = ch[cur][<span class=\"number\">1</span>];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// è¿”å›å‰é©±ç»“ç‚¹æ ¹ç¼–å·</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">pre</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> cur = ch[rt][<span class=\"number\">0</span>];</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!cur)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> cur;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (ch[cur][<span class=\"number\">1</span>])</span><br><span class=\"line\">            cur = ch[cur][<span class=\"number\">1</span>];</span><br><span class=\"line\">        <span class=\"built_in\">splay</span>(cur);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> cur;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// è¿”å›åç»§ç»“ç‚¹æ ¹ç¼–å·</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">nxt</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> cur = ch[rt][<span class=\"number\">1</span>];</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!cur)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> cur;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (ch[cur][<span class=\"number\">0</span>])</span><br><span class=\"line\">            cur = ch[cur][<span class=\"number\">0</span>];</span><br><span class=\"line\">        <span class=\"built_in\">splay</span>(cur);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> cur;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">del</span><span class=\"params\">(<span class=\"type\">int</span> k)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">rk</span>(k);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (cnt[rt] &gt; <span class=\"number\">1</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            cnt[rt]--;</span><br><span class=\"line\">            <span class=\"built_in\">maintain</span>(rt);</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!ch[rt][<span class=\"number\">0</span>] &amp;&amp; !ch[rt][<span class=\"number\">1</span>])</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"built_in\">clear</span>(rt);</span><br><span class=\"line\">            rt = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!ch[rt][<span class=\"number\">0</span>])</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> cur = rt;</span><br><span class=\"line\">            rt = ch[rt][<span class=\"number\">1</span>];</span><br><span class=\"line\">            fa[rt] = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"built_in\">clear</span>(cur);</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!ch[rt][<span class=\"number\">1</span>])</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> cur = rt;</span><br><span class=\"line\">            rt = ch[rt][<span class=\"number\">0</span>];</span><br><span class=\"line\">            fa[rt] = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"built_in\">clear</span>(cur);</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">int</span> cur = rt;</span><br><span class=\"line\">        <span class=\"type\">int</span> x = <span class=\"built_in\">pre</span>();</span><br><span class=\"line\">        fa[ch[cur][<span class=\"number\">1</span>]] = x;</span><br><span class=\"line\">        ch[x][<span class=\"number\">1</span>] = ch[cur][<span class=\"number\">1</span>];</span><br><span class=\"line\">        <span class=\"built_in\">clear</span>(cur);</span><br><span class=\"line\">        <span class=\"built_in\">maintain</span>(rt);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; tree;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n, opt, x;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;n); n; --n)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d&quot;</span>, &amp;opt, &amp;x);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (opt == <span class=\"number\">1</span>)</span><br><span class=\"line\">            tree.<span class=\"built_in\">ins</span>(x);</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (opt == <span class=\"number\">2</span>)</span><br><span class=\"line\">            tree.<span class=\"built_in\">del</span>(x);</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (opt == <span class=\"number\">3</span>)</span><br><span class=\"line\">            <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d\\n&quot;</span>, tree.<span class=\"built_in\">rk</span>(x));</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (opt == <span class=\"number\">4</span>)</span><br><span class=\"line\">            <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d\\n&quot;</span>, tree.<span class=\"built_in\">kth</span>(x));</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (opt == <span class=\"number\">5</span>)</span><br><span class=\"line\">            tree.<span class=\"built_in\">ins</span>(x), <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d\\n&quot;</span>, val[tree.<span class=\"built_in\">pre</span>()]), tree.<span class=\"built_in\">del</span>(x);</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">            tree.<span class=\"built_in\">ins</span>(x), <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d\\n&quot;</span>, val[tree.<span class=\"built_in\">nxt</span>()]), tree.<span class=\"built_in\">del</span>(x);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"6-2-æ–‡è‰ºå¹³è¡¡æ ‘\">6.2 æ–‡è‰ºå¹³è¡¡æ ‘</h3>\n<p>æ–‡è‰ºå¹³è¡¡æ ‘ï¼ŒæŒ‡å€ŸåŠ©å¹³è¡¡æ ‘ä¸­åºéå†æ˜¯ä»å°åˆ°å¤§çš„æ€§è´¨å°†å…¶ç•¥ä½œä¿®æ”¹ï¼Œç”¨äº<em><strong>ç»´æŠ¤é«˜çº§åŒºé—´æ“ä½œ</strong></em>è¡Œä¸ºï¼ˆä¾‹å¦‚ï¼Œ<em><strong>ç»´æŠ¤åŒºé—´ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[l,r]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">]</span></span></span></span>â€‹ ç¿»è½¬</strong></em>ï¼‰ï¼Œä¸æ”¯æŒä¸€åˆ‡ä¼ ç»Ÿå¹³è¡¡æ ‘æ“ä½œã€‚</p>\n<p>è¯·å†™ä¸€ä¸ªç¨‹åºï¼Œè¦æ±‚ç»´æŠ¤ä¸€ä¸ªæ•°åˆ—ï¼Œæ”¯æŒä»¥ä¸‹ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>6</mn></mrow><annotation encoding=\"application/x-tex\">6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">6</span></span></span></span> ç§æ“ä½œï¼š</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">ç¼–å·</th>\n<th style=\"text-align:center\">åç§°</th>\n<th style=\"text-align:center\">æ ¼å¼</th>\n<th style=\"text-align:left\">è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">1</td>\n<td style=\"text-align:center\">æ’å…¥</td>\n<td style=\"text-align:center\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">INSERT</mi><mo>â¡</mo><mtext>Â </mtext><mi>p</mi><mi>o</mi><mi>s</mi><mi>i</mi><mtext>Â </mtext><mi>t</mi><mi>o</mi><mi>t</mi><mtext>Â </mtext><msub><mi>c</mi><mn>1</mn></msub><mtext>Â </mtext><msub><mi>c</mi><mn>2</mn></msub><mo>â‹¯</mo><msub><mi>c</mi><mrow><mi>t</mi><mi>o</mi><mi>t</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\operatorname{INSERT}\\ posi \\ tot \\ c_1 \\ c_2 \\cdots c_{tot}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mop\"><span class=\"mord mathrm\">INSERT</span></span><span class=\"mspace\">Â </span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">os</span><span class=\"mord mathnormal\">i</span><span class=\"mspace\">Â </span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\">Â </span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\">Â </span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></td>\n<td style=\"text-align:left\">åœ¨å½“å‰æ•°åˆ—çš„ç¬¬ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mi>o</mi><mi>s</mi><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">posi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">os</span><span class=\"mord mathnormal\">i</span></span></span></span> ä¸ªæ•°å­—åæ’å…¥ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mi>o</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">tot</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">t</span></span></span></span> ä¸ªæ•°å­—ï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>c</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>c</mi><mn>2</mn></msub><mo>â‹¯</mo><msub><mi>c</mi><mrow><mi>t</mi><mi>o</mi><mi>t</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">c_1, c_2 \\cdots c_{tot}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼›è‹¥åœ¨æ•°åˆ—é¦–æ’å…¥ï¼Œåˆ™ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mi>o</mi><mi>s</mi><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">posi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">os</span><span class=\"mord mathnormal\">i</span></span></span></span> ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">2</td>\n<td style=\"text-align:center\">åˆ é™¤</td>\n<td style=\"text-align:center\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">DELETE</mi><mo>â¡</mo><mtext>Â </mtext><mi>p</mi><mi>o</mi><mi>s</mi><mi>i</mi><mtext>Â </mtext><mi>t</mi><mi>o</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">\\operatorname{DELETE} \\ posi \\ tot</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mop\"><span class=\"mord mathrm\">DELETE</span></span><span class=\"mspace\">Â </span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">os</span><span class=\"mord mathnormal\">i</span><span class=\"mspace\">Â </span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">t</span></span></span></span></td>\n<td style=\"text-align:left\">ä»å½“å‰æ•°åˆ—çš„ç¬¬ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mi>o</mi><mi>s</mi><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">posi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">os</span><span class=\"mord mathnormal\">i</span></span></span></span> ä¸ªæ•°å­—å¼€å§‹è¿ç»­åˆ é™¤ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mi>o</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">tot</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">t</span></span></span></span> ä¸ªæ•°å­—</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">3</td>\n<td style=\"text-align:center\">ä¿®æ”¹</td>\n<td style=\"text-align:center\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">MAKE-SAME</mi><mo>â¡</mo><mtext>Â </mtext><mi>p</mi><mi>o</mi><mi>s</mi><mi>i</mi><mtext>Â </mtext><mi>t</mi><mi>o</mi><mi>t</mi><mtext>Â </mtext><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">\\operatorname{MAKE-SAME} \\ posi \\ tot \\ c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mop\"><span class=\"mord mathrm\">MAKE-SAME</span></span><span class=\"mspace\">Â </span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">os</span><span class=\"mord mathnormal\">i</span><span class=\"mspace\">Â </span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\">Â </span><span class=\"mord mathnormal\">c</span></span></span></span></td>\n<td style=\"text-align:left\">ä»å½“å‰æ•°åˆ—çš„ç¬¬ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mi>o</mi><mi>s</mi><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">posi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">os</span><span class=\"mord mathnormal\">i</span></span></span></span> ä¸ªæ•°å­—å¼€å§‹çš„è¿ç»­ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mi>o</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">tot</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">t</span></span></span></span> ä¸ªæ•°å­—ç»Ÿä¸€ä¿®æ”¹ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span></span></span></span></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">4</td>\n<td style=\"text-align:center\">ç¿»è½¬</td>\n<td style=\"text-align:center\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">REVERSE</mi><mo>â¡</mo><mtext>Â </mtext><mi>p</mi><mi>o</mi><mi>s</mi><mi>i</mi><mtext>Â </mtext><mi>t</mi><mi>o</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">\\operatorname{REVERSE} \\ posi \\ tot</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mop\"><span class=\"mord mathrm\">REVERSE</span></span><span class=\"mspace\">Â </span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">os</span><span class=\"mord mathnormal\">i</span><span class=\"mspace\">Â </span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">t</span></span></span></span></td>\n<td style=\"text-align:left\">å–å‡ºä»å½“å‰æ•°åˆ—çš„ç¬¬ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mi>o</mi><mi>s</mi><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">posi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">os</span><span class=\"mord mathnormal\">i</span></span></span></span> ä¸ªæ•°å­—å¼€å§‹çš„ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mi>o</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">tot</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">t</span></span></span></span> ä¸ªæ•°å­—ï¼Œç¿»è½¬åæ”¾å…¥åŸæ¥çš„ä½ç½®</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">5</td>\n<td style=\"text-align:center\">æ±‚å’Œ</td>\n<td style=\"text-align:center\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">GET-SUM</mi><mo>â¡</mo><mtext>Â </mtext><mi>p</mi><mi>o</mi><mi>s</mi><mi>i</mi><mtext>Â </mtext><mi>t</mi><mi>o</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">\\operatorname{GET-SUM} \\ posi \\ tot</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mop\"><span class=\"mord mathrm\">GET-SUM</span></span><span class=\"mspace\">Â </span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">os</span><span class=\"mord mathnormal\">i</span><span class=\"mspace\">Â </span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">t</span></span></span></span></td>\n<td style=\"text-align:left\">è®¡ç®—ä»å½“å‰æ•°åˆ—çš„ç¬¬ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mi>o</mi><mi>s</mi><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">posi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">os</span><span class=\"mord mathnormal\">i</span></span></span></span> ä¸ªæ•°å­—å¼€å§‹çš„ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mi>o</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">tot</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">t</span></span></span></span> ä¸ªæ•°å­—çš„å’Œå¹¶è¾“å‡º</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">6</td>\n<td style=\"text-align:center\">æ±‚æœ€å¤§å­åˆ—å’Œ</td>\n<td style=\"text-align:center\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">MAX-SUM</mi><mo>â¡</mo></mrow><annotation encoding=\"application/x-tex\">\\operatorname{MAX-SUM}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mop\"><span class=\"mord mathrm\">MAX-SUM</span></span></span></span></span></td>\n<td style=\"text-align:left\">æ±‚å‡ºå½“å‰æ•°åˆ—ä¸­å’Œæœ€å¤§çš„ä¸€æ®µå­åˆ—ï¼Œå¹¶è¾“å‡ºæœ€å¤§å’Œ</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li>å¯¹äº <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>100</mn><mi mathvariant=\"normal\">%</mi></mrow><annotation encoding=\"application/x-tex\">100\\%</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8056em;vertical-align:-0.0556em;\"></span><span class=\"mord\">100%</span></span></span></span> çš„æ•°æ®ï¼Œä»»ä½•æ—¶åˆ»æ•°åˆ—ä¸­æœ€å¤šå«æœ‰ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>5</mn><mo>Ã—</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding=\"application/x-tex\">5 \\times 10^5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">5</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span></span></span></span></span></span></span></span> ä¸ªæ•°ï¼Œä»»ä½•æ—¶åˆ»æ•°åˆ—ä¸­ä»»ä½•ä¸€ä¸ªæ•°å­—å‡åœ¨ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mo>âˆ’</mo><mn>1</mn><msup><mn>0</mn><mn>3</mn></msup><mo separator=\"true\">,</mo><mn>1</mn><msup><mn>0</mn><mn>3</mn></msup><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[-10^3, 10^3]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">âˆ’</span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span> å†…ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>M</mi><mo>â‰¤</mo><mn>2</mn><mo>Ã—</mo><mn>1</mn><msup><mn>0</mn><mn>4</mn></msup></mrow><annotation encoding=\"application/x-tex\">1 \\le M \\le 2 \\times 10^4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8193em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span></span></span></span></span></span></span></span>ï¼Œæ’å…¥çš„æ•°å­—æ€»æ•°ä¸è¶…è¿‡ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn><mo>Ã—</mo><mn>1</mn><msup><mn>0</mn><mn>6</mn></msup></mrow><annotation encoding=\"application/x-tex\">4 \\times 10^6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">6</span></span></span></span></span></span></span></span></span></span></span>ã€‚</li>\n</ul>\n<h4 id=\"6-2-1-æ— æ—‹Treapå®ç°æ–‡è‰ºå¹³è¡¡æ ‘\">6.2.1 æ— æ—‹Treapå®ç°æ–‡è‰ºå¹³è¡¡æ ‘</h4>\n<p>æ‡’æ ‡è®°å’Œçº¿æ®µæ ‘çš„æƒ³æ³•ä¸€æ ·ï¼Œè¿™æ ·å¤„ç†ä¸å®¹æ˜“é”™ã€‚</p>\n<p>åˆ†è£‚è¦æŒ‰<code>size</code>ï¼Œäº¤æ¢æ˜¯æ•´ä¸ªå­æ ‘å†…çš„æ‰€æœ‰èŠ‚ç‚¹çš„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mi>s</mi><mi>o</mi><mi>n</mi><mo separator=\"true\">,</mo><mi>r</mi><mi>s</mi><mi>o</mi><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">lson,rson</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">so</span><span class=\"mord mathnormal\">n</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">rso</span><span class=\"mord mathnormal\">n</span></span></span></span>â€‹å…¨éƒ¨äº¤æ¢ï¼Œæ‰€ä»¥éœ€è¦æ‡’æ ‡è®°ã€‚äº¤æ¢å„¿å­å¹¶ä¸ä¼šå½±å“å †çš„æ€§è´¨ï¼Œæ‰€ä»¥ä¸éœ€è¦ç®¡ã€‚</p>\n<p>æ›´å¤æ‚çš„æ‡’æ ‡è®°ä¸€å®šè¦ææ¸…æ¥šã€‚æä¸æ¸…æ¥šæ‡’æ ‡è®°æå…¶å®¹æ˜“é”™ä¸”ç›¸å½“éš¾ä»¥è°ƒè¯•ï¼ˆå› ä¸ºæ ‘ç»“æ„çš„éšæœºæ€§ï¼‰</p>\n<p>è¿™ä¸ªé¢˜æ ‡è®°çš„å‘ç‚¹å°±åœ¨äºå­æ®µé•¿åº¦éç©ºï¼Œå…¨è´Ÿæ•°å°±è¦è¾“å‡ºæœ€å¤§çš„é‚£ä¸ªè´Ÿæ•°ã€‚æ‰€ä»¥ç»´æŠ¤åŒºé—´ä¸­å€¼ï¼ˆåŒºé—´æœ€å¤§å­æ®µï¼‰çš„æ—¶å€™éœ€è¦é¢å¤–å¸¦ä¸€æ¬¡<code>tree[rt].val</code>ï¼Œè¯¦æƒ…è§æ‡’æ ‡è®°ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\">random_device rd;</span><br><span class=\"line\"><span class=\"function\">mt19937 <span class=\"title\">ran</span><span class=\"params\">(rd())</span></span>;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> int long long</span></span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">Treap</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">struct</span> <span class=\"title class_\">node</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> l, r;</span><br><span class=\"line\">        <span class=\"type\">int</span> w;</span><br><span class=\"line\">        <span class=\"type\">int</span> val;</span><br><span class=\"line\">        <span class=\"type\">int</span> sz;</span><br><span class=\"line\">        <span class=\"type\">int</span> lazytag;</span><br><span class=\"line\">        <span class=\"type\">int</span> sum;</span><br><span class=\"line\">        <span class=\"type\">int</span> maxsum;</span><br><span class=\"line\">        <span class=\"type\">int</span> maxpresum;</span><br><span class=\"line\">        <span class=\"type\">int</span> maxsufsum;</span><br><span class=\"line\">        <span class=\"type\">bool</span> sametag;</span><br><span class=\"line\">        <span class=\"type\">int</span> sames;</span><br><span class=\"line\">        <span class=\"built_in\">node</span>() : <span class=\"built_in\">l</span>(<span class=\"number\">0</span>), <span class=\"built_in\">r</span>(<span class=\"number\">0</span>), <span class=\"built_in\">w</span>(<span class=\"number\">0</span>), <span class=\"built_in\">val</span>(<span class=\"number\">0</span>),</span><br><span class=\"line\">                 <span class=\"built_in\">sz</span>(<span class=\"number\">0</span>), <span class=\"built_in\">lazytag</span>(<span class=\"number\">0</span>), <span class=\"built_in\">sum</span>(<span class=\"number\">0</span>), <span class=\"built_in\">maxpresum</span>(<span class=\"number\">0</span>), <span class=\"built_in\">maxsufsum</span>(<span class=\"number\">0</span>),</span><br><span class=\"line\">                 <span class=\"built_in\">sametag</span>(<span class=\"number\">0</span>), <span class=\"built_in\">sames</span>(<span class=\"number\">0</span>), <span class=\"built_in\">maxsum</span>(<span class=\"number\">0</span>) &#123;&#125;;</span><br><span class=\"line\">        <span class=\"built_in\">node</span>(<span class=\"type\">int</span> val) : <span class=\"built_in\">l</span>(<span class=\"number\">0</span>), <span class=\"built_in\">r</span>(<span class=\"number\">0</span>), <span class=\"built_in\">w</span>(<span class=\"built_in\">ran</span>()), <span class=\"built_in\">val</span>(val),</span><br><span class=\"line\">                        <span class=\"built_in\">sz</span>(<span class=\"number\">1</span>), <span class=\"built_in\">lazytag</span>(<span class=\"number\">0</span>), <span class=\"built_in\">sum</span>(val), <span class=\"built_in\">maxpresum</span>(<span class=\"built_in\">max</span>(val, <span class=\"number\">0ll</span>)),</span><br><span class=\"line\">                        <span class=\"built_in\">maxsufsum</span>(<span class=\"built_in\">max</span>(val, <span class=\"number\">0ll</span>)), <span class=\"built_in\">sametag</span>(<span class=\"number\">0</span>), <span class=\"built_in\">sames</span>(<span class=\"number\">0</span>), <span class=\"built_in\">maxsum</span>(val) &#123;&#125;;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"type\">const</span> <span class=\"type\">static</span> <span class=\"type\">int</span> maxn = <span class=\"number\">5e5</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\">    node tree[maxn];</span><br><span class=\"line\">    <span class=\"type\">int</span> root;</span><br><span class=\"line\">    queue&lt;<span class=\"type\">int</span>&gt; q;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">void</span> <span class=\"title\">init</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt; maxn; i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            q.<span class=\"built_in\">push</span>(i);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">Treap</span>() &#123; <span class=\"built_in\">init</span>(); &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">newnode</span><span class=\"params\">(<span class=\"type\">int</span> val)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> tot = q.<span class=\"built_in\">front</span>();</span><br><span class=\"line\">        q.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">        tree[tot] = <span class=\"built_in\">node</span>(val);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> tot;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">getrub</span><span class=\"params\">(<span class=\"type\">int</span> rt)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!rt)</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        <span class=\"built_in\">getrub</span>(tree[rt].l);</span><br><span class=\"line\">        <span class=\"built_in\">getrub</span>(tree[rt].r);</span><br><span class=\"line\">        q.<span class=\"built_in\">push</span>(rt);</span><br><span class=\"line\">        tree[rt] = <span class=\"built_in\">node</span>();</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">pushup</span><span class=\"params\">(<span class=\"type\">int</span> rt)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        tree[rt].sz = tree[tree[rt].l].sz + tree[tree[rt].r].sz + <span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        tree[rt].sum = tree[tree[rt].l].sum + tree[tree[rt].r].sum + tree[rt].val;</span><br><span class=\"line\"></span><br><span class=\"line\">        tree[rt].maxpresum = <span class=\"built_in\">max</span>(tree[tree[rt].l].maxpresum, tree[tree[rt].l].sum + tree[rt].val + tree[tree[rt].r].maxpresum);</span><br><span class=\"line\"></span><br><span class=\"line\">        tree[rt].maxsufsum = <span class=\"built_in\">max</span>(tree[tree[rt].r].maxsufsum, tree[tree[rt].r].sum + tree[rt].val + tree[tree[rt].l].maxsufsum);</span><br><span class=\"line\"></span><br><span class=\"line\">        tree[rt].maxsum = <span class=\"built_in\">max</span>(tree[rt].val, tree[tree[rt].l].maxsufsum + tree[rt].val + tree[tree[rt].r].maxpresum);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tree[rt].l)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            tree[rt].maxsum = <span class=\"built_in\">max</span>(tree[rt].maxsum, tree[tree[rt].l].maxsum);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tree[rt].r)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            tree[rt].maxsum = <span class=\"built_in\">max</span>(tree[rt].maxsum, tree[tree[rt].r].maxsum);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">Reverse</span><span class=\"params\">(<span class=\"type\">int</span> x)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!x)</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        <span class=\"built_in\">swap</span>(tree[x].l, tree[x].r);</span><br><span class=\"line\">        <span class=\"built_in\">swap</span>(tree[x].maxpresum, tree[x].maxsufsum);</span><br><span class=\"line\">        tree[x].lazytag ^= <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">Cover</span><span class=\"params\">(<span class=\"type\">int</span> rt, <span class=\"type\">int</span> ci)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        tree[rt].val = tree[rt].sames = ci;</span><br><span class=\"line\">        tree[rt].sum = tree[rt].sz * ci;</span><br><span class=\"line\">        tree[rt].maxpresum = tree[rt].maxsufsum = <span class=\"built_in\">max</span>(<span class=\"number\">0ll</span>, tree[rt].sum);</span><br><span class=\"line\">        tree[rt].maxsum = <span class=\"built_in\">max</span>(ci, tree[rt].sum);</span><br><span class=\"line\">        tree[rt].sametag = <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">pushdown</span><span class=\"params\">(<span class=\"type\">int</span> rt)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!rt)</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tree[rt].lazytag)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (tree[rt].l)</span><br><span class=\"line\">                <span class=\"built_in\">Reverse</span>(tree[rt].l);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (tree[rt].r)</span><br><span class=\"line\">                <span class=\"built_in\">Reverse</span>(tree[rt].r);</span><br><span class=\"line\">            tree[rt].lazytag = <span class=\"number\">0</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tree[rt].sametag)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (tree[rt].l)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"built_in\">Cover</span>(tree[rt].l, tree[rt].sames);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (tree[rt].r)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"built_in\">Cover</span>(tree[rt].r, tree[rt].sames);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            tree[rt].sametag = <span class=\"number\">0</span>;</span><br><span class=\"line\">            tree[rt].sames = <span class=\"number\">0</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">split_sz</span><span class=\"params\">(<span class=\"type\">const</span> <span class=\"type\">int</span> rt, <span class=\"type\">int</span> &amp;l, <span class=\"type\">int</span> &amp;r, <span class=\"type\">int</span> sz)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!rt)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            l = r = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">pushdown</span>(rt);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tree[tree[rt].l].sz + <span class=\"number\">1</span> &lt;= sz)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            l = rt;</span><br><span class=\"line\">            <span class=\"built_in\">split_sz</span>(tree[rt].r, tree[rt].r, r, sz - (tree[tree[rt].l].sz + <span class=\"number\">1</span>));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            r = rt;</span><br><span class=\"line\">            <span class=\"built_in\">split_sz</span>(tree[rt].l, l, tree[rt].l, sz);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">pushup</span>(rt);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">merge</span><span class=\"params\">(<span class=\"type\">int</span> &amp;rt, <span class=\"type\">const</span> <span class=\"type\">int</span> l, <span class=\"type\">const</span> <span class=\"type\">int</span> r)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!l || !r)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            rt = l | r;</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">pushdown</span>(l);</span><br><span class=\"line\">        <span class=\"built_in\">pushdown</span>(r);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tree[l].w &gt; tree[r].w) <span class=\"comment\">// å¤§æ ¹å †å½¢å¼ï¼Œå°æ ¹å †æ¢ä¸ªå·å°±è¡Œ</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            rt = l;</span><br><span class=\"line\">            <span class=\"built_in\">merge</span>(tree[rt].r, tree[rt].r, r);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            rt = r;</span><br><span class=\"line\">            <span class=\"built_in\">merge</span>(tree[rt].l, l, tree[rt].l);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">pushup</span>(rt);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">insert</span><span class=\"params\">(<span class=\"type\">int</span> pos, vector&lt;<span class=\"type\">int</span>&gt; &amp;a)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> rt1, rt2;</span><br><span class=\"line\">        <span class=\"built_in\">split_sz</span>(root, rt1, rt2, pos);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> j : a)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"built_in\">merge</span>(rt1, rt1, <span class=\"built_in\">newnode</span>(j));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">merge</span>(root, rt1, rt2);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">del</span><span class=\"params\">(<span class=\"type\">int</span> pos, <span class=\"type\">int</span> tot)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> rt1, rt2, rt3;</span><br><span class=\"line\">        <span class=\"built_in\">split_sz</span>(root, rt1, rt3, pos + tot - <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"built_in\">split_sz</span>(rt1, rt1, rt2, pos - <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"built_in\">getrub</span>(rt2);</span><br><span class=\"line\">        <span class=\"built_in\">merge</span>(root, rt1, rt3);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">reverse</span><span class=\"params\">(<span class=\"type\">int</span> l, <span class=\"type\">int</span> tot)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> rt1, rt2, rt3;</span><br><span class=\"line\">        <span class=\"built_in\">split_sz</span>(root, rt2, rt3, l + tot - <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"built_in\">split_sz</span>(rt2, rt1, rt2, l - <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"built_in\">Reverse</span>(rt2);</span><br><span class=\"line\">        <span class=\"built_in\">merge</span>(rt2, rt1, rt2);</span><br><span class=\"line\">        <span class=\"built_in\">merge</span>(root, rt2, rt3);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">getsum</span><span class=\"params\">(<span class=\"type\">int</span> pos, <span class=\"type\">int</span> tot)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> rt1, rt2, rt3;</span><br><span class=\"line\">        <span class=\"built_in\">split_sz</span>(root, rt1, rt3, pos + tot - <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"built_in\">split_sz</span>(rt1, rt1, rt2, pos - <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"type\">int</span> ans = tree[rt2].sum;</span><br><span class=\"line\">        <span class=\"built_in\">merge</span>(rt1, rt1, rt2);</span><br><span class=\"line\">        <span class=\"built_in\">merge</span>(root, rt1, rt3);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">getmaxsum</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> tree[root].maxsum;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">make_same</span><span class=\"params\">(<span class=\"type\">int</span> l, <span class=\"type\">int</span> tot, <span class=\"type\">int</span> c)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> rt1, rt2, rt3;</span><br><span class=\"line\">        <span class=\"built_in\">split_sz</span>(root, rt2, rt3, l + tot - <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"built_in\">split_sz</span>(rt2, rt1, rt2, l - <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"built_in\">Cover</span>(rt2, c);</span><br><span class=\"line\">        <span class=\"built_in\">merge</span>(rt2, rt1, rt2);</span><br><span class=\"line\">        <span class=\"built_in\">merge</span>(root, rt2, rt3);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">print</span><span class=\"params\">(<span class=\"type\">int</span> rt)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!rt)</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        <span class=\"built_in\">pushdown</span>(rt);</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(tree[rt].l);</span><br><span class=\"line\">        cout &lt;&lt; tree[rt].val &lt;&lt; <span class=\"string\">&quot; &quot;</span>;</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(tree[rt].r);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">print</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(root);</span><br><span class=\"line\">        cout &lt;&lt; endl;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">Treap tr;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// freopen(&quot;data.in&quot;, &quot;r&quot;, stdin);</span></span><br><span class=\"line\">    <span class=\"comment\">// freopen(&quot;data.out&quot;, &quot;w&quot;, stdout);</span></span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"type\">int</span> n, m;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class=\"line\">    <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">a</span><span class=\"params\">(n)</span></span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> &amp;i : a)</span><br><span class=\"line\">        cin &gt;&gt; i;</span><br><span class=\"line\">    tr.<span class=\"built_in\">insert</span>(<span class=\"number\">0</span>, a);</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (m--)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        string s;</span><br><span class=\"line\">        cin &gt;&gt; s;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (s == <span class=\"string\">&quot;GET-SUM&quot;</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> pos, cnt;</span><br><span class=\"line\">            cin &gt;&gt; pos &gt;&gt; cnt;</span><br><span class=\"line\">            cout &lt;&lt; tr.<span class=\"built_in\">getsum</span>(pos, cnt) &lt;&lt; endl;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (s == <span class=\"string\">&quot;MAX-SUM&quot;</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            cout &lt;&lt; tr.<span class=\"built_in\">getmaxsum</span>() &lt;&lt; endl;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (s == <span class=\"string\">&quot;INSERT&quot;</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> pos, cnt;</span><br><span class=\"line\">            cin &gt;&gt; pos &gt;&gt; cnt;</span><br><span class=\"line\">            <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">b</span><span class=\"params\">(cnt)</span></span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> &amp;j : b)</span><br><span class=\"line\">                cin &gt;&gt; j;</span><br><span class=\"line\">            tr.<span class=\"built_in\">insert</span>(pos, b);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (s == <span class=\"string\">&quot;DELETE&quot;</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> pos, cnt;</span><br><span class=\"line\">            cin &gt;&gt; pos &gt;&gt; cnt;</span><br><span class=\"line\">            tr.<span class=\"built_in\">del</span>(pos, cnt);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (s == <span class=\"string\">&quot;MAKE-SAME&quot;</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> pos, tot, c;</span><br><span class=\"line\">            cin &gt;&gt; pos &gt;&gt; tot &gt;&gt; c;</span><br><span class=\"line\">            tr.<span class=\"built_in\">make_same</span>(pos, tot, c);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> pos, tot;</span><br><span class=\"line\">            cin &gt;&gt; pos &gt;&gt; tot;</span><br><span class=\"line\">            tr.<span class=\"built_in\">reverse</span>(pos, tot);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// tr.print();</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"6-3-å¯æŒä¹…åŒ–å¹³è¡¡æ ‘\">6.3 å¯æŒä¹…åŒ–å¹³è¡¡æ ‘</h3>\n<p>å¦‚é¢˜ï¼Œå¯æŒä¹…åŒ–æ•°æ®ç»“æ„ã€‚</p>\n<p>éœ€è¦æ³¨æ„ä¸€ç‚¹ï¼Œå¹³è¡¡æ ‘å¯æŒä¹…åŒ–æ¶ˆè€—æ— ç”¨å†…å­˜æ›´å¤§ï¼Œå»ºè®®ç©ºé—´å€æ•°<code>&lt;&lt;6</code>ä»¥ä¸Š</p>\n<h4 id=\"6-3-1-å¯æŒä¹…åŒ–æ— æ—‹Treap\">6.3.1 å¯æŒä¹…åŒ–æ— æ—‹Treap</h4>\n<p>å’Œéå¯æŒä¹…åŒ–æ— æ—‹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi><mi>r</mi><mi>e</mi><mi>a</mi><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">Treap</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathnormal\">re</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">p</span></span></span></span>â€‹â€‹å‡ ä¹æ²¡æœ‰åŒºåˆ«ï¼Œå°ç®€å•çš„å·®å¼‚å‡ºåœ¨<code>merge</code>å’Œ<code>split_val</code>å‡½æ•°ä¸Šï¼Œæ¯æ¬¡è¦åˆ†è£‚æˆ–è€…è¦åˆå¹¶çš„æ—¶å€™éƒ½å¿…é¡»æ–°å¼€ç»“ç‚¹ï¼Œå°†å¤åˆ¶ä¸€ä»½æ—§ç»“ç‚¹ï¼Œä»¥ä¿è¯åŸå…ˆç‰ˆæœ¬ä¸è¢«ç ´åã€‚</p>\n<p>ç”¨äºè§£å†³éœ€è¦æä¾›ä»¥ä¸‹æ“ä½œçš„æ•°æ®ç»“æ„ï¼ˆ <strong>å¯¹äºå„ä¸ªä»¥å¾€çš„å†å²ç‰ˆæœ¬</strong> ï¼‰ï¼š</p>\n<p>1ã€ æ’å…¥ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span></p>\n<p>2ã€ åˆ é™¤ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>ï¼ˆè‹¥æœ‰å¤šä¸ªç›¸åŒçš„æ•°ï¼Œåº”åªåˆ é™¤ä¸€ä¸ªï¼Œ<strong>å¦‚æœæ²¡æœ‰è¯·å¿½ç•¥è¯¥æ“ä½œ</strong>ï¼‰</p>\n<p>3ã€ æŸ¥è¯¢ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> çš„æ’åï¼ˆæ’åå®šä¹‰ä¸ºæ¯”å½“å‰æ•°å°çš„æ•°çš„ä¸ªæ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">+</span><span class=\"mord\">1</span></span></span></span>ï¼‰</p>\n<p>4ã€æŸ¥è¯¢æ’åä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> çš„æ•°</p>\n<p>5ã€ æ±‚ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> çš„å‰é©±ï¼ˆå‰é©±å®šä¹‰ä¸ºå°äº <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>ï¼Œä¸”æœ€å¤§çš„æ•°ï¼Œ<strong>å¦‚ä¸å­˜åœ¨è¾“å‡º</strong> <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>âˆ’</mo><msup><mn>2</mn><mn>31</mn></msup><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">-2^{31}+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8974em;vertical-align:-0.0833em;\"></span><span class=\"mord\">âˆ’</span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">31</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> ï¼‰</p>\n<p>6ã€æ±‚ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> çš„åç»§ï¼ˆåç»§å®šä¹‰ä¸ºå¤§äº <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>ï¼Œä¸”æœ€å°çš„æ•°ï¼Œ<strong>å¦‚ä¸å­˜åœ¨è¾“å‡º</strong> <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mn>31</mn></msup><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">2^{31}-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8974em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">31</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> ï¼‰</p>\n<p><strong>å’ŒåŸæœ¬å¹³è¡¡æ ‘ä¸åŒçš„ä¸€ç‚¹æ˜¯ï¼Œæ¯ä¸€æ¬¡çš„ä»»ä½•æ“ä½œéƒ½æ˜¯åŸºäºæŸä¸€ä¸ªå†å²ç‰ˆæœ¬ï¼ŒåŒæ—¶ç”Ÿæˆä¸€ä¸ªæ–°çš„ç‰ˆæœ¬ã€‚ï¼ˆæ“ä½œ3, 4, 5, 6å³ä¿æŒåŸç‰ˆæœ¬æ— å˜åŒ–ï¼‰</strong></p>\n<p>æ¯ä¸ªç‰ˆæœ¬çš„ç¼–å·å³ä¸ºæ“ä½œçš„åºå·ï¼ˆç‰ˆæœ¬<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>å³ä¸ºåˆå§‹çŠ¶æ€ï¼Œç©ºæ ‘ï¼‰<br>\nå¯¹äº <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>100</mn><mi mathvariant=\"normal\">%</mi></mrow><annotation encoding=\"application/x-tex\">100\\%</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8056em;vertical-align:-0.0556em;\"></span><span class=\"mord\">100%</span></span></span></span> çš„æ•°æ®ï¼Œ $ 1 \\leq n \\leq 5 \\times  10^5 $ , <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">âˆ£</mi><msub><mi>x</mi><mi>i</mi></msub><mi mathvariant=\"normal\">âˆ£</mi><mo>â‰¤</mo><msup><mn>10</mn><mn>9</mn></msup></mrow><annotation encoding=\"application/x-tex\">|x_i| \\leq {10}^9</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">âˆ£</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">âˆ£</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8484em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\">10</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8484em;\"><span style=\"top:-3.0973em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">9</span></span></span></span></span></span></span></span></span></span></span>ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mo>â‰¤</mo><msub><mi>v</mi><mi>i</mi></msub><mo>&lt;</mo><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">0 \\le v_i &lt; i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6891em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mtext>opt</mtext><mo>â‰¤</mo><mn>6</mn></mrow><annotation encoding=\"application/x-tex\">1\\le \\text{opt} \\le 6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8304em;vertical-align:-0.1944em;\"></span><span class=\"mord text\"><span class=\"mord\">opt</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">6</span></span></span></span>ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\">random_device rd;</span><br><span class=\"line\"><span class=\"function\">mt19937 <span class=\"title\">ran</span><span class=\"params\">(rd())</span></span>;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">Persistant_Treap</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">struct</span> <span class=\"title class_\">node</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> l, r;</span><br><span class=\"line\">        <span class=\"type\">int</span> val;</span><br><span class=\"line\">        <span class=\"type\">int</span> sz;</span><br><span class=\"line\">        <span class=\"type\">int</span> cnt;</span><br><span class=\"line\">        <span class=\"type\">int</span> w;</span><br><span class=\"line\">        <span class=\"built_in\">node</span>() &#123; l = r = val = sz = cnt = w = <span class=\"number\">0</span>; &#125;;</span><br><span class=\"line\">        <span class=\"built_in\">node</span>(<span class=\"type\">int</span> val) : <span class=\"built_in\">l</span>(<span class=\"number\">0</span>), <span class=\"built_in\">r</span>(<span class=\"number\">0</span>), <span class=\"built_in\">val</span>(val), <span class=\"built_in\">sz</span>(<span class=\"number\">1</span>), <span class=\"built_in\">cnt</span>(<span class=\"number\">1</span>), <span class=\"built_in\">w</span>(<span class=\"built_in\">ran</span>()) &#123;&#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"type\">int</span> tot = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"type\">const</span> <span class=\"type\">static</span> <span class=\"type\">int</span> maxn = <span class=\"number\">5e5</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\">    node tree[maxn &lt;&lt; <span class=\"number\">6</span>];</span><br><span class=\"line\">    <span class=\"type\">int</span> vers[maxn];</span><br><span class=\"line\">    <span class=\"type\">int</span> ver = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">newnode</span><span class=\"params\">(<span class=\"type\">int</span> val)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        ++tot;</span><br><span class=\"line\">        tree[tot] = <span class=\"built_in\">node</span>(val);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> tot;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">pushup</span><span class=\"params\">(<span class=\"type\">int</span> rt)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        tree[rt].sz = tree[rt].cnt + tree[tree[rt].l].sz + tree[tree[rt].r].sz;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">merge</span><span class=\"params\">(<span class=\"type\">const</span> <span class=\"type\">int</span> l, <span class=\"type\">const</span> <span class=\"type\">int</span> r)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!l || !r)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> l | r;</span><br><span class=\"line\">        <span class=\"type\">int</span> newrt;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tree[l].w &gt; tree[r].w)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            newrt = ++tot;</span><br><span class=\"line\">            tree[newrt] = tree[l];</span><br><span class=\"line\">            tree[newrt].r = <span class=\"built_in\">merge</span>(tree[newrt].r, r);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            newrt = ++tot;</span><br><span class=\"line\">            tree[newrt] = tree[r];</span><br><span class=\"line\">            tree[newrt].l = <span class=\"built_in\">merge</span>(l, tree[newrt].l);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">pushup</span>(newrt);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> newrt;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">split_val</span><span class=\"params\">(<span class=\"type\">int</span> rt, <span class=\"type\">int</span> &amp;l, <span class=\"type\">int</span> &amp;r, <span class=\"type\">int</span> val)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!rt)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            l = r = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">int</span> newrt;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tree[rt].val &lt;= val)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            l = ++tot;</span><br><span class=\"line\">            tree[l] = tree[rt];</span><br><span class=\"line\">            <span class=\"built_in\">split_val</span>(tree[rt].r, tree[l].r, r, val);</span><br><span class=\"line\">            <span class=\"built_in\">pushup</span>(l);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            r = ++tot;</span><br><span class=\"line\">            tree[r] = tree[rt];</span><br><span class=\"line\">            <span class=\"built_in\">split_val</span>(tree[rt].l, l, tree[r].l, val);</span><br><span class=\"line\">            <span class=\"built_in\">pushup</span>(r);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">void</span> <span class=\"title\">insert</span><span class=\"params\">(<span class=\"type\">int</span> v, <span class=\"type\">int</span> val)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        vers[++ver] = vers[v];</span><br><span class=\"line\">        <span class=\"type\">int</span> rt1, rt2, rt3;</span><br><span class=\"line\">        <span class=\"built_in\">split_val</span>(vers[ver], rt1, rt2, val - <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"built_in\">split_val</span>(rt2, rt2, rt3, val);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!rt2)</span><br><span class=\"line\">            rt2 = <span class=\"built_in\">newnode</span>(val);</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">            tree[rt2].cnt++, tree[rt2].sz++;</span><br><span class=\"line\">        rt2 = <span class=\"built_in\">merge</span>(rt2, rt3);</span><br><span class=\"line\">        vers[ver] = <span class=\"built_in\">merge</span>(rt1, rt2);</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">void</span> <span class=\"title\">del</span><span class=\"params\">(<span class=\"type\">int</span> v, <span class=\"type\">int</span> val)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        vers[++ver] = vers[v];</span><br><span class=\"line\">        <span class=\"type\">int</span> rt1, rt2, rt3;</span><br><span class=\"line\">        <span class=\"built_in\">split_val</span>(vers[ver], rt1, rt2, val);</span><br><span class=\"line\">        <span class=\"built_in\">split_val</span>(rt1, rt1, rt3, val - <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!rt3)</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        tree[rt3].cnt--, tree[rt3].sz--;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!tree[rt3].cnt)</span><br><span class=\"line\">            rt3 = <span class=\"built_in\">merge</span>(tree[rt3].l, tree[rt3].r);</span><br><span class=\"line\">        rt1 = <span class=\"built_in\">merge</span>(rt1, rt3);</span><br><span class=\"line\">        vers[ver] = <span class=\"built_in\">merge</span>(rt1, rt2);</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">int</span> <span class=\"title\">rnk</span><span class=\"params\">(<span class=\"type\">int</span> v, <span class=\"type\">int</span> val)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        vers[++ver] = vers[v];</span><br><span class=\"line\">        <span class=\"type\">int</span> x, y;</span><br><span class=\"line\">        <span class=\"built_in\">split_val</span>(vers[ver], x, y, val - <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"type\">int</span> ans = tree[x].sz + <span class=\"number\">1</span>;</span><br><span class=\"line\">        vers[ver] = <span class=\"built_in\">merge</span>(x, y);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">int</span> <span class=\"title\">kth</span><span class=\"params\">(<span class=\"type\">int</span> v, <span class=\"type\">int</span> k)</span> <span class=\"comment\">// ç‰ˆæœ¬è®¿é—®</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        vers[++ver] = vers[v];</span><br><span class=\"line\">        <span class=\"type\">int</span> x = vers[ver];</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (k &lt;= tree[tree[x].l].sz)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                x = tree[x].l;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (k &gt; tree[tree[x].l].sz + tree[x].cnt)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                k -= (tree[tree[x].l].sz + tree[x].cnt);</span><br><span class=\"line\">                x = tree[x].r;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> tree[x].val;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">inline</span> <span class=\"type\">int</span> _kth(<span class=\"type\">int</span> rt, <span class=\"type\">int</span> k) <span class=\"comment\">// æ ¹è®¿é—®ï¼Œprivate</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> x = rt;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (k &lt;= tree[tree[x].l].sz)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                x = tree[x].l;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (k &gt; tree[tree[x].l].sz + tree[x].cnt)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                k -= (tree[tree[x].l].sz + tree[x].cnt);</span><br><span class=\"line\">                x = tree[x].r;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> tree[x].val;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">int</span> <span class=\"title\">pre</span><span class=\"params\">(<span class=\"type\">int</span> v, <span class=\"type\">int</span> val)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        vers[++ver] = vers[v];</span><br><span class=\"line\">        <span class=\"type\">int</span> x, y;</span><br><span class=\"line\">        <span class=\"built_in\">split_val</span>(vers[ver], x, y, val - <span class=\"number\">1</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">int</span> ans = -(INT_MAX);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (x != <span class=\"number\">0</span>)</span><br><span class=\"line\">            ans = _kth(x, tree[x].sz);</span><br><span class=\"line\">        vers[ver] = <span class=\"built_in\">merge</span>(x, y);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">int</span> <span class=\"title\">suf</span><span class=\"params\">(<span class=\"type\">int</span> v, <span class=\"type\">int</span> val)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        vers[++ver] = vers[v];</span><br><span class=\"line\">        <span class=\"type\">int</span> x, y;</span><br><span class=\"line\">        <span class=\"built_in\">split_val</span>(vers[ver], x, y, val);</span><br><span class=\"line\">        <span class=\"type\">int</span> ans = (INT_MAX);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (y != <span class=\"number\">0</span>)</span><br><span class=\"line\">            ans = _kth(y, <span class=\"number\">1</span>);</span><br><span class=\"line\">        vers[ver] = <span class=\"built_in\">merge</span>(x, y);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">Persistant_Treap tr;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"type\">int</span> n;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (n--)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> v, op, x;</span><br><span class=\"line\">        cin &gt;&gt; v &gt;&gt; op &gt;&gt; x;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (op == <span class=\"number\">1</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            tr.<span class=\"built_in\">insert</span>(v, x);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (op == <span class=\"number\">2</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            tr.<span class=\"built_in\">del</span>(v, x);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (op == <span class=\"number\">3</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            cout &lt;&lt; tr.<span class=\"built_in\">rnk</span>(v, x) &lt;&lt; endl;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (op == <span class=\"number\">4</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            cout &lt;&lt; tr.<span class=\"built_in\">kth</span>(v, x) &lt;&lt; endl;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (op == <span class=\"number\">5</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            cout &lt;&lt; tr.<span class=\"built_in\">pre</span>(v, x) &lt;&lt; endl;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">            cout &lt;&lt; tr.<span class=\"built_in\">suf</span>(v, x) &lt;&lt; endl;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"6-3-2-å¯æŒä¹…åŒ–æ–‡è‰ºå¹³è¡¡æ ‘\">6.3.2 å¯æŒä¹…åŒ–æ–‡è‰ºå¹³è¡¡æ ‘</h4>\n<p>ç†è®ºä¸Šï¼Œæ–‡è‰ºå¹³è¡¡æ ‘å¯ä»¥å¹²äº†çº¿æ®µæ ‘æ‰€èƒ½å¹²çš„æ‰€æœ‰æ´»å„¿ï¼Œä½†æ˜¯å¸¸æ•°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mi>u</mi><mi>p</mi><mi>e</mi><mi>r</mi><mi>B</mi><mi>i</mi><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">SuperBig</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">er</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>ã€‚å…¶å­˜æ´»æ„ä¹‰ä¸»è¦åœ¨äºåŒºé—´ç¿»è½¬ã€‚</p>\n<p>ç»´æŠ¤ä¸€ä¸ªåºåˆ—ï¼Œå…¶ä¸­éœ€è¦æä¾›ä»¥ä¸‹æ“ä½œï¼Œè¦æ±‚å¼ºåˆ¶åœ¨çº¿ï¼ˆ<strong>å¯¹äºå„ä¸ªä»¥å¾€çš„å†å²ç‰ˆæœ¬</strong>ï¼‰ï¼š</p>\n<ol>\n<li>åœ¨ç¬¬ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span></span></span></span> ä¸ªæ•°åæ’å…¥æ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>ã€‚</li>\n<li>åˆ é™¤ç¬¬ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span></span></span></span> ä¸ªæ•°ã€‚</li>\n<li>ç¿»è½¬åŒºé—´ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[l,r]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">]</span></span></span></span>ï¼Œä¾‹å¦‚åŸåºåˆ—æ˜¯ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">{</mo><mn>5</mn><mo separator=\"true\">,</mo><mn>4</mn><mo separator=\"true\">,</mo><mn>3</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">\\{5,4,3,2,1\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\">5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">4</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">3</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">}</span></span></span></span>ï¼Œç¿»è½¬åŒºé—´ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>2</mn><mo separator=\"true\">,</mo><mn>4</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[2,4]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">4</span><span class=\"mclose\">]</span></span></span></span> åï¼Œç»“æœæ˜¯ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">{</mo><mn>5</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mn>3</mn><mo separator=\"true\">,</mo><mn>4</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">\\{5,2,3,4,1\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\">5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">3</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">4</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">}</span></span></span></span>ã€‚</li>\n<li>æŸ¥è¯¢åŒºé—´ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[l,r]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">]</span></span></span></span> ä¸­æ‰€æœ‰æ•°çš„å’Œã€‚</li>\n</ol>\n<p><strong>å’ŒåŸæœ¬å¹³è¡¡æ ‘ä¸åŒçš„ä¸€ç‚¹æ˜¯ï¼Œæ¯ä¸€æ¬¡çš„ä»»ä½•æ“ä½œéƒ½æ˜¯åŸºäºæŸä¸€ä¸ªå†å²ç‰ˆæœ¬ï¼ŒåŒæ—¶ç”Ÿæˆä¸€ä¸ªæ–°çš„ç‰ˆæœ¬ï¼ˆæ“ä½œ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span> å³ä¿æŒåŸç‰ˆæœ¬æ— å˜åŒ–ï¼‰ï¼Œæ–°ç‰ˆæœ¬å³ç¼–å·ä¸ºæ­¤æ¬¡æ“ä½œçš„åºå·ã€‚</strong></p>\n<p>emm,ç›¸å½“è´´å†…å­˜<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mn>979</mn><mi>M</mi><mi>B</mi><mi mathvariant=\"normal\">/</mi><mn>1</mn><mi>G</mi><mi>B</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(979MB/1GB)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">979</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">MB</span><span class=\"mord\">/1</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">GB</span><span class=\"mclose\">)</span></span></span></span>ï¼Œçˆ†<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle mathcolor=\"red\"><mi>M</mi><mi>L</mi><mi>E</mi></mstyle></mrow><annotation encoding=\"application/x-tex\">\\color{red}MLE</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;color:red;\">M</span><span class=\"mord mathnormal\" style=\"color:red;\">L</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;color:red;\">E</span></span></span></span>â€‹å°±çœ‹ç€åŠå§ã€‚</p>\n<p>æ³¨æ„ï¼Œpushdownçš„æ—¶å€™ä¹Ÿè¦æ–°å»ºç«‹æ‹·è´èŠ‚ç‚¹ï¼Œè®°ä½ï¼Œå¯æŒä¹…åŒ–æ•°æ®ç»“æ„ä¸Šåªè¦æ¶‰åŠåˆ°æ”¹å¿…é¡»è¦æ–°å»ºèŠ‚ç‚¹ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\">random_device rd;</span><br><span class=\"line\"><span class=\"function\">mt19937 <span class=\"title\">ran</span><span class=\"params\">(rd())</span></span>;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> i64 long long</span></span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">Persistant_literary_Treap</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"keyword\">private</span>:</span><br><span class=\"line\">    <span class=\"keyword\">struct</span> <span class=\"title class_\">node</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> l, r;</span><br><span class=\"line\">        <span class=\"type\">int</span> w;</span><br><span class=\"line\">        i64 sum;</span><br><span class=\"line\">        i64 val;</span><br><span class=\"line\">        <span class=\"type\">bool</span> lazy;</span><br><span class=\"line\">        <span class=\"type\">int</span> sz;</span><br><span class=\"line\">        <span class=\"built_in\">node</span>() &#123; l = r = w = sum = val = sz = lazy = <span class=\"number\">0</span>; &#125;;</span><br><span class=\"line\">        <span class=\"built_in\">node</span>(i64 val) : <span class=\"built_in\">l</span>(<span class=\"number\">0</span>), <span class=\"built_in\">r</span>(<span class=\"number\">0</span>), <span class=\"built_in\">w</span>(<span class=\"built_in\">ran</span>()), <span class=\"built_in\">sum</span>(val), <span class=\"built_in\">val</span>(val), <span class=\"built_in\">sz</span>(<span class=\"number\">1</span>), <span class=\"built_in\">lazy</span>(<span class=\"number\">0</span>) &#123;&#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"type\">const</span> <span class=\"type\">static</span> <span class=\"type\">int</span> maxn = <span class=\"number\">2e5</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\">    node tree[maxn &lt;&lt; <span class=\"number\">7</span>];</span><br><span class=\"line\">    <span class=\"type\">int</span> vers[maxn], ver = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> tot = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">newnode</span><span class=\"params\">(i64 val)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        tot++;</span><br><span class=\"line\">        tree[tot] = <span class=\"built_in\">node</span>(val);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> tot;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">pushdown</span><span class=\"params\">(<span class=\"type\">int</span> rt)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!rt)</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!tree[rt].lazy)</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tree[rt].l) <span class=\"comment\">// åªè¦åŠ¨ç»“ç‚¹é‚£å¿…é¡»å…¨éƒ¨å¤‡ä»½å¯æŒä¹…åŒ–</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> rl = ++tot;</span><br><span class=\"line\">            tree[rl] = tree[tree[rt].l];</span><br><span class=\"line\">            tree[rt].l = rl;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tree[rt].r)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> rr = ++tot;</span><br><span class=\"line\">            tree[rr] = tree[tree[rt].r];</span><br><span class=\"line\">            tree[rt].r = rr;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">swap</span>(tree[rt].l, tree[rt].r);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tree[rt].l)</span><br><span class=\"line\">            tree[tree[rt].l].lazy ^= <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tree[rt].r)</span><br><span class=\"line\">            tree[tree[rt].r].lazy ^= <span class=\"number\">1</span>;</span><br><span class=\"line\">        tree[rt].lazy = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">pushup</span><span class=\"params\">(<span class=\"type\">int</span> rt)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        tree[rt].sz = tree[tree[rt].l].sz + tree[tree[rt].r].sz + <span class=\"number\">1</span>;</span><br><span class=\"line\">        tree[rt].sum = tree[tree[rt].l].sum + tree[tree[rt].r].sum + tree[rt].val;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">merge</span><span class=\"params\">(<span class=\"type\">int</span> l, <span class=\"type\">int</span> r)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!l || !r)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> l | r;</span><br><span class=\"line\">        <span class=\"type\">int</span> nowrt = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"built_in\">pushdown</span>(l);</span><br><span class=\"line\">        <span class=\"built_in\">pushdown</span>(r);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tree[l].w &gt; tree[r].w)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            nowrt = ++tot;</span><br><span class=\"line\">            tree[nowrt] = tree[l];</span><br><span class=\"line\">            tree[nowrt].r = <span class=\"built_in\">merge</span>(tree[nowrt].r, r);</span><br><span class=\"line\">            <span class=\"built_in\">pushup</span>(nowrt);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            nowrt = ++tot;</span><br><span class=\"line\">            tree[nowrt] = tree[r];</span><br><span class=\"line\">            tree[nowrt].l = <span class=\"built_in\">merge</span>(l, tree[nowrt].l);</span><br><span class=\"line\">            <span class=\"built_in\">pushup</span>(nowrt);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> nowrt;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">split_sz</span><span class=\"params\">(<span class=\"type\">const</span> <span class=\"type\">int</span> rt, <span class=\"type\">int</span> &amp;l, <span class=\"type\">int</span> &amp;r, <span class=\"type\">int</span> sz)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!rt)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            l = r = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">pushdown</span>(rt);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tree[tree[rt].l].sz + <span class=\"number\">1</span> &lt;= sz)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> newrt = ++tot;</span><br><span class=\"line\">            tree[newrt] = tree[rt];</span><br><span class=\"line\">            l = newrt;</span><br><span class=\"line\">            <span class=\"built_in\">split_sz</span>(tree[rt].r, tree[newrt].r, r, sz - (tree[tree[newrt].l].sz + <span class=\"number\">1</span>));</span><br><span class=\"line\">            <span class=\"built_in\">pushup</span>(l);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> newrt = ++tot;</span><br><span class=\"line\">            tree[newrt] = tree[rt];</span><br><span class=\"line\">            r = newrt;</span><br><span class=\"line\">            <span class=\"built_in\">split_sz</span>(tree[rt].l, l, tree[newrt].l, sz);</span><br><span class=\"line\">            <span class=\"built_in\">pushup</span>(r);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">void</span> <span class=\"title\">insert</span><span class=\"params\">(<span class=\"type\">int</span> v, <span class=\"type\">int</span> k, i64 val)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        vers[++ver] = vers[v];</span><br><span class=\"line\">        <span class=\"type\">int</span> rt1, rt2;</span><br><span class=\"line\">        <span class=\"built_in\">split_sz</span>(vers[ver], rt1, rt2, k);</span><br><span class=\"line\">        rt1 = <span class=\"built_in\">merge</span>(rt1, <span class=\"built_in\">newnode</span>(val));</span><br><span class=\"line\">        vers[ver] = <span class=\"built_in\">merge</span>(rt1, rt2);</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">void</span> <span class=\"title\">del</span><span class=\"params\">(<span class=\"type\">int</span> v, <span class=\"type\">int</span> k)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        vers[++ver] = vers[v];</span><br><span class=\"line\">        <span class=\"type\">int</span> rt1, rt2, rt3;</span><br><span class=\"line\">        <span class=\"built_in\">split_sz</span>(vers[ver], rt1, rt3, k);</span><br><span class=\"line\">        <span class=\"built_in\">split_sz</span>(rt1, rt1, rt2, k - <span class=\"number\">1</span>);</span><br><span class=\"line\">        vers[ver] = <span class=\"built_in\">merge</span>(rt1, rt3);</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> i64 <span class=\"title\">query</span><span class=\"params\">(<span class=\"type\">int</span> v, <span class=\"type\">int</span> l, <span class=\"type\">int</span> r)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        vers[++ver] = vers[v];</span><br><span class=\"line\">        <span class=\"type\">int</span> rt1, rt2, rt3;</span><br><span class=\"line\">        <span class=\"built_in\">split_sz</span>(vers[ver], rt1, rt3, r);</span><br><span class=\"line\">        <span class=\"built_in\">split_sz</span>(rt1, rt1, rt2, l - <span class=\"number\">1</span>);</span><br><span class=\"line\">        i64 ans = tree[rt2].sum;</span><br><span class=\"line\">        rt1 = <span class=\"built_in\">merge</span>(rt1, rt2);</span><br><span class=\"line\">        vers[ver] = <span class=\"built_in\">merge</span>(rt1, rt3);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">void</span> <span class=\"title\">reverse</span><span class=\"params\">(<span class=\"type\">int</span> v, <span class=\"type\">int</span> l, <span class=\"type\">int</span> r)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        vers[++ver] = vers[v];</span><br><span class=\"line\">        <span class=\"type\">int</span> rt1, rt2, rt3;</span><br><span class=\"line\">        <span class=\"built_in\">split_sz</span>(vers[ver], rt1, rt3, r);</span><br><span class=\"line\">        <span class=\"built_in\">split_sz</span>(rt1, rt1, rt2, l - <span class=\"number\">1</span>);</span><br><span class=\"line\">        tree[rt2].lazy ^= <span class=\"number\">1</span>;</span><br><span class=\"line\">        rt1 = <span class=\"built_in\">merge</span>(rt1, rt2);</span><br><span class=\"line\">        vers[ver] = <span class=\"built_in\">merge</span>(rt1, rt3);</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">Persistant_literary_Treap tr;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"type\">int</span> n;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    i64 lastans = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (n--)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        i64 v, op, p, x, l, r;</span><br><span class=\"line\">        cin &gt;&gt; v &gt;&gt; op;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (op == <span class=\"number\">1</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            cin &gt;&gt; p &gt;&gt; x;</span><br><span class=\"line\">            p ^= lastans;</span><br><span class=\"line\">            x ^= lastans;</span><br><span class=\"line\">            tr.<span class=\"built_in\">insert</span>(v, p, x);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (op == <span class=\"number\">2</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            cin &gt;&gt; p;</span><br><span class=\"line\">            p ^= lastans;</span><br><span class=\"line\">            tr.<span class=\"built_in\">del</span>(v, p);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (op == <span class=\"number\">3</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            cin &gt;&gt; l &gt;&gt; r;</span><br><span class=\"line\">            l ^= lastans;</span><br><span class=\"line\">            r ^= lastans;</span><br><span class=\"line\">            tr.<span class=\"built_in\">reverse</span>(v, l, r);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            cin &gt;&gt; l &gt;&gt; r;</span><br><span class=\"line\">            l ^= lastans;</span><br><span class=\"line\">            r ^= lastans;</span><br><span class=\"line\">            lastans = tr.<span class=\"built_in\">query</span>(v, l, r);</span><br><span class=\"line\">            cout &lt;&lt; lastans &lt;&lt; endl;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h2 id=\"7-æ ‘å¥—æ ‘\">7.æ ‘å¥—æ ‘</h2>\n<h3 id=\"7-1-çº¿æ®µæ ‘å¥—å¹³è¡¡æ ‘\">7.1 çº¿æ®µæ ‘å¥—å¹³è¡¡æ ‘</h3>\n<p>å…³é”®è¯ï¼šåŒºé—´å¤§å‹å¹³è¡¡æ ‘æ“ä½œã€‚</p>\n<p>æ‚¨éœ€è¦å†™ä¸€ç§æ•°æ®ç»“æ„ï¼ˆå¯å‚è€ƒé¢˜ç›®æ ‡é¢˜ï¼‰ï¼Œæ¥ç»´æŠ¤ä¸€ä¸ªæœ‰åºæ•°åˆ—ï¼Œå…¶ä¸­éœ€è¦æä¾›ä»¥ä¸‹æ“ä½œï¼š</p>\n<ol>\n<li>\n<p>æŸ¥è¯¢ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> åœ¨åŒºé—´å†…çš„æ’å</p>\n</li>\n<li>\n<p>æŸ¥è¯¢åŒºé—´å†…æ’åä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> çš„å€¼</p>\n</li>\n<li>\n<p>ä¿®æ”¹æŸä¸€ä½ç½®ä¸Šçš„æ•°å€¼</p>\n</li>\n<li>\n<p>æŸ¥è¯¢ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> åœ¨åŒºé—´å†…çš„å‰é©±ï¼ˆå‰é©±å®šä¹‰ä¸ºä¸¥æ ¼å°äº <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>ï¼Œä¸”æœ€å¤§çš„æ•°ï¼Œ<strong>è‹¥ä¸å­˜åœ¨è¾“å‡º <code>-2147483647</code></strong>ï¼‰</p>\n</li>\n<li>\n<p>æŸ¥è¯¢ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> åœ¨åŒºé—´å†…çš„åç»§ï¼ˆåç»§å®šä¹‰ä¸ºä¸¥æ ¼å¤§äº <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>ï¼Œä¸”æœ€å°çš„æ•°ï¼Œ<strong>è‹¥ä¸å­˜åœ¨è¾“å‡º <code>2147483647</code></strong>ï¼‰</p>\n</li>\n</ol>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>n</mi><mo separator=\"true\">,</mo><mi>m</mi><mo>â‰¤</mo><mn>5</mn><mo>Ã—</mo><mn>1</mn><msup><mn>0</mn><mn>4</mn></msup></mrow><annotation encoding=\"application/x-tex\">1\\le n,m\\le5\\times 10^4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8304em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">5</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span></span></span></span></span></span></span></span>ï¼Œåºåˆ—ä¸­çš„å€¼åœ¨ä»»ä½•æ—¶åˆ» <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>âˆˆ</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><msup><mn>0</mn><mn>8</mn></msup><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\in[0,10^8]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">8</span></span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span>ã€‚</p>\n<p><strong>ï¼ˆç‰¹åˆ«æé†’ï¼šæ­¤æ•°æ®ä¸ä¿è¯æ“ä½œ 4ã€5 ä¸€å®šå­˜åœ¨ï¼Œæ•…è¯·åŠ¡å¿…è€ƒè™‘ä¸å­˜åœ¨çš„æƒ…å†µã€‚ï¼‰</strong></p>\n<p>åšæ³•ï¼š</p>\n<p>æ¯ä¸ªçº¿æ®µæ ‘ç»“ç‚¹ç»´æŠ¤ä¸€ä¸ª<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi><mi>r</mi><mi>e</mi><mi>a</mi><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">Treap</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathnormal\">re</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">p</span></span></span></span>å¹³è¡¡æ ‘ï¼ŒåŒºé—´åˆå¹¶ç›´æ¥å¹³è¡¡æ ‘<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>M</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>e</mi></mrow><annotation encoding=\"application/x-tex\">Merge</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">er</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">e</span></span></span></span>â€‹æ‹¿ä¸‹ã€‚</p>\n<ol>\n<li>æŸ¥è¯¢æ’åï¼šçº¿æ®µæ ‘æŸ¥è¯¢ï¼ŒæŸ¥è¯¢æ¯ä¸ªå­åŒºé—´å†…<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(k-1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>çš„æ’åå¹¶æ±‚å’Œï¼Œå¤æ‚åº¦<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(logN)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span></li>\n<li>æŸ¥è¯¢æ’åä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>çš„æ•°ï¼šè¿™ä¸ªæ²¡åŠæ³•ç›´æ¥åŠ æ³•æ±‚ï¼Œéœ€è¦äºŒåˆ†+æ“ä½œ1åˆ¤æ–­ï¼Œå¤æ‚åº¦<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><msup><mi>g</mi><mn>2</mn></msup><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(log^2N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span></li>\n<li>ä¿®æ”¹ï¼šæ— è¯å¯è¯´ï¼Œå¤æ‚åº¦<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(logN)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>ã€‚</li>\n<li>æŸ¥è¯¢å‰é©±ï¼šå„åŒºé—´æŸ¥è¯¢å‰é©±åå–<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">max</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ma</span><span class=\"mord mathnormal\">x</span></span></span></span>ï¼Œå¤æ‚åº¦<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(logN)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>ã€‚</li>\n<li>æŸ¥è¯¢åç»§ï¼šå„åŒºé—´æŸ¥è¯¢åç»§åå–<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">min</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">min</span></span></span></span>ï¼Œå¤æ‚åº¦<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(logN)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>.</li>\n</ol>\n<p>å¤æ‚åº¦ä¸Šç•Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mi>l</mi><mi>o</mi><msup><mi>g</mi><mn>3</mn></msup><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(Nlog^3N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">Nl</span><span class=\"mord mathnormal\">o</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>ã€‚å•çº¯ä¿®æ”¹+æŸ¥è¯¢ç¬¬<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span>å°æ ‘çŠ¶ä¸»å¸­æ ‘å¯ä»¥<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mi>l</mi><mi>o</mi><msup><mi>g</mi><mn>2</mn></msup><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(Nlog^2N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">Nl</span><span class=\"mord mathnormal\">o</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>å®ç°ã€‚</p>\n<h3 id=\"7-2-æ ‘çŠ¶æ•°ç»„-çº¿æ®µæ ‘\">7.2 æ ‘çŠ¶æ•°ç»„+çº¿æ®µæ ‘</h3>\n<p>å…³é”®è¯ï¼šä¸»å¸­æ ‘å¼ºåŒ–ï¼Œå·®åˆ†åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘</p>\n<p>æ ‘çŠ¶æ•°ç»„çš„å·®åˆ†æ€§è´¨ä½¿å¾—ä¸»å¸­æ ‘å¯ä»¥æ”¯æŒå¿«é€Ÿä¿®æ”¹ã€‚</p>\n<p>è§1.12</p>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"7-3-çº¿æ®µæ ‘å¥—çº¿æ®µæ ‘\">*7.3 çº¿æ®µæ ‘å¥—çº¿æ®µæ ‘</h3>\n<p>å…³é”®è¯ï¼šäºŒç»´åŒºé—´ä¿®æ”¹ã€åŒºé—´æŸ¥è¯¢ã€‚</p>\n<p>è§<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mi>I</mi><mo>âˆ’</mo><mi>W</mi><mi>i</mi><mi>k</mi><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">OI-Wiki</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">Wiki</span></span></span></span>æ‰‹å†Œï¼Œè¿‡äºåé—¨ã€‚</p>\n<h2 id=\"8-é™æ€æ ‘ï¼ˆæ ‘ä¸Šå·®åˆ†ï¼›HLD-LLDï¼Œé‡é“¾å‰–åˆ†ã€é•¿é“¾å‰–åˆ†ï¼‰\">8. é™æ€æ ‘ï¼ˆæ ‘ä¸Šå·®åˆ†ï¼›HLD/LLDï¼Œé‡é“¾å‰–åˆ†ã€é•¿é“¾å‰–åˆ†ï¼‰</h2>\n<p>å…³é”®è¯ï¼šé™æ€æ ‘åŒºé—´æ“ä½œï¼Œé™æ€æ ‘åºåˆ—åŒ–æ“ä½œã€‚</p>\n<h4 id=\"8-1-æ ‘ä¸Šå·®åˆ†â€”â€”é™æ€æ ‘ï¼Œé™æ€æ ‘èŠ‚ç‚¹ä¿¡æ¯\">8.1 æ ‘ä¸Šå·®åˆ†â€”â€”é™æ€æ ‘ï¼Œé™æ€æ ‘èŠ‚ç‚¹ä¿¡æ¯</h4>\n<p>æƒ³æ“ä½œã€æŸ¥è¯¢<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>åˆ°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>èŠ‚ç‚¹çš„åŒºé—´å±æ€§ï¼Œå¯ä»¥é€šè¿‡æ ‘ä¸Šå·®åˆ†åˆ°æ ¹æ“ä½œå®ç°ï¼Œå³ç»“ç‚¹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>å­˜å‚¨<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>åˆ°æ ¹çš„ä¿¡æ¯ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>å­˜å‚¨<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>åˆ°æ ¹çš„ä¿¡æ¯ã€‚</p>\n<p>æŸ¥è¯¢çš„æ—¶å€™ç›´æ¥æŸ¥è¯¢<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo>+</mo><mi>v</mi><mo>âˆ’</mo><mi>l</mi><mi>c</mi><msub><mi>a</mi><mrow><mi>u</mi><mo separator=\"true\">,</mo><mi>v</mi></mrow></msub><mo>âˆ’</mo><mi>f</mi><msub><mi>a</mi><mrow><mi>l</mi><mi>c</mi><msub><mi>a</mi><mrow><mi>u</mi><mo separator=\"true\">,</mo><mi>v</mi></mrow></msub></mrow></msub></mrow><annotation encoding=\"application/x-tex\">u+v-lca_{u,v}-fa_{lca_{u,v}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">c</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0418em;vertical-align:-0.3473em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\">c</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3473em;\"><span></span></span></span></span></span></span></span></span></span>â€‹å³å¯ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span><span class=\"comment\">//æ ‘ä¸Šå·®åˆ†ï¼Œæ ‘ä¸Šä¸€æ¡é“¾çš„åŒºé—´å’Œï¼Œfromï¼š[JLOI2014] æ¾é¼ çš„æ–°å®¶</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> inf=<span class=\"number\">0x3f3f3f3f</span>;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> N=<span class=\"number\">3</span>*<span class=\"number\">1e5</span><span class=\"number\">+10</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> n,u,v,vis[N],a[N],b[N];</span><br><span class=\"line\"><span class=\"type\">int</span> fa[N][<span class=\"number\">40</span>],dep[N];</span><br><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt;edge[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"type\">int</span> x,<span class=\"type\">int</span> f)</span></span>&#123;<span class=\"comment\">//lcaé¢„å¤„ç†</span></span><br><span class=\"line\">    dep[x]=dep[f]<span class=\"number\">+1</span>;</span><br><span class=\"line\">    fa[x][<span class=\"number\">0</span>]=f;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> i:edge[x])<span class=\"keyword\">if</span>(i!=f)<span class=\"built_in\">dfs</span>(i,x); </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">sum</span><span class=\"params\">(<span class=\"type\">int</span> x,<span class=\"type\">int</span> f)</span></span>&#123;<span class=\"comment\">//ç»Ÿè®¡ç‚¹xçš„å€¼</span></span><br><span class=\"line\">    a[x]=b[x];</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> i:edge[x])&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(i!=f)&#123;</span><br><span class=\"line\">            <span class=\"built_in\">sum</span>(i,x);<span class=\"comment\">//æ­¤æ—¶å·²ç»ç»Ÿè®¡äº†æ‰€æœ‰içš„å€¼äº†</span></span><br><span class=\"line\">            a[x]+=a[i];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">lca</span><span class=\"params\">(<span class=\"type\">int</span> x,<span class=\"type\">int</span> y)</span></span>&#123;<span class=\"comment\">//lca</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(x==y)<span class=\"keyword\">return</span> x;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(dep[x]&lt;dep[y])<span class=\"built_in\">swap</span>(x,y);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">30</span>;i&gt;=<span class=\"number\">0</span>;i--)</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(dep[fa[x][i]]&gt;=dep[y])x=fa[x][i];</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(x==y)<span class=\"keyword\">return</span> x;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">30</span>;i&gt;=<span class=\"number\">0</span>;i--)</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(fa[x][i]!=fa[y][i])x=fa[x][i],y=fa[y][i];</span><br><span class=\"line\">    <span class=\"keyword\">return</span> fa[x][<span class=\"number\">0</span>];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    cin&gt;&gt;n;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)cin&gt;&gt;vis[i];</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n<span class=\"number\">-1</span>;i++)&#123;</span><br><span class=\"line\">        cin&gt;&gt;u&gt;&gt;v;</span><br><span class=\"line\">        edge[u].<span class=\"built_in\">push_back</span>(v);</span><br><span class=\"line\">        edge[v].<span class=\"built_in\">push_back</span>(u);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">dfs</span>(<span class=\"number\">1</span>,<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">1</span>;j&lt;=<span class=\"number\">30</span>;j++)</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)</span><br><span class=\"line\">            fa[i][j]=fa[fa[i][j<span class=\"number\">-1</span>]][j<span class=\"number\">-1</span>];</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n<span class=\"number\">-1</span>;i++)&#123;<span class=\"comment\">//ç‚¹å·®åˆ†,ä¸€ä¸ªç‚¹çš„å·®åˆ†æ•°ç»„çš„å€¼å°±æ˜¯è¿™ä¸ªç‚¹çš„å€¼-æ‰€æœ‰å…¶äº²å„¿å­çš„å€¼</span></span><br><span class=\"line\">    <span class=\"comment\">//å¯¹vis[i],vis[i+1]è¿™ä¸¤ä¸ªç‚¹ä¹‹é—´åŠ ä¸€åªéœ€è¦å¦‚ä¸‹æ­¥éª¤ï¼ˆå››æ­¥ï¼‰ï¼Œæ“ä½œçš„æ˜¯å·®åˆ†æ•°ç»„</span></span><br><span class=\"line\">        b[vis[i]]++;</span><br><span class=\"line\">        b[vis[i<span class=\"number\">+1</span>]]++;</span><br><span class=\"line\">        b[<span class=\"built_in\">lca</span>(vis[i],vis[i<span class=\"number\">+1</span>])]--;</span><br><span class=\"line\">        b[fa[<span class=\"built_in\">lca</span>(vis[i],vis[i<span class=\"number\">+1</span>])][<span class=\"number\">0</span>]]--;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">sum</span>(<span class=\"number\">1</span>,<span class=\"number\">0</span>);<span class=\"comment\">//éå†æ•´æ£µæ ‘ï¼Œæ¨å‡ºåŸå§‹æƒå€¼</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">2</span>;i&lt;=n;i++)a[vis[i]]--;<span class=\"comment\">//æœ¬é¢˜ä¾‹å¤–ï¼ˆå› ä¸ºæˆ‘ä»¬æŠŠæ—¢ä½œä¸ºèµ·ç‚¹åˆåšä¸ºç»ˆç‚¹çš„ç‚¹ç®—äº†ä¸¤æ¬¡ï¼Œç°åœ¨æŠŠè¿™äº›ç‚¹çš„æƒå€¼å‡ä¸€å³å¯ ï¼‰</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)cout&lt;&lt;a[i]&lt;&lt;endl;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<p>è¿˜æœ‰ä¸€ä¸ªæ ‘ä¸Šå¼‚æˆ–å·®åˆ†ï¼š</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> int long long</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> lowbit(x) (x&amp;-x)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> endl <span class=\"string\">&#x27;\\n&#x27;</span><span class=\"comment\">//äº¤äº’é¢˜å°±åˆ </span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> N=<span class=\"number\">1e6</span><span class=\"number\">+10</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> n,q,u,v,idx,s,w;</span><br><span class=\"line\"><span class=\"type\">int</span> tree[N],a[N],dfn[N],dep[N],fa[N][<span class=\"number\">21</span>],siz[N];</span><br><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt;edge[N];</span><br><span class=\"line\"><span class=\"comment\">/*è¦æ±‚è§£å†³è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼Œæ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ“ä½œï¼š</span></span><br><span class=\"line\"><span class=\"comment\">1.uåˆ°vçš„è·¯å¾„ä¸Šæ‰€æœ‰å€¼å¼‚æˆ–ä¸Šk</span></span><br><span class=\"line\"><span class=\"comment\">2.è¾“å‡ºuåˆ°vä¸Šæ‰€æœ‰ç‚¹çš„å€¼</span></span><br><span class=\"line\"><span class=\"comment\">è§£æ³•ï¼š</span></span><br><span class=\"line\"><span class=\"comment\">æ ‘ä¸Šå¼‚æˆ–å·®åˆ†ï¼Œ1ç”±å¼‚æˆ–çš„æ€§è´¨å¯ä»¥è½¬åŒ–ä¸ºå››æ¡é“¾çš„æ“ä½œï¼Œu-&gt;1ï¼Œv-&gt;1ï¼Œk-&gt;1ï¼Œï¼ˆk-faï¼‰-&gt;1ï¼Œä½†æ˜¯å¯ä»¥ç®€åŒ–ï¼Œåˆ©ç”¨å¼‚æˆ–å·®åˆ†æ•°ç»„ï¼Œä¸€ä¸ªç‚¹çš„å€¼ä¸ºè¿™ä¸ªç‚¹å¼‚æˆ–å®ƒçš„æ‰€æœ‰å„¿å­èŠ‚ç‚¹ï¼Œè¿™æ ·åªéœ€è¦ä¿®æ”¹uï¼Œvï¼Œkï¼Œk-faå››ä¸ªç‚¹çš„å€¼å³å¯</span></span><br><span class=\"line\"><span class=\"comment\">2å•ç‚¹æŸ¥è¯¢ï¼Œéš¾åº¦åœ¨äºå¦‚ä½•é€šè¿‡å¼‚æˆ–å·®åˆ†è¿˜åŸè¿™ä¸ªç‚¹çš„å€¼ï¼Œæ–¹æ³•å°±æ˜¯uå¼‚æˆ–ä»¥uä¸ºæ ¹çš„å­æ ‘çš„æ‰€æœ‰ç‚¹çš„å¼‚æˆ–å·®åˆ†æ•°ç»„ï¼Œåˆ©ç”¨dfsåºï¼Œå­æ ‘å†…çš„æ‰€æœ‰ç‚¹è¢«ç»´æŠ¤æˆäº†ä¸€ä¸ªåŒºé—´ï¼Œè¿™æ ·å°±å˜æˆäº†åŒºé—´å¼‚æˆ–ï¼Œå°±å¯ä»¥åˆ©ç”¨æ ‘çŠ¶æ•°ç»„å¿«é€Ÿç»´æŠ¤ï¼Œå¯¹dfsåºå»ºç«‹æ ‘çŠ¶æ•°ç»„å³å¯ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">//æ¶‰åŠçŸ¥è¯†ç‚¹ï¼šå¼‚æˆ–ã€æ ‘çŠ¶æ•°ç»„ã€dfsåºã€æ ‘ä¸Šå·®åˆ†ã€å¼‚æˆ–å‰ç¼€å’Œã€lca*/</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"type\">int</span> x,<span class=\"type\">int</span> f)</span></span>&#123;</span><br><span class=\"line\">    dep[x]=dep[f]<span class=\"number\">+1</span>;fa[x][<span class=\"number\">0</span>]=f;a[f]^=a[x],dfn[x]=++idx;</span><br><span class=\"line\">    siz[x]=<span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> i:edge[x])&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(i!=f)&#123;</span><br><span class=\"line\">            <span class=\"built_in\">dfs</span>(i,x);</span><br><span class=\"line\">            siz[x]+=siz[i];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"type\">int</span> x,<span class=\"type\">int</span> k)</span></span>&#123;<span class=\"comment\">//ç‚¹xåŠ ä¸Šk</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span>(x&lt;=n)&#123;</span><br><span class=\"line\">        tree[x]^=k;<span class=\"comment\">//ä¾æ¬¡ä¿®æ”¹æ¯ä¸ªè¦†ç›–æœ‰xçš„åŒºé—´çš„å€¼</span></span><br><span class=\"line\">        x+=<span class=\"built_in\">lowbit</span>(x);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">sum</span><span class=\"params\">(<span class=\"type\">int</span> x)</span></span>&#123;<span class=\"comment\">//å¤„ç†0åˆ°xä¹‹é—´çš„å‰ç¼€å’Œ</span></span><br><span class=\"line\">    <span class=\"type\">int</span> cnt=<span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(x&gt;<span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">        cnt^=tree[x];</span><br><span class=\"line\">        x-=<span class=\"built_in\">lowbit</span>(x);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> cnt;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">lca</span><span class=\"params\">(<span class=\"type\">int</span> x,<span class=\"type\">int</span> y)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(dep[x]&gt;dep[y]) <span class=\"built_in\">swap</span>(x,y);<span class=\"comment\">//yçš„æ·±åº¦å¤§ï¼Œdepå¤§</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i=<span class=\"number\">20</span>;i&gt;=<span class=\"number\">0</span>;i-- ) </span><br><span class=\"line\">        <span class=\"keyword\">if</span>(dep[x]&lt;=dep[y]-(<span class=\"number\">1</span>&lt;&lt;i)) y=fa[y][i];</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(x==y) <span class=\"keyword\">return</span> x;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i=<span class=\"number\">20</span>;i&gt;=<span class=\"number\">0</span>;i-- ) </span><br><span class=\"line\">        <span class=\"keyword\">if</span>(fa[x][i]!=fa[y][i]) </span><br><span class=\"line\">            x=fa[x][i],y=fa[y][i];</span><br><span class=\"line\">    <span class=\"keyword\">return</span> fa[x][<span class=\"number\">0</span>];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">change</span><span class=\"params\">(<span class=\"type\">int</span> u,<span class=\"type\">int</span> v,<span class=\"type\">int</span> w)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> k=<span class=\"built_in\">lca</span>(u,v);</span><br><span class=\"line\">    <span class=\"built_in\">add</span>(dfn[u],w);</span><br><span class=\"line\">    <span class=\"built_in\">add</span>(dfn[v],w);</span><br><span class=\"line\">    <span class=\"built_in\">add</span>(dfn[k],w);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (fa[k][<span class=\"number\">0</span>]) <span class=\"built_in\">add</span>(dfn[fa[k][<span class=\"number\">0</span>]], w);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">get</span><span class=\"params\">(<span class=\"type\">int</span> u)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">sum</span>(dfn[u]+siz[u]<span class=\"number\">-1</span>)^<span class=\"built_in\">sum</span>(dfn[u]<span class=\"number\">-1</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">check2</span><span class=\"params\">(<span class=\"type\">int</span> u,<span class=\"type\">int</span> v)</span></span>&#123;</span><br><span class=\"line\">    vector&lt;<span class=\"type\">int</span>&gt;e;<span class=\"type\">int</span> flag=<span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(dep[u]&lt;dep[v])<span class=\"built_in\">swap</span>(u,v);</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(dep[u]&gt;dep[v])&#123;</span><br><span class=\"line\">        e.<span class=\"built_in\">push_back</span>(<span class=\"built_in\">get</span>(u));</span><br><span class=\"line\">        u=fa[u][<span class=\"number\">0</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(u==v)e.<span class=\"built_in\">push_back</span>(<span class=\"built_in\">get</span>(u));</span><br><span class=\"line\">    <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(u!=v)&#123;</span><br><span class=\"line\">            e.<span class=\"built_in\">push_back</span>(<span class=\"built_in\">get</span>(u));e.<span class=\"built_in\">push_back</span>(<span class=\"built_in\">get</span>(v));</span><br><span class=\"line\">            u=fa[u][<span class=\"number\">0</span>];v=fa[v][<span class=\"number\">0</span>];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        e.<span class=\"built_in\">push_back</span>(<span class=\"built_in\">get</span>(u));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">sort</span>(e.<span class=\"built_in\">begin</span>(),e.<span class=\"built_in\">end</span>());</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">2</span>;i&lt;e.<span class=\"built_in\">size</span>();i++)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(e[i<span class=\"number\">-2</span>]+e[i<span class=\"number\">-1</span>]&gt;e[i])<span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">find</span><span class=\"params\">(<span class=\"type\">int</span> u,<span class=\"type\">int</span> v)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> k = <span class=\"built_in\">lca</span>(u, v);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (dep[u] + dep[v] - <span class=\"number\">2</span> * dep[k] + <span class=\"number\">1</span> &gt; <span class=\"number\">46</span>) <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">return</span> <span class=\"built_in\">check2</span>(u,v);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>);cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin&gt;&gt;n&gt;&gt;q;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)cin&gt;&gt;a[i];</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n<span class=\"number\">-1</span>;i++)&#123;</span><br><span class=\"line\">        cin&gt;&gt;u&gt;&gt;v;</span><br><span class=\"line\">        edge[u].<span class=\"built_in\">push_back</span>(v);</span><br><span class=\"line\">        edge[v].<span class=\"built_in\">push_back</span>(u);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">dfs</span>(<span class=\"number\">1</span>,<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">1</span>;j&lt;=<span class=\"number\">20</span>;j++)</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)</span><br><span class=\"line\">            fa[i][j]=fa[fa[i][j<span class=\"number\">-1</span>]][j<span class=\"number\">-1</span>];</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)<span class=\"built_in\">add</span>(dfn[i],a[i]);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=q;i++)&#123;</span><br><span class=\"line\">        cin&gt;&gt;s;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(s==<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">            cin&gt;&gt;u&gt;&gt;v&gt;&gt;w;</span><br><span class=\"line\">            <span class=\"built_in\">change</span>(u,v,w);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            cin&gt;&gt;u&gt;&gt;v;</span><br><span class=\"line\">            cout&lt;&lt;<span class=\"built_in\">find</span>(u,v);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"8-2-é‡é“¾å‰–åˆ†â€”â€”é™æ€æ ‘ï¼ŒåŠ¨æ€æ ‘èŠ‚ç‚¹ä¿¡æ¯\">8.2 é‡é“¾å‰–åˆ†â€”â€”é™æ€æ ‘ï¼ŒåŠ¨æ€æ ‘èŠ‚ç‚¹ä¿¡æ¯</h4>\n<p>ä¸€ç§ä»¥é“¾èŠ‚ç‚¹æ•°åˆ’åˆ†è½»é‡ä»¥å®ç°æ ‘èŠ‚ç‚¹ç¼–å·åŒ–ï¼Œå°†ä¹¦ä¸Šé—®é¢˜è½¬ç§»åˆ°åŒºé—´æ“ä½œå®ç°ã€‚</p>\n<p>é‡é“¾å‰–åˆ†ä¿è¯æ¯ä¸€é¢—å­æ ‘ä¸­æ‰€æœ‰èŠ‚ç‚¹çš„ç¼–å·å¿…å®šæ˜¯ä¸€æ®µè¿ç»­çš„åºåˆ—<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>f</mi><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">dfn</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">df</span><span class=\"mord mathnormal\">n</span></span></span></span>åºå·ã€‚</p>\n<p>é‡é“¾å‰–åˆ†å¯ä»¥å°†æ ‘ä¸Šçš„ä»»æ„ä¸€æ¡è·¯å¾„åˆ’åˆ†æˆä¸è¶…è¿‡<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">logN</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>æ¡è¿ç»­çš„é“¾ï¼Œæ¯æ¡é“¾ä¸Šçš„ç‚¹æ·±åº¦äº’ä¸ç›¸åŒï¼ˆå³æ˜¯è‡ªåº•å‘ä¸Šçš„ä¸€æ¡é“¾ï¼Œé“¾ä¸Šæ‰€æœ‰ç‚¹çš„ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mi>C</mi><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">LCA</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord mathnormal\">A</span></span></span></span> ä¸ºé“¾çš„ä¸€ä¸ªç«¯ç‚¹)ã€‚</p>\n<p>é‡é“¾å‰–åˆ†è¿˜èƒ½ä¿è¯åˆ’åˆ†å‡ºçš„æ¯æ¡é“¾ä¸Šçš„èŠ‚ç‚¹ DFS åºè¿ç»­ï¼Œå› æ­¤å¯ä»¥æ–¹ä¾¿åœ°ç”¨ä¸€äº›ç»´æŠ¤åºåˆ—çš„æ•°æ®ç»“æ„ï¼ˆå¦‚çº¿æ®µæ ‘ï¼‰æ¥ç»´æŠ¤æ ‘ä¸Šè·¯å¾„çš„ä¿¡æ¯ã€‚</p>\n<p>é‡é“¾å‰–åˆ†å¤æ‚åº¦æ˜¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>çš„ï¼Œä¸¤æ¬¡<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>f</mi><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">dfs</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">df</span><span class=\"mord mathnormal\">s</span></span></span></span>å®ç°ï¼Œè·³é“¾æ±‚<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mi>c</mi><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">lca</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">a</span></span></span></span>çš„å®ç°æ˜¯å•æ¬¡è¯¢é—®<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(logN)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>â€‹çš„ã€‚å¯¹äºé«˜èŠ‚ç‚¹æ•°è€Œä½å¼ºåº¦è¯¢é—®ç›¸å½“å‹å¥½ã€‚</p>\n<p>è¿™é‡Œé»˜è®¤æ˜¯ä»<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>å¼€å§‹çš„</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> int long long</span></span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">3e5</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> father[maxn], sizes[maxn], hson[maxn], depth[maxn], top[maxn], ranks[maxn], dfn[maxn], cnt;</span><br><span class=\"line\"><span class=\"type\">int</span> nxt[maxn &lt;&lt; <span class=\"number\">1LL</span>], head[maxn], to[maxn &lt;&lt; <span class=\"number\">1LL</span>], tot;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"type\">int</span> u, <span class=\"type\">int</span> v)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    nxt[++tot] = head[u];</span><br><span class=\"line\">    head[u] = tot;</span><br><span class=\"line\">    to[tot] = v;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">add_edge</span><span class=\"params\">(<span class=\"type\">int</span> u, <span class=\"type\">int</span> v)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">add</span>(u, v);</span><br><span class=\"line\">    <span class=\"built_in\">add</span>(v, u);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">dfs1</span><span class=\"params\">(<span class=\"type\">int</span> pos)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    hson[pos] = <span class=\"number\">-1</span>;</span><br><span class=\"line\">    sizes[pos] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = head[pos]; i; i = nxt[i])</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!depth[to[i]])</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            depth[to[i]] = depth[pos] + <span class=\"number\">1</span>;</span><br><span class=\"line\">            father[to[i]] = pos;</span><br><span class=\"line\">            <span class=\"built_in\">dfs1</span>(to[i]);</span><br><span class=\"line\">            sizes[pos] += sizes[to[i]];</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (hson[pos] == <span class=\"number\">-1</span> || sizes[to[i]] &gt; sizes[hson[pos]])</span><br><span class=\"line\">                hson[pos] = to[i];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">dfs2</span><span class=\"params\">(<span class=\"type\">int</span> u, <span class=\"type\">int</span> tops)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    top[u] = tops;</span><br><span class=\"line\">    dfn[u] = ++cnt;</span><br><span class=\"line\">    ranks[cnt] = u;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (hson[u] != <span class=\"number\">-1</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">dfs2</span>(hson[u], tops);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = head[u]; i; i = nxt[i])</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (to[i] == father[u] || to[i] == hson[u])</span><br><span class=\"line\">                <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">            <span class=\"built_in\">dfs2</span>(to[i], to[i]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"type\">int</span> n, m, r;</span><br><span class=\"line\"><span class=\"type\">int</span> a[maxn];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">lca</span><span class=\"params\">(<span class=\"type\">int</span> u, <span class=\"type\">int</span> v)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (top[u] != top[v])</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (depth[top[u]] &lt; depth[top[v]])</span><br><span class=\"line\">            <span class=\"built_in\">swap</span>(u, v);</span><br><span class=\"line\">        u = father[top[u]]; <span class=\"comment\">// æ‰€åœ¨é‡é“¾é¦–ä½çš„å‘ä¸Šè·³</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> depth[u] &lt; depth[v] ? u : v;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">init</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt; n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> u, v;</span><br><span class=\"line\">        cin &gt;&gt; u &gt;&gt; v;</span><br><span class=\"line\">        <span class=\"built_in\">add_edge</span>(u, v);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    depth[r] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">dfs1</span>(r);</span><br><span class=\"line\">    <span class=\"built_in\">dfs2</span>(r, r);</span><br><span class=\"line\">    <span class=\"comment\">// cout &lt;&lt; &quot;finished build&quot; &lt;&lt; endl;</span></span><br><span class=\"line\">    <span class=\"comment\">// cout &lt;&lt; &quot;root  is&quot; &lt;&lt; dfn[1] &lt;&lt; endl;</span></span><br><span class=\"line\">    <span class=\"comment\">/*for (int i = 1; i &lt;= n; i++)</span></span><br><span class=\"line\"><span class=\"comment\">        cout &lt;&lt; dfn[i] &lt;&lt; &quot; &quot;;</span></span><br><span class=\"line\"><span class=\"comment\">    cout &lt;&lt; endl;</span></span><br><span class=\"line\"><span class=\"comment\">    for (int i = 1; i &lt;= n; i++)</span></span><br><span class=\"line\"><span class=\"comment\">        cout &lt;&lt; ranks[i] &lt;&lt; &quot; &quot;;</span></span><br><span class=\"line\"><span class=\"comment\">    cout &lt;&lt; endl;</span></span><br><span class=\"line\"><span class=\"comment\">    for (int i = 1; i &lt;= n; i++)</span></span><br><span class=\"line\"><span class=\"comment\">        cout &lt;&lt; top[i] &lt;&lt; &quot; &quot;;</span></span><br><span class=\"line\"><span class=\"comment\">        */</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"8-3é•¿é“¾å‰–åˆ†â€”â€”ä»…æ·±åº¦ç»´åº¦çº¿æ€§ä¼˜åŒ–åŠ¨æ€è§„åˆ’\">8.3é•¿é“¾å‰–åˆ†â€”â€”ä»…æ·±åº¦ç»´åº¦çº¿æ€§ä¼˜åŒ–åŠ¨æ€è§„åˆ’</h4>\n<p>é•¿é“¾å‰–åˆ†çš„å®ç°æ–¹å¼å’Œé‡é“¾å‰–åˆ†å¾ˆåƒï¼Œåªä¸è¿‡é‡å„¿å­è¢«å®šä¹‰ä¸ºäº†é“¾é•¿åº¦æœ€é•¿çš„é‚£ä¸€ä¸ªï¼Œszç»´æŠ¤çš„æ˜¯æ‰€å±æœ€é•¿é“¾çš„é•¿åº¦ã€‚</p>\n<p>é•¿é“¾å‰–åˆ†è·³é“¾çš„æ—¶ç©ºå¤æ‚åº¦æœ€å¤§æ˜¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><msqrt><mi>N</mi></msqrt><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N\\sqrt N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1767em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9267em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;padding-left:0.833em;\">N</span></span><span style=\"top:-2.8867em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"1.08em\" viewBox=\"0 0 400000 1080\" preserveAspectRatio=\"xMinYMin slice\"><path d=\"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z\"/></svg></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1133em;\"><span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>çš„ï¼Œè¿™ä¸ªé“ç†æ˜¾è€Œæ˜“è§ã€‚</p>\n<p>é•¿é“¾å‰–åˆ†å¯ä»¥åšåˆ°çº¿æ€§æ—¶é—´çš„ä¼˜åŒ–æ ‘ä¸Šå’Œæ·±åº¦æœ‰å…³çš„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">dp</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">p</span></span></span></span>ã€‚é•¿é“¾å‰–åˆ†åï¼Œåœ¨ç»´æŠ¤ä¿¡æ¯çš„è¿‡ç¨‹ä¸­ï¼Œå…ˆ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span> ç»§æ‰¿é‡å„¿å­çš„ä¿¡æ¯ï¼Œå†æš´åŠ›åˆå¹¶å…¶ä½™è½»å„¿å­çš„ä¿¡æ¯ã€‚</p>\n<p>ç¤ºä¾‹ï¼š</p>\n<p>ç»™å®šä¸€æ£µä»¥ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> ä¸ºæ ¹ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> ä¸ªèŠ‚ç‚¹çš„æ ‘ã€‚è®¾ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mo stretchy=\"false\">(</mo><mi>u</mi><mo separator=\"true\">,</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">d(u,x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">u</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span> ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span> å­æ ‘ä¸­åˆ° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span> è·ç¦»ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> çš„èŠ‚ç‚¹æ•°ã€‚</p>\n<p>å¯¹äºæ¯ä¸ªç‚¹ï¼Œæ±‚ä¸€ä¸ªæœ€å°çš„ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>ï¼Œä½¿å¾— <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mo stretchy=\"false\">(</mo><mi>u</mi><mo separator=\"true\">,</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">d(u,k)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">u</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose\">)</span></span></span></span> æœ€å¤§ã€‚<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>n</mi><mo>â‰¤</mo><mn>1</mn><msup><mn>0</mn><mn>6</mn></msup></mrow><annotation encoding=\"application/x-tex\">1â‰¤nâ‰¤10^6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">6</span></span></span></span></span></span></span></span></span></span></span></p>\n<p>æ­£å¸¸åˆ†æçš„è¯ï¼Œè®¾<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mrow><mi>u</mi><mo separator=\"true\">,</mo><mi>i</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">f_{u,i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>è¡¨ç¤ºåœ¨<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>å­æ ‘ä¸­è·ç¦»<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>è·ç¦»ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>çš„èŠ‚ç‚¹æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹ç¨‹æœ‰ï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>f</mi><mrow><mi>u</mi><mo separator=\"true\">,</mo><mi>i</mi></mrow></msub><mo>=</mo><mo>âˆ‘</mo><msub><mi>f</mi><mrow><mi>v</mi><mo separator=\"true\">,</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">f_{u,i}=\\sum f_{v,i-1}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.6em;vertical-align:-0.55em;\"></span><span class=\"mop op-symbol large-op\" style=\"position:relative;top:0em;\">âˆ‘</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p>çº¯æš´åŠ›è½¬ç§»ï¼Œæ·±åº¦ç»´åº¦æ˜¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>ï¼Œæ€»å¤æ‚åº¦<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>â€‹ï¼Œæ— æ³•æ‰¿å—ã€‚</p>\n<p>è€ƒè™‘æ ‘é“¾å‰–åˆ†ä¼˜åŒ–ï¼Œå¯¹äº<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>ï¼Œç›´æ¥ç»§æ‰¿å…¶é‡å„¿å­çš„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">dp</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">p</span></span></span></span>æ•°ç»„ï¼Œå¹¶åœ¨æ•°ç»„å‰å¤´æ’å…¥ä¸€ä¸ª<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>å…ƒç´ è¡¨ç¤º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><msub><mi>p</mi><mrow><mi>u</mi><mo separator=\"true\">,</mo><mn>0</mn></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">dp_{u,0}=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span><span class=\"mpunct mtight\">,</span><span class=\"mord mtight\">0</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>ï¼ŒæŒ‡æ ¹èŠ‚ç‚¹è‡ªå·±ã€‚</p>\n<p>ç„¶åå‰©ä¸‹çš„è½»å„¿å­çš„æš´åŠ›å‘é‡å„¿å­åˆå¹¶å°±å¯ä»¥äº†ã€‚æ—¶é—´å¤æ‚åº¦<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>2</mn><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(2n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>â€‹ï¼Œçº¿æ€§é€šè¿‡ï¼Œå› ä¸ºæ¯ä¸ªå­æ ‘èŠ‚ç‚¹çš„vectoræœ€å¤šå­˜æ”¾æ·±åº¦å¤šä¸ªå…ƒç´ ï¼Œæ€»å…ƒç´ æ•°è™½å¤š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>ï¼Œè€Œä¸æ˜¯æš´åŠ›é‚£æ ·æ‰€æœ‰çš„å…¨éƒ¨å¼€ï¼Œæ²¡æœ‰çš„ä¹Ÿå¼€äº†ã€‚</p>\n<p>å…³äºç›´æ¥ç»§æ‰¿é‡å„¿å­ä¿¡æ¯ï¼Œä½¿ç”¨<code>vector</code>çš„<code>swap</code>å‡½æ•°æ˜¾ç„¶æ¯”å†™æŒ‡é’ˆæ›´ç®€å•æ˜“æ‡‚ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> int long long</span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std; </span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> N=<span class=\"number\">1e6</span><span class=\"number\">+5</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> n,x,y,cnt,hd[N],to[N&lt;&lt;<span class=\"number\">1</span>],nxt[N&lt;&lt;<span class=\"number\">1</span>],len[N],son[N],ans[N];</span><br><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt;f[N];    <span class=\"comment\">//è¿™é‡Œçš„ vector æ˜¯å€’åºå­˜å‚¨çš„ï¼Œå› ä¸ºè¦åœ¨ç»§æ‰¿é‡å„¿å­çš„ä¿¡æ¯åï¼Œè¦å°†å½“å‰èŠ‚ç‚¹çš„ DP æ•°ç»„æœ€å‰é¢æ’å…¥ä¸€ä¸ªå…ƒç´ ï¼Œè€Œ push_back çš„å¤æ‚åº¦ä¼˜äº pop_frontï¼Œå€’åºå­˜å‚¨å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ push_back </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"type\">int</span> x,<span class=\"type\">int</span> y)</span></span>&#123;</span><br><span class=\"line\">    to[++cnt]=y,nxt[cnt]=hd[x],hd[x]=cnt;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">get</span><span class=\"params\">(<span class=\"type\">int</span> x,<span class=\"type\">int</span> id)</span></span>&#123;    <span class=\"comment\">//ç”±äº vector æ˜¯å€’åºå­˜å‚¨çš„ï¼Œæ­¤å¤„å°† vector æ­£åºå­˜å‚¨çš„ä½ç½®è½¬åŒ–ä¸ºå€’åºå­˜å‚¨çš„ä½ç½® </span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> len[x]-id<span class=\"number\">-1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">dfs1</span><span class=\"params\">(<span class=\"type\">int</span> x,<span class=\"type\">int</span> fa)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=hd[x];i;i=nxt[i])&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> y=to[i];</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(y==fa) <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        <span class=\"built_in\">dfs1</span>(y,x);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(len[y]&gt;len[son[x]]) son[x]=y;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    len[x]=len[son[x]]<span class=\"number\">+1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">dfs2</span><span class=\"params\">(<span class=\"type\">int</span> x,<span class=\"type\">int</span> fa)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(son[x]) <span class=\"built_in\">dfs2</span>(son[x],x),<span class=\"built_in\">swap</span>(f[x],f[son[x]]),ans[x]=ans[son[x]]<span class=\"number\">+1</span>;    <span class=\"comment\">//ç»§æ‰¿é‡å„¿å­çš„ä¿¡æ¯ã€‚è¿™é‡Œçš„ç»§æ‰¿ç›´æ¥ç”¨ swap è€Œä¸æ˜¯å¤åˆ¶ï¼Œswap åœ¨æ—¶é—´å’Œç©ºé—´ä¸Šéƒ½æ›´ä¼˜ï¼ˆswap äº¤æ¢ vector çš„æ—¶é—´å¤æ‚åº¦ä¸º O(1)ï¼‰ã€‚ </span></span><br><span class=\"line\">    f[x].<span class=\"built_in\">push_back</span>(<span class=\"number\">1</span>);    <span class=\"comment\">//push_back çš„å¤æ‚åº¦ä¼˜äº pop_front</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=hd[x];i;i=nxt[i])&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> y=to[i];</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(y==fa||y==son[x]) <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        <span class=\"built_in\">dfs2</span>(y,x);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">1</span>;j&lt;=len[y];j++)&#123;</span><br><span class=\"line\">            f[x][<span class=\"built_in\">get</span>(x,j)]+=f[y][<span class=\"built_in\">get</span>(y,j<span class=\"number\">-1</span>)];    <span class=\"comment\">//æš´åŠ›åˆå¹¶è½»å„¿å­çš„ä¿¡æ¯ </span></span><br><span class=\"line\">            <span class=\"keyword\">if</span>(f[x][<span class=\"built_in\">get</span>(x,j)]&gt;f[x][<span class=\"built_in\">get</span>(x,ans[x])]||(f[x][<span class=\"built_in\">get</span>(x,j)]==f[x][<span class=\"built_in\">get</span>(x,ans[x])]&amp;&amp;j&lt;ans[x])) ans[x]=j;    <span class=\"comment\">//æ›´æ–°ç­”æ¡ˆ</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(f[x][<span class=\"built_in\">get</span>(x,ans[x])]==<span class=\"number\">1</span>) ans[x]=<span class=\"number\">0</span>;    <span class=\"comment\">//f[x][0]=1,f[x][ans[x]]=1ï¼Œ0 æ˜¾ç„¶æ›´ä¼˜</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%lld&quot;</span>,&amp;n);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;n;i++)&#123;</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%lld%lld&quot;</span>,&amp;x,&amp;y);</span><br><span class=\"line\">        <span class=\"built_in\">add</span>(x,y),<span class=\"built_in\">add</span>(y,x);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">dfs1</span>(<span class=\"number\">1</span>,<span class=\"number\">0</span>),<span class=\"built_in\">dfs2</span>(<span class=\"number\">1</span>,<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%lld\\n&quot;</span>,ans[i]);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h2 id=\"9-åŠ¨æ€æ ‘-ï¼ˆLCT-Link-Cut-Treeï¼Œå®é“¾å‰–åˆ†ï¼‰\">9. åŠ¨æ€æ ‘ ï¼ˆLCT/Link-Cut Treeï¼Œå®é“¾å‰–åˆ†ï¼‰</h2>\n<p>å…³é”®è¯ï¼šåŠ¨æ€æ ‘ï¼Œä¿®æ”¹æ ‘ç»“æ„åæ ‘ä¸ŠåŒºé—´æ“ä½œã€åºåˆ—åŒ–æ“ä½œã€‚</p>\n<p><em><strong>æ³¨æ„ï¼Œåºåˆ—ä¸Šçš„è·³è·ƒåŒæ ·å¯ä»¥è§†ä½œä¸€æ£µæ ‘æ¥è§£å†³é—®é¢˜</strong></em></p>\n<p>ç»´æŠ¤ä¸€ä¸ª <strong>æ£®æ—</strong>ï¼Œæ”¯æŒåˆ é™¤æŸæ¡è¾¹ï¼ŒåŠ å…¥æŸæ¡è¾¹ï¼Œå¹¶ä¿è¯åŠ è¾¹ï¼Œåˆ è¾¹ä¹‹åä»æ˜¯æ£®æ—ã€‚æˆ‘ä»¬è¦ç»´æŠ¤è¿™ä¸ªæ£®æ—çš„ä¸€äº›ä¿¡æ¯ã€‚</p>\n<p>ä¸€èˆ¬çš„æ“ä½œæœ‰ä¸¤ç‚¹è¿é€šæ€§ï¼Œä¸¤ç‚¹è·¯å¾„æƒå€¼å’Œï¼Œè¿æ¥ä¸¤ç‚¹å’Œåˆ‡æ–­æŸæ¡è¾¹ã€ä¿®æ”¹ä¿¡æ¯ç­‰ã€‚</p>\n<p>æ ¸å¿ƒæ€æƒ³æ˜¯æˆ‘è¦è°æˆ‘å°±æŠŠè°è½¬åˆ°å®é“¾ä¸Šé¢ï¼Œå…¶ä»–çš„éƒ½æ˜¯è™šé“¾ã€‚</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mi>C</mi><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">LCT</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">CT</span></span></span></span>çš„è¾…åŠ©æ ‘æ€§è´¨ï¼š</p>\n<ol>\n<li>è¾…åŠ©æ ‘ç”±å¤šæ£µ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mi>p</mi><mi>l</mi><mi>a</mi><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">Splay</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">Spl</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span> ç»„æˆï¼Œæ¯æ£µ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mi>p</mi><mi>l</mi><mi>a</mi><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">Splay</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">Spl</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span> ç»´æŠ¤åŸæ ‘ä¸­çš„ä¸€æ¡è·¯å¾„ï¼Œä¸”ä¸­åºéå†è¿™æ£µ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mi>p</mi><mi>l</mi><mi>a</mi><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">Splay</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">Spl</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span> å¾—åˆ°çš„ç‚¹åºåˆ—ï¼Œä»å‰åˆ°åå¯¹åº”åŸæ ‘ã€Œä»ä¸Šåˆ°ä¸‹ã€çš„ä¸€æ¡è·¯å¾„ã€‚</li>\n<li>åŸæ ‘æ¯ä¸ªèŠ‚ç‚¹ä¸è¾…åŠ©æ ‘çš„ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mi>p</mi><mi>l</mi><mi>a</mi><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">Splay</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">Spl</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span> èŠ‚ç‚¹ä¸€ä¸€å¯¹åº”ã€‚</li>\n<li>è¾…åŠ©æ ‘çš„å„æ£µ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mi>p</mi><mi>l</mi><mi>a</mi><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">Splay</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">Spl</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span> ä¹‹é—´å¹¶ä¸æ˜¯ç‹¬ç«‹çš„ã€‚æ¯æ£µ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mi>p</mi><mi>l</mi><mi>a</mi><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">Splay</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">Spl</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span> çš„æ ¹èŠ‚ç‚¹çš„çˆ¶äº²èŠ‚ç‚¹æœ¬åº”æ˜¯ç©ºï¼Œä½†åœ¨ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mi>C</mi><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">LCT</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">CT</span></span></span></span> ä¸­æ¯æ£µ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mi>p</mi><mi>l</mi><mi>a</mi><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">Splay</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">Spl</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span> çš„æ ¹èŠ‚ç‚¹çš„çˆ¶äº²èŠ‚ç‚¹æŒ‡å‘åŸæ ‘ä¸­ <strong>è¿™æ¡é“¾</strong> çš„çˆ¶äº²èŠ‚ç‚¹ï¼ˆå³é“¾æœ€é¡¶ç«¯çš„ç‚¹çš„çˆ¶äº²èŠ‚ç‚¹ï¼‰ã€‚è¿™ç±»çˆ¶äº²é“¾æ¥ä¸é€šå¸¸ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mi>p</mi><mi>l</mi><mi>a</mi><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">Splay</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">Spl</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span> çš„çˆ¶äº²é“¾æ¥åŒºåˆ«åœ¨äºå„¿å­è®¤çˆ¶äº²ï¼Œè€Œçˆ¶äº²ä¸è®¤å„¿å­ï¼Œå¯¹åº”åŸæ ‘çš„ä¸€æ¡ <strong>è™šè¾¹</strong>ã€‚å› æ­¤ï¼Œæ¯ä¸ªè¿é€šå—æ°å¥½æœ‰ä¸€ä¸ªç‚¹çš„çˆ¶äº²èŠ‚ç‚¹ä¸ºç©ºã€‚</li>\n<li>ç”±äºè¾…åŠ©æ ‘çš„ä»¥ä¸Šæ€§è´¨ï¼Œæˆ‘ä»¬ç»´æŠ¤ä»»ä½•æ“ä½œéƒ½ä¸éœ€è¦ç»´æŠ¤åŸæ ‘ï¼Œè¾…åŠ©æ ‘å¯ä»¥åœ¨ä»»ä½•æƒ…å†µä¸‹æ‹¿å‡ºä¸€ä¸ªå”¯ä¸€çš„åŸæ ‘ï¼Œæˆ‘ä»¬åªéœ€è¦ç»´æŠ¤è¾…åŠ©æ ‘å³å¯ã€‚</li>\n</ol>\n<p>ç¤ºä¾‹ï¼š</p>\n<p>ç»™å®š <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> ä¸ªç‚¹ä»¥åŠæ¯ä¸ªç‚¹çš„æƒå€¼ï¼Œè¦ä½ å¤„ç†æ¥ä¸‹æ¥çš„ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span> ä¸ªæ“ä½œã€‚</p>\n<p>æ“ä½œæœ‰å››ç§ï¼Œæ“ä½œä» <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span> åˆ° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span></span></span></span> ç¼–å·ã€‚ç‚¹ä» <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> åˆ° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> ç¼–å·ã€‚</p>\n<ul>\n<li><code>0 x y</code> ä»£è¡¨è¯¢é—®ä» <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> åˆ° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span> çš„è·¯å¾„ä¸Šçš„ç‚¹çš„æƒå€¼çš„ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>xor</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{xor}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord text\"><span class=\"mord\">xor</span></span></span></span></span> å’Œã€‚ä¿è¯ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> åˆ° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span> æ˜¯è”é€šçš„ã€‚</li>\n<li><code>1 x y</code> ä»£è¡¨è¿æ¥ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> åˆ° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>ï¼Œè‹¥ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> åˆ° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span> å·²ç»è”é€šåˆ™æ— éœ€è¿æ¥ã€‚</li>\n<li><code>2 x y</code> ä»£è¡¨åˆ é™¤è¾¹ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(x,y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span>ï¼Œä¸ä¿è¯è¾¹ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(x,y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span> å­˜åœ¨ã€‚</li>\n<li><code>3 x y</code> ä»£è¡¨å°†ç‚¹ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> ä¸Šçš„æƒå€¼å˜æˆ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>ã€‚</li>\n</ul>\n<p>ä¿è¯ï¼š</p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>n</mi><mo>â‰¤</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding=\"application/x-tex\">1 \\leq n \\leq 10^5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span></span></span></span></span></span></span></span>ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>m</mi><mo>â‰¤</mo><mn>3</mn><mo>Ã—</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding=\"application/x-tex\">1 \\leq m \\leq 3 \\times 10^5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span></span></span></span></span></span></span></span>ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><msub><mi>a</mi><mi>i</mi></msub><mo>â‰¤</mo><mn>1</mn><msup><mn>0</mn><mn>9</mn></msup></mrow><annotation encoding=\"application/x-tex\">1 \\leq a_i \\leq 10^9</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.786em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">9</span></span></span></span></span></span></span></span></span></span></span>ã€‚</li>\n<li>å¯¹äºæ“ä½œ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">0, 1, 2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span></span></span></span>ï¼Œä¿è¯ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo>â‰¤</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">1 \\leq x, y \\leq n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8304em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>ã€‚</li>\n<li>å¯¹äºæ“ä½œ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span></span></span></span>ï¼Œä¿è¯ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>x</mi><mo>â‰¤</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">1 \\leq x \\leq n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>y</mi><mo>â‰¤</mo><mn>1</mn><msup><mn>0</mn><mn>9</mn></msup></mrow><annotation encoding=\"application/x-tex\">1 \\leq y \\leq 10^9</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8304em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">9</span></span></span></span></span></span></span></span></span></span></span>ã€‚</li>\n</ul>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// LCTï¼ŒåŠ¨æ€æ ‘ã€å®é“¾å‰–åˆ†</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> int long long</span></span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">node</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> ch[<span class=\"number\">2</span>];</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> l ch[0]</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> r ch[1]</span></span><br><span class=\"line\">    <span class=\"type\">int</span> val = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> sum = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"comment\">// int lazytag = 0;</span></span><br><span class=\"line\">    <span class=\"comment\">// int sz = 1;</span></span><br><span class=\"line\">    <span class=\"type\">int</span> revtag = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> fa = <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">5e5</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\">node tr[maxn];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">reverse</span><span class=\"params\">(<span class=\"type\">int</span> x)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    tr[x].revtag ^= <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">bool</span> <span class=\"title\">get</span><span class=\"params\">(<span class=\"type\">int</span> x)</span> <span class=\"comment\">// è·å–xæ˜¯çˆ¶äº²èŠ‚ç‚¹çš„å“ªä¸ªå„¿å­</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> tr[tr[x].fa].r == x;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">bool</span> <span class=\"title\">isroot</span><span class=\"params\">(<span class=\"type\">int</span> x)</span> <span class=\"comment\">// åˆ¤æ–­xç»“ç‚¹æ˜¯å¦ä½œä¸ºä¸€æ£µåŠ¨æ€Splayçš„æ ¹</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> tr[tr[x].fa].l != x &amp;&amp; tr[tr[x].fa].r != x;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">pushup</span><span class=\"params\">(<span class=\"type\">int</span> rt)</span> <span class=\"comment\">// æ›´æ–°ç»“ç‚¹ä¿¡æ¯</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// other pushups;</span></span><br><span class=\"line\">    <span class=\"comment\">// tr[rt].sz = tr[tr[rt].l].sz + tr[tr[rt].r].sz + 1;</span></span><br><span class=\"line\">    tr[rt].sum = tr[tr[rt].l].sum ^ tr[tr[rt].r].sum ^ tr[rt].val;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">pushdown</span><span class=\"params\">(<span class=\"type\">int</span> x)</span> <span class=\"comment\">// æ ‘ä¸Šæ‡’æ ‡è®°ï¼Œæ–‡è‰ºå¹³è¡¡æ ‘æ ‡è®°æ˜¯åˆšéœ€æ±‚</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (tr[x].revtag)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">swap</span>(tr[x].l, tr[x].r);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tr[x].l)</span><br><span class=\"line\">            <span class=\"built_in\">reverse</span>(tr[x].l);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tr[x].r)</span><br><span class=\"line\">            <span class=\"built_in\">reverse</span>(tr[x].r);</span><br><span class=\"line\">        tr[x].revtag = <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"type\">int</span> x)</span> <span class=\"comment\">// åŠ¨xä¹‹å‰ç»“ç®—xæ‰€åœ¨æ ¹çš„æ‰€æœ‰lazytag</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!<span class=\"built_in\">isroot</span>(x))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">update</span>(tr[x].fa);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">pushdown</span>(x);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">rotate</span><span class=\"params\">(<span class=\"type\">int</span> x)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> y = tr[x].fa, z = tr[y].fa, k = <span class=\"built_in\">get</span>(x);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!<span class=\"built_in\">isroot</span>(y))</span><br><span class=\"line\">        tr[z].ch[tr[z].r == y] = x;</span><br><span class=\"line\">    <span class=\"comment\">// ä¸Šé¢è¿™å¥ä¸€å®šè¦å†™åœ¨å‰é¢ï¼Œæ™®é€šçš„ Splay æ˜¯ä¸ç”¨çš„ï¼Œå› ä¸º isRoot  (åé¢ä¼šè®²)</span></span><br><span class=\"line\">    tr[x].fa = z;</span><br><span class=\"line\">    tr[y].ch[k] = tr[x].ch[!k];</span><br><span class=\"line\">    tr[tr[x].ch[!k]].fa = y;</span><br><span class=\"line\">    tr[x].ch[!k] = y;</span><br><span class=\"line\">    tr[y].fa = x;</span><br><span class=\"line\">    <span class=\"built_in\">pushup</span>(y), <span class=\"built_in\">pushup</span>(x);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">Splay</span><span class=\"params\">(<span class=\"type\">int</span> x)</span> <span class=\"comment\">// ä¼¸å±•æ“ä½œï¼Œå°†ç»“ç‚¹ä¼¸å±•åˆ°æ ¹ã€‚</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">update</span>(x);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> fa; fa = tr[x].fa, !<span class=\"built_in\">isroot</span>(x); <span class=\"built_in\">rotate</span>(x))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!<span class=\"built_in\">isroot</span>(fa))</span><br><span class=\"line\">            <span class=\"built_in\">rotate</span>(<span class=\"built_in\">get</span>(fa) == <span class=\"built_in\">get</span>(x) ? fa : x);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">access</span><span class=\"params\">(<span class=\"type\">int</span> x)</span> <span class=\"comment\">// æ‹‰ç›´ä»xåˆ°å½“å‰åŠ¨æ€æ ‘æ ¹èŠ‚ç‚¹çš„å®è¾¹è·¯å¾„ï¼Œè¿”å›è¯¥è·¯å¾„ç»ˆç‚¹çš„Splayçš„æ ¹ï¼ˆå³è·¯å¾„ç»ˆç‚¹ï¼‰</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> p;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (p = <span class=\"number\">0</span>; x; p = x, x = tr[x].fa)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">Splay</span>(x);</span><br><span class=\"line\">        tr[x].r = p;</span><br><span class=\"line\">        <span class=\"built_in\">pushup</span>(x);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> p;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">makeroot</span><span class=\"params\">(<span class=\"type\">int</span> x)</span> <span class=\"comment\">// æ¢æ ¹æ“ä½œï¼ŒæŒ‡å®šxç»“ç‚¹æˆä¸ºåŸæ ‘ï¼ˆéè¾…åŠ©æ ‘ï¼‰çš„æ€»æ ¹</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">access</span>(x);  <span class=\"comment\">// æ‹‰å‡ºxåˆ°å½“å‰æ ¹çš„è·¯å¾„ï¼Œxå¿…ç„¶æ˜¯æ­¤æ—¶æ‰€åœ¨Splayä¸­ä¸­åºéå†çš„æœ€åä¸€ä¸ªç‚¹</span></span><br><span class=\"line\">    <span class=\"built_in\">Splay</span>(x);   <span class=\"comment\">// æ—‹æ ¹ï¼Œæ ¹æ®LCT-Splayå®šä¹‰ï¼Œè¿™æ£µSplayå¿…å®šæ²¡æœ‰å³å„¿å­</span></span><br><span class=\"line\">    <span class=\"built_in\">reverse</span>(x); <span class=\"comment\">// ç›´æ¥ç¿»è½¬Splayï¼Œè¿«ä½¿å…¶æˆä¸ºå½“å‰Splayä¸­åºéå†ç¬¬ä¸€ä¸ªè®¿é—®çš„ç‚¹ï¼Œæˆä¸ºæ·±åº¦æœ€æµ…çš„æ ¹ï¼Œå®ç°äº†æ¢è·Ÿ</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">find</span><span class=\"params\">(<span class=\"type\">int</span> p)</span> <span class=\"comment\">// æ‰¾ç»“ç‚¹påœ¨åŸæ£®æ—æ‰€å±æ ‘ï¼ˆéè¾…åŠ©Splayæ£®æ—æ ‘ï¼‰çš„æ ‘æ ¹</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">access</span>(p);</span><br><span class=\"line\">    <span class=\"built_in\">Splay</span>(p);</span><br><span class=\"line\">    <span class=\"built_in\">pushdown</span>(p);</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (tr[p].l)</span><br><span class=\"line\">        p = tr[p].l, <span class=\"built_in\">pushdown</span>(p);</span><br><span class=\"line\">    <span class=\"built_in\">Splay</span>(p);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> p;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">bool</span> <span class=\"title\">link</span><span class=\"params\">(<span class=\"type\">int</span> x, <span class=\"type\">int</span> y)</span> <span class=\"comment\">// è¿ä¸€æ¡x-&gt;yçš„è½»è¾¹</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">makeroot</span>(x);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">find</span>(y) == x)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    tr[x].fa = y;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">bool</span> <span class=\"title\">cut</span><span class=\"params\">(<span class=\"type\">int</span> x, <span class=\"type\">int</span> y)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">makeroot</span>(x);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">find</span>(y) != x || tr[y].fa != x || tr[y].l)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    tr[y].fa = tr[x].r = <span class=\"number\">0</span>; <span class=\"comment\">// xåœ¨findroot(y)åè¢«è½¬åˆ°äº†æ ¹</span></span><br><span class=\"line\">    <span class=\"built_in\">pushup</span>(x);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">split</span><span class=\"params\">(<span class=\"type\">int</span> x, <span class=\"type\">int</span> y)</span> <span class=\"comment\">// åŠ¨æ€æ ‘ä¸­æ‹†å‡ºæ¥ä¸€æ¡x-&gt;yæŒ‡å®šè·¯å¾„ï¼Œä¿è¯è·¯å¾„ä¸Šéƒ½æ˜¯å®è¾¹,ä¿è¯yåœ¨æ ¹ã€‚</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">makeroot</span>(x);</span><br><span class=\"line\">    <span class=\"built_in\">access</span>(y);</span><br><span class=\"line\">    <span class=\"built_in\">Splay</span>(y);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"type\">int</span> n, m;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> v;</span><br><span class=\"line\">        cin &gt;&gt; v;</span><br><span class=\"line\">        tr[i].val = v;</span><br><span class=\"line\">        tr[i].sum = v;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (m--)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> op, x, y;</span><br><span class=\"line\">        cin &gt;&gt; op &gt;&gt; x &gt;&gt; y;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (op == <span class=\"number\">0</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"built_in\">split</span>(x, y);</span><br><span class=\"line\">            cout &lt;&lt; tr[y].sum &lt;&lt; endl;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (op == <span class=\"number\">1</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"built_in\">link</span>(x, y);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (op == <span class=\"number\">2</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"built_in\">cut</span>(x, y);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"built_in\">Splay</span>(x); <span class=\"comment\">// èŠ‚ç‚¹ä¿®æ”¹è½¬åˆ°æ ¹å†æ”¹ï¼Œä¸ä¼šå½±å“å…¶ä»–ä¿¡æ¯</span></span><br><span class=\"line\">            tr[x].val = y;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h2 id=\"10-01Trie\">10. 01Trie</h2>\n<p>å…³äºå­—å…¸æ ‘Trieçš„å†…å®¹ï¼Œè¯¦è§<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mi>a</mi><mi>r</mi><mi>t</mi><mtext>Â </mtext><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">Part\\ 2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\">Â </span><span class=\"mord\">2</span></span></span></span>.</p>\n<h3 id=\"10-1-01Trie\">10.1 01Trie</h3>\n<p>01å­—å…¸æ ‘ã€‚å†™æ³•å‚è§å¯æŒä¹…åŒ–ï¼Œæ²¡å•¥åŒºåˆ«ã€‚</p>\n<p><code>tr[rt].cnt</code>å­˜å‚¨çš„æ˜¯ä»å½“å‰èŠ‚ç‚¹æ•°ä½å‡ºå‘è¿˜æœ‰å¤šå°‘ä¸ªæ•°å­—ï¼Œæ ¹èŠ‚ç‚¹å°±æ˜¯æ•°å­—çš„æ€»ä¸ªæ•°ã€‚</p>\n<h3 id=\"10-2-å¯æŒä¹…åŒ–01Trie\">10.2 å¯æŒä¹…åŒ–01Trie</h3>\n<p>ç»´æŠ¤åŒºé—´å¼‚æˆ–æœ€å¤§å€¼æˆ–è€…åŒºé—´ç¬¬<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span>å¤§å€¼ã€‚åŒºé—´ç¬¬<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span>å¤§å€¼ç±»ä¼¼äºä¸»å¸­æ ‘æ ‘ä¸ŠäºŒåˆ†ã€‚</p>\n<p>ç¤ºä¾‹ï¼šï¼ˆåŒºé—´æœ€å¤§å€¼ï¼‰</p>\n<p>ç»™å®šä¸€ä¸ªéè´Ÿæ•´æ•°åºåˆ— <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">{</mo><mi>a</mi><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">\\{a\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">}</span></span></span></span>ï¼Œåˆå§‹é•¿åº¦ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>ã€‚</p>\n<p>æœ‰ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>M</mi></mrow><annotation encoding=\"application/x-tex\">M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span> ä¸ªæ“ä½œï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§æ“ä½œç±»å‹ï¼š</p>\n<ol>\n<li><code>A x</code>ï¼šæ·»åŠ æ“ä½œï¼Œè¡¨ç¤ºåœ¨åºåˆ—æœ«å°¾æ·»åŠ ä¸€ä¸ªæ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>ï¼Œåºåˆ—çš„é•¿åº¦ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span> åŠ  <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>ã€‚</li>\n<li><code>Q l r x</code>ï¼šè¯¢é—®æ“ä½œï¼Œä½ éœ€è¦æ‰¾åˆ°ä¸€ä¸ªä½ç½® <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span></span></span></span>ï¼Œæ»¡è¶³ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mo>â‰¤</mo><mi>p</mi><mo>â‰¤</mo><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">l \\le p \\le r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8304em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8304em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span>ï¼Œä½¿å¾—ï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo stretchy=\"false\">[</mo><mi>p</mi><mo stretchy=\"false\">]</mo><mo>âŠ•</mo><mi>a</mi><mo stretchy=\"false\">[</mo><mi>p</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">]</mo><mo>âŠ•</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo>âŠ•</mo><mi>a</mi><mo stretchy=\"false\">[</mo><mi>N</mi><mo stretchy=\"false\">]</mo><mo>âŠ•</mo><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">a[p] \\oplus a[p+1] \\oplus ... \\oplus a[N] \\oplus x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">p</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âŠ•</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âŠ•</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">...</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âŠ•</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âŠ•</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> æœ€å¤§ï¼Œè¾“å‡ºæœ€å¤§å€¼ã€‚</li>\n</ol>\n<ul>\n<li>å¯¹äºæ‰€æœ‰æµ‹è¯•ç‚¹ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>N</mi><mo separator=\"true\">,</mo><mi>M</mi><mo>â‰¤</mo><mn>3</mn><mo>Ã—</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding=\"application/x-tex\">1\\le N,M \\le 3\\times 10 ^ 5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span></span></span></span></span></span></span></span>ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mo>â‰¤</mo><msub><mi>a</mi><mi>i</mi></msub><mo>â‰¤</mo><mn>1</mn><msup><mn>0</mn><mn>7</mn></msup></mrow><annotation encoding=\"application/x-tex\">0\\leq a_i\\leq 10 ^ 7</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.786em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">7</span></span></span></span></span></span></span></span></span></span></span>ã€‚</li>\n</ul>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">Present_Trie</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"keyword\">private</span>:</span><br><span class=\"line\">    <span class=\"keyword\">struct</span> <span class=\"title class_\">node</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> nxt[<span class=\"number\">2</span>];</span><br><span class=\"line\">        <span class=\"type\">int</span> cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    vector&lt;node&gt; tr;</span><br><span class=\"line\">    <span class=\"type\">int</span> tot = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> n;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">init</span><span class=\"params\">(<span class=\"type\">int</span> n)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>-&gt;n = n;</span><br><span class=\"line\">        tr.<span class=\"built_in\">resize</span>(n &lt;&lt; <span class=\"number\">5</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">newroot</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ++tot;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">insert</span><span class=\"params\">(<span class=\"type\">int</span> rt1, <span class=\"type\">int</span> rt2, <span class=\"type\">int</span> x)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">30</span>; i &gt;= <span class=\"number\">0</span>; i--)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> bit = (x &gt;&gt; i) &amp; <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (bit)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (!tr[rt2].nxt[<span class=\"number\">1</span>])</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    tr[rt2].nxt[<span class=\"number\">1</span>] = ++tot;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                tr[rt2].nxt[<span class=\"number\">0</span>] = tr[rt1].nxt[<span class=\"number\">0</span>];</span><br><span class=\"line\">                rt1 = tr[rt1].nxt[<span class=\"number\">1</span>];</span><br><span class=\"line\">                rt2 = tr[rt2].nxt[<span class=\"number\">1</span>];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (!tr[rt2].nxt[<span class=\"number\">0</span>])</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    tr[rt2].nxt[<span class=\"number\">0</span>] = ++tot;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                tr[rt2].nxt[<span class=\"number\">1</span>] = tr[rt1].nxt[<span class=\"number\">1</span>];</span><br><span class=\"line\">                rt1 = tr[rt1].nxt[<span class=\"number\">0</span>];</span><br><span class=\"line\">                rt2 = tr[rt2].nxt[<span class=\"number\">0</span>];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            tr[rt2].cnt = tr[rt1].cnt + <span class=\"number\">1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">query</span><span class=\"params\">(<span class=\"type\">int</span> rt1, <span class=\"type\">int</span> rt2, <span class=\"type\">int</span> x)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> ret = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">30</span>; i &gt;= <span class=\"number\">0</span>; i--)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> bit = (x &gt;&gt; i) &amp; <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (tr[tr[rt2].nxt[bit ^ <span class=\"number\">1</span>]].cnt - tr[tr[rt1].nxt[bit ^ <span class=\"number\">1</span>]].cnt &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                ret |= (<span class=\"number\">1</span> &lt;&lt; i);</span><br><span class=\"line\">                rt1 = tr[rt1].nxt[bit ^ <span class=\"number\">1</span>];</span><br><span class=\"line\">                rt2 = tr[rt2].nxt[bit ^ <span class=\"number\">1</span>];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                rt1 = tr[rt1].nxt[bit];</span><br><span class=\"line\">                rt2 = tr[rt2].nxt[bit];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ret;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">Present_Trie pt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n, q;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; q;</span><br><span class=\"line\">    <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">root</span><span class=\"params\">(n + <span class=\"number\">1</span>)</span></span>;</span><br><span class=\"line\">    pt.<span class=\"built_in\">init</span>(<span class=\"number\">1e6</span> + <span class=\"number\">9</span>);</span><br><span class=\"line\">    <span class=\"type\">int</span> calc = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> x;</span><br><span class=\"line\">        cin &gt;&gt; x;</span><br><span class=\"line\">        calc ^= x;</span><br><span class=\"line\">        root[i] = pt.<span class=\"built_in\">newroot</span>();</span><br><span class=\"line\">        pt.<span class=\"built_in\">insert</span>(root[i - <span class=\"number\">1</span>], root[i], calc);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (q--)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">char</span> c;</span><br><span class=\"line\">        <span class=\"type\">int</span> l, r, x;</span><br><span class=\"line\">        cin &gt;&gt; c;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (c == <span class=\"string\">&#x27;Q&#x27;</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            cin &gt;&gt; l &gt;&gt; r &gt;&gt; x;</span><br><span class=\"line\">            l--, r--;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (l == <span class=\"number\">0</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                cout &lt;&lt; <span class=\"built_in\">max</span>(x ^ calc, pt.<span class=\"built_in\">query</span>(root[l], root[r], x ^ calc)) &lt;&lt; endl;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                cout &lt;&lt; pt.<span class=\"built_in\">query</span>(root[l - <span class=\"number\">1</span>], root[r], x ^ calc) &lt;&lt; endl;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (c == <span class=\"string\">&#x27;A&#x27;</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            cin &gt;&gt; x;</span><br><span class=\"line\">            calc ^= x;</span><br><span class=\"line\">            root.<span class=\"built_in\">emplace_back</span>(pt.<span class=\"built_in\">newroot</span>());</span><br><span class=\"line\">            n++;</span><br><span class=\"line\">            pt.<span class=\"built_in\">insert</span>(root[n - <span class=\"number\">1</span>], root[n], calc);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h2 id=\"11-å•è°ƒæ ˆ\">11.å•è°ƒæ ˆ</h2>\n<p>å•è°ƒæ ˆï¼Œå¯ä»¥ç»´æŠ¤ä¸€ä¸ªå•è°ƒçš„åºåˆ—ï¼Œä½¿å¾—æ¯ä¸€ä¸ªå…ƒç´ è¿›æ ˆçš„æ—¶å€™ï¼Œæ‰€æœ‰æ¯”è¿™ä¸ªå…ƒç´ å°çš„æ ˆå†…å…ƒç´ å‡ä¼šè¢«å…¶æ¶ˆé™¤æˆ–è€…èåˆï¼Œæ¯”ä»–å¤§çš„æ ˆå†…å…ƒç´ ä¸ä¼šä¸å…¶æ¶ˆé™¤æˆ–è€…èåˆã€‚æœ€å…¸å‹çš„ä¾‹å­å°±æ˜¯ç»´æŠ¤æŸä¸ªæ•°æœ€å·¦ä¾§å’Œæœ€å³ä¾§ç¬¬ä¸€ä¸ªæ¯”å…¶å¤§çš„æ•°ã€‚ä½†æ˜¯å•è°ƒæ ˆå¹¶ä¸å±€é™äºæ­¤ï¼š</p>\n<p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span> çš„æ•°ç»„ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span> ã€‚æ‚¨å¯ä»¥æ‰§è¡Œä»¥ä¸‹ä»»æ„æ¬¡æ“ä½œï¼ˆå¯èƒ½æ˜¯é›¶æ¬¡ï¼‰ï¼š</p>\n<ul>\n<li>é€‰æ‹©ä¸¤ä¸ªä¸åŒçš„ç´¢å¼• <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> å’Œ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span> ï¼Œå…¶ä¸­ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn mathvariant=\"bold\">1</mn><mo>â‰¤</mo><mi mathvariant=\"bold\">i</mi><mo>&lt;</mo><mi mathvariant=\"bold\">j</mi><mo>â‰¤</mo><mi mathvariant=\"bold\">m</mi></mrow><annotation encoding=\"application/x-tex\">\\bf{1\\le i &lt; j\\le m}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathbf\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathbf\">j</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathbf\">m</span></span></span></span></span></span> å’Œ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">b_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> ä¸ºå¶æ•°ï¼Œå°† <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">b_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> é™¤ä»¥ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span> ï¼Œå¹¶å°† <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>b</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">b_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span> ä¹˜ä»¥ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span> ã€‚</li>\n</ul>\n<p>æ‚¨çš„ä»»åŠ¡æ˜¯åœ¨æ‰§è¡Œä»»æ„æ•°é‡çš„æ­¤ç±»æ“ä½œåæœ€å¤§åŒ–æ•°ç»„çš„æ€»å’Œã€‚ç”±äºå®ƒå¯èƒ½å¾ˆå¤§ï¼Œè¯·è¾“å‡ºæ­¤æ€»å’Œæ¨¡æ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><msup><mn>0</mn><mn>9</mn></msup><mo>+</mo><mn>7</mn></mrow><annotation encoding=\"application/x-tex\">10^9+7</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8974em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">9</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">7</span></span></span></span> ã€‚</p>\n<p>ç”±äºè¿™é“é¢˜å¤ªç®€å•äº†ï¼Œç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> çš„æ•°ç»„ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span> ï¼Œä½ éœ€è¦å¯¹ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span> çš„æ¯ä¸ªå‰ç¼€è¿›è¡Œæ±‚è§£ã€‚</p>\n<p>æ¢å¥è¯è¯´ï¼Œè¡¨ç¤ºåœ¨æ‰§è¡Œä»»æ„æ•°é‡çš„ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>b</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(b)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">b</span><span class=\"mclose\">)</span></span></span></span> ç­‰è¿ç®—å <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span> çš„æœ€å¤§å’Œï¼Œä½ éœ€è¦åˆ†åˆ«è¾“å‡º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">[</mo><msub><mi>a</mi><mn>1</mn></msub><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f([a_1])</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">([</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">])</span></span></span></span> ã€ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">[</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f([a_1,a_2])</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">([</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">])</span></span></span></span> ã€ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>â€¦</mo></mrow><annotation encoding=\"application/x-tex\">\\ldots</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.123em;\"></span><span class=\"minner\">â€¦</span></span></span></span> ã€ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">[</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>â€¦</mo><mo separator=\"true\">,</mo><msub><mi>a</mi><mi>n</mi></msub><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f([a_1,a_2,\\ldots,a_n])</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">([</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">â€¦</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">])</span></span></span></span> æ¨¡æ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><msup><mn>0</mn><mn>9</mn></msup><mo>+</mo><mn>7</mn></mrow><annotation encoding=\"application/x-tex\">10^9+7</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8974em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">9</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">7</span></span></span></span> ã€‚</p>\n<p>ä¸éš¾è€ƒè™‘åˆ°æ¯ä¸ªæ•°æ–°åŠ è¿›åºåˆ—çš„æ—¶å€™ï¼Œæ‰€æœ‰æ¯”è¿™ä¸ªæ•°å°çš„åº•æ•°ï¼ˆé™¤å°½2ä»¥åçš„æ•°ï¼‰æ‰€åŒ…å«2çš„ä¸ªæ•°éƒ½è¦åŠ åˆ°æ–°æ•°å­—ä¸Šã€‚å¾ˆåƒä¸€ä¸ªçº¿æ®µæ ‘åŒºé—´æŸ¥ï¼Œä½†æ˜¯è¿™ä¼šå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼š</p>\n<p>æ ·ä¾‹ï¼š 18 2 7</p>\n<p>æ–°åŠ å…¥çš„7æ˜¾ç„¶æŸ¥ä¸åˆ°9åº•ä¸Šçš„ä¸€ä¸ª2ï¼Œä½†æ˜¯14å¯ä»¥æŸ¥åˆ°ã€‚çº¿æ®µæ ‘æœ€åå¤æ‚åº¦æ˜¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mi>l</mi><mi>o</mi><msup><mi>g</mi><mn>2</mn></msup><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">nlog^2n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0085em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\">n</span></span></span></span>çš„ã€‚ï¼ˆå®é™…ä¸Šæ ¹æ®è¿ç®—ç‰¹æ€§åˆ†æï¼Œèƒ½å¤Ÿå¡æ»¡<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mi>o</mi><msup><mi>g</mi><mn>2</mn></msup><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">log^2n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0085em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\">n</span></span></span></span>å•æ¬¡è¯¢é—®çš„æƒ…å†µæœ€å¤šåªæœ‰<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">logn</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">n</span></span></span></span>æ¬¡ï¼Œæ‰€ä»¥çœŸå®å®é™…å¤æ‚åº¦ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi><mo>+</mo><mi>l</mi><mi>o</mi><msup><mi>g</mi><mn>3</mn></msup><mi>n</mi><mo>â†’</mo><mi>n</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">nlogn+log^3n\\rightarrow nlogn</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0085em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â†’</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">n</span></span></span></span>çš„å¤æ‚åº¦ï¼‰</p>\n<p>æ‰€ä»¥ï¼Œæ¯”å½“å‰æ•°å°çš„å‡å¯ä»¥åˆå¹¶ï¼Œæ¯”å½“å‰æ•°å¤§çš„å‡æ— æ³•åˆå¹¶ï¼Œç¬¦åˆå•è°ƒæ ˆå®šä¹‰ï¼š</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">solve</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    mint tmpsum = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"function\">vector&lt;i64&gt; <span class=\"title\">a</span><span class=\"params\">(n + <span class=\"number\">1</span>)</span></span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">        cin &gt;&gt; a[i];</span><br><span class=\"line\">    stack&lt;pair&lt;i64, i64&gt;&gt; st;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> k = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (a[i] % <span class=\"number\">2</span> == <span class=\"number\">0</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            k++;</span><br><span class=\"line\">            a[i] &gt;&gt;= <span class=\"number\">1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (!st.<span class=\"built_in\">empty</span>() &amp;&amp; (k &gt;= <span class=\"number\">30</span> || (a[i] &lt;&lt; k) &gt; st.<span class=\"built_in\">top</span>().first))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">auto</span> [num, cnt] = st.<span class=\"built_in\">top</span>();</span><br><span class=\"line\">            st.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">            tmpsum -= <span class=\"built_in\">power</span>(<span class=\"built_in\">mint</span>(<span class=\"number\">2</span>), cnt) * num;</span><br><span class=\"line\">            tmpsum += num;</span><br><span class=\"line\">            k += cnt;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        st.<span class=\"built_in\">push</span>(&#123;a[i], k&#125;);</span><br><span class=\"line\">        tmpsum += <span class=\"built_in\">mint</span>(a[i]) * <span class=\"built_in\">power</span>(<span class=\"built_in\">mint</span>(<span class=\"number\">2</span>), k);</span><br><span class=\"line\">        cout &lt;&lt; tmpsum &lt;&lt; <span class=\"string\">&quot; &quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; endl;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h1>Part 2. æ•°å­¦</h1>\n<h3 id=\"0-Modint-h\">0. Modint.h</h3>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">ifndef</span> __MODINT_H__</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> __MODINT_H__</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> i64 = <span class=\"type\">long</span> <span class=\"type\">long</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">namespace</span> Modint</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">template</span> &lt;<span class=\"keyword\">class</span> <span class=\"title class_\">T</span>&gt;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">constexpr</span> T <span class=\"title\">power</span><span class=\"params\">(T a, i64 b)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        T res = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (; b; b /= <span class=\"number\">2</span>, a *= a)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (b % <span class=\"number\">2</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                res *= a;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">constexpr</span> i64 <span class=\"title\">mul</span><span class=\"params\">(i64 a, i64 b, i64 p)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        i64 res = a * b - (i64)(<span class=\"number\">1.L</span> * a * b / p) * p;</span><br><span class=\"line\">        res %= p;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (res &lt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            res += p;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">     * @brief æ¨¡è¿ç®—ï¼ˆi64ï¼‰ï¼Œjianglyç‰ˆæœ¬ï¼Œæ”¯æŒåŠ¨æ€æ¨¡æ•°æ”¹å˜</span></span><br><span class=\"line\"><span class=\"comment\">     * @param P æ¨¡æ•°ï¼Œä»…æ”¯æŒè´¨æ•°ã€‚å¦‚æœé€‰æ‹©åŠ¨æ€å®šä¹‰æ¨¡æ•°ï¼ŒP=0ï¼Œä¸”å¿…é¡»è°ƒç”¨setModå‡½æ•°è®¾ç½®æ¨¡æ•°ã€‚é»˜è®¤ä¸º1e18+9</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">template</span> &lt;i64 P&gt;</span><br><span class=\"line\">    <span class=\"keyword\">struct</span> <span class=\"title class_\">MLong</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        i64 x;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">constexpr</span> <span class=\"title\">MLong</span><span class=\"params\">()</span> : x&#123;</span>&#125; &#123;&#125;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">constexpr</span> <span class=\"title\">MLong</span><span class=\"params\">(i64 x)</span> : x&#123;</span><span class=\"built_in\">norm</span>(x % <span class=\"built_in\">getMod</span>())&#125; &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">static</span> i64 Mod;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">constexpr</span> <span class=\"type\">static</span> i64 <span class=\"title\">getMod</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (P &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> P;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> Mod;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">constexpr</span> <span class=\"type\">static</span> <span class=\"type\">void</span> <span class=\"title\">setMod</span><span class=\"params\">(i64 Mod_)</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            Mod = Mod_;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">constexpr</span> i64 <span class=\"title\">norm</span><span class=\"params\">(i64 x)</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (x &lt; <span class=\"number\">0</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                x += <span class=\"built_in\">getMod</span>();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (x &gt;= <span class=\"built_in\">getMod</span>())</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                x -= <span class=\"built_in\">getMod</span>();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> x;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">constexpr</span> i64 <span class=\"title\">val</span><span class=\"params\">()</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> x;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">explicit</span> <span class=\"keyword\">constexpr</span> <span class=\"keyword\">operator</span> <span class=\"title\">i64</span><span class=\"params\">()</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> x;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">constexpr</span> MLong <span class=\"keyword\">operator</span>-() <span class=\"type\">const</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            MLong res;</span><br><span class=\"line\">            res.x = <span class=\"built_in\">norm</span>(<span class=\"built_in\">getMod</span>() - x);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">constexpr</span> MLong <span class=\"title\">inv</span><span class=\"params\">()</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"built_in\">assert</span>(x != <span class=\"number\">0</span>);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">power</span>(*<span class=\"keyword\">this</span>, <span class=\"built_in\">getMod</span>() - <span class=\"number\">2</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">constexpr</span> MLong &amp;<span class=\"keyword\">operator</span>*=(MLong rhs) &amp;</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            x = <span class=\"built_in\">mul</span>(x, rhs.x, <span class=\"built_in\">getMod</span>());</span><br><span class=\"line\">            <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">constexpr</span> MLong &amp;<span class=\"keyword\">operator</span>+=(MLong rhs) &amp;</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            x = <span class=\"built_in\">norm</span>(x + rhs.x);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">constexpr</span> MLong &amp;<span class=\"keyword\">operator</span>-=(MLong rhs) &amp;</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            x = <span class=\"built_in\">norm</span>(x - rhs.x);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">constexpr</span> MLong &amp;<span class=\"keyword\">operator</span>/=(MLong rhs) &amp;</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span> *= rhs.<span class=\"built_in\">inv</span>();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">friend</span> <span class=\"keyword\">constexpr</span> MLong <span class=\"keyword\">operator</span>*(MLong lhs, MLong rhs)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            MLong res = lhs;</span><br><span class=\"line\">            res *= rhs;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">friend</span> <span class=\"keyword\">constexpr</span> MLong <span class=\"keyword\">operator</span>+(MLong lhs, MLong rhs)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            MLong res = lhs;</span><br><span class=\"line\">            res += rhs;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">friend</span> <span class=\"keyword\">constexpr</span> MLong <span class=\"keyword\">operator</span>-(MLong lhs, MLong rhs)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            MLong res = lhs;</span><br><span class=\"line\">            res -= rhs;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">friend</span> <span class=\"keyword\">constexpr</span> MLong <span class=\"keyword\">operator</span>/(MLong lhs, MLong rhs)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            MLong res = lhs;</span><br><span class=\"line\">            res /= rhs;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">friend</span> <span class=\"keyword\">constexpr</span> std::istream &amp;<span class=\"keyword\">operator</span>&gt;&gt;(std::istream &amp;is, MLong &amp;a)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            i64 v;</span><br><span class=\"line\">            is &gt;&gt; v;</span><br><span class=\"line\">            a = <span class=\"built_in\">MLong</span>(v);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> is;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">friend</span> <span class=\"keyword\">constexpr</span> std::ostream &amp;<span class=\"keyword\">operator</span>&lt;&lt;(std::ostream &amp;os, <span class=\"type\">const</span> MLong &amp;a)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> os &lt;&lt; a.<span class=\"built_in\">val</span>();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">friend</span> <span class=\"keyword\">constexpr</span> <span class=\"type\">bool</span> <span class=\"keyword\">operator</span>==(MLong lhs, MLong rhs)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> lhs.<span class=\"built_in\">val</span>() == rhs.<span class=\"built_in\">val</span>();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">friend</span> <span class=\"keyword\">constexpr</span> <span class=\"type\">bool</span> <span class=\"keyword\">operator</span>!=(MLong lhs, MLong rhs)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> lhs.<span class=\"built_in\">val</span>() != rhs.<span class=\"built_in\">val</span>();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">template</span> &lt;&gt;</span><br><span class=\"line\">    i64 MLong&lt;<span class=\"number\">0LL</span>&gt;::Mod = (i64)(<span class=\"number\">1E18</span>) + <span class=\"number\">9</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/*template &lt;i64 V, i64 P&gt;</span></span><br><span class=\"line\"><span class=\"comment\">    constexpr MLong&lt;P&gt; CInv = MLong&lt;P&gt;(V).inv();*/</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">     * @brief æ¨¡è¿ç®—ï¼ˆintï¼‰ï¼Œjianglyç‰ˆæœ¬ï¼Œæ”¯æŒåŠ¨æ€æ¨¡æ•°æ”¹å˜</span></span><br><span class=\"line\"><span class=\"comment\">     * @param P æ¨¡æ•°ï¼Œä»…æ”¯æŒè´¨æ•°ã€‚å¦‚æœé€‰æ‹©åŠ¨æ€å®šä¹‰æ¨¡æ•°ï¼ŒP=0ï¼Œä¸”å¿…é¡»è°ƒç”¨setModå‡½æ•°è®¾ç½®æ¨¡æ•°ã€‚é»˜è®¤ä¸º998244353</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">template</span> &lt;<span class=\"type\">int</span> P&gt;</span><br><span class=\"line\">    <span class=\"keyword\">struct</span> <span class=\"title class_\">MInt</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> x;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">constexpr</span> <span class=\"title\">MInt</span><span class=\"params\">()</span> : x&#123;</span>&#125; &#123;&#125;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">constexpr</span> <span class=\"title\">MInt</span><span class=\"params\">(i64 x)</span> : x&#123;</span><span class=\"built_in\">norm</span>(x % <span class=\"built_in\">getMod</span>())&#125; &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">static</span> <span class=\"type\">int</span> Mod;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">constexpr</span> <span class=\"type\">static</span> <span class=\"type\">int</span> <span class=\"title\">getMod</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (P &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> P;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> Mod;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">constexpr</span> <span class=\"type\">static</span> <span class=\"type\">void</span> <span class=\"title\">setMod</span><span class=\"params\">(<span class=\"type\">int</span> Mod_)</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            Mod = Mod_;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">constexpr</span> <span class=\"type\">int</span> <span class=\"title\">norm</span><span class=\"params\">(<span class=\"type\">int</span> x)</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (x &lt; <span class=\"number\">0</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                x += <span class=\"built_in\">getMod</span>();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (x &gt;= <span class=\"built_in\">getMod</span>())</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                x -= <span class=\"built_in\">getMod</span>();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> x;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">constexpr</span> <span class=\"type\">int</span> <span class=\"title\">val</span><span class=\"params\">()</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> x;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">explicit</span> <span class=\"keyword\">constexpr</span> <span class=\"keyword\">operator</span> <span class=\"title\">int</span><span class=\"params\">()</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> x;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">constexpr</span> MInt <span class=\"keyword\">operator</span>-() <span class=\"type\">const</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            MInt res;</span><br><span class=\"line\">            res.x = <span class=\"built_in\">norm</span>(<span class=\"built_in\">getMod</span>() - x);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">constexpr</span> MInt <span class=\"title\">inv</span><span class=\"params\">()</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"built_in\">assert</span>(x != <span class=\"number\">0</span>);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">power</span>(*<span class=\"keyword\">this</span>, <span class=\"built_in\">getMod</span>() - <span class=\"number\">2</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">constexpr</span> MInt &amp;<span class=\"keyword\">operator</span>*=(MInt rhs) &amp;</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            x = <span class=\"number\">1LL</span> * x * rhs.x % <span class=\"built_in\">getMod</span>();</span><br><span class=\"line\">            <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">constexpr</span> MInt &amp;<span class=\"keyword\">operator</span>+=(MInt rhs) &amp;</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            x = <span class=\"built_in\">norm</span>(x + rhs.x);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">constexpr</span> MInt &amp;<span class=\"keyword\">operator</span>-=(MInt rhs) &amp;</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            x = <span class=\"built_in\">norm</span>(x - rhs.x);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">constexpr</span> MInt &amp;<span class=\"keyword\">operator</span>/=(MInt rhs) &amp;</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span> *= rhs.<span class=\"built_in\">inv</span>();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">friend</span> <span class=\"keyword\">constexpr</span> MInt <span class=\"keyword\">operator</span>*(MInt lhs, MInt rhs)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            MInt res = lhs;</span><br><span class=\"line\">            res *= rhs;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">friend</span> <span class=\"keyword\">constexpr</span> MInt <span class=\"keyword\">operator</span>+(MInt lhs, MInt rhs)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            MInt res = lhs;</span><br><span class=\"line\">            res += rhs;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">friend</span> <span class=\"keyword\">constexpr</span> MInt <span class=\"keyword\">operator</span>-(MInt lhs, MInt rhs)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            MInt res = lhs;</span><br><span class=\"line\">            res -= rhs;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">friend</span> <span class=\"keyword\">constexpr</span> MInt <span class=\"keyword\">operator</span>/(MInt lhs, MInt rhs)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            MInt res = lhs;</span><br><span class=\"line\">            res /= rhs;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">friend</span> <span class=\"keyword\">constexpr</span> std::istream &amp;<span class=\"keyword\">operator</span>&gt;&gt;(std::istream &amp;is, MInt &amp;a)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            i64 v;</span><br><span class=\"line\">            is &gt;&gt; v;</span><br><span class=\"line\">            a = <span class=\"built_in\">MInt</span>(v);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> is;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">friend</span> <span class=\"keyword\">constexpr</span> std::ostream &amp;<span class=\"keyword\">operator</span>&lt;&lt;(std::ostream &amp;os, <span class=\"type\">const</span> MInt &amp;a)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> os &lt;&lt; a.<span class=\"built_in\">val</span>();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">friend</span> <span class=\"keyword\">constexpr</span> <span class=\"type\">bool</span> <span class=\"keyword\">operator</span>==(MInt lhs, MInt rhs)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> lhs.<span class=\"built_in\">val</span>() == rhs.<span class=\"built_in\">val</span>();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">friend</span> <span class=\"keyword\">constexpr</span> <span class=\"type\">bool</span> <span class=\"keyword\">operator</span>!=(MInt lhs, MInt rhs)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> lhs.<span class=\"built_in\">val</span>() != rhs.<span class=\"built_in\">val</span>();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">template</span> &lt;&gt;</span><br><span class=\"line\">    <span class=\"type\">int</span> MInt&lt;<span class=\"number\">0</span>&gt;::Mod = <span class=\"number\">998244353</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// é€†å…ƒ</span></span><br><span class=\"line\">    <span class=\"keyword\">template</span> &lt;<span class=\"type\">int</span> V, <span class=\"type\">int</span> P&gt;</span><br><span class=\"line\">    <span class=\"keyword\">constexpr</span> MInt&lt;P&gt; CInv = <span class=\"built_in\">MInt</span>&lt;P&gt;(V).<span class=\"built_in\">inv</span>();</span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">     * @brief é˜¶ä¹˜ç±»(é€‚é…Jianglyæ¨¡æ¿ï¼‰ï¼Œæ”¯æŒè®¡ç®—ç»„åˆæ•°ï¼Œæ’åˆ—æ•°ç­‰æ“ä½œï¼Œå¤æ‚åº¦O(n),é…å¥—jianglyç‰ˆæœ¬çš„æ¨¡è¿ç®—ç±»</span></span><br><span class=\"line\"><span class=\"comment\">     * @brief å°æ•°æ®æ—¶éœ€è¦ç»„åˆæ•°å»ºè®®ä½¿ç”¨ç»„åˆæ•°è¡¨ï¼ˆæ¨è¾‰ä¸‰è§’ï¼‰ï¼Œå¤§æ•°æ®æ—¶éœ€è¦ç»„åˆæ•°å»ºè®®ä½¿ç”¨Lucaså®šç†</span></span><br><span class=\"line\"><span class=\"comment\">     * @param MOD æ¨¡æ•°ï¼Œä¸€èˆ¬å–è´¨æ•°ï¼Œéƒ¨åˆ†åˆæ•°æƒ…å†µä¸‹å¯èƒ½æ²¡æœ‰é€†å…ƒã€‚</span></span><br><span class=\"line\"><span class=\"comment\">     * @note æ”¯æŒè®¡ç®—ç»„åˆæ•°ï¼Œå¯ä»¥ä½¿ç”¨C(n,k)è®¡ç®—ç»„åˆæ•°ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">     * @note æ”¯æŒè®¡ç®—æ’åˆ—æ•°ï¼Œå¯ä»¥ä½¿ç”¨A(n,k)è®¡ç®—æ’åˆ—æ•°ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">template</span> &lt;<span class=\"keyword\">class</span> <span class=\"title class_\">T</span>&gt;</span><br><span class=\"line\">    <span class=\"keyword\">struct</span> <span class=\"title class_\">Fact</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        std::vector&lt;T&gt; fact, factinv;</span><br><span class=\"line\">        <span class=\"type\">const</span> <span class=\"type\">int</span> n;</span><br><span class=\"line\">        <span class=\"built_in\">Fact</span>(<span class=\"type\">const</span> <span class=\"type\">int</span> &amp;_n) : <span class=\"built_in\">n</span>(_n), <span class=\"built_in\">fact</span>(_n + <span class=\"number\">1</span>, <span class=\"number\">1</span>), <span class=\"built_in\">factinv</span>(_n + <span class=\"number\">1</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; ++i)</span><br><span class=\"line\">                fact[i] = fact[i - <span class=\"number\">1</span>] * i;</span><br><span class=\"line\">            factinv[n] = fact[n].<span class=\"built_in\">inv</span>();</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = n; i; --i)</span><br><span class=\"line\">                factinv[i - <span class=\"number\">1</span>] = factinv[i] * i;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"function\">T <span class=\"title\">C</span><span class=\"params\">(<span class=\"type\">const</span> <span class=\"type\">int</span> &amp;n, <span class=\"type\">const</span> <span class=\"type\">int</span> &amp;k)</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (n &lt; <span class=\"number\">0</span> || k &lt; <span class=\"number\">0</span> || n &lt; k)</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> fact[n] * factinv[k] * factinv[n - k];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"function\">T <span class=\"title\">A</span><span class=\"params\">(<span class=\"type\">const</span> <span class=\"type\">int</span> &amp;n, <span class=\"type\">const</span> <span class=\"type\">int</span> &amp;k)</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (n &lt; <span class=\"number\">0</span> || k &lt; <span class=\"number\">0</span> || n &lt; k)</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> fact[n] * factinv[n - k];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">endif</span> <span class=\"comment\">//__MODINT_H__</span></span></span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"1-æ•°è®ºç›¸å…³\">1. æ•°è®ºç›¸å…³</h3>\n<h4 id=\"1-1-å¤§è´¨æ•°åˆ¤å®šï¼ˆMiller-Rabinç´ æ€§æµ‹è¯•ï¼‰\">1.1 å¤§è´¨æ•°åˆ¤å®šï¼ˆMiller-Rabinç´ æ€§æµ‹è¯•ï¼‰</h4>\n<p>ä»¥<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(logN)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>å¤æ‚åº¦ï¼Œä»¥è¾ƒé«˜æ­£ç¡®æ€§åˆ¤å®šè´¨æ•°ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> i64 long long</span></span><br><span class=\"line\">    <span class=\"function\">i64 <span class=\"title\">mul</span><span class=\"params\">(i64 a, i64 b, i64 m)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">static_cast</span>&lt;__int128&gt;(a) * b % m;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">i64 <span class=\"title\">power</span><span class=\"params\">(i64 a, i64 b, i64 m)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        i64 res = <span class=\"number\">1</span> % m;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (; b; b &gt;&gt;= <span class=\"number\">1</span>, a = <span class=\"built_in\">mul</span>(a, a, m))</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (b &amp; <span class=\"number\">1</span>)</span><br><span class=\"line\">                res = <span class=\"built_in\">mul</span>(res, a, m);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/* @brief Miller-Rabin ç´ æ€§æµ‹è¯•,æ—¶é—´å¤æ‚åº¦ä¸º O(log n)</span></span><br><span class=\"line\"><span class=\"comment\">     * @param n å¾…æµ‹è¯•çš„æ•°ï¼Œä¸å¤§äº 1e18</span></span><br><span class=\"line\"><span class=\"comment\">     * @return true ä¸ºç´ æ•°ï¼Œfalse ä¸ºåˆæ•°*/</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">bool</span> <span class=\"title\">isprime</span><span class=\"params\">(i64 n)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (n &lt; <span class=\"number\">2</span>)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">        <span class=\"type\">static</span> <span class=\"keyword\">constexpr</span> <span class=\"type\">int</span> A[] = &#123;<span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">7</span>, <span class=\"number\">11</span>, <span class=\"number\">13</span>, <span class=\"number\">17</span>, <span class=\"number\">19</span>, <span class=\"number\">23</span>&#125;;</span><br><span class=\"line\">        <span class=\"type\">int</span> s = __builtin_ctzll(n - <span class=\"number\">1</span>);</span><br><span class=\"line\">        i64 d = (n - <span class=\"number\">1</span>) &gt;&gt; s;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> a : A)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (a == n)</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">            i64 x = <span class=\"built_in\">power</span>(a, d, n);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (x == <span class=\"number\">1</span> || x == n - <span class=\"number\">1</span>)</span><br><span class=\"line\">                <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">            <span class=\"type\">bool</span> ok = <span class=\"literal\">false</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; s - <span class=\"number\">1</span>; ++i)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                x = <span class=\"built_in\">mul</span>(x, x, n);</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (x == n - <span class=\"number\">1</span>)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    ok = <span class=\"literal\">true</span>;</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!ok)</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"1-2-è´¨å› æ•°åˆ†è§£\">1.2 è´¨å› æ•°åˆ†è§£</h4>\n<h5 id=\"1-2-1-å°æ•°å­—è´¨å› æ•°åˆ†è§£\">1.2.1  å°æ•°å­—è´¨å› æ•°åˆ†è§£</h5>\n<p>ä»¥<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><msqrt><mi>N</mi></msqrt><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N\\sqrt N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1767em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9267em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;padding-left:0.833em;\">N</span></span><span style=\"top:-2.8867em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"1.08em\" viewBox=\"0 0 400000 1080\" preserveAspectRatio=\"xMinYMin slice\"><path d=\"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z\"/></svg></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1133em;\"><span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>å¤æ‚åº¦åˆ†è§£è´¨å› æ•°ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">breakdown</span><span class=\"params\">(<span class=\"type\">int</span> N)</span> </span>&#123;</span><br><span class=\"line\">  vector&lt;<span class=\"type\">int</span>&gt; result;</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">2</span>; i * i &lt;= N; i++) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (N % i == <span class=\"number\">0</span>) &#123;  <span class=\"comment\">// å¦‚æœ i èƒ½å¤Ÿæ•´é™¤ Nï¼Œè¯´æ˜ i ä¸º N çš„ä¸€ä¸ªè´¨å› å­ã€‚</span></span><br><span class=\"line\">      <span class=\"keyword\">while</span> (N % i == <span class=\"number\">0</span>) N /= i;</span><br><span class=\"line\">      result.<span class=\"built_in\">push_back</span>(i);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (N != <span class=\"number\">1</span>) &#123;  <span class=\"comment\">// è¯´æ˜å†ç»è¿‡æ“ä½œä¹‹å N ç•™ä¸‹äº†ä¸€ä¸ªç´ æ•°</span></span><br><span class=\"line\">    result.<span class=\"built_in\">push_back</span>(N);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"1-2-2-å¤§è´¨æ•°è´¨å› æ•°åˆ†è§£ï¼ˆPollar-Rhoç®—æ³•ï¼‰\">1.2.2 å¤§è´¨æ•°è´¨å› æ•°åˆ†è§£ï¼ˆPollar-Rhoç®—æ³•ï¼‰</h5>\n<p>ä»¥æœŸæœ›å¤æ‚åº¦<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mfrac><mn>1</mn><mn>4</mn></mfrac></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N^{\\frac{1}{4}})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.204em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.954em;\"><span style=\"top:-3.363em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mopen nulldelimiter sizing reset-size3 size6\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8443em;\"><span style=\"top:-2.656em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">4</span></span></span></span><span style=\"top:-3.2255em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line mtight\" style=\"border-bottom-width:0.049em;\"></span></span><span style=\"top:-3.384em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.344em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter sizing reset-size3 size6\"></span></span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>å¤æ‚åº¦åˆ†è§£è´¨å› æ•°ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">namespace</span> Prime</span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"keyword\">using</span> i64=<span class=\"type\">long</span> <span class=\"type\">long</span>;</span><br><span class=\"line\">    <span class=\"function\">i64 <span class=\"title\">mul</span><span class=\"params\">(i64 a, i64 b, i64 m)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">static_cast</span>&lt;__int128&gt;(a) * b % m;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">i64 <span class=\"title\">power</span><span class=\"params\">(i64 a, i64 b, i64 m)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        i64 res = <span class=\"number\">1</span> % m;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (; b; b &gt;&gt;= <span class=\"number\">1</span>, a = <span class=\"built_in\">mul</span>(a, a, m))</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (b &amp; <span class=\"number\">1</span>)</span><br><span class=\"line\">                res = <span class=\"built_in\">mul</span>(res, a, m);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/* @brief Miller-Rabin ç´ æ€§æµ‹è¯•,æ—¶é—´å¤æ‚åº¦ä¸º O(log n)</span></span><br><span class=\"line\"><span class=\"comment\">     * @param n å¾…æµ‹è¯•çš„æ•°ï¼Œä¸å¤§äº 1e18</span></span><br><span class=\"line\"><span class=\"comment\">     * @return true ä¸ºç´ æ•°ï¼Œfalse ä¸ºåˆæ•°</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">bool</span> <span class=\"title\">isprime</span><span class=\"params\">(i64 n)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (n &lt; <span class=\"number\">2</span>)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">        <span class=\"type\">static</span> <span class=\"keyword\">constexpr</span> <span class=\"type\">int</span> A[] = &#123;<span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">7</span>, <span class=\"number\">11</span>, <span class=\"number\">13</span>, <span class=\"number\">17</span>, <span class=\"number\">19</span>, <span class=\"number\">23</span>&#125;;</span><br><span class=\"line\">        <span class=\"type\">int</span> s = __builtin_ctzll(n - <span class=\"number\">1</span>);</span><br><span class=\"line\">        i64 d = (n - <span class=\"number\">1</span>) &gt;&gt; s;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> a : A)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (a == n)</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">            i64 x = <span class=\"built_in\">power</span>(a, d, n);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (x == <span class=\"number\">1</span> || x == n - <span class=\"number\">1</span>)</span><br><span class=\"line\">                <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">            <span class=\"type\">bool</span> ok = <span class=\"literal\">false</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; s - <span class=\"number\">1</span>; ++i)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                x = <span class=\"built_in\">mul</span>(x, x, n);</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (x == n - <span class=\"number\">1</span>)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    ok = <span class=\"literal\">true</span>;</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!ok)</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/* @brief ç´ å› å­åˆ†è§£ï¼ˆPollard-Rho ç®—æ³•ï¼‰,æ—¶é—´å¤æ‚åº¦æœŸæœ›ä¸º O(n^(1/4))ï¼Œæœ€åä¸º O(n^(1/2))ï¼Œæœ¬å‡½æ•°å¤æ‚åº¦å¸¦æ’åºï¼Œå…·ä½“å¤æ‚åº¦å¾…å®šï¼Œå¯ä¼°ç®—ä¸ºäºšçº¿æ€§</span></span><br><span class=\"line\"><span class=\"comment\">     * @param n å¾…åˆ†è§£çš„æ•°ï¼Œä¸å¤§äº 1e18</span></span><br><span class=\"line\"><span class=\"comment\">     * @return ä¸€ä¸ª vectorï¼ŒåŒ…å«äº† n çš„æ‰€æœ‰ç´ å› å­ï¼ŒæŒ‰ç…§ä»å°åˆ°å¤§çš„é¡ºåºæ’åˆ—ï¼ŒåŒ…æ‹¬é‡å¤çš„</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\">std::vector&lt;i64&gt; <span class=\"title\">factorize</span><span class=\"params\">(i64 n)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        std::vector&lt;i64&gt; p;</span><br><span class=\"line\">        std::function&lt;<span class=\"type\">void</span>(i64)&gt; f = [&amp;](i64 n)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (n &lt;= <span class=\"number\">10000</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">2</span>; i * i &lt;= n; ++i)</span><br><span class=\"line\">                    <span class=\"keyword\">for</span> (; n % i == <span class=\"number\">0</span>; n /= i)</span><br><span class=\"line\">                        p.<span class=\"built_in\">push_back</span>(i);</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (n &gt; <span class=\"number\">1</span>)</span><br><span class=\"line\">                    p.<span class=\"built_in\">push_back</span>(n);</span><br><span class=\"line\">                <span class=\"keyword\">return</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"built_in\">isprime</span>(n))</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                p.<span class=\"built_in\">push_back</span>(n);</span><br><span class=\"line\">                <span class=\"keyword\">return</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">auto</span> g = [&amp;](i64 x)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"built_in\">return</span> (<span class=\"built_in\">mul</span>(x, x, n) + <span class=\"number\">1</span>) % n;</span><br><span class=\"line\">            &#125;;</span><br><span class=\"line\">            i64 x0 = <span class=\"number\">2</span>;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                i64 x = x0;</span><br><span class=\"line\">                i64 y = x0;</span><br><span class=\"line\">                i64 d = <span class=\"number\">1</span>;</span><br><span class=\"line\">                i64 power = <span class=\"number\">1</span>, lam = <span class=\"number\">0</span>;</span><br><span class=\"line\">                i64 v = <span class=\"number\">1</span>;</span><br><span class=\"line\">                <span class=\"keyword\">while</span> (d == <span class=\"number\">1</span>)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    y = <span class=\"built_in\">g</span>(y);</span><br><span class=\"line\">                    ++lam;</span><br><span class=\"line\">                    v = <span class=\"built_in\">mul</span>(v, std::<span class=\"built_in\">abs</span>(x - y), n);</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (lam % <span class=\"number\">127</span> == <span class=\"number\">0</span>)</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        d = std::<span class=\"built_in\">gcd</span>(v, n);</span><br><span class=\"line\">                        v = <span class=\"number\">1</span>;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (power == lam)</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        x = y;</span><br><span class=\"line\">                        power *= <span class=\"number\">2</span>;</span><br><span class=\"line\">                        lam = <span class=\"number\">0</span>;</span><br><span class=\"line\">                        d = std::<span class=\"built_in\">gcd</span>(v, n);</span><br><span class=\"line\">                        v = <span class=\"number\">1</span>;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (d != n)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"built_in\">f</span>(d);</span><br><span class=\"line\">                    <span class=\"built_in\">f</span>(n / d);</span><br><span class=\"line\">                    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                ++x0;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"built_in\">f</span>(n);</span><br><span class=\"line\">        std::<span class=\"built_in\">sort</span>(p.<span class=\"built_in\">begin</span>(), p.<span class=\"built_in\">end</span>());</span><br><span class=\"line\">        <span class=\"keyword\">return</span> p;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">     * @brief ç´ å› å­åˆ†è§£ï¼ˆPollard-Rho ç®—æ³•ï¼‰</span></span><br><span class=\"line\"><span class=\"comment\">     * @param n å¾…åˆ†è§£çš„æ•°ï¼Œä¸å¤§äº 1e18</span></span><br><span class=\"line\"><span class=\"comment\">     * @return ä¸€ä¸ª vectorï¼ŒåŒ…å«äº† n çš„æ‰€æœ‰ç´ å› å­ï¼ŒæŒ‰ç…§ä»å°åˆ°å¤§çš„é¡ºåºæ’åˆ—ï¼Œfirst ä¸ºç´ å› å­ï¼Œsecond ä¸ºæŒ‡æ•°</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    std::vector&lt;std::pair&lt;i64, i64&gt;&gt; <span class=\"built_in\">factorize_pairs</span>(i64 n)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        std::vector&lt;i64&gt; p = <span class=\"built_in\">factorize</span>(n);</span><br><span class=\"line\">        std::vector&lt;std::pair&lt;i64, i64&gt;&gt; res;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> i : p)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (res.<span class=\"built_in\">empty</span>() || res.<span class=\"built_in\">back</span>().first != i)</span><br><span class=\"line\">                res.<span class=\"built_in\">emplace_back</span>(i, <span class=\"number\">1</span>);</span><br><span class=\"line\">            <span class=\"keyword\">else</span></span><br><span class=\"line\">                res.<span class=\"built_in\">back</span>().second++;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"type\">int</span> p, i64 n, std::vector&lt;std::pair&lt;i64, i64&gt;&gt; &amp;ps, std::vector&lt;i64&gt; &amp;ds)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (p == ps.<span class=\"built_in\">size</span>())</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (n &gt; <span class=\"number\">1</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                ds.<span class=\"built_in\">push_back</span>(n);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (i64 i = <span class=\"number\">0</span>; i &lt;= ps[p].second; i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"built_in\">dfs</span>(p + <span class=\"number\">1</span>, n, ps, ds);</span><br><span class=\"line\">            n *= ps[p].first;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">     * @brief å› æ•°é›†åˆ(ä¸å«1,Pollard-Rho ç®—æ³•è´¨å› æ•°åˆ†è§£)</span></span><br><span class=\"line\"><span class=\"comment\">     * @param n å¾…è€ƒå¯Ÿçš„æ•°ï¼Œä¸å¤§äº 1e18</span></span><br><span class=\"line\"><span class=\"comment\">     * @return ä¸€ä¸ª vectorï¼ŒåŒ…å«äº† n çš„å› å­ï¼ŒæŒ‰ç…§ä»å°åˆ°å¤§çš„é¡ºåºæ’åˆ—ã€‚ä¸å«1ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\">std::vector&lt;i64&gt; <span class=\"title\">getd</span><span class=\"params\">(i64 n)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        std::vector&lt;std::pair&lt;i64, i64&gt;&gt; p = <span class=\"built_in\">factorize_pairs</span>(n);</span><br><span class=\"line\">        std::vector&lt;i64&gt; d;</span><br><span class=\"line\">        <span class=\"built_in\">dfs</span>(<span class=\"number\">0</span>, <span class=\"number\">1</span>, p, d);</span><br><span class=\"line\">        std::<span class=\"built_in\">sort</span>(d.<span class=\"built_in\">begin</span>(), d.<span class=\"built_in\">end</span>());</span><br><span class=\"line\">        <span class=\"keyword\">return</span> d;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"1-3-åŸºäºå€¼åŸŸå¤„ç†çš„å¿«é€ŸGCD\">1.3 åŸºäºå€¼åŸŸå¤„ç†çš„å¿«é€ŸGCD</h4>\n<p>ä½ éœ€è¦è§£å†³ä»¥ä¸‹é—®é¢˜ï¼š</p>\n<p>ä»¥<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>çš„å•æ¬¡è¯¢é—®å¤æ‚åº¦ã€<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>çš„æ€»æ—¶é—´å¤æ‚åº¦å›ç­”<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">âˆ€</mi><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo>âˆˆ</mo><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>n</mi><mo stretchy=\"false\">]</mo><mo separator=\"true\">,</mo><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo stretchy=\"false\">?</mo></mrow><annotation encoding=\"application/x-tex\">\\forall x,y\\in[1,n],gcd(x,y)=?</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\">âˆ€</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">]</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mclose\">?</span></span></span></span></p>\n<p>æ“ä½œæ–¹æ³•ï¼š</p>\n<p>å°†ä»»æ„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>åˆ†è§£æˆä¸‰ä¸ªæ•°çš„ä¹˜ç§¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo>Ã—</mo><mi>b</mi><mo>Ã—</mo><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">a\\times b\\times c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span></span></span></span>ï¼Œåˆ™æ˜¾ç„¶<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo separator=\"true\">,</mo><mi>b</mi><mo separator=\"true\">,</mo><mi>c</mi><mo>â‰¤</mo><msqrt><mi>n</mi></msqrt></mrow><annotation encoding=\"application/x-tex\">a,b,c\\le \\sqrt n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.04em;vertical-align:-0.2397em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8003em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"padding-left:0.833em;\">n</span></span><span style=\"top:-2.7603em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"1.08em\" viewBox=\"0 0 400000 1080\" preserveAspectRatio=\"xMinYMin slice\"><path d=\"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z\"/></svg></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2397em;\"><span></span></span></span></span></span></span></span></span>.</p>\n<p>è€ƒè™‘çº¿ç­›ï¼Œè‹¥ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> ä¸ºè´¨æ•°ï¼Œæ˜¾ç„¶ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(1,1,x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>å®ƒçš„ä¸€ä¸ªåˆ†è§£ï¼›</p>\n<p>è‹¥ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> ä¸ºåˆæ•°ï¼Œè®¾ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span></span></span></span> æ˜¯ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> çš„æœ€å°è´¨å› å­ï¼Œ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mn>0</mn></msub><mo separator=\"true\">,</mo><msub><mi>b</mi><mn>0</mn></msub><mo separator=\"true\">,</mo><msub><mi>c</mi><mn>0</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(a_0,b_0,c_0)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> æ˜¯ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><mi>x</mi><mi>p</mi></mfrac></mrow><annotation encoding=\"application/x-tex\">\\frac{x}{p}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1765em;vertical-align:-0.4811em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6954em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4811em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span> çš„ä¸€ä¸ªåˆ†è§£ï¼›</p>\n<p>åˆ™æ˜¾ç„¶æœ‰<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mn>0</mn></msub><mi>p</mi><mo separator=\"true\">,</mo><msub><mi>b</mi><mn>0</mn></msub><mo separator=\"true\">,</mo><msub><mi>c</mi><mn>0</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(a_0p,b_0,c_0)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">p</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>æ’åºåæ˜¯ä¸€ä¸ªä»å°åˆ°å¤§çš„åˆ†è§£ã€‚</p>\n<p>è‹¥æ±‚<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">gcd(x,y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span>ï¼Œè®¾<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mi>a</mi><mo>Ã—</mo><mi>b</mi><mo>Ã—</mo><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">x=a\\times b\\times c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span></span></span></span>. å‹’ä»¤<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>=</mo><mi>y</mi><mo separator=\"true\">,</mo><msub><mi>r</mi><mn>1</mn></msub><mo>=</mo><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo separator=\"true\">,</mo><msub><mi>p</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">p_1=y,r_1=gcd(a,p_1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>â€‹.</p>\n<p>å‹’ä»¤<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mn>2</mn></msub><mo>=</mo><mfrac><msub><mi>p</mi><mn>1</mn></msub><msub><mi>r</mi><mn>1</mn></msub></mfrac></mrow><annotation encoding=\"application/x-tex\">p_2=\\frac{p_1}{r_1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1926em;vertical-align:-0.4451em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7475em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:-0.0278em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.4461em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4451em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>r</mi><mn>2</mn></msub><mo>=</mo><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy=\"false\">(</mo><mi>b</mi><mo separator=\"true\">,</mo><msub><mi>p</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">r_2=gcd(b,p_2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">b</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>ï¼›<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mn>3</mn></msub><mo>=</mo><mfrac><msub><mi>p</mi><mn>2</mn></msub><msub><mi>r</mi><mn>2</mn></msub></mfrac></mrow><annotation encoding=\"application/x-tex\">p_3=\\frac{p_2}{r_2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1926em;vertical-align:-0.4451em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7475em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:-0.0278em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.4461em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4451em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>r</mi><mn>3</mn></msub><mo>=</mo><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy=\"false\">(</mo><mi>c</mi><mo separator=\"true\">,</mo><msub><mi>p</mi><mn>3</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">r_3=gcd(c,p_3)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">c</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>.</p>\n<p>åˆ™æœ‰<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>r</mi><mn>1</mn></msub><msub><mi>r</mi><mn>2</mn></msub><msub><mi>r</mi><mn>3</mn></msub><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">gcd(x,y)=r_1r_2r_3.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span></p>\n<p>åŸç†ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>r</mi><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mi mathvariant=\"normal\">/</mi><mi>r</mi><mo separator=\"true\">,</mo><mi>y</mi><mi mathvariant=\"normal\">/</mi><mi>r</mi><mo stretchy=\"false\">)</mo><mspace width=\"1em\"/><mi>i</mi><mi>f</mi><mi>f</mi><mspace width=\"1em\"/><mi>r</mi><mi mathvariant=\"normal\">âˆ£</mi><mi>x</mi><mo separator=\"true\">,</mo><mi>r</mi><mi mathvariant=\"normal\">âˆ£</mi><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">gcd(x,y)=rgcd(x/r,y/r)\\quad iff\\quad r|x,r|y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mord\">/</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord\">/</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">ff</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord\">âˆ£</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord\">âˆ£</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">#include &lt;bits/stdc++.h&gt;</span><br><span class=\"line\">using namespace std;</span><br><span class=\"line\">const int INF = 1e6 + 1;</span><br><span class=\"line\">const int maxn = 5001;</span><br><span class=\"line\">vector&lt;array&lt;int, 3&gt;&gt; v(INF + 10);</span><br><span class=\"line\">bool vis[INF + 10];</span><br><span class=\"line\">int prime[INF + 10];</span><br><span class=\"line\">void euler()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    v[1] = &#123;1, 1, 1&#125;;</span><br><span class=\"line\">    for (int i = 2; i &lt;= INF; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        if (!vis[i])</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            vis[i] = 1;</span><br><span class=\"line\">            prime[++prime[0]] = i;</span><br><span class=\"line\">            v[i] = &#123;1, 1, i&#125;;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        for (int j = 1; j &lt;= prime[0] &amp;&amp; i * prime[j] &lt;= INF; j++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            int k = i * prime[j];</span><br><span class=\"line\">            vis[k] = 1;</span><br><span class=\"line\">            v[k] = &#123;v[i][0] * prime[j], v[i][1], v[i][2]&#125;;</span><br><span class=\"line\">            sort(v[k].begin(), v[k].end());</span><br><span class=\"line\">            if (i % prime[j] == 0)</span><br><span class=\"line\">                break;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">int gcds[1010][1010];</span><br><span class=\"line\">void init()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    gcds[0][0] = 0;</span><br><span class=\"line\">    for (int i = 1; i &lt;= 1000; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        gcds[i][0] = gcds[0][i] = i;</span><br><span class=\"line\">        for (int j = 1; j &lt;= i; j++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            gcds[i][j] = gcds[j][i] = gcds[j][i % j];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">int Gcd(int a, int b)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    int ret = 1;</span><br><span class=\"line\">    for (int i = 0, r; i &lt; 3; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        if (v[a][i] &gt; 1e3)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            if (b % v[a][i])</span><br><span class=\"line\">                r = 1;</span><br><span class=\"line\">            else</span><br><span class=\"line\">                r = v[a][i];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        else</span><br><span class=\"line\">            r = gcds[v[a][i]][b % v[a][i]];</span><br><span class=\"line\">        b /= r;</span><br><span class=\"line\">        ret = ret * r;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    return ret;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"1-4-æ‰©å±•æ¬§å‡ é‡Œå¾—å®šç†\">1.4 æ‰©å±•æ¬§å‡ é‡Œå¾—å®šç†</h4>\n<p>å¯æ±‚å‡ºæ–¹ç¨‹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi><mi>y</mi><mo>=</mo><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>b</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">ax+by=gcd(a,b)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mclose\">)</span></span></span></span>çš„ä¸€ç»„ç‰¹è§£ã€‚è¯¥æ–¹ç¨‹é€šè§£ä¸ºï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo fence=\"true\">{</mo><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mi>x</mi><mo>=</mo><msup><mi>x</mi><msup><mrow></mrow><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">â€²</mo></msup></msup><mo>+</mo><mi>k</mi><mfrac><mi>b</mi><mrow><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>b</mi><mo stretchy=\"false\">)</mo></mrow></mfrac></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo separator=\"true\">,</mo><mi>k</mi><mo>âˆˆ</mo><mi>Z</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mi>y</mi><mo>=</mo><msup><mi>y</mi><msup><mrow></mrow><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">â€²</mo></msup></msup><mo>âˆ’</mo><mi>k</mi><mfrac><mi>a</mi><mrow><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>b</mi><mo stretchy=\"false\">)</mo></mrow></mfrac></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding=\"application/x-tex\">\\left\\{\n\\begin{aligned}\nx=x^{&#x27;}+k\\frac{b}{gcd(a,b)}&amp;\\\\\n\\\\&amp;,k\\in Z\\\\\ny=y^{&#x27;}-k\\frac{a}{gcd(a,b)}\\\\\n\\end{aligned}\n\\right.\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:7.951em;vertical-align:-3.7255em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.15em;\"><span style=\"top:-1.366em;\"><span class=\"pstrut\" style=\"height:4.116em;\"></span><span class=\"delimsizinginner delim-size4\"><span>â©</span></span></span><span style=\"top:-1.358em;\"><span class=\"pstrut\" style=\"height:4.116em;\"></span><span style=\"height:2.116em;width:0.8889em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.8889em\" height=\"2.116em\" style=\"width:0.8889em\" viewBox=\"0 0 888.89 2116\" preserveAspectRatio=\"xMinYMin\"><path d=\"M384 0 H504 V2116 H384z M384 0 H504 V2116 H384z\"/></svg></span></span><span style=\"top:-4.116em;\"><span class=\"pstrut\" style=\"height:4.116em;\"></span><span class=\"delimsizinginner delim-size4\"><span>â¨</span></span></span><span style=\"top:-5.258em;\"><span class=\"pstrut\" style=\"height:4.116em;\"></span><span style=\"height:2.116em;width:0.8889em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.8889em\" height=\"2.116em\" style=\"width:0.8889em\" viewBox=\"0 0 888.89 2116\" preserveAspectRatio=\"xMinYMin\"><path d=\"M384 0 H504 V2116 H384z M384 0 H504 V2116 H384z\"/></svg></span></span><span style=\"top:-7.366em;\"><span class=\"pstrut\" style=\"height:4.116em;\"></span><span class=\"delimsizinginner delim-size4\"><span>â§</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.65em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.2255em;\"><span style=\"top:-6.2255em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9925em;\"><span style=\"top:-2.9925em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.5795em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8278em;\"><span style=\"top:-2.931em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-4.1495em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"></span></span><span style=\"top:-2.6495em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"></span></span><span style=\"top:-0.8819em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9925em;\"><span style=\"top:-2.9925em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.5795em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8278em;\"><span style=\"top:-2.931em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1076em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.7255em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.2255em;\"><span style=\"top:-6.2255em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\"></span></span></span><span style=\"top:-2.6495em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3819em;\"><span></span></span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n<p>å–æœ€å°çš„éè´Ÿè§£ï¼Œ<code>x=(x%s+s)%s</code>ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">exgcd</span><span class=\"params\">(<span class=\"type\">int</span> a, <span class=\"type\">int</span> b, <span class=\"type\">int</span> &amp;x, <span class=\"type\">int</span> &amp;y)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (b == <span class=\"number\">0</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        x = <span class=\"number\">1</span>, y = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">exgcd</span>(b, a % b, y, x);</span><br><span class=\"line\">    y -= (a / b) * x;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"1-5-ç§¯æ€§å‡½æ•°çº¿æ€§ç­›ï¼ˆæ¬§æ‹‰å‡½æ•°ç­›ï¼‰\">1.5 ç§¯æ€§å‡½æ•°çº¿æ€§ç­›ï¼ˆæ¬§æ‹‰å‡½æ•°ç­›ï¼‰</h4>\n<p>å¦‚æœä¸€ä¸ªç§¯æ€§å‡½æ•°èƒ½å¤Ÿæ»¡è¶³ä»¥ä¸‹ä¸‰æ¡æ€§è´¨ï¼š</p>\n<ol>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>p</mi><mo stretchy=\"false\">)</mo><mtext>å¯</mtext><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mtext>æŸ¥è¯¢</mtext></mrow><annotation encoding=\"application/x-tex\">f(p)å¯O(1)æŸ¥è¯¢</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">p</span><span class=\"mclose\">)</span><span class=\"mord cjk_fallback\">å¯</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mord cjk_fallback\">æŸ¥è¯¢</span></span></span></span></li>\n<li>è‹¥<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo separator=\"true\">,</mo><mi>m</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">gcd(n,m)=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>ï¼Œåˆ™<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Ï†</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mi>m</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>Ï†</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo><mi>Ï†</mi><mo stretchy=\"false\">(</mo><mi>m</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\varphi(nm)=\\varphi(n)\\varphi(m)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">Ï†</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">nm</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">Ï†</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\">Ï†</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mclose\">)</span></span></span></span></li>\n<li>è‹¥<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>âˆ£</mo><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">n\\mid m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆ£</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>,åˆ™<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Ï†</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mi>m</mi><mo stretchy=\"false\">)</mo><mtext>å¯ç§¯æ€§è½¬ç§»</mtext></mrow><annotation encoding=\"application/x-tex\">\\varphi(nm)å¯ç§¯æ€§è½¬ç§»</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">Ï†</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">nm</span><span class=\"mclose\">)</span><span class=\"mord cjk_fallback\">å¯ç§¯æ€§è½¬ç§»</span></span></span></span>ï¼ˆå³é€’æ¨å…¬å¼åªå«æœ‰ä¹˜æ³•ï¼‰</li>\n</ol>\n<p>åˆ™å‡å¯ä½¿ç”¨çº¿æ€§ç­›å®ç°çº¿æ€§æ±‚è§£ã€‚</p>\n<p><em><strong>ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•°ï¼š</strong></em></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">int</span> prime[maxn];</span><br><span class=\"line\"><span class=\"type\">bool</span> vis[maxn];<span class=\"comment\">//åˆå§‹0ï¼Œæ ‡è®°åˆæ•°</span></span><br><span class=\"line\"><span class=\"type\">int</span> phi[maxn];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">euler</span><span class=\"params\">(<span class=\"type\">int</span> n)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">2</span>;i&lt;=n;i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!vis[i])prime[++prime[<span class=\"number\">0</span>]]=i,phi[i]=i<span class=\"number\">-1</span>;\\\\æ€§è´¨<span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">1</span>;j&lt;=prime[<span class=\"number\">0</span>]&amp;&amp;i*prime[j]&lt;=n;j++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            vis[i*prime[j]]=<span class=\"literal\">true</span>;\\\\ç­›å»åˆæ•°</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(i%prime[j]==<span class=\"number\">0</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                phi[i*prime[j]]=prime[j]*phi[i];\\\\æ€§è´¨<span class=\"number\">3</span></span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            phi[i*prime[j]]=phi[prime[j]]*phi[i];\\\\æ€§è´¨<span class=\"number\">2</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><em><strong>å› æ•°ä¸ªæ•°ç­›ï¼š</strong></em></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">pre</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n;</span><br><span class=\"line\">    vector&lt;<span class=\"type\">int</span>&gt; d;</span><br><span class=\"line\">    vector&lt;<span class=\"type\">int</span>&gt; num;</span><br><span class=\"line\">    vector&lt;<span class=\"type\">bool</span>&gt; vis;</span><br><span class=\"line\">    vector&lt;<span class=\"type\">int</span>&gt; prime;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">init</span><span class=\"params\">(<span class=\"type\">int</span> _n)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        n = _n;</span><br><span class=\"line\">        d.<span class=\"built_in\">resize</span>(n + <span class=\"number\">1</span>);</span><br><span class=\"line\">        num.<span class=\"built_in\">resize</span>(n + <span class=\"number\">1</span>);</span><br><span class=\"line\">        vis.<span class=\"built_in\">resize</span>(n + <span class=\"number\">1</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">did</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        d[<span class=\"number\">1</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">2</span>; i &lt;= n; i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!vis[i])</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                prime.<span class=\"built_in\">push_back</span>(i);</span><br><span class=\"line\">                d[i] = <span class=\"number\">2</span>;</span><br><span class=\"line\">                num[i] = <span class=\"number\">1</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt; prime.<span class=\"built_in\">size</span>() &amp;&amp; i * prime[j] &lt;= n; j++)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                vis[i * prime[j]] = <span class=\"number\">1</span>;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (i % prime[j] == <span class=\"number\">0</span>)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    num[i * prime[j]] = num[i] + <span class=\"number\">1</span>;</span><br><span class=\"line\">                    d[i * prime[j]] = d[i] / (num[i * prime[j]]) * (num[i * prime[j]] + <span class=\"number\">1</span>);</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                num[i * prime[j]] = <span class=\"number\">1</span>;</span><br><span class=\"line\">                d[i * prime[j]] = d[i] * <span class=\"number\">2</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">qs</span><span class=\"params\">(<span class=\"type\">int</span> x)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> d[x];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<p>è‹¥å‡½æ•°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>æ»¡è¶³<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">f(1)=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>ä¸”<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">âˆ€</mi><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo>âˆˆ</mo><msup><mi>N</mi><mo>âˆ—</mo></msup><mo separator=\"true\">,</mo><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">\\forall x,y\\in N^*,gcd(x,y)=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\">âˆ€</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">âˆ—</span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>éƒ½æœ‰<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(xy)=f(x)f(y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span>ï¼Œåˆ™<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>â€‹ä¸ºç§¯æ€§å‡½æ•°ã€‚</p>\n<p>ç‰¹åˆ«çš„ï¼Œè‹¥<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">âˆ€</mi><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo>âˆˆ</mo><msup><mi>N</mi><mo>âˆ—</mo></msup></mrow><annotation encoding=\"application/x-tex\">\\forall x,y\\in N^*</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\">âˆ€</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6887em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">âˆ—</span></span></span></span></span></span></span></span></span></span></span>éƒ½æœ‰<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(xy)=f(x)f(y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span>â€‹â€‹â€‹,åˆ™ç§°ä½œå®Œå…¨ç§¯æ€§å‡½æ•°ã€‚</p>\n<p>è‹¥<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>å’Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">g(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>å‡ä¸ºç§¯æ€§å‡½æ•°ï¼Œé‚£ä¹ˆä¸‹åˆ—å‡½æ•°ä¹Ÿç§°ä½œç§¯æ€§å‡½æ•°ï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd class =\"mtr-glue\"></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mi>h</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msup><mi>x</mi><mi>p</mi></msup><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd><mtd class =\"mtr-glue\"></mtd><mtd class =\"mml-eqn-num\"></mtd></mtr><mtr><mtd class =\"mtr-glue\"></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mi>h</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>f</mi><mi>p</mi></msup><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd><mtd class =\"mtr-glue\"></mtd><mtd class =\"mml-eqn-num\"></mtd></mtr><mtr><mtd class =\"mtr-glue\"></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mi>h</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mi>g</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd><mtd class =\"mtr-glue\"></mtd><mtd class =\"mml-eqn-num\"></mtd></mtr><mtr><mtd class =\"mtr-glue\"></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mi>h</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><munder><mo>âˆ‘</mo><mrow><mi>d</mi><mo>âˆ£</mo><mi>x</mi></mrow></munder><mi>f</mi><mo stretchy=\"false\">(</mo><mi>d</mi><mo stretchy=\"false\">)</mo><mi>g</mi><mo stretchy=\"false\">(</mo><mfrac><mi>x</mi><mi>d</mi></mfrac><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd><mtd class =\"mtr-glue\"></mtd><mtd class =\"mml-eqn-num\"></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{align}\n&amp;h(x)=f(x^p)\\\\\n&amp;h(x)=f^p(x)\\\\\n&amp;h(x)=f(x)g(x)\\\\\n&amp;h(x)=\\sum_{d\\mid x}f(d)g(\\frac{x}{d})\\\\\n\\end{align}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:7.4236em;vertical-align:-3.4618em;\"></span><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.9618em;\"><span style=\"top:-6.2293em;\"><span class=\"pstrut\" style=\"height:3.1076em;\"></span><span class=\"mord\"></span></span><span style=\"top:-4.7293em;\"><span class=\"pstrut\" style=\"height:3.1076em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3.2293em;\"><span class=\"pstrut\" style=\"height:3.1076em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.4618em;\"><span class=\"pstrut\" style=\"height:3.1076em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.4618em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.9618em;\"><span style=\"top:-6.2293em;\"><span class=\"pstrut\" style=\"height:3.1076em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7144em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-4.7293em;\"><span class=\"pstrut\" style=\"height:3.1076em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7144em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.2293em;\"><span class=\"pstrut\" style=\"height:3.1076em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span><span style=\"top:-1.4618em;\"><span class=\"pstrut\" style=\"height:3.1076em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.05em;\"><span style=\"top:-1.809em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mrel mtight\">âˆ£</span><span class=\"mord mathnormal mtight\">x</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.516em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">d</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1076em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.4618em;\"><span></span></span></span></span></span></span></span><span class=\"tag\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.9618em;\"><span style=\"top:-6.2293em;\"><span class=\"pstrut\" style=\"height:3.1076em;\"></span><span class=\"eqn-num\"></span></span><span style=\"top:-4.7293em;\"><span class=\"pstrut\" style=\"height:3.1076em;\"></span><span class=\"eqn-num\"></span></span><span style=\"top:-3.2293em;\"><span class=\"pstrut\" style=\"height:3.1076em;\"></span><span class=\"eqn-num\"></span></span><span style=\"top:-1.4618em;\"><span class=\"pstrut\" style=\"height:3.1076em;\"></span><span class=\"eqn-num\"></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.4618em;\"><span></span></span></span></span></span></span></span></span></p>\n<p>è®¾è´¨å› æ•°åˆ†è§£<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><msubsup><mo>âˆ</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msubsup><mi>p</mi><mi>i</mi><msub><mi>k</mi><mi>i</mi></msub></msubsup></mrow><annotation encoding=\"application/x-tex\">x=\\prod_{i=1}^{n}p_i^{k_i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2307em;vertical-align:-0.2997em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8043em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.931em;\"><span style=\"top:-2.4231em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.1449em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.0315em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2769em;\"><span></span></span></span></span></span></span></span></span></span>ï¼Œåˆ™</p>\n<p>è‹¥<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">F(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>ä¸ºç§¯æ€§å‡½æ•°ï¼Œåˆ™<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msubsup><mo>âˆ</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mi>f</mi><mo stretchy=\"false\">(</mo><msubsup><mi>p</mi><mi>i</mi><mi>k</mi></msubsup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">F(x)=\\prod_{i=1}^{n}f(p_i^k)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1488em;vertical-align:-0.2997em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8043em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-2.4413em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2587em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></p>\n<p>è‹¥<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">F(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>ä¸ºå®Œå…¨ç§¯æ€§å‡½æ•°ï¼Œåˆ™<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msubsup><mo>âˆ</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mi>f</mi><mo stretchy=\"false\">(</mo><msubsup><mi>p</mi><mi>i</mi><mi>k</mi></msubsup><mo stretchy=\"false\">)</mo><mo>=</mo><msubsup><mo>âˆ</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msup><mi>f</mi><mi>k</mi></msup><mo stretchy=\"false\">(</mo><msub><mi>p</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">F(x)=\\prod_{i=1}^{n}f(p_i^k)=\\prod_{i=1}^{n}f^k(p_i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1488em;vertical-align:-0.2997em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8043em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-2.4413em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2587em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1488em;vertical-align:-0.2997em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8043em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>â€‹</p>\n<p>ï¼ˆå› ä¸ºè´¨æ•°å’Œå…¶è‡ªå·±çš„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mi>c</mi><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">gcd</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">d</span></span></span></span>â€‹å¹¶ä¸æ˜¯1è€Œæ˜¯å…¶æœ¬èº«ï¼‰</p>\n<p>å¸¸è§ç§¯æ€§å‡½æ•°:</p>\n<ol>\n<li>\n<p>æ¬§æ‹‰å‡½æ•°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Ï†</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mo stretchy=\"false\">[</mo><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy=\"false\">(</mo><mi>i</mi><mo separator=\"true\">,</mo><mi>n</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\varphi(n)=\\sum_{i=1}^{n}[gcd(i,n)=1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">Ï†</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.104em;vertical-align:-0.2997em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8043em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">i</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>.</p>\n</li>\n<li>\n<p>é™¤æ•°å‡½æ•°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Ïƒ</mi><mi>k</mi></msub><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mo>âˆ‘</mo><mrow><mi>d</mi><mo>âˆ£</mo><mi>n</mi></mrow></msub><msup><mi>d</mi><mi>k</mi></msup><mo separator=\"true\">,</mo><mi>k</mi><mo>âˆˆ</mo><mi>N</mi><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\sigma_k(n)=\\sum_{d\\mid n}d^k,k\\in N.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">Ïƒ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.3238em;vertical-align:-0.4747em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2253em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mrel mtight\">âˆ£</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4747em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord\">.</span></span></span></span></p>\n<p>ï¼ˆç‰¹åˆ«çš„ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Ïƒ</mi><mn>0</mn></msub><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\sigma_0(n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">Ïƒ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>åˆè®°ä½œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">d(n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>ï¼Œè¡¨ç¤ºé™¤æ•°çš„ä¸ªæ•°ã€‚<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Ïƒ</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\sigma_1(n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">Ïƒ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>åˆè®°ä½œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Ïƒ</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\sigma(n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">Ïƒ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>â€‹â€‹ï¼Œè¡¨ç¤ºå› æ•°å’Œï¼‰</p>\n</li>\n</ol>\n<p>äºŒè€…å‡ä¸ºéå®Œå…¨ç§¯æ€§å‡½æ•°ã€‚</p>\n<ol start=\"3\">\n<li>è«æ¯”ä¹Œæ–¯å‡½æ•°</li>\n</ol>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd class =\"mtr-glue\"></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mi>Î¼</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mo fence=\"true\">{</mo><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mspace width=\"1em\"/><mtext>Â </mtext><mo>âˆ’</mo><mn>1</mn><mspace width=\"2em\"/><mspace width=\"1em\"/><mtext>Â Â </mtext><mi>i</mi><mi>f</mi><mi>f</mi><mtext>Â Â </mtext><mi>n</mi><mtext>Â </mtext><mi>i</mi><mi>s</mi><mtext>Â </mtext><mi>a</mi><mtext>Â </mtext><mi>p</mi><mi>r</mi><mi>i</mi><mi>m</mi><mi>e</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mspace width=\"2em\"/><mn>0</mn><mspace width=\"2em\"/><mspace width=\"2em\"/><msup><mi>n</mi><msup><mrow></mrow><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">â€²</mo></msup></msup><mtext>â€…â€Š</mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>â€…â€Š</mtext><mi>p</mi><mn>1</mn><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>âˆ’</mo><mi>Î¼</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><msup><mrow></mrow><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">â€²</mo></msup></msup><mo stretchy=\"false\">)</mo><mspace width=\"2em\"/><mspace width=\"1em\"/><mi>o</mi><mi>t</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>w</mi><mi>i</mi><mi>s</mi><mi>e</mi></mrow></mstyle></mtd></mtr></mtable></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo separator=\"true\">,</mo><mi>n</mi><mo>=</mo><msub><mi>p</mi><mn>1</mn></msub><mo>â‹…</mo><msup><mi>n</mi><msup><mrow></mrow><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">â€²</mo></msup></msup></mrow></mstyle></mtd><mtd class =\"mtr-glue\"></mtd><mtd class =\"mml-eqn-num\"></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{align}\\mu(n)=\\left\\{\n\\begin{aligned}\n&amp;\\quad \\ -1\\qquad \\quad \\ \\ iff\\ \\ n\\ is\\ a\\ prime \\\\\n&amp;\\qquad 0\\qquad \\qquad n^{&#x27;}\\;mod\\;p1=0\\\\\n&amp;-\\mu(n^{&#x27;})\\qquad \\quad otherwise\n\\end{aligned}\n\\right.\n&amp;,n=p_1\\cdot n^{&#x27;}\n\\end{align}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:5.105em;vertical-align:-2.3025em;\"></span><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.8025em;\"><span style=\"top:-4.8025em;\"><span class=\"pstrut\" style=\"height:4.6525em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Î¼</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-1.9em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>â©</span></span></span><span style=\"top:-1.892em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span style=\"height:0.616em;width:0.8889em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.8889em\" height=\"0.616em\" style=\"width:0.8889em\" viewBox=\"0 0 888.89 616\" preserveAspectRatio=\"xMinYMin\"><path d=\"M384 0 H504 V616 H384z M384 0 H504 V616 H384z\"/></svg></span></span><span style=\"top:-3.15em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>â¨</span></span></span><span style=\"top:-4.292em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span style=\"height:0.616em;width:0.8889em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.8889em\" height=\"0.616em\" style=\"width:0.8889em\" viewBox=\"0 0 888.89 616\" preserveAspectRatio=\"xMinYMin\"><path d=\"M384 0 H504 V616 H384z M384 0 H504 V616 H384z\"/></svg></span></span><span style=\"top:-4.9em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>â§</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.6525em;\"><span style=\"top:-4.805em;\"><span class=\"pstrut\" style=\"height:2.9925em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3.1525em;\"><span class=\"pstrut\" style=\"height:2.9925em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.5em;\"><span class=\"pstrut\" style=\"height:2.9925em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.1525em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.6525em;\"><span style=\"top:-4.8125em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\">Â </span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:2em;\"></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\">Â </span><span class=\"mspace\">Â </span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">ff</span><span class=\"mspace\">Â </span><span class=\"mspace\">Â </span><span class=\"mord mathnormal\">n</span><span class=\"mspace\">Â </span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">s</span><span class=\"mspace\">Â </span><span class=\"mord mathnormal\">a</span><span class=\"mspace\">Â </span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">im</span><span class=\"mord mathnormal\">e</span></span></span><span style=\"top:-3.16em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:2em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:2em;\"></span><span class=\"mspace\" style=\"margin-right:2em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9925em;\"><span style=\"top:-2.9925em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.5795em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8278em;\"><span style=\"top:-2.931em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">0</span></span></span><span style=\"top:-1.5075em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">Î¼</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9925em;\"><span style=\"top:-2.9925em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.5795em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8278em;\"><span style=\"top:-2.931em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:2em;\"></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">er</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">se</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.1525em;\"><span></span></span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.3025em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.8025em;\"><span style=\"top:-4.8025em;\"><span class=\"pstrut\" style=\"height:4.6525em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9925em;\"><span style=\"top:-2.9925em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.5795em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8278em;\"><span style=\"top:-2.931em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.3025em;\"><span></span></span></span></span></span></span></span><span class=\"tag\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.8025em;\"><span style=\"top:-4.8025em;\"><span class=\"pstrut\" style=\"height:4.6525em;\"></span><span class=\"eqn-num\"></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.3025em;\"><span></span></span></span></span></span></span></span></span></p>\n<ol start=\"4\">\n<li>\n<p>æ¬§æ‹‰å‡½æ•°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Ï†</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mo stretchy=\"false\">[</mo><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy=\"false\">(</mo><mi>i</mi><mo separator=\"true\">,</mo><mi>n</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\varphi(n)=\\sum_{i=1}^{n}[gcd(i,n)=1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">Ï†</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.104em;vertical-align:-0.2997em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8043em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">i</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span></p>\n<p>é€šè§£å…¬å¼</p>\n</li>\n</ol>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>Ï†</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>x</mi><munderover><mo>âˆ</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy=\"false\">(</mo><mn>1</mn><mo>âˆ’</mo><mfrac><mn>1</mn><msub><mi>p</mi><mi>i</mi></msub></mfrac><mo stretchy=\"false\">)</mo><mtext>â€‰</mtext><mtext>â€‰</mtext><mtext>â€‰</mtext><mtext>â€‰</mtext><mo separator=\"true\">,</mo><mtext>â€‰</mtext><mtext>â€‰</mtext><mtext>â€‰</mtext><mi>x</mi><mo>=</mo><munderover><mo>âˆ</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msubsup><mi>p</mi><mi>i</mi><msub><mi>k</mi><mi>i</mi></msub></msubsup></mrow><annotation encoding=\"application/x-tex\">\\varphi(x)=x\\prod_{i=1}^{n}(1-\\frac{1}{p_i})\\,\\,\\,\\,,\\,\\,\\,x=\\prod_{i=1}^{n}p_i^{k_i}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">Ï†</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.9291em;vertical-align:-1.2777em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2019em;vertical-align:-0.8804em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.9291em;vertical-align:-1.2777em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.931em;\"><span style=\"top:-2.4231em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.1449em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.0315em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2769em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p>æ€§è´¨</p>\n<ol>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Ï†</mi><mo stretchy=\"false\">(</mo><mi>p</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>p</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">\\varphi(p)=p-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">Ï†</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">p</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span></li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Ï†</mi><mo stretchy=\"false\">(</mo><msup><mi>p</mi><mi>k</mi></msup><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>p</mi><mrow><mi>k</mi><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>Ï†</mi><mo stretchy=\"false\">(</mo><mi>p</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\varphi(p^k)=p^{k-1}\\varphi(p)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0991em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">Ï†</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0991em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord mathnormal\">Ï†</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">p</span><span class=\"mclose\">)</span></span></span></span></li>\n<li>è‹¥<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo separator=\"true\">,</mo><mi>m</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">gcd(n,m)=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>ï¼Œåˆ™<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Ï†</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mi>m</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>Ï†</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo><mi>Ï†</mi><mo stretchy=\"false\">(</mo><mi>m</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\varphi(nm)=\\varphi(n)\\varphi(m)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">Ï†</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">nm</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">Ï†</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\">Ï†</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mclose\">)</span></span></span></span></li>\n<li>è‹¥<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>âˆ£</mo><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">n\\mid m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆ£</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>,åˆ™<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Ï†</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mi>m</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>n</mi><mi>Ï†</mi><mo stretchy=\"false\">(</mo><mi>m</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\varphi(nm)=n\\varphi(m)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">Ï†</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">nm</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">Ï†</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mclose\">)</span></span></span></span>â€‹</li>\n</ol>\n<p>ä»”ç»†è§‚å¯Ÿä¸éš¾å‘ç°2æ˜¯4çš„å­é›†å…³ç³»ï¼Œæ•…æ€§è´¨1ã€3ã€4ç§°ä½œæ¬§æ‹‰å‡½æ•°ä¸‰æ€§è´¨ï¼Œç®€ç§°æ¬§æ‹‰å‡½æ•°æ€§ã€‚</p>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"1-6-è£´èœ€å®šç†\">1.6 è£´èœ€å®šç†</h4>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mtext>è®¾ä¸å…¨ä¸º</mtext><mn>0</mn><mtext>çš„æ•´æ•°</mtext><mi>a</mi><mo separator=\"true\">,</mo><mi>b</mi><mtext>ï¼Œå¯¹äºä»»æ„æ•´æ•°</mtext><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mtext>æœ‰</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mspace width=\"2em\"/><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>b</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">âˆ£</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mtext>ä¸”ä¸€å®šå­˜åœ¨æ•´æ•°è§£</mtext><msub><mi>x</mi><mn>0</mn></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mn>0</mn></msub><mtext>ä½¿å¾—ä¸‹åˆ—æ–¹ç¨‹æˆç«‹</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mspace width=\"2em\"/><mi>a</mi><msub><mi>x</mi><mn>0</mn></msub><mo>+</mo><mi>b</mi><msub><mi>y</mi><mn>0</mn></msub><mo>=</mo><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>b</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}\n&amp;è®¾ä¸å…¨ä¸º0çš„æ•´æ•°a,bï¼Œå¯¹äºä»»æ„æ•´æ•°x,yæœ‰\\\\\n\\\\\n&amp;\\qquad gcd(a,b)|(ax+by)\\\\\n\\\\\n&amp;ä¸”ä¸€å®šå­˜åœ¨æ•´æ•°è§£x_0,y_0ä½¿å¾—ä¸‹åˆ—æ–¹ç¨‹æˆç«‹\\\\\n\\\\\n&amp;\\qquad ax_0+by_0=gcd(a,b)\n\\end{aligned}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:10.5em;vertical-align:-5em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:5.5em;\"><span style=\"top:-7.5em;\"><span class=\"pstrut\" style=\"height:2.84em;\"></span><span class=\"mord\"></span></span><span style=\"top:-6em;\"><span class=\"pstrut\" style=\"height:2.84em;\"></span><span class=\"mord\"></span></span><span style=\"top:-4.5em;\"><span class=\"pstrut\" style=\"height:2.84em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:2.84em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.5em;\"><span class=\"pstrut\" style=\"height:2.84em;\"></span><span class=\"mord\"></span></span><span style=\"top:0em;\"><span class=\"pstrut\" style=\"height:2.84em;\"></span><span class=\"mord\"></span></span><span style=\"top:1.5em;\"><span class=\"pstrut\" style=\"height:2.84em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:5em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:5.5em;\"><span style=\"top:-7.66em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord cjk_fallback\">è®¾ä¸å…¨ä¸º</span><span class=\"mord\">0</span><span class=\"mord cjk_fallback\">çš„æ•´æ•°</span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mord cjk_fallback\">ï¼Œå¯¹äºä»»æ„æ•´æ•°</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord cjk_fallback\">æœ‰</span></span></span><span style=\"top:-4.66em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:2em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mclose\">)</span><span class=\"mord\">âˆ£</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span><span style=\"top:-1.66em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord cjk_fallback\">ä¸”ä¸€å®šå­˜åœ¨æ•´æ•°è§£</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord cjk_fallback\">ä½¿å¾—ä¸‹åˆ—æ–¹ç¨‹æˆç«‹</span></span></span><span style=\"top:1.34em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:2em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:5em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>ä¸Šè¿°æƒ…å½¢å¯ä»¥æ¨å¹¿åˆ°ä»»æ„å¤šå˜é‡ã€‚</p>\n<h4 id=\"1-7-æ‰©å±•æ¬§æ‹‰å®šç†\">1.7 æ‰©å±•æ¬§æ‹‰å®šç†</h4>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mi>a</mi><mi>b</mi></msup><mo>â‰¡</mo><mrow><mo fence=\"true\">{</mo><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><msup><mi>a</mi><mrow><mi>b</mi><mtext>Â </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><mi>Ï†</mi><mo stretchy=\"false\">(</mo><mi>m</mi><mo stretchy=\"false\">)</mo></mrow></msup><mspace width=\"2em\"/><mspace width=\"2em\"/><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>m</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><msup><mi>a</mi><mi>b</mi></msup><mspace width=\"2em\"/><mspace width=\"2em\"/><mspace width=\"2em\"/><mspace width=\"1em\"/><mtext>Â </mtext><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>m</mi><mo stretchy=\"false\">)</mo><mo mathvariant=\"normal\">â‰ </mo><mn>1</mn><mo separator=\"true\">,</mo><mi>b</mi><mo>&lt;</mo><mi>Ï†</mi><mo stretchy=\"false\">(</mo><mi>m</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><msup><mi>a</mi><mrow><mo stretchy=\"false\">(</mo><mi>b</mi><mtext>Â </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><mi>Ï†</mi><mo stretchy=\"false\">(</mo><mi>m</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo>+</mo><mi>Ï†</mi><mo stretchy=\"false\">(</mo><mi>m</mi><mo stretchy=\"false\">)</mo></mrow></msup><mspace width=\"1em\"/><mtext>Â </mtext><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>m</mi><mo stretchy=\"false\">)</mo><mo mathvariant=\"normal\">â‰ </mo><mn>1</mn><mo separator=\"true\">,</mo><mi>b</mi><mo>â‰¥</mo><mi>Ï†</mi><mo stretchy=\"false\">(</mo><mi>m</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr></mtable></mrow><mspace width=\"1em\"/><mo stretchy=\"false\">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><mi>m</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">a^b\\equiv \n\\left \\{\n\\begin{aligned}\n&amp;a^{b\\ mod\\ \\varphi(m)}\\qquad \\qquad gcd(a,m)=1\\\\\n&amp;a^b \\qquad\\qquad\\qquad\\quad\\ gcd(a,m)\\neq1,b&lt;\\varphi(m)\\\\\n&amp;a^{(b\\ mod\\ \\varphi(m))+\\varphi(m)} \\quad \\ gcd(a,m)\\neq1,b\\geq\\varphi(m)\n\\end{aligned}\n\\right.\\quad (mod\\ m)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8991em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¡</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:4.8em;vertical-align:-2.15em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-1.9em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>â©</span></span></span><span style=\"top:-1.892em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span style=\"height:0.616em;width:0.8889em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.8889em\" height=\"0.616em\" style=\"width:0.8889em\" viewBox=\"0 0 888.89 616\" preserveAspectRatio=\"xMinYMin\"><path d=\"M384 0 H504 V616 H384z M384 0 H504 V616 H384z\"/></svg></span></span><span style=\"top:-3.15em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>â¨</span></span></span><span style=\"top:-4.292em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span style=\"height:0.616em;width:0.8889em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.8889em\" height=\"0.616em\" style=\"width:0.8889em\" viewBox=\"0 0 888.89 616\" preserveAspectRatio=\"xMinYMin\"><path d=\"M384 0 H504 V616 H384z M384 0 H504 V616 H384z\"/></svg></span></span><span style=\"top:-4.9em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>â§</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.6276em;\"><span style=\"top:-4.6276em;\"><span class=\"pstrut\" style=\"height:2.938em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3.0684em;\"><span class=\"pstrut\" style=\"height:2.938em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.4704em;\"><span class=\"pstrut\" style=\"height:2.938em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.1276em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.6276em;\"><span style=\"top:-4.6896em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">b</span><span class=\"mspace mtight\"><span class=\"mtight\">Â </span></span><span class=\"mord mathnormal mtight\">m</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mspace mtight\"><span class=\"mtight\">Â </span></span><span class=\"mord mathnormal mtight\">Ï†</span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">m</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:2em;\"></span><span class=\"mspace\" style=\"margin-right:2em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-3.1304em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:2em;\"></span><span class=\"mspace\" style=\"margin-right:2em;\"></span><span class=\"mspace\" style=\"margin-right:2em;\"></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\">Â </span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\"><span class=\"mrel\"><span class=\"mord vbox\"><span class=\"thinbox\"><span class=\"rlap\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"inner\"><span class=\"mord\"><span class=\"mrel\">î€ </span></span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel\">=</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\">Ï†</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mclose\">)</span></span></span><span style=\"top:-1.5324em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">b</span><span class=\"mspace mtight\"><span class=\"mtight\">Â </span></span><span class=\"mord mathnormal mtight\">m</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mspace mtight\"><span class=\"mtight\">Â </span></span><span class=\"mord mathnormal mtight\">Ï†</span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">m</span><span class=\"mclose mtight\">))</span><span class=\"mbin mtight\">+</span><span class=\"mord mathnormal mtight\">Ï†</span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">m</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\">Â </span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\"><span class=\"mrel\"><span class=\"mord vbox\"><span class=\"thinbox\"><span class=\"rlap\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"inner\"><span class=\"mord\"><span class=\"mrel\">î€ </span></span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel\">=</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\">Ï†</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.1276em;\"><span></span></span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\">Â </span><span class=\"mord mathnormal\">m</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<h4 id=\"1-8-ä¹˜æ³•é€†å…ƒ\">1.8 ä¹˜æ³•é€†å…ƒ</h4>\n<p>çº¿æ€§é€†å…ƒï¼š</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> int long long</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> endl <span class=\"string\">&#x27;\\n&#x27;</span></span></span><br><span class=\"line\"><span class=\"type\">int</span> mod;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">6e6</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> inv[maxn];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"type\">int</span> a;</span><br><span class=\"line\">    cin &gt;&gt; a &gt;&gt; mod;</span><br><span class=\"line\">    inv[<span class=\"number\">1</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    cout &lt;&lt; <span class=\"number\">1</span> &lt;&lt; endl;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">2</span>; i &lt;= a; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        inv[i] = (mod - mod / i) * inv[mod % i] % mod;</span><br><span class=\"line\">        cout &lt;&lt; inv[i] &lt;&lt; endl;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>å¿«é€Ÿå¹‚é€†å…ƒï¼ˆè´¹é©¬å°å®šç†ï¼‰ï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>å¯¹äºä»»æ„æ­£æ•´æ•°</mtext><mi>a</mi><mtext>ï¼Œ</mtext><mi mathvariant=\"normal\">âˆƒ</mi><mi>p</mi><mtext>æ»¡è¶³</mtext><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>p</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mtext>åˆ™å¿…ç„¶æœ‰ä»¥ä¸‹åŒä½™å¼æˆç«‹</mtext><mo>:</mo><mspace linebreak=\"newline\"></mspace><msup><mi>a</mi><mrow><mi>p</mi><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo>â‰¡</mo><mn>1</mn><mtext>Â </mtext><mo stretchy=\"false\">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext>â€…â€Š</mtext><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">å¯¹äºä»»æ„æ­£æ•´æ•°aï¼Œ\\exists pæ»¡è¶³gcd(a,p)=1,åˆ™å¿…ç„¶æœ‰ä»¥ä¸‹åŒä½™å¼æˆç«‹:\\\\\na^{p-1} \\equiv1\\ (mod \\; n)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord cjk_fallback\">å¯¹äºä»»æ„æ­£æ•´æ•°</span><span class=\"mord mathnormal\">a</span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord\">âˆƒ</span><span class=\"mord mathnormal\">p</span><span class=\"mord cjk_fallback\">æ»¡è¶³</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord cjk_fallback\">åˆ™å¿…ç„¶æœ‰ä»¥ä¸‹åŒä½™å¼æˆç«‹</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8641em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¡</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mspace\">Â </span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">quickpow</span>(a,mod<span class=\"number\">-2</span>);</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"1-9-ä¸­å›½å‰©ä½™å®šç†\">1.9 ä¸­å›½å‰©ä½™å®šç†</h4>\n<p>ç»™å®š <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> ç»„éè´Ÿæ•´æ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo separator=\"true\">,</mo><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">a_i, b_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> ï¼Œæ±‚è§£å…³äº <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> çš„æ–¹ç¨‹ç»„çš„æœ€å°éè´Ÿæ•´æ•°è§£ã€‚</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo fence=\"true\">{</mo><mtable rowspacing=\"0.36em\" columnalign=\"left left\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>x</mi><mo>â‰¡</mo><msub><mi>b</mi><mn>1</mn></msub><mspace></mspace><mspace width=\"0.4444em\"/><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">m</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">d</mi></mrow><mspace width=\"0.3333em\"/><msub><mi>a</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>x</mi><mo>â‰¡</mo><msub><mi>b</mi><mn>2</mn></msub><mspace></mspace><mspace width=\"0.4444em\"/><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">m</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">d</mi></mrow><mspace width=\"0.3333em\"/><msub><mi>a</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">â€¦</mo></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>x</mi><mo>â‰¡</mo><msub><mi>b</mi><mi>n</mi></msub><mspace></mspace><mspace width=\"0.4444em\"/><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">m</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">d</mi></mrow><mspace width=\"0.3333em\"/><msub><mi>a</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding=\"application/x-tex\">\\begin{cases}x\\equiv b_1\\pmod{a_1}\\\\x\\equiv b_2\\pmod{a_2}\\\\\\dots\\\\x\\equiv b_n\\pmod{a_n}\\end{cases}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:5.76em;vertical-align:-2.63em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.95em;\"><span style=\"top:-1.6em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>â©</span></span></span><span style=\"top:-1.592em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span style=\"height:0.916em;width:0.8889em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.8889em\" height=\"0.916em\" style=\"width:0.8889em\" viewBox=\"0 0 888.89 916\" preserveAspectRatio=\"xMinYMin\"><path d=\"M384 0 H504 V916 H384z M384 0 H504 V916 H384z\"/></svg></span></span><span style=\"top:-3.15em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>â¨</span></span></span><span style=\"top:-4.292em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span style=\"height:0.916em;width:0.8889em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.8889em\" height=\"0.916em\" style=\"width:0.8889em\" viewBox=\"0 0 888.89 916\" preserveAspectRatio=\"xMinYMin\"><path d=\"M384 0 H504 V916 H384z M384 0 H504 V916 H384z\"/></svg></span></span><span style=\"top:-5.2em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>â§</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.45em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.13em;\"><span style=\"top:-5.13em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¡</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace allowbreak\"></span><span class=\"mspace\" style=\"margin-right:0.4444em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathrm\">mod</span></span></span><span class=\"mspace\" style=\"margin-right:0.3333em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.69em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¡</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace allowbreak\"></span><span class=\"mspace\" style=\"margin-right:0.4444em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathrm\">mod</span></span></span><span class=\"mspace\" style=\"margin-right:0.3333em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"minner\">â€¦</span></span></span><span style=\"top:-0.81em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¡</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace allowbreak\"></span><span class=\"mspace\" style=\"margin-right:0.4444em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathrm\">mod</span></span></span><span class=\"mspace\" style=\"margin-right:0.3333em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.63em;\"><span></span></span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n<p>å¯¹äº <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>100</mn><mi mathvariant=\"normal\">%</mi></mrow><annotation encoding=\"application/x-tex\">100 \\%</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8056em;vertical-align:-0.0556em;\"></span><span class=\"mord\">100%</span></span></span></span> çš„æ•°æ®ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>n</mi><mo>â‰¤</mo><msup><mn>10</mn><mn>5</mn></msup></mrow><annotation encoding=\"application/x-tex\">1 \\le n \\le {10}^5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8484em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\">10</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8484em;\"><span style=\"top:-3.0973em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span></span></span></span></span></span></span></span>ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><msub><mi>b</mi><mi>i</mi></msub><mo separator=\"true\">,</mo><msub><mi>a</mi><mi>i</mi></msub><mo>â‰¤</mo><msup><mn>10</mn><mn>12</mn></msup></mrow><annotation encoding=\"application/x-tex\">1 \\le b_i,a_i \\le {10}^{12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8484em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\">10</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8484em;\"><span style=\"top:-3.0973em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span></span></span></span></span></span></span></span>ï¼Œä¿è¯æ‰€æœ‰ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">a_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> çš„æœ€å°å…¬å€æ•°ä¸è¶…è¿‡ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>10</mn><mn>18</mn></msup></mrow><annotation encoding=\"application/x-tex\">{10}^{18}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8484em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\">10</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8484em;\"><span style=\"top:-3.0973em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">18</span></span></span></span></span></span></span></span></span></span></span></span>ã€‚ä¸ä¿è¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>ä¸ºè´¨æ•°</p>\n<p><strong>è¯·æ³¨æ„ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­è¿›è¡Œä¹˜æ³•è¿ç®—æ—¶ç»“æœå¯èƒ½æœ‰æº¢å‡ºçš„é£é™©ã€‚</strong></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> int long long</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">quickmul</span><span class=\"params\">(<span class=\"type\">int</span> a, <span class=\"type\">int</span> b, <span class=\"type\">int</span> mod)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (a &lt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        a += mod;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (b &lt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        b += mod;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (a &lt; b)</span><br><span class=\"line\">        <span class=\"built_in\">swap</span>(a, b);</span><br><span class=\"line\">    <span class=\"type\">int</span> e = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (b)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (b &amp; <span class=\"number\">1</span>)</span><br><span class=\"line\">            (e += a) %= mod;</span><br><span class=\"line\">        (a &lt;&lt;= <span class=\"number\">1</span>) %= mod;</span><br><span class=\"line\">        b &gt;&gt;= <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> e;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">exgcd</span><span class=\"params\">(<span class=\"type\">int</span> a, <span class=\"type\">int</span> b, <span class=\"type\">int</span> &amp;x, <span class=\"type\">int</span> &amp;y)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (b == <span class=\"number\">0</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        x = <span class=\"number\">1</span>, y = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">exgcd</span>(b, a % b, y, x);</span><br><span class=\"line\">    y -= (a / b) * x;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">500001</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> a[maxn], m[maxn]; <span class=\"comment\">// å¯¹må–æ¨¡ä½™æ•°æ˜¯a</span></span><br><span class=\"line\"><span class=\"type\">int</span> n;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">ExCRT</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> mod = m[<span class=\"number\">1</span>], ans = a[<span class=\"number\">1</span>];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">2</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> b1 = mod, b2 = m[i], c = __gcd(b1, b2), minus = (a[i] - ans % b2 + b2) % b2;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (minus % c != <span class=\"number\">0</span>)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">        b1 /= c, b2 /= c, minus /= c;</span><br><span class=\"line\">        <span class=\"type\">int</span> x, y;</span><br><span class=\"line\">        <span class=\"built_in\">exgcd</span>(b1, b2, x, y);</span><br><span class=\"line\">        x = <span class=\"built_in\">quickmul</span>(x, minus, b2);</span><br><span class=\"line\">        ans += x * mod;</span><br><span class=\"line\">        mod *= b2;</span><br><span class=\"line\">        ans = (ans % mod + mod) % mod;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"literal\">false</span>);</span><br><span class=\"line\">    cin.<span class=\"built_in\">tie</span>(<span class=\"literal\">nullptr</span>);</span><br><span class=\"line\">    cout.<span class=\"built_in\">tie</span>(<span class=\"literal\">nullptr</span>);</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cin &gt;&gt; m[i] &gt;&gt; a[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; <span class=\"built_in\">ExCRT</span>() &lt;&lt; endl;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"1-10-ç¦»æ•£å¯¹æ•°\">1.10 ç¦»æ•£å¯¹æ•°</h4>\n<h5 id=\"1-10-1-åŸæ ¹\">1.10.1 åŸæ ¹</h5>\n<p>æ»¡è¶³<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>a</mi><mi>n</mi></msup><mo>â‰¡</mo><mn>1</mn><mtext>Â </mtext><mo stretchy=\"false\">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><mi>m</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>m</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">a^n\\equiv 1\\ (mod \\ m),gcd(a,m)=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¡</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mspace\">Â </span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\">Â </span><span class=\"mord mathnormal\">m</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>çš„æœ€å°æ­£æ•´æ•°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>å­˜åœ¨ï¼Œç§°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>çš„é˜¶ï¼Œè®°ä½œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Î´</mi><mi>m</mi></msub><mo stretchy=\"false\">(</mo><mi>a</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\delta_m(a)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">Î´</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span></span></span></span>ã€‚</p>\n<p>ç»™å®š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>ï¼Œè‹¥<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy=\"false\">(</mo><mi>g</mi><mo separator=\"true\">,</mo><mi>m</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">gcd(g,m)=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>ä¸”<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Î´</mi><mi>m</mi></msub><mo stretchy=\"false\">(</mo><mi>g</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>Ï†</mi><mo stretchy=\"false\">(</mo><mi>m</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\delta_m(g)=\\varphi(m)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">Î´</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">Ï†</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mclose\">)</span></span></span></span>ï¼Œåˆ™ç§°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>çš„ä¸€ä¸ªåŸæ ¹ï¼ˆå¾ªç¯ç¾¤çš„ç”Ÿæˆå…ƒï¼‰ã€‚</p>\n<p>è¯¦ç»†è§<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mi>I</mi><mo>âˆ’</mo><mi>W</mi><mi>i</mi><mi>k</mi><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">OI-Wiki</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">Wiki</span></span></span></span></p>\n<h5 id=\"1-10-2-ç¦»æ•£å¯¹æ•°\">1.10.2 ç¦»æ•£å¯¹æ•°</h5>\n<p>å®šä¹‰<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>a</mi><mi>x</mi></msup><mo>â‰¡</mo><mi>b</mi><mtext>Â </mtext><mo stretchy=\"false\">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><mi>m</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">a^x\\equiv b\\ (mod\\ m)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¡</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace\">Â </span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\">Â </span><span class=\"mord mathnormal\">m</span><span class=\"mclose\">)</span></span></span></span>ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>çš„ä¸€ä¸ªåŸæ ¹æ—¶ï¼Œè®°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mi>i</mi><mi>n</mi><msub><mi>d</mi><mi>a</mi></msub><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">x=ind_ab</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">in</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">b</span></span></span></span>ï¼Œç§°ä½œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>å…³äº<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>çš„ç¦»æ•£å¯¹æ•°ã€‚</p>\n<h5 id=\"1-10-3-ExBSGSç®—æ³•\">1.10.3 ExBSGSç®—æ³•</h5>\n<p>ç»™å®š <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo separator=\"true\">,</mo><mi>p</mi><mo separator=\"true\">,</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">a,p,b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>ï¼Œæ±‚æ»¡è¶³ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>a</mi><mi>x</mi></msup><mo>â‰¡</mo><mi>b</mi><mspace></mspace><mspace width=\"0.4444em\"/><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">m</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">d</mi></mrow><mspace width=\"0.3333em\"/><mi>p</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">a^xâ‰¡b \\pmod p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¡</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace allowbreak\"></span><span class=\"mspace\" style=\"margin-right:0.4444em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathrm\">mod</span></span></span><span class=\"mspace\" style=\"margin-right:0.3333em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mclose\">)</span></span></span></span> çš„æœ€å°è‡ªç„¶æ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> ã€‚å¦‚æœæ— è§£ï¼Œè¾“å‡º <code>No Solution</code>ï¼Œå¦åˆ™è¾“å‡ºæœ€å°è‡ªç„¶æ•°è§£ã€‚</p>\n<p>å¯¹äº <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>100</mn><mi mathvariant=\"normal\">%</mi></mrow><annotation encoding=\"application/x-tex\">100\\%</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8056em;vertical-align:-0.0556em;\"></span><span class=\"mord\">100%</span></span></span></span> çš„æ•°æ®ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>p</mi><mo separator=\"true\">,</mo><mi>b</mi><mo>â‰¤</mo><mn>1</mn><msup><mn>0</mn><mn>9</mn></msup></mrow><annotation encoding=\"application/x-tex\">1\\le a,p,bâ‰¤10^9</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">9</span></span></span></span></span></span></span></span></span></span></span> æˆ– <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo>=</mo><mi>p</mi><mo>=</mo><mi>b</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">a=p=b=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>ã€‚<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>âˆ‘</mo><msqrt><mi>p</mi></msqrt><mo>â‰¤</mo><mn>5</mn><mo>Ã—</mo><mn>1</mn><msup><mn>0</mn><mn>6</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\sum \\sqrt p\\le 5\\times 10^6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0869em;vertical-align:-0.3369em;\"></span><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ‘</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7031em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"padding-left:0.833em;\">p</span></span><span style=\"top:-2.6631em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"1.08em\" viewBox=\"0 0 400000 1080\" preserveAspectRatio=\"xMinYMin slice\"><path d=\"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z\"/></svg></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3369em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">5</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">6</span></span></span></span></span></span></span></span></span></span></span>â€‹ã€‚</p>\n<p>åŸç†ï¼šæåˆ°å’ŒBSGSç®—æ³•ä¸€è‡´ï¼Œé€šè¿‡<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo>â‰¡</mo><mi>b</mi><mtext>Â </mtext><mo stretchy=\"false\">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><mi>c</mi><mo stretchy=\"false\">)</mo><mtext>â€…â€Š</mtext><mo>âŸº</mo><mtext>â€…â€Š</mtext><mi>a</mi><mo>Ã—</mo><mi>d</mi><mo>â‰¡</mo><mi>b</mi><mo>Ã—</mo><mi>d</mi><mtext>Â </mtext><mo stretchy=\"false\">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><mi>c</mi><mo>Ã—</mo><mi>d</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">a \\equiv b \\ (mod\\ c) \\iff a\\times d\\equiv b\\times d\\ (mod\\ c\\times d)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4637em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¡</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace\">Â </span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\">Â </span><span class=\"mord mathnormal\">c</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âŸº</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¡</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mspace\">Â </span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\">Â </span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mclose\">)</span></span></span></span></p>\n<p>æ¯æ¬¡åœ¨ä¸¤è¾¹é™¤ä»¥ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mo>=</mo><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>p</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">d=gcd(a,p)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mclose\">)</span></span></span></span>ï¼Œå¾—åˆ°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><mi>a</mi><mi>d</mi></mfrac><mo>Ã—</mo><msup><mi>a</mi><mrow><mi>x</mi><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo>â‰¡</mo><mfrac><mi>b</mi><mi>d</mi></mfrac><mtext>Â </mtext><mo stretchy=\"false\">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><mfrac><mi>p</mi><mi>d</mi></mfrac><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\frac{a}{d}\\times a^{x-1}\\equiv\\frac{b}{d}\\ (mod\\ \\frac{p}{d})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0404em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6954em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¡</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2251em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8801em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\">Â </span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\">Â </span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7475em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.4461em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">)</span></span></span></span></p>\n<p>é‡å¤æ‰§è¡Œè¯¥è¯­æ®µï¼Œç›´åˆ°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>p</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">gcd(a,p)=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> ä¸ºæ­¢ã€‚</p>\n<p>ç„¶åä¸Š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi><mi>S</mi><mi>G</mi><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">BSGS</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">BSGS</span></span></span></span>æ ¹å·æš´åŠ›åˆ†æ²»ç®—ï¼Œå¤æ‚åº¦<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msqrt><mrow><mi>Ï†</mi><mo stretchy=\"false\">(</mo><mi>p</mi><mo stretchy=\"false\">)</mo></mrow></msqrt><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(\\sqrt {\\varphi(p)})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.24em;vertical-align:-0.305em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.935em;\"><span class=\"svg-align\" style=\"top:-3.2em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mord mathnormal\">Ï†</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">p</span><span class=\"mclose\">)</span></span></span><span style=\"top:-2.895em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:1.28em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"1.28em\" viewBox=\"0 0 400000 1296\" preserveAspectRatio=\"xMinYMin slice\"><path d=\"M263,681c0.7,0,18,39.7,52,119\nc34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120\nc340,-704.7,510.7,-1060.3,512,-1067\nl0 -0\nc4.7,-7.3,11,-11,19,-11\nH40000v40H1012.3\ns-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232\nc-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1\ns-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26\nc-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z\nM1001 80h400000v40h-400000z\"/></svg></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.305em;\"><span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">int</span> <span class=\"title\">BSGS</span><span class=\"params\">(<span class=\"type\">int</span> a, <span class=\"type\">int</span> n, <span class=\"type\">int</span> p, <span class=\"type\">int</span> ad = <span class=\"number\">1</span>)</span> <span class=\"comment\">// ad*(a^x)=n(mod p)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    unordered_map&lt;<span class=\"type\">int</span>, <span class=\"type\">int</span>&gt; mp;</span><br><span class=\"line\">    <span class=\"type\">int</span> m = <span class=\"built_in\">ceil</span>(<span class=\"built_in\">sqrt</span>(p));</span><br><span class=\"line\">    <span class=\"type\">int</span> s = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; m; i++, s = <span class=\"number\">1ll</span> * s * a % p)</span><br><span class=\"line\">        mp[<span class=\"number\">1ll</span> * s * n % p] = i;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>, tmp = s, s = ad; i &lt;= m; i++, s = <span class=\"number\">1ll</span> * s * tmp % p)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (mp.<span class=\"built_in\">find</span>(s) != mp.<span class=\"built_in\">end</span>())</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"number\">1ll</span> * i * m - mp[s] &gt;= <span class=\"number\">0</span>)</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"number\">1ll</span> * i * m - mp[s];</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">int</span> <span class=\"title\">exBSGS</span><span class=\"params\">(<span class=\"type\">int</span> a, <span class=\"type\">int</span> n, <span class=\"type\">int</span> p)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    a %= p;</span><br><span class=\"line\">    n %= p;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (n == <span class=\"number\">1</span> || p == <span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> d, ad = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> ((d = <span class=\"built_in\">gcd</span>(a, p)) ^ <span class=\"number\">1</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (n % d)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">        cnt++;</span><br><span class=\"line\">        n /= d;</span><br><span class=\"line\">        p /= d;</span><br><span class=\"line\">        ad = (<span class=\"number\">1ll</span> * ad * a / d) % p;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (ad == n)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> cnt;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> ans = <span class=\"built_in\">BSGS</span>(a, n, p, ad);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (ans == <span class=\"number\">-1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ans + cnt;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"type\">int</span> a, p, n;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (cin &gt;&gt; a &gt;&gt; p &gt;&gt; n)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!a &amp;&amp; !p &amp;&amp; !n)</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> ans = <span class=\"built_in\">exBSGS</span>(a, n, p);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (~ans)</span><br><span class=\"line\">            cout &lt;&lt; ans &lt;&lt; <span class=\"string\">&quot;\\n&quot;</span>;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">            cout &lt;&lt; <span class=\"string\">&quot;No Solution&quot;</span> &lt;&lt; <span class=\"string\">&quot;\\n&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"1-11-äºŒæ¬¡å‰©ä½™ï¼ˆå¥‡ç´ æ•°ï¼‰\">1.11 äºŒæ¬¡å‰©ä½™ï¼ˆå¥‡ç´ æ•°ï¼‰</h4>\n<p>ç»™å‡º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo separator=\"true\">,</mo><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">N,p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">p</span></span></span></span>ï¼Œæ±‚è§£æ–¹ç¨‹</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>â‰¡</mo><mi>N</mi><mspace></mspace><mspace width=\"1em\"/><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">m</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">d</mi></mrow><mspace width=\"0.3333em\"/><mi>p</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x^2 \\equiv N \\pmod{p}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8641em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¡</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace allowbreak\"></span><span class=\"mspace\" style=\"margin-right:1em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathrm\">mod</span></span></span><span class=\"mspace\" style=\"margin-right:0.3333em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p>å¤šç»„æ•°æ®ï¼Œ<strong>ä¸”ä¿è¯ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span></span></span></span> æ˜¯å¥‡ç´ æ•°ã€‚</strong></p>\n<p>è¾“å‡ºå…± <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span> è¡Œã€‚</p>\n<p>å¯¹äºæ¯ä¸€è¡Œè¾“å‡ºï¼Œè‹¥æœ‰è§£ï¼Œåˆ™æŒ‰ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>â€Š</mtext><mo lspace=\"0.22em\" rspace=\"0.22em\"><mrow><mi mathvariant=\"normal\">m</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">d</mi></mrow></mo><mtext>â€Š</mtext><mtext>Â </mtext><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">\\bmod ~p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mspace\" style=\"margin-right:0.0556em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathrm\">mod</span></span></span><span class=\"mspace\" style=\"margin-right:0.0556em;\"></span><span class=\"mspace nobreak\">Â </span><span class=\"mord mathnormal\">p</span></span></span></span> åé€’å¢çš„é¡ºåºè¾“å‡ºåœ¨ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>â€Š</mtext><mo lspace=\"0.22em\" rspace=\"0.22em\"><mrow><mi mathvariant=\"normal\">m</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">d</mi></mrow></mo><mtext>â€Š</mtext><mtext>Â </mtext><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">\\bmod~ p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mspace\" style=\"margin-right:0.0556em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathrm\">mod</span></span></span><span class=\"mspace\" style=\"margin-right:0.0556em;\"></span><span class=\"mspace nobreak\">Â </span><span class=\"mord mathnormal\">p</span></span></span></span> æ„ä¹‰ä¸‹çš„å…¨éƒ¨è§£ï¼›è‹¥ä¸¤è§£ç›¸åŒï¼Œåªè¾“å‡ºå…¶ä¸­ä¸€ä¸ªï¼›è‹¥æ— è§£ï¼Œåˆ™è¾“å‡º <code>Hola!</code> ã€‚</p>\n<p>å¯¹äº <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>100</mn><mi mathvariant=\"normal\">%</mi></mrow><annotation encoding=\"application/x-tex\">100\\%</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8056em;vertical-align:-0.0556em;\"></span><span class=\"mord\">100%</span></span></span></span> çš„æ•°æ®ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>T</mi><mo>â‰¤</mo><mn>1</mn><msup><mn>0</mn><mn>4</mn></msup><mo separator=\"true\">,</mo><mn>0</mn><mo>â‰¤</mo><mi>N</mi><mo separator=\"true\">,</mo><mi>p</mi><mo>â‰¤</mo><mn>1</mn><msup><mn>0</mn><mn>9</mn></msup><mo>+</mo><mn>9</mn></mrow><annotation encoding=\"application/x-tex\">1\\leq T\\leq 10^4,0\\le N, p\\leq 10^9+9</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8193em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0085em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8974em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">9</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">9</span></span></span></span>â€‹ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"type\">long</span> <span class=\"type\">long</span> ll;</span><br><span class=\"line\">random_device rd;</span><br><span class=\"line\"><span class=\"function\">mt19937 <span class=\"title\">ran</span><span class=\"params\">(rd())</span></span>;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">num</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    ll x; <span class=\"comment\">// å®éƒ¨</span></span><br><span class=\"line\">    ll y; <span class=\"comment\">// è™šéƒ¨(å³è™šæ•°å•ä½âˆšwçš„ç³»æ•°)</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">ll t, w, n, p;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">num <span class=\"title\">mul</span><span class=\"params\">(num a, num b, ll p)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123; <span class=\"comment\">// å¤æ•°ä¹˜æ³•</span></span><br><span class=\"line\">    num res;</span><br><span class=\"line\">    res.x = ((a.x * b.x % p + a.y * b.y % p * w % p) % p + p) % p; <span class=\"comment\">// x = a.x*b.x + a.y*b.y*w</span></span><br><span class=\"line\">    res.y = ((a.x * b.y % p + a.y * b.x % p) % p + p) % p;         <span class=\"comment\">// y = a.x*b.y + a.y*b.x</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">qpow_r</span><span class=\"params\">(ll a, ll b, ll p)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123; <span class=\"comment\">// å®æ•°å¿«é€Ÿå¹‚</span></span><br><span class=\"line\">    ll res = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (b)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (b &amp; <span class=\"number\">1</span>)</span><br><span class=\"line\">            res = res * a % p;</span><br><span class=\"line\">        a = a * a % p;</span><br><span class=\"line\">        b &gt;&gt;= <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">qpow_i</span><span class=\"params\">(num a, ll b, ll p)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123; <span class=\"comment\">// å¤æ•°å¿«é€Ÿå¹‚</span></span><br><span class=\"line\">    num res = &#123;<span class=\"number\">1</span>, <span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (b)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (b &amp; <span class=\"number\">1</span>)</span><br><span class=\"line\">            res = <span class=\"built_in\">mul</span>(res, a, p);</span><br><span class=\"line\">        a = <span class=\"built_in\">mul</span>(a, a, p);</span><br><span class=\"line\">        b &gt;&gt;= <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res.x % p; <span class=\"comment\">// åªç”¨è¿”å›å®æ•°éƒ¨åˆ†ï¼Œå› ä¸ºè™šæ•°éƒ¨åˆ†æ²¡äº†</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">cipolla</span><span class=\"params\">(ll n, ll p)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    n %= p;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">qpow_r</span>(n, (p - <span class=\"number\">1</span>) / <span class=\"number\">2</span>, p) == <span class=\"number\">-1</span> + p)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">-1</span>; <span class=\"comment\">// æ®æ¬§æ‹‰å‡†åˆ™åˆ¤å®šæ˜¯å¦æœ‰è§£</span></span><br><span class=\"line\">    ll a;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (<span class=\"number\">1</span>)</span><br><span class=\"line\">    &#123; <span class=\"comment\">// æ‰¾å‡ºä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„a</span></span><br><span class=\"line\">        a = <span class=\"built_in\">ran</span>() % p;</span><br><span class=\"line\">        w = (((a * a) % p - n) % p + p) % p; <span class=\"comment\">// w = a^2 - nï¼Œè™šæ•°å•ä½çš„å¹³æ–¹</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"built_in\">qpow_r</span>(w, (p - <span class=\"number\">1</span>) / <span class=\"number\">2</span>, p) == <span class=\"number\">-1</span> + p)</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    num x = &#123;a, <span class=\"number\">1</span>&#125;;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">qpow_i</span>(x, (p + <span class=\"number\">1</span>) / <span class=\"number\">2</span>, p);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"type\">int</span> t;</span><br><span class=\"line\">    cin &gt;&gt; t;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (t--)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cin &gt;&gt; n &gt;&gt; p;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!n)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            cout &lt;&lt; <span class=\"number\">0</span> &lt;&lt; <span class=\"string\">&quot;\\n&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        ll ans1 = <span class=\"built_in\">cipolla</span>(n, p), ans2 = -ans1 + p; <span class=\"comment\">// å¦ä¸€ä¸ªè§£å°±æ˜¯å…¶ç›¸åæ•°</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (ans1 == <span class=\"number\">-1</span>)</span><br><span class=\"line\">            cout &lt;&lt; <span class=\"string\">&quot;Hola!\\n&quot;</span>;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (ans1 &gt; ans2)</span><br><span class=\"line\">                <span class=\"built_in\">swap</span>(ans1, ans2);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (ans1 == ans2)</span><br><span class=\"line\">                cout &lt;&lt; ans1 &lt;&lt; <span class=\"string\">&quot;\\n&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span></span><br><span class=\"line\">                cout &lt;&lt; ans1 &lt;&lt; <span class=\"string\">&quot; &quot;</span> &lt;&lt; ans2 &lt;&lt; <span class=\"string\">&quot;\\n&quot;</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"1-12-æ•°è®ºåˆ†å—\">1.12 æ•°è®ºåˆ†å—</h4>\n<p>ä»¥æœŸæœ›å¤æ‚åº¦<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msqrt><mi>x</mi></msqrt><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(\\sqrt x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0503em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8003em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"padding-left:0.833em;\">x</span></span><span style=\"top:-2.7603em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"1.08em\" viewBox=\"0 0 400000 1080\" preserveAspectRatio=\"xMinYMin slice\"><path d=\"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z\"/></svg></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2397em;\"><span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>çš„å¤æ‚åº¦æ±‚è§£<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mi>g</mi><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">âŒŠ</mo><mfrac><mi>x</mi><mi>i</mi></mfrac><mo stretchy=\"false\">âŒ‹</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">F(x)=\\sum_{i=1}^ng(\\lfloor\\frac{x}i\\rfloor)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1493em;vertical-align:-0.345em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8043em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(âŒŠ</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6954em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">âŒ‹)</span></span></span></span>ã€‚</p>\n<p>åˆ†å—ç†è®ºï¼šå¦‚æœ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">âŒŠ</mo><mfrac><mi>x</mi><mi>i</mi></mfrac><mo stretchy=\"false\">âŒ‹</mo><mo>=</mo><mo stretchy=\"false\">âŒŠ</mo><mfrac><mi>x</mi><mi>j</mi></mfrac><mo stretchy=\"false\">âŒ‹</mo></mrow><annotation encoding=\"application/x-tex\">\\lfloor\\frac{x}{i}\\rfloor=\\lfloor\\frac{x}{j}\\rfloor</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.095em;vertical-align:-0.345em;\"></span><span class=\"mopen\">âŒŠ</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6954em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">âŒ‹</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2311em;vertical-align:-0.4811em;\"></span><span class=\"mopen\">âŒŠ</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6954em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4811em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">âŒ‹</span></span></span></span>ï¼Œåˆ™æœ‰è¯¥å—çš„åˆ†å—åŒºé—´ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle mathsize=\"1.2em\"><mo stretchy=\"false\">[</mo><mi>i</mi><mo separator=\"true\">,</mo><mo stretchy=\"false\">âŒŠ</mo><mfrac><mi>x</mi><mrow><mo stretchy=\"false\">âŒŠ</mo><mfrac><mi>x</mi><mi>i</mi></mfrac><mo stretchy=\"false\">âŒ‹</mo></mrow></mfrac><mo stretchy=\"false\">âŒ‹</mo><mo stretchy=\"false\">]</mo></mstyle></mrow><annotation encoding=\"application/x-tex\">\\large [i,\\lfloor\\frac{x}{\\lfloor\\frac{x}{i}\\rfloor}\\rfloor]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.5892em;vertical-align:-0.6892em;\"></span><span class=\"mopen sizing reset-size6 size7\">[</span><span class=\"mord mathnormal sizing reset-size6 size7\">i</span><span class=\"mpunct sizing reset-size6 size7\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mopen sizing reset-size6 size7\">âŒŠ</span><span class=\"mord sizing reset-size6 size7\"><span class=\"mopen nulldelimiter sizing reset-size7 size6\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.681em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">âŒŠ</span><span class=\"mord mtight\"><span class=\"mopen nulldelimiter sizing reset-size4 size6\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7069em;\"><span style=\"top:-2.656em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size4 size2 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span style=\"top:-3.2255em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line mtight\" style=\"border-bottom-width:0.049em;\"></span></span><span style=\"top:-3.384em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size4 size2 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.344em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter sizing reset-size4 size6\"></span></span><span class=\"mclose mtight\">âŒ‹</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5743em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter sizing reset-size7 size6\"></span></span><span class=\"mclose sizing reset-size6 size7\">âŒ‹]</span></span></span></span>â€‹</p>\n<p>åŸç†ï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">âŒŠ</mo><mfrac><mi>x</mi><mrow><mi>a</mi><mi>b</mi></mrow></mfrac><mo stretchy=\"false\">âŒ‹</mo><mo>=</mo><mo stretchy=\"false\">âŒŠ</mo><mfrac><mrow><mo stretchy=\"false\">âŒŠ</mo><mfrac><mi>x</mi><mi>a</mi></mfrac><mo stretchy=\"false\">âŒ‹</mo></mrow><mi>b</mi></mfrac><mo stretchy=\"false\">âŒ‹</mo></mrow><annotation encoding=\"application/x-tex\">\\lfloor\\frac{x}{ab}\\rfloor=\\lfloor\\frac{\\lfloor\\frac{x}{a}\\rfloor}{b}\\rfloor</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.095em;vertical-align:-0.345em;\"></span><span class=\"mopen\">âŒŠ</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6954em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">ab</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">âŒ‹</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.4208em;vertical-align:-0.345em;\"></span><span class=\"mopen\">âŒŠ</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0758em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.5508em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">âŒŠ</span><span class=\"mord mtight\"><span class=\"mopen nulldelimiter sizing reset-size3 size6\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6915em;\"><span style=\"top:-2.656em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span style=\"top:-3.2255em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line mtight\" style=\"border-bottom-width:0.049em;\"></span></span><span style=\"top:-3.384em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.344em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter sizing reset-size3 size6\"></span></span><span class=\"mclose mtight\">âŒ‹</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">âŒ‹</span></span></span></span></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"type\">long</span> <span class=\"type\">long</span> <span class=\"title\">H</span><span class=\"params\">(<span class=\"type\">int</span> n)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"type\">long</span> <span class=\"type\">long</span> res = <span class=\"number\">0</span>;  <span class=\"comment\">// å‚¨å­˜ç»“æœ</span></span><br><span class=\"line\">  <span class=\"type\">int</span> l = <span class=\"number\">1</span>, r;       <span class=\"comment\">// å—å·¦ç«¯ç‚¹ä¸å³ç«¯ç‚¹</span></span><br><span class=\"line\">  <span class=\"keyword\">while</span> (l &lt;= n) &#123;</span><br><span class=\"line\">    r = n / (n / l);  <span class=\"comment\">// è®¡ç®—å½“å‰å—çš„å³ç«¯ç‚¹</span></span><br><span class=\"line\">    <span class=\"comment\">// ç´¯åŠ è¿™ä¸€å—çš„è´¡çŒ®åˆ°ç»“æœä¸­ã€‚ä¹˜ä¸Š 1LL é˜²æ­¢æº¢å‡º</span></span><br><span class=\"line\">    res += <span class=\"number\">1LL</span> * (r - l + <span class=\"number\">1</span>) * (n / l);</span><br><span class=\"line\">    l = r + <span class=\"number\">1</span>;  <span class=\"comment\">// å·¦ç«¯ç‚¹ç§»åˆ°ä¸‹ä¸€å—</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>å¦‚æœæ˜¯å‘ä¸Šå–æ•´åˆ†å—<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mi>g</mi><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">âŒˆ</mo><mfrac><mi>x</mi><mi>i</mi></mfrac><mo stretchy=\"false\">âŒ‰</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">F(x)=\\sum_{i=1}^ng(\\lceil\\frac{x}i\\rceil)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1493em;vertical-align:-0.345em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8043em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(âŒˆ</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6954em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">âŒ‰)</span></span></span></span>ï¼Œåˆ™æœ‰å¦‚æœ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">âŒˆ</mo><mfrac><mi>x</mi><mi>i</mi></mfrac><mo stretchy=\"false\">âŒ‰</mo><mo>=</mo><mo stretchy=\"false\">âŒˆ</mo><mfrac><mi>x</mi><mi>j</mi></mfrac><mo stretchy=\"false\">âŒ‰</mo></mrow><annotation encoding=\"application/x-tex\">\\lceil\\frac{x}{i}\\rceil=\\lceil\\frac{x}{j}\\rceil</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.095em;vertical-align:-0.345em;\"></span><span class=\"mopen\">âŒˆ</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6954em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">âŒ‰</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2311em;vertical-align:-0.4811em;\"></span><span class=\"mopen\">âŒˆ</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6954em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4811em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">âŒ‰</span></span></span></span>ï¼Œåˆ™æœ‰è¯¥å—çš„åˆ†å—åŒºé—´ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle mathsize=\"1.2em\"><mo stretchy=\"false\">[</mo><mi>i</mi><mo separator=\"true\">,</mo><mo stretchy=\"false\">âŒˆ</mo><mfrac><mi>x</mi><mrow><mo stretchy=\"false\">âŒˆ</mo><mfrac><mrow><mi>x</mi><mo>âˆ’</mo><mn>1</mn></mrow><mi>i</mi></mfrac><mo stretchy=\"false\">âŒ‰</mo></mrow></mfrac><mo stretchy=\"false\">âŒ‰</mo><mo stretchy=\"false\">]</mo></mstyle></mrow><annotation encoding=\"application/x-tex\">\\large [i,\\lceil\\frac{x}{\\lceil\\frac{x-1}{i}\\rceil}\\rceil]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.6427em;vertical-align:-0.7427em;\"></span><span class=\"mopen sizing reset-size6 size7\">[</span><span class=\"mord mathnormal sizing reset-size6 size7\">i</span><span class=\"mpunct sizing reset-size6 size7\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mopen sizing reset-size6 size7\">âŒˆ</span><span class=\"mord sizing reset-size6 size7\"><span class=\"mopen nulldelimiter sizing reset-size7 size6\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.681em;\"><span style=\"top:-2.6104em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">âŒˆ</span><span class=\"mord mtight\"><span class=\"mopen nulldelimiter sizing reset-size4 size6\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8693em;\"><span style=\"top:-2.656em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size4 size2 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span style=\"top:-3.2255em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line mtight\" style=\"border-bottom-width:0.049em;\"></span></span><span style=\"top:-3.386em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size4 size2 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.344em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter sizing reset-size4 size6\"></span></span><span class=\"mclose mtight\">âŒ‰</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6189em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter sizing reset-size7 size6\"></span></span><span class=\"mclose sizing reset-size6 size7\">âŒ‰]</span></span></span></span>ã€‚æ³¨æ„ç‰¹æ®Šå¤„ç†<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>â‰¥</mo><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">i\\ge x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7955em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>çš„æƒ…å†µï¼Œæ­¤æ—¶åˆ†å—å³ç«¯ç‚¹åˆ†æ¯ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>.æ³¨æ„å³è¾¹ç•Œçš„å†™æ³•ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">auto</span> calc = [&amp;](<span class=\"keyword\">auto</span> self, <span class=\"type\">int</span> x) -&gt; i64</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (mp.<span class=\"built_in\">count</span>(x))</span><br><span class=\"line\">            <span class=\"keyword\">return</span> mp[x];</span><br><span class=\"line\">        i64 res = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> i = <span class=\"number\">2</span>;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (i &lt;= n)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> invr = (x - <span class=\"number\">1</span>) / i;</span><br><span class=\"line\">            <span class=\"type\">int</span> r = n;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (invr != <span class=\"number\">0</span>)                  <span class=\"comment\">// åˆ†å—é˜²0</span></span><br><span class=\"line\">                r = <span class=\"built_in\">min</span>(r, (x - <span class=\"number\">1</span>) / invr); <span class=\"comment\">// æ³¨æ„åˆ†å—å€¼åŸŸä¸è¦è¶…è¿‡ä½ æ±‚å’Œå¼çš„ä¸Šç•Œ</span></span><br><span class=\"line\">            res = (res + (r - i + <span class=\"number\">1</span>) * <span class=\"built_in\">self</span>(self, (x + i - <span class=\"number\">1</span>) / i) % mod) % mod;</span><br><span class=\"line\">            i = r + <span class=\"number\">1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        res = (res * inv) % mod;</span><br><span class=\"line\">        res = (res + n * inv % mod) % mod;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> mp[x] = res;</span><br><span class=\"line\">    &#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-çº¿æ€§ä»£æ•°ç›¸å…³\">2. çº¿æ€§ä»£æ•°ç›¸å…³</h3>\n<h4 id=\"2-1-çŸ©é˜µå¿«é€Ÿå¹‚\">2.1 çŸ©é˜µå¿«é€Ÿå¹‚</h4>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;icpc-model/Modint.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> Modint;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> mod = <span class=\"number\">1e9</span> + <span class=\"number\">7</span>;</span><br><span class=\"line\"><span class=\"keyword\">using</span> mint = MInt&lt;mod&gt;;</span><br><span class=\"line\">vector&lt;vector&lt;mint&gt;&gt; <span class=\"keyword\">operator</span>*(vector&lt;vector&lt;mint&gt;&gt; a, vector&lt;vector&lt;mint&gt;&gt; b)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    vector&lt;vector&lt;mint&gt;&gt; <span class=\"built_in\">c</span>(a.<span class=\"built_in\">size</span>(), <span class=\"built_in\">vector</span>&lt;mint&gt;(a.<span class=\"built_in\">size</span>(), <span class=\"number\">0</span>));</span><br><span class=\"line\">    <span class=\"type\">int</span> n = a.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt; n; j++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> k = <span class=\"number\">0</span>; k &lt; n; k++)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                c[i][j] += (a[i][k] * b[k][j]);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> c;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">solve</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n;</span><br><span class=\"line\">    <span class=\"type\">long</span> <span class=\"type\">long</span> k;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; k;</span><br><span class=\"line\">    vector&lt;vector&lt;mint&gt;&gt; <span class=\"built_in\">E</span>(n, <span class=\"built_in\">vector</span>&lt;mint&gt;(n, <span class=\"number\">0</span>));</span><br><span class=\"line\">    vector&lt;vector&lt;mint&gt;&gt; A = E;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++)</span><br><span class=\"line\">        E[i][i] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt; n; j++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            cin &gt;&gt; A[i][j];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (k)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (k &amp; <span class=\"number\">1</span>)</span><br><span class=\"line\">            E = E * A;</span><br><span class=\"line\">        A = A * A;</span><br><span class=\"line\">        k &gt;&gt;= <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt; n; j++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            cout &lt;&lt; E[i][j] &lt;&lt; <span class=\"string\">&quot; &quot;</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        cout &lt;&lt; endl;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"type\">int</span> t;</span><br><span class=\"line\">    <span class=\"comment\">// cin &gt;&gt; t;</span></span><br><span class=\"line\">    <span class=\"comment\">// while (t--)</span></span><br><span class=\"line\">    <span class=\"built_in\">solve</span>();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"2-2-çŸ©é˜µæ•°åˆ—é€’æ¨\">2.2 çŸ©é˜µæ•°åˆ—é€’æ¨</h4>\n<p>å¯¹æ•°åˆ—é€’æ¨å¼å­åˆ—çŸ©é˜µæ–¹ç¨‹å°±è¡Œã€‚æœ€è‘—åçš„å°±æ˜¯feibonacciæ•°åˆ—ï¼š</p>\n<p>\\pmatrix{f_n\\\\f_{n-1}} =\\pmatrix{1\\ 1\\\\1 \\ 0}\\pmatrix{f_{ n-1}\\\\f_{n-2}}\n</p>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"2-3-çŸ©é˜µæ±‚é€†-é«˜æ–¯æ¶ˆå…ƒ-ä»…å¯æ±‚å”¯ä¸€è§£\">2.3 çŸ©é˜µæ±‚é€†/é«˜æ–¯æ¶ˆå…ƒ(ä»…å¯æ±‚å”¯ä¸€è§£)</h4>\n<p>æ±‚çŸ©é˜µçš„é€†çŸ©é˜µï¼Œæ— è§£åˆ¤å®šçŸ©é˜µéæ»¡ç§©çŸ©é˜µï¼Œç­‰ä»·äºè§£çº¿æ€§æ–¹ç¨‹ç»„ã€‚ä½¿ç”¨é«˜æ–¯æ¶ˆå…ƒæ³•å³å¯ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> mod = <span class=\"number\">998244353</span>;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> endl <span class=\"string\">&#x27;\\n&#x27;</span></span></span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> P = <span class=\"number\">1e9</span> + <span class=\"number\">7</span>;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">power</span><span class=\"params\">(<span class=\"type\">int</span> a, <span class=\"type\">int</span> b, <span class=\"type\">int</span> mod)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> res = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (b)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (b &amp; <span class=\"number\">1</span>)</span><br><span class=\"line\">            res = (<span class=\"number\">1ll</span> * res * a) % mod;</span><br><span class=\"line\">        a = (<span class=\"number\">1ll</span> * a * a) % mod;</span><br><span class=\"line\">        b &gt;&gt;= <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res % mod;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">std::vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">gauss</span><span class=\"params\">(std::vector&lt;std::vector&lt;<span class=\"type\">int</span>&gt;&gt; a, std::vector&lt;<span class=\"type\">int</span>&gt; b)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n = a.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; ++i)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> r = i;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (a[r][i] == <span class=\"number\">0</span>)</span><br><span class=\"line\">            ++r;</span><br><span class=\"line\">        std::<span class=\"built_in\">swap</span>(a[i], a[r]);</span><br><span class=\"line\">        std::<span class=\"built_in\">swap</span>(b[i], b[r]);</span><br><span class=\"line\">        <span class=\"type\">int</span> inv = <span class=\"built_in\">power</span>(a[i][i], P - <span class=\"number\">2</span>, P);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = i; j &lt; n; ++j)</span><br><span class=\"line\">            a[i][j] = <span class=\"number\">1ll</span> * a[i][j] * inv % P;</span><br><span class=\"line\">        b[i] = <span class=\"number\">1ll</span> * b[i] * inv % P;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt; n; ++j)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (i == j)</span><br><span class=\"line\">                <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">            <span class=\"type\">int</span> x = a[j][i];</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> k = i; k &lt; n; ++k)</span><br><span class=\"line\">                a[j][k] = (a[j][k] + <span class=\"number\">1ll</span> * (P - x) * a[i][k]) % P;</span><br><span class=\"line\">            b[j] = (b[j] + <span class=\"number\">1ll</span> * (P - x) * b[i]) % P;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> b;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">/**   é«˜æ–¯æ¶ˆå…ƒæ³•ï¼ˆgaussian eliminationï¼‰ã€ä¹…è¿œã€‘</span></span><br><span class=\"line\"><span class=\"comment\"> *    2020-12-02: https://www.codechef.com/viewsolution/39942900</span></span><br><span class=\"line\"><span class=\"comment\"> **/</span></span><br><span class=\"line\"><span class=\"function\">std::vector&lt;<span class=\"type\">double</span>&gt; <span class=\"title\">gauss</span><span class=\"params\">(std::vector&lt;std::vector&lt;<span class=\"type\">double</span>&gt;&gt; a, std::vector&lt;<span class=\"type\">double</span>&gt; b, <span class=\"type\">int</span> &amp;rank)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n = a.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; ++i)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> r = i;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (r &lt; n &amp;&amp; a[r][i] == <span class=\"number\">0</span>)</span><br><span class=\"line\">            ++r;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (r == n)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> b;</span><br><span class=\"line\">        std::<span class=\"built_in\">swap</span>(a[i], a[r]);</span><br><span class=\"line\">        std::<span class=\"built_in\">swap</span>(b[i], b[r]);</span><br><span class=\"line\">        <span class=\"type\">double</span> x = a[i][i];</span><br><span class=\"line\">        rank++;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = i; j &lt; n; ++j)</span><br><span class=\"line\">            a[i][j] /= x;</span><br><span class=\"line\">        b[i] /= x;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt; n; ++j)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (i == j)</span><br><span class=\"line\">                <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">            x = a[j][i];</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> k = i; k &lt; n; ++k)</span><br><span class=\"line\">                a[j][k] -= a[i][k] * x;</span><br><span class=\"line\">            b[j] -= b[i] * x;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> b;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">vector&lt;vector&lt;<span class=\"type\">int</span>&gt;&gt; <span class=\"built_in\">invmatrix</span>(vector&lt;vector&lt;<span class=\"type\">int</span>&gt;&gt; a, vector&lt;vector&lt;<span class=\"type\">int</span>&gt;&gt; b, <span class=\"type\">int</span> &amp;rank)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n = a.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; ++i)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> r = i;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (r &lt; n &amp;&amp; a[r][i] == <span class=\"number\">0</span>)</span><br><span class=\"line\">            ++r;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (r == n)</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        rank++;</span><br><span class=\"line\">        <span class=\"built_in\">swap</span>(a[i], a[r]);</span><br><span class=\"line\">        <span class=\"built_in\">swap</span>(b[i], b[r]);</span><br><span class=\"line\">        <span class=\"type\">int</span> inv = <span class=\"built_in\">power</span>(a[i][i], P - <span class=\"number\">2</span>, P);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = i; j &lt; n; ++j)</span><br><span class=\"line\">            a[i][j] = <span class=\"number\">1ll</span> * a[i][j] * inv % P;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> k = <span class=\"number\">0</span>; k &lt; n; k++)</span><br><span class=\"line\">            b[i][k] = <span class=\"number\">1ll</span> * b[i][k] * inv % P;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt; n; ++j)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (i == j)</span><br><span class=\"line\">                <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">            <span class=\"type\">int</span> x = a[j][i];</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> k = i; k &lt; n; ++k)</span><br><span class=\"line\">                a[j][k] = (a[j][k] + <span class=\"number\">1ll</span> * (P - x) * a[i][k]) % P;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> k = <span class=\"number\">0</span>; k &lt; n; k++)</span><br><span class=\"line\">                b[j][k] = (b[j][k] + <span class=\"number\">1ll</span> * (P - x) * b[i][k]) % P;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> b;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">solve</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    vector&lt;vector&lt;<span class=\"type\">int</span>&gt;&gt; <span class=\"built_in\">a</span>(n, <span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;(n));</span><br><span class=\"line\">    vector&lt;vector&lt;<span class=\"type\">int</span>&gt;&gt; <span class=\"built_in\">E</span>(n, <span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;(n));</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt; n; j++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            cin &gt;&gt; a[i][j];</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (i == j)</span><br><span class=\"line\">                E[i][j] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    vector&lt;vector&lt;<span class=\"type\">int</span>&gt;&gt; A;</span><br><span class=\"line\">    <span class=\"type\">int</span> rk = <span class=\"number\">0</span>;</span><br><span class=\"line\">    A = <span class=\"built_in\">invmatrix</span>(a, E, rk);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (rk != n)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cout &lt;&lt; <span class=\"string\">&quot;No Solution&quot;</span> &lt;&lt; endl;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> &amp;i : A)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> &amp;j : i)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            cout &lt;&lt; j &lt;&lt; <span class=\"string\">&quot; &quot;</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        cout &lt;&lt; endl;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"comment\">// int t;</span></span><br><span class=\"line\">    <span class=\"comment\">// cin &gt;&gt; t;</span></span><br><span class=\"line\">    <span class=\"comment\">// while (t--)</span></span><br><span class=\"line\">    <span class=\"built_in\">solve</span>();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"2-4-çº¿æ€§åŸº\">2.4 çº¿æ€§åŸº</h4>\n<p>ä¸éš¾å‘ç°ï¼ŒæŒ‰ä½Bitwise Xorè¿ç®—æ˜¯ä¸€ä¸ªé’ˆå¯¹MOD2å‰©ä½™ç³»å‘é‡ç©ºé—´åŠ æ³•è¿ç®—ï¼Œæ•…å­˜åœ¨ä»£æ•°çº¿æ€§åŸºã€‚</p>\n<p>çº¿æ€§ç©ºé—´<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>&lt;</mo><msubsup><mi>Z</mi><mn>2</mn><mi>n</mi></msubsup><mo separator=\"true\">,</mo><mi>b</mi><mi>i</mi><mi>t</mi><mi>w</mi><mi>i</mi><mi>s</mi><mi>e</mi><mtext>Â </mtext><mi>X</mi><mi>o</mi><mi>r</mi><mo separator=\"true\">,</mo><mi>b</mi><mi>i</mi><mi>t</mi><mi>w</mi><mi>i</mi><mi>s</mi><mi>e</mi><mtext>Â </mtext><mi>A</mi><mi>n</mi><mi>d</mi><mo>&gt;</mo></mrow><annotation encoding=\"application/x-tex\">&lt;Z_2^n,bitwise\\ Xor,bitwise\\ And&gt;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9425em;vertical-align:-0.2481em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-2.4519em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">bi</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">tw</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">se</span><span class=\"mspace\">Â </span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">or</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">bi</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">tw</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">se</span><span class=\"mspace\">Â </span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span></span></span></span>ä¸ºåŸŸç©ºé—´ã€‚</p>\n<p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å¼‚æˆ–çº¿æ€§åŸºå®ç°ï¼š</p>\n<ol>\n<li>\n<p>åˆ¤æ–­ä¸€ä¸ªæ•°èƒ½å¦è¡¨ç¤ºæˆæŸæ•°é›†å­é›†çš„å¼‚æˆ–å’Œï¼ˆå·²æœ‰é›†åˆå…ƒç´ æ˜¯å¦èƒ½å¤Ÿæ„é€ å‡º0ï¼‰ï¼›</p>\n</li>\n<li>\n<p>æ±‚ä¸€ä¸ªæ•°è¡¨ç¤ºæˆæŸæ•°é›†å­é›†å¼‚æˆ–å’Œçš„æ–¹æ¡ˆæ•°ï¼›</p>\n</li>\n<li>\n<p>æ±‚æŸæ•°é›†å­é›†çš„æœ€å¤§/æœ€å°/ç¬¬<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>å¤§/ç¬¬<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>â€‹å°å¼‚æˆ–å’Œï¼›</p>\n<p>å¦‚æœè¯´ï¼Œçº¿æ€§åŸºä¸­å¼‚æˆ–çš„æœ€å¤§æ•°ï¼ˆçš„äºŒè¿›åˆ¶å½¢å¼ï¼‰æ˜¯ä¸€ä¸² <strong>è¿ç»­çš„ï¼Œæ²¡æœ‰å¸¦åç»­<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span></strong> çš„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>ï¼Œé‚£ç›¸ä¿¡èªæ˜çš„ä½ ä¸€å®šä¼šæ±‚ç¬¬<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>å¤§ï¼Œå› ä¸ºç¬¬<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>å¤§å…¶å®å°±æ˜¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>ã€‚</p>\n<p>ç°åœ¨ç›¸å½“äºå‘Šè¯‰ä½ åœ¨è¿™ä¸€ä¸²<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>ä¸­å¤¹äº†å¾ˆå¤š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>ï¼Œé—®ä½ ç¬¬<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>å¤§æ˜¯å¤šå°‘ã€‚é‚£ä¹ˆä½ å…¶å®å¯ä»¥ä¸ç”¨ç®¡ä¸­é—´çš„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>ï¼ŒæŠŠ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>çš„äºŒè¿›åˆ¶å½¢å¼å¼„å‡ºæ¥ï¼Œç„¶åæŠŠä¸­é—´çœç•¥<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>ç»™æ’å›å»å°±å¥½äº†ã€‚ï¼ˆå› ä¸ºæœ€å¤§å€¼ä½æ˜¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>çš„åœ°æ–¹ä¸€è¾ˆå­ä¸å¯èƒ½å‡º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>ï¼‰<br>\nè§£é‡Šä¸€ä¸‹å°±ç›¸å½“äºæŠŠçº¿æ€§åŸºå¼‚æˆ–åå‡ºæ¥çš„æœ€å¤§å€¼é‡Œçš„æ‰€æœ‰<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>éƒ½ç»™æŒ¤åˆ°æœ€åï¼Œç„¶åæ±‚å‡ºç¬¬<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>å¤§ï¼Œå†æŠŠä½ å¼„èµ°çš„0ç»™ä¸¢å›å»ã€‚</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi><mi>g</mi><mo>:</mo></mrow><annotation encoding=\"application/x-tex\">eg:</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span></span></span></span>å¼‚æˆ–åæœ€å¤§å€¼ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>10110011</mn><msub><mn>0</mn><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">101100110_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7944em;vertical-align:-0.15em;\"></span><span class=\"mord\">10110011</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼Œé—®ç¬¬<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>20</mn></mrow><annotation encoding=\"application/x-tex\">20</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">20</span></span></span></span>å¤§</p>\n<p>æŒ¤åˆ°åé¢å»åæˆ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1111</mn><msub><mn>1</mn><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">11111_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7944em;vertical-align:-0.15em;\"></span><span class=\"mord\">1111</span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼Œç¬¬<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>å¤§æ˜¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1010</mn><msub><mn>0</mn><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">10100_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7944em;vertical-align:-0.15em;\"></span><span class=\"mord\">1010</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼ŒæŠŠ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>æ’å›å»æˆä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>10010000</mn><msub><mn>0</mn><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">100100000_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7944em;vertical-align:-0.15em;\"></span><span class=\"mord\">10010000</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼Œç¬¬20å¤§ä¾¿æ˜¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>10010000</mn><msub><mn>0</mn><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">100100000_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7944em;vertical-align:-0.15em;\"></span><span class=\"mord\">10010000</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></p>\n</li>\n<li>\n<p>æ±‚ä¸€ä¸ªæ•°åœ¨æŸæ•°é›†å­é›†å¼‚æˆ–å’Œä¸­çš„æ’åã€‚</p>\n</li>\n</ol>\n<p>çº¿æ€§åŸºçš„ç‹¬ç«‹æ€§å†³å®šäº†ä¸€ç»„å¼‚æˆ–ä¸º0çš„æ•°æ— è®ºä»¥ä»€ä¹ˆé¡ºåºæ’å…¥æœ€ç»ˆçº¿æ€§åŸºéƒ½ä¸ä¼šå…è®¸è¿™nä¸ªæ•°åŒæ—¶æ’å…¥çº¿æ€§åŸºä¸­ï¼Œæ‰€ä»¥å’Œçº¿æ€§åŸºç›¸å…³çš„è´ªå¿ƒç›´æ¥å¯¹æƒå€¼æ’åºåæŒ‰é¡ºåºæ’å…¥çº¿æ€§åŸºå°±å¯ä»¥äº†ã€‚</p>\n<p>æ³¨æ„ï¼Œçº¿æ€§åŸºçš„æ’å…¥æ˜¯å¯é‡å¤è´¡çŒ®çš„ï¼Œæ‰€ä»¥æ”¯æŒæ ‘ä¸Šå€å¢<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi><mi>M</mi><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">RMQ</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">RMQ</span></span></span></span>ï¼Œæ€æƒ³å‚è€ƒæ ‘ä¸Šå€å¢lcaæŸ¥è¯¢å’Œåºåˆ—åŒºé—´æœ€å¤§å€¼æŸ¥è¯¢ã€‚çº¿æ€§åŸºçš„æå¤§æ— å…³æ€§ä¿è¯ä»»æ„ä¸€ç»„çº¿æ€§åŸºæœ€å¤šæ˜¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">logn</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">n</span></span></span></span>â€‹çº§åˆ«çš„ï¼Œæ”¯æŒæš´åŠ›åˆå¹¶ã€‚å¯ä»¥å€ŸåŠ©æ ‘ä¸Šå€å¢å®ç°æ ‘ä¸ŠæŸ¥è¯¢é—®é¢˜ã€‚</p>\n<p>æ±‚<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>â†’</mo><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">x\\rightarrow y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â†’</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>è·¯å¾„ä¸Šçš„æœ€å¤§å¼‚æˆ–å’Œï¼Œåªéœ€è¦å››æ®µå½©è‰²å¼§çº¿æ®µæ‰€ä»£è¡¨çš„å€å¢çº¿æ€§åŸºåˆå¹¶å³å¯ï¼Œè¿™æ˜¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><msup><mi>g</mi><mn>2</mn></msup><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(log^2n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>çš„å•æ¬¡è¯¢é—®ã€‚æ±‚<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mi>c</mi><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">lca</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">a</span></span></span></span>æ–¹å¼çš„å€å¢è·³æ˜¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><msup><mi>g</mi><mn>3</mn></msup><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(log^3n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>çš„ã€‚</p>\n<p><img src=\"C:%5CUsers%5C%E6%A0%BE%E6%B4%A5%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20241030231917971.png\" alt=\"image-20241030231917971\"></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">LineBase</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"keyword\">private</span>:</span><br><span class=\"line\">    <span class=\"type\">const</span> <span class=\"type\">static</span> <span class=\"type\">int</span> MN = <span class=\"number\">62</span>;</span><br><span class=\"line\">    i64 a[MN + <span class=\"number\">1</span>], tmp[MN + <span class=\"number\">1</span>];</span><br><span class=\"line\">    <span class=\"type\">bool</span> flag; <span class=\"comment\">// çº¿æ€§åŸºä¸­æ˜¯å¦æœ‰é‡å¤æ’å…¥çš„å…ƒç´ </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">insert</span><span class=\"params\">(i64 x)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = MN; ~i; i--)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (x &amp; (<span class=\"number\">1ll</span> &lt;&lt; i))</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (!a[i])</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    a[i] = x;</span><br><span class=\"line\">                    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">else</span></span><br><span class=\"line\">                    x ^= a[i];</span><br><span class=\"line\">        flag = <span class=\"literal\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">bool</span> <span class=\"title\">check</span><span class=\"params\">(i64 x)</span> <span class=\"comment\">// æŸ¥çœ‹å½“å‰çº¿æ€§åŸºä¸­èƒ½å¦è¡¨ç¤ºå‡ºæ¥è¿™ä¸ªæ•°(æ˜¯å¦å·²æ’å…¥)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = MN; ~i; i--)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (x &amp; (<span class=\"number\">1ll</span> &lt;&lt; i))</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (!a[i])</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">                <span class=\"keyword\">else</span></span><br><span class=\"line\">                    x ^= a[i];</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">i64 <span class=\"title\">qmax</span><span class=\"params\">(i64 res = <span class=\"number\">0</span>)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = MN; ~i; i--)</span><br><span class=\"line\">            res = <span class=\"built_in\">max</span>(res, res ^ a[i]);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">i64 <span class=\"title\">qmin</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (flag) <span class=\"comment\">// çº¿æ€§åŸºæœ‰è¯•å›¾æ’å…¥è¿‡ç›¸åŒçš„æ•°ï¼Œæœ€å°å€¼ä¸º0</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt;= MN; i++)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (a[i])</span><br><span class=\"line\">                <span class=\"keyword\">return</span> a[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">i64 <span class=\"title\">query</span><span class=\"params\">(i64 k)</span> <span class=\"comment\">// çº¿æ€§åŸºä¸‹ç¬¬kå°</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        i64 res = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\">        k -= flag; <span class=\"comment\">// çº¿æ€§åŸºæœ‰è¯•å›¾æ’å…¥è¿‡ç›¸åŒçš„æ•°ï¼Œæœ€å°å€¼ä¸º0</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!k)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt;= MN; i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = i - <span class=\"number\">1</span>; ~j; j--)</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (a[i] &amp; (<span class=\"number\">1ll</span> &lt;&lt; j))</span><br><span class=\"line\">                    a[i] ^= a[j];</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (a[i])</span><br><span class=\"line\">                tmp[cnt++] = a[i];</span><br><span class=\"line\">        &#125; <span class=\"comment\">// çº¿æ€§åŸºé‡æ„</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (k &gt;= (<span class=\"number\">1ll</span> &lt;&lt; cnt))</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; cnt; i++)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (k &amp; (<span class=\"number\">1ll</span> &lt;&lt; i))</span><br><span class=\"line\">                res ^= tmp[i];</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">LineBase lb;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<p>æ ‘ä¸Šå€å¢æŸ¥è¯¢è·¯å¾„max</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">using</span> i64 = <span class=\"type\">long</span> <span class=\"type\">long</span>;</span><br><span class=\"line\"><span class=\"keyword\">using</span> u64 = <span class=\"type\">unsigned</span> <span class=\"type\">long</span> <span class=\"type\">long</span>;</span><br><span class=\"line\"><span class=\"type\">const</span> i64 mod = <span class=\"number\">998244353</span>;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> endl <span class=\"string\">&#x27;\\n&#x27;</span></span></span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">LineBase</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"keyword\">private</span>:</span><br><span class=\"line\">    <span class=\"type\">const</span> <span class=\"type\">static</span> <span class=\"type\">int</span> MN = <span class=\"number\">60</span>;</span><br><span class=\"line\">    array&lt;u64, MN + 1&gt; a;</span><br><span class=\"line\">    <span class=\"type\">bool</span> flag;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">friend</span> LineBase <span class=\"title\">merge</span><span class=\"params\">(LineBase a, LineBase b)</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"built_in\">LineBase</span>()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        a.<span class=\"built_in\">fill</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">ins</span><span class=\"params\">(u64 x)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = MN; ~i; i--)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (x &amp; (<span class=\"number\">1ll</span> &lt;&lt; i))</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (!a[i])</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    a[i] = x;</span><br><span class=\"line\">                    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">else</span></span><br><span class=\"line\">                    x ^= a[i];</span><br><span class=\"line\">        flag = <span class=\"literal\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">bool</span> <span class=\"title\">check</span><span class=\"params\">(u64 x)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = MN; ~i; i--)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (x &amp; (<span class=\"number\">1ll</span> &lt;&lt; i))</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (!a[i])</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">                <span class=\"keyword\">else</span></span><br><span class=\"line\">                    x ^= a[i];</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">u64 <span class=\"title\">qmax</span><span class=\"params\">(u64 res = <span class=\"number\">0</span>)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = MN; ~i; i--)</span><br><span class=\"line\">            res = <span class=\"built_in\">max</span>(res, res ^ a[i]);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">u64 <span class=\"title\">qmin</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (flag)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt;= MN; i++)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (a[i])</span><br><span class=\"line\">                <span class=\"keyword\">return</span> a[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">merge</span><span class=\"params\">(LineBase b)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; b.MN; i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>-&gt;<span class=\"built_in\">ins</span>(b.a[i]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"function\">LineBase <span class=\"title\">merge</span><span class=\"params\">(LineBase a, LineBase b)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    LineBase c = a;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; b.MN; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        c.<span class=\"built_in\">ins</span>(b.a[i]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> c;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">node</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> fa;</span><br><span class=\"line\">    LineBase lb;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">2e4</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\">node st[maxn][<span class=\"number\">16</span>];</span><br><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt; con[maxn];</span><br><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt; dep;</span><br><span class=\"line\">vector&lt;u64&gt; num;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">add_edge</span><span class=\"params\">(<span class=\"type\">int</span> u, <span class=\"type\">int</span> v)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    con[u].<span class=\"built_in\">push_back</span>(v);</span><br><span class=\"line\">    con[v].<span class=\"built_in\">push_back</span>(u);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"type\">int</span> u, <span class=\"type\">int</span> fa)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    st[u][<span class=\"number\">0</span>].fa = fa;</span><br><span class=\"line\">    dep[u] = dep[fa] + <span class=\"number\">1</span>;</span><br><span class=\"line\">    st[u][<span class=\"number\">0</span>].lb.<span class=\"built_in\">ins</span>(num[u]);</span><br><span class=\"line\">    st[u][<span class=\"number\">0</span>].lb.<span class=\"built_in\">ins</span>(num[fa]);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">1</span>; j &lt;= <span class=\"number\">15</span>; j++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        st[u][j].fa = st[st[u][j - <span class=\"number\">1</span>].fa][j - <span class=\"number\">1</span>].fa;</span><br><span class=\"line\">        st[u][j].lb = <span class=\"built_in\">merge</span>(st[u][j - <span class=\"number\">1</span>].lb, st[st[u][j - <span class=\"number\">1</span>].fa][j - <span class=\"number\">1</span>].lb);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> v : con[u])</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (v == fa)</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        <span class=\"built_in\">dfs</span>(v, u);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">pair&lt;<span class=\"type\">int</span>, LineBase&gt; <span class=\"title\">lca</span><span class=\"params\">(<span class=\"type\">int</span> u, <span class=\"type\">int</span> v)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (dep[u] &lt; dep[v])</span><br><span class=\"line\">        <span class=\"built_in\">swap</span>(u, v);</span><br><span class=\"line\">    <span class=\"type\">int</span> tmp = dep[u] - dep[v];</span><br><span class=\"line\">    LineBase ans;</span><br><span class=\"line\">    ans.<span class=\"built_in\">ins</span>(num[u]), ans.<span class=\"built_in\">ins</span>(num[v]);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt;= <span class=\"number\">15</span>; j++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> ((tmp &gt;&gt; j) &amp; <span class=\"number\">1</span>)</span><br><span class=\"line\">            ans.<span class=\"built_in\">merge</span>(st[u][j].lb), u = st[u][j].fa;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (u == v)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> &#123;u, ans&#125;;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">15</span>; j &gt;= <span class=\"number\">0</span>; j--)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (st[u][j].fa != st[v][j].fa)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            ans.<span class=\"built_in\">merge</span>(st[u][j].lb);</span><br><span class=\"line\">            ans.<span class=\"built_in\">merge</span>(st[v][j].lb);</span><br><span class=\"line\">            u = st[u][j].fa, v = st[v][j].fa;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ans.<span class=\"built_in\">merge</span>(st[u][<span class=\"number\">0</span>].lb);</span><br><span class=\"line\">    ans.<span class=\"built_in\">merge</span>(st[v][<span class=\"number\">0</span>].lb);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> &#123;st[u][<span class=\"number\">0</span>].fa, ans&#125;;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">solve</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n, q;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; q;</span><br><span class=\"line\">    num.<span class=\"built_in\">assign</span>(n + <span class=\"number\">1</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    dep.<span class=\"built_in\">assign</span>(n + <span class=\"number\">1</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cin &gt;&gt; num[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt; n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> u, v;</span><br><span class=\"line\">        cin &gt;&gt; u &gt;&gt; v;</span><br><span class=\"line\">        <span class=\"built_in\">add_edge</span>(u, v);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">dfs</span>(<span class=\"number\">1</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (q--)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> u, v;</span><br><span class=\"line\">        cin &gt;&gt; u &gt;&gt; v;</span><br><span class=\"line\">        cout &lt;&lt; <span class=\"built_in\">lca</span>(u, v).second.<span class=\"built_in\">qmax</span>() &lt;&lt; endl;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"type\">int</span> t = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"comment\">// cin &gt;&gt; t;</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> (t--)</span><br><span class=\"line\">        <span class=\"built_in\">solve</span>();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"2-5-äºŒè¿›åˆ¶çŸ©é˜µç±»Matrix-h\">2.5 äºŒè¿›åˆ¶çŸ©é˜µç±»Matrix.h</h4>\n<p>è¿™æ®µä»£ç å®šä¹‰äº†ä¸€ä¸ªåä¸º <code>matrix_Z2_base</code> çš„æ¨¡æ¿ç±»ï¼Œå®ƒç”¨äºè¡¨ç¤ºå’Œæ“ä½œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>&lt;</mo><msubsup><mi>Z</mi><mn>2</mn><mi>n</mi></msubsup><mo separator=\"true\">,</mo><mi>x</mi><mi>o</mi><mi>r</mi><mo separator=\"true\">,</mo><mi>a</mi><mi>n</mi><mi>d</mi><mo>&gt;</mo></mrow><annotation encoding=\"application/x-tex\">&lt;Z_2^n,xor,and&gt;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9425em;vertical-align:-0.2481em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-2.4519em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">or</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">an</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span></span></span></span>çº¿æ€§ç©ºé—´çš„çŸ©é˜µã€‚å…ƒç´ åªæœ‰0å’Œ1ï¼Œè¿ç®—åœ¨<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">mod2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">d</span><span class=\"mord\">2</span></span></span></span>æ•°åŸŸä¸‹ã€‚</p>\n<ol>\n<li>\n<p><strong>æ„é€ å‡½æ•°</strong>ï¼š</p>\n<ul>\n<li><code>matrix_Z2_base(int n, int m, bool init_diagonal = false, bool init_off_diagonal = false)</code>ï¼šåˆ›å»ºä¸€ä¸ªå¤§å°ä¸º nÃ—m çš„çŸ©é˜µï¼Œå…¶ä¸­ <code>n</code> æ˜¯è¡Œæ•°ï¼Œ<code>m</code> æ˜¯åˆ—æ•°ã€‚<code>init_diagonal</code> å’Œ <code>init_off_diagonal</code> å‚æ•°ç”¨äºåˆå§‹åŒ–å¯¹è§’çº¿å’Œéå¯¹è§’çº¿å…ƒç´ ã€‚å¦‚æœ <code>init_diagonal</code> ä¸º <code>true</code>ï¼Œåˆ™å¯¹è§’çº¿å…ƒç´ è¢«åˆå§‹åŒ–ä¸º 1ï¼Œå¦åˆ™ä¸º 0ã€‚éå¯¹è§’çº¿å…ƒç´ çš„åˆå§‹åŒ–ç”± <code>init_off_diagonal</code> æ§åˆ¶ã€‚</li>\n</ul>\n</li>\n<li>\n<p><strong>è®¿é—®æ“ä½œç¬¦</strong>ï¼š</p>\n<ul>\n<li><code>std::bitset&lt;SZ&gt; &amp;operator[](int i)</code>ï¼šè¿”å›ç¬¬ <code>i</code> è¡Œçš„å¼•ç”¨ã€‚</li>\n<li><code>const std::bitset&lt;SZ&gt; &amp;operator[](int i) const</code>ï¼šè¿”å›ç¬¬ <code>i</code> è¡Œçš„å¸¸é‡å¼•ç”¨ã€‚</li>\n</ul>\n</li>\n<li>\n<p><strong>åˆ‡ç‰‡æ“ä½œ</strong>ï¼š</p>\n<ul>\n<li><code>matrix_Z2_base &amp;inplace_slice(int il, int ir, int jl, int jr)</code>ï¼šåœ¨åŸåœ°ä¿®æ”¹çŸ©é˜µï¼Œè¿”å›å·¦ä¸Šè§’ä¸º <code>(il, jl)</code>ï¼Œå³ä¸‹è§’ä¸º <code>(ir, jr)</code> çš„å­çŸ©é˜µã€‚</li>\n<li><code>matrix_Z2_base slice(int il, int ir, int jl, int jr) const</code>ï¼šè¿”å›å·¦ä¸Šè§’ä¸º <code>(il, jl)</code>ï¼Œå³ä¸‹è§’ä¸º <code>(ir, jr)</code> çš„å­çŸ©é˜µçš„å‰¯æœ¬ã€‚</li>\n</ul>\n</li>\n<li>\n<p><strong>è¡Œåˆ‡ç‰‡å’Œåˆ—åˆ‡ç‰‡</strong>ï¼š</p>\n<ul>\n<li><code>matrix_Z2_base &amp;inplace_row_slice(int il, int ir)</code>ï¼šåœ¨åŸåœ°ä¿®æ”¹çŸ©é˜µï¼Œè¿”å›è¡Œåˆ‡ç‰‡å­çŸ©é˜µã€‚</li>\n<li><code>matrix_Z2_base row_slice(int il, int ir) const</code>ï¼šè¿”å›è¡Œåˆ‡ç‰‡å­çŸ©é˜µçš„å‰¯æœ¬ã€‚</li>\n<li><code>matrix_Z2_base &amp;inplace_column_slice(int jl, int jr)</code>ï¼šåœ¨åŸåœ°ä¿®æ”¹çŸ©é˜µï¼Œè¿”å›åˆ—åˆ‡ç‰‡å­çŸ©é˜µã€‚</li>\n<li><code>matrix_Z2_base column_slice(int jl, int jr) const</code>ï¼šè¿”å›åˆ—åˆ‡ç‰‡å­çŸ©é˜µçš„å‰¯æœ¬ã€‚</li>\n</ul>\n</li>\n<li>\n<p><strong>æ¯”è¾ƒæ“ä½œç¬¦</strong>ï¼š</p>\n<ul>\n<li><code>bool operator==(const matrix_Z2_base &amp;a) const</code>ï¼šæ¯”è¾ƒä¸¤ä¸ªçŸ©é˜µæ˜¯å¦ç›¸ç­‰ã€‚</li>\n<li><code>bool operator!=(const matrix_Z2_base &amp;a) const</code>ï¼šæ¯”è¾ƒä¸¤ä¸ªçŸ©é˜µæ˜¯å¦ä¸ç›¸ç­‰ã€‚</li>\n</ul>\n</li>\n<li>\n<p><strong>çŸ©é˜µåŠ æ³•å’Œå‡æ³•</strong>ï¼š</p>\n<ul>\n<li><code>matrix_Z2_base &amp;operator+=(const matrix_Z2_base &amp;M)</code>ï¼šåŸåœ°çŸ©é˜µåŠ æ³•ã€‚</li>\n<li><code>matrix_Z2_base operator+(const matrix_Z2_base &amp;M) const</code>ï¼šè¿”å›ä¸¤ä¸ªçŸ©é˜µç›¸åŠ çš„ç»“æœã€‚</li>\n<li><code>matrix_Z2_base &amp;operator-=(const matrix_Z2_base &amp;M)</code>ï¼šåŸåœ°çŸ©é˜µå‡æ³•ã€‚</li>\n<li><code>matrix_Z2_base operator-(const matrix_Z2_base &amp;M) const</code>ï¼šè¿”å›ä¸¤ä¸ªçŸ©é˜µç›¸å‡çš„ç»“æœã€‚</li>\n</ul>\n</li>\n<li>\n<p><strong>çŸ©é˜µä¹˜æ³•</strong>ï¼š</p>\n<ul>\n<li><code>matrix_Z2_base &amp;operator*=(const matrix_Z2_base &amp;a)</code>ï¼šåŸåœ°çŸ©é˜µä¹˜æ³•ã€‚</li>\n<li><code>matrix_Z2_base operator*(const matrix_Z2_base &amp;a) const</code>ï¼šè¿”å›ä¸¤ä¸ªçŸ©é˜µç›¸ä¹˜çš„ç»“æœã€‚</li>\n</ul>\n</li>\n<li>\n<p><strong>çŸ©é˜µä¹˜ä»¥å¸¸æ•°</strong>ï¼š</p>\n<ul>\n<li><code>matrix_Z2_base &amp;operator*=(bool c)</code>ï¼šå°†çŸ©é˜µçš„æ¯ä¸ªå…ƒç´ ä¹˜ä»¥å¸ƒå°”å¸¸æ•° <code>c</code>ã€‚</li>\n<li><code>matrix_Z2_base operator*(bool c) const</code>ï¼šè¿”å›ä¹˜ä»¥å¸¸æ•°åçš„çŸ©é˜µã€‚</li>\n</ul>\n</li>\n<li>\n<p><strong>çŸ©é˜µä¹˜æ–¹</strong>ï¼š</p>\n<ul>\n<li><code>matrix_Z2_base &amp;inplace_power(T e)</code>ï¼šåŸåœ°è®¡ç®—çŸ©é˜µçš„ <code>e</code> æ¬¡å¹‚ã€‚</li>\n<li><code>matrix_Z2_base power(T e) const</code>ï¼šè¿”å›çŸ©é˜µçš„ <code>e</code> æ¬¡å¹‚ã€‚</li>\n</ul>\n</li>\n<li>\n<p><strong>çŸ©é˜µè½¬ç½®</strong>ï¼š</p>\n<ul>\n<li><code>matrix_Z2_base &amp;inplace_transpose()</code>ï¼šåŸåœ°è½¬ç½®çŸ©é˜µã€‚</li>\n<li><code>matrix_Z2_base transpose() const</code>ï¼šè¿”å›çŸ©é˜µçš„è½¬ç½®ã€‚</li>\n</ul>\n</li>\n<li>\n<p><strong>çŸ©é˜µä¹˜ä»¥è¡Œå‘é‡</strong>ï¼š</p>\n<ul>\n<li><code>std::vector&lt;int&gt; operator*(const std::bitset&lt;SZ&gt; &amp;v) const</code>ï¼šå°†çŸ©é˜µä¹˜ä»¥è¡Œå‘é‡ <code>v</code>ã€‚</li>\n</ul>\n</li>\n<li>\n<p><strong>è¡Œé˜¶æ¢¯å½¢å¼å’Œè¡Œåˆ—å¼ã€ç§©</strong>ï¼š</p>\n<ul>\n<li><code>tuple&lt;matrix_Z2_base &amp;, bool, int&gt; inplace_REF(int up_to = -1)</code>ï¼šåŸåœ°è®¡ç®—çŸ©é˜µçš„è¡Œé˜¶æ¢¯å½¢å¼ï¼Œå¹¶è¿”å›è¡Œåˆ—å¼å’Œç§©ã€‚</li>\n<li><code>tuple&lt;matrix_Z2_base, bool, int&gt; REF(int up_to = -1) const</code>ï¼šè¿”å›çŸ©é˜µçš„è¡Œé˜¶æ¢¯å½¢å¼ï¼Œå¹¶è¿”å›è¡Œåˆ—å¼å’Œç§©ã€‚</li>\n</ul>\n</li>\n<li>\n<p><strong>çŸ©é˜µé€†</strong>ï¼š</p>\n<ul>\n<li><code>optional&lt;matrix_Z2_base&gt; inverse() const</code>ï¼šè¿”å›çŸ©é˜µçš„é€†ï¼Œå¦‚æœçŸ©é˜µä¸å¯é€†ï¼Œåˆ™è¿”å›ç©ºã€‚</li>\n</ul>\n</li>\n<li>\n<p><strong>è¡Œåˆ—å¼</strong>ï¼š</p>\n<ul>\n<li><code>bool determinant() const</code>ï¼šè¿”å›çŸ©é˜µçš„è¡Œåˆ—å¼æ˜¯å¦ä¸º 1ã€‚</li>\n</ul>\n</li>\n<li>\n<p><strong>ç§©</strong>ï¼š</p>\n<ul>\n<li><code>int rank() const</code>ï¼šè¿”å›çŸ©é˜µçš„ç§©ã€‚</li>\n</ul>\n</li>\n<li>\n<p><strong>çº¿æ€§æ–¹ç¨‹ç»„çš„è§£</strong>ï¼š</p>\n<ul>\n<li>\n<p><code>optional&lt;std::bitset&lt;SZ&gt;&gt; find_a_solution() const</code>ï¼šè¿”å›çŸ©é˜µæ‰€ä»£è¡¨çš„çº¿æ€§æ–¹ç¨‹ç»„çš„ä¸€ä¸ªè§£ã€‚</p>\n<p>è§£å¤šè§£<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>å…ƒ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>å¼çº¿æ€§æ–¹ç¨‹ç»„ç¤ºä¾‹ï¼š</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> s = <span class=\"number\">0</span>; s &lt; n; ++s)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"function\">matrix_Z2 <span class=\"title\">M</span><span class=\"params\">(n + <span class=\"number\">1</span>, n + <span class=\"number\">1</span>)</span></span>;<span class=\"comment\">//ç¬¬nè¡Œè¡¨ç¤ºä¸»å…ƒéƒ½æœ‰è°ï¼Œç¬¬nåˆ—æ˜¯æ–¹ç¨‹å¢å¹¿åˆ—ï¼Œè¡¨ç¤ºå„çº¿æ€§æ–¹ç¨‹ç»“æœã€‚</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> u = <span class=\"number\">0</span>; u &lt; n; ++u)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> v = <span class=\"number\">0</span>; v &lt; n; ++v)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (adjm[u] &gt;&gt; v &amp; <span class=\"number\">1</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                M[v][u] = <span class=\"number\">1</span>;<span class=\"comment\">//åŸé¢˜æ˜¯ä¸ªå›¾è®ºï¼Œæ ¹æ®è¾¹åˆ—çš„çŸ©é˜µæ–¹ç¨‹</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        M[n][u] = u == s;<span class=\"comment\">//æ ‡è®°ä¸»å…ƒï¼Œè¡¨ç¤ºç¬¬sä¸ªå…ƒç´ çš„è§£å¿…é¡»æ˜¯1ï¼Œç»™å‡ºæ¥çš„å¤šç»„è§£å¿…å®šçº¿æ€§æ— å…³</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    M[n][n] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">auto</span> resptr = M.<span class=\"built_in\">find_a_solution</span>())</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> pick = *resptr;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> u = <span class=\"number\">0</span>; u &lt; n; ++u)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (pick[u])</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                res[u] |= <span class=\"number\">1LL</span> &lt;&lt; s;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cout &lt;&lt; <span class=\"string\">&quot;No\\n&quot;</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>è¾“å‡ºæ“ä½œç¬¦</strong>ï¼š</p>\n<ul>\n<li><code>friend output_stream &amp;operator&lt;&lt;(output_stream &amp;out, const matrix_Z2_base &amp;a)</code>ï¼šè¾“å‡ºçŸ©é˜µåˆ°æµã€‚</li>\n</ul>\n</li>\n<li>\n<p><strong>çŸ©é˜µä¹˜ä»¥å¸¸æ•°ï¼ˆå¤–éƒ¨ï¼‰</strong>ï¼š</p>\n<ul>\n<li><code>matrix_Z2_base&lt;SZ&gt; operator*(bool c, matrix_Z2_base&lt;SZ&gt; M)</code>ï¼šè¿”å›ä¹˜ä»¥å¸¸æ•°åçš„çŸ©é˜µã€‚</li>\n</ul>\n</li>\n<li>\n<p><strong>è¡Œå‘é‡ä¹˜ä»¥çŸ©é˜µ</strong>ï¼š</p>\n<ul>\n<li><code>std::bitset&lt;SZ&gt; operator*(const std::vector&lt;int&gt; &amp;v, const matrix_Z2_base&lt;SZ&gt; &amp;a)</code>ï¼šå°†è¡Œå‘é‡ <code>v</code> ä¹˜ä»¥çŸ©é˜µ <code>a</code>ã€‚</li>\n</ul>\n</li>\n</ol>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">ifndef</span> __MATRIX_H__</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> __MATRIX_H__</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\"> *@brief äºŒè¿›åˆ¶çŸ©é˜µç±»</span></span><br><span class=\"line\"><span class=\"comment\"> *@note è¯¥ç±»æ”¯æŒçŸ©é˜µçš„åŠ å‡ä¹˜ï¼Œæ±‚é€†ï¼Œæ±‚è¡Œåˆ—å¼ï¼Œæ±‚ç§©ï¼Œæ±‚è¡Œé˜¶æ¢¯å½¢å¼ï¼Œæ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„ç­‰æ“ä½œ</span></span><br><span class=\"line\"><span class=\"comment\"> *@tparam SZ çŸ©é˜µåˆ—å‘é‡çš„ä½æ•°ï¼Œå³çŸ©é˜µçš„åˆ—æ•°ï¼Œç”¨äºåˆå§‹åŒ–bitsetçš„ä½æ•°</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">template</span> &lt;<span class=\"type\">size_t</span> SZ&gt;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">matrix_Z2_base</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n, m;</span><br><span class=\"line\">    std::vector&lt;std::bitset&lt;SZ&gt;&gt; data;</span><br><span class=\"line\">    std::bitset&lt;SZ&gt; &amp;<span class=\"keyword\">operator</span>[](<span class=\"type\">int</span> i)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">assert</span>(<span class=\"number\">0</span> &lt;= i &amp;&amp; i &lt; n);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> data[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">const</span> std::bitset&lt;SZ&gt; &amp;<span class=\"keyword\">operator</span>[](<span class=\"type\">int</span> i) <span class=\"type\">const</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">assert</span>(<span class=\"number\">0</span> &lt;= i &amp;&amp; i &lt; n);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> data[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">matrix_Z2_base &amp;<span class=\"title\">inplace_slice</span><span class=\"params\">(<span class=\"type\">int</span> il, <span class=\"type\">int</span> ir, <span class=\"type\">int</span> jl, <span class=\"type\">int</span> jr)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">assert</span>(<span class=\"number\">0</span> &lt;= il &amp;&amp; il &lt;= ir &amp;&amp; ir &lt;= n);</span><br><span class=\"line\">        <span class=\"built_in\">assert</span>(<span class=\"number\">0</span> &lt;= jl &amp;&amp; jl &lt;= jr &amp;&amp; jr &lt;= m);</span><br><span class=\"line\">        n = ir - il, m = jr - jl;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (il &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> i = <span class=\"number\">0</span>; i &lt; n; ++i)</span><br><span class=\"line\">                <span class=\"built_in\">swap</span>(data[i], data[il + i]);</span><br><span class=\"line\">        data.<span class=\"built_in\">resize</span>(n);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> &amp;row : data)</span><br><span class=\"line\">            row = row &lt;&lt; SZ - jr &gt;&gt; jl;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">     *@brief è¿”å›ä¸€ä¸ªå­çŸ©é˜µ</span></span><br><span class=\"line\"><span class=\"comment\">     *@param il å·¦ä¸Šè§’è¡Œåæ ‡</span></span><br><span class=\"line\"><span class=\"comment\">     *@param ir å³ä¸‹è§’è¡Œåæ ‡</span></span><br><span class=\"line\"><span class=\"comment\">     *@param jl å·¦ä¸Šè§’åˆ—åæ ‡</span></span><br><span class=\"line\"><span class=\"comment\">     *@param jr å³ä¸‹è§’åˆ—åæ ‡</span></span><br><span class=\"line\"><span class=\"comment\">     *@return è¿”å›ä¸€ä¸ªå­çŸ©é˜µ</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\">matrix_Z2_base <span class=\"title\">slice</span><span class=\"params\">(<span class=\"type\">int</span> il, <span class=\"type\">int</span> ir, <span class=\"type\">int</span> jl, <span class=\"type\">int</span> jr)</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">matrix_Z2_base</span>(*<span class=\"keyword\">this</span>).<span class=\"built_in\">inplace_slice</span>(il, ir, jl, jr);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">matrix_Z2_base &amp;<span class=\"title\">inplace_row_slice</span><span class=\"params\">(<span class=\"type\">int</span> il, <span class=\"type\">int</span> ir)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">assert</span>(<span class=\"number\">0</span> &lt;= il &amp;&amp; il &lt;= ir &amp;&amp; ir &lt;= n);</span><br><span class=\"line\">        n = ir - il;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (il &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> i = <span class=\"number\">0</span>; i &lt; n; ++i)</span><br><span class=\"line\">                <span class=\"built_in\">swap</span>(data[i], data[il + i]);</span><br><span class=\"line\">        data.<span class=\"built_in\">resize</span>(n);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">     *@brief è¿”å›ä¸€ä¸ªè¡Œåˆ‡ç‰‡å­çŸ©é˜µ</span></span><br><span class=\"line\"><span class=\"comment\">     *@param il å·¦ä¸Šè§’è¡Œåæ ‡</span></span><br><span class=\"line\"><span class=\"comment\">     *@param ir å³ä¸‹è§’è¡Œåæ ‡</span></span><br><span class=\"line\"><span class=\"comment\">     *@return è¿”å›ä¸€ä¸ªè¡Œåˆ‡ç‰‡å­çŸ©é˜µ</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\">matrix_Z2_base <span class=\"title\">row_slice</span><span class=\"params\">(<span class=\"type\">int</span> il, <span class=\"type\">int</span> ir)</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">matrix_Z2_base</span>(*<span class=\"keyword\">this</span>).<span class=\"built_in\">inplace_row_slice</span>(il, ir);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">matrix_Z2_base &amp;<span class=\"title\">inplace_column_slice</span><span class=\"params\">(<span class=\"type\">int</span> jl, <span class=\"type\">int</span> jr)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">assert</span>(<span class=\"number\">0</span> &lt;= jl &amp;&amp; jl &lt;= jr &amp;&amp; jr &lt;= m);</span><br><span class=\"line\">        m = jr - jl;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> &amp;row : data)</span><br><span class=\"line\">            row = row &lt;&lt; SZ - jr &gt;&gt; jl;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">     *@brief è¿”å›ä¸€ä¸ªåˆ—åˆ‡ç‰‡å­çŸ©é˜µ</span></span><br><span class=\"line\"><span class=\"comment\">     *@param jl å·¦ä¸Šè§’åˆ—åæ ‡</span></span><br><span class=\"line\"><span class=\"comment\">     *@param jr å³ä¸‹è§’åˆ—åæ ‡</span></span><br><span class=\"line\"><span class=\"comment\">     *@return è¿”å›ä¸€ä¸ªåˆ—åˆ‡ç‰‡å­çŸ©é˜µ</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\">matrix_Z2_base <span class=\"title\">column_slice</span><span class=\"params\">(<span class=\"type\">int</span> jl, <span class=\"type\">int</span> jr)</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">matrix_Z2_base</span>(*<span class=\"keyword\">this</span>).<span class=\"built_in\">inplace_column_slice</span>(jl, jr);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// çŸ©é˜µç›¸ç­‰</span></span><br><span class=\"line\">    <span class=\"type\">bool</span> <span class=\"keyword\">operator</span>==(<span class=\"type\">const</span> matrix_Z2_base &amp;a) <span class=\"type\">const</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">assert</span>(n == a.n &amp;&amp; m == a.m);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> data == a.data;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// çŸ©é˜µä¸ç­‰</span></span><br><span class=\"line\">    <span class=\"type\">bool</span> <span class=\"keyword\">operator</span>!=(<span class=\"type\">const</span> matrix_Z2_base &amp;a) <span class=\"type\">const</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">assert</span>(n == a.n &amp;&amp; m == a.m);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> data != a.data;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// çŸ©é˜µç›¸åŠ </span></span><br><span class=\"line\">    matrix_Z2_base &amp;<span class=\"keyword\">operator</span>+=(<span class=\"type\">const</span> matrix_Z2_base &amp;M)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">assert</span>(n == M.n &amp;&amp; m == M.m);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> i = <span class=\"number\">0</span>; i &lt; n; ++i)</span><br><span class=\"line\">            data[i] ^= M[i];</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// çŸ©é˜µç›¸åŠ </span></span><br><span class=\"line\">    matrix_Z2_base <span class=\"keyword\">operator</span>+(<span class=\"type\">const</span> matrix_Z2_base &amp;M) <span class=\"type\">const</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">matrix_Z2_base</span>(*<span class=\"keyword\">this</span>) += M;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// çŸ©é˜µç›¸å‡</span></span><br><span class=\"line\">    matrix_Z2_base &amp;<span class=\"keyword\">operator</span>-=(<span class=\"type\">const</span> matrix_Z2_base &amp;M)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">assert</span>(n == M.n &amp;&amp; m == M.m);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> i = <span class=\"number\">0</span>; i &lt; n; ++i)</span><br><span class=\"line\">            data[i] ^= M[i];</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// çŸ©é˜µç›¸å‡</span></span><br><span class=\"line\">    matrix_Z2_base <span class=\"keyword\">operator</span>-(<span class=\"type\">const</span> matrix_Z2_base &amp;M) <span class=\"type\">const</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">matrix_Z2_base</span>(*<span class=\"keyword\">this</span>) -= M;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// çŸ©é˜µç›¸ä¹˜</span></span><br><span class=\"line\">    matrix_Z2_base &amp;<span class=\"keyword\">operator</span>*=(<span class=\"type\">const</span> matrix_Z2_base &amp;a)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">assert</span>(m == a.n);</span><br><span class=\"line\">        <span class=\"type\">int</span> l = a.m;</span><br><span class=\"line\">        <span class=\"function\">matrix_Z2_base <span class=\"title\">res</span><span class=\"params\">(n, l)</span></span>;</span><br><span class=\"line\">        std::vector&lt;std::bitset&lt;SZ&gt;&gt; <span class=\"built_in\">temp</span>(l);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> i = <span class=\"number\">0</span>; i &lt; l; ++i)</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> j = <span class=\"number\">0</span>; j &lt; m; ++j)</span><br><span class=\"line\">                temp[i][j] = a[j][i];</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> i = <span class=\"number\">0</span>; i &lt; n; ++i)</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> j = <span class=\"number\">0</span>; j &lt; l; ++j)</span><br><span class=\"line\">                res[i][j] = (data[i] &amp; temp[j]).<span class=\"built_in\">count</span>() &amp; <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span> = res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// çŸ©é˜µç›¸ä¹˜</span></span><br><span class=\"line\">    matrix_Z2_base <span class=\"keyword\">operator</span>*(<span class=\"type\">const</span> matrix_Z2_base &amp;a) <span class=\"type\">const</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">matrix_Z2_base</span>(*<span class=\"keyword\">this</span>) *= a;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// çŸ©é˜µä¹˜ä»¥ä¸€ä¸ªå¸¸æ•°</span></span><br><span class=\"line\">    matrix_Z2_base &amp;<span class=\"keyword\">operator</span>*=(<span class=\"type\">bool</span> c)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!c)</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> &amp;v : *<span class=\"keyword\">this</span>)</span><br><span class=\"line\">                v.<span class=\"built_in\">reset</span>();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// çŸ©é˜µä¹˜ä»¥ä¸€ä¸ªå¸¸æ•°</span></span><br><span class=\"line\">    matrix_Z2_base <span class=\"keyword\">operator</span>*(<span class=\"type\">bool</span> c) <span class=\"type\">const</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">matrix_Z2_base</span>(*<span class=\"keyword\">this</span>) *= c;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// çŸ©é˜µä¹˜æ–¹</span></span><br><span class=\"line\">    <span class=\"keyword\">template</span> &lt;<span class=\"keyword\">class</span> <span class=\"title class_\">T</span>, <span class=\"keyword\">typename</span> enable_if&lt;is_integral&lt;T&gt;::value&gt;::type * = <span class=\"literal\">nullptr</span>&gt;</span><br><span class=\"line\">    matrix_Z2_base &amp;<span class=\"built_in\">inplace_power</span>(T e)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">assert</span>(n == m);</span><br><span class=\"line\">        <span class=\"function\">matrix_Z2_base <span class=\"title\">res</span><span class=\"params\">(n, n, <span class=\"literal\">true</span>)</span></span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (; e; *<span class=\"keyword\">this</span> *= *<span class=\"keyword\">this</span>, e &gt;&gt;= <span class=\"number\">1</span>)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (e &amp; <span class=\"number\">1</span>)</span><br><span class=\"line\">                res *= *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span> = res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// çŸ©é˜µä¹˜æ–¹</span></span><br><span class=\"line\">    <span class=\"keyword\">template</span> &lt;<span class=\"keyword\">class</span> <span class=\"title class_\">T</span>&gt;</span><br><span class=\"line\">    <span class=\"function\">matrix_Z2_base <span class=\"title\">power</span><span class=\"params\">(T e)</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">matrix_Z2_base</span>(*<span class=\"keyword\">this</span>).<span class=\"built_in\">inplace_power</span>(e);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// çŸ©é˜µè½¬ç½®</span></span><br><span class=\"line\">    <span class=\"function\">matrix_Z2_base &amp;<span class=\"title\">inplace_transpose</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">assert</span>(n == m);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> i = <span class=\"number\">0</span>; i &lt; n; ++i)</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> j = i + <span class=\"number\">1</span>; j &lt; n; ++j)</span><br><span class=\"line\">                <span class=\"built_in\">swap</span>(data[i][j], data[j][i]);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// çŸ©é˜µè½¬ç½®</span></span><br><span class=\"line\">    <span class=\"function\">matrix_Z2_base <span class=\"title\">transpose</span><span class=\"params\">()</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (n == m)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">matrix_Z2_base</span>(*<span class=\"keyword\">this</span>).<span class=\"built_in\">inplace_transpose</span>();</span><br><span class=\"line\">        <span class=\"function\">matrix_Z2_base <span class=\"title\">res</span><span class=\"params\">(m, n)</span></span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> i = <span class=\"number\">0</span>; i &lt; n; ++i)</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> j = <span class=\"number\">0</span>; j &lt; m; ++j)</span><br><span class=\"line\">                res[j][i] = data[i][j];</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">     *@brief çŸ©é˜µä¹˜ä»¥ä¸€ä¸ªè¡Œå‘é‡</span></span><br><span class=\"line\"><span class=\"comment\">     *@param v è¡Œå‘é‡</span></span><br><span class=\"line\"><span class=\"comment\">     *@return è¿”å›ä¸€ä¸ªè¡Œå‘é‡</span></span><br><span class=\"line\"><span class=\"comment\">     *@note è¡Œå‘é‡å¿…é¡»åœ¨çŸ©é˜µå·¦ä¹˜ï¼Œæ—¶é—´å¤æ‚åº¦O(n * m / w)</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    std::vector&lt;<span class=\"type\">int</span>&gt; <span class=\"keyword\">operator</span>*(<span class=\"type\">const</span> std::bitset&lt;SZ&gt; &amp;v) <span class=\"type\">const</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"function\">std::vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">res</span><span class=\"params\">(n)</span></span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> i = <span class=\"number\">0</span>; i &lt; n; ++i)</span><br><span class=\"line\">            res[i] = (data[i] &amp; v).<span class=\"built_in\">count</span>() &amp; <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// O(n * m * up_to / w)</span></span><br><span class=\"line\">    <span class=\"comment\">// Returns &#123;REF matrix, determinant, rank&#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">     *@brief çŸ©é˜µçš„è¡Œé˜¶æ¢¯å½¢å¼</span></span><br><span class=\"line\"><span class=\"comment\">     *@param up_to è¡Œé˜¶æ¢¯å½¢å¼çš„è¡Œæ•°ï¼Œå¸¦å‚æ•°çš„æƒ…å†µä¸‹åªè®¡ç®—å‰up_to=m-1åˆ—å‘é‡çš„è¡Œé˜¶æ¢¯å½¢å¼ï¼Œç”¨äºè§£çº¿æ€§æ–¹ç¨‹ç»„</span></span><br><span class=\"line\"><span class=\"comment\">     *@return è¿”å›ä¸€ä¸ªå…ƒç»„ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯è¡Œé˜¶æ¢¯å½¢å¼çš„çŸ©é˜µï¼Œç¬¬äºŒä¸ªå…ƒç´ æ˜¯è¡Œåˆ—å¼ï¼Œç¬¬ä¸‰ä¸ªå…ƒç´ æ˜¯ç§©</span></span><br><span class=\"line\"><span class=\"comment\">     *@note æ—¶é—´å¤æ‚åº¦O(n * m * up_to / w),å¦‚æœè¦è§£å¤šè§£çº¿æ€§æ–¹ç¨‹ç»„ï¼Œå¦‚æœæƒ³å›ºå®šç¬¬kä¸ªè‡ªç”±å˜é‡ï¼Œéœ€è¦å¯¹ä¼ å…¥çŸ©é˜µçš„a_&#123;n,k&#125;ç½®1,åŒæ—¶å¢å¹¿å‘é‡çš„å¯¹åº”ä½a_&#123;n,n&#125;ä¹Ÿå¿…é¡»ç½®1ï¼Œç„¶åè°ƒç”¨è¯¥å‡½æ•°ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">     *@note å®é™…ä¸Šç­‰ä»·äºæ–°æ·»äº†ä¸€ç»„çº¿æ€§æ–¹ç¨‹ï¼Œå³a_&#123;n,k&#125; * x_k = a_&#123;n,n&#125;ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\">tuple&lt;matrix_Z2_base &amp;, <span class=\"type\">bool</span>, <span class=\"type\">int</span>&gt; <span class=\"title\">inplace_REF</span><span class=\"params\">(<span class=\"type\">int</span> up_to = <span class=\"number\">-1</span>)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (n == <span class=\"number\">0</span>)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> &#123;*<span class=\"keyword\">this</span>, <span class=\"literal\">true</span>, <span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!~up_to)</span><br><span class=\"line\">            up_to = m;</span><br><span class=\"line\">        <span class=\"type\">bool</span> det = <span class=\"literal\">true</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> rank = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> j = <span class=\"number\">0</span>; j &lt; up_to; ++j)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> pivot = <span class=\"number\">-1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> i = rank; i &lt; n; ++i)</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (data[i][j])</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    pivot = i;</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!~pivot)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                det = <span class=\"literal\">false</span>;</span><br><span class=\"line\">                <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (rank != pivot)</span><br><span class=\"line\">                <span class=\"built_in\">swap</span>(data[rank], data[pivot]);</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> i = rank + <span class=\"number\">1</span>; i &lt; n; ++i)</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (data[i][j])</span><br><span class=\"line\">                    data[i] ^= data[rank];</span><br><span class=\"line\">            ++rank;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (rank == n)</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> &#123;*<span class=\"keyword\">this</span>, det, rank&#125;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// O(n * m * up_to / w)</span></span><br><span class=\"line\">    <span class=\"comment\">// Returns &#123;REF matrix, determinant, rank&#125;</span></span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">     *@brief çŸ©é˜µçš„è¡Œé˜¶æ¢¯å½¢å¼</span></span><br><span class=\"line\"><span class=\"comment\">     *@param up_to è¡Œé˜¶æ¢¯å½¢å¼çš„è¡Œæ•°</span></span><br><span class=\"line\"><span class=\"comment\">     *@return è¿”å›ä¸€ä¸ªå…ƒç»„ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯è¡Œé˜¶æ¢¯å½¢å¼çš„çŸ©é˜µï¼Œç¬¬äºŒä¸ªå…ƒç´ æ˜¯è¡Œåˆ—å¼ï¼Œç¬¬ä¸‰ä¸ªå…ƒç´ æ˜¯ç§©</span></span><br><span class=\"line\"><span class=\"comment\">     *@note æ—¶é—´å¤æ‚åº¦O(n * m * up_to / w)ã€‚è§£å¤šè§£çº¿æ€§æ–¹ç¨‹ç»„æ—¶ï¼Œå¦‚æœæƒ³å›ºå®šç¬¬kä¸ªè‡ªç”±å˜é‡ï¼Œéœ€è¦å¯¹ä¼ å…¥çŸ©é˜µçš„a_&#123;n,k&#125;ç½®1,åŒæ—¶å¢å¹¿å‘é‡çš„å¯¹åº”ä½a_&#123;n,n&#125;ä¹Ÿå¿…é¡»ç½®1ï¼Œç„¶åè°ƒç”¨è¯¥å‡½æ•°ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">     *@note å®é™…ä¸Šç­‰ä»·äºæ–°æ·»äº†ä¸€ç»„çº¿æ€§æ–¹ç¨‹ï¼Œå³a_&#123;n,k&#125; * x_k = a_&#123;n,n&#125;ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\">tuple&lt;matrix_Z2_base, <span class=\"type\">bool</span>, <span class=\"type\">int</span>&gt; <span class=\"title\">REF</span><span class=\"params\">(<span class=\"type\">int</span> up_to = <span class=\"number\">-1</span>)</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">matrix_Z2_base</span>(*<span class=\"keyword\">this</span>).<span class=\"built_in\">inplace_REF</span>(up_to);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// O(n * m * min(n, m) / w)</span></span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">     *@brief çŸ©é˜µçš„é€†</span></span><br><span class=\"line\"><span class=\"comment\">     *@return è¿”å›ä¸€ä¸ªå¯é€‰çš„çŸ©é˜µï¼Œè¡¨ç¤ºçŸ©é˜µçš„é€†</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\">optional&lt;matrix_Z2_base&gt; <span class=\"title\">inverse</span><span class=\"params\">()</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">assert</span>(n == m);</span><br><span class=\"line\">        std::vector&lt;std::bitset&lt;SZ&gt;&gt; <span class=\"built_in\">a</span>(data), <span class=\"built_in\">res</span>(n);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> i = <span class=\"number\">0</span>; i &lt; n; ++i)</span><br><span class=\"line\">            res[i].<span class=\"built_in\">set</span>(i);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> j = <span class=\"number\">0</span>; j &lt; n; ++j)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> pivot = <span class=\"number\">-1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> i = j; i &lt; n; ++i)</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (a[i][j])</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    pivot = i;</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!~pivot)</span><br><span class=\"line\">                <span class=\"keyword\">return</span> &#123;&#125;;</span><br><span class=\"line\">            <span class=\"built_in\">swap</span>(a[j], a[pivot]), <span class=\"built_in\">swap</span>(res[j], res[pivot]);</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> i = <span class=\"number\">0</span>; i &lt; n; ++i)</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (i != j &amp;&amp; a[i][j])</span><br><span class=\"line\">                    a[i] ^= a[j], res[i] ^= res[j];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">swap</span>(*<span class=\"keyword\">this</span>, res);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">     *@brief çŸ©é˜µçš„è¡Œåˆ—å¼</span></span><br><span class=\"line\"><span class=\"comment\">     *@return è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºçŸ©é˜µçš„è¡Œåˆ—å¼æ˜¯å¦ä¸º1</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">bool</span> <span class=\"title\">determinant</span><span class=\"params\">()</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">assert</span>(n == m);</span><br><span class=\"line\">        <span class=\"function\">matrix_Z2_base <span class=\"title\">a</span><span class=\"params\">(data)</span></span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> i = <span class=\"number\">0</span>; i &lt; n; ++i)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> j = i + <span class=\"number\">1</span>; j &lt; n; ++j)</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (a[j][i])</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (a[i][i])</span><br><span class=\"line\">                        a[j] ^= a[i];</span><br><span class=\"line\">                    <span class=\"keyword\">else</span></span><br><span class=\"line\">                        <span class=\"built_in\">swap</span>(a[i], a[j]);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!a[i][i])</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// O(n^3 / w)</span></span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">     *@brief çŸ©é˜µçš„ç§©</span></span><br><span class=\"line\"><span class=\"comment\">     *@return è¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºçŸ©é˜µçš„ç§©</span></span><br><span class=\"line\"><span class=\"comment\">     *@note æ—¶é—´å¤æ‚åº¦O(n^3 / w)</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">rank</span><span class=\"params\">()</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">get</span>&lt;<span class=\"number\">2</span>&gt;(<span class=\"built_in\">REF</span>());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// Regarding the matrix as a system of linear equations by separating first m-1 columns, find a solution of the linear equation.</span></span><br><span class=\"line\">    <span class=\"comment\">// O(n * m^2 / w)</span></span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">     *@brief çŸ©é˜µæ‰€ä»£è¡¨çš„çº¿æ€§æ–¹ç¨‹ç»„çš„ä¸€ä¸ªè§£</span></span><br><span class=\"line\"><span class=\"comment\">     *@return è¿”å›ä¸€ä¸ªå¯é€‰çš„ä½é›†ï¼Œè¡¨ç¤ºçŸ©é˜µçš„ä¸€ä¸ªè§£</span></span><br><span class=\"line\"><span class=\"comment\">     *@note æ—¶é—´å¤æ‚åº¦O(n * m^2 / w),è¯¥çŸ©é˜µæ‰€ä»£è¡¨çš„çº¿æ€§æ–¹ç¨‹ç»„ç³»æ•°çŸ©é˜µä¸ºä½m-1ä½ï¼Œå¸¸æ•°é¡¹ä¸ºç¬¬mä½ï¼Œè¡¨ç¤ºn*(m-1)çš„å¢å¹¿çŸ©é˜µã€‚</span></span><br><span class=\"line\"><span class=\"comment\">     *@note æ—¶é—´å¤æ‚åº¦O(n * m * up_to / w),å¦‚æœè¦è§£å¤šè§£çº¿æ€§æ–¹ç¨‹ç»„ï¼Œå¦‚æœæƒ³å›ºå®šç¬¬kä¸ªè‡ªç”±å˜é‡ï¼Œéœ€è¦å¯¹ä¼ å…¥çŸ©é˜µçš„a_&#123;n,k&#125;ç½®1,åŒæ—¶å¢å¹¿å‘é‡çš„å¯¹åº”ä½a_&#123;n,n&#125;ä¹Ÿå¿…é¡»ç½®1ï¼Œç„¶åè°ƒç”¨è¯¥å‡½æ•°ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">     *@note å®é™…ä¸Šç­‰ä»·äºæ–°æ·»äº†ä¸€ç»„çº¿æ€§æ–¹ç¨‹ï¼Œå³a_&#123;n,k&#125; * x_k = a_&#123;n,n&#125;ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    optional&lt;std::bitset&lt;SZ&gt;&gt; <span class=\"built_in\">find_a_solution</span>() <span class=\"type\">const</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">assert</span>(m &gt;= <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> [ref, _, rank] = <span class=\"built_in\">REF</span>(m - <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> i = rank; i &lt; n; ++i)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (ref[i][m - <span class=\"number\">1</span>])</span><br><span class=\"line\">                <span class=\"keyword\">return</span> &#123;&#125;;</span><br><span class=\"line\">        std::bitset&lt;SZ&gt; res;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> i = rank - <span class=\"number\">1</span>; i &gt;= <span class=\"number\">0</span>; --i)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> pivot = ref[i]._Find_first();</span><br><span class=\"line\">            <span class=\"built_in\">assert</span>(pivot &lt; m - <span class=\"number\">1</span>);</span><br><span class=\"line\">            res[pivot] = ref[i][m - <span class=\"number\">1</span>] ^ (ref[i] &amp; res).<span class=\"built_in\">count</span>() &amp; <span class=\"number\">1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">template</span> &lt;<span class=\"keyword\">class</span> <span class=\"title class_\">output_stream</span>&gt;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> output_stream &amp;<span class=\"keyword\">operator</span>&lt;&lt;(output_stream &amp;out, <span class=\"type\">const</span> matrix_Z2_base &amp;a)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        out &lt;&lt; <span class=\"string\">&quot;\\n&quot;</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> i = <span class=\"number\">0</span>; i &lt; a.n; ++i)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> j = <span class=\"number\">0</span>; j &lt; a.m; ++j)</span><br><span class=\"line\">                out &lt;&lt; <span class=\"built_in\">bool</span>(a[i][j]);</span><br><span class=\"line\">            out &lt;&lt; <span class=\"string\">&quot;\\n&quot;</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> out;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">     *@brief æ„é€ å‡½æ•°</span></span><br><span class=\"line\"><span class=\"comment\">     *@param n è¡Œæ•°</span></span><br><span class=\"line\"><span class=\"comment\">     *@param m åˆ—æ•°</span></span><br><span class=\"line\"><span class=\"comment\">     *@param init_diagonal å¯¹è§’çº¿æ˜¯å¦åˆå§‹åŒ–</span></span><br><span class=\"line\"><span class=\"comment\">     *@param init_off_diagonal éå¯¹è§’çº¿æ˜¯å¦åˆå§‹åŒ–</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"built_in\">matrix_Z2_base</span>(<span class=\"type\">int</span> n, <span class=\"type\">int</span> m, <span class=\"type\">bool</span> init_diagonal = <span class=\"literal\">false</span>, <span class=\"type\">bool</span> init_off_diagonal = <span class=\"literal\">false</span>) : <span class=\"built_in\">n</span>(n), <span class=\"built_in\">m</span>(m), <span class=\"built_in\">data</span>(n)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">assert</span>(m &lt;= SZ);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> i = <span class=\"number\">0</span>; i &lt; n; ++i)</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> j = <span class=\"number\">0</span>; j &lt; m; ++j)</span><br><span class=\"line\">                data[i][j] = i == j ? init_diagonal : init_off_diagonal;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">     *@brief æ„é€ å‡½æ•°</span></span><br><span class=\"line\"><span class=\"comment\">     *@param n è¡Œæ•°</span></span><br><span class=\"line\"><span class=\"comment\">     *@param m åˆ—æ•°</span></span><br><span class=\"line\"><span class=\"comment\">     *@param a çŸ©é˜µ</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"built_in\">matrix_Z2_base</span>(<span class=\"type\">int</span> n, <span class=\"type\">int</span> m, <span class=\"type\">const</span> std::vector&lt;std::bitset&lt;SZ&gt;&gt; &amp;a) : <span class=\"built_in\">n</span>(n), <span class=\"built_in\">m</span>(m), <span class=\"built_in\">data</span>(a) &#123;&#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\"> *@brief çŸ©é˜µä¹˜ä»¥ä¸€ä¸ªå¸¸æ•°</span></span><br><span class=\"line\"><span class=\"comment\"> *@param c å¸¸æ•°</span></span><br><span class=\"line\"><span class=\"comment\"> *@param M çŸ©é˜µ</span></span><br><span class=\"line\"><span class=\"comment\"> *@return è¿”å›ä¸€ä¸ªçŸ©é˜µ</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">template</span> &lt;<span class=\"type\">size_t</span> SZ&gt;</span><br><span class=\"line\">matrix_Z2_base&lt;SZ&gt; <span class=\"keyword\">operator</span>*(<span class=\"type\">bool</span> c, matrix_Z2_base&lt;SZ&gt; M)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!c)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> &amp;v : M)</span><br><span class=\"line\">            v.<span class=\"built_in\">reset</span>();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> M;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// Multiply a row std::vector v on the left</span></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\"> *@brief è¡Œå‘é‡ä¹˜ä»¥çŸ©é˜µ</span></span><br><span class=\"line\"><span class=\"comment\"> *@param v è¡Œå‘é‡</span></span><br><span class=\"line\"><span class=\"comment\"> *@param a çŸ©é˜µ</span></span><br><span class=\"line\"><span class=\"comment\"> *@return è¿”å›ä¸€ä¸ªè¡Œå‘é‡</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">template</span> &lt;<span class=\"type\">size_t</span> SZ&gt;</span><br><span class=\"line\">std::bitset&lt;SZ&gt; <span class=\"keyword\">operator</span>*(<span class=\"type\">const</span> std::vector&lt;<span class=\"type\">int</span>&gt; &amp;v, <span class=\"type\">const</span> matrix_Z2_base&lt;SZ&gt; &amp;a)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"built_in\">assert</span>(a.n == (<span class=\"type\">int</span>)v.<span class=\"built_in\">size</span>());</span><br><span class=\"line\">    std::bitset&lt;SZ&gt; res;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> i = <span class=\"number\">0</span>; i &lt; a.n; ++i)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (v[i])</span><br><span class=\"line\">            res ^= a[i];</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">endif</span></span></span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"3-å¤šé¡¹å¼ç›¸å…³\">3. å¤šé¡¹å¼ç›¸å…³</h3>\n<p>å…³é”®è¯ï¼šå·ç§¯ä¼˜åŒ–ã€‚åŠ¨æ€è§„åˆ’ä¼˜åŒ–ã€‚</p>\n<h4 id=\"3-1-å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ï¼ˆFTTï¼‰-å¤šé¡¹å¼ä¹˜æ³•\">3.1 å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ï¼ˆFTTï¼‰/å¤šé¡¹å¼ä¹˜æ³•</h4>\n<p>ç»™å®šä¸€ä¸ª <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> æ¬¡å¤šé¡¹å¼ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">F(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>ï¼Œå’Œä¸€ä¸ª <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span> æ¬¡å¤šé¡¹å¼ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">G(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">G</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>ã€‚</p>\n<p>è¯·æ±‚å‡º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">F(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span> å’Œ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">G(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">G</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span> çš„å·ç§¯ï¼Œä»ä½æ¬¡æ–¹é¡¹åˆ°é«˜æ¬¡æ–¹é¡¹ç»™å‡ºç³»æ•°ã€‚</p>\n<p>ä¿è¯è¾“å…¥ä¸­çš„ç³»æ•°å¤§äºç­‰äº <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span> ä¸”å°äºç­‰äº <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>9</mn></mrow><annotation encoding=\"application/x-tex\">9</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">9</span></span></span></span>ã€‚</p>\n<p>å¯¹äº <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>100</mn><mi mathvariant=\"normal\">%</mi></mrow><annotation encoding=\"application/x-tex\">100\\%</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8056em;vertical-align:-0.0556em;\"></span><span class=\"mord\">100%</span></span></span></span> çš„æ•°æ®ï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>n</mi><mo separator=\"true\">,</mo><mi>m</mi><mo>â‰¤</mo><msup><mn>10</mn><mn>6</mn></msup></mrow><annotation encoding=\"application/x-tex\">1 \\le n, m \\leq {10}^6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8304em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8484em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\">10</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8484em;\"><span style=\"top:-3.0973em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">6</span></span></span></span></span></span></span></span></span></span></span>â€‹â€‹ã€‚</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mi>T</mi><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">FTT</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">FTT</span></span></span></span>ç­‰ä¸‹åˆ—ä¸€ç³»åˆ—å¿«é€Ÿå˜æ¢çš„æœ¬è´¨éƒ½æ˜¯é€‰æ‹©å‡ºæ¥<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mi>w</mi></msup><mo>=</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">2^w=n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02691em;\">w</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>ä¸ªå¤šé¡¹å¼ç‚¹å€¼ï¼Œç”¨è¿™ç»„ç‚¹å€¼å‘é‡çš„è¿ç®—å»æ›¿ä»£å¤šé¡¹å¼çš„è¿ç®—ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;math.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">using</span> d32 = <span class=\"type\">double</span>;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> endl <span class=\"string\">&#x27;\\n&#x27;</span></span></span><br><span class=\"line\"><span class=\"type\">const</span> d32 PI = <span class=\"number\">3.14159265358979323846</span>;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">fft</span><span class=\"params\">(vector&lt;complex&lt;d32&gt;&gt; &amp;a)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n = a.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (n == <span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    vector&lt;complex&lt;d32&gt;&gt; <span class=\"built_in\">a0</span>(n / <span class=\"number\">2</span>), <span class=\"built_in\">a1</span>(n / <span class=\"number\">2</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n / <span class=\"number\">2</span>; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        a0[i] = a[i * <span class=\"number\">2</span>];</span><br><span class=\"line\">        a1[i] = a[i * <span class=\"number\">2</span> + <span class=\"number\">1</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">fft</span>(a0);</span><br><span class=\"line\">    <span class=\"built_in\">fft</span>(a1);</span><br><span class=\"line\">    d32 ang = <span class=\"number\">2</span> * PI / n;</span><br><span class=\"line\">    <span class=\"function\">complex&lt;d32&gt; <span class=\"title\">w</span><span class=\"params\">(<span class=\"number\">1</span>)</span>, <span class=\"title\">wn</span><span class=\"params\">(cos(ang), sin(ang))</span></span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n / <span class=\"number\">2</span>; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        a[i] = a0[i] + w * a1[i];</span><br><span class=\"line\">        a[i + n / <span class=\"number\">2</span>] = a0[i] - w * a1[i];</span><br><span class=\"line\">        w *= wn;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">vector&lt;d32&gt; <span class=\"title\">mul</span><span class=\"params\">(vector&lt;d32&gt; a, vector&lt;d32&gt; b)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (n &lt; a.<span class=\"built_in\">size</span>() + b.<span class=\"built_in\">size</span>())</span><br><span class=\"line\">        n *= <span class=\"number\">2</span>;</span><br><span class=\"line\">    a.<span class=\"built_in\">resize</span>(n);</span><br><span class=\"line\">    b.<span class=\"built_in\">resize</span>(n);</span><br><span class=\"line\">    vector&lt;complex&lt;d32&gt;&gt; <span class=\"built_in\">A</span>(a.<span class=\"built_in\">begin</span>(), a.<span class=\"built_in\">end</span>()), <span class=\"built_in\">B</span>(b.<span class=\"built_in\">begin</span>(), b.<span class=\"built_in\">end</span>());</span><br><span class=\"line\">    <span class=\"built_in\">fft</span>(A);</span><br><span class=\"line\">    <span class=\"built_in\">fft</span>(B);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++)</span><br><span class=\"line\">        A[i] *= B[i];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++)</span><br><span class=\"line\">        A[i] = <span class=\"built_in\">conj</span>(A[i]);<span class=\"comment\">//é€†å˜æ¢å‰æ±‚å€’æ•°ã€‚</span></span><br><span class=\"line\">    <span class=\"built_in\">fft</span>(A);</span><br><span class=\"line\">    <span class=\"function\">vector&lt;d32&gt; <span class=\"title\">res</span><span class=\"params\">(n)</span></span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++)</span><br><span class=\"line\">        res[i] = <span class=\"built_in\">round</span>(A[i].<span class=\"built_in\">real</span>() / n);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">solve</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n, m;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class=\"line\">    <span class=\"function\">vector&lt;d32&gt; <span class=\"title\">a</span><span class=\"params\">(n + <span class=\"number\">1</span>)</span>, <span class=\"title\">b</span><span class=\"params\">(m + <span class=\"number\">1</span>)</span></span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt;= n; i++)</span><br><span class=\"line\">        cin &gt;&gt; a[i];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt;= m; i++)</span><br><span class=\"line\">        cin &gt;&gt; b[i];</span><br><span class=\"line\">    vector&lt;d32&gt; res = <span class=\"built_in\">mul</span>(a, b);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt;= n + m; i++)</span><br><span class=\"line\">        cout &lt;&lt; (<span class=\"type\">long</span> <span class=\"type\">long</span>)res[i] &lt;&lt; <span class=\"string\">&quot; &quot;</span>;</span><br><span class=\"line\">    cout &lt;&lt; endl;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"type\">int</span> t = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"comment\">// cin &gt;&gt; t;</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> (t--)</span><br><span class=\"line\">        <span class=\"built_in\">solve</span>();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>è¿˜æœ‰ä¸€ç§å†™æ³•ï¼š</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">using</span> d32 = <span class=\"type\">double</span>;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> endl <span class=\"string\">&#x27;\\n&#x27;</span></span></span><br><span class=\"line\"><span class=\"type\">const</span> d32 PI = <span class=\"number\">3.14159265358979323846</span>;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">fft</span><span class=\"params\">(vector&lt;complex&lt;<span class=\"type\">double</span>&gt;&gt; &amp;f, <span class=\"type\">int</span> op)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n = f.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (n == <span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    vector&lt;complex&lt;<span class=\"type\">double</span>&gt;&gt; <span class=\"built_in\">f0</span>(n / <span class=\"number\">2</span>), <span class=\"built_in\">f1</span>(n / <span class=\"number\">2</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n / <span class=\"number\">2</span>; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        f0[i] = f[i * <span class=\"number\">2</span>];</span><br><span class=\"line\">        f1[i] = f[i * <span class=\"number\">2</span> + <span class=\"number\">1</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">fft</span>(f0, op);</span><br><span class=\"line\">    <span class=\"built_in\">fft</span>(f1, op);</span><br><span class=\"line\">    <span class=\"function\">complex&lt;<span class=\"type\">double</span>&gt; <span class=\"title\">cur</span><span class=\"params\">(<span class=\"number\">1</span>, <span class=\"number\">0</span>)</span>, <span class=\"title\">step</span><span class=\"params\">(cos(<span class=\"number\">2</span> * PI / n), sin(<span class=\"number\">2</span> * PI * op / n))</span></span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> k = <span class=\"number\">0</span>; k &lt; n / <span class=\"number\">2</span>; ++k)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        complex&lt;<span class=\"type\">double</span>&gt; tmp = cur * f1[k];</span><br><span class=\"line\">        f[k] = f0[k] + tmp;</span><br><span class=\"line\">        f[k + n / <span class=\"number\">2</span>] = f0[k] - tmp;</span><br><span class=\"line\">        cur *= step;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">vector&lt;d32&gt; <span class=\"title\">mul</span><span class=\"params\">(vector&lt;d32&gt; &amp;a, vector&lt;d32&gt; &amp;b)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (n &lt; a.<span class=\"built_in\">size</span>() + b.<span class=\"built_in\">size</span>())</span><br><span class=\"line\">        n *= <span class=\"number\">2</span>;</span><br><span class=\"line\">    a.<span class=\"built_in\">resize</span>(n);</span><br><span class=\"line\">    b.<span class=\"built_in\">resize</span>(n);</span><br><span class=\"line\">    vector&lt;complex&lt;d32&gt;&gt; <span class=\"built_in\">A</span>(a.<span class=\"built_in\">begin</span>(), a.<span class=\"built_in\">end</span>()), <span class=\"built_in\">B</span>(b.<span class=\"built_in\">begin</span>(), b.<span class=\"built_in\">end</span>());</span><br><span class=\"line\">    <span class=\"built_in\">fft</span>(A, <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"built_in\">fft</span>(B, <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++)</span><br><span class=\"line\">        A[i] *= B[i];</span><br><span class=\"line\">    <span class=\"built_in\">fft</span>(A, <span class=\"number\">-1</span>);</span><br><span class=\"line\">    <span class=\"function\">vector&lt;d32&gt; <span class=\"title\">res</span><span class=\"params\">(n)</span></span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++)</span><br><span class=\"line\">        res[i] = <span class=\"built_in\">round</span>(A[i].<span class=\"built_in\">real</span>() / n);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"3-2-å¿«é€Ÿæ•°è®ºå˜æ¢ï¼ˆNTTï¼‰-å¤šé¡¹å¼ä¹˜æ³•\">3.2 å¿«é€Ÿæ•°è®ºå˜æ¢ï¼ˆNTTï¼‰/å¤šé¡¹å¼ä¹˜æ³•</h4>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">constexpr</span> <span class=\"type\">int</span> P = <span class=\"number\">998244353</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">power</span><span class=\"params\">(<span class=\"type\">int</span> a, <span class=\"type\">int</span> b)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> res = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (; b; b /= <span class=\"number\">2</span>, a = <span class=\"number\">1LL</span> * a * a % P)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (b % <span class=\"number\">2</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            res = <span class=\"number\">1LL</span> * res * a % P;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">std::vector&lt;<span class=\"type\">int</span>&gt; rev, roots&#123;<span class=\"number\">0</span>, <span class=\"number\">1</span>&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">dft</span><span class=\"params\">(std::vector&lt;<span class=\"type\">int</span>&gt; &amp;a)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n = a.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">int</span>(rev.<span class=\"built_in\">size</span>()) != n)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> k = __builtin_ctz(n) - <span class=\"number\">1</span>;</span><br><span class=\"line\">        rev.<span class=\"built_in\">resize</span>(n);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            rev[i] = rev[i &gt;&gt; <span class=\"number\">1</span>] &gt;&gt; <span class=\"number\">1</span> | (i &amp; <span class=\"number\">1</span>) &lt;&lt; k;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (rev[i] &lt; i)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            std::<span class=\"built_in\">swap</span>(a[i], a[rev[i]]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (roots.<span class=\"built_in\">size</span>() &lt; n)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> k = __builtin_ctz(roots.<span class=\"built_in\">size</span>());</span><br><span class=\"line\">        roots.<span class=\"built_in\">resize</span>(n);</span><br><span class=\"line\">        <span class=\"keyword\">while</span> ((<span class=\"number\">1</span> &lt;&lt; k) &lt; n)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> e = <span class=\"built_in\">power</span>(<span class=\"number\">31</span>, <span class=\"number\">1</span> &lt;&lt; (__builtin_ctz(P - <span class=\"number\">1</span>) - k - <span class=\"number\">1</span>));</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span> &lt;&lt; (k - <span class=\"number\">1</span>); i &lt; (<span class=\"number\">1</span> &lt;&lt; k); i++)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                roots[<span class=\"number\">2</span> * i] = roots[i];</span><br><span class=\"line\">                roots[<span class=\"number\">2</span> * i + <span class=\"number\">1</span>] = <span class=\"number\">1LL</span> * roots[i] * e % P;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            k++;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> k = <span class=\"number\">1</span>; k &lt; n; k *= <span class=\"number\">2</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i += <span class=\"number\">2</span> * k)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt; k; j++)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"type\">int</span> u = a[i + j];</span><br><span class=\"line\">                <span class=\"type\">int</span> v = <span class=\"number\">1LL</span> * a[i + j + k] * roots[k + j] % P;</span><br><span class=\"line\">                a[i + j] = (u + v) % P;</span><br><span class=\"line\">                a[i + j + k] = (u - v + P) % P;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">idft</span><span class=\"params\">(std::vector&lt;<span class=\"type\">int</span>&gt; &amp;a)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n = a.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">    std::<span class=\"built_in\">reverse</span>(a.<span class=\"built_in\">begin</span>() + <span class=\"number\">1</span>, a.<span class=\"built_in\">end</span>());</span><br><span class=\"line\">    <span class=\"built_in\">dft</span>(a);</span><br><span class=\"line\">    <span class=\"type\">int</span> inv = <span class=\"built_in\">power</span>(n, P - <span class=\"number\">2</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        a[i] = <span class=\"number\">1LL</span> * a[i] * inv % P;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">std::vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">mul</span><span class=\"params\">(std::vector&lt;<span class=\"type\">int</span>&gt; a, std::vector&lt;<span class=\"type\">int</span>&gt; b)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n = <span class=\"number\">1</span>, tot = a.<span class=\"built_in\">size</span>() + b.<span class=\"built_in\">size</span>() - <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (n &lt; tot)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        n *= <span class=\"number\">2</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (tot &lt; <span class=\"number\">128</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"function\">std::vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">c</span><span class=\"params\">(a.size() + b.size() - <span class=\"number\">1</span>)</span></span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; a.<span class=\"built_in\">size</span>(); i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt; b.<span class=\"built_in\">size</span>(); j++)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                c[i + j] = (c[i + j] + <span class=\"number\">1LL</span> * a[i] * b[j]) % P;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> c;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    a.<span class=\"built_in\">resize</span>(n);</span><br><span class=\"line\">    b.<span class=\"built_in\">resize</span>(n);</span><br><span class=\"line\">    <span class=\"built_in\">dft</span>(a);</span><br><span class=\"line\">    <span class=\"built_in\">dft</span>(b);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        a[i] = <span class=\"number\">1LL</span> * a[i] * b[i] % P;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">idft</span>(a);</span><br><span class=\"line\">    a.<span class=\"built_in\">resize</span>(tot);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> a;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"3-3-å¿«é€Ÿè«æ¯”ä¹Œæ–¯å˜æ¢-å¿«é€Ÿæ²ƒå°”ä»€å˜æ¢ï¼ˆFMT-FWTï¼‰\">3.3 å¿«é€Ÿè«æ¯”ä¹Œæ–¯å˜æ¢/å¿«é€Ÿæ²ƒå°”ä»€å˜æ¢ï¼ˆFMT/FWTï¼‰</h4>\n<p>ç»™å®šé•¿åº¦ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">2^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span> ä¸¤ä¸ªåºåˆ— <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo separator=\"true\">,</mo><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">A,B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span>ï¼Œè®¾</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>C</mi><mi>i</mi></msub><mo>=</mo><munder><mo>âˆ‘</mo><mrow><mi>j</mi><mo>âŠ•</mo><mi>k</mi><mo>=</mo><mi>i</mi></mrow></munder><msub><mi>A</mi><mi>j</mi></msub><mo>Ã—</mo><msub><mi>B</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">C_i=\\sum_{j\\oplus k = i}A_j \\times B_k\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4882em;vertical-align:-1.4382em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.05em;\"><span style=\"top:-1.8479em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mbin mtight\">âŠ•</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mrel mtight\">=</span><span class=\"mord mathnormal mtight\">i</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4382em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p>åˆ†åˆ«å½“ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>âŠ•</mo></mrow><annotation encoding=\"application/x-tex\">\\oplus</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">âŠ•</span></span></span></span> æ˜¯ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>o</mi><mi>r</mi><mo separator=\"true\">,</mo><mi>a</mi><mi>n</mi><mi>d</mi><mo separator=\"true\">,</mo><mi>x</mi><mi>o</mi><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">or, and, xor</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">or</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">an</span><span class=\"mord mathnormal\">d</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">or</span></span></span></span> æ—¶æ±‚å‡º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi></mrow><annotation encoding=\"application/x-tex\">C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span></span></span></span>â€‹â€‹ã€‚ç§°ä½œæˆ–ã€ä¸ã€å¼‚æˆ–å·ç§¯ã€‚<strong>è¯·åŒºåˆ†ä»–ä»¬ä¸å¯¹åº”ä¹˜æ³•çš„åŒºåˆ«ã€‚</strong></p>\n<p>å·ç§¯åŸç†ï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mi>M</mi><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">FMT</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">FMT</span></span></span></span>æ˜¯å­é›†è¿ç®—ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mi>W</mi><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">FWT</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>æ˜¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>âˆ˜</mo><mi>y</mi><mo>=</mo><mi>p</mi><mi>o</mi><mi>p</mi><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mi mathvariant=\"normal\">&amp;</mi><mi>y</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">%</mi><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">x\\circ y=popcount(x\\&amp;y)\\%2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4445em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ˜</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mord\">&amp;</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mord\">%2</span></span></span></span>â€‹</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mi>M</mi><msub><mi>T</mi><mrow><mi>a</mi><mi>n</mi><mi>d</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>A</mi><msub><mo stretchy=\"false\">)</mo><mi>i</mi></msub><mo>=</mo><msub><mo>âˆ‘</mo><mrow><mi>i</mi><mi mathvariant=\"normal\">&amp;</mi><mi>j</mi><mo>=</mo><mi>i</mi></mrow></msub><msub><mi>a</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">FMT_{and}(A)_i=\\sum_{i\\&amp;j=i}a_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">FM</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">an</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1858em;vertical-align:-0.4358em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1864em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mtight\">&amp;</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">=</span><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span></p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mi>M</mi><msub><mi>T</mi><mrow><mi>o</mi><mi>r</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>A</mi><msub><mo stretchy=\"false\">)</mo><mi>i</mi></msub><mo>=</mo><msub><mo>âˆ‘</mo><mrow><mi>i</mi><mi mathvariant=\"normal\">âˆ£</mi><mi>j</mi><mo>=</mo><mi>i</mi></mrow></msub><msub><mi>a</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">FMT_{or}(A)_i=\\sum_{i|j=i}a_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">FM</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">or</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2247em;vertical-align:-0.4747em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2253em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mtight\">âˆ£</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">=</span><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4747em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span></p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mi>M</mi><msub><mi>T</mi><mrow><mi>x</mi><mi>o</mi><mi>r</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>A</mi><msub><mo stretchy=\"false\">)</mo><mi>i</mi></msub><mo>=</mo><msub><mo>âˆ‘</mo><mrow><mi>i</mi><mo>âˆ˜</mo><mi>j</mi><mo>=</mo><mn>0</mn></mrow></msub><msub><mi>a</mi><mi>j</mi></msub><mo>âˆ’</mo><msub><mo>âˆ‘</mo><mrow><mi>i</mi><mo>âˆ˜</mo><mi>j</mi><mo>=</mo><mn>1</mn></mrow></msub><msub><mi>a</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">FMT_{xor}(A)_i=\\sum_{i\\circ j=0}a_j-\\sum_{i\\circ j=1}a_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">FM</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">or</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1858em;vertical-align:-0.4358em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">âˆ˜</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">0</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1858em;vertical-align:-0.4358em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">âˆ˜</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span></p>\n<p>æ³¨æ„ï¼Œé’ˆå¯¹å¼‚æˆ–çš„å¿«é€Ÿæ²ƒå°”ä»€å˜æ¢æ˜¯çº¿æ€§å˜æ¢çš„ï¼Œå³<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mi>W</mi><mi>T</mi><mo stretchy=\"false\">(</mo><mi>c</mi><mo>â‹…</mo><mi>A</mi><mo>+</mo><mi>B</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>c</mi><mo>â‹…</mo><mi>F</mi><mi>W</mi><mi>T</mi><mo stretchy=\"false\">(</mo><mi>A</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>F</mi><mi>W</mi><mi>T</mi><mo stretchy=\"false\">(</mo><mi>B</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">FWT(c\\cdot A+B)=c\\cdot FWT(A)+FWT(B)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4445em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mclose\">)</span></span></span></span>â€‹</p>\n<p>å¯¹æ•°ç»„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>x</mi><mn>0</mn></msup></mrow><annotation encoding=\"application/x-tex\">F(x)=x^0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span></span></span></span></span></span></span></span>ï¼ˆå³åªæœ‰<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo stretchy=\"false\">[</mo><mn>0</mn><mo stretchy=\"false\">]</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">a[0]=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>ï¼Œå…¶ä½™ä½ç½®å…¨ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>ï¼‰çš„å¿«é€Ÿ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mi>W</mi><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">FWT</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>åæ‰€å¾—åºåˆ—å…¨ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>ã€‚</p>\n<p>å¯¹æ•°ç»„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>x</mi><mi>t</mi></msup></mrow><annotation encoding=\"application/x-tex\">F(x)=x^t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7936em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7936em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span></span></span></span></span></span></span>ï¼ˆå³åªæœ‰<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo stretchy=\"false\">[</mo><mi>t</mi><mo stretchy=\"false\">]</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">a[t]=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>ï¼Œå…¶ä½™ä½ç½®å…¨ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>ï¼‰çš„å¿«é€Ÿ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mi>W</mi><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">FWT</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>åæ‰€å¾—åºåˆ—å…¨ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>æˆ–è€…<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">âˆ’</span><span class=\"mord\">1</span></span></span></span>ï¼ˆæ˜¾ç„¶ï¼‰</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">std::vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">fwt_and</span><span class=\"params\">(vector&lt;<span class=\"type\">int</span>&gt; a)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n = a.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt; n; i &lt;&lt;= <span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt; n; j += i &lt;&lt; <span class=\"number\">1</span>)</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> k = <span class=\"number\">0</span>; k &lt; i; k++)</span><br><span class=\"line\">                a[j + k] = (<span class=\"number\">1ll</span> * a[j + k] + a[i + j + k]) % mod;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> a;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">std::vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">ifwt_and</span><span class=\"params\">(vector&lt;<span class=\"type\">int</span>&gt; a)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n = a.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt; n; i &lt;&lt;= <span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt; n; j += i &lt;&lt; <span class=\"number\">1</span>)</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> k = <span class=\"number\">0</span>; k &lt; i; k++)</span><br><span class=\"line\">                a[j + k] = (<span class=\"number\">1ll</span> * a[j + k] - a[i + j + k] + mod) % mod;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> a;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">std::vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">fwt_or</span><span class=\"params\">(vector&lt;<span class=\"type\">int</span>&gt; a)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n = a.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt; n; i &lt;&lt;= <span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt; n; j += i &lt;&lt; <span class=\"number\">1</span>)</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> k = <span class=\"number\">0</span>; k &lt; i; k++)</span><br><span class=\"line\">                a[i + j + k] = (<span class=\"number\">1ll</span> * a[j + k] + a[i + j + k]) % mod;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> a;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">std::vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">ifwt_or</span><span class=\"params\">(vector&lt;<span class=\"type\">int</span>&gt; a)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n = a.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt; n; i &lt;&lt;= <span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt; n; j += i &lt;&lt; <span class=\"number\">1</span>)</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> k = <span class=\"number\">0</span>; k &lt; i; k++)</span><br><span class=\"line\">                a[i + j + k] = (<span class=\"number\">1ll</span> * a[i + j + k] - a[j + k] + mod) % mod;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> a;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">std::vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">fwt_xor</span><span class=\"params\">(vector&lt;<span class=\"type\">int</span>&gt; a)</span> <span class=\"comment\">// å¼‚æˆ–</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n = a.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt; n; i &lt;&lt;= <span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt; n; j += i &lt;&lt; <span class=\"number\">1</span>)</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> k = <span class=\"number\">0</span>; k &lt; i; k++)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"type\">int</span> x = a[j + k], y = a[i + j + k];</span><br><span class=\"line\">                a[j + k] = (<span class=\"number\">1ll</span> * x + y) % mod;</span><br><span class=\"line\">                a[i + j + k] = (<span class=\"number\">1ll</span> * x - y + mod) % mod;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> a;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">std::vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">ifwt_xor</span><span class=\"params\">(vector&lt;<span class=\"type\">int</span>&gt; a)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> inv_2 = <span class=\"number\">499122177</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> n = a.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt; n; i &lt;&lt;= <span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt; n; j += i &lt;&lt; <span class=\"number\">1</span>)</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> k = <span class=\"number\">0</span>; k &lt; i; k++)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"type\">int</span> x = a[j + k], y = a[i + j + k];</span><br><span class=\"line\">                a[j + k] = (<span class=\"number\">1ll</span> * x + y) * inv_2 % mod;</span><br><span class=\"line\">                a[i + j + k] = (<span class=\"number\">1ll</span> * x - y + mod) % mod * inv_2 % mod;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> a;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">std::vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">fwt_not</span><span class=\"params\">(std::vector&lt;<span class=\"type\">int</span>&gt; a)</span> <span class=\"comment\">// åŒæˆ–</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n = a.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt; n; i &lt;&lt;= <span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt; n; j += i &lt;&lt; <span class=\"number\">1</span>)</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> k = <span class=\"number\">0</span>; k &lt; i; k++)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"type\">int</span> x = a[j + k], y = a[i + j + k];</span><br><span class=\"line\">                a[i + j + k] = (<span class=\"number\">1ll</span> * x + y) % mod;</span><br><span class=\"line\">                a[j + k] = (<span class=\"number\">1ll</span> * x - y + mod) % mod;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> a;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">std::vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">ifwt_not</span><span class=\"params\">(std::vector&lt;<span class=\"type\">int</span>&gt; a)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> inv_2 = <span class=\"number\">499122177</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> n = a.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt; n; i &lt;&lt;= <span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt; n; j += i &lt;&lt; <span class=\"number\">1</span>)</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> k = <span class=\"number\">0</span>; k &lt; i; k++)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"type\">int</span> x = a[j + k], y = a[i + j + k];</span><br><span class=\"line\">                a[i + j + k] = (<span class=\"number\">1ll</span> * x + y) * inv_2 % mod;</span><br><span class=\"line\">                a[j + k] = (<span class=\"number\">1ll</span> * x - y + mod) % mod * inv_2 % mod;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> a;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">std::vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">FWT</span><span class=\"params\">(std::vector&lt;<span class=\"type\">int</span>&gt; a, std::vector&lt;<span class=\"type\">int</span>&gt; b, vector&lt;<span class=\"type\">int</span>&gt; (*f)(vector&lt;<span class=\"type\">int</span>&gt;), vector&lt;<span class=\"type\">int</span>&gt; (*g)(vector&lt;<span class=\"type\">int</span>&gt;))</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n = a.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">    <span class=\"built_in\">assert</span>((n &amp; (n - <span class=\"number\">1</span>)) == <span class=\"number\">0</span>); <span class=\"comment\">// næ˜¯2çš„å¹‚</span></span><br><span class=\"line\">    a = <span class=\"built_in\">f</span>(a);</span><br><span class=\"line\">    b = <span class=\"built_in\">f</span>(b);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++)</span><br><span class=\"line\">        a[i] = <span class=\"number\">1ll</span> * a[i] * b[i] % mod;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">g</span>(a);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"3-4-åˆ†æ²»NTTï¼ˆNTT-CQDï¼‰\">3.4 åˆ†æ²»NTTï¼ˆNTT+CQDï¼‰</h4>\n<p>ç»™å®šåºåˆ— <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>g</mi><mrow><mn>1</mn><mo>â€¦</mo><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">g_{1\\dots n - 1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"minner mtight\">â€¦</span><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>ï¼Œæ±‚åºåˆ— <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mrow><mn>0</mn><mo>â€¦</mo><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">f_{0\\dots n - 1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9028em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">0</span><span class=\"minner mtight\">â€¦</span><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>ã€‚</p>\n<p>å…¶ä¸­ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub><mo>=</mo><msubsup><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>i</mi></msubsup><msub><mi>f</mi><mrow><mi>i</mi><mo>âˆ’</mo><mi>j</mi></mrow></msub><msub><mi>g</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">f_i=\\sum_{j=1}^if_{i-j}g_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.4004em;vertical-align:-0.4358em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9646em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>ï¼Œè¾¹ç•Œä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mn>0</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">f_0=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>ã€‚</p>\n<p>ç­”æ¡ˆå¯¹ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>998244353</mn></mrow><annotation encoding=\"application/x-tex\">998244353</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">998244353</span></span></span></span> å–æ¨¡ã€‚</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn><mo>â‰¤</mo><mi>n</mi><mo>â‰¤</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding=\"application/x-tex\">2\\leq n\\leq 10^5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span></span></span></span></span></span></span></span>ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mo>â‰¤</mo><msub><mi>g</mi><mi>i</mi></msub><mo>&lt;</mo><mn>998244353</mn></mrow><annotation encoding=\"application/x-tex\">0\\leq g_i&lt;998244353</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">998244353</span></span></span></span>â€‹ã€‚</p>\n<p>åˆ©ç”¨CDQåˆ†æ²»çš„æ€æƒ³ï¼Œå…ˆè§£å†³å·¦åŠéƒ¨åˆ†ï¼Œå†è§£å†³å·¦åŠéƒ¨åˆ†å¯¹å³åŠéƒ¨åˆ†çš„è´¡çŒ®ã€‚</p>\n<p>è®¾å½“å‰è®¡ç®—åŒºé—´ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[l,r]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">]</span></span></span></span>ï¼Œæ­¤æ—¶å…ˆ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi><mi>D</mi><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">CDQ</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal\">Q</span></span></span></span>å·²ç»è®¡ç®—å‡ºäº†<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mo>â€¦</mo><mo separator=\"true\">,</mo><mi>m</mi><mi>i</mi><mi>d</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">f[l,\\ldots,mid]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">â€¦</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">mi</span><span class=\"mord mathnormal\">d</span><span class=\"mclose\">]</span></span></span></span>ï¼Œè€ƒè™‘å…¶å¯¹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">[</mo><mi>m</mi><mi>i</mi><mi>d</mi><mo>+</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>â€¦</mo><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">f[mid+1,\\ldots,r]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">mi</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">â€¦</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">]</span></span></span></span>çš„è´¡çŒ®ã€‚</p>\n<p>å¯¹äº<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>k</mi></msub><mo stretchy=\"false\">(</mo><mi>k</mi><mo>â‰¥</mo><mi>m</mi><mi>i</mi><mi>d</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f_k(k\\ge mid+1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">mi</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>è€Œè¨€ï¼Œå‰åŠéƒ¨åˆ†æ‰€é€ æˆçš„è´¡çŒ®ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mo>âˆ‘</mo><mrow><mi>i</mi><mo>+</mo><mi>j</mi><mo>=</mo><mi>k</mi><mo separator=\"true\">,</mo><mi>i</mi><mo>â‰¤</mo><mi>m</mi><mi>i</mi><mi>d</mi></mrow></msub><msub><mi>f</mi><mi>i</mi></msub><msub><mi>g</mi><mrow><mi>k</mi><mo>âˆ’</mo><mi>i</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\sum_{i+j=k,i\\le mid}f_ig_{k-i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1858em;vertical-align:-0.4358em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1864em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">=</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">â‰¤</span><span class=\"mord mathnormal mtight\">mi</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span></p>\n<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œéœ€è¦å°†<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>m</mi><mi>i</mi><mi>d</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">f[l,mid]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">mi</span><span class=\"mord mathnormal\">d</span><span class=\"mclose\">]</span></span></span></span>å’Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><mi>r</mi><mo>âˆ’</mo><mi>l</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">g(0,r-l)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mclose\">)</span></span></span></span>å·ç§¯å·èµ·æ¥ï¼Œå¯¹ååŠéƒ¨åˆ†è¿›è¡Œè´¡çŒ®ã€‚</p>\n<p>æ‰€ä»¥ç®—å‡ºå‰åŠéƒ¨åˆ†åï¼Œå°†<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mo>â€¦</mo><mo separator=\"true\">,</mo><mi>m</mi><mi>i</mi><mi>d</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">f[l,\\ldots,mid]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">â€¦</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">mi</span><span class=\"mord mathnormal\">d</span><span class=\"mclose\">]</span></span></span></span>ææˆä¸€ä¸ªå¤šé¡¹å¼ï¼Œå·ç§¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mi>T</mi><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">NTT</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">NTT</span></span></span></span>â€‹è®¡ç®—è´¡çŒ®ï¼ŒåŠ åœ¨åé¢ï¼Œç„¶åé€’å½’ååŠéƒ¨åˆ†ã€‚</p>\n<p>å¤æ‚åº¦<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><msup><mi>g</mi><mn>2</mn></msup><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(nlog^2n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span></p>\n<p>ï¼ˆæœ¬ä¾‹é¢˜ä¹Ÿå¯åˆ©ç”¨ç”Ÿæˆå‡½æ•°æ“çºµåºåˆ—ï¼Œå¤šé¡¹å¼æ±‚é€†è§£å†³ï¼Œå¤æ‚åº¦<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(nlogn)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span> ï¼‰</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">using</span> i64 = <span class=\"type\">long</span> <span class=\"type\">long</span>;</span><br><span class=\"line\"><span class=\"type\">const</span> i64 mod = <span class=\"number\">998244353</span>;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> endl <span class=\"string\">&#x27;\\n&#x27;</span></span></span><br><span class=\"line\"><span class=\"keyword\">constexpr</span> <span class=\"type\">int</span> P = <span class=\"number\">998244353</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">power</span><span class=\"params\">(<span class=\"type\">int</span> a, <span class=\"type\">int</span> b)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> res = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (; b; b /= <span class=\"number\">2</span>, a = <span class=\"number\">1LL</span> * a * a % P)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (b % <span class=\"number\">2</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            res = <span class=\"number\">1LL</span> * res * a % P;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">std::vector&lt;<span class=\"type\">int</span>&gt; rev, roots&#123;<span class=\"number\">0</span>, <span class=\"number\">1</span>&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">dft</span><span class=\"params\">(std::vector&lt;<span class=\"type\">int</span>&gt; &amp;a)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">   <span class=\"comment\">//è§NTT</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">idft</span><span class=\"params\">(std::vector&lt;<span class=\"type\">int</span>&gt; &amp;a)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//è§NTT</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">std::vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">mul</span><span class=\"params\">(std::vector&lt;<span class=\"type\">int</span>&gt; a, std::vector&lt;<span class=\"type\">int</span>&gt; b)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">   <span class=\"comment\">//è§NTT</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt; f, g;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">cdq</span><span class=\"params\">(<span class=\"type\">int</span> l, <span class=\"type\">int</span> r)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l == r)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!l)</span><br><span class=\"line\">            f[l] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (l + r) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">cdq</span>(l, mid);</span><br><span class=\"line\">    <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">a</span><span class=\"params\">(mid - l + <span class=\"number\">1</span>)</span>, <span class=\"title\">b</span><span class=\"params\">(r - l + <span class=\"number\">1</span>)</span></span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = l; i &lt;= mid; i++)</span><br><span class=\"line\">        a[i - l] = f[i];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt;= r - l; i++)</span><br><span class=\"line\">        b[i] = g[i];</span><br><span class=\"line\">    a = <span class=\"built_in\">mul</span>(a, b);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = mid + <span class=\"number\">1</span>; i &lt;= r; i++)</span><br><span class=\"line\">        f[i] = (f[i] + a[i - l]) % P;</span><br><span class=\"line\">    <span class=\"built_in\">cdq</span>(mid + <span class=\"number\">1</span>, r);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">solve</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    f.<span class=\"built_in\">resize</span>(n);</span><br><span class=\"line\">    g.<span class=\"built_in\">resize</span>(n);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt; n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cin &gt;&gt; g[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    g[<span class=\"number\">0</span>] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"built_in\">cdq</span>(<span class=\"number\">0</span>, n - <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cout &lt;&lt; f[i] &lt;&lt; <span class=\"string\">&quot; &quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"type\">int</span> t = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"comment\">// cin &gt;&gt; t;</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> (t--)</span><br><span class=\"line\">        <span class=\"built_in\">solve</span>();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"3-5-Poly-h-with-NTT-Modint-h\">3.5 Poly.h, with NTT&amp;Modint.h</h4>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**   å¤šé¡¹å¼ç›¸å…³ï¼ˆPoly, with. MInt &amp; MLongï¼‰</span></span><br><span class=\"line\"><span class=\"comment\"> *    2023-09-20: https://atcoder.jp/contests/arc163/submissions/45737810</span></span><br><span class=\"line\"><span class=\"comment\"> *    2024-07-28: https://codeforces.com/contest/1991/submission/273204889</span></span><br><span class=\"line\"><span class=\"comment\"> **/</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">ifndef</span> __POLYS_H__</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> __POLYS_H__</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;icpc-model/Modint.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> Modint;</span><br><span class=\"line\"><span class=\"keyword\">constexpr</span> <span class=\"type\">int</span> P = <span class=\"number\">998244353</span>;</span><br><span class=\"line\"><span class=\"keyword\">using</span> Z = MInt&lt;P&gt;;</span><br><span class=\"line\"><span class=\"keyword\">using</span> i64 = <span class=\"type\">long</span> <span class=\"type\">long</span>;</span><br><span class=\"line\">std::vector&lt;<span class=\"type\">int</span>&gt; rev;</span><br><span class=\"line\"><span class=\"keyword\">template</span> &lt;<span class=\"type\">int</span> P&gt;</span><br><span class=\"line\">std::vector&lt;MInt&lt;P&gt;&gt; roots&#123;<span class=\"number\">0</span>, <span class=\"number\">1</span>&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">template</span> &lt;<span class=\"type\">int</span> P&gt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">constexpr</span> MInt&lt;P&gt; <span class=\"title\">findPrimitiveRoot</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    MInt&lt;P&gt; i = <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> k = __builtin_ctz(P - <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"built_in\">power</span>(i, (P - <span class=\"number\">1</span>) / <span class=\"number\">2</span>) != <span class=\"number\">1</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        i += <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">power</span>(i, (P - <span class=\"number\">1</span>) &gt;&gt; k);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">template</span> &lt;<span class=\"type\">int</span> P&gt;</span><br><span class=\"line\"><span class=\"keyword\">constexpr</span> MInt&lt;P&gt; primitiveRoot = <span class=\"built_in\">findPrimitiveRoot</span>&lt;P&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">template</span> &lt;&gt;</span><br><span class=\"line\"><span class=\"keyword\">constexpr</span> MInt&lt;<span class=\"number\">998244353</span>&gt; primitiveRoot&lt;<span class=\"number\">998244353</span>&gt;&#123;<span class=\"number\">31</span>&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">template</span> &lt;<span class=\"type\">int</span> P&gt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">constexpr</span> <span class=\"type\">void</span> <span class=\"title\">dft</span><span class=\"params\">(std::vector&lt;MInt&lt;P&gt;&gt; &amp;a)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n = a.<span class=\"built_in\">size</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">int</span>(rev.<span class=\"built_in\">size</span>()) != n)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> k = __builtin_ctz(n) - <span class=\"number\">1</span>;</span><br><span class=\"line\">        rev.<span class=\"built_in\">resize</span>(n);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            rev[i] = rev[i &gt;&gt; <span class=\"number\">1</span>] &gt;&gt; <span class=\"number\">1</span> | (i &amp; <span class=\"number\">1</span>) &lt;&lt; k;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (rev[i] &lt; i)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            std::<span class=\"built_in\">swap</span>(a[i], a[rev[i]]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (roots&lt;P&gt;.<span class=\"built_in\">size</span>() &lt; n)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> k = __builtin_ctz(roots&lt;P&gt;.<span class=\"built_in\">size</span>());</span><br><span class=\"line\">        roots&lt;P&gt;.<span class=\"built_in\">resize</span>(n);</span><br><span class=\"line\">        <span class=\"keyword\">while</span> ((<span class=\"number\">1</span> &lt;&lt; k) &lt; n)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">auto</span> e = <span class=\"built_in\">power</span>(primitiveRoot&lt;P&gt;, <span class=\"number\">1</span> &lt;&lt; (__builtin_ctz(P - <span class=\"number\">1</span>) - k - <span class=\"number\">1</span>));</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span> &lt;&lt; (k - <span class=\"number\">1</span>); i &lt; (<span class=\"number\">1</span> &lt;&lt; k); i++)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                roots&lt;P&gt;[<span class=\"number\">2</span> * i] = roots&lt;P&gt;[i];</span><br><span class=\"line\">                roots&lt;P&gt;[<span class=\"number\">2</span> * i + <span class=\"number\">1</span>] = roots&lt;P&gt;[i] * e;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            k++;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> k = <span class=\"number\">1</span>; k &lt; n; k *= <span class=\"number\">2</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i += <span class=\"number\">2</span> * k)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt; k; j++)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                MInt&lt;P&gt; u = a[i + j];</span><br><span class=\"line\">                MInt&lt;P&gt; v = a[i + j + k] * roots&lt;P&gt;[k + j];</span><br><span class=\"line\">                a[i + j] = u + v;</span><br><span class=\"line\">                a[i + j + k] = u - v;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">template</span> &lt;<span class=\"type\">int</span> P&gt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">constexpr</span> <span class=\"type\">void</span> <span class=\"title\">idft</span><span class=\"params\">(std::vector&lt;MInt&lt;P&gt;&gt; &amp;a)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n = a.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">    std::<span class=\"built_in\">reverse</span>(a.<span class=\"built_in\">begin</span>() + <span class=\"number\">1</span>, a.<span class=\"built_in\">end</span>());</span><br><span class=\"line\">    <span class=\"built_in\">dft</span>(a);</span><br><span class=\"line\">    MInt&lt;P&gt; inv = (<span class=\"number\">1</span> - P) / n;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        a[i] *= inv;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">template</span> &lt;<span class=\"type\">int</span> P = <span class=\"number\">998244353</span>&gt;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> Poly : <span class=\"keyword\">public</span> std::vector&lt;MInt&lt;P&gt;&gt;</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">using</span> Value = MInt&lt;P&gt;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">Poly</span>() : std::<span class=\"built_in\">vector</span>&lt;Value&gt;() &#123;&#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">explicit</span> <span class=\"keyword\">constexpr</span> <span class=\"title\">Poly</span><span class=\"params\">(<span class=\"type\">int</span> n)</span> : std::vector&lt;Value&gt;(n) &#123;</span>&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">explicit</span> <span class=\"keyword\">constexpr</span> <span class=\"title\">Poly</span><span class=\"params\">(<span class=\"type\">const</span> std::vector&lt;Value&gt; &amp;a)</span> : std::vector&lt;Value&gt;(a) &#123;</span>&#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">constexpr</span> <span class=\"title\">Poly</span><span class=\"params\">(<span class=\"type\">const</span> std::initializer_list&lt;Value&gt; &amp;a)</span> : std::vector&lt;Value&gt;(a) &#123;</span>&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">template</span> &lt;<span class=\"keyword\">class</span> <span class=\"title class_\">InputIt</span>, <span class=\"keyword\">class</span> = std::_RequireInputIter&lt;InputIt&gt;&gt;</span><br><span class=\"line\">    <span class=\"keyword\">explicit</span> <span class=\"keyword\">constexpr</span> <span class=\"built_in\">Poly</span>(InputIt first, InputIt last) : std::<span class=\"built_in\">vector</span>&lt;Value&gt;(first, last) &#123;&#125;</span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">    @brief é€šè¿‡å‡½æ•°ç”Ÿæˆå¤šé¡¹å¼</span></span><br><span class=\"line\"><span class=\"comment\">    @param n ç”Ÿæˆçš„å¤šé¡¹å¼çš„é•¿åº¦</span></span><br><span class=\"line\"><span class=\"comment\">    @param f ç”Ÿæˆå¤šé¡¹å¼çš„å‡½æ•°</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    <span class=\"keyword\">template</span> &lt;<span class=\"keyword\">class</span> F&gt;</span><br><span class=\"line\">    <span class=\"keyword\">explicit</span> <span class=\"keyword\">constexpr</span> <span class=\"built_in\">Poly</span>(<span class=\"type\">int</span> n, F f) : std::<span class=\"built_in\">vector</span>&lt;Value&gt;(n)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            (*<span class=\"keyword\">this</span>)[i] = <span class=\"built_in\">f</span>(i);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">    @brief å¤šé¡¹å¼ä½ç§»</span></span><br><span class=\"line\"><span class=\"comment\">    @param k ä½ç§»çš„è·ç¦»ï¼Œæ­£æ•°è¡¨ç¤ºå„é¡¹ä¹˜ä»¥ x^kï¼Œè´Ÿæ•°è¡¨ç¤ºå„é¡¹é™¤ä»¥ x^k</span></span><br><span class=\"line\"><span class=\"comment\">    @return ä½ç§»åçš„å¤šé¡¹å¼</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">constexpr</span> Poly <span class=\"title\">shift</span><span class=\"params\">(<span class=\"type\">int</span> k)</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (k &gt;= <span class=\"number\">0</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">auto</span> b = *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">            b.<span class=\"built_in\">insert</span>(b.<span class=\"built_in\">begin</span>(), k, <span class=\"number\">0</span>);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> b;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>-&gt;<span class=\"built_in\">size</span>() &lt;= -k)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">Poly</span>();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">Poly</span>(<span class=\"keyword\">this</span>-&gt;<span class=\"built_in\">begin</span>() + (-k), <span class=\"keyword\">this</span>-&gt;<span class=\"built_in\">end</span>());</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// å¤šé¡¹å¼é‡å¡‘ï¼Œå°†å¤šé¡¹å¼çš„é•¿åº¦è°ƒæ•´ä¸º k</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">constexpr</span> Poly <span class=\"title\">trunc</span><span class=\"params\">(<span class=\"type\">int</span> k)</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        Poly f = *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">        f.<span class=\"built_in\">resize</span>(k);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> f;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// å¤šé¡¹å¼åŠ æ³•</span></span><br><span class=\"line\">    <span class=\"keyword\">constexpr</span> <span class=\"keyword\">friend</span> Poly <span class=\"keyword\">operator</span>+(<span class=\"type\">const</span> Poly &amp;a, <span class=\"type\">const</span> Poly &amp;b)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"function\">Poly <span class=\"title\">res</span><span class=\"params\">(std::max(a.size(), b.size()))</span></span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; a.<span class=\"built_in\">size</span>(); i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            res[i] += a[i];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; b.<span class=\"built_in\">size</span>(); i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            res[i] += b[i];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// å¤šé¡¹å¼å‡æ³•</span></span><br><span class=\"line\">    <span class=\"keyword\">constexpr</span> <span class=\"keyword\">friend</span> Poly <span class=\"keyword\">operator</span>-(<span class=\"type\">const</span> Poly &amp;a, <span class=\"type\">const</span> Poly &amp;b)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"function\">Poly <span class=\"title\">res</span><span class=\"params\">(std::max(a.size(), b.size()))</span></span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; a.<span class=\"built_in\">size</span>(); i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            res[i] += a[i];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; b.<span class=\"built_in\">size</span>(); i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            res[i] -= b[i];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// å¤šé¡¹å¼å–è´Ÿ</span></span><br><span class=\"line\">    <span class=\"keyword\">constexpr</span> <span class=\"keyword\">friend</span> Poly <span class=\"keyword\">operator</span>-(<span class=\"type\">const</span> Poly &amp;a)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"function\">std::vector&lt;Value&gt; <span class=\"title\">res</span><span class=\"params\">(a.size())</span></span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"built_in\">int</span>(res.<span class=\"built_in\">size</span>()); i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            res[i] = -a[i];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">Poly</span>(res);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// å¤šé¡¹å¼ä¹˜æ³•ï¼ŒNTTå¿«é€Ÿæ•°è®ºå˜æ¢</span></span><br><span class=\"line\">    <span class=\"keyword\">constexpr</span> <span class=\"keyword\">friend</span> Poly <span class=\"keyword\">operator</span>*(Poly a, Poly b)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (a.<span class=\"built_in\">size</span>() == <span class=\"number\">0</span> || b.<span class=\"built_in\">size</span>() == <span class=\"number\">0</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">Poly</span>();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (a.<span class=\"built_in\">size</span>() &lt; b.<span class=\"built_in\">size</span>())</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            std::<span class=\"built_in\">swap</span>(a, b);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">int</span> n = <span class=\"number\">1</span>, tot = a.<span class=\"built_in\">size</span>() + b.<span class=\"built_in\">size</span>() - <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (n &lt; tot)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            n *= <span class=\"number\">2</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (((P - <span class=\"number\">1</span>) &amp; (n - <span class=\"number\">1</span>)) != <span class=\"number\">0</span> || b.<span class=\"built_in\">size</span>() &lt; <span class=\"number\">128</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"function\">Poly <span class=\"title\">c</span><span class=\"params\">(a.size() + b.size() - <span class=\"number\">1</span>)</span></span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; a.<span class=\"built_in\">size</span>(); i++)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt; b.<span class=\"built_in\">size</span>(); j++)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    c[i + j] += a[i] * b[j];</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> c;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        a.<span class=\"built_in\">resize</span>(n);</span><br><span class=\"line\">        b.<span class=\"built_in\">resize</span>(n);</span><br><span class=\"line\">        <span class=\"built_in\">dft</span>(a);</span><br><span class=\"line\">        <span class=\"built_in\">dft</span>(b);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; ++i)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            a[i] *= b[i];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">idft</span>(a);</span><br><span class=\"line\">        a.<span class=\"built_in\">resize</span>(tot);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> a;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">constexpr</span> <span class=\"keyword\">friend</span> Poly <span class=\"keyword\">operator</span>*(Value a, Poly b)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"built_in\">int</span>(b.<span class=\"built_in\">size</span>()); i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            b[i] *= a;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> b;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">constexpr</span> <span class=\"keyword\">friend</span> Poly <span class=\"keyword\">operator</span>*(Poly a, Value b)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"built_in\">int</span>(a.<span class=\"built_in\">size</span>()); i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            a[i] *= b;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> a;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">constexpr</span> <span class=\"keyword\">friend</span> Poly <span class=\"keyword\">operator</span>/(Poly a, Value b)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"built_in\">int</span>(a.<span class=\"built_in\">size</span>()); i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            a[i] /= b;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> a;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">constexpr</span> Poly &amp;<span class=\"keyword\">operator</span>+=(Poly b)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">return</span> (*<span class=\"keyword\">this</span>) = (*<span class=\"keyword\">this</span>) + b;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">constexpr</span> Poly &amp;<span class=\"keyword\">operator</span>-=(Poly b)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">return</span> (*<span class=\"keyword\">this</span>) = (*<span class=\"keyword\">this</span>) - b;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">constexpr</span> Poly &amp;<span class=\"keyword\">operator</span>*=(Poly b)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">return</span> (*<span class=\"keyword\">this</span>) = (*<span class=\"keyword\">this</span>) * b;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">constexpr</span> Poly &amp;<span class=\"keyword\">operator</span>*=(Value b)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">return</span> (*<span class=\"keyword\">this</span>) = (*<span class=\"keyword\">this</span>) * b;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">constexpr</span> Poly &amp;<span class=\"keyword\">operator</span>/=(Value b)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">return</span> (*<span class=\"keyword\">this</span>) = (*<span class=\"keyword\">this</span>) / b;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// å¤šé¡¹å¼æ±‚å¯¼</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">constexpr</span> Poly <span class=\"title\">deriv</span><span class=\"params\">()</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>-&gt;<span class=\"built_in\">empty</span>())</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">Poly</span>();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"function\">Poly <span class=\"title\">res</span><span class=\"params\">(<span class=\"keyword\">this</span>-&gt;size() - <span class=\"number\">1</span>)</span></span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"keyword\">this</span>-&gt;<span class=\"built_in\">size</span>() - <span class=\"number\">1</span>; ++i)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            res[i] = (i + <span class=\"number\">1</span>) * (*<span class=\"keyword\">this</span>)[i + <span class=\"number\">1</span>];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// å¤šé¡¹å¼ç§¯åˆ†</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">constexpr</span> Poly <span class=\"title\">integr</span><span class=\"params\">()</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"function\">Poly <span class=\"title\">res</span><span class=\"params\">(<span class=\"keyword\">this</span>-&gt;size() + <span class=\"number\">1</span>)</span></span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"keyword\">this</span>-&gt;<span class=\"built_in\">size</span>(); ++i)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            res[i + <span class=\"number\">1</span>] = (*<span class=\"keyword\">this</span>)[i] / (i + <span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// å¤šé¡¹å¼æ±‚é€†ï¼Œä¸­é—´mä¸ºæ¨¡å¤šé¡¹å¼é•¿åº¦ï¼Œå³ mod x^m</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">constexpr</span> Poly <span class=\"title\">inv</span><span class=\"params\">(<span class=\"type\">int</span> m)</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        Poly x&#123;(*<span class=\"keyword\">this</span>)[<span class=\"number\">0</span>].<span class=\"built_in\">inv</span>()&#125;;</span><br><span class=\"line\">        <span class=\"type\">int</span> k = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (k &lt; m)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            k *= <span class=\"number\">2</span>;</span><br><span class=\"line\">            x = (x * (Poly&#123;<span class=\"number\">2</span>&#125; - <span class=\"built_in\">trunc</span>(k) * x)).<span class=\"built_in\">trunc</span>(k);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> x.<span class=\"built_in\">trunc</span>(m);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// å¤šé¡¹å¼æ±‚lnx</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">constexpr</span> Poly <span class=\"title\">log</span><span class=\"params\">(<span class=\"type\">int</span> m)</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> (<span class=\"built_in\">deriv</span>() * <span class=\"built_in\">inv</span>(m)).<span class=\"built_in\">integr</span>().<span class=\"built_in\">trunc</span>(m);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// å¤šé¡¹å¼æ±‚e^x</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">constexpr</span> Poly <span class=\"title\">exp</span><span class=\"params\">(<span class=\"type\">int</span> m)</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        Poly x&#123;<span class=\"number\">1</span>&#125;;</span><br><span class=\"line\">        <span class=\"type\">int</span> k = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (k &lt; m)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            k *= <span class=\"number\">2</span>;</span><br><span class=\"line\">            x = (x * (Poly&#123;<span class=\"number\">1</span>&#125; - x.<span class=\"built_in\">log</span>(k) + <span class=\"built_in\">trunc</span>(k))).<span class=\"built_in\">trunc</span>(k);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> x.<span class=\"built_in\">trunc</span>(m);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// å¤šé¡¹å¼å¿«é€Ÿå¹‚</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">constexpr</span> Poly <span class=\"title\">pow</span><span class=\"params\">(<span class=\"type\">int</span> k, <span class=\"type\">int</span> m)</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> i = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (i &lt; <span class=\"keyword\">this</span>-&gt;<span class=\"built_in\">size</span>() &amp;&amp; (*<span class=\"keyword\">this</span>)[i] == <span class=\"number\">0</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            i++;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (i == <span class=\"keyword\">this</span>-&gt;<span class=\"built_in\">size</span>() || <span class=\"number\">1LL</span> * i * k &gt;= m)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">Poly</span>(m);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        Value v = (*<span class=\"keyword\">this</span>)[i];</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> f = <span class=\"built_in\">shift</span>(-i) * v.<span class=\"built_in\">inv</span>();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> (f.<span class=\"built_in\">log</span>(m - i * k) * k).<span class=\"built_in\">exp</span>(m - i * k).<span class=\"built_in\">shift</span>(i * k) * <span class=\"built_in\">power</span>(v, k);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// å¤šé¡¹å¼å¼€æ ¹</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">constexpr</span> Poly <span class=\"title\">sqrt</span><span class=\"params\">(<span class=\"type\">int</span> m)</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        Poly x&#123;<span class=\"number\">1</span>&#125;;</span><br><span class=\"line\">        <span class=\"type\">int</span> k = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (k &lt; m)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            k *= <span class=\"number\">2</span>;</span><br><span class=\"line\">            x = (x + (<span class=\"built_in\">trunc</span>(k) * x.<span class=\"built_in\">inv</span>(k)).<span class=\"built_in\">trunc</span>(k)) * CInv&lt;<span class=\"number\">2</span>, P&gt;;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> x.<span class=\"built_in\">trunc</span>(m);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// å¤šé¡¹å¼è½¬ç½®ä¹˜æ³•ï¼Œè®¡ç®—F(x)*G(1/x)çš„ç»“æœï¼ŒæŠ¹æ‰è´Ÿæ¬¡æ–¹é¡¹</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">constexpr</span> Poly <span class=\"title\">mulT</span><span class=\"params\">(Poly b)</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (b.<span class=\"built_in\">size</span>() == <span class=\"number\">0</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">Poly</span>();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">int</span> n = b.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">        std::<span class=\"built_in\">reverse</span>(b.<span class=\"built_in\">begin</span>(), b.<span class=\"built_in\">end</span>());</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ((*<span class=\"keyword\">this</span>) * b).<span class=\"built_in\">shift</span>(-(n - <span class=\"number\">1</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// å¤šé¡¹å¼å¤šç‚¹æ±‚å€¼</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">constexpr</span> std::vector&lt;Value&gt; <span class=\"title\">eval</span><span class=\"params\">(std::vector&lt;Value&gt; x)</span> <span class=\"type\">const</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>-&gt;<span class=\"built_in\">size</span>() == <span class=\"number\">0</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> std::<span class=\"built_in\">vector</span>&lt;Value&gt;(x.<span class=\"built_in\">size</span>(), <span class=\"number\">0</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">const</span> <span class=\"type\">int</span> n = std::<span class=\"built_in\">max</span>(x.<span class=\"built_in\">size</span>(), <span class=\"keyword\">this</span>-&gt;<span class=\"built_in\">size</span>());</span><br><span class=\"line\">        <span class=\"function\">std::vector&lt;Poly&gt; <span class=\"title\">q</span><span class=\"params\">(<span class=\"number\">4</span> * n)</span></span>;</span><br><span class=\"line\">        <span class=\"function\">std::vector&lt;Value&gt; <span class=\"title\">ans</span><span class=\"params\">(x.size())</span></span>;</span><br><span class=\"line\">        x.<span class=\"built_in\">resize</span>(n);</span><br><span class=\"line\">        std::function&lt;<span class=\"type\">void</span>(<span class=\"type\">int</span>, <span class=\"type\">int</span>, <span class=\"type\">int</span>)&gt; build = [&amp;](<span class=\"type\">int</span> p, <span class=\"type\">int</span> l, <span class=\"type\">int</span> r)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (r - l == <span class=\"number\">1</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                q[p] = Poly&#123;<span class=\"number\">1</span>, -x[l]&#125;;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"type\">int</span> m = (l + r) / <span class=\"number\">2</span>;</span><br><span class=\"line\">                <span class=\"built_in\">build</span>(<span class=\"number\">2</span> * p, l, m);</span><br><span class=\"line\">                <span class=\"built_in\">build</span>(<span class=\"number\">2</span> * p + <span class=\"number\">1</span>, m, r);</span><br><span class=\"line\">                q[p] = q[<span class=\"number\">2</span> * p] * q[<span class=\"number\">2</span> * p + <span class=\"number\">1</span>];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"built_in\">build</span>(<span class=\"number\">1</span>, <span class=\"number\">0</span>, n);</span><br><span class=\"line\">        std::function&lt;<span class=\"type\">void</span>(<span class=\"type\">int</span>, <span class=\"type\">int</span>, <span class=\"type\">int</span>, <span class=\"type\">const</span> Poly &amp;)&gt; work = [&amp;](<span class=\"type\">int</span> p, <span class=\"type\">int</span> l, <span class=\"type\">int</span> r, <span class=\"type\">const</span> Poly &amp;num)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (r - l == <span class=\"number\">1</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (l &lt; <span class=\"built_in\">int</span>(ans.<span class=\"built_in\">size</span>()))</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    ans[l] = num[<span class=\"number\">0</span>];</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"type\">int</span> m = (l + r) / <span class=\"number\">2</span>;</span><br><span class=\"line\">                <span class=\"built_in\">work</span>(<span class=\"number\">2</span> * p, l, m, num.<span class=\"built_in\">mulT</span>(q[<span class=\"number\">2</span> * p + <span class=\"number\">1</span>]).<span class=\"built_in\">trunc</span>(m - l));</span><br><span class=\"line\">                <span class=\"built_in\">work</span>(<span class=\"number\">2</span> * p + <span class=\"number\">1</span>, m, r, num.<span class=\"built_in\">mulT</span>(q[<span class=\"number\">2</span> * p]).<span class=\"built_in\">trunc</span>(r - m));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"built_in\">work</span>(<span class=\"number\">1</span>, <span class=\"number\">0</span>, n, <span class=\"built_in\">mulT</span>(q[<span class=\"number\">1</span>].<span class=\"built_in\">inv</span>(n)));</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">template</span> &lt;<span class=\"type\">int</span> P = <span class=\"number\">998244353</span>&gt;</span><br><span class=\"line\">Poly&lt;P&gt; <span class=\"built_in\">berlekampMassey</span>(<span class=\"type\">const</span> Poly&lt;P&gt; &amp;s)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    Poly&lt;P&gt; c;</span><br><span class=\"line\">    Poly&lt;P&gt; oldC;</span><br><span class=\"line\">    <span class=\"type\">int</span> f = <span class=\"number\">-1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; s.<span class=\"built_in\">size</span>(); i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> delta = s[i];</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">1</span>; j &lt;= c.<span class=\"built_in\">size</span>(); j++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            delta -= c[j - <span class=\"number\">1</span>] * s[i - j];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (delta == <span class=\"number\">0</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (f == <span class=\"number\">-1</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            c.<span class=\"built_in\">resize</span>(i + <span class=\"number\">1</span>);</span><br><span class=\"line\">            f = i;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">auto</span> d = oldC;</span><br><span class=\"line\">            d *= <span class=\"number\">-1</span>;</span><br><span class=\"line\">            d.<span class=\"built_in\">insert</span>(d.<span class=\"built_in\">begin</span>(), <span class=\"number\">1</span>);</span><br><span class=\"line\">            MInt&lt;P&gt; df1 = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">1</span>; j &lt;= d.<span class=\"built_in\">size</span>(); j++)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                df1 += d[j - <span class=\"number\">1</span>] * s[f + <span class=\"number\">1</span> - j];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"built_in\">assert</span>(df1 != <span class=\"number\">0</span>);</span><br><span class=\"line\">            <span class=\"keyword\">auto</span> coef = delta / df1;</span><br><span class=\"line\">            d *= coef;</span><br><span class=\"line\">            <span class=\"function\">Poly&lt;P&gt; <span class=\"title\">zeros</span><span class=\"params\">(i - f - <span class=\"number\">1</span>)</span></span>;</span><br><span class=\"line\">            zeros.<span class=\"built_in\">insert</span>(zeros.<span class=\"built_in\">end</span>(), d.<span class=\"built_in\">begin</span>(), d.<span class=\"built_in\">end</span>());</span><br><span class=\"line\">            d = zeros;</span><br><span class=\"line\">            <span class=\"keyword\">auto</span> temp = c;</span><br><span class=\"line\">            c += d;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (i - temp.<span class=\"built_in\">size</span>() &gt; f - oldC.<span class=\"built_in\">size</span>())</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                oldC = temp;</span><br><span class=\"line\">                f = i;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    c *= <span class=\"number\">-1</span>;</span><br><span class=\"line\">    c.<span class=\"built_in\">insert</span>(c.<span class=\"built_in\">begin</span>(), <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> c;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">template</span> &lt;<span class=\"type\">int</span> P = <span class=\"number\">998244353</span>&gt;</span><br><span class=\"line\">MInt&lt;P&gt; <span class=\"built_in\">linearRecurrence</span>(Poly&lt;P&gt; p, Poly&lt;P&gt; q, i64 n)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> m = q.<span class=\"built_in\">size</span>() - <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (n &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> newq = q;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= m; i += <span class=\"number\">2</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            newq[i] *= <span class=\"number\">-1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> newp = p * newq;</span><br><span class=\"line\">        newq = q * newq;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; m; i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            p[i] = newp[i * <span class=\"number\">2</span> + n % <span class=\"number\">2</span>];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt;= m; i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            q[i] = newq[i * <span class=\"number\">2</span>];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        n /= <span class=\"number\">2</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> p[<span class=\"number\">0</span>] / q[<span class=\"number\">0</span>];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">Comb</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n;</span><br><span class=\"line\">    std::vector&lt;Z&gt; _fac;</span><br><span class=\"line\">    std::vector&lt;Z&gt; _invfac;</span><br><span class=\"line\">    std::vector&lt;Z&gt; _inv;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">Comb</span>() : n&#123;<span class=\"number\">0</span>&#125;, _fac&#123;<span class=\"number\">1</span>&#125;, _invfac&#123;<span class=\"number\">1</span>&#125;, _inv&#123;<span class=\"number\">0</span>&#125; &#123;&#125;</span><br><span class=\"line\">    <span class=\"built_in\">Comb</span>(<span class=\"type\">int</span> n) : <span class=\"built_in\">Comb</span>()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">init</span>(n);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">init</span><span class=\"params\">(<span class=\"type\">int</span> m)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        m = std::<span class=\"built_in\">min</span>(m, Z::<span class=\"built_in\">getMod</span>() - <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (m &lt;= n)</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        _fac.<span class=\"built_in\">resize</span>(m + <span class=\"number\">1</span>);</span><br><span class=\"line\">        _invfac.<span class=\"built_in\">resize</span>(m + <span class=\"number\">1</span>);</span><br><span class=\"line\">        _inv.<span class=\"built_in\">resize</span>(m + <span class=\"number\">1</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = n + <span class=\"number\">1</span>; i &lt;= m; i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            _fac[i] = _fac[i - <span class=\"number\">1</span>] * i;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        _invfac[m] = _fac[m].<span class=\"built_in\">inv</span>();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = m; i &gt; n; i--)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            _invfac[i - <span class=\"number\">1</span>] = _invfac[i] * i;</span><br><span class=\"line\">            _inv[i] = _invfac[i] * _fac[i - <span class=\"number\">1</span>];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        n = m;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\">Z <span class=\"title\">fac</span><span class=\"params\">(<span class=\"type\">int</span> m)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (m &gt; n)</span><br><span class=\"line\">            <span class=\"built_in\">init</span>(<span class=\"number\">2</span> * m);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> _fac[m];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">Z <span class=\"title\">invfac</span><span class=\"params\">(<span class=\"type\">int</span> m)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (m &gt; n)</span><br><span class=\"line\">            <span class=\"built_in\">init</span>(<span class=\"number\">2</span> * m);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> _invfac[m];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">Z <span class=\"title\">inv</span><span class=\"params\">(<span class=\"type\">int</span> m)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (m &gt; n)</span><br><span class=\"line\">            <span class=\"built_in\">init</span>(<span class=\"number\">2</span> * m);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> _inv[m];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">Z <span class=\"title\">binom</span><span class=\"params\">(<span class=\"type\">int</span> n, <span class=\"type\">int</span> m)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (n &lt; m || m &lt; <span class=\"number\">0</span>)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">fac</span>(n) * <span class=\"built_in\">invfac</span>(m) * <span class=\"built_in\">invfac</span>(n - m);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; comb;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">Poly&lt;P&gt; <span class=\"title\">get</span><span class=\"params\">(<span class=\"type\">int</span> n, <span class=\"type\">int</span> m)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (m == <span class=\"number\">0</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">Poly</span>(n + <span class=\"number\">1</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (m % <span class=\"number\">2</span> == <span class=\"number\">1</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> f = <span class=\"built_in\">get</span>(n, m - <span class=\"number\">1</span>);</span><br><span class=\"line\">        Z p = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt;= n; i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            f[n - i] += comb.<span class=\"built_in\">binom</span>(n, i) * p;</span><br><span class=\"line\">            p *= m;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> f;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">auto</span> f = <span class=\"built_in\">get</span>(n, m / <span class=\"number\">2</span>);</span><br><span class=\"line\">    <span class=\"keyword\">auto</span> fm = f;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        fm[i] *= comb.<span class=\"built_in\">fac</span>(i);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">Poly <span class=\"title\">pw</span><span class=\"params\">(n + <span class=\"number\">1</span>)</span></span>;</span><br><span class=\"line\">    pw[<span class=\"number\">0</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        pw[i] = pw[i - <span class=\"number\">1</span>] * (m / <span class=\"number\">2</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        pw[i] *= comb.<span class=\"built_in\">invfac</span>(i);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fm = fm.<span class=\"built_in\">mulT</span>(pw);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        fm[i] *= comb.<span class=\"built_in\">invfac</span>(i);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> f + fm;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">endif</span></span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"3-6-å¤šé¡¹å¼æ±‚é€†\">3.6 å¤šé¡¹å¼æ±‚é€†</h4>\n<p>ç»™å®šä¸€ä¸ªå¤šé¡¹å¼ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">F(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span> ï¼Œè¯·æ±‚å‡ºä¸€ä¸ªå¤šé¡¹å¼ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">G(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">G</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>ï¼Œ æ»¡è¶³ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>âˆ—</mo><mi>G</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>â‰¡</mo><mn>1</mn><mspace></mspace><mspace width=\"0.4444em\"/><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">m</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">d</mi></mrow><mspace width=\"0.3333em\"/><msup><mi>x</mi><mi>n</mi></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">F(x) * G(x) \\equiv 1 \\pmod{x^n}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">G</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¡</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span><span class=\"mspace allowbreak\"></span><span class=\"mspace\" style=\"margin-right:0.4444em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathrm\">mod</span></span></span><span class=\"mspace\" style=\"margin-right:0.3333em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>ã€‚ç³»æ•°å¯¹ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>998244353</mn></mrow><annotation encoding=\"application/x-tex\">998244353</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">998244353</span></span></span></span> å–æ¨¡ã€‚</p>\n<p>å¯¹äº <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>100</mn><mi mathvariant=\"normal\">%</mi></mrow><annotation encoding=\"application/x-tex\">100\\%</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8056em;vertical-align:-0.0556em;\"></span><span class=\"mord\">100%</span></span></span></span> çš„æ•°æ®ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>n</mi><mo>â‰¤</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding=\"application/x-tex\">1 \\leq n \\leq 10^5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span></span></span></span></span></span></span></span>ï¼Œ$ 0 \\leq a_i \\leq 10^9$â€‹ã€‚</p>\n<p>å·¥ä½œåŸç†ï¼š</p>\n<p>æˆ‘ä»¬ä¸å¦¨å‡è®¾ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><msup><mn>2</mn><mi>k</mi></msup></mrow><annotation encoding=\"application/x-tex\">n=2^k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span></span></span></span>,<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>âˆˆ</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">k\\in N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>ã€‚</p>\n<p>è‹¥<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">n=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>ï¼Œåˆ™<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>Ã—</mo><mi>B</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>â‰¡</mo><msub><mi>a</mi><mn>0</mn></msub><mo>Ã—</mo><msub><mi>b</mi><mn>0</mn></msub><mo>â‰¡</mo><mn>1</mn><mo stretchy=\"false\">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><msup><mi>x</mi><mn>1</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">A(x)Ã—B(x)â‰¡a_0Ã—b_0â‰¡1(mod\\  x^1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¡</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¡</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\">Â </span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>,å…¶ä¸­<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">a_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>b</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">b_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>è¡¨ç¤ºå¤šé¡¹å¼<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>å’Œå¤šé¡¹å¼<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span>çš„å¸¸æ•°é¡¹ã€‚</p>\n<p>è‹¥éœ€è¦æ±‚å‡º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>b</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">b_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼Œç›´æ¥ç”¨è´¹é©¬å°å®šç†æ±‚å‡º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">a_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>çš„ä¹˜æ³•é€†å…ƒå³å¯ã€‚</p>\n<p>å½“<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">n&gt;1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>æ—¶ï¼š</p>\n<p>æˆ‘ä»¬å‡è®¾åœ¨æ¨¡<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>x</mi><mfrac><mi>n</mi><mn>2</mn></mfrac></msup></mrow><annotation encoding=\"application/x-tex\">x^{\\frac{n}{2}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8471em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8471em;\"><span style=\"top:-3.363em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mopen nulldelimiter sizing reset-size3 size6\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6915em;\"><span style=\"top:-2.656em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.2255em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line mtight\" style=\"border-bottom-width:0.049em;\"></span></span><span style=\"top:-3.384em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.344em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter sizing reset-size3 size6\"></span></span></span></span></span></span></span></span></span></span></span></span></span>çš„æ„ä¹‰ä¸‹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">A(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>çš„é€†å…ƒ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>B</mi><mtext>â€²</mtext></msup><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">B^â€²(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">â€²</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>æˆ‘ä»¬å·²ç»æ±‚å¾—ã€‚</p>\n<p>ä¾æ®å®šä¹‰ï¼Œåˆ™æœ‰</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><msup><mi>B</mi><mtext>â€²</mtext></msup><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>â‰¡</mo><mn>1</mn><mo stretchy=\"false\">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><msup><mi>x</mi><mfrac><mi>n</mi><mn>2</mn></mfrac></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">A(x)B^â€²(x)â‰¡1(mod\\  x^{\\frac{n}{2}})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">â€²</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¡</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0971em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\">Â </span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8471em;\"><span style=\"top:-3.363em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mopen nulldelimiter sizing reset-size3 size6\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6915em;\"><span style=\"top:-2.656em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.2255em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line mtight\" style=\"border-bottom-width:0.049em;\"></span></span><span style=\"top:-3.384em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.344em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter sizing reset-size3 size6\"></span></span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> (1)</p>\n<p>å¯¹(1)å¼è¿›è¡Œç§»é¡¹å¾—</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><msup><mi>B</mi><mtext>â€²</mtext></msup><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>âˆ’</mo><mn>1</mn><mo>â‰¡</mo><mn>0</mn><mo stretchy=\"false\">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><msup><mi>x</mi><mfrac><mi>n</mi><mn>2</mn></mfrac></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">A(x)B^â€²(x)âˆ’1â‰¡0(mod\\ x^{\\frac{n}{2}})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">â€²</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¡</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0971em;vertical-align:-0.25em;\"></span><span class=\"mord\">0</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\">Â </span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8471em;\"><span style=\"top:-3.363em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mopen nulldelimiter sizing reset-size3 size6\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6915em;\"><span style=\"top:-2.656em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.2255em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line mtight\" style=\"border-bottom-width:0.049em;\"></span></span><span style=\"top:-3.384em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.344em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter sizing reset-size3 size6\"></span></span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> (2)</p>\n<p>ç„¶åå¯¹(2)å¼ç­‰å·ä¸¤è¾¹å¹³æ–¹ï¼Œå¾—</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>A</mi><mn>2</mn></msup><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><msup><mi>B</mi><mrow><mtext>â€²</mtext><mn>2</mn></mrow></msup><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>âˆ’</mo><mn>2</mn><mi>A</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><msup><mi>B</mi><mtext>â€²</mtext></msup><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mn>1</mn><mo>â‰¡</mo><mn>0</mn><mo stretchy=\"false\">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><msup><mi>x</mi><mi>n</mi></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">A^2(x)B^{â€²2}(x)âˆ’2A(x)B^â€²(x)+1â‰¡0(mod\\  x^n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">â€²2</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\">A</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">â€²</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¡</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">0</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\">Â </span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> (3)</p>\n<p>å°†å¸¸æ•°é¡¹ç§»åŠ¨åˆ°ç­‰å¼å³ä¾§ï¼Œå¾—</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>A</mi><mn>2</mn></msup><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><msup><mi>B</mi><mrow><mtext>â€²</mtext><mn>2</mn></mrow></msup><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>âˆ’</mo><mn>2</mn><mi>A</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><msup><mi>B</mi><mtext>â€²</mtext></msup><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>â‰¡</mo><mo>âˆ’</mo><mn>1</mn><mo stretchy=\"false\">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><msup><mi>x</mi><mi>n</mi></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">A^2(x)B^{â€²2}(x)âˆ’2A(x)B^â€²(x)â‰¡âˆ’1(mod\\  x^n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">â€²2</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\">A</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">â€²</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¡</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">âˆ’</span><span class=\"mord\">1</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\">Â </span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> (4)</p>\n<p>å°†ç­‰å¼ä¸¤è¾¹å»ç›¸åæ•°ï¼Œå¾—</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn><mi>A</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><msup><mi>B</mi><mtext>â€²</mtext></msup><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>âˆ’</mo><msup><mi>A</mi><mn>2</mn></msup><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><msup><mi>B</mi><mrow><mtext>â€²</mtext><mn>2</mn></mrow></msup><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>â‰¡</mo><mn>1</mn><mo stretchy=\"false\">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><msup><mi>x</mi><mi>n</mi></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">2A(x)B^â€²(x)âˆ’A^2(x)B^{â€²2}(x)â‰¡1(mod\\  x^n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\">A</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">â€²</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">â€²2</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¡</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\">Â </span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> (5)</p>\n<p>ä¸‹é¢è€ƒè™‘å›æˆ‘ä»¬éœ€è¦æ±‚çš„å¤šé¡¹å¼<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">B(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>ï¼Œä¾æ®å®šä¹‰ï¼Œå…¶æ»¡è¶³</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mi>B</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>â‰¡</mo><mn>1</mn><mo stretchy=\"false\">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><msup><mi>x</mi><mi>n</mi></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">A(x)B(x)â‰¡1(mod\\ x^n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¡</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\">Â </span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> (6)</p>\n<p>å°†(5)âˆ’(6)å¹¶ç§»é¡¹ï¼Œå¾—</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mi>B</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>â‰¡</mo><mn>2</mn><mi>A</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><msup><mi>B</mi><mtext>â€²</mtext></msup><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>âˆ’</mo><msup><mi>A</mi><mn>2</mn></msup><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><msup><mi>B</mi><mrow><mtext>â€²</mtext><mn>2</mn></mrow></msup><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><msup><mi>x</mi><mi>n</mi></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">A(x)B(x)â‰¡2A(x)B^â€²(x)âˆ’A^2(x)B^{â€²2}(x)(mod\\  x^n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¡</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\">A</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">â€²</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">â€²2</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\">Â </span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> (7)</p>\n<p>ç­‰å¼ä¸¤è¾¹çº¦å»<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">A(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>ï¼Œå¾—</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>â‰¡</mo><mn>2</mn><mi>B</mi><mtext>â€²</mtext><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>âˆ’</mo><mi>A</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><msup><mi>B</mi><mrow><mtext>â€²</mtext><mn>2</mn></mrow></msup><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><msup><mi>x</mi><mi>n</mi></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">B(x)â‰¡2Bâ€²(x)âˆ’A(x)B^{â€²2}(x)(mod\\  x^n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¡</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mord\">â€²</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">â€²2</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\">Â </span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> (8)</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">solve</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"function\">vector&lt;Z&gt; <span class=\"title\">a</span><span class=\"params\">(n)</span></span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> &amp;i : a)</span><br><span class=\"line\">        cin &gt;&gt; i;</span><br><span class=\"line\">    <span class=\"function\">Poly&lt;P&gt; <span class=\"title\">A</span><span class=\"params\">(a)</span></span>;</span><br><span class=\"line\">    Poly&lt;P&gt; invA = A.<span class=\"built_in\">inv</span>(n);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> &amp;i : invA)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cout &lt;&lt; i &lt;&lt; <span class=\"string\">&quot; &quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; endl;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"3-7-å¤šé¡¹å¼é™¤æ³•\">3.7 å¤šé¡¹å¼é™¤æ³•</h4>\n<p><em><strong>ä¸¥æ ¼æ³¨æ„ï¼šå¤šé¡¹å¼é™¤æ³•ä¸å¯ä»¥æ‹¿æ¥åšé«˜ç²¾åº¦é™¤æ³•ï¼å› ä¸ºå¤šé¡¹å¼é™¤æ³•åšäº†å–ä½™æ•°çš„æ“ä½œï¼ç›¸å½“äºæ‰£äº†é¡¹çš„ç³»æ•°ï¼</strong></em></p>\n<p>ç»™å®šä¸€ä¸ª <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> æ¬¡å¤šé¡¹å¼ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">F(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span> å’Œä¸€ä¸ª <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span> æ¬¡å¤šé¡¹å¼  <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">G(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">G</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span> ï¼Œè¯·æ±‚å‡ºå¤šé¡¹å¼ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">Q(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">Q</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">R(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>ï¼Œæ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">Q(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">Q</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span> æ¬¡æ•°ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>âˆ’</mo><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">n-m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">R(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span> æ¬¡æ•°å°äº <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span></li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mi>G</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>R</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">F(x) = Q(x)  G(x) + R(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">Q</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\">G</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span></li>\n</ul>\n<p>æ‰€æœ‰çš„è¿ç®—åœ¨æ¨¡ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>998244353</mn></mrow><annotation encoding=\"application/x-tex\">998244353</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">998244353</span></span></span></span> æ„ä¹‰ä¸‹è¿›è¡Œã€‚</p>\n<p>å¦‚æœ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">R(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span> ä¸è¶³ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">m-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> æ¬¡ï¼Œå¤šä½™çš„é¡¹ç³»æ•°è¡¥ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>ã€‚</p>\n<p>å¯¹äºæ‰€æœ‰æ•°æ®ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>m</mi><mo>&lt;</mo><mi>n</mi><mo>â‰¤</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding=\"application/x-tex\">1 \\le m &lt; n \\le 10^5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">5</span></span></span></span></span></span></span></span></span></span></span>ï¼Œç»™å‡ºçš„ç³»æ•°å‡å±äº <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>998244353</mn><mo stretchy=\"false\">)</mo><mo>âˆ©</mo><mi mathvariant=\"double-struck\">Z</mi></mrow><annotation encoding=\"application/x-tex\">[0, 998244353) \\cap \\mathbb{Z}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">998244353</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ©</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">Z</span></span></span></span>ã€‚</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>æ¬¡å¤šé¡¹å¼<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">A(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>çš„ç³»æ•°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi><mi>e</mi><mi>c</mi><mi>t</mi><mi>o</mi><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">vector</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\">ec</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">or</span></span></span></span>è¿›è¡Œä¸€æ¬¡<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mi>e</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>s</mi><mi>e</mi></mrow><annotation encoding=\"application/x-tex\">reverse</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">re</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\">erse</span></span></span></span>åè¡¨ç¤ºçš„æ˜¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo stretchy=\"false\">(</mo><mfrac><mn>1</mn><mi>x</mi></mfrac><mo stretchy=\"false\">)</mo><msup><mi>x</mi><mi>N</mi></msup></mrow><annotation encoding=\"application/x-tex\">A(\\frac{1}{x})x^N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span></span></span></span></span></span></span>çš„ç³»æ•°ã€‚</p>\n<p>æ•…æ±‚å¤šé¡¹å¼é™¤æ³•<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>B</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mi>C</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>D</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">A(x)=B(x)C(x)+D(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>æ—¶ï¼Œè€ƒè™‘<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>x</mi><mi>N</mi></msup><mi>A</mi><mo stretchy=\"false\">(</mo><mfrac><mn>1</mn><mi>x</mi></mfrac><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>x</mi><mi>M</mi></msup><mi>B</mi><mo stretchy=\"false\">(</mo><mfrac><mn>1</mn><mi>x</mi></mfrac><mo stretchy=\"false\">)</mo><msup><mi>x</mi><mrow><mi>N</mi><mo>âˆ’</mo><mi>M</mi></mrow></msup><mi>C</mi><mo stretchy=\"false\">(</mo><mfrac><mn>1</mn><mi>x</mi></mfrac><mo stretchy=\"false\">)</mo><mo>+</mo><mi>D</mi><mo stretchy=\"false\">(</mo><mfrac><mn>1</mn><mi>x</mi></mfrac><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x^NA(\\frac{1}{x})=x^MB(\\frac{1}{x})x^{N-M}C(\\frac{1}{x})+D(\\frac{1}{x})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\">A</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">M</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">M</span></span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">)</span></span></span></span></p>\n<p>å¤šé¡¹å¼å¯¹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>x</mi><mrow><mi>N</mi><mo>âˆ’</mo><mi>M</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">x^{N-M+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8413em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">M</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span>æ±‚æ¨¡ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">D(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>æ¶ˆå¤±ï¼Œæœ‰<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>x</mi><mrow><mi>N</mi><mo>âˆ’</mo><mi>M</mi></mrow></msup><mi>C</mi><mo stretchy=\"false\">(</mo><mfrac><mn>1</mn><mi>x</mi></mfrac><mo stretchy=\"false\">)</mo><mo>â‰¡</mo><mfrac><mrow><msup><mi>A</mi><msup><mrow></mrow><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">â€²</mo></msup></msup><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mrow><msup><mi>B</mi><msup><mrow></mrow><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">â€²</mo></msup></msup><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">x^{N-M}C(\\frac{1}{x})\\equiv \\frac{A^{&#x27;}(x)}{B^{&#x27;}(x)}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">M</span></span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¡</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.8765em;vertical-align:-0.61em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2665em;\"><span style=\"top:-2.565em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8928em;\"><span style=\"top:-2.8928em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.6068em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8496em;\"><span style=\"top:-2.8496em;margin-right:0.1em;\"><span class=\"pstrut\" style=\"height:2.5556em;\"></span><span class=\"mord mtight\"><span class=\"mord mtight\">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mclose mtight\">)</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.485em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1164em;\"><span style=\"top:-3.1164em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.6854em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9596em;\"><span style=\"top:-2.9596em;margin-right:0.1em;\"><span class=\"pstrut\" style=\"height:2.5556em;\"></span><span class=\"mord mtight\"><span class=\"mord mtight\">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.61em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">solve</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n, k;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; k;</span><br><span class=\"line\">    <span class=\"function\">vector&lt;Z&gt; <span class=\"title\">a</span><span class=\"params\">(n + <span class=\"number\">1</span>)</span>, <span class=\"title\">b</span><span class=\"params\">(k + <span class=\"number\">1</span>)</span></span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> &amp;i : a)</span><br><span class=\"line\">        cin &gt;&gt; i;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> &amp;i : b)</span><br><span class=\"line\">        cin &gt;&gt; i;</span><br><span class=\"line\">    <span class=\"function\">Poly&lt;P&gt; <span class=\"title\">A</span><span class=\"params\">(a)</span>, <span class=\"title\">B</span><span class=\"params\">(b)</span></span>;</span><br><span class=\"line\">    <span class=\"built_in\">reverse</span>(A.<span class=\"built_in\">begin</span>(), A.<span class=\"built_in\">end</span>());</span><br><span class=\"line\">    <span class=\"built_in\">reverse</span>(B.<span class=\"built_in\">begin</span>(), B.<span class=\"built_in\">end</span>());</span><br><span class=\"line\">    A.<span class=\"built_in\">resize</span>(n - k + <span class=\"number\">1</span>);</span><br><span class=\"line\">    B.<span class=\"built_in\">resize</span>(n - k + <span class=\"number\">1</span>);</span><br><span class=\"line\">    Poly&lt;P&gt; C = A * (B.<span class=\"built_in\">inv</span>(n - k + <span class=\"number\">1</span>));</span><br><span class=\"line\">    C.<span class=\"built_in\">resize</span>(n - k + <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"built_in\">reverse</span>(C.<span class=\"built_in\">begin</span>(), C.<span class=\"built_in\">end</span>());</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> &amp;i : C)</span><br><span class=\"line\">        cout &lt;&lt; i &lt;&lt; <span class=\"string\">&quot; &quot;</span>;</span><br><span class=\"line\">    cout &lt;&lt; endl;</span><br><span class=\"line\">    Poly&lt;P&gt; D = <span class=\"built_in\">Poly</span>&lt;P&gt;(a) - <span class=\"built_in\">Poly</span>&lt;P&gt;(b) * C;</span><br><span class=\"line\">    D.<span class=\"built_in\">resize</span>(k);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> &amp;i : D)</span><br><span class=\"line\">        cout &lt;&lt; i &lt;&lt; <span class=\"string\">&quot; &quot;</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"3-8-å¤šé¡¹å¼å¯¹æ•°\">3.8 å¤šé¡¹å¼å¯¹æ•°</h4>\n<p>æ±‚ä¸ªå¯¼å†ç§¯åˆ†å°±è¡Œã€‚</p>\n<p>ç»™å®šå¤šé¡¹å¼<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">A(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>ï¼Œæ±‚<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">B(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>ä½¿å¾—<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>â‰¡</mo><mi>l</mi><mi>n</mi><mi>A</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mtext>Â </mtext><mo stretchy=\"false\">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><msup><mi>x</mi><mi>n</mi></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">B(x)\\equiv lnA(x)\\ (mod\\ x^n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¡</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">A</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\">Â </span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\">Â </span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>ï¼Œä¿è¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><mn>0</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">a_0=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">solve</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"function\">vector&lt;Z&gt; <span class=\"title\">a</span><span class=\"params\">(n)</span></span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> &amp;x : a)</span><br><span class=\"line\">        cin &gt;&gt; x;</span><br><span class=\"line\">    <span class=\"function\">Poly&lt;P&gt; <span class=\"title\">p</span><span class=\"params\">(a)</span></span>;</span><br><span class=\"line\">    <span class=\"keyword\">auto</span> b = p.<span class=\"built_in\">log</span>(n);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> x : b)</span><br><span class=\"line\">        cout &lt;&lt; x &lt;&lt; <span class=\"string\">&#x27; &#x27;</span>;</span><br><span class=\"line\">    cout &lt;&lt; endl;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"3-9-å¤šé¡¹å¼è‡ªç„¶æŒ‡æ•°\">3.9 å¤šé¡¹å¼è‡ªç„¶æŒ‡æ•°</h4>\n<p>ç»™å®šå¤šé¡¹å¼<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">A(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>ï¼Œæ±‚<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">B(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>ä½¿å¾—<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>â‰¡</mo><msup><mi>e</mi><mrow><mi>A</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></msup><mtext>Â </mtext><mo stretchy=\"false\">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><msup><mi>x</mi><mi>n</mi></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">B(x)\\equiv e^{A(x)}\\ (mod\\ x^n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¡</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.138em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">A</span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\">Â </span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\">Â </span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>ï¼Œä¿è¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">a_0=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>â€‹</p>\n<p>å‡½æ•°æ±‚å¯¼ï¼Œç‰›é¡¿è¿­ä»£æ³•ã€‚</p>\n<p>å…ˆä»ç‰›é¡¿è¿­ä»£è®²èµ·ã€‚</p>\n<p>å·²çŸ¥å¤šé¡¹å¼å‡½æ•°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi><mo stretchy=\"false\">(</mo><mi>z</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">G(z)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">G</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mclose\">)</span></span></span></span>ï¼Œæ±‚å¤šé¡¹å¼å‡½æ•°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">F(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>æ»¡è¶³ $$G(F(x))\\equiv0 \\pmod{x^n}$$</p>\n<p>è€ƒè™‘ç”¨è¿­ä»£æ±‚è§£ï¼Œå‡è®¾æˆ‘ä»¬å·²ç»æ±‚å¾—<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>F</mi><mn>0</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">F_0(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>æ»¡è¶³ $$G(F_0(x))\\equiv0\\pmod{x^{\\left\\lceil\\frac{n}{2}\\right\\rceil}}$$</p>\n<p>å°†å‡½æ•°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi></mrow><annotation encoding=\"application/x-tex\">G</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span></span></span></span>åœ¨<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>z</mi><mo>=</mo><msub><mi>F</mi><mn>0</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">z=F_0(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>å¤„è¿›è¡Œæ³°å‹’å±•å¼€ $$G(F(x))=\\sum_{i=1}^{\\infty}\\frac{G^i(F_0(x))}{i!}(F(x)-F_0(x))^i$$ ,å…¶ä¸­<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>G</mi><mi>i</mi></msup></mrow><annotation encoding=\"application/x-tex\">G^i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8247em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">G</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8247em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span></span></span></span></span></span></span>ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi></mrow><annotation encoding=\"application/x-tex\">G</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span></span></span></span>çš„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>é˜¶å¯¼å‡½æ•°.</p>\n<p>å–å‰ä¸¤é¡¹ $$G(F(x))\\equiv G(F_0(x))+Gâ€™(F_0(x))(F(x)-F_0(x))\\pmod{x^n}$$</p>\n<p>è€ƒè™‘åˆ°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi><mo stretchy=\"false\">(</mo><mi>F</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo>â‰¡</mo><mn>0</mn><mspace></mspace><mspace width=\"0.4444em\"/><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">m</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">d</mi></mrow><mspace width=\"0.3333em\"/><msup><mi>x</mi><mi>n</mi></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">G(F(x))\\equiv 0\\pmod{x^n}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">G</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">))</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¡</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span><span class=\"mspace allowbreak\"></span><span class=\"mspace\" style=\"margin-right:0.4444em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathrm\">mod</span></span></span><span class=\"mspace\" style=\"margin-right:0.3333em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> $$F(x)\\equiv F_0(x)-\\frac{G(F_0(x))}{Gâ€™(F_0(x))}\\pmod{x^n}$$</p>\n<p>è¾¹ç•Œæ¡ä»¶å³<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">[</mo><mn>0</mn><mo stretchy=\"false\">]</mo><mo>=</mo><msup><mi>e</mi><msub><mi>a</mi><mn>0</mn></msub></msup></mrow><annotation encoding=\"application/x-tex\">f[0]=e^{a_0}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>ï¼Œå‘ä¸Šè¿­ä»£å³å¯.</p>\n<p>å›åˆ°æœ¬é¢˜ï¼Œè€ƒè™‘åˆ° $$B(x)\\equiv e^{A(x)}\\pmod{x^n}$$</p>\n<p>å³ $$\\ln B(x)-A(x)\\equiv0\\pmod{x^n}$$</p>\n<p>äºæ˜¯ä»¤ $$G(B(x))\\equiv\\ln B(x)-A(x)\\pmod{x^n}$$</p>\n<p>ç”±äº<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">A(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>ä¸ºå¸¸æ•°ï¼Œ $$Gâ€™(B(x))=B^{-1}(x)$$ ï¼Œå¥—ç‰›é¡¿è¿­ä»£ $$B(x)\\equiv B_0(x)(1-\\ln B_0(x)+A(x))\\pmod{x^n}$$</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">solve</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"function\">vector&lt;Z&gt; <span class=\"title\">a</span><span class=\"params\">(n)</span></span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> &amp;x : a)</span><br><span class=\"line\">        cin &gt;&gt; x;</span><br><span class=\"line\">    <span class=\"function\">Poly&lt;P&gt; <span class=\"title\">p</span><span class=\"params\">(a)</span></span>;</span><br><span class=\"line\">    <span class=\"keyword\">auto</span> b = p.<span class=\"built_in\">exp</span>(n);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> x : b)</span><br><span class=\"line\">        cout &lt;&lt; x &lt;&lt; <span class=\"string\">&#x27; &#x27;</span>;</span><br><span class=\"line\">    cout &lt;&lt; endl;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"3-10-å¤šé¡¹å¼å¤šç‚¹æ±‚å€¼\">3.10 å¤šé¡¹å¼å¤šç‚¹æ±‚å€¼</h4>\n<p>åŸç†ä¸ä¼šï¼ŒæŠ„å°±è¡Œã€‚</p>\n<p>ç»™å®šä¸€ä¸ª <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> æ¬¡å¤šé¡¹å¼ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span> ï¼Œç°åœ¨è¯·ä½ å¯¹äº <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>âˆˆ</mo><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>m</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">i \\in [1,m]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6986em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mclose\">]</span></span></span></span> ï¼Œæ±‚å‡º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(a_i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> ã€‚<em><strong>æ³¨æ„æ˜¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>æ¬¡ï¼Œæ„å‘³ç€æœ‰<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">n+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>é¡¹</strong></em>ã€‚</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo separator=\"true\">,</mo><mi>m</mi><mo>âˆˆ</mo><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>64000</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">n,m \\in [1,64000]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">64000</span><span class=\"mclose\">]</span></span></span></span>ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo separator=\"true\">,</mo><mo stretchy=\"false\">[</mo><msup><mi>x</mi><mi>i</mi></msup><mo stretchy=\"false\">]</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>âˆˆ</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>998244352</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">a_i,[x^i]f(x) \\in [0,998244352]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0747em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8247em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span></span></span></span><span class=\"mclose\">]</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">998244352</span><span class=\"mclose\">]</span></span></span></span> ã€‚</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><msup><mi>x</mi><mi>i</mi></msup><mo stretchy=\"false\">]</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">[x^i]f(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0747em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8247em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span></span></span></span><span class=\"mclose\">]</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span> è¡¨ç¤º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span> çš„ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>â€‹ æ¬¡é¡¹ç³»æ•°ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">solve</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n, m;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class=\"line\">    <span class=\"function\">Poly&lt;P&gt; <span class=\"title\">f</span><span class=\"params\">(n + <span class=\"number\">1</span>)</span></span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> &amp;v : f)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cin &gt;&gt; v;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">vector&lt;Z&gt; <span class=\"title\">x</span><span class=\"params\">(m)</span></span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> &amp;v : x)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cin &gt;&gt; v;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">auto</span> fx = f.<span class=\"built_in\">eval</span>(x);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> v : fx)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cout &lt;&lt; v &lt;&lt; endl;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"3-11-å¤šé¡¹å¼å¿«é€Ÿæ’å€¼-æ‹‰æ ¼æœ—æ—¥å¿«é€Ÿæ’å€¼\">3.11 å¤šé¡¹å¼å¿«é€Ÿæ’å€¼/æ‹‰æ ¼æœ—æ—¥å¿«é€Ÿæ’å€¼</h4>\n<p>ä»¥ä¸‹é»˜è®¤<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mi>i</mi><mi>d</mi><mo>=</mo><mo stretchy=\"false\">âŒŠ</mo><mfrac><mrow><mi>l</mi><mo>+</mo><mi>r</mi></mrow><mn>2</mn></mfrac><mo stretchy=\"false\">âŒ‹</mo></mrow><annotation encoding=\"application/x-tex\">mid=\\lfloor\\frac{l+r}{2}\\rfloor</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">mi</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2251em;vertical-align:-0.345em;\"></span><span class=\"mopen\">âŒŠ</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8801em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mbin mtight\">+</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">âŒ‹</span></span></span></span></p>\n<p>ç”±æ‹‰æ ¼æœ—æ—¥å·®å€¼å…¬å¼<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle mathsize=\"1.2em\"><mi>F</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msub><mi>y</mi><mi>i</mi></msub><msub><mo>âˆ</mo><mrow><mi>j</mi><mo mathvariant=\"normal\">â‰ </mo><mi>i</mi></mrow></msub><mfrac><mrow><mi>x</mi><mo>âˆ’</mo><msub><mi>x</mi><mi>j</mi></msub></mrow><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\large F(x)=\\sum_{i=1}^n y_i\\prod_{j\\neq i}\\frac{x-x_j}{x_i-x_j}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2em;vertical-align:-0.3em;\"></span><span class=\"mord mathnormal sizing reset-size6 size7\" style=\"margin-right:0.13889em;\">F</span><span class=\"mopen sizing reset-size6 size7\">(</span><span class=\"mord mathnormal sizing reset-size6 size7\">x</span><span class=\"mclose sizing reset-size6 size7\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel sizing reset-size6 size7\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.7257em;vertical-align:-0.6505em;\"></span><span class=\"mop sizing reset-size6 size7\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8017em;\"><span style=\"top:-2.5027em;margin-left:0em;margin-right:0.0417em;\"><span class=\"pstrut\" style=\"height:2.8em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.3147em;margin-right:0.0417em;\"><span class=\"pstrut\" style=\"height:2.8em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2973em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord sizing reset-size6 size7\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2897em;\"><span style=\"top:-2.65em;margin-left:-0.0359em;margin-right:0.0417em;\"><span class=\"pstrut\" style=\"height:2.8em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop sizing reset-size6 size7\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1656em;\"><span style=\"top:-2.5027em;margin-left:0em;margin-right:0.0417em;\"><span class=\"pstrut\" style=\"height:2.8em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\"><span class=\"mrel mtight\"><span class=\"mord vbox mtight\"><span class=\"thinbox mtight\"><span class=\"rlap mtight\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"inner\"><span class=\"mord mtight\"><span class=\"mrel mtight\">î€ </span></span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel mtight\">=</span></span><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.427em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord sizing reset-size6 size7\"><span class=\"mopen nulldelimiter sizing reset-size7 size6\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.896em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.4502em;margin-left:0em;margin-right:0.0625em;\"><span class=\"pstrut\" style=\"height:2.6em;\"></span><span class=\"sizing reset-size4 size2 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1498em;\"><span></span></span></span></span></span></span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.4502em;margin-left:0em;margin-right:0.0625em;\"><span class=\"pstrut\" style=\"height:2.6em;\"></span><span class=\"sizing reset-size4 size2 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2957em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.5071em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.4502em;margin-left:0em;margin-right:0.0625em;\"><span class=\"pstrut\" style=\"height:2.6em;\"></span><span class=\"sizing reset-size4 size2 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2957em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5421em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter sizing reset-size7 size6\"></span></span></span></span></span>åŒ–ç®€å¾—åˆ°</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mstyle mathsize=\"1.2em\"><mi>F</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mfrac><msub><mi>y</mi><mi>i</mi></msub><mrow><munder><mo>âˆ</mo><mrow><mi>j</mi><mo mathvariant=\"normal\">â‰ </mo><mi>i</mi></mrow></munder><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo></mrow></mfrac><munder><mo>âˆ</mo><mrow><mi>j</mi><mo mathvariant=\"normal\">â‰ </mo><mi>i</mi></mrow></munder><mo stretchy=\"false\">(</mo><mi>x</mi><mo>âˆ’</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo></mstyle></mrow><annotation encoding=\"application/x-tex\">\\large F(x)=\\sum_{i=1}^n \\frac{y_i}{\\prod_{j\\neq i}(x_i-x_j)}\\prod_{j\\neq i}(x-x_j)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2em;vertical-align:-0.3em;\"></span><span class=\"mord mathnormal sizing reset-size6 size7\" style=\"margin-right:0.13889em;\">F</span><span class=\"mopen sizing reset-size6 size7\">(</span><span class=\"mord mathnormal sizing reset-size6 size7\">x</span><span class=\"mclose sizing reset-size6 size7\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel sizing reset-size6 size7\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.6548em;vertical-align:-1.6903em;\"></span><span class=\"mop op-limits sizing reset-size6 size7\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.637em;\"><span style=\"top:-2.0443em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span><span style=\"top:-4.45em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2557em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord sizing reset-size6 size7\"><span class=\"mopen nulldelimiter sizing reset-size7 size6\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1076em;\"><span style=\"top:-2.514em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1656em;\"><span style=\"top:-2.5027em;margin-left:0em;margin-right:0.0417em;\"><span class=\"pstrut\" style=\"height:2.8em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\"><span class=\"mrel mtight\"><span class=\"mord vbox mtight\"><span class=\"thinbox mtight\"><span class=\"rlap mtight\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"inner\"><span class=\"mord mtight\"><span class=\"mrel mtight\">î€ </span></span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel mtight\">=</span></span><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.427em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2897em;\"><span style=\"top:-2.65em;margin-left:0em;margin-right:0.0417em;\"><span class=\"pstrut\" style=\"height:2.8em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2897em;\"><span style=\"top:-2.65em;margin-left:0em;margin-right:0.0417em;\"><span class=\"pstrut\" style=\"height:2.8em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2796em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.43em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.877em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2897em;\"><span style=\"top:-2.65em;margin-left:-0.0359em;margin-right:0.0417em;\"><span class=\"pstrut\" style=\"height:2.8em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.113em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter sizing reset-size7 size6\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits sizing reset-size6 size7\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.05em;\"><span style=\"top:-2.021em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\"><span class=\"mrel mtight\"><span class=\"mord vbox mtight\"><span class=\"thinbox mtight\"><span class=\"rlap mtight\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"inner\"><span class=\"mord mtight\"><span class=\"mrel mtight\">î€ </span></span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel mtight\">=</span></span><span class=\"mord mathnormal mtight\">i</span></span></span></span><span style=\"top:-3.2em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4086em;\"><span></span></span></span></span></span><span class=\"mopen sizing reset-size6 size7\">(</span><span class=\"mord mathnormal sizing reset-size6 size7\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin sizing reset-size6 size7\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2356em;vertical-align:-0.3356em;\"></span><span class=\"mord sizing reset-size6 size7\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2897em;\"><span style=\"top:-2.65em;margin-left:0em;margin-right:0.0417em;\"><span class=\"pstrut\" style=\"height:2.8em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2796em;\"><span></span></span></span></span></span></span><span class=\"mclose sizing reset-size6 size7\">)</span></span></span></span></span></p>\n<p>è®¾<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle mathsize=\"1.2em\"><mi>Î´</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msubsup><mo>âˆ</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mo stretchy=\"false\">(</mo><mi>x</mi><mo>âˆ’</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mstyle></mrow><annotation encoding=\"application/x-tex\">\\large \\delta(x)=\\prod_{i=1}^n(x-x_i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2em;vertical-align:-0.3em;\"></span><span class=\"mord mathnormal sizing reset-size6 size7\" style=\"margin-right:0.03785em;\">Î´</span><span class=\"mopen sizing reset-size6 size7\">(</span><span class=\"mord mathnormal sizing reset-size6 size7\">x</span><span class=\"mclose sizing reset-size6 size7\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel sizing reset-size6 size7\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.3189em;vertical-align:-0.3568em;\"></span><span class=\"mop sizing reset-size6 size7\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8017em;\"><span style=\"top:-2.5027em;margin-left:0em;margin-right:0.0417em;\"><span class=\"pstrut\" style=\"height:2.8em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.3147em;margin-right:0.0417em;\"><span class=\"pstrut\" style=\"height:2.8em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2973em;\"><span></span></span></span></span></span></span><span class=\"mopen sizing reset-size6 size7\">(</span><span class=\"mord mathnormal sizing reset-size6 size7\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin sizing reset-size6 size7\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2em;vertical-align:-0.3em;\"></span><span class=\"mord sizing reset-size6 size7\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2897em;\"><span style=\"top:-2.65em;margin-left:0em;margin-right:0.0417em;\"><span class=\"pstrut\" style=\"height:2.8em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose sizing reset-size6 size7\">)</span></span></span></span>ï¼Œåˆ™æ˜¾ç„¶æœ‰æ´›å¿…è¾¾æ³•åˆ™ä¸‹ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle mathsize=\"1.2em\"><msub><mo>âˆ</mo><mrow><mi>j</mi><mo mathvariant=\"normal\">â‰ </mo><mi>i</mi></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow><mi>lim</mi><mo>â¡</mo></mrow><mrow><mi>x</mi><mo>â†’</mo><msub><mi>x</mi><mi>i</mi></msub></mrow></msub><mfrac><mrow><mi>Î´</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi>x</mi><mo>âˆ’</mo><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>=</mo><msup><mi>Î´</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">â€²</mo></msup><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mstyle></mrow><annotation encoding=\"application/x-tex\">\\large \\prod_{j\\neq i}(x_i-x_j)=\\lim_{x\\to x_i}\\frac{\\delta(x)}{x-x_i}=\\delta&#x27;(x_i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.4124em;vertical-align:-0.5124em;\"></span><span class=\"mop sizing reset-size6 size7\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1656em;\"><span style=\"top:-2.5027em;margin-left:0em;margin-right:0.0417em;\"><span class=\"pstrut\" style=\"height:2.8em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\"><span class=\"mrel mtight\"><span class=\"mord vbox mtight\"><span class=\"thinbox mtight\"><span class=\"rlap mtight\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"inner\"><span class=\"mord mtight\"><span class=\"mrel mtight\">î€ </span></span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel mtight\">=</span></span><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.427em;\"><span></span></span></span></span></span></span><span class=\"mopen sizing reset-size6 size7\">(</span><span class=\"mord sizing reset-size6 size7\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2897em;\"><span style=\"top:-2.65em;margin-left:0em;margin-right:0.0417em;\"><span class=\"pstrut\" style=\"height:2.8em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin sizing reset-size6 size7\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2356em;vertical-align:-0.3356em;\"></span><span class=\"mord sizing reset-size6 size7\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2897em;\"><span style=\"top:-2.65em;margin-left:0em;margin-right:0.0417em;\"><span class=\"pstrut\" style=\"height:2.8em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2796em;\"><span></span></span></span></span></span></span><span class=\"mclose sizing reset-size6 size7\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel sizing reset-size6 size7\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.7059em;vertical-align:-0.5339em;\"></span><span class=\"mop sizing reset-size6 size7\"><span class=\"mop\">lim</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.137em;\"><span style=\"top:-2.65em;margin-right:0.0417em;\"><span class=\"pstrut\" style=\"height:2.8em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"mrel mtight\">â†’</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.4502em;margin-left:0em;margin-right:0.0625em;\"><span class=\"pstrut\" style=\"height:2.6em;\"></span><span class=\"sizing reset-size4 size2 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1498em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2499em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord sizing reset-size6 size7\"><span class=\"mopen nulldelimiter sizing reset-size7 size6\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9767em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.4502em;margin-left:0em;margin-right:0.0625em;\"><span class=\"pstrut\" style=\"height:2.6em;\"></span><span class=\"sizing reset-size4 size2 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1498em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.4767em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03785em;\">Î´</span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4449em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter sizing reset-size7 size6\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel sizing reset-size6 size7\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2em;vertical-align:-0.3em;\"></span><span class=\"mord sizing reset-size6 size7\"><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">Î´</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7334em;\"><span style=\"top:-3.163em;margin-right:0.0417em;\"><span class=\"pstrut\" style=\"height:2.8em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">â€²</span></span></span></span></span></span></span></span></span><span class=\"mopen sizing reset-size6 size7\">(</span><span class=\"mord sizing reset-size6 size7\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2897em;\"><span style=\"top:-2.65em;margin-left:0em;margin-right:0.0417em;\"><span class=\"pstrut\" style=\"height:2.8em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose sizing reset-size6 size7\">)</span></span></span></span></p>\n<p>å¯¹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Î´</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\delta(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">Î´</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>åˆ†æ²»<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mi>T</mi><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">NTT</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">NTT</span></span></span></span>ï¼ˆç±»ä¼¼å¿«é€Ÿå¹‚é‚£ç§å°±è¡Œäº†ï¼‰ï¼Œæ±‚å¯¼åå¤šç‚¹æ±‚å€¼å¾—åˆ°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>Î´</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">â€²</mo></msup><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\delta&#x27;(x_i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">Î´</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">â€²</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>.</p>\n<p>æ¥ä¸‹æ¥ç»§ç»­æ­£å®—åˆ†æ²»<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mi>T</mi><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">NTT</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">NTT</span></span></span></span>å³å¯ï¼Œè®¾<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>G</mi><mrow><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msubsup><mo>âˆ</mo><mrow><mi>i</mi><mo>=</mo><mi>l</mi></mrow><mi>r</mi></msubsup><mo stretchy=\"false\">(</mo><mi>x</mi><mo>âˆ’</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">G_{l,r}(x)=\\prod_{i=l}^r(x-x_i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">G</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.104em;vertical-align:-0.2997em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8043em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mrow><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">H_{l,r}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>l</mi></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mi>l</mi></msub><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>r</mi></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mi>r</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(x_l,y_l),\\cdots,(x_r,y_r)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>æ’å‡ºæ¥çš„å¤šé¡¹å¼ï¼Œå³<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mi>l</mi></mrow><mi>r</mi></msubsup><mfrac><msub><mi>y</mi><mi>i</mi></msub><mrow><msup><mi>Î´</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">â€²</mo></msup><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow></mfrac><msub><mo>âˆ</mo><mrow><mi>j</mi><mo mathvariant=\"normal\">â‰ </mo><mi>i</mi><mo separator=\"true\">,</mo><mi>l</mi><mo>â‰¤</mo><mi>j</mi><mo>â‰¤</mo><mi>r</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>âˆ’</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\sum_{i=l}^r \\frac{y_i}{\\delta&#x27;(x_i)}\\prod_{j\\neq i,l\\le j\\le r}(x-x_j)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.3243em;vertical-align:-0.52em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8043em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7475em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03785em;\">Î´</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6828em;\"><span style=\"top:-2.786em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">â€²</span></span></span></span></span></span></span></span></span><span class=\"mopen mtight\">(</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mclose mtight\">)</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.4461em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.52em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1864em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\"><span class=\"mrel mtight\"><span class=\"mord vbox mtight\"><span class=\"thinbox mtight\"><span class=\"rlap mtight\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"inner\"><span class=\"mord mtight\"><span class=\"mrel mtight\">î€ </span></span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel mtight\">=</span></span><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mrel mtight\">â‰¤</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">â‰¤</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>ï¼Œåˆ™æœ‰</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>G</mi><mrow><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi></mrow></msub><mo>=</mo><msub><mi>G</mi><mrow><mi>l</mi><mo separator=\"true\">,</mo><mi>m</mi><mi>i</mi><mi>d</mi></mrow></msub><mtext>Â </mtext><mo>â‹…</mo><mtext>Â </mtext><msub><mi>G</mi><mrow><mi>m</mi><mi>i</mi><mi>d</mi><mo>+</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>r</mi></mrow></msub><mspace linebreak=\"newline\"></mspace><msub><mi>H</mi><mrow><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi></mrow></msub><mo>=</mo><msub><mi>H</mi><mrow><mi>l</mi><mo separator=\"true\">,</mo><mi>m</mi><mi>i</mi><mi>d</mi></mrow></msub><mtext>Â </mtext><mo>â‹…</mo><msub><mi>G</mi><mrow><mi>m</mi><mi>i</mi><mi>d</mi><mo>+</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>r</mi></mrow></msub><mtext>Â </mtext><mo>+</mo><mtext>Â </mtext><msub><mi>H</mi><mrow><mi>m</mi><mi>i</mi><mi>d</mi><mo>+</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>r</mi></mrow></msub><mtext>Â </mtext><mo>â‹…</mo><mtext>Â </mtext><msub><mi>G</mi><mrow><mi>l</mi><mo separator=\"true\">,</mo><mi>m</mi><mi>i</mi><mi>d</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">G_{l,r}=G_{l,mid}\\ \\cdot\\ G_{mid+1,r}\\\\\nH_{l,r}=H_{l,mid}\\ \\cdot G_{mid+1,r}\\ +\\ H_{mid+1,r}\\ \\cdot\\ G_{l,mid}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">G</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">G</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">mi</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\">Â </span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\">Â </span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">G</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">mi</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">mi</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\">Â </span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">G</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">mi</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\">Â </span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\">Â </span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">mi</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\">Â </span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\">Â </span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">G</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">mi</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p>åˆ†æ²»<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mi>T</mi><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">NTT</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">NTT</span></span></span></span>å³å¯ã€‚å¤æ‚åº¦<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><msup><mi>g</mi><mn>2</mn></msup><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(nlog^2n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span></p>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"3-12-äºŒç»´å·ç§¯\">3.12 äºŒç»´å·ç§¯</h4>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mstyle mathsize=\"1.2em\"><msub><mi>s</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub><mo>=</mo><munder><mo>âˆ‘</mo><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>âˆ˜</mo><msub><mi>x</mi><mn>2</mn></msub><mo>=</mo><mi>i</mi><mo separator=\"true\">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo>âˆ—</mo><msub><mi>y</mi><mn>2</mn></msub><mo>=</mo><mi>j</mi></mrow></munder><msub><mi>a</mi><mrow><msub><mi>x</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mn>1</mn></msub></mrow></msub><mo>Ã—</mo><msub><mi>b</mi><mrow><msub><mi>x</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mn>2</mn></msub></mrow></msub></mstyle></mrow><annotation encoding=\"application/x-tex\">\\large s_{i,j}=\\sum_{x_1\\circ x_2=i,y_1*y_2=j}a_{x_1,y_1}\\times b_{x_2,y_2}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8522em;vertical-align:-0.3356em;\"></span><span class=\"mord sizing reset-size6 size7\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2897em;\"><span style=\"top:-2.65em;margin-left:0em;margin-right:0.0417em;\"><span class=\"pstrut\" style=\"height:2.8em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2796em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel sizing reset-size6 size7\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.9224em;vertical-align:-1.6624em;\"></span><span class=\"mop op-limits sizing reset-size6 size7\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.05em;\"><span style=\"top:-2.0443em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3403em;\"><span style=\"top:-2.457em;margin-left:0em;margin-right:0.0625em;\"><span class=\"pstrut\" style=\"height:2.6em;\"></span><span class=\"sizing reset-size4 size2 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mbin mtight\">âˆ˜</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3403em;\"><span style=\"top:-2.457em;margin-left:0em;margin-right:0.0625em;\"><span class=\"pstrut\" style=\"height:2.6em;\"></span><span class=\"sizing reset-size4 size2 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mrel mtight\">=</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3403em;\"><span style=\"top:-2.457em;margin-left:-0.0359em;margin-right:0.0625em;\"><span class=\"pstrut\" style=\"height:2.6em;\"></span><span class=\"sizing reset-size4 size2 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mbin mtight\">âˆ—</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3403em;\"><span style=\"top:-2.457em;margin-left:-0.0359em;margin-right:0.0625em;\"><span class=\"pstrut\" style=\"height:2.6em;\"></span><span class=\"sizing reset-size4 size2 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mrel mtight\">=</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span style=\"top:-3.2em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3853em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord sizing reset-size6 size7\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.137em;\"><span style=\"top:-2.65em;margin-left:0em;margin-right:0.0417em;\"><span class=\"pstrut\" style=\"height:2.8em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3403em;\"><span style=\"top:-2.457em;margin-left:0em;margin-right:0.0625em;\"><span class=\"pstrut\" style=\"height:2.6em;\"></span><span class=\"sizing reset-size4 size2 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mpunct mtight\">,</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3403em;\"><span style=\"top:-2.457em;margin-left:-0.0359em;margin-right:0.0625em;\"><span class=\"pstrut\" style=\"height:2.6em;\"></span><span class=\"sizing reset-size4 size2 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2796em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin sizing reset-size6 size7\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1689em;vertical-align:-0.3356em;\"></span><span class=\"mord sizing reset-size6 size7\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.137em;\"><span style=\"top:-2.65em;margin-left:0em;margin-right:0.0417em;\"><span class=\"pstrut\" style=\"height:2.8em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3403em;\"><span style=\"top:-2.457em;margin-left:0em;margin-right:0.0625em;\"><span class=\"pstrut\" style=\"height:2.6em;\"></span><span class=\"sizing reset-size4 size2 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mpunct mtight\">,</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3403em;\"><span style=\"top:-2.457em;margin-left:-0.0359em;margin-right:0.0625em;\"><span class=\"pstrut\" style=\"height:2.6em;\"></span><span class=\"sizing reset-size4 size2 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2796em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p>åˆ†5æ­¥ï¼š</p>\n<p>1.å¯¹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>å’Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>çš„æ¯ä¸€è¡Œåšæ™®é€š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi><mi>F</mi><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">DFT</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">FT</span></span></span></span>æˆ–å¯¹åº”<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mi>W</mi><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">FWT</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span></p>\n<p>2.å¯¹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>å’Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>çš„æ¯ä¸€åˆ—åšæ™®é€š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi><mi>F</mi><mi>T</mi><mi mathvariant=\"normal\">/</mi><mi>F</mi><mi>W</mi><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">DFT/FWT</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">FT</span><span class=\"mord\">/</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span></p>\n<p>3.æ–°å»ºçŸ©é˜µ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>s</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>a</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub><msub><mi>b</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">s_{i,j}=a_{i,j}b_{i,j}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span></p>\n<p>4.å¯¹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>çš„æ¯ä¸€<strong>åˆ—</strong>åšæ™®é€š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>I</mi><mi>D</mi><mi>F</mi><mi>T</mi><mi mathvariant=\"normal\">/</mi><mi>I</mi><mi>F</mi><mi>W</mi><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">IDFT/IFWT</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">FT</span><span class=\"mord\">/</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>(åˆ«å¿˜äº†åšå®Œä¹‹åä¹˜ä¸Šæ¯åˆ—é•¿åº¦çš„é€†å…ƒ)</p>\n<p>5.å¯¹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>çš„æ¯ä¸€<strong>è¡Œ</strong>åšæ™®é€š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>I</mi><mi>D</mi><mi>F</mi><mi>T</mi><mi mathvariant=\"normal\">/</mi><mi>I</mi><mi>F</mi><mi>W</mi><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">IDFT/IFWT</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">FT</span><span class=\"mord\">/</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>(åˆ«å¿˜äº†åšå®Œä¹‹åä¹˜ä¸Šæ¯è¡Œé•¿åº¦çš„é€†å…ƒ)</p>\n<p>ç„¶å<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>å°±æ˜¯è¦æ±‚çš„ç»“æœäº†ã€‚</p>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"3-13-æ™®é€šç”Ÿæˆå‡½æ•°æ“ä½œ\">3.13 æ™®é€šç”Ÿæˆå‡½æ•°æ“ä½œ</h4>\n<p>æ™®é€šç”Ÿæˆå‡½æ•°æ“ä½œç»„åˆæ•°å­¦è®¡æ•°é—®é¢˜ã€‚</p>\n<p>ä¸¾ä¸€ä¸ªä¾‹å­ï¼š</p>\n<p>ä¸€ä¸ªé•¿åº¦ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>çš„æ•°åˆ—ï¼Œä»ä¸­å–å‡º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>ä¸ªæ•°ï¼Œè¦æ±‚å¼‚æˆ–ç»“æœä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>çš„æ–¹æ¡ˆæ•°ã€‚</p>\n<p>æ“çºµç”Ÿæˆå‡½æ•°ï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>F</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><munderover><mo>âˆ</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy=\"false\">(</mo><mn>1</mn><mo>+</mo><msup><mi>x</mi><msub><mi>a</mi><mi>i</mi></msub></msup><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">F(x,y)=\\prod_{i=1}^n(1+x^{a_i}y)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.9291em;vertical-align:-1.2777em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7144em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p>è¿™é‡Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>ä¸ºå¼‚æˆ–å·ç§¯ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>ä¸ºæ­£å·ç§¯ã€‚</p>\n<p>åˆ™ç­”æ¡ˆä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><msup><mi>x</mi><mi>k</mi></msup><msup><mi>y</mi><mi>s</mi></msup><mo stretchy=\"false\">]</mo><mi>F</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">[x^{k}y^s]F(x,y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0991em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">s</span></span></span></span></span></span></span></span><span class=\"mclose\">]</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span>ï¼Œå³å¯¹åº”é¡¹ç³»æ•°ã€‚ä¸€èˆ¬ä¸ä¼šæœ‰äºŒç»´çš„æƒ…å†µï¼ŒäºŒç»´æ˜¾ç„¶æ— æ³•ç¡®å®šå•ä½æ ¹ï¼Œä¸€èˆ¬æ˜¯éœ€è¦æš´åŠ›å·ç§¯çš„ã€‚æœ¬ç”Ÿæˆå‡½æ•°åŸé¢˜<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mi>B</mi><mi>C</mi><mn>367</mn><mi>G</mi></mrow><annotation encoding=\"application/x-tex\">ABC367G</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">BC</span><span class=\"mord\">367</span><span class=\"mord mathnormal\">G</span></span></span></span>ä¸­<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>æ˜¯ä¸€ä¸ªé•¿åº¦ä¸è¶…è¿‡<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>100</mn></mrow><annotation encoding=\"application/x-tex\">100</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">100</span></span></span></span>â€‹çš„å¾ªç¯å·ç§¯ï¼Œé—®é¢˜åªåœ¨å¿«é€Ÿæ²ƒå°”ä»€å˜æ¢ä¸Šã€‚</p>\n<p>è€ƒè™‘å¯¹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>+</mo><msup><mi>x</mi><msub><mi>a</mi><mi>i</mi></msub></msup><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">1+x^{a_i}y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8588em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>è¿›è¡Œå¿«é€Ÿæ²ƒå°”ä»€ç‚¹å€¼å˜æ¢ï¼Œè®°å˜æ¢åçš„ç‚¹å€¼åºåˆ—ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mi>W</mi><mi>T</mi><mo stretchy=\"false\">(</mo><msup><mi>x</mi><msub><mi>a</mi><mi>i</mi></msub></msup><mo stretchy=\"false\">)</mo><mo>=</mo><mo stretchy=\"false\">{</mo><msubsup><mi>g</mi><msub><mi>a</mi><mi>i</mi></msub><mi>w</mi></msubsup><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">FWT(x^{a_i})=\\{g_{a_i}^{w}\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0971em;vertical-align:-0.3471em;\"></span><span class=\"mopen\">{</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02691em;\">w</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3471em;\"><span></span></span></span></span></span></span><span class=\"mclose\">}</span></span></span></span>ï¼Œåˆ™ç”±äºå°†<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>äºæ­¤ç»´åº¦è§†ä½œå¸¸æ•°ï¼Œç”±äºæ²ƒå°”ä»€å˜æ¢çº¿æ€§æ€§æœ‰<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mi>W</mi><mi>T</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo>+</mo><msup><mi>x</mi><msub><mi>a</mi><mi>i</mi></msub></msup><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo stretchy=\"false\">{</mo><mn>1</mn><mo>+</mo><msubsup><mi>g</mi><msub><mi>a</mi><mi>i</mi></msub><mi>w</mi></msubsup><mi>y</mi><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">FWT(1+x^{a_i}y)=\\{1+g_{a_i}^{w}y\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0971em;vertical-align:-0.3471em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02691em;\">w</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3471em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">}</span></span></span></span>â€‹.</p>\n<p>ç”±äºæ²ƒå°”ä»€å˜æ¢ç‰¹æ€§ï¼Œå¹‚æ¬¡å‡½æ•°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>x</mi><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">x^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span>çš„æ²ƒå°”ä»€å˜æ¢åºåˆ—åªæœ‰<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>å’Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">âˆ’</span><span class=\"mord\">1</span></span></span></span>ä¸¤ç§æƒ…å†µï¼Œæ‰€ä»¥æ²ƒå°”ä»€åºåˆ—å¯¹åº”ä½ç½®ç‚¹å€¼ç›¸ä¹˜åæœ‰<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mi>W</mi><mi>T</mi><mo stretchy=\"false\">(</mo><mi>F</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><msub><mo stretchy=\"false\">)</mo><mi>w</mi></msub><mo>=</mo><mo stretchy=\"false\">[</mo><msup><mi>y</mi><mn>0</mn></msup><mo stretchy=\"false\">]</mo><msubsup><mo>âˆ</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mo stretchy=\"false\">(</mo><mn>1</mn><mo>+</mo><mi>y</mi><msup><mo stretchy=\"false\">)</mo><msub><mi>c</mi><mi>w</mi></msub></msup><mo stretchy=\"false\">(</mo><mn>1</mn><mo>âˆ’</mo><mi>y</mi><msup><mo stretchy=\"false\">)</mo><mrow><mi>n</mi><mo>âˆ’</mo><msub><mi>c</mi><mi>w</mi></msub></mrow></msup></mrow><annotation encoding=\"application/x-tex\">FWT(F(x,y))_w=[y^0]\\prod_{i=1}^n(1+y)^{c_w}(1-y)^{n-c_w}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02691em;\">w</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1138em;vertical-align:-0.2997em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span></span></span></span></span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8043em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02691em;\">w</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0213em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7713em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02691em;\">w</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>ï¼Œå…¶ä¸­<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>c</mi><mi>w</mi></msub></mrow><annotation encoding=\"application/x-tex\">c_w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02691em;\">w</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mi>W</mi><mi>T</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><msub><mi>a</mi><mi>i</mi></msub></msub><msub><mo stretchy=\"false\">)</mo><mi>w</mi></msub></mrow><annotation encoding=\"application/x-tex\">FWT(x_{a_i})_w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0001em;vertical-align:-0.2501em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02691em;\">w</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>çš„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>çš„æ•°é‡ã€‚å…³äº<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>c</mi><mi>w</mi></msub></mrow><annotation encoding=\"application/x-tex\">c_w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02691em;\">w</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>æ˜¾ç„¶æœ‰<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>c</mi><mi>w</mi></msub><mo>+</mo><mo stretchy=\"false\">(</mo><mi>n</mi><mo>âˆ’</mo><msub><mi>c</mi><mi>w</mi></msub><mo stretchy=\"false\">)</mo><mo>Ã—</mo><mo stretchy=\"false\">(</mo><mo>âˆ’</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>=</mo><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msubsup><mi>h</mi><msub><mi>a</mi><mi>i</mi></msub><mi>w</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">c_w+(n-c_w)\\times(-1)=\\sum_{i=1}^nh_{a_i}^w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02691em;\">w</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02691em;\">w</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">âˆ’</span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1514em;vertical-align:-0.3471em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8043em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02691em;\">w</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3471em;\"><span></span></span></span></span></span></span></span></span></span>ï¼Œç­‰å¼å³è¾¹å¯ä»¥ç”±<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msup><mi>x</mi><msub><mi>a</mi><mi>i</mi></msub></msup></mrow><annotation encoding=\"application/x-tex\">\\sum_{i=1}^nx^{a_i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.104em;vertical-align:-0.2997em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8043em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>å¿«é€Ÿæ²ƒå°”ä»€å˜æ¢å¾—åˆ°ï¼ˆ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mi>W</mi><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">FWT</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>çº¿æ€§æ€§ï¼‰</p>\n<p>ç”±äº<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>â€‹ç»´åº¦å¾ˆå°ï¼Œæš´åŠ›å·ç§¯å·å‡ºæ¥ï¼Œæœ€åå¿«é€Ÿæ²ƒå°”ä»€é€†å˜æ¢åå°±æ˜¯ç»“æœå¤šé¡¹å¼ï¼Œç›´æ¥é”ç»“æœå°±è¡Œäº†ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt; f, a, b, finalans;</span><br><span class=\"line\">vector&lt;vector&lt;<span class=\"type\">int</span>&gt;&gt; presum, presum2;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">solve</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n, m, k;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; k;</span><br><span class=\"line\">    f.<span class=\"built_in\">assign</span>(<span class=\"number\">1</span> &lt;&lt; <span class=\"number\">20</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> x;</span><br><span class=\"line\">        cin &gt;&gt; x;</span><br><span class=\"line\">        f[x]++;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    a = <span class=\"built_in\">fwt_xor</span>(f);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; (<span class=\"number\">1</span> &lt;&lt; <span class=\"number\">20</span>); i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        a[i] = ((n + a[i]) % mod * (<span class=\"number\">499122177</span>)) % mod;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// æš´åŠ›é¢„å¤„ç†å¾ªç¯å·ç§¯(1+y)^a ä»¥åŠ(1-y)^a</span></span><br><span class=\"line\">    presum.<span class=\"built_in\">assign</span>(n + <span class=\"number\">1</span>, <span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;(m + <span class=\"number\">1</span>)), presum2 = presum;</span><br><span class=\"line\">    presum[<span class=\"number\">0</span>][<span class=\"number\">0</span>] = presum2[<span class=\"number\">0</span>][<span class=\"number\">0</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt; m; j++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            presum[i][j] = (presum[i][j] + presum[i - <span class=\"number\">1</span>][j]) % mod;                              <span class=\"comment\">//(1+y)</span></span><br><span class=\"line\">            presum[i][(j + <span class=\"number\">1</span>) % m] = (presum[i][(j + <span class=\"number\">1</span>) % m] + presum[i - <span class=\"number\">1</span>][j]) % mod;          <span class=\"comment\">//(1+y)</span></span><br><span class=\"line\">            presum2[i][j] = (presum2[i][j] + presum2[i - <span class=\"number\">1</span>][j]) % mod;                           <span class=\"comment\">//(1-y)</span></span><br><span class=\"line\">            presum2[i][(j + <span class=\"number\">1</span>) % m] = (presum2[i][(j + <span class=\"number\">1</span>) % m] - presum2[i - <span class=\"number\">1</span>][j] + mod) % mod; <span class=\"comment\">//(1-y)</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    finalans.<span class=\"built_in\">assign</span>(<span class=\"number\">1</span> &lt;&lt; <span class=\"number\">20</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; (<span class=\"number\">1</span> &lt;&lt; <span class=\"number\">20</span>); i++) <span class=\"comment\">// å¿«é€Ÿæ²ƒå°”ä»€å˜æ¢ç¬¬iä½çš„å€¼</span></span><br><span class=\"line\">    &#123;                                   <span class=\"comment\">//(1+y)^(a[i])*(1-y)^(n-a[i])</span></span><br><span class=\"line\">                                        <span class=\"comment\">// æ±‚y^0ï¼Œå³y^mé¡¹</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt; m; j++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            finalans[i] = (finalans[i] + (presum[a[i]][j] * presum2[n - a[i]][(m - j) % m] % mod)) % mod;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    b = ifwt_xor(finalans);</span><br><span class=\"line\">    i64 ans = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; (<span class=\"number\">1</span> &lt;&lt; <span class=\"number\">20</span>); i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        ans = (ans + b[i] * <span class=\"built_in\">power</span>(i, k) % mod) % mod;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>å…¶ä»–è§<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mi>I</mi><mo>âˆ’</mo><mi>W</mi><mi>i</mi><mi>k</mi><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">OI-Wiki</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">Wiki</span></span></span></span></p>\n<h4 id=\"3-14-æŒ‡æ•°ç”Ÿæˆå‡½æ•°æ“ä½œ\">3.14 æŒ‡æ•°ç”Ÿæˆå‡½æ•°æ“ä½œ</h4>\n<p>æ“çºµæ’åˆ—æ•°å­¦è®¡æ•°é—®é¢˜ã€‚</p>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"4-è®¡ç®—å‡ ä½•ç›¸å…³\">4. è®¡ç®—å‡ ä½•ç›¸å…³</h3>\n<h4 id=\"4-1-å¹³é¢å‡ ä½•ï¼ˆwith-Complex\">4.1 å¹³é¢å‡ ä½•ï¼ˆwith Complex)</h4>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**   å¹³é¢å‡ ä½•ï¼ˆwith. complexï¼‰</span></span><br><span class=\"line\"><span class=\"comment\"> *    2023-09-04: https://qoj.ac/submission/164445</span></span><br><span class=\"line\"><span class=\"comment\">**/</span></span><br><span class=\"line\"><span class=\"keyword\">using</span> Point = std::complex&lt;<span class=\"type\">long</span> <span class=\"type\">double</span>&gt;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> x real</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> y imag</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">long</span> <span class=\"type\">double</span> <span class=\"title\">dot</span><span class=\"params\">(<span class=\"type\">const</span> Point &amp;a, <span class=\"type\">const</span> Point &amp;b)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (std::<span class=\"built_in\">conj</span>(a) * b).<span class=\"built_in\">x</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">long</span> <span class=\"type\">double</span> <span class=\"title\">cross</span><span class=\"params\">(<span class=\"type\">const</span> Point &amp;a, <span class=\"type\">const</span> Point &amp;b)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (std::<span class=\"built_in\">conj</span>(a) * b).<span class=\"built_in\">y</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">long</span> <span class=\"type\">double</span> <span class=\"title\">length</span><span class=\"params\">(<span class=\"type\">const</span> Point &amp;a)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> std::<span class=\"built_in\">sqrt</span>(<span class=\"built_in\">dot</span>(a, a));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">long</span> <span class=\"type\">double</span> <span class=\"title\">dist</span><span class=\"params\">(<span class=\"type\">const</span> Point &amp;a, <span class=\"type\">const</span> Point &amp;b)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">length</span>(a - b);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">long</span> <span class=\"type\">double</span> <span class=\"title\">get</span><span class=\"params\">(<span class=\"type\">const</span> Point &amp;a, <span class=\"type\">const</span> Point &amp;b, <span class=\"type\">const</span> Point &amp;c, <span class=\"type\">const</span> Point &amp;d)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">auto</span> e = a + (b - a) * <span class=\"built_in\">cross</span>(c - a, d - a) / <span class=\"built_in\">cross</span>(b - a, d - c);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">dist</span>(d, e);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"4-2-äºŒç»´å‡¸åŒ…-æ—‹è½¬å¡å£³ï¼ˆå‡¸åŒ…ç›´å¾„ï¼‰\">4.2 äºŒç»´å‡¸åŒ…+æ—‹è½¬å¡å£³ï¼ˆå‡¸åŒ…ç›´å¾„ï¼‰</h4>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"comment\">// #define DEBUG 1</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> i64 long long</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> d32 double</span></span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> INF = <span class=\"number\">0x3f3f3f3f</span>;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> N = <span class=\"number\">2e6</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">node</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    i64 x, y;</span><br><span class=\"line\">    <span class=\"type\">bool</span> <span class=\"keyword\">operator</span>&lt;(<span class=\"type\">const</span> node &amp;a) <span class=\"type\">const</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> x == a.x ? y &lt; a.y : x &lt; a.x;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">bool</span> <span class=\"keyword\">operator</span>==(<span class=\"type\">const</span> node &amp;a) <span class=\"type\">const</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> x == a.x &amp;&amp; y == a.y;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    node <span class=\"keyword\">operator</span>-(<span class=\"type\">const</span> node &amp;a) <span class=\"type\">const</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> &#123;x - a.x, y - a.y&#125;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    i64 <span class=\"keyword\">operator</span>*(<span class=\"type\">const</span> node &amp;a) <span class=\"type\">const</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> x * a.y - y * a.x;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    i64 <span class=\"keyword\">operator</span>^(<span class=\"type\">const</span> node &amp;a) <span class=\"type\">const</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> x * a.x + y * a.y;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    node <span class=\"keyword\">operator</span>+(<span class=\"type\">const</span> node &amp;a) <span class=\"type\">const</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> &#123;x + a.x, y + a.y&#125;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">friend</span> d32 <span class=\"title\">dis</span><span class=\"params\">(node a, node b)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">sqrtl</span>((a.x - b.x) * (a.x - b.x) + (a.y - b.y) * (a.y - b.y));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">friend</span> i64 <span class=\"title\">dis2</span><span class=\"params\">(node a, node b)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> (a.x - b.x) * (a.x - b.x) + (a.y - b.y) * (a.y - b.y);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"type\">int</span> stk[N], tp = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"type\">bool</span> used[N];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//è¿”å›çš„vector0ä½ç©ºå‡ºï¼Œæœ€åä¸€ä½ä¸ºç¬¬ä¸€ä¸ªç‚¹</span></span><br><span class=\"line\"><span class=\"function\">vector&lt;node&gt; <span class=\"title\">get_convex</span><span class=\"params\">(node p[], <span class=\"type\">int</span> n)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// stk[] æ˜¯æ•´å‹ï¼Œå­˜çš„æ˜¯ä¸‹æ ‡</span></span><br><span class=\"line\">    <span class=\"comment\">// p[] å­˜å‚¨å‘é‡æˆ–ç‚¹</span></span><br><span class=\"line\">    <span class=\"comment\">// h[] å­˜å‚¨å‡¸åŒ…ä¸Šçš„ç‚¹</span></span><br><span class=\"line\">    <span class=\"comment\">// used[] æ ‡è®°æ˜¯å¦åœ¨å‡¸åŒ…ä¸Š</span></span><br><span class=\"line\">    <span class=\"comment\">// tp æ ˆé¡¶æŒ‡é’ˆ</span></span><br><span class=\"line\">    tp = <span class=\"number\">0</span>; <span class=\"comment\">// åˆå§‹åŒ–æ ˆ</span></span><br><span class=\"line\">            <span class=\"comment\">// æ ‡è®°æ˜¯å¦åœ¨å‡¸åŒ…ä¸Š</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        used[i] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    std::<span class=\"built_in\">sort</span>(p + <span class=\"number\">1</span>, p + <span class=\"number\">1</span> + n); <span class=\"comment\">// å¯¹ç‚¹è¿›è¡Œæ’åº</span></span><br><span class=\"line\">    stk[++tp] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"comment\">// æ ˆå†…æ·»åŠ ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œä¸”ä¸æ›´æ–° usedï¼Œä½¿å¾— 1 åœ¨æœ€åå°é—­å‡¸åŒ…æ—¶ä¹Ÿå¯¹å•è°ƒæ ˆæ›´æ–°</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">2</span>; i &lt;= n; ++i)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (tp &gt;= <span class=\"number\">2</span> <span class=\"comment\">// ä¸‹ä¸€è¡Œ * æ“ä½œç¬¦è¢«é‡è½½ä¸ºå‰ç§¯</span></span><br><span class=\"line\">               &amp;&amp; (p[stk[tp]] - p[stk[tp - <span class=\"number\">1</span>]]) * (p[i] - p[stk[tp]]) &lt;= <span class=\"number\">0</span>)</span><br><span class=\"line\">            used[stk[tp--]] = <span class=\"number\">0</span>;</span><br><span class=\"line\">        used[i] = <span class=\"number\">1</span>; <span class=\"comment\">// used è¡¨ç¤ºåœ¨å‡¸å£³ä¸Š</span></span><br><span class=\"line\">        stk[++tp] = i;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> tmp = tp; <span class=\"comment\">// tmp è¡¨ç¤ºä¸‹å‡¸å£³å¤§å°</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = n - <span class=\"number\">1</span>; i &gt; <span class=\"number\">0</span>; --i)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!used[i])</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"comment\">// â†“æ±‚ä¸Šå‡¸å£³æ—¶ä¸å½±å“ä¸‹å‡¸å£³</span></span><br><span class=\"line\">            <span class=\"keyword\">while</span> (tp &gt; tmp &amp;&amp; (p[stk[tp]] - p[stk[tp - <span class=\"number\">1</span>]]) * (p[i] - p[stk[tp]]) &lt;= <span class=\"number\">0</span>)</span><br><span class=\"line\">                used[stk[tp--]] = <span class=\"number\">0</span>;</span><br><span class=\"line\">            used[i] = <span class=\"number\">1</span>;</span><br><span class=\"line\">            stk[++tp] = i;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    vector&lt;node&gt; h;</span><br><span class=\"line\">    h.<span class=\"built_in\">push_back</span>(&#123;-INF, -INF&#125;);    <span class=\"comment\">// ä» 1 å¼€å§‹å­˜å‚¨å‡¸åŒ…ä¸Šçš„ç‚¹</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= tp; ++i) <span class=\"comment\">// å¤åˆ¶åˆ°æ–°æ•°ç»„ä¸­å»</span></span><br><span class=\"line\">        h.<span class=\"built_in\">push_back</span>(p[stk[i]]);</span><br><span class=\"line\">    <span class=\"type\">int</span> ans = tp - <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> h;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"type\">bool</span> is[N];</span><br><span class=\"line\"><span class=\"comment\">// æ±‚å‡¸åŒ…ç›´å¾„ï¼Œè¿”å›ç›´å¾„çš„å¹³æ–¹</span></span><br><span class=\"line\"><span class=\"function\">i64 <span class=\"title\">get_longest</span><span class=\"params\">(vector&lt;node&gt; sta)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">ifdef</span> DEBUG</span></span><br><span class=\"line\">    cout &lt;&lt; <span class=\"string\">&quot;-------------------DEBUG-------------------&quot;</span> &lt;&lt; endl;</span><br><span class=\"line\">    cout &lt;&lt; <span class=\"string\">&quot;points in convex hull:&quot;</span> &lt;&lt; endl;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> i : sta)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cout &lt;&lt; i.x &lt;&lt; <span class=\"string\">&quot; &quot;</span> &lt;&lt; i.y &lt;&lt; endl;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; <span class=\"string\">&quot;-------------------DEBUG-------------------&quot;</span> &lt;&lt; endl;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">endif</span></span></span><br><span class=\"line\">    i64 mx = <span class=\"number\">0</span>;               <span class=\"comment\">// æ±‚å‡¸åŒ…ç›´å¾„</span></span><br><span class=\"line\">    <span class=\"type\">int</span> top = sta.<span class=\"built_in\">size</span>() - <span class=\"number\">1</span>; <span class=\"comment\">// å°†å‡¸åŒ…ä¸Šçš„èŠ‚ç‚¹ç¼–å·å­˜åœ¨æ ˆé‡Œï¼Œç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªèŠ‚ç‚¹ç¼–å·ç›¸åŒ</span></span><br><span class=\"line\">    <span class=\"type\">int</span> j = <span class=\"number\">3</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (top &lt; <span class=\"number\">4</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        mx = <span class=\"built_in\">dis2</span>(sta[<span class=\"number\">1</span>], sta[<span class=\"number\">2</span>]);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> mx;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt; top; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> ((sta[i + <span class=\"number\">1</span>] - sta[i]) * (sta[j] - sta[i + <span class=\"number\">1</span>]) &lt;= (sta[i + <span class=\"number\">1</span>] - sta[i]) * (sta[j % top + <span class=\"number\">1</span>] - sta[i + <span class=\"number\">1</span>]))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">ifdef</span> DEBUG</span></span><br><span class=\"line\">            cout &lt;&lt; <span class=\"string\">&quot;-------------------DEBUG-------------------&quot;</span> &lt;&lt; endl;</span><br><span class=\"line\">            cout &lt;&lt; <span class=\"string\">&quot;i=&quot;</span> &lt;&lt; i &lt;&lt; <span class=\"string\">&quot; j=&quot;</span> &lt;&lt; j &lt;&lt; endl;</span><br><span class=\"line\">            cout &lt;&lt; <span class=\"string\">&quot;sta[i]=&quot;</span> &lt;&lt; sta[i].x &lt;&lt; <span class=\"string\">&quot; &quot;</span> &lt;&lt; sta[i].y &lt;&lt; endl;</span><br><span class=\"line\">            cout &lt;&lt; <span class=\"string\">&quot;sta[i+1]=&quot;</span> &lt;&lt; sta[i + <span class=\"number\">1</span>].x &lt;&lt; <span class=\"string\">&quot; &quot;</span> &lt;&lt; sta[i + <span class=\"number\">1</span>].y &lt;&lt; endl;</span><br><span class=\"line\">            cout &lt;&lt; <span class=\"string\">&quot;sta[j]=&quot;</span> &lt;&lt; sta[j].x &lt;&lt; <span class=\"string\">&quot; &quot;</span> &lt;&lt; sta[j].y &lt;&lt; endl;</span><br><span class=\"line\">            cout &lt;&lt; <span class=\"string\">&quot;sta[j%top+1]=&quot;</span> &lt;&lt; sta[j % top + <span class=\"number\">1</span>].x &lt;&lt; <span class=\"string\">&quot; &quot;</span> &lt;&lt; sta[j % top + <span class=\"number\">1</span>].y &lt;&lt; endl;</span><br><span class=\"line\">            cout &lt;&lt; <span class=\"string\">&quot;-------------------DEBUG-------------------&quot;</span> &lt;&lt; endl;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">endif</span></span></span><br><span class=\"line\">            j = j % top + <span class=\"number\">1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">ifdef</span> DEBUG</span></span><br><span class=\"line\">        cout &lt;&lt; <span class=\"string\">&quot;-------------------DEBUG-------------------&quot;</span> &lt;&lt; endl;</span><br><span class=\"line\">        cout &lt;&lt; <span class=\"string\">&quot;mx=&quot;</span> &lt;&lt; mx &lt;&lt; endl;</span><br><span class=\"line\">        cout &lt;&lt; <span class=\"string\">&quot;dis2(sta[&quot;</span> &lt;&lt; i &lt;&lt; <span class=\"string\">&quot;],sta[&quot;</span> &lt;&lt; j &lt;&lt; <span class=\"string\">&quot;])=&quot;</span> &lt;&lt; <span class=\"built_in\">dis2</span>(sta[i], sta[j]) &lt;&lt; endl;</span><br><span class=\"line\">        cout &lt;&lt; <span class=\"string\">&quot;dis2(sta[&quot;</span> &lt;&lt; i + <span class=\"number\">1</span> &lt;&lt; <span class=\"string\">&quot;],sta[&quot;</span> &lt;&lt; j &lt;&lt; <span class=\"string\">&quot;])=&quot;</span> &lt;&lt; <span class=\"built_in\">dis2</span>(sta[i + <span class=\"number\">1</span>], sta[j]) &lt;&lt; endl;</span><br><span class=\"line\">        cout &lt;&lt; <span class=\"string\">&quot;-------------------DEBUG-------------------&quot;</span> &lt;&lt; endl;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">endif</span></span></span><br><span class=\"line\">        mx = <span class=\"built_in\">max</span>(mx, <span class=\"built_in\">max</span>(<span class=\"built_in\">dis2</span>(sta[i], sta[j]), <span class=\"built_in\">dis2</span>(sta[i + <span class=\"number\">1</span>], sta[j])));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> mx;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">node a[N + <span class=\"number\">1</span>], b[N + <span class=\"number\">1</span>];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">solve</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cin &gt;&gt; a[i].x &gt;&gt; a[i].y;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    vector&lt;node&gt; h = <span class=\"built_in\">get_convex</span>(a, n);</span><br><span class=\"line\">    <span class=\"type\">int</span> cnt = h.<span class=\"built_in\">size</span>() - <span class=\"number\">2</span>;</span><br><span class=\"line\">    d32 C = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= cnt; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        C += <span class=\"built_in\">dis</span>(h[i], h[i + <span class=\"number\">1</span>]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cin &gt;&gt; b[i].x &gt;&gt; b[i].y;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    h.<span class=\"built_in\">clear</span>();</span><br><span class=\"line\">    h = <span class=\"built_in\">get_convex</span>(b, n);</span><br><span class=\"line\">    d32 D = <span class=\"built_in\">sqrtl</span>(<span class=\"built_in\">get_longest</span>(h));</span><br><span class=\"line\">    <span class=\"comment\">// cout &lt;&lt; C &lt;&lt; endl;</span></span><br><span class=\"line\">    cout &lt;&lt; fixed &lt;&lt; <span class=\"built_in\">setprecision</span>(<span class=\"number\">10</span>) &lt;&lt; C + <span class=\"number\">2</span> * M_PI * D &lt;&lt; endl;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"type\">int</span> t;</span><br><span class=\"line\">    cin &gt;&gt; t;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (t--)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">solve</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"5-ç»„åˆæ•°å­¦ç›¸å…³\">5. ç»„åˆæ•°å­¦ç›¸å…³</h3>\n<h4 id=\"5-1-ç»„åˆæ•°æ¨è¾‰ä¸‰è§’-çº¿æ€§é€’æ¨é€†å…ƒ\">5.1 ç»„åˆæ•°æ¨è¾‰ä¸‰è§’+çº¿æ€§é€’æ¨é€†å…ƒ</h4>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;iostream&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">int</span> n,m;</span><br><span class=\"line\"><span class=\"type\">int</span> f[<span class=\"number\">1005</span>][<span class=\"number\">1005</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    cin&gt;&gt;n&gt;&gt;m;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;=n;i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        f[i][i]=<span class=\"number\">1</span>;</span><br><span class=\"line\">        f[i][<span class=\"number\">0</span>]=<span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">1</span>;j&lt;i;j++)</span><br><span class=\"line\">            f[i][j]=f[i<span class=\"number\">-1</span>][j]+f[i<span class=\"number\">-1</span>][j<span class=\"number\">-1</span>];</span><br><span class=\"line\">    cout&lt;&lt;f[n][m];</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> int long long</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> endl <span class=\"string\">&#x27;\\n&#x27;</span></span></span><br><span class=\"line\"><span class=\"type\">int</span> mod;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">6e6</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> inv[maxn];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"type\">int</span> a;</span><br><span class=\"line\">    cin &gt;&gt; a &gt;&gt; mod;</span><br><span class=\"line\">    inv[<span class=\"number\">1</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    cout &lt;&lt; <span class=\"number\">1</span> &lt;&lt; endl;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">2</span>; i &lt;= a; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        inv[i] = (mod - mod / i) * inv[mod % i] % mod;</span><br><span class=\"line\">        cout &lt;&lt; inv[i] &lt;&lt; endl;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"5-2-å¢å¡æ–¯å®šç†-æ‰©å±•å¢å¡æ–¯å®šç†\">5.2 å¢å¡æ–¯å®šç†/æ‰©å±•å¢å¡æ–¯å®šç†</h4>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msubsup><mi>C</mi><mi>n</mi><mi>m</mi></msubsup><mtext>Â </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><mi>p</mi><mo>=</mo><msubsup><mi>C</mi><mrow><mo stretchy=\"false\">âŒŠ</mo><mfrac><mi>n</mi><mi>p</mi></mfrac><mo stretchy=\"false\">âŒ‹</mo></mrow><mrow><mo stretchy=\"false\">âŒŠ</mo><mfrac><mi>m</mi><mi>p</mi></mfrac><mo stretchy=\"false\">âŒ‹</mo></mrow></msubsup><mo>â‹…</mo><msubsup><mi>C</mi><mrow><mi>n</mi><mtext>Â </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><mi>p</mi></mrow><mrow><mi>m</mi><mtext>Â </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><mi>p</mi></mrow></msubsup><mtext>Â </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">C_n^{m}\\ mod\\ p=C_{\\lfloor \\frac{n}{p}\\rfloor}^{\\lfloor \\frac{m}{p}\\rfloor}\\cdot C_{n\\ mod\\ p}^{m\\ mod\\ p}\\ mod \\ p\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9614em;vertical-align:-0.247em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7144em;\"><span style=\"top:-2.453em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\">Â </span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\">Â </span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.886em;vertical-align:-0.6782em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2078em;\"><span style=\"top:-2.6598em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">âŒŠ</span><span class=\"mord mtight\"><span class=\"mopen nulldelimiter sizing reset-size3 size6\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6915em;\"><span style=\"top:-2.656em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span style=\"top:-3.2255em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line mtight\" style=\"border-bottom-width:0.049em;\"></span></span><span style=\"top:-3.384em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4829em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter sizing reset-size3 size6\"></span></span><span class=\"mclose mtight\">âŒ‹</span></span></span></span><span style=\"top:-3.6828em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">âŒŠ</span><span class=\"mord mtight\"><span class=\"mopen nulldelimiter sizing reset-size3 size6\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6915em;\"><span style=\"top:-2.656em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span style=\"top:-3.2255em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line mtight\" style=\"border-bottom-width:0.049em;\"></span></span><span style=\"top:-3.384em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4829em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter sizing reset-size3 size6\"></span></span><span class=\"mclose mtight\">âŒ‹</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6782em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.4044em;vertical-align:-0.4374em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.967em;\"><span style=\"top:-2.3987em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mspace mtight\"><span class=\"mtight\">Â </span></span><span class=\"mord mathnormal mtight\">m</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mspace mtight\"><span class=\"mtight\">Â </span></span><span class=\"mord mathnormal mtight\">p</span></span></span></span><span style=\"top:-3.1809em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"mspace mtight\"><span class=\"mtight\">Â </span></span><span class=\"mord mathnormal mtight\">m</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mspace mtight\"><span class=\"mtight\">Â </span></span><span class=\"mord mathnormal mtight\">p</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4374em;\"><span></span></span></span></span></span></span><span class=\"mspace\">Â </span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\">Â </span><span class=\"mord mathnormal\">p</span></span></span></span></span></p>\n<p>å¼ºåˆ¶è¦æ±‚<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span></span></span></span>ä¸ºè´¨æ•°ã€‚å¤æ‚åº¦<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>p</mi><mo>+</mo><mi>T</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(p+Tlogn)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">Tl</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"type\">long</span> <span class=\"type\">long</span> <span class=\"title\">C</span><span class=\"params\">(<span class=\"type\">long</span> <span class=\"type\">long</span> n,<span class=\"type\">long</span> <span class=\"type\">long</span> m,<span class=\"type\">long</span> <span class=\"type\">long</span> mod)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(m&gt;n&amp;&amp;n==<span class=\"number\">0</span>)<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(m==<span class=\"number\">0</span>)<span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ((frac[n]*invq[m]%mod)*invq[n-m])%mod;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//é˜¶ä¹˜çš„å€¼å’Œé€†å…ƒé¢„å¤„ç†æ˜¯çº¿æ€§çš„é€’æ¨</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">long</span> <span class=\"type\">long</span> <span class=\"title\">Lucas</span><span class=\"params\">(<span class=\"type\">long</span> <span class=\"type\">long</span> n, <span class=\"type\">long</span> <span class=\"type\">long</span> m, <span class=\"type\">long</span> <span class=\"type\">long</span> p)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (m == <span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (<span class=\"built_in\">C</span>(n % p, m % p, p) * <span class=\"built_in\">Lucas</span>(n / p, m / p, p)) % p;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>å¯¹äºæ‰©å±•å¢å¡æ–¯å®šç†ï¼Œä¸å†è¦æ±‚<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span></span></span></span>å¿…é¡»æ˜¯è´¨æ•°ï¼ŒåŸç†è§<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mi>I</mi><mo>âˆ’</mo><mi>W</mi><mi>i</mi><mi>k</mi><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">OI-Wiki</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">Wiki</span></span></span></span>ã€‚æ³¨æ„ï¼Œå•æ¬¡è¯¢é—®<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>p</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>p</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(plogp)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">pl</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">p</span><span class=\"mclose\">)</span></span></span></span>å¤æ‚åº¦ï¼ŒåŸºæœ¬ä¸å¯èƒ½æ”¯æŒå¤§é‡æ¬¡æ•°è¯¢é—®ã€‚æ¨¡æ¿ä¹Ÿæ˜¯ä»…æ”¯æŒæŸ¥è¯¢ä¸€æ¬¡çš„ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;cstdio&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;algorithm&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;cstring&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;iostream&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;climits&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;cmath&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">namespace</span> ExLucas</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">const</span> <span class=\"type\">int</span> N = <span class=\"number\">1e6</span>;</span><br><span class=\"line\">    <span class=\"keyword\">typedef</span> <span class=\"type\">long</span> <span class=\"type\">long</span> ll;</span><br><span class=\"line\">    ll n, m, p;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> ll <span class=\"title\">power</span><span class=\"params\">(ll a, ll b, <span class=\"type\">const</span> ll p = LLONG_MAX)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        ll ans = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (b)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (b &amp; <span class=\"number\">1</span>)</span><br><span class=\"line\">                ans = ans * a % p;</span><br><span class=\"line\">            a = a * a % p;</span><br><span class=\"line\">            b &gt;&gt;= <span class=\"number\">1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">ll <span class=\"title\">fac</span><span class=\"params\">(<span class=\"type\">const</span> ll n, <span class=\"type\">const</span> ll p, <span class=\"type\">const</span> ll pk)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!n)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">        ll ans = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt; pk; i++)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (i % p)</span><br><span class=\"line\">                ans = ans * i % pk;</span><br><span class=\"line\">        ans = <span class=\"built_in\">power</span>(ans, n / pk, pk);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n % pk; i++)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (i % p)</span><br><span class=\"line\">                ans = ans * i % pk;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans * <span class=\"built_in\">fac</span>(n / p, p, pk) % pk;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">ll <span class=\"title\">exgcd</span><span class=\"params\">(<span class=\"type\">const</span> ll a, <span class=\"type\">const</span> ll b, ll &amp;x, ll &amp;y)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!b)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            x = <span class=\"number\">1</span>, y = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> a;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        ll xx, yy, g = <span class=\"built_in\">exgcd</span>(b, a % b, xx, yy);</span><br><span class=\"line\">        x = yy;</span><br><span class=\"line\">        y = xx - a / b * yy;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> g;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">ll <span class=\"title\">inv</span><span class=\"params\">(<span class=\"type\">const</span> ll a, <span class=\"type\">const</span> ll p)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        ll x, y;</span><br><span class=\"line\">        <span class=\"built_in\">exgcd</span>(a, p, x, y);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> (x % p + p) % p;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">ll <span class=\"title\">C</span><span class=\"params\">(<span class=\"type\">const</span> ll n, <span class=\"type\">const</span> ll m, <span class=\"type\">const</span> ll p, <span class=\"type\">const</span> ll pk)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (n &lt; m)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        ll f1 = <span class=\"built_in\">fac</span>(n, p, pk), f2 = <span class=\"built_in\">fac</span>(m, p, pk), f3 = <span class=\"built_in\">fac</span>(n - m, p, pk), cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (ll i = n; i; i /= p)</span><br><span class=\"line\">            cnt += i / p;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (ll i = m; i; i /= p)</span><br><span class=\"line\">            cnt -= i / p;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (ll i = n - m; i; i /= p)</span><br><span class=\"line\">            cnt -= i / p;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> f1 * <span class=\"built_in\">inv</span>(f2, pk) % pk * <span class=\"built_in\">inv</span>(f3, pk) % pk * <span class=\"built_in\">power</span>(p, cnt, pk) % pk;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ll a[N], c[N];</span><br><span class=\"line\">    <span class=\"type\">int</span> cnt;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">inline</span> ll <span class=\"title\">CRT</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        ll M = <span class=\"number\">1</span>, ans = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; cnt; i++)</span><br><span class=\"line\">            M *= c[i];</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; cnt; i++)</span><br><span class=\"line\">            ans = (ans + a[i] * (M / c[i]) % M * <span class=\"built_in\">inv</span>(M / c[i], c[i]) % M) % M;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">ll <span class=\"title\">exlucas</span><span class=\"params\">(<span class=\"type\">const</span> ll n, <span class=\"type\">const</span> ll m, ll p)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        ll tmp = <span class=\"built_in\">sqrt</span>(p);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">2</span>; p &gt; <span class=\"number\">1</span> &amp;&amp; i &lt;= tmp; i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            ll tmp = <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (p % i == <span class=\"number\">0</span>)</span><br><span class=\"line\">                p /= i, tmp *= i;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (tmp &gt; <span class=\"number\">1</span>)</span><br><span class=\"line\">                a[cnt] = <span class=\"built_in\">C</span>(n, m, i, tmp), c[cnt++] = tmp;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (p &gt; <span class=\"number\">1</span>)</span><br><span class=\"line\">            a[cnt] = <span class=\"built_in\">C</span>(n, m, p, p), c[cnt++] = p;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">CRT</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">work</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"literal\">false</span>);</span><br><span class=\"line\">        cin &gt;&gt; n &gt;&gt; m &gt;&gt; p;</span><br><span class=\"line\">        cout &lt;&lt; <span class=\"built_in\">exlucas</span>(n, m, p);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> zyt::<span class=\"built_in\">work</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"5-3-Catlanæ•°ä¸Fibonacciæ•°åˆ—\">5.3 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi><mi>a</mi><mi>t</mi><mi>l</mi><mi>a</mi><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">Catlan</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">tl</span><span class=\"mord mathnormal\">an</span></span></span></span>æ•°ä¸<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mi>i</mi><mi>b</mi><mi>o</mi><mi>n</mi><mi>a</mi><mi>c</mi><mi>c</mi><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">Fibonacci</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\">ib</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">na</span><span class=\"mord mathnormal\">cc</span><span class=\"mord mathnormal\">i</span></span></span></span>æ•°åˆ—</h4>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mi>n</mi></msub><mo>=</mo><mfrac><mrow><mn>2</mn><mi>n</mi><mo stretchy=\"false\">!</mo></mrow><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></mfrac><mo separator=\"true\">,</mo><mi>n</mi><mo>â‰¥</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">H_n=\\frac{2n!}{n+1},n\\ge 2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2834em;vertical-align:-0.4033em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8801em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span><span class=\"mord mathnormal mtight\">n</span><span class=\"mclose mtight\">!</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4033em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>ï¼Œç»´æŠ¤ä¸€ç§ç»å¯¹å¤§äºç­‰äºçš„å…³ç³»ï¼Œæ¯”å¦‚å›ºå®šå…¥æ ˆé¡ºåºï¼Œæœ‰å¤šå°‘ç§å‡ºæ ˆé¡ºåºï¼ˆä¿è¯æ ˆå†…å…ƒç´ æ•°é‡ä¸€å®šå¤§äºç­‰äºæ€»å‡ºæ ˆå…ƒç´ æ•°é‡ï¼‰â€‹</p>\n<p>æ•°åˆ—çš®äºšè¯ºå‘¨æœŸä¸è¶…è¿‡<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>6</mn><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">6k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord\">6</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>â€‹ä¸ºæ¨¡æ•°ã€‚å¼ºè¡Œè§£å‘¨æœŸå¯ä»¥è€ƒè™‘çŸ©é˜µåŸæ ¹è®¡ç®—ï¼Œå› ä¸ºçŸ©é˜µ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mi>o</mi><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">mod</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">d</span></span></span></span><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span></span></span></span>æœ€å°å‘¨æœŸæ˜¯çš®äºšè¯ºå‘¨æœŸï¼Œæ‰€ä»¥æ ¹å·å¼€<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msqrt><mrow><mn>6</mn><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msqrt></mrow><annotation encoding=\"application/x-tex\">\\sqrt {6k+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.04em;vertical-align:-0.1494em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8906em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\">6</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-2.8506em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"1.08em\" viewBox=\"0 0 400000 1080\" preserveAspectRatio=\"xMinYMin slice\"><path d=\"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z\"/></svg></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1494em;\"><span></span></span></span></span></span></span></span></span>.</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> umap unordered_map</span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"type\">long</span> <span class=\"type\">long</span> ll;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"type\">unsigned</span> <span class=\"type\">long</span> <span class=\"type\">long</span> ull;</span><br><span class=\"line\"></span><br><span class=\"line\">string S;</span><br><span class=\"line\">ll MOD;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> L = <span class=\"number\">2</span>;</span><br><span class=\"line\"><span class=\"type\">const</span> ull BASE = <span class=\"number\">13331</span>;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">Matrix</span> &#123;</span><br><span class=\"line\">    ll M[L<span class=\"number\">+1</span>][L<span class=\"number\">+1</span>];</span><br><span class=\"line\">    ll *<span class=\"keyword\">operator</span>[](<span class=\"type\">int</span> p) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> M[p];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">clear</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">memset</span>(M, <span class=\"number\">0</span>, <span class=\"keyword\">sizeof</span> M);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">reset</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">clear</span>();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= L; i++)</span><br><span class=\"line\">            M[i][i] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    Matrix <span class=\"keyword\">friend</span> <span class=\"keyword\">operator</span>*(Matrix A, Matrix B) &#123;</span><br><span class=\"line\">        Matrix C; C.<span class=\"built_in\">clear</span>();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= L; i++)</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> k = <span class=\"number\">1</span>; k &lt;= L; k++)</span><br><span class=\"line\">                <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">1</span>; j &lt;= L; j++)</span><br><span class=\"line\">                    (C[i][j] += A[i][k] * B[k][j] % MOD) %= MOD;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> C;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">ull <span class=\"title\">hs</span><span class=\"params\">()</span> </span>&#123; <span class=\"comment\">// hash</span></span><br><span class=\"line\">        ull ret = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= L; i++)</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">1</span>; j &lt;= L; j++)</span><br><span class=\"line\">                ret = ret * BASE + M[i][j];</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ret;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"function\">Matrix <span class=\"title\">qpow</span><span class=\"params\">(Matrix A, ll b)</span> </span>&#123;</span><br><span class=\"line\">    Matrix Ret; Ret.<span class=\"built_in\">reset</span>();</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (b) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (b &amp; <span class=\"number\">1</span>)</span><br><span class=\"line\">            Ret = Ret * A;</span><br><span class=\"line\">        A = A * A;</span><br><span class=\"line\">        b &gt;&gt;= <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> Ret;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">BSGS</span><span class=\"params\">(Matrix A, Matrix B)</span> </span>&#123;</span><br><span class=\"line\">    umap&lt;ull, ll&gt; mp;</span><br><span class=\"line\">    ll t = <span class=\"built_in\">sqrt</span>(MOD * <span class=\"number\">6</span>) + <span class=\"number\">1</span>;</span><br><span class=\"line\">    Matrix Cur; Cur.<span class=\"built_in\">reset</span>();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (ll i = <span class=\"number\">1</span>; i &lt;= t; i++) &#123;</span><br><span class=\"line\">        mp[(Cur * B).<span class=\"built_in\">hs</span>()] = i<span class=\"number\">-1</span>;</span><br><span class=\"line\">        Cur = A * Cur;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    Matrix Cur2 = Cur;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (ll i = <span class=\"number\">1</span>; i &lt;= t; i++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (mp.<span class=\"built_in\">find</span>(Cur<span class=\"number\">2.</span><span class=\"built_in\">hs</span>()) != mp.<span class=\"built_in\">end</span>())</span><br><span class=\"line\">            <span class=\"keyword\">return</span> i * t - mp[Cur<span class=\"number\">2.</span><span class=\"built_in\">hs</span>()];</span><br><span class=\"line\">        Cur2 = Cur * Cur2;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Matrix A, I;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">init</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    A[<span class=\"number\">1</span>][<span class=\"number\">1</span>] = <span class=\"number\">1</span>; A[<span class=\"number\">1</span>][<span class=\"number\">2</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    A[<span class=\"number\">2</span>][<span class=\"number\">1</span>] = <span class=\"number\">1</span>; A[<span class=\"number\">2</span>][<span class=\"number\">2</span>] = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    I[<span class=\"number\">1</span>][<span class=\"number\">1</span>] = <span class=\"number\">1</span>; I[<span class=\"number\">1</span>][<span class=\"number\">2</span>] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    I[<span class=\"number\">2</span>][<span class=\"number\">1</span>] = <span class=\"number\">0</span>; I[<span class=\"number\">2</span>][<span class=\"number\">2</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">fib</span><span class=\"params\">(ll n)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (n == <span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">qpow</span>(A, n<span class=\"number\">-1</span>)[<span class=\"number\">1</span>][<span class=\"number\">1</span>];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123; ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>); cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin &gt;&gt; S &gt;&gt; MOD;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (MOD == <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        cout &lt;&lt; <span class=\"number\">0</span> &lt;&lt; endl;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">init</span>();</span><br><span class=\"line\">    ll pi = <span class=\"built_in\">BSGS</span>(A, I);</span><br><span class=\"line\">    ll n = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> c : S)</span><br><span class=\"line\">        n = (n * <span class=\"number\">10</span> + (c - <span class=\"string\">&#x27;0&#x27;</span>)) % pi;</span><br><span class=\"line\">    cout &lt;&lt; <span class=\"built_in\">fib</span>(n) &lt;&lt; endl;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>æŸ¥<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mi>I</mi><mo>âˆ’</mo><mi>W</mi><mi>i</mi><mi>k</mi><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">OI-Wiki</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">Wiki</span></span></span></span>â€‹</p>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"6-ä½è¿ç®—ç›¸å…³æŠ€å·§æ‚è°ˆ\">6. ä½è¿ç®—ç›¸å…³æŠ€å·§æ‚è°ˆ</h3>\n<ol>\n<li>å¼‚æˆ–æ˜¯ç‰¹æ®Šçš„çŸ©é˜µåŠ æ³•ï¼Œåœ¨<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>&lt;</mo><msubsup><mi>Z</mi><mn>2</mn><mi>n</mi></msubsup><mo separator=\"true\">,</mo><mi>x</mi><mi>o</mi><mi>r</mi><mo separator=\"true\">,</mo><mi>a</mi><mi>n</mi><mi>d</mi><mo>&gt;</mo></mrow><annotation encoding=\"application/x-tex\">&lt;Z_2^n,xor,and&gt;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9425em;vertical-align:-0.2481em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-2.4519em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">or</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">an</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span></span></span></span>ä¸‹ã€‚</li>\n<li>è¿ç»­ä»<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>åˆ°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>çš„å¼‚æˆ–å’Œæ˜¯æœ‰è§„å¾‹çš„ï¼Œå¯¹äºæ¨¡<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>å‰©ä½™ä¸‹æœ‰ä½™<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>å¾—<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>ï¼Œä½™<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>å¾—<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">n+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>ï¼Œä½™<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span></span></span></span>å¾—<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>ï¼Œä½™<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>å¾—<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>â€‹.</li>\n<li>åŒºé—´å¼‚æˆ–å’Œå¯è¡¨ç¤ºä¸¤ä¸ªå‰ç¼€å¼‚æˆ–çš„å¼‚æˆ–å’Œã€‚</li>\n<li>å¸¦é€’å½’å½¢å¼çš„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mfrac><mi>x</mi><mn>3</mn></mfrac><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(x)=f(\\frac{x}{3})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.095em;vertical-align:-0.345em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6954em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">)</span></span></span></span>ç­‰ä¹‹ç±»çš„å…³æ³¨ä½è¿ç®—è¿›åˆ¶è¡¨ç¤ºè§„å¾‹ã€‚</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo>+</mo><mi>b</mi><mo>=</mo><mn>2</mn><mo stretchy=\"false\">(</mo><mi>a</mi><mi mathvariant=\"normal\">&amp;</mi><mi>b</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mo stretchy=\"false\">(</mo><mi>a</mi><mo>âŠ•</mo><mi>b</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">a+b=2(a\\&amp;b)+(a\\oplus b)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">2</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mord\">&amp;</span><span class=\"mord mathnormal\">b</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âŠ•</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mclose\">)</span></span></span></span></li>\n</ol>\n<div style=\"page-break-after: always;\"></div>\n<h1>Part 3. æ‚é¡¹æŠ€å·§</h1>\n<h3 id=\"3-1-æ™®é€šè«é˜Ÿ\">3.1 æ™®é€šè«é˜Ÿ</h3>\n<p>å‡è®¾<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">n=m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>,é‚£ä¹ˆå¯¹äºåºåˆ—ä¸Šçš„åŒºé—´è¯¢é—®é—®é¢˜,å¦‚æœä»<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[l,r]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">]</span></span></span></span>çš„ç­”æ¡ˆèƒ½å¤Ÿ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>æ‰©å±•åˆ°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>l</mi><mo>âˆ’</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">]</mo><mo separator=\"true\">,</mo><mo stretchy=\"false\">[</mo><mi>l</mi><mo>+</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">]</mo><mo separator=\"true\">,</mo><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">]</mo><mo separator=\"true\">,</mo><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[l-1,r],[l+1,r],[l,r+1],[l,r-1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">]</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">]</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>ï¼ˆå³ä¸<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[l,r]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">]</span></span></span></span>ç›¸é‚»çš„åŒºé—´ï¼‰çš„ç­”æ¡ˆ,é‚£ä¹ˆå¯ä»¥åœ¨<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><msqrt><mi>n</mi></msqrt><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n\\sqrt n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0503em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8003em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"padding-left:0.833em;\">n</span></span><span style=\"top:-2.7603em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"1.08em\" viewBox=\"0 0 400000 1080\" preserveAspectRatio=\"xMinYMin slice\"><path d=\"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z\"/></svg></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2397em;\"><span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>â€‹çš„å¤æ‚åº¦å†…æ±‚å‡ºæ‰€æœ‰è¯¢é—®çš„ç­”æ¡ˆã€‚</p>\n<p>è«é˜Ÿéœ€è¦ç›¸å½“ç‰›é€¼çš„å¡å¸¸ï¼ŒåŸºæœ¬ä¸Šç¦ç”¨ä¸€åˆ‡<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mi>a</mi><mi>p</mi><mi>S</mi><mi>T</mi><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">mapSTL</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">ma</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">pST</span><span class=\"mord mathnormal\">L</span></span></span></span>ï¼Œå®åœ¨å¿…è¦éœ€è¦æ‰‹æ“å“ˆå¸Œè¡¨ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> i64 long long</span></span><br><span class=\"line\"><span class=\"type\">int</span> block; <span class=\"comment\">// è«é˜Ÿåˆ†å—å¤§å°</span></span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">node</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> l, r, id;</span><br><span class=\"line\">    <span class=\"type\">bool</span> <span class=\"keyword\">operator</span>&lt;(<span class=\"type\">const</span> node &amp;x) <span class=\"type\">const</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (l / block != x.l / block)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> l &lt; x.l;</span><br><span class=\"line\">        <span class=\"comment\">// æ³¨æ„ä¸‹é¢ä¸¤è¡Œä¸èƒ½å†™å°äºï¼ˆå¤§äºï¼‰ç­‰äºï¼Œå¦åˆ™ä¼šå‡ºé”™ï¼ˆè¯¦è§ä¸‹é¢çš„å°ç»†èŠ‚ï¼‰</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> ((l / block) &amp; <span class=\"number\">1</span>)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> r &lt; x.r;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> r &gt; x.r;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"type\">int</span> sum = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">2e5</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> inf = <span class=\"number\">1e6</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> mp[inf];</span><br><span class=\"line\"><span class=\"type\">int</span> a[maxn];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"type\">int</span> pos)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (mp[a[pos]])</span><br><span class=\"line\">        sum--;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        sum++;</span><br><span class=\"line\">    mp[a[pos]] ^= <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">del</span><span class=\"params\">(<span class=\"type\">int</span> pos)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (mp[a[pos]])</span><br><span class=\"line\">        sum--;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        sum++;</span><br><span class=\"line\">    mp[a[pos]] ^= <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"type\">int</span> n;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">solve</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    sum = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> n, q;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; q;</span><br><span class=\"line\">    block = <span class=\"built_in\">sqrt</span>(n);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cin &gt;&gt; a[i];</span><br><span class=\"line\">        mp[a[i]] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    vector&lt;node&gt; qs;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; q; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> l, r;</span><br><span class=\"line\">        cin &gt;&gt; l &gt;&gt; r;</span><br><span class=\"line\">        qs.<span class=\"built_in\">push_back</span>(&#123;l, r, i&#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">ans</span><span class=\"params\">(q)</span></span>;</span><br><span class=\"line\">    <span class=\"built_in\">sort</span>(qs.<span class=\"built_in\">begin</span>(), qs.<span class=\"built_in\">end</span>());</span><br><span class=\"line\">    <span class=\"type\">int</span> l = <span class=\"number\">1</span>, r = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; q; i++)<span class=\"comment\">//è«é˜Ÿç®—æ³•çµé­‚</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (l &gt; qs[i].l)</span><br><span class=\"line\">            <span class=\"built_in\">add</span>(--l);</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (r &lt; qs[i].r)</span><br><span class=\"line\">            <span class=\"built_in\">add</span>(++r);</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (l &lt; qs[i].l)</span><br><span class=\"line\">            <span class=\"built_in\">del</span>(l++);</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (r &gt; qs[i].r)</span><br><span class=\"line\">            <span class=\"built_in\">del</span>(r--);</span><br><span class=\"line\">        ans[qs[i].id] = sum;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; q; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (ans[i])</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            cout &lt;&lt; <span class=\"string\">&quot;NO&quot;</span> &lt;&lt; endl;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">            cout &lt;&lt; <span class=\"string\">&quot;YES&quot;</span> &lt;&lt; endl;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"type\">int</span> t;</span><br><span class=\"line\">    cin &gt;&gt; t;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (t--)</span><br><span class=\"line\">        <span class=\"built_in\">solve</span>();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"3-2-å¸¦ä¿®æ”¹è«é˜Ÿ\">3.2 å¸¦ä¿®æ”¹è«é˜Ÿ</h3>\n<p>æ™®é€šè«é˜Ÿç®—æ³•ä¸æ”¯æŒä¿®æ”¹ï¼Œéœ€è¦å¸¦ä¿®æ”¹çš„è«é˜Ÿã€‚å¸¦ä¿®æ”¹è«é˜Ÿå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯åŠ ä¸Šäº†ä¸€ä¸ªæ—¶é—´æˆ³ç»´åº¦ï¼Œå˜æˆäº†å¤šç»´è«é˜Ÿã€‚</p>\n<p>ç„¶åè·³æ—¶é—´æˆ³å°±è¡Œäº†ï¼Œæ”¹å°‘äº†å°±å¤šæ”¹ï¼Œæ”¹å¤šäº†å°±æ”¹å›å»ã€‚</p>\n<p>æ³¨æ„ï¼Œå¸¦ä¿®æ”¹è«é˜Ÿå¸¸æ•°è¾ƒå¤§ï¼Œåˆ†å—<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>n</mi><mfrac><mn>2</mn><mn>3</mn></mfrac></msup></mrow><annotation encoding=\"application/x-tex\">n^{\\frac{2}{3}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.954em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.954em;\"><span style=\"top:-3.363em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mopen nulldelimiter sizing reset-size3 size6\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8443em;\"><span style=\"top:-2.656em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span><span style=\"top:-3.2255em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line mtight\" style=\"border-bottom-width:0.049em;\"></span></span><span style=\"top:-3.384em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.344em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter sizing reset-size3 size6\"></span></span></span></span></span></span></span></span></span></span></span></span></span>ï¼Œæ—¶é—´å¤æ‚åº¦<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mfrac><mn>5</mn><mn>3</mn></mfrac></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n^{\\frac{5}{3}})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.204em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.954em;\"><span style=\"top:-3.363em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mopen nulldelimiter sizing reset-size3 size6\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8443em;\"><span style=\"top:-2.656em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span><span style=\"top:-3.2255em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line mtight\" style=\"border-bottom-width:0.049em;\"></span></span><span style=\"top:-3.384em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">5</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.344em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter sizing reset-size3 size6\"></span></span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>ï¼Œä¸è¦å¸¦å¥‡å¶æ’åºâ€‹</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">using</span> i64 = <span class=\"type\">long</span> <span class=\"type\">long</span>;</span><br><span class=\"line\"><span class=\"type\">const</span> i64 mod = <span class=\"number\">998244353</span>;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> endl <span class=\"string\">&#x27;\\n&#x27;</span></span></span><br><span class=\"line\"><span class=\"type\">int</span> block;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">qnode</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> l, r, id, t;</span><br><span class=\"line\">    <span class=\"type\">bool</span> <span class=\"keyword\">operator</span>&lt;(<span class=\"type\">const</span> qnode &amp;x) <span class=\"type\">const</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (l / block != x.l / block)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> l &lt; x.l;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (r / block != x.r / block)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> r &lt; x.r;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> t &lt; x.t;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">vector&lt;array&lt;<span class=\"type\">int</span>, 2&gt;&gt; <span class=\"built_in\">upd</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\"><span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">mp</span><span class=\"params\">(<span class=\"number\">1e7</span>)</span></span>;</span><br><span class=\"line\"><span class=\"type\">int</span> sum = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"type\">int</span> x)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    mp[x]++;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (mp[x] == <span class=\"number\">1</span>)</span><br><span class=\"line\">        sum++;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">del</span><span class=\"params\">(<span class=\"type\">int</span> x)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    mp[x]--;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (mp[x] == <span class=\"number\">0</span>)</span><br><span class=\"line\">        sum--;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">solve</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n, q;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; q;</span><br><span class=\"line\">    <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">a</span><span class=\"params\">(n)</span></span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++)</span><br><span class=\"line\">        cin &gt;&gt; a[i];</span><br><span class=\"line\">    block = <span class=\"built_in\">pow</span>(n, <span class=\"number\">2.0</span> / <span class=\"number\">3</span>);</span><br><span class=\"line\">    vector&lt;qnode&gt; query;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>, cnt = <span class=\"number\">0</span>; i &lt; q; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">char</span> op;</span><br><span class=\"line\">        cin &gt;&gt; op;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (op == <span class=\"string\">&#x27;Q&#x27;</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> l, r;</span><br><span class=\"line\">            cin &gt;&gt; l &gt;&gt; r;</span><br><span class=\"line\">            query.<span class=\"built_in\">emplace_back</span>((qnode)&#123;l - <span class=\"number\">1</span>, r - <span class=\"number\">1</span>, cnt, upd.<span class=\"built_in\">size</span>() - <span class=\"number\">1</span>&#125;);</span><br><span class=\"line\">            cnt++;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> x, y;</span><br><span class=\"line\">            cin &gt;&gt; x &gt;&gt; y;</span><br><span class=\"line\">            upd.<span class=\"built_in\">push_back</span>(&#123;x - <span class=\"number\">1</span>, y&#125;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">ans</span><span class=\"params\">(query.size())</span></span>;</span><br><span class=\"line\">    <span class=\"built_in\">sort</span>(query.<span class=\"built_in\">begin</span>(), query.<span class=\"built_in\">end</span>());</span><br><span class=\"line\">    <span class=\"type\">int</span> l = <span class=\"number\">0</span>, r = <span class=\"number\">-1</span>, t = <span class=\"number\">0</span>;</span><br><span class=\"line\">    stack&lt;array&lt;<span class=\"type\">int</span>, 2&gt;&gt; stk;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> &amp;i : query)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (l &gt; i.l)</span><br><span class=\"line\">            <span class=\"built_in\">add</span>(a[--l]);</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (r &lt; i.r)</span><br><span class=\"line\">            <span class=\"built_in\">add</span>(a[++r]);</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (l &lt; i.l)</span><br><span class=\"line\">            <span class=\"built_in\">del</span>(a[l++]);</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (r &gt; i.r)</span><br><span class=\"line\">            <span class=\"built_in\">del</span>(a[r--]);</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (t &lt; i.t)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            t++;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (l &lt;= upd[t][<span class=\"number\">0</span>] &amp;&amp; upd[t][<span class=\"number\">0</span>] &lt;= r)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"built_in\">del</span>(a[upd[t][<span class=\"number\">0</span>]]);</span><br><span class=\"line\">                <span class=\"built_in\">add</span>(upd[t][<span class=\"number\">1</span>]);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            stk.<span class=\"built_in\">push</span>(&#123;upd[t][<span class=\"number\">0</span>], a[upd[t][<span class=\"number\">0</span>]]&#125;);</span><br><span class=\"line\">            a[upd[t][<span class=\"number\">0</span>]] = upd[t][<span class=\"number\">1</span>];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (t &gt; i.t)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (l &lt;= upd[t][<span class=\"number\">0</span>] &amp;&amp; upd[t][<span class=\"number\">0</span>] &lt;= r)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"built_in\">del</span>(a[upd[t][<span class=\"number\">0</span>]]);</span><br><span class=\"line\">                <span class=\"built_in\">add</span>(stk.<span class=\"built_in\">top</span>()[<span class=\"number\">1</span>]);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            a[upd[t][<span class=\"number\">0</span>]] = stk.<span class=\"built_in\">top</span>()[<span class=\"number\">1</span>];</span><br><span class=\"line\">            stk.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">            t--;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        ans[i.id] = sum;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> i : ans)</span><br><span class=\"line\">        cout &lt;&lt; i &lt;&lt; endl;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"type\">int</span> t = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"comment\">// cin &gt;&gt; t;</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> (t--)</span><br><span class=\"line\">        <span class=\"built_in\">solve</span>();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"3-3-æ ‘ä¸Šè«é˜Ÿ\">3.3 æ ‘ä¸Šè«é˜Ÿ</h3>\n<p>ç»™å®šä¸€ä¸ª<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹è¡¨ç¤ºä¸€ä¸ªæ•´æ•°ï¼Œé—®<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>åˆ°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>çš„è·¯å¾„ä¸Šæœ‰å¤šå°‘ä¸ªä¸åŒçš„æ•´æ•°ã€‚</p>\n<p>è½¬æˆæ¬§æ‹‰åºåŒºé—´é—®é¢˜ã€‚</p>\n<p>å…·ä½“åšæ³•ï¼šè®¾æ¯ä¸ªç‚¹çš„ç¼–å·<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>é¦–æ¬¡å‡ºç°çš„ä½ç½®<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mi>i</mi><mi>r</mi><mi>s</mi><mi>t</mi><mo stretchy=\"false\">[</mo><mi>a</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">first[a]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">rs</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">]</span></span></span></span>ï¼Œæœ€åå‡ºç°çš„ä½ç½®ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mi>a</mi><mi>s</mi><mi>t</mi><mo stretchy=\"false\">[</mo><mi>a</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">last[a]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">]</span></span></span></span>ï¼Œé‚£ä¹ˆå¯¹äºè·¯å¾„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>â†’</mo><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">xâ†’y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â†’</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>ï¼Œè®¾<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mi>i</mi><mi>r</mi><mi>s</mi><mi>t</mi><mo stretchy=\"false\">[</mo><mi>x</mi><mo stretchy=\"false\">]</mo><mo>â‰¤</mo><mi>f</mi><mi>i</mi><mi>r</mi><mi>s</mi><mi>t</mi><mo stretchy=\"false\">[</mo><mi>y</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">first[x]\\le first[y]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">rs</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">rs</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">]</span></span></span></span>ï¼ˆä¸æ»¡è¶³åˆ™<code>swap</code>ï¼Œè¿™ä¸ªæ“ä½œçš„æ„ä¹‰åœ¨äºï¼Œå¦‚æœ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>ã€<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>åœ¨ä¸€æ¡é“¾ä¸Šï¼Œåˆ™<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>ä¸€å®šæ˜¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>çš„ç¥–å…ˆæˆ–ç­‰äº<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>ï¼‰ï¼Œå¦‚æœ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mi>c</mi><mi>a</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">lca(x,y)=x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">a</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>ï¼Œåˆ™ç›´æ¥æŠŠ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>f</mi><mi>i</mi><mi>r</mi><mi>s</mi><mi>t</mi><mo stretchy=\"false\">[</mo><mi>x</mi><mo stretchy=\"false\">]</mo><mo separator=\"true\">,</mo><mi>f</mi><mi>i</mi><mi>r</mi><mi>s</mi><mi>t</mi><mo stretchy=\"false\">[</mo><mi>y</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[first[x],first[y]]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">rs</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">rs</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">]]</span></span></span></span>çš„åŒºé—´æ‰¯è¿‡æ¥ç”¨ï¼Œåä¹‹ä½¿ç”¨<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>l</mi><mi>a</mi><mi>s</mi><mi>t</mi><mo stretchy=\"false\">[</mo><mi>x</mi><mo stretchy=\"false\">]</mo><mo separator=\"true\">,</mo><mi>f</mi><mi>i</mi><mi>r</mi><mi>s</mi><mi>t</mi><mo stretchy=\"false\">[</mo><mi>y</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[last[x],first[y]]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">rs</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">]]</span></span></span></span>åŒºé—´ï¼Œä½†è¿™ä¸ªåŒºé—´å†…ä¸åŒ…å«<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>å’Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>çš„æœ€è¿‘å…¬å…±ç¥–å…ˆï¼ŒæŸ¥è¯¢çš„æ—¶å€™åŠ ä¸Šå³å¯ã€‚</p>\n<div style=\"page-break-after: always;\"></div>\n<h1>Part 4. å›¾è®º</h1>\n<h2 id=\"1-æœ€çŸ­è·¯\">1. æœ€çŸ­è·¯</h2>\n<p>æœ€çŸ­è·¯ï¼Œå›¾ä¸Šé—®é¢˜ï¼Œåˆ†å±‚å›¾æœ€çŸ­è·¯ï¼Œæœ€çŸ­è·¯å½¢å¼ä¼˜åŒ–<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">dp</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">p</span></span></span></span>â€‹.</p>\n<p>æœ€çŸ­è·¯å…·æœ‰ç±»ä¼¼<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">dp</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">p</span></span></span></span>çš„æœ€ä¼˜å­ç»“æ„æ€§è´¨ï¼Œåˆ¤å®šä¸€æ¡è¾¹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>u</mi><mo separator=\"true\">,</mo><mi>v</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(u,v)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">u</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mclose\">)</span></span></span></span>å±äºæœ€çŸ­è·¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>â†’</mo><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">i\\to j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â†’</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>çš„ä¸€æ¡è¾¹ï¼Œå½“ä¸”ä»…å½“<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>i</mi><msub><mi>s</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>u</mi></mrow></msub><mo>+</mo><mi>w</mi><mo>+</mo><mi>d</mi><mi>i</mi><msub><mi>s</mi><mrow><mi>v</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub><mo>=</mo><mi>d</mi><mi>i</mi><msub><mi>s</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">dis_{i,u}+w+dis_{v,j}=dis_{i,j}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">i</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">u</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">i</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">i</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span></p>\n<h3 id=\"1-1-Dijkstra\">1.1 Dijkstra</h3>\n<p>ç¨€ç–å›¾å †ä¼˜åŒ–ï¼Œå¤æ‚åº¦<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">(</mo><mi>n</mi><mo>+</mo><mi>m</mi><mo stretchy=\"false\">)</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O((n+m)logn)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">((</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>ï¼Œåªèƒ½å¤„ç†å®Œå…¨æ­£è¾¹æƒå›¾ã€‚å¦‚æœæœ‰è´Ÿè¾¹æƒéœ€è¦å‚è€ƒè´¹ç”¨æµä¸­å¯¹å¶<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi><mi>i</mi><mi>j</mi><mi>k</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">Dijkstra</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">ijk</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">a</span></span></span></span>ï¼Œä½¿ç”¨åŠ¿èƒ½å‡½æ•°è¿›è¡Œè¯„ä¼°ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//mlogn</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;bits/stdc++.h&gt;</span><span class=\"comment\">//å¤„ç†å®Œå…¨æ­£æƒæœ‰å‘å›¾ï¼Œå¯ä»¥æœ‰ç¯</span></span></span><br><span class=\"line\"><span class=\"comment\">//å°†ç»“ç‚¹åˆ†ä¸ºä¸¤ç±»ï¼Œä¸æ–­æ¾å¼›ï¼Œä½†æ³¨æ„ç¡®å®šä¸€ä¸ªèŠ‚ç‚¹åæˆ‘ä»¬ä¾¿ä¸å†è¿›è¡Œæ›´æ–°è¿™ä¸ªèŠ‚ç‚¹äº†ï¼ˆæ‰€ä»¥è¿™æ˜¯dijçš„çŸ­è§†æ€§ï¼‰ï¼Œæ‰€ä»¥æ— æ³•å¤„ç†è´Ÿæƒï¼Œå› ä¸ºè´Ÿæƒå¯èƒ½ä¼šæ›´æ–°æˆ‘ä»¬å·²åŠ å…¥çš„èŠ‚ç‚¹ã€‚</span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> N=<span class=\"number\">1e5</span><span class=\"number\">+2</span>;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> inf=<span class=\"number\">0x3f3f3f3f</span>;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"type\">long</span> <span class=\"type\">long</span> ll;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> pair&lt;<span class=\"type\">int</span>,<span class=\"type\">int</span>&gt; P;</span><br><span class=\"line\"><span class=\"type\">int</span> n,m,s,u,v,sum;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">node</span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> to,val;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">vector&lt;vector&lt;node&gt; &gt;edge;</span><br><span class=\"line\"><span class=\"type\">int</span> dis[N],vis[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">dijkstra</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">memset</span>(dis,inf,<span class=\"built_in\">sizeof</span>(dis));<span class=\"comment\">//åˆå§‹åŒ–</span></span><br><span class=\"line\">    dis[s]=<span class=\"number\">0</span>;</span><br><span class=\"line\">    priority_queue&lt;P,vector&lt;P&gt;,greater&lt;P&gt;&gt;q;<span class=\"comment\">//å°æ ¹å †å¯åŠ¨</span></span><br><span class=\"line\">    q.<span class=\"built_in\">push</span>(&#123;<span class=\"number\">0</span>,s&#125;);<span class=\"comment\">//è·ç¦»åœ¨å‰ï¼Œç‚¹åœ¨åï¼Œå› ä¸ºpairé»˜è®¤å…ˆæ’å‰é¢çš„</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span>(!q.<span class=\"built_in\">empty</span>())&#123;</span><br><span class=\"line\">        P k=q.<span class=\"built_in\">top</span>();q.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(vis[k.second])<span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        vis[k.second]=<span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> j:edge[k.second])&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(dis[j.to]&gt;dis[k.second]+j.val)&#123;</span><br><span class=\"line\">                dis[j.to]=<span class=\"built_in\">min</span>(dis[j.to],dis[k.second]+j.val);</span><br><span class=\"line\">                q.<span class=\"built_in\">push</span>(&#123;dis[j.to],j.to&#125;);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; </span><br><span class=\"line\">        <span class=\"comment\">//å¯¹æ‰€æœ‰ç›¸é‚»é¡¶ç‚¹è¿›è¡Œæ¾å¼›ï¼Œdisæ˜¯åˆ°æºç‚¹çš„è·ç¦»</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    cin&gt;&gt;n&gt;&gt;m&gt;&gt;s;</span><br><span class=\"line\">    edge.<span class=\"built_in\">resize</span>(n<span class=\"number\">+1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=m;i++)&#123;</span><br><span class=\"line\">        cin&gt;&gt;u&gt;&gt;v&gt;&gt;sum;</span><br><span class=\"line\">        edge[u].<span class=\"built_in\">push_back</span>(&#123;v,sum&#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">dijkstra</span>();</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!vis[i])cout&lt;&lt;(<span class=\"number\">1</span>&lt;&lt;<span class=\"number\">31</span>)<span class=\"number\">-1</span>&lt;&lt;<span class=\"string\">&quot; &quot;</span>;<span class=\"comment\">//è¯´æ˜ä¸ç›¸è¿</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span> cout&lt;&lt;dis[i]&lt;&lt;<span class=\"string\">&quot; &quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"1-2-Floyed\">1.2  Floyed</h3>\n<p>ä»¥<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mn>3</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n^3)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>çš„æ–¹å¼æš´åŠ›é¢„å¤„ç†æ‰€æœ‰çš„æœ€çŸ­è·¯ï¼Œæœ¬è´¨æ˜¯è¿é€šçŸ©é˜µçš„ä¼ é€’é—­åŒ…ã€‚é€‚åˆæ•°æ®èŒƒå›´æå°çš„å¤§é‡çš„æœ€çŸ­è·¯è¯¢é—®æ“ä½œã€‚æ›¾ç»åœ¨<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mi>t</mi><mi>c</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">Atcoder</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">er</span></span></span></span>â€‹å‡ºç°è¿‡ã€‚</p>\n<p>æš´åŠ›æšä¸¾é¡ºåºåƒä¸‡åˆ«åäº†ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\">cin&gt;&gt;n&gt;&gt;m&gt;&gt;s;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">1</span>;j&lt;=n;j++)</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(i!=j)a[i][j]=inf;<span class=\"comment\">//åˆå§‹åŒ–</span></span><br><span class=\"line\">            <span class=\"keyword\">else</span> a[i][j]=<span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=m;i++)&#123;</span><br><span class=\"line\">        cin&gt;&gt;u&gt;&gt;v&gt;&gt;sum;</span><br><span class=\"line\">        a[u][v]=<span class=\"built_in\">min</span>(a[u][v],sum);<span class=\"comment\">//åº”ä»˜é‡è¾¹</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> k=<span class=\"number\">1</span>;k&lt;=n;k++)<span class=\"comment\">//å…ˆæšä¸¾æ¯ä¸ªä¸­é—´ç‚¹ï¼Œæ¥æ›´æ–°iï¼Œjï¼Œå¿…é¡»å…ˆè¿™ä¹ˆåš</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">1</span>;j&lt;=n;j++)</span><br><span class=\"line\">                a[i][j]=<span class=\"built_in\">min</span>(a[i][j],a[i][k]+a[k][j]);<span class=\"comment\">//æ ¸å¿ƒè¿‡ç¨‹ï¼šå€ŸåŠ©æ¯ä¸ªä¸­é—´ç‚¹è¿›è¡Œæ¾å¼›æ“ä½œ</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(a[s][i]==inf)cout&lt;&lt;(<span class=\"number\">1</span>&lt;&lt;<span class=\"number\">31</span>)<span class=\"number\">-1</span>&lt;&lt;<span class=\"string\">&quot; &quot;</span>;<span class=\"comment\">//è¯´æ˜ä¸ç›¸è¿</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span> cout&lt;&lt;a[s][i]&lt;&lt;<span class=\"string\">&quot; &quot;</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"1-3-SPFA-Bellman-Ford\">1.3  SPFA/Bellman-Ford</h3>\n<p>å…³äº<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mi>P</mi><mi>F</mi><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">SPFA</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">SPF</span><span class=\"mord mathnormal\">A</span></span></span></span>â€”â€”ä»–æ­»äº†ã€‚</p>\n<p>æç«¯æ¡ä»¶ä¸‹ä¼šè¢«èŠèŠ±å›¾å¡æˆ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mi>m</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(nm)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">nm</span><span class=\"mclose\">)</span></span></span></span>çš„ç®—æ³•ã€‚å¯ä»¥ç”¨äºæ™®é€‚æ€§çš„å¸¦è´Ÿè¾¹æƒçš„å›¾ï¼Œå¯ä»¥æ£€æµ‹è´Ÿç¯ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"type\">bool</span> <span class=\"title\">spfa</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">memset</span>(dis, inf, <span class=\"built_in\">sizeof</span>(dis)); <span class=\"comment\">// åˆå§‹åŒ–</span></span><br><span class=\"line\">    <span class=\"built_in\">memset</span>(cnt, <span class=\"number\">0</span>, <span class=\"built_in\">sizeof</span>(cnt));   <span class=\"comment\">// è´Ÿç¯è®¡æ•°å™¨</span></span><br><span class=\"line\">    dis[s] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    vis[s] = <span class=\"number\">1</span>; <span class=\"comment\">// æ³¨æ„ visæ•°ç»„ä»£è¡¨åœ¨ä¸åœ¨é˜Ÿåˆ—ä¸­ï¼Œåœ¨è¿™é‡Œç‚¹æ˜¯å¯ä»¥é‡å¤å…¥é˜Ÿçš„</span></span><br><span class=\"line\">    queue&lt;<span class=\"type\">int</span>&gt; q;</span><br><span class=\"line\">    q.<span class=\"built_in\">push</span>(s);</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (!q.<span class=\"built_in\">empty</span>())</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> u = q.<span class=\"built_in\">front</span>();</span><br><span class=\"line\">        q.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">        vis[u] = <span class=\"number\">0</span>; <span class=\"comment\">// å–å‡ºé˜Ÿåˆ—ä¸­çš„å…ƒç´ ï¼Œæ•…visä¸º0</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> i : edge[u])</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (dis[i.to] &gt; dis[u] + i.val)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                cnt[i.to]++;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (cnt[i.to] &gt; n)</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">                dis[i.to] = dis[u] + i.val;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (vis[i.to] == <span class=\"number\">0</span>)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    vis[i.to] = <span class=\"number\">1</span>;</span><br><span class=\"line\">                    q.<span class=\"built_in\">push</span>(i.to);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>åˆ¤æ–­è´Ÿç¯æ–¹å¼ï¼šå½“ä¸€ä¸ªç‚¹è¢«æ¾å¼›äº†è¶…è¿‡<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>æ¬¡ï¼Œæ„å‘³ç€å…¶ä¸­ä¸€å®šæœ‰ç»è¿‡å®ƒçš„è´Ÿç¯ã€‚</p>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"1-4-å·®åˆ†çº¦æŸ\">1.4 å·®åˆ†çº¦æŸ</h3>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>r</mi></msub><mo>âˆ’</mo><msub><mi>x</mi><mi>l</mi></msub><mo>â‰¤</mo><mi>c</mi><mtext>â€…â€Š</mtext><mo>âŸº</mo><mtext>â€…â€Š</mtext><mi>a</mi><mi>d</mi><mi>d</mi><mi>E</mi><mi>d</mi><mi>g</mi><mi>e</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mo separator=\"true\">,</mo><mi>r</mi><mo separator=\"true\">,</mo><mi>c</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x_r-x_l\\le c\\iff addEdge(l,r,c)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.786em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.549em;vertical-align:-0.024em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âŸº</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">dd</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">e</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mclose\">)</span></span></span></span>ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>r</mi></msub><mo>âˆ’</mo><msub><mi>x</mi><mi>l</mi></msub><mo>â‰¥</mo><mi>c</mi><mtext>â€…â€Š</mtext><mo>âŸº</mo><mtext>â€…â€Š</mtext><mi>a</mi><mi>d</mi><mi>d</mi><mi>E</mi><mi>d</mi><mi>g</mi><mi>e</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo separator=\"true\">,</mo><mi>l</mi><mo separator=\"true\">,</mo><mo>âˆ’</mo><mi>c</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x_r-x_l\\ge c\\iff addEdge(r,l,-c)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.786em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.549em;vertical-align:-0.024em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âŸº</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">dd</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">e</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">âˆ’</span><span class=\"mord mathnormal\">c</span><span class=\"mclose\">)</span></span></span></span></p>\n<p>è·‘æœ€çŸ­è·¯æ±‚å¯è¡Œè§£å³å¯ï¼Œä½¿ç”¨<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mi>p</mi><mi>f</mi><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">Spfa</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Sp</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\">a</span></span></span></span>è·‘æœ€çŸ­è·¯ã€‚æœ‰è´Ÿç¯åˆ™æ— è§£ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> int long long</span></span><br><span class=\"line\">vector&lt;vector&lt;array&lt;<span class=\"type\">int</span>, 2&gt;&gt;&gt; con;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">addedge</span><span class=\"params\">(<span class=\"type\">int</span> x, <span class=\"type\">int</span> y, <span class=\"type\">int</span> z)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    con[x].<span class=\"built_in\">push_back</span>(&#123;y, z&#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt; dist, vis, tot;</span><br><span class=\"line\"><span class=\"type\">int</span> n, m;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">bool</span> <span class=\"title\">spfa</span><span class=\"params\">(vector&lt;<span class=\"type\">int</span>&gt; &amp;dist, <span class=\"type\">int</span> st)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    dist.<span class=\"built_in\">assign</span>(n + <span class=\"number\">1</span>, LONG_LONG_MIN / <span class=\"number\">2</span>);</span><br><span class=\"line\">    vis.<span class=\"built_in\">assign</span>(n + <span class=\"number\">1</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    tot.<span class=\"built_in\">assign</span>(n + <span class=\"number\">1</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    queue&lt;<span class=\"type\">int</span>&gt; q;</span><br><span class=\"line\">    dist[<span class=\"number\">0</span>] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    vis[<span class=\"number\">0</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    q.<span class=\"built_in\">push</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (!q.<span class=\"built_in\">empty</span>())</span><br><span class=\"line\">    &#123; <span class=\"comment\">// åˆ¤è´Ÿç¯ï¼Œçœ‹ä¸Šé¢çš„</span></span><br><span class=\"line\">        <span class=\"type\">int</span> cur = q.<span class=\"built_in\">front</span>();</span><br><span class=\"line\">        q.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">        vis[cur] = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> [v, w] : con[cur])</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (dist[cur] + w &gt; dist[v])</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                dist[v] = dist[cur] + w;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (!vis[v])</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    vis[v] = <span class=\"number\">1</span>;</span><br><span class=\"line\">                    q.<span class=\"built_in\">push</span>(v);</span><br><span class=\"line\">                    tot[v]++;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (tot[v] &gt;= n)</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class=\"line\">    con.<span class=\"built_in\">assign</span>(n + <span class=\"number\">1</span>, vector&lt;array&lt;<span class=\"type\">int</span>, <span class=\"number\">2</span>&gt;&gt;());</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= m; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> u, v, w;</span><br><span class=\"line\">        cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class=\"line\">        <span class=\"built_in\">addedge</span>(u, v, w);</span><br><span class=\"line\">        <span class=\"built_in\">addedge</span>(v, u, -w);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">        <span class=\"built_in\">addedge</span>(<span class=\"number\">0</span>, i, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">spfa</span>(dist, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">        cout &lt;&lt; dist[i] &lt;&lt; <span class=\"string\">&#x27; &#x27;</span>;</span><br><span class=\"line\">    cout &lt;&lt; <span class=\"string\">&#x27;\\n&#x27;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"1-5-åˆ†å±‚å›¾æœ€çŸ­è·¯\">1.5 åˆ†å±‚å›¾æœ€çŸ­è·¯</h3>\n<p>å¯¹äºç‰¹å®šçš„ä¸€äº›é™åˆ¶æ¡ä»¶ï¼Œå¯ä»¥é€šè¿‡æ‹†åˆ†åˆ†å±‚å›¾ï¼Œç”¨ä¸åŒå›¾å±‚è¡¨ç¤ºä¸åŒçš„çŠ¶æ€ã€‚</p>\n<h4 id=\"ç¤ºä¾‹1ï¼škæ¬¡æœºä¼šä¸æ¶ˆè€—èŠ±è´¹é€šè¿‡æŸæ¡è¾¹çš„æœ€çŸ­è·¯\">ç¤ºä¾‹1ï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>æ¬¡æœºä¼šä¸æ¶ˆè€—èŠ±è´¹é€šè¿‡æŸæ¡è¾¹çš„æœ€çŸ­è·¯</h4>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;bits/stdc++.h&gt;</span><span class=\"comment\">//è§£å†³é—®é¢˜ï¼šæˆ‘ä»¬æœ‰kæ¬¡æœºä¼š0ä»£ä»·çš„é€šè¿‡æŸæ¡è·¯ä¸‹çš„æœ€çŸ­è·¯</span></span></span><br><span class=\"line\"><span class=\"comment\">//åˆ†å±‚å›¾ï¼šå½“æˆ‘ä»¬ä½¿ç”¨ä¸€æ¬¡æœºä¼šæ—¶ï¼Œç›¸å½“äºæˆ‘ä»¬è¿›å…¥ä¸‹ä¸€å¼ å›¾</span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> N=<span class=\"number\">2</span>*<span class=\"number\">1e5</span><span class=\"number\">+2</span>;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> inf=<span class=\"number\">0x3f3f3f3f</span>;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> pair&lt;<span class=\"type\">int</span>,<span class=\"type\">int</span>&gt; P;</span><br><span class=\"line\"><span class=\"type\">int</span> n,m,k,s,t,u,v,sum;</span><br><span class=\"line\">vector&lt;P&gt;edge[N];</span><br><span class=\"line\"><span class=\"type\">int</span> dis[N],vis[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">dijkstra</span><span class=\"params\">()</span></span>&#123;<span class=\"comment\">//å¸¸è§„ä¸å¿…å†è¯´</span></span><br><span class=\"line\">    <span class=\"built_in\">memset</span>(dis,inf,<span class=\"built_in\">sizeof</span>(dis));</span><br><span class=\"line\">    dis[s]=<span class=\"number\">0</span>;</span><br><span class=\"line\">    priority_queue&lt;P,vector&lt;P&gt;,greater&lt;P&gt;&gt;q;</span><br><span class=\"line\">    q.<span class=\"built_in\">push</span>(&#123;<span class=\"number\">0</span>,s&#125;);</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(!q.<span class=\"built_in\">empty</span>())&#123;</span><br><span class=\"line\">        P k=q.<span class=\"built_in\">top</span>();q.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(vis[k.second])<span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        vis[k.second]=<span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> j:edge[k.second])dis[j.first]=<span class=\"built_in\">min</span>(dis[j.first],dis[k.second]+j.second),q.<span class=\"built_in\">push</span>(&#123;dis[j.first],j.first&#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    cin&gt;&gt;n&gt;&gt;m&gt;&gt;k&gt;&gt;s&gt;&gt;t;</span><br><span class=\"line\">    s++;t++;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=m;i++)&#123;</span><br><span class=\"line\">        cin&gt;&gt;u&gt;&gt;v&gt;&gt;sum;</span><br><span class=\"line\">        u++;v++;</span><br><span class=\"line\">        edge[u].<span class=\"built_in\">push_back</span>(&#123;v,sum&#125;);<span class=\"comment\">//åŸå§‹å±‚</span></span><br><span class=\"line\">        edge[v].<span class=\"built_in\">push_back</span>(&#123;u,sum&#125;);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">1</span>;j&lt;=k;j++)&#123;<span class=\"comment\">//ä¸€å…±æœ‰k+1å±‚ï¼ŒæŸä¸ªç‚¹åœ¨æ¯ä¸ªå±‚sï¼Œs+n,s+2n,...,s+kn</span></span><br><span class=\"line\">            edge[u+j*n].<span class=\"built_in\">push_back</span>(&#123;v+j*n,sum&#125;);<span class=\"comment\">//æ¯ä¸ªå±‚éƒ½æ˜¯ä¸€æ ·çš„</span></span><br><span class=\"line\">            edge[v+j*n].<span class=\"built_in\">push_back</span>(&#123;u+j*n,sum&#125;);</span><br><span class=\"line\">            edge[v+(j<span class=\"number\">-1</span>)*n].<span class=\"built_in\">push_back</span>(&#123;u+j*n,<span class=\"number\">0</span>&#125;);<span class=\"comment\">//ä½¿ç”¨ç‰¹æƒï¼šå³æ¢å±‚</span></span><br><span class=\"line\">            edge[u+(j<span class=\"number\">-1</span>)*n].<span class=\"built_in\">push_back</span>(&#123;v+j*n,<span class=\"number\">0</span>&#125;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=k;i++)edge[t+(i<span class=\"number\">-1</span>)*n].<span class=\"built_in\">push_back</span>(&#123;t+i*n,<span class=\"number\">0</span>&#125;);<span class=\"comment\">//æŠŠç»ˆç‚¹ä»ä¸Šåˆ°å°è¿èµ·æ¥ï¼Œè¿™æ ·å³ä½¿æ²¡æœ‰ç”¨å®Œnæ¬¡æœºä¼šæˆ‘ä»¬ä¹Ÿæ˜¯ä»t+nkä¸­è¯»ç­”æ¡ˆ</span></span><br><span class=\"line\">    <span class=\"built_in\">dijkstra</span>();<span class=\"comment\">//æ­£å¸¸è·‘æœ€çŸ­è·¯</span></span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d&quot;</span>,dis[t+k*n]);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"ç¤ºä¾‹2ï¼šåœ°é“æ¢ä¹˜é—®é¢˜\">ç¤ºä¾‹2ï¼šåœ°é“æ¢ä¹˜é—®é¢˜</h4>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//ååœ°é“é—®é¢˜ï¼šä¸€å…±mæ¡çº¿è·¯ï¼Œnä¸ªåœ°é“ç«™ï¼Œæœ‰æ¢ä¹˜ç­‰é—®é¢˜ï¼Œé‚£å°±å»ºm+1*nä¸ªç‚¹ï¼Œåœ¨5e5å·¦å³ï¼Œå› ä¸ºæ¯å±‚å›¾ä¹‹é—´çš„è¾¹æƒä¸åŒæ‰€ä»¥è¦æŠŠç«™ç‚¹æ‹†å¼€æˆmä¸ªï¼Œå†å»ºç«‹è™šå±‚è¿æ¥ä¸åŒå±‚ä»£è¡¨æ¨¡æ‹Ÿæ¢ä¹˜çš„è¿‡ç¨‹</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;iostream&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;cstring&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;queue&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> N = <span class=\"number\">510000</span>,INF = <span class=\"number\">0x3f3f3f3f</span>;  <span class=\"comment\">//æ³¨æ„æ•°æ®èŒƒå›´</span></span><br><span class=\"line\"><span class=\"keyword\">typedef</span> pair&lt;<span class=\"type\">int</span>,<span class=\"type\">int</span>&gt; P;</span><br><span class=\"line\"><span class=\"type\">int</span> n,m,s,t;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">node</span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> to,val;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">vector&lt;node&gt;edge[N];</span><br><span class=\"line\"><span class=\"type\">int</span> dis[N],vis[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"type\">int</span> u,<span class=\"type\">int</span> v,<span class=\"type\">int</span> w)</span> <span class=\"comment\">//åŠ è¾¹å‡½æ•°</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//cout&lt;&lt;u&lt;&lt;&quot; &quot;&lt;&lt;v&lt;&lt;&quot; &quot;&lt;&lt;w&lt;&lt;endl;</span></span><br><span class=\"line\">    edge[u].<span class=\"built_in\">push_back</span>(&#123;v,w&#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">dijkstra</span><span class=\"params\">(<span class=\"type\">int</span> s)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">memset</span>(dis,INF,<span class=\"built_in\">sizeof</span>(dis));<span class=\"comment\">//åˆå§‹åŒ–</span></span><br><span class=\"line\">    dis[s]=<span class=\"number\">0</span>;</span><br><span class=\"line\">    priority_queue&lt;P,vector&lt;P&gt;,greater&lt;P&gt;&gt;q;<span class=\"comment\">//å°æ ¹å †å¯åŠ¨</span></span><br><span class=\"line\">    q.<span class=\"built_in\">push</span>(&#123;<span class=\"number\">0</span>,s&#125;);<span class=\"comment\">//è·ç¦»åœ¨å‰ï¼Œç‚¹åœ¨åï¼Œå› ä¸ºpairé»˜è®¤å…ˆæ’å‰é¢çš„</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span>(!q.<span class=\"built_in\">empty</span>())&#123;</span><br><span class=\"line\">        P k=q.<span class=\"built_in\">top</span>();q.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(vis[k.second])<span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        vis[k.second]=<span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> j:edge[k.second])&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(dis[j.to]&gt;dis[k.second]+j.val)&#123;</span><br><span class=\"line\">                <span class=\"comment\">//if(j.to==8)cout&lt;&lt;k.second&lt;&lt;&quot; &quot;&lt;&lt;dis[k.second]&lt;&lt;endl;</span></span><br><span class=\"line\">                dis[j.to]=<span class=\"built_in\">min</span>(dis[j.to],dis[k.second]+j.val);</span><br><span class=\"line\">                q.<span class=\"built_in\">push</span>(&#123;dis[j.to],j.to&#125;);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> price,ad,num,pre,cur;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; s &gt;&gt; t;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i = <span class=\"number\">1</span>;i &lt;= m;i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cin &gt;&gt; price &gt;&gt; ad &gt;&gt; num;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j = <span class=\"number\">0</span>;j &lt;num;j++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            cin &gt;&gt; cur;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(j)&#123;</span><br><span class=\"line\">                <span class=\"built_in\">add</span>((i<span class=\"number\">-1</span>)*n+pre,(i<span class=\"number\">-1</span>)*n+cur,ad);    </span><br><span class=\"line\">                <span class=\"built_in\">add</span>((i<span class=\"number\">-1</span>)*n+cur,(i<span class=\"number\">-1</span>)*n+pre,ad);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"built_in\">add</span>((i<span class=\"number\">-1</span>)*n+cur,n*m+cur,<span class=\"number\">0</span>);</span><br><span class=\"line\">            <span class=\"built_in\">add</span>(n*m+cur,(i<span class=\"number\">-1</span>)*n+cur,price); </span><br><span class=\"line\">            pre = cur;  </span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">dijkstra</span>(n*m+s);    </span><br><span class=\"line\">    <span class=\"keyword\">if</span>(dis[n*m+t] == INF)   </span><br><span class=\"line\">        cout &lt;&lt; <span class=\"number\">-1</span> &lt;&lt; endl;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        cout &lt;&lt; dis[n*m+t] &lt;&lt; endl;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"ç¤ºä¾‹3ï¼šä¸€äº›ç›¸ç±»ä¼¼çš„ç§»åŠ¨æ–¹å¼é›†åˆåˆ°ä¸€èµ·ï¼ˆ2023æ¾³é—¨åŒºåŸŸèµ›ï¼‰\">ç¤ºä¾‹3ï¼šä¸€äº›ç›¸ç±»ä¼¼çš„ç§»åŠ¨æ–¹å¼é›†åˆåˆ°ä¸€èµ·ï¼ˆ2023æ¾³é—¨åŒºåŸŸèµ›ï¼‰</h4>\n<p>é¢˜æ„æ¦‚æ‹¬ï¼š</p>\n<p>æœ‰ä¸€ä¸ª<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>ä¸ªèŠ‚ç‚¹çš„ç¯ï¼Œç¼–å·<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mo>â†’</mo><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">0\\to n-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â†’</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>. ä½ åˆå§‹åœ¨<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>å·èŠ‚ç‚¹ã€‚ç»™ä¸€ä¸ªé•¿åº¦ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>çš„æ•°ç»„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>ã€‚ä½ æ¯ä¸€æ¬¡å¯ä»¥è¿›è¡Œä»¥ä¸‹æ“ä½œï¼š</p>\n<ol>\n<li>ä»<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>ç«‹å³ä¼ é€ï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>â†’</mo><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo>+</mo><mi>i</mi><mo stretchy=\"false\">)</mo><mspace></mspace><mspace width=\"0.4444em\"/><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">m</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">d</mi></mrow><mspace width=\"0.3333em\"/><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">i\\to (a_i+i)\\pmod{n}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â†’</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">)</span><span class=\"mspace allowbreak\"></span><span class=\"mspace\" style=\"margin-right:0.4444em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathrm\">mod</span></span></span><span class=\"mspace\" style=\"margin-right:0.3333em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span></li>\n<li>ä¿®æ”¹å½“å‰<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">a_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>â†’</mo><msub><mi>a</mi><mi>i</mi></msub><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">a_i\\to a_i+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â†’</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span></li>\n</ol>\n<p>ç»™å®šä¸€ä¸ª<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>ï¼Œè¯¢é—®æœ€å°‘ç»è¿‡å¤šå°‘æ¬¡æ“ä½œèƒ½å¤Ÿä»<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>åˆ°è¾¾<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>.</p>\n<p>è¿™é‡Œè¦çœ‹ä½ æ€ä¹ˆçœ‹å¾…è¿™ä¸ªä¿®æ”¹ã€‚åœ¨<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>å¯¹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">a_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>åŠ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>ç­‰ä»·äºç›´æ¥è·³åˆ°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>+</mo><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">a_i+i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>ååˆèŠ±è´¹ä¸€æ¬¡æœºä¼šå‘åèµ°ã€‚å› ä¸ºä½ æ°¸è¿œä¸å¯èƒ½èµ°å›å¤´è·¯ï¼Œå°±æ˜¯ç¬¬äºŒæ¬¡ç»è¿‡<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>è¿™ä¸ªç‚¹ï¼Œæ‰€ä»¥è¿™ä¸ªæŠ½è±¡æ˜¯åˆç†çš„ã€‚è€Œæˆ‘ä»¬åˆä¸å¯èƒ½ç›´æ¥åœ¨åŸå›¾ä¸ŠæŠŠæ‰€æœ‰çš„ç‚¹å…¨éƒ¨ç›´æ¥ä¸²èµ·æ¥ã€‚</p>\n<p>æ‰€ä»¥å¼€ä¸€ä¸ªåˆ†å±‚å›¾ï¼Œé¢å¤–æ–°å»ºç«‹ä¸€ä¸ªæœ‰å‘ç¯æ¨¡æ‹Ÿåè·³è·ƒè¿™ä¸ªæ“ä½œï¼Œç„¶åä¸€æ¬¡æ“ä½œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>å°±ä»åŸå›¾çš„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>å‘ç¯ä¸Šçš„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>+</mo><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">i+a_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7429em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>è¿è¾¹ã€‚ç¯ä¸Šçš„ç‚¹å‘åŸå›¾çš„è‡ªå·±è¿ä¸€æ¡ä»£ä»·ä¸º0çš„å•å‘æœ‰å‘è¾¹ã€‚</p>\n<div style=\"page-break-after: always;\"></div>\n<h2 id=\"2-ç½‘ç»œæµ\">2. ç½‘ç»œæµ</h2>\n<p>è§£å†³ç½‘ç»œæµæ¨¡å‹é—®é¢˜ã€‚</p>\n<h3 id=\"2-1-MaxFlow-h\">2.1 MaxFlow.h</h3>\n<p>Jianglyæœ€æ–°æœ€å¤§æµæ¨¡æ¿ï¼Œç‚¹ç¼–å·ä»0å¼€å§‹ã€‚è´¹ç”¨æµåŒç†ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">template</span> &lt;<span class=\"keyword\">class</span> <span class=\"title class_\">T</span>&gt;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">MaxFlow</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">struct</span> <span class=\"title class_\">_Edge</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> to;</span><br><span class=\"line\">        T cap;</span><br><span class=\"line\">        _Edge(<span class=\"type\">int</span> to, T cap) : <span class=\"built_in\">to</span>(to), <span class=\"built_in\">cap</span>(cap) &#123;&#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"type\">int</span> n;</span><br><span class=\"line\">    std::vector&lt;_Edge&gt; e;</span><br><span class=\"line\">    std::vector&lt;std::vector&lt;<span class=\"type\">int</span>&gt;&gt; g;</span><br><span class=\"line\">    std::vector&lt;<span class=\"type\">int</span>&gt; cur, h;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">MaxFlow</span>() &#123;&#125;</span><br><span class=\"line\">    <span class=\"built_in\">MaxFlow</span>(<span class=\"type\">int</span> n)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">init</span>(n);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">init</span><span class=\"params\">(<span class=\"type\">int</span> n)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>-&gt;n = n;</span><br><span class=\"line\">        e.<span class=\"built_in\">clear</span>();</span><br><span class=\"line\">        g.<span class=\"built_in\">assign</span>(n, &#123;&#125;);</span><br><span class=\"line\">        cur.<span class=\"built_in\">resize</span>(n);</span><br><span class=\"line\">        h.<span class=\"built_in\">resize</span>(n);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">bool</span> <span class=\"title\">bfs</span><span class=\"params\">(<span class=\"type\">int</span> s, <span class=\"type\">int</span> t)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        h.<span class=\"built_in\">assign</span>(n, <span class=\"number\">-1</span>);</span><br><span class=\"line\">        std::queue&lt;<span class=\"type\">int</span>&gt; que;</span><br><span class=\"line\">        h[s] = <span class=\"number\">0</span>;</span><br><span class=\"line\">        que.<span class=\"built_in\">push</span>(s);</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (!que.<span class=\"built_in\">empty</span>())</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">const</span> <span class=\"type\">int</span> u = que.<span class=\"built_in\">front</span>();</span><br><span class=\"line\">            que.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i : g[u])</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">auto</span> [v, c] = e[i];</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (c &gt; <span class=\"number\">0</span> &amp;&amp; h[v] == <span class=\"number\">-1</span>)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    h[v] = h[u] + <span class=\"number\">1</span>;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (v == t)</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    que.<span class=\"built_in\">push</span>(v);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\">T <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"type\">int</span> u, <span class=\"type\">int</span> t, T f)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (u == t)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> f;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> r = f;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> &amp;i = cur[u]; i &lt; <span class=\"built_in\">int</span>(g[u].<span class=\"built_in\">size</span>()); ++i)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">const</span> <span class=\"type\">int</span> j = g[u][i];</span><br><span class=\"line\">            <span class=\"keyword\">auto</span> [v, c] = e[j];</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (c &gt; <span class=\"number\">0</span> &amp;&amp; h[v] == h[u] + <span class=\"number\">1</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">auto</span> a = <span class=\"built_in\">dfs</span>(v, t, std::<span class=\"built_in\">min</span>(r, c));</span><br><span class=\"line\">                e[j].cap -= a;</span><br><span class=\"line\">                e[j ^ <span class=\"number\">1</span>].cap += a;</span><br><span class=\"line\">                r -= a;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (r == <span class=\"number\">0</span>)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> f;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> f - r;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">addEdge</span><span class=\"params\">(<span class=\"type\">int</span> u, <span class=\"type\">int</span> v, T c)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        g[u].<span class=\"built_in\">push_back</span>(e.<span class=\"built_in\">size</span>());</span><br><span class=\"line\">        e.<span class=\"built_in\">emplace_back</span>(v, c);</span><br><span class=\"line\">        g[v].<span class=\"built_in\">push_back</span>(e.<span class=\"built_in\">size</span>());</span><br><span class=\"line\">        e.<span class=\"built_in\">emplace_back</span>(u, <span class=\"number\">0</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">T <span class=\"title\">flow</span><span class=\"params\">(<span class=\"type\">int</span> s, <span class=\"type\">int</span> t)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        T ans = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"built_in\">bfs</span>(s, t))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            cur.<span class=\"built_in\">assign</span>(n, <span class=\"number\">0</span>);</span><br><span class=\"line\">            ans += <span class=\"built_in\">dfs</span>(s, t, std::numeric_limits&lt;T&gt;::<span class=\"built_in\">max</span>());</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\">std::vector&lt;<span class=\"type\">bool</span>&gt; <span class=\"title\">minCut</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"function\">std::vector&lt;<span class=\"type\">bool</span>&gt; <span class=\"title\">c</span><span class=\"params\">(n)</span></span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            c[i] = (h[i] != <span class=\"number\">-1</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> c;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">struct</span> <span class=\"title class_\">Edge</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> from;</span><br><span class=\"line\">        <span class=\"type\">int</span> to;</span><br><span class=\"line\">        T cap;</span><br><span class=\"line\">        T flow;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"function\">std::vector&lt;Edge&gt; <span class=\"title\">edges</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        std::vector&lt;Edge&gt; a;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; e.<span class=\"built_in\">size</span>(); i += <span class=\"number\">2</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            Edge x;</span><br><span class=\"line\">            x.from = e[i + <span class=\"number\">1</span>].to;</span><br><span class=\"line\">            x.to = e[i].to;</span><br><span class=\"line\">            x.cap = e[i].cap + e[i + <span class=\"number\">1</span>].cap;</span><br><span class=\"line\">            x.flow = e[i + <span class=\"number\">1</span>].cap;</span><br><span class=\"line\">            a.<span class=\"built_in\">push_back</span>(x);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> a;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"2-2-MinCostFlow-h\">2.2 MinCostFlow.h</h3>\n<p>æ”¯æŒè´Ÿæ•°è´¹ç”¨ï¼Œä¸æ”¯æŒè´Ÿæ•°æµé‡ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\"> *@brief è´¹ç”¨æµï¼ˆJianglyï¼‰</span></span><br><span class=\"line\"><span class=\"comment\"> *@note æ—¶é—´å¤æ‚åº¦O(F(n+m)log(n+m)),F(n+m)è¡¨ç¤ºæµé‡å’Œï¼Œnè¡¨ç¤ºç‚¹æ•°ï¼Œmè¡¨ç¤ºè¾¹æ•°</span></span><br><span class=\"line\"><span class=\"comment\"> *@note ç©ºé—´å¤æ‚åº¦O(n+m)</span></span><br><span class=\"line\"><span class=\"comment\"> *@tparam Cap æµé‡æ•°æ®ç±»å‹</span></span><br><span class=\"line\"><span class=\"comment\"> *@tparam Cost è´¹ç”¨æ•°æ®ç±»å‹</span></span><br><span class=\"line\"><span class=\"comment\"> *@note  å¤æ‚åº¦ä¼°ç®—å¯åŒæœ€å¤§æµï¼Œç‚¹æ•°ä¸è¶…è¿‡2000ï¼Œæœ€åä¸Šç•Œä¼°ç®—O(n^3)åˆ°O(n^4)ï¼ŒåŸºæœ¬ä¸ä¼šTLE</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">template</span> &lt;<span class=\"keyword\">class</span> <span class=\"title class_\">T</span>&gt;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">MinCostFlow</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">struct</span> <span class=\"title class_\">_Edge</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> to;</span><br><span class=\"line\">        T cap;</span><br><span class=\"line\">        T cost;</span><br><span class=\"line\">        _Edge(<span class=\"type\">int</span> to_, T cap_, T cost_) : <span class=\"built_in\">to</span>(to_), <span class=\"built_in\">cap</span>(cap_), <span class=\"built_in\">cost</span>(cost_) &#123;&#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"type\">int</span> n;</span><br><span class=\"line\">    std::vector&lt;_Edge&gt; e;</span><br><span class=\"line\">    std::vector&lt;std::vector&lt;<span class=\"type\">int</span>&gt;&gt; g;</span><br><span class=\"line\">    std::vector&lt;T&gt; h, dis;</span><br><span class=\"line\">    std::vector&lt;<span class=\"type\">int</span>&gt; pre;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">bool</span> <span class=\"title\">dijkstra</span><span class=\"params\">(<span class=\"type\">int</span> s, <span class=\"type\">int</span> t)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        dis.<span class=\"built_in\">assign</span>(n, std::numeric_limits&lt;T&gt;::<span class=\"built_in\">max</span>());</span><br><span class=\"line\">        pre.<span class=\"built_in\">assign</span>(n, <span class=\"number\">-1</span>);</span><br><span class=\"line\">        std::priority_queue&lt;std::pair&lt;T, <span class=\"type\">int</span>&gt;, std::vector&lt;std::pair&lt;T, <span class=\"type\">int</span>&gt;&gt;, std::greater&lt;std::pair&lt;T, <span class=\"type\">int</span>&gt;&gt;&gt; que;</span><br><span class=\"line\">        dis[s] = <span class=\"number\">0</span>;</span><br><span class=\"line\">        que.<span class=\"built_in\">emplace</span>(<span class=\"number\">0</span>, s);</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (!que.<span class=\"built_in\">empty</span>())</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            T d = que.<span class=\"built_in\">top</span>().first;</span><br><span class=\"line\">            <span class=\"type\">int</span> u = que.<span class=\"built_in\">top</span>().second;</span><br><span class=\"line\">            que.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (dis[u] != d)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i : g[u])</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"type\">int</span> v = e[i].to;</span><br><span class=\"line\">                T cap = e[i].cap;</span><br><span class=\"line\">                T cost = e[i].cost;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (cap &gt; <span class=\"number\">0</span> &amp;&amp; dis[v] &gt; d + h[u] - h[v] + cost)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    dis[v] = d + h[u] - h[v] + cost;</span><br><span class=\"line\">                    pre[v] = i;</span><br><span class=\"line\">                    que.<span class=\"built_in\">emplace</span>(dis[v], v);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> dis[t] != std::numeric_limits&lt;T&gt;::<span class=\"built_in\">max</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">MinCostFlow</span>() &#123;&#125;</span><br><span class=\"line\">    <span class=\"built_in\">MinCostFlow</span>(<span class=\"type\">int</span> n_)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">init</span>(n_);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">init</span><span class=\"params\">(<span class=\"type\">int</span> n_)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        n = n_;</span><br><span class=\"line\">        e.<span class=\"built_in\">clear</span>();</span><br><span class=\"line\">        g.<span class=\"built_in\">assign</span>(n, &#123;&#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">addEdge</span><span class=\"params\">(<span class=\"type\">int</span> u, <span class=\"type\">int</span> v, T cap, T cost)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        g[u].<span class=\"built_in\">push_back</span>(e.<span class=\"built_in\">size</span>());</span><br><span class=\"line\">        e.<span class=\"built_in\">emplace_back</span>(v, cap, cost);</span><br><span class=\"line\">        g[v].<span class=\"built_in\">push_back</span>(e.<span class=\"built_in\">size</span>());</span><br><span class=\"line\">        e.<span class=\"built_in\">emplace_back</span>(u, <span class=\"number\">0</span>, -cost);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">std::pair&lt;T, T&gt; <span class=\"title\">flow</span><span class=\"params\">(<span class=\"type\">int</span> s, <span class=\"type\">int</span> t)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        T flow = <span class=\"number\">0</span>;</span><br><span class=\"line\">        T cost = <span class=\"number\">0</span>;</span><br><span class=\"line\">        h.<span class=\"built_in\">assign</span>(n, <span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"built_in\">dijkstra</span>(s, t))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; ++i)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                h[i] += dis[i];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            T aug = std::numeric_limits&lt;<span class=\"type\">int</span>&gt;::<span class=\"built_in\">max</span>();</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = t; i != s; i = e[pre[i] ^ <span class=\"number\">1</span>].to)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                aug = std::<span class=\"built_in\">min</span>(aug, e[pre[i]].cap);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = t; i != s; i = e[pre[i] ^ <span class=\"number\">1</span>].to)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                e[pre[i]].cap -= aug;</span><br><span class=\"line\">                e[pre[i] ^ <span class=\"number\">1</span>].cap += aug;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            flow += aug;</span><br><span class=\"line\">            cost += aug * h[t];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> std::<span class=\"built_in\">make_pair</span>(flow, cost);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">struct</span> <span class=\"title class_\">Edge</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> from;</span><br><span class=\"line\">        <span class=\"type\">int</span> to;</span><br><span class=\"line\">        T cap;</span><br><span class=\"line\">        T cost;</span><br><span class=\"line\">        T flow;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"function\">std::vector&lt;Edge&gt; <span class=\"title\">edges</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        std::vector&lt;Edge&gt; a;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; e.<span class=\"built_in\">size</span>(); i += <span class=\"number\">2</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            Edge x;</span><br><span class=\"line\">            x.from = e[i + <span class=\"number\">1</span>].to;</span><br><span class=\"line\">            x.to = e[i].to;</span><br><span class=\"line\">            x.cap = e[i].cap + e[i + <span class=\"number\">1</span>].cap;</span><br><span class=\"line\">            x.cost = e[i].cost;</span><br><span class=\"line\">            x.flow = e[i + <span class=\"number\">1</span>].cap;</span><br><span class=\"line\">            a.<span class=\"built_in\">push_back</span>(x);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> a;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"2-3-Dinic-æœ±\">2.3 Dinic (æœ±)</h3>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// ç†è®ºä¸Šç•Œä¸ºn2mï¼Œå¤„ç†1e4-1e5çš„æ•°æ®</span></span><br><span class=\"line\"><span class=\"comment\">// ä¸‰ä¸ªä¼˜åŒ–ï¼šå¤šè·¯å¢å¹¿ï¼Œå½“å‰å¼§ï¼Œç‚¸ç‚¹</span></span><br><span class=\"line\"><span class=\"comment\">// å°‘åšå‡ æ¬¡bfsï¼Œä¸€æ¬¡dfsè¿›è¡Œå¤šæ¬¡å¢å¹¿</span></span><br><span class=\"line\"><span class=\"comment\">// å»ºå›¾æ—¶ä¸ç”¨è€ƒè™‘ç‚¹çš„å˜åŒ–ï¼Œè¿‡ç¨‹ä¸­æ²¡æœ‰ç”¨åˆ°ç‚¹æ•°è¿™ä¸ªä¿¡æ¯ï¼Œåªéœ€æŠŠè¾¹å»ºå‡ºæ¥å°±èƒ½è·‘</span></span><br><span class=\"line\"><span class=\"comment\">// å¤šæµ‹çš„æ—¶å€™è®°å¾—æ¸…ç©ºe[0]</span></span><br><span class=\"line\"><span class=\"comment\">// æ£€æŸ¥è¿™æ¡è¾¹æ˜¯ä¸æ˜¯æ»¡æµï¼šæ˜¯çš„è¯è¿™æ¡è¾¹çš„lenå˜æˆ0ï¼ˆæ²¡æœ‰å‰©ä½™æµé‡ï¼‰</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> int long long</span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> N = <span class=\"number\">10010</span>, M = <span class=\"number\">200010</span>, INF = <span class=\"number\">1e15</span>;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">edge</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> ed;</span><br><span class=\"line\">    <span class=\"type\">int</span> len;</span><br><span class=\"line\">    <span class=\"type\">int</span> id;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">vector&lt;edge&gt; e[N];</span><br><span class=\"line\"><span class=\"type\">int</span> n, m, S, T;</span><br><span class=\"line\"><span class=\"type\">int</span> dep[N], cur[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">bool</span> <span class=\"title\">bfs</span><span class=\"params\">()</span> <span class=\"comment\">// bfsåˆ†å±‚</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">memset</span>(dep, <span class=\"number\">-1</span>, <span class=\"keyword\">sizeof</span> dep);</span><br><span class=\"line\">    queue&lt;<span class=\"type\">int</span>&gt; q;</span><br><span class=\"line\">    q.<span class=\"built_in\">push</span>(S);</span><br><span class=\"line\">    dep[S] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (!q.<span class=\"built_in\">empty</span>())</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> t = q.<span class=\"built_in\">front</span>();</span><br><span class=\"line\">        q.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; e[t].<span class=\"built_in\">size</span>(); i = i + <span class=\"number\">1</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> ed = e[t][i].ed;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (dep[ed] == <span class=\"number\">-1</span> &amp;&amp; e[t][i].len) <span class=\"comment\">// å¦‚æœè¿™ä¸ªç‚¹æ²¡æœ‰è¢«å®šä¹‰å±‚æ¬¡ï¼Œä¸”è¿˜æœ‰å‰©ä½™æµé‡</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                dep[ed] = dep[t] + <span class=\"number\">1</span>;</span><br><span class=\"line\">                q.<span class=\"built_in\">push</span>(ed);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">memset</span>(cur, <span class=\"number\">0</span>, <span class=\"built_in\">sizeof</span>(cur));</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (dep[T] == <span class=\"number\">-1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"type\">int</span> st, <span class=\"type\">int</span> limit)</span> <span class=\"comment\">// limitæœ€å¤§å¯å¢åŠ çš„æµé‡</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (st == T)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> limit;</span><br><span class=\"line\">    <span class=\"type\">int</span> nowflow = <span class=\"number\">0</span>;                                   <span class=\"comment\">// å®šä¹‰å½“å‰èŠ‚ç‚¹çš„æµé‡,å¤šè·¯å¢å¹¿ä¼˜åŒ–ï¼Œæ‰¾æ»¡å½“å‰èƒ½æ‰¾çš„limitæµé‡ä¸Šç•Œ</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = cur[st]; i &lt; e[st].<span class=\"built_in\">size</span>(); i = i + <span class=\"number\">1</span>) <span class=\"comment\">// å½“å‰å¼§ä¼˜åŒ–ï¼Œå¦‚æœä¸€ä¸ªç‚¹æœ‰å¾ˆå¤šå‡ºè¾¹ï¼Œæœ‰äº›å‡ºè¾¹å¯èƒ½æ— æ³•å†æ¨æµäº†ï¼Œæˆ‘ä»¬å°±è®°å½•ç¬¬ä¸€æ¡å¯ä»¥æ¨æµçš„è¾¹</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cur[st] = i; <span class=\"comment\">// å½“å‰å¼§ä¼˜åŒ–</span></span><br><span class=\"line\">        <span class=\"type\">int</span> ed = e[st][i].ed;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (dep[ed] == dep[st] + <span class=\"number\">1</span> &amp;&amp; e[st][i].len) <span class=\"comment\">// è¿™æ¡è¾¹èƒ½æ¨ä¸”ï¼Œæ·±åº¦ä¸ºæ›´æ·±ä¸€å±‚ï¼ˆä¸ºäº†æ‰¾æœ€çŸ­çš„å¢å¹¿è·¯ï¼‰</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> t = <span class=\"built_in\">dfs</span>(ed, <span class=\"built_in\">min</span>(e[st][i].len, limit - nowflow)); <span class=\"comment\">// æ˜¯ä¸ºäº†é™åˆ¶åé¢ç‚¹çš„æµé‡ä¸èƒ½å¤§äºlimit-nowflow</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (t)                                               <span class=\"comment\">// èµ°ä¸‹å»èƒ½æ¨æµ</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                e[st][i].len -= t;           <span class=\"comment\">// å‡å»ç›¸åº”çš„</span></span><br><span class=\"line\">                e[ed][e[st][i].id].len += t; <span class=\"comment\">// åè¾¹+ç›¸åº”çš„</span></span><br><span class=\"line\">                nowflow += t;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (nowflow == limit)</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> nowflow;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!nowflow)</span><br><span class=\"line\">        dep[st] = <span class=\"number\">-1</span>; <span class=\"comment\">// å¦‚æœè¿™ä¸ªç‚¹ä¸èƒ½å»¶ç”³ï¼Œé‚£å°±åˆ æ‰è¿™ä¸ªç‚¹ï¼ˆç‚¸ç‚¹ä¼˜åŒ–ï¼‰</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> nowflow;   <span class=\"comment\">// ä¼šè¿”å›æœ¬æ¬¡bfsï¼ˆï¼‰åæ‰€æœ‰å¢å¹¿è·¯èƒ½åŠ çš„æœ€å¤šæµé‡</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">dinic</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> r = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (<span class=\"built_in\">bfs</span>())</span><br><span class=\"line\">        r += <span class=\"built_in\">dfs</span>(S, INF);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"type\">int</span> u, <span class=\"type\">int</span> v, <span class=\"type\">int</span> w)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123; <span class=\"comment\">// cout&lt;&lt;u&lt;&lt;&quot; &quot;&lt;&lt;v&lt;&lt;&quot; &quot;&lt;&lt;w&lt;&lt;endl;</span></span><br><span class=\"line\">    <span class=\"type\">int</span> sti = e[u].<span class=\"built_in\">size</span>();</span><br><span class=\"line\">    <span class=\"type\">int</span> edi = e[v].<span class=\"built_in\">size</span>();</span><br><span class=\"line\">    e[u].<span class=\"built_in\">push_back</span>((edge)&#123;v, w, edi&#125;); <span class=\"comment\">// å»ºè¾¹</span></span><br><span class=\"line\">    e[v].<span class=\"built_in\">push_back</span>((edge)&#123;u, <span class=\"number\">0</span>, sti&#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; S &gt;&gt; T;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= m; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> u, v, w;</span><br><span class=\"line\">        cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class=\"line\">        <span class=\"built_in\">add</span>(u, v, w);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; <span class=\"built_in\">dinic</span>();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"2-4-ISAP-æœ±\">2.4 ISAP (æœ±)</h3>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// ç†è®ºä¸Šç•Œä¸ºn2mï¼Œå¤„ç†1e4-1e5çš„æ•°æ®</span></span><br><span class=\"line\"><span class=\"comment\">// åªåšä¸€æ¬¡bfs</span></span><br><span class=\"line\"><span class=\"comment\">// å»ºå›¾æ—¶æ³¨æ„nçš„æ”¹å˜ï¼Œè¿è¡Œè¿‡ç¨‹ä¸­æœ‰è·Ÿç‚¹æ•°ç›¸å…³</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> int long long</span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> N = <span class=\"number\">10010</span>, INF = <span class=\"number\">1e15</span>;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">edge</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> ed;</span><br><span class=\"line\">    <span class=\"type\">int</span> len;</span><br><span class=\"line\">    <span class=\"type\">int</span> id;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">vector&lt;edge&gt; e[N];</span><br><span class=\"line\"><span class=\"type\">int</span> n, m, S, T;</span><br><span class=\"line\"><span class=\"type\">int</span> dep[N], gap[N], cur[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">bfs</span><span class=\"params\">()</span> <span class=\"comment\">// bfsåˆ†å±‚</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">memset</span>(dep, <span class=\"number\">-1</span>, <span class=\"keyword\">sizeof</span> dep);</span><br><span class=\"line\">    <span class=\"built_in\">memset</span>(gap, <span class=\"number\">0</span>, <span class=\"built_in\">sizeof</span>(gap));</span><br><span class=\"line\">    queue&lt;<span class=\"type\">int</span>&gt; q;</span><br><span class=\"line\">    q.<span class=\"built_in\">push</span>(T);</span><br><span class=\"line\">    dep[T] = <span class=\"number\">0</span>; <span class=\"comment\">// Tä¸ºå±‚æ•°ä¸º0çš„ç‚¹</span></span><br><span class=\"line\">    gap[<span class=\"number\">0</span>] = <span class=\"number\">1</span>; <span class=\"comment\">// å±‚æ•°ä¸º0çš„ç‚¹æœ‰ä¸€ä¸ª</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> (!q.<span class=\"built_in\">empty</span>())</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> t = q.<span class=\"built_in\">front</span>();</span><br><span class=\"line\">        q.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; e[t].<span class=\"built_in\">size</span>(); i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> ed = e[t][i].ed;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (dep[ed] == <span class=\"number\">-1</span>) <span class=\"comment\">// å¦‚æœè¿™ä¸ªç‚¹æ²¡æœ‰è¢«å®šä¹‰å±‚æ¬¡å°±è€ƒè™‘ï¼ˆåœ¨è¿™é‡Œä¸åœ¨ä¹è¿™æ¡è¾¹çš„æµé‡æ˜¯å¦ä¸º0ï¼åªè´Ÿè´£åˆ†å±‚)</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                dep[ed] = dep[t] + <span class=\"number\">1</span>;</span><br><span class=\"line\">                gap[dep[ed]]++;</span><br><span class=\"line\">                q.<span class=\"built_in\">push</span>(ed);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"type\">int</span> st, <span class=\"type\">int</span> limit)</span> <span class=\"comment\">// limitæœ€å¤§å¯å¢åŠ çš„æµé‡</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (st == T)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> limit;</span><br><span class=\"line\">    <span class=\"type\">int</span> nowflow = <span class=\"number\">0</span>;                                   <span class=\"comment\">// å®šä¹‰å½“å‰èŠ‚ç‚¹çš„æµé‡,å¤šè·¯å¢å¹¿ä¼˜åŒ–ï¼Œæ‰¾æ»¡å½“å‰èƒ½æ‰¾çš„limitæµé‡ä¸Šç•Œ</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = cur[st]; i &lt; e[st].<span class=\"built_in\">size</span>(); i = i + <span class=\"number\">1</span>) <span class=\"comment\">// å½“å‰å¼§ä¼˜åŒ–ï¼Œå¦‚æœä¸€ä¸ªç‚¹æœ‰å¾ˆå¤šå‡ºè¾¹ï¼Œæœ‰äº›å‡ºè¾¹å¯èƒ½æ— æ³•å†æ¨æµäº†ï¼Œæˆ‘ä»¬å°±è®°å½•ç¬¬ä¸€æ¡å¯ä»¥æ¨æµçš„è¾¹</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cur[st] = i; <span class=\"comment\">// å½“å‰å¼§ä¼˜åŒ–</span></span><br><span class=\"line\">        <span class=\"type\">int</span> ed = e[st][i].ed;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (dep[ed] + <span class=\"number\">1</span> == dep[st] &amp;&amp; e[st][i].len) <span class=\"comment\">// è¿™æ¡è¾¹èƒ½æ¨ä¸”ï¼Œæ·±åº¦ä¸ºæ›´æ·±ä¸€å±‚ï¼ˆä¸ºäº†æ‰¾æœ€çŸ­çš„å¢å¹¿è·¯ï¼‰</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> t = <span class=\"built_in\">dfs</span>(ed, <span class=\"built_in\">min</span>(e[st][i].len, limit - nowflow)); <span class=\"comment\">// æ˜¯ä¸ºäº†é™åˆ¶åé¢ç‚¹çš„æµé‡ä¸èƒ½å¤§äºlimit-nowflow</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (t)                                               <span class=\"comment\">// èµ°ä¸‹å»èƒ½æ¨æµ</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                e[st][i].len -= t;           <span class=\"comment\">// å‡å»ç›¸åº”çš„</span></span><br><span class=\"line\">                e[ed][e[st][i].id].len += t; <span class=\"comment\">// åè¾¹+ç›¸åº”çš„</span></span><br><span class=\"line\">                nowflow += t;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (nowflow == limit)</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> nowflow;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125; <span class=\"comment\">// åˆ°è¿™è¯´æ˜è¿™ä¸ªç‚¹è¿˜æœ‰å‰©ä½™æµé‡ï¼Œå±‚æ•°å°±+1</span></span><br><span class=\"line\">    --gap[dep[st]];</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (gap[dep[st]] == <span class=\"number\">0</span>)</span><br><span class=\"line\">        dep[S] = n + <span class=\"number\">1</span>; <span class=\"comment\">// å‡ºç°æ–­å±‚ï¼Œæ— æ³•åˆ°è¾¾täº†ï¼Œç›´æ¥ç»“æŸ</span></span><br><span class=\"line\">    dep[st]++;          <span class=\"comment\">// å±‚++</span></span><br><span class=\"line\">    gap[dep[st]]++;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> nowflow; <span class=\"comment\">// ä¼šè¿”å›æœ¬æ¬¡bfsï¼ˆï¼‰åæ‰€æœ‰å¢å¹¿è·¯èƒ½åŠ çš„æœ€å¤šæµé‡</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">ISAP</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> flow = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"built_in\">bfs</span>();</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (dep[S] &lt; n)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">memset</span>(cur, <span class=\"number\">0</span>, <span class=\"built_in\">sizeof</span>(cur)); <span class=\"comment\">// æ¯ä¸€æ¬¡å¼€å§‹dfså‰éƒ½è¦æ³¨æ„curæ•°ç»„çš„æ¸…ç©ºï¼ä¸dinicä¸åŒï¼Œå› ä¸ºè¿™é‡Œåªéœ€è¦ä¸€æ¬¡bfs</span></span><br><span class=\"line\">        flow += <span class=\"built_in\">dfs</span>(S, INF);         <span class=\"comment\">// åˆå§‹æµé‡ä¸ºæ— ç©·å¤§</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> flow;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"type\">int</span> u, <span class=\"type\">int</span> v, <span class=\"type\">int</span> w)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123; <span class=\"comment\">// cout&lt;&lt;u&lt;&lt;&quot; &quot;&lt;&lt;v&lt;&lt;&quot; &quot;&lt;&lt;w&lt;&lt;endl;</span></span><br><span class=\"line\">    <span class=\"type\">int</span> sti = e[u].<span class=\"built_in\">size</span>();</span><br><span class=\"line\">    <span class=\"type\">int</span> edi = e[v].<span class=\"built_in\">size</span>();</span><br><span class=\"line\">    e[u].<span class=\"built_in\">push_back</span>((edge)&#123;v, w, edi&#125;); <span class=\"comment\">// å»ºè¾¹</span></span><br><span class=\"line\">    e[v].<span class=\"built_in\">push_back</span>((edge)&#123;u, <span class=\"number\">0</span>, sti&#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; S &gt;&gt; T;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= m; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> u, v, w;</span><br><span class=\"line\">        cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class=\"line\">        <span class=\"type\">int</span> sti = e[u].<span class=\"built_in\">size</span>();</span><br><span class=\"line\">        <span class=\"type\">int</span> edi = e[v].<span class=\"built_in\">size</span>();</span><br><span class=\"line\">        e[u].<span class=\"built_in\">push_back</span>((edge)&#123;v, w, edi&#125;); <span class=\"comment\">// å»ºè¾¹</span></span><br><span class=\"line\">        e[v].<span class=\"built_in\">push_back</span>((edge)&#123;u, <span class=\"number\">0</span>, sti&#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; <span class=\"built_in\">ISAP</span>();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"2-5-é¢„æµæ¨è¿›ï¼ˆAmiyaCastï¼‰\">2.5 é¢„æµæ¨è¿›ï¼ˆAmiyaCastï¼‰</h3>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> ll long long</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> pii make_pair</span></span><br><span class=\"line\"><span class=\"type\">const</span> ll inf = <span class=\"number\">1145141919810</span>;</span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">int</span> n, m, s, t;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">Dinic</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> tp, s, t, n, m;</span><br><span class=\"line\">    <span class=\"keyword\">struct</span> <span class=\"title class_\">Edge</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> u, v;</span><br><span class=\"line\">        ll cap;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    vector&lt;ll&gt; dis;</span><br><span class=\"line\">    vector&lt;<span class=\"type\">int</span>&gt; cur, que;</span><br><span class=\"line\">    vector&lt;vector&lt;<span class=\"type\">int</span>&gt;&gt; v;</span><br><span class=\"line\">    vector&lt;Edge&gt; e, _e;</span><br><span class=\"line\">    <span class=\"built_in\">Dinic</span>(<span class=\"type\">int</span> _n, <span class=\"type\">int</span> _s, <span class=\"type\">int</span> <span class=\"type\">_t</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        n = _n, s = _s, t = <span class=\"type\">_t</span>;</span><br><span class=\"line\">        dis.<span class=\"built_in\">resize</span>(_n + <span class=\"number\">1</span>), cur.<span class=\"built_in\">resize</span>(_n + <span class=\"number\">1</span>), que.<span class=\"built_in\">resize</span>(_n + <span class=\"number\">1</span>),</span><br><span class=\"line\">            v.<span class=\"built_in\">resize</span>(n + <span class=\"number\">1</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"type\">int</span> x, <span class=\"type\">int</span> y, ll w)</span> </span>&#123; _e.<span class=\"built_in\">push_back</span>(&#123;x, y, w&#125;); &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">Add</span><span class=\"params\">(<span class=\"type\">int</span> x, <span class=\"type\">int</span> y, <span class=\"type\">int</span> flw)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        e.<span class=\"built_in\">push_back</span>(Edge&#123;x, y, flw&#125;), e.<span class=\"built_in\">push_back</span>(Edge&#123;y, x, <span class=\"number\">0</span>&#125;);</span><br><span class=\"line\">        v[x].<span class=\"built_in\">push_back</span>(e.<span class=\"built_in\">size</span>() - <span class=\"number\">2</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">bfs</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        dis.<span class=\"built_in\">assign</span>(n + <span class=\"number\">1</span>, inf);</span><br><span class=\"line\">        <span class=\"type\">int</span> l = <span class=\"number\">1</span>, r = <span class=\"number\">1</span>;</span><br><span class=\"line\">        que[<span class=\"number\">1</span>] = s, dis[s] = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (l &lt;= r)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> p = que[l++], to;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i : v[p])</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (e[i].cap &amp;&amp; dis[to = e[i].v] &gt;= inf)</span><br><span class=\"line\">                    dis[to] = dis[p] + <span class=\"number\">1</span>, que[++r] = to;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> dis[t] &lt; inf;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"type\">int</span> p, ll a)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (p == t || !a)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> a;</span><br><span class=\"line\">        <span class=\"type\">int</span> sf = <span class=\"number\">0</span>, flw;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> &amp;i = cur[p], to; i &lt; (<span class=\"type\">int</span>)v[p].<span class=\"built_in\">size</span>(); ++i)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            Edge &amp;E = e[v[p][i]];</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (dis[to = E.v] == dis[p] + <span class=\"number\">1</span> &amp;&amp; (flw = <span class=\"built_in\">dfs</span>(to, <span class=\"built_in\">min</span>(a,</span><br><span class=\"line\">                                                                  E.cap))))</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                E.cap -= flw;</span><br><span class=\"line\">                e[v[p][i] ^ <span class=\"number\">1</span>].cap += flw;</span><br><span class=\"line\">                a -= flw;</span><br><span class=\"line\">                sf += flw;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (!a)</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> sf;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">ll <span class=\"title\">dinic</span><span class=\"params\">(<span class=\"type\">int</span> tp = <span class=\"number\">1</span>)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>-&gt;tp = tp;</span><br><span class=\"line\">        <span class=\"type\">int</span> flw = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"built_in\">bfs</span>())</span><br><span class=\"line\">            cur.<span class=\"built_in\">assign</span>(n + <span class=\"number\">1</span>, <span class=\"number\">0</span>), flw += <span class=\"built_in\">dfs</span>(s, inf);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> flw;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">ll <span class=\"title\">get_ans</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        ll ans = <span class=\"number\">0</span>;</span><br><span class=\"line\">        m = _e.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">        <span class=\"built_in\">sort</span>(_e.<span class=\"built_in\">begin</span>(), _e.<span class=\"built_in\">end</span>(), [](Edge a, Edge b)</span><br><span class=\"line\">             &#123; <span class=\"keyword\">return</span> a.cap &gt;</span><br><span class=\"line\">                      b.cap; &#125;);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> rp = <span class=\"number\">0</span>; rp &lt;= <span class=\"number\">1</span>; ++rp)</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> p = <span class=\"number\">1</span> &lt;&lt; <span class=\"number\">30</span>, i = <span class=\"number\">0</span>; p; p /=</span><br><span class=\"line\">                                            <span class=\"number\">2</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">for</span> (; i &lt; m &amp;&amp; _e[i].cap &gt;= p; ++i)</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (rp)</span><br><span class=\"line\">                        v[_e[i].v].<span class=\"built_in\">push_back</span>(i * <span class=\"number\">2</span> + <span class=\"number\">1</span>);</span><br><span class=\"line\">                    <span class=\"keyword\">else</span></span><br><span class=\"line\">                        <span class=\"built_in\">Add</span>(_e[i].u, _e[i].v, _e[i].cap);</span><br><span class=\"line\">                ans += <span class=\"built_in\">dinic</span>(rp);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; s &gt;&gt; t;</span><br><span class=\"line\">    <span class=\"function\">Dinic <span class=\"title\">d</span><span class=\"params\">(n, s, t)</span></span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; m; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> x, y;</span><br><span class=\"line\">        ll w;</span><br><span class=\"line\">        cin &gt;&gt; x &gt;&gt; y &gt;&gt; w;</span><br><span class=\"line\">        d.<span class=\"built_in\">add</span>(x, y, w);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; d.<span class=\"built_in\">get_ans</span>() &lt;&lt; endl;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"2-6-æœ€å°è´¹ç”¨æœ€å¤§æµï¼ˆæœ±ï¼‰\">2.6 æœ€å°è´¹ç”¨æœ€å¤§æµï¼ˆæœ±ï¼‰</h3>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//ç†è®ºä¸Šç•Œä¸ºn2mï¼Œå¤„ç†1e4-1e5çš„æ•°æ®</span></span><br><span class=\"line\"><span class=\"comment\">//æ¯æ¡è¾¹æµè¿‡å»å¤šäº†ä¸€ä¸ªæˆæœ¬</span></span><br><span class=\"line\"><span class=\"comment\">//bfsæ¢æˆäº†spfaè·‘æœ€çŸ­è·¯å³å¯,0å·ç‚¹å¾—ç©ºå‡ºæ¥</span></span><br><span class=\"line\"><span class=\"comment\">//æœ€å¤§è´¹ç”¨æœ€å¤§æµï¼šå»ºè¾¹æ—¶æŠŠcåç€å»ºï¼Œç…§æ ·è·‘æ¿å­ï¼Œæœ€åç­”æ¡ˆä¹Ÿåè¿‡æ¥å°±è¡Œï¼Œç±»ä¼¼æœ€é•¿è·¯</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> int long long</span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> N = <span class=\"number\">10010</span>, M = <span class=\"number\">200010</span>, INF = <span class=\"number\">1e15</span>;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">edge</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> ed;</span><br><span class=\"line\">    <span class=\"type\">int</span> len;</span><br><span class=\"line\">    <span class=\"type\">int</span> id;</span><br><span class=\"line\">    <span class=\"type\">int</span> cost;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">vector &lt;edge&gt; e[N];</span><br><span class=\"line\"><span class=\"type\">int</span> n, m, S, T;</span><br><span class=\"line\"><span class=\"type\">int</span> dep[N], dis[N], vis[N],ans ,res;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">bool</span> <span class=\"title\">spfa</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">memset</span>(dis,<span class=\"number\">0x3f</span>,<span class=\"built_in\">sizeof</span>(dis));<span class=\"comment\">//åˆå§‹åŒ–</span></span><br><span class=\"line\">    <span class=\"built_in\">memset</span>(vis,<span class=\"number\">0</span>,<span class=\"built_in\">sizeof</span>(vis));</span><br><span class=\"line\">    dis[T]=<span class=\"number\">0</span>;</span><br><span class=\"line\">    vis[T]=<span class=\"number\">1</span>;<span class=\"comment\">//visæ•°ç»„ä»£è¡¨åœ¨ä¸åœ¨é˜Ÿåˆ—ä¸­</span></span><br><span class=\"line\">    deque&lt;<span class=\"type\">int</span>&gt;q;q.<span class=\"built_in\">push_back</span>(T);</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(!q.<span class=\"built_in\">empty</span>())&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> u=q.<span class=\"built_in\">front</span>();q.<span class=\"built_in\">pop_front</span>();</span><br><span class=\"line\">        vis[u]=<span class=\"number\">0</span>;<span class=\"comment\">//å–å‡ºé˜Ÿåˆ—ä¸­çš„å…ƒç´ ï¼Œæ•…visä¸º0</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; e[u].<span class=\"built_in\">size</span>(); i++)&#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> ed = e[u][i].ed;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (e[ed][e[u][i].id].len &amp;&amp; dis[ed]&gt;dis[u]-e[u][i].cost)&#123;<span class=\"comment\">//å–åå‘è¾¹æ˜¯å› ä¸ºæˆ‘ä»¬è¦ä¿è¯æ­£æµï¼Œä½†æ˜¯SPFAæ˜¯å€’ç€è·‘çš„ï¼Œæ‰€ä»¥è¯´æˆ‘ä»¬è¦æ±‚e[u][i]çš„å¯¹åº”åå‘è¾¹æ˜¯æ­£çš„ï¼Œ</span></span><br><span class=\"line\">                dis[ed]=dis[u]-e[u][i].cost;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (!vis[ed])&#123;</span><br><span class=\"line\">                    vis[ed]=<span class=\"literal\">true</span>;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (q.<span class=\"built_in\">empty</span>() || dis[ed]&gt;=dis[q.<span class=\"built_in\">front</span>()])q.<span class=\"built_in\">push_back</span>(ed);<span class=\"comment\">//ä¸€ä¸ªlisä¼˜åŒ–spfaçš„</span></span><br><span class=\"line\">                        <span class=\"keyword\">else</span> q.<span class=\"built_in\">push_front</span>(ed);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> dis[S]&lt;dis[<span class=\"number\">0</span>];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"type\">int</span> st, <span class=\"type\">int</span> limit)</span></span>&#123;</span><br><span class=\"line\">    vis[st]=<span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (st == T||limit==<span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> limit;</span><br><span class=\"line\">    <span class=\"type\">int</span> nowflow=<span class=\"number\">0</span>;<span class=\"comment\">//å®šä¹‰å½“å‰èŠ‚ç‚¹çš„æµé‡</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; e[st].<span class=\"built_in\">size</span>(); i = i + <span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> ed = e[st][i].ed;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (dis[ed] == dis[st] - e[st][i].cost &amp;&amp; e[st][i].len&amp;&amp;!vis[ed])<span class=\"comment\">//è¿™æ¡è¾¹èƒ½æ¨ä¸”ï¼Œæ·±åº¦ä¸ºæ›´æ·±ä¸€å±‚ï¼Œä¸”æ²¡èµ°è¿‡</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> t = <span class=\"built_in\">dfs</span>(ed, <span class=\"built_in\">min</span>(e[st][i].len, limit-nowflow));<span class=\"comment\">//æ˜¯ä¸ºäº†é™åˆ¶åé¢ç‚¹çš„æµé‡ä¸èƒ½å¤§äºlimit-nowflow</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (t)<span class=\"comment\">//èµ°ä¸‹å»èƒ½æ¨æµ</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                res+=t*e[st][i].cost;<span class=\"comment\">//ç»Ÿè®¡ç­”æ¡ˆï¼Œç»è¿‡è¿™ä¸€æ¡è¾¹</span></span><br><span class=\"line\">                e[st][i].len -= t;</span><br><span class=\"line\">                e[ed][e[st][i].id].len += t;</span><br><span class=\"line\">                nowflow+=t;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(nowflow==limit)<span class=\"keyword\">return</span> nowflow;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!nowflow)dep[st]=<span class=\"number\">-1</span>;<span class=\"comment\">//å¦‚æœè¿™ä¸ªç‚¹ä¸èƒ½å»¶ç”³ï¼Œé‚£å°±åˆ æ‰è¿™ä¸ªç‚¹ï¼ˆç‚¸ç‚¹ä¼˜åŒ–ï¼‰</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> nowflow;<span class=\"comment\">//ä¼šè¿”å›æœ¬æ¬¡bfsï¼ˆï¼‰åæ‰€æœ‰å¢å¹¿è·¯èƒ½åŠ çš„æœ€å¤šæµé‡</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">dinic</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(<span class=\"built_in\">spfa</span>())&#123;</span><br><span class=\"line\">        vis[T]=<span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(vis[T])&#123;<span class=\"comment\">//å¦‚æœdfså®Œå·²ç»èµ°ä¸åˆ°täº†é‚£è¯´æ˜è¿™ä¸€è½®ç»“æŸ</span></span><br><span class=\"line\">            <span class=\"built_in\">memset</span>(vis,<span class=\"number\">0</span>,<span class=\"keyword\">sizeof</span> vis);</span><br><span class=\"line\">            ans+=<span class=\"built_in\">dfs</span>(S,INF);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"type\">int</span> u,<span class=\"type\">int</span> v,<span class=\"type\">int</span> w,<span class=\"type\">int</span> c)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//cout&lt;&lt;u&lt;&lt;&quot; &quot;&lt;&lt;v&lt;&lt;&quot; &quot;&lt;&lt;w&lt;&lt;endl;</span></span><br><span class=\"line\">    <span class=\"type\">int</span> sti = e[u].<span class=\"built_in\">size</span>();</span><br><span class=\"line\">    <span class=\"type\">int</span> edi = e[v].<span class=\"built_in\">size</span>();</span><br><span class=\"line\">    e[u].<span class=\"built_in\">push_back</span>((edge)&#123;v, w, edi, c&#125;);<span class=\"comment\">//å»ºè¾¹</span></span><br><span class=\"line\">    e[v].<span class=\"built_in\">push_back</span>((edge)&#123;u, <span class=\"number\">0</span>, sti, -c&#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    cin&gt;&gt;n&gt;&gt;m&gt;&gt;S&gt;&gt;T;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= m; i++)&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> u,v,w,c;</span><br><span class=\"line\">        cin &gt;&gt; u &gt;&gt; v &gt;&gt; w &gt;&gt; c;</span><br><span class=\"line\">        <span class=\"type\">int</span> sti = e[u].<span class=\"built_in\">size</span>();</span><br><span class=\"line\">        <span class=\"type\">int</span> edi = e[v].<span class=\"built_in\">size</span>();</span><br><span class=\"line\">        e[u].<span class=\"built_in\">push_back</span>((edge)&#123;v, w, edi, c&#125;);<span class=\"comment\">//å»ºè¾¹</span></span><br><span class=\"line\">        e[v].<span class=\"built_in\">push_back</span>((edge)&#123;u, <span class=\"number\">0</span>, sti, -c&#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">dinic</span>();</span><br><span class=\"line\">    cout&lt;&lt;ans&lt;&lt;<span class=\"string\">&quot; &quot;</span>&lt;&lt;res;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"2-7-ç½‘ç»œæµç»“è®º\">2.7 ç½‘ç»œæµç»“è®º</h3>\n<h4 id=\"2-7-1-äºŒåˆ†å›¾åšå¼ˆ\">2.7.1 äºŒåˆ†å›¾åšå¼ˆ</h4>\n<p>äºŒåˆ†å›¾åšå¼ˆï¼Œç»™å‡ºä¸€å¼ äºŒåˆ†å›¾å’Œèµ·å§‹ç‚¹ Hï¼ŒA å’Œ Bè½®æµæ“ä½œï¼Œæ¯æ¬¡åªèƒ½é€‰ä¸ä¸Šä¸ªè¢«é€‰æ‹©çš„ç‚¹ï¼ˆç¬¬ä¸€å›åˆåˆ™æ˜¯ç‚¹ Hï¼‰ç›¸é‚»çš„ç‚¹ï¼Œä¸”ä¸èƒ½é€‰æ‹©å·²é€‰æ‹©è¿‡çš„ç‚¹ï¼Œæ— æ³•é€‰ç‚¹çš„äººè¾“æ‰ã€‚</p>\n<p>å…·ä½“æ¥è¯´ï¼Œå°±æ˜¯æ‰€æœ‰çš„çŠ¶æ€å¯ä»¥è¢«åˆ†ä¸ºä¸¤ç±»ï¼Œæ¯æ¬¡æ“ä½œå¿…å®šæ˜¯ä»ä¸€ä¸ªçŠ¶æ€åˆ°å¦ä¸€ç±»çŠ¶æ€ï¼Œä¸èƒ½æ“ä½œçš„äººè¾“</p>\n<p>åšæ³•ï¼Œå¦‚æœäºŒåˆ†å›¾çš„æ‰€æœ‰æœ€å¤§åŒ¹é…éƒ½ç»è¿‡Hï¼Œé‚£ä¹ˆå…ˆæ‰‹å¿…èƒœï¼Œå¦åˆ™å¿…è´¥</p>\n<p>å»ºå›¾ååˆ¤æ–­Hæ˜¯ä¸æ˜¯å¿…é¡»ç‚¹å³å¯ï¼ˆè·‘ä¸¤æ¬¡ï¼Œç¬¬ä¸€æ¬¡ä¸å¸¦Hç‚¹ï¼Œè·‘ä¸€æ¬¡ï¼Œå†å¸¦ä¸ŠHç‚¹ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½æœ‰æ–°å¢æµé‡ï¼Œè‹¥æœ‰åˆ™æ˜¯å¿…é¡»ç‚¹ï¼Œå…ˆæ‰‹å¿…èƒœï¼Œå¦åˆ™å¿…è´¥ï¼‰</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">solve</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    cin&gt;&gt;m&gt;&gt;n&gt;&gt;s;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; N; i++)e[i].<span class=\"built_in\">clear</span>();</span><br><span class=\"line\">    <span class=\"built_in\">memset</span>(sp,<span class=\"number\">0</span>,<span class=\"built_in\">sizeof</span>(sp));</span><br><span class=\"line\">    <span class=\"type\">int</span> M=a[m];S=M<span class=\"number\">+1</span>;T=M<span class=\"number\">+2</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++) &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> x ;cin&gt;&gt;x; sp[x] = <span class=\"number\">1</span>;<span class=\"comment\">//ç¦æ­¢è®¿é—®çš„çŠ¶æ€</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; M; i++) &#123;<span class=\"comment\">//æ¯ä¸ªçŠ¶æ€</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>(sp[i]) <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(odd[i] == odd[s]) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">calc</span>(i);<span class=\"comment\">//içš„åç»§çŠ¶æ€è¿è¾¹</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (i != s) <span class=\"built_in\">add</span>(S, i, <span class=\"number\">1</span>);<span class=\"comment\">//èµ·ç‚¹å…ˆä¸è¿</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"built_in\">add</span>(i, T, <span class=\"number\">1</span>);   </span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">dinic</span>();<span class=\"comment\">//å¦‚ä½•åˆ¤æ–­è¿™ä¸ªç‚¹æ˜¯ä¸æ˜¯æœ€å¤§åŒ¹é…çš„å¿…é¡»ç‚¹ï¼Ÿå…ˆä¸åŠ è¿™ä¸ªç‚¹è·‘ä¸€æ¬¡ï¼Œå†åŠ ä¸Šè·‘ä¸€æ¬¡ï¼Œçœ‹èƒ½ä¸èƒ½æœ‰æ–°æµå³å¯</span></span><br><span class=\"line\">    <span class=\"built_in\">add</span>(S, s, <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"built_in\">dinic</span>())</span><br><span class=\"line\">        cout&lt;&lt;<span class=\"string\">&quot;Alice&quot;</span>&lt;&lt;endl;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> </span><br><span class=\"line\">        cout&lt;&lt;<span class=\"string\">&quot;Bob&quot;</span>&lt;&lt;endl;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"2-7-2-æœ€å°è·¯å¾„è¦†ç›–ä¸ååºé›†åˆDilworthå®šç†\">2.7.2 æœ€å°è·¯å¾„è¦†ç›–ä¸ååºé›†åˆDilworthå®šç†</h4>\n<h5 id=\"2-7-2-1-æœ€å°è·¯å¾„è¦†ç›–\">2.7.2.1 æœ€å°è·¯å¾„è¦†ç›–</h5>\n<p>æœ€å°è·¯å¾„è¦†ç›–é—®é¢˜æ˜¯æŒ‡ç”¨æœ€å°‘çš„<strong>ä¸ç›¸äº¤</strong>è·¯å¾„ï¼Œä½¿å¾—è·¯å¾„è¦†ç›–æ•´ä¸ªæœ‰å‘å›¾çš„æ‰€æœ‰ç‚¹ã€‚</p>\n<p>æœ¬è´¨æ˜¯äºŒåˆ†å›¾çš„æœ€å¤§åŒ¹é…ã€‚</p>\n<p>ç›®æ ‡æ˜¯è¦†ç›–æ‰€æœ‰çš„ç‚¹ï¼Œè¿™äº›è·¯å¾„ä¸è¦æ±‚éå¾—å…±ç”¨èµ·ç‚¹å’Œç»ˆç‚¹ã€‚åˆå§‹è€ƒè™‘æ¯ä¸ªç‚¹éƒ½è¢«ä¸€æ¡è‡ªç¯å”¯ä¸€è¦†ç›–ï¼Œé‚£ä¹ˆä¸€æ¡è¾¹è¿é€šä¸¤ä¸ªç‚¹å°±æ„å‘³ç€è¿™æ¡è¾¹åŒæ—¶è¦†ç›–äº†è¿™ä¸¤ä¸ªç‚¹ï¼ŒåŒæ—¶å› ä¸ºä¸ç›¸äº¤è·¯å¾„çš„å±æ€§ç¡®ä¿äº†å¦‚æœç‚¹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>è¿å‘äº†ç‚¹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span>ï¼Œé‚£ä¹ˆä¸€å®šä¸ä¼šå†æœ‰ç‚¹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>è¿å‘ä»»ä½•ä¸€ä¸ªç‚¹ã€‚ç¡®ä¿ä¸€ä¸ªç‚¹åªè¿æ¥ä¸€æ¡å‡ºè¾¹ï¼Œå°±æ˜¯äºŒåˆ†å›¾çš„æœ€å¤§åŒ¹é…é—®é¢˜ã€‚å»ºå›¾è·‘æœ€å¤§åŒ¹é…åæ‰¾å‡ºæœ€å¤§å¯åŒ–ç®€æ•°é‡ï¼Œç»“æœå°±æ˜¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>âˆ’</mo></mrow><annotation encoding=\"application/x-tex\">n-</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mord\">âˆ’</span></span></span></span>æœ€å¤§æµã€‚</p>\n<p><strong>ç¤ºä¾‹1ï¼šï¼ˆæ¨¡æ¿é¢˜)</strong></p>\n<p>ç»™å®šæœ‰å‘å›¾ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi><mo>=</mo><mo stretchy=\"false\">(</mo><mi>V</mi><mo separator=\"true\">,</mo><mi>E</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">G=(V,E)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mclose\">)</span></span></span></span> ã€‚è®¾ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span> æ˜¯ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi></mrow><annotation encoding=\"application/x-tex\">G</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span></span></span></span> çš„ä¸€ä¸ªç®€å•è·¯ï¼ˆé¡¶ç‚¹ä¸ç›¸äº¤ï¼‰çš„é›†åˆã€‚å¦‚æœ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span> ä¸­æ¯ä¸ªå®šç‚¹æ°å¥½åœ¨ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span> çš„ä¸€æ¡è·¯ä¸Šï¼Œåˆ™ç§° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span> æ˜¯ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi></mrow><annotation encoding=\"application/x-tex\">G</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span></span></span></span> çš„ä¸€ä¸ªè·¯å¾„è¦†ç›–ã€‚<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span> ä¸­è·¯å¾„å¯ä»¥ä» <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span> çš„ä»»ä½•ä¸€ä¸ªå®šç‚¹å¼€å§‹ï¼Œé•¿åº¦ä¹Ÿæ˜¯ä»»æ„çš„ï¼Œç‰¹åˆ«åœ°ï¼Œå¯ä»¥ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>ã€‚<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi></mrow><annotation encoding=\"application/x-tex\">G</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span></span></span></span> çš„æœ€å°è·¯å¾„è¦†ç›–æ˜¯ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi></mrow><annotation encoding=\"application/x-tex\">G</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span></span></span></span> æ‰€å«è·¯å¾„æ¡æ•°æœ€å°‘çš„è·¯å¾„è¦†ç›–ã€‚è®¾è®¡ä¸€ä¸ªæœ‰æ•ˆç®—æ³•æ±‚ä¸€ä¸ª DAGï¼ˆæœ‰å‘æ— ç¯å›¾ï¼‰<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi></mrow><annotation encoding=\"application/x-tex\">G</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span></span></span></span> çš„æœ€å°è·¯å¾„è¦†ç›–ã€‚</p>\n<p><strong>è¾“å…¥æ ¼å¼</strong></p>\n<p>ç¬¬ä¸€è¡Œæœ‰ä¸¤ä¸ªæ­£æ•´æ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> å’Œ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>ã€‚<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> æ˜¯ç»™å®š DAGï¼ˆæœ‰å‘æ— ç¯å›¾ï¼‰<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi></mrow><annotation encoding=\"application/x-tex\">G</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span></span></span></span> çš„é¡¶ç‚¹æ•°ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span> æ˜¯ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi></mrow><annotation encoding=\"application/x-tex\">G</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span></span></span></span> çš„è¾¹æ•°ã€‚æ¥ä¸‹æ¥çš„ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span> è¡Œï¼Œæ¯è¡Œæœ‰ä¸¤ä¸ªæ­£æ•´æ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> å’Œ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span> è¡¨ç¤ºä¸€æ¡æœ‰å‘è¾¹ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(i,j)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">i</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">)</span></span></span></span>ã€‚</p>\n<p><strong>è¾“å‡ºæ ¼å¼</strong></p>\n<p>ä»ç¬¬ä¸€è¡Œå¼€å§‹ï¼Œæ¯è¡Œè¾“å‡ºä¸€æ¡è·¯å¾„ã€‚æ–‡ä»¶çš„æœ€åä¸€è¡Œæ˜¯æœ€å°‘è·¯å¾„æ•°ã€‚</p>\n<p>å¯¹äº <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>100</mn><mi mathvariant=\"normal\">%</mi></mrow><annotation encoding=\"application/x-tex\">100\\%</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8056em;vertical-align:-0.0556em;\"></span><span class=\"mord\">100%</span></span></span></span> çš„æ•°æ®ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>n</mi><mo>â‰¤</mo><mn>150</mn></mrow><annotation encoding=\"application/x-tex\">1\\leq n\\leq 150</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">150</span></span></span></span>ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>m</mi><mo>â‰¤</mo><mn>6000</mn></mrow><annotation encoding=\"application/x-tex\">1\\leq m\\leq 6000</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">6000</span></span></span></span>â€‹â€‹ã€‚</p>\n<p>è®°å½•è·¯å¾„åœ¨dfsä¸­ç»´æŠ¤ä¸€ä¸ªnxtæ•°ç»„è¡¨ç¤ºè¿™ä¸ªç‚¹çš„ä¸‹ä¸€ä¸ªã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> int long long</span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> N = <span class=\"number\">10010</span>, M = <span class=\"number\">200010</span>, INF = <span class=\"number\">1e15</span>;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">edge</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> ed;</span><br><span class=\"line\">    <span class=\"type\">int</span> len;</span><br><span class=\"line\">    <span class=\"type\">int</span> id;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">vector&lt;edge&gt; e[N];</span><br><span class=\"line\"><span class=\"type\">int</span> n, m, S, T;</span><br><span class=\"line\"><span class=\"type\">int</span> dep[N], cur[N], p[N], net[N], d[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">bool</span> <span class=\"title\">bfs</span><span class=\"params\">()</span> <span class=\"comment\">// bfsåˆ†å±‚</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">memset</span>(dep, <span class=\"number\">-1</span>, <span class=\"keyword\">sizeof</span> dep);</span><br><span class=\"line\">    queue&lt;<span class=\"type\">int</span>&gt; q;</span><br><span class=\"line\">    q.<span class=\"built_in\">push</span>(S);</span><br><span class=\"line\">    dep[S] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (!q.<span class=\"built_in\">empty</span>())</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> t = q.<span class=\"built_in\">front</span>();</span><br><span class=\"line\">        q.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; e[t].<span class=\"built_in\">size</span>(); i = i + <span class=\"number\">1</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> ed = e[t][i].ed;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (dep[ed] == <span class=\"number\">-1</span> &amp;&amp; e[t][i].len) <span class=\"comment\">// å¦‚æœè¿™ä¸ªç‚¹æ²¡æœ‰è¢«å®šä¹‰å±‚æ¬¡ï¼Œä¸”è¿˜æœ‰å‰©ä½™æµé‡</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                dep[ed] = dep[t] + <span class=\"number\">1</span>;</span><br><span class=\"line\">                q.<span class=\"built_in\">push</span>(ed);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">memset</span>(cur, <span class=\"number\">0</span>, <span class=\"built_in\">sizeof</span>(cur));</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (dep[T] == <span class=\"number\">-1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"type\">int</span> st, <span class=\"type\">int</span> limit)</span> <span class=\"comment\">// limitæœ€å¤§å¯å¢åŠ çš„æµé‡</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (st == T)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> limit;</span><br><span class=\"line\">    <span class=\"type\">int</span> nowflow = <span class=\"number\">0</span>;                                   <span class=\"comment\">// å®šä¹‰å½“å‰èŠ‚ç‚¹çš„æµé‡,å¤šè·¯å¢å¹¿ä¼˜åŒ–ï¼Œæ‰¾æ»¡å½“å‰èƒ½æ‰¾çš„limitæµé‡ä¸Šç•Œ</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = cur[st]; i &lt; e[st].<span class=\"built_in\">size</span>(); i = i + <span class=\"number\">1</span>) <span class=\"comment\">// å½“å‰å¼§ä¼˜åŒ–ï¼Œå¦‚æœä¸€ä¸ªç‚¹æœ‰å¾ˆå¤šå‡ºè¾¹ï¼Œæœ‰äº›å‡ºè¾¹å¯èƒ½æ— æ³•å†æ¨æµäº†ï¼Œæˆ‘ä»¬å°±è®°å½•ç¬¬ä¸€æ¡å¯ä»¥æ¨æµçš„è¾¹</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cur[st] = i; <span class=\"comment\">// å½“å‰å¼§ä¼˜åŒ–</span></span><br><span class=\"line\">        <span class=\"type\">int</span> ed = e[st][i].ed;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (dep[ed] == dep[st] + <span class=\"number\">1</span> &amp;&amp; e[st][i].len) <span class=\"comment\">// è¿™æ¡è¾¹èƒ½æ¨ä¸”ï¼Œæ·±åº¦ä¸ºæ›´æ·±ä¸€å±‚ï¼ˆä¸ºäº†æ‰¾æœ€çŸ­çš„å¢å¹¿è·¯ï¼‰</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> t = <span class=\"built_in\">dfs</span>(ed, <span class=\"built_in\">min</span>(e[st][i].len, limit - nowflow)); <span class=\"comment\">// æ˜¯ä¸ºäº†é™åˆ¶åé¢ç‚¹çš„æµé‡ä¸èƒ½å¤§äºlimit-nowflow</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (t)                                               <span class=\"comment\">// èµ°ä¸‹å»èƒ½æ¨æµ</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                e[st][i].len -= t;           <span class=\"comment\">// å‡å»ç›¸åº”çš„</span></span><br><span class=\"line\">                e[ed][e[st][i].id].len += t; <span class=\"comment\">// åè¾¹+ç›¸åº”çš„</span></span><br><span class=\"line\">                nowflow += t;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (t)</span><br><span class=\"line\">                    net[st] = ed - n;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (nowflow == limit)</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> nowflow;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!nowflow)</span><br><span class=\"line\">        dep[st] = <span class=\"number\">-1</span>; <span class=\"comment\">// å¦‚æœè¿™ä¸ªç‚¹ä¸èƒ½å»¶ç”³ï¼Œé‚£å°±åˆ æ‰è¿™ä¸ªç‚¹ï¼ˆç‚¸ç‚¹ä¼˜åŒ–ï¼‰</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> nowflow;   <span class=\"comment\">// ä¼šè¿”å›æœ¬æ¬¡bfsï¼ˆï¼‰åæ‰€æœ‰å¢å¹¿è·¯èƒ½åŠ çš„æœ€å¤šæµé‡</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">dinic</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> r = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (<span class=\"built_in\">bfs</span>())</span><br><span class=\"line\">        r += <span class=\"built_in\">dfs</span>(S, INF);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"type\">int</span> u, <span class=\"type\">int</span> v, <span class=\"type\">int</span> w)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// cout&lt;&lt;u&lt;&lt;&quot; &quot;&lt;&lt;v&lt;&lt;&quot; &quot;&lt;&lt;w&lt;&lt;endl;</span></span><br><span class=\"line\">    <span class=\"type\">int</span> sti = e[u].<span class=\"built_in\">size</span>();</span><br><span class=\"line\">    <span class=\"type\">int</span> edi = e[v].<span class=\"built_in\">size</span>();</span><br><span class=\"line\">    e[u].<span class=\"built_in\">push_back</span>((edge)&#123;v, w, edi&#125;); <span class=\"comment\">// å»ºè¾¹</span></span><br><span class=\"line\">    e[v].<span class=\"built_in\">push_back</span>((edge)&#123;u, <span class=\"number\">0</span>, sti&#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">print</span><span class=\"params\">(<span class=\"type\">int</span> x)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d &quot;</span>, x);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (net[x] &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(net[x]);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class=\"line\">    S = <span class=\"number\">0</span>;</span><br><span class=\"line\">    T = <span class=\"number\">2</span> * n + <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= m; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> u, v;</span><br><span class=\"line\">        cin &gt;&gt; u &gt;&gt; v;</span><br><span class=\"line\">        <span class=\"built_in\">add</span>(u, v + n, <span class=\"number\">1</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">add</span>(S, i, <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"built_in\">add</span>(i + n, T, <span class=\"number\">1</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> maxflow = <span class=\"built_in\">dinic</span>();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (net[i])</span><br><span class=\"line\">            d[net[i]]++;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!d[i])</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(i), cout &lt;&lt; endl;</span><br><span class=\"line\">    cout &lt;&lt; n - maxflow;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h5 id=\"2-7-2-2-Dilworthå®šç†\">2.7.2.2 Dilworthå®šç†</h5>\n<p>æ ¹æ®<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi><mi>i</mi><mi>l</mi><mi>w</mi><mi>o</mi><mi>r</mi><mi>t</mi><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">Dilworth</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">lw</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">or</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">h</span></span></span></span>å®šç†ï¼Œååºé›†åˆçš„<strong>æœ€é•¿é“¾é•¿åº¦</strong>ç­‰äºå…¶<strong>æœ€å°çš„åé“¾è¦†ç›–</strong>ã€‚</p>\n<p><strong>é“¾</strong>ï¼šä¸€æ¡é“¾æ˜¯ä¸€äº›<strong>ç‚¹çš„é›†åˆ</strong>ï¼Œç‚¹é›†ä¸­ä»»æ„ä¸¤ä¸ªç‚¹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>å’Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>ï¼Œæ»¡è¶³<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>èƒ½åˆ°è¾¾<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>æˆ–æ˜¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>èƒ½åˆ°è¾¾<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>ï¼ˆå­˜åœ¨ååºå…³ç³»ï¼‰ï¼Œåˆ™ç§°è¯¥ç‚¹é›†ä¸ºä¸€æ¡é“¾ã€‚</p>\n<p><strong>åé“¾</strong>ï¼šä¸€æ¡åé“¾æ˜¯ä¸€äº›<strong>ç‚¹çš„é›†åˆ</strong>ï¼Œç‚¹é›†ä¸­ä»»æ„ä¸¤ä¸ªç‚¹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>å’Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>ï¼Œæ»¡è¶³<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>ä¸èƒ½åˆ°è¾¾<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>å¹¶ä¸”<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>ä¸èƒ½åˆ°è¾¾<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>â€‹ï¼Œåˆ™ç§°è¯¥ç‚¹é›†ä¸ºä¸€æ¡åé“¾ã€‚</p>\n<p><strong>æœ€å°é“¾è¦†ç›–</strong>æ˜¯æŒ‡åœ¨æœ‰å‘å›¾ä¸­ç”¨<strong>å¯ä»¥ç›¸äº¤</strong>çš„è‹¥å¹²æ¡è·¯å¾„è¦†ç›–æ•´ä¸ªå›¾ä¸”è·¯å¾„æ•°æœ€å°‘ã€‚</p>\n<p><strong>æ±‚å‡ºæœ‰å‘å›¾çš„ä¼ é€’é—­åŒ…ä¹‹åå³å¯æŒ‰ç…§ç¤ºä¾‹ä¸€ä¸ç›¸äº¤è·¯å¾„æ±‚è§£ï¼ŒäºŒåˆ†å›¾æœ€å¤§åŒ¹é…å³å¯ã€‚</strong></p>\n<p>å¦‚æœæœ‰å‘å›¾æ˜¯ä¸€ä¸ª<strong>å®Œå¤‡</strong>çš„<strong>ååºé›†åˆå“ˆæ–¯å›¾</strong>ï¼ˆå³å…¶ä¼ é€’é—­åŒ…ç­‰äºè‡ªèº«ï¼‰ï¼Œåˆ™<strong>æœ€å°é“¾è¦†ç›–ç­‰ä»·äºæœ€å°è·¯å¾„è¦†ç›–</strong>ã€‚æ­¤æ—¶ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi><mi>i</mi><mi>l</mi><mi>w</mi><mi>o</mi><mi>r</mi><mi>t</mi><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">Dilworth</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">lw</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">or</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">h</span></span></span></span>å®šç†å¯é‡æ–°è¡¨è¿°ä¸º<strong>æœ€å¤§é“¾é•¿åº¦ç­‰äºæœ€å°çš„åé“¾åˆ’åˆ†</strong>ã€‚</p>\n<p><strong>ç¤ºä¾‹1ï¼šABC237Ex Hakata</strong></p>\n<p>æˆ‘ä»¬æœ‰ä¸€ä¸ªç”±å°å†™è‹±æ–‡å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸² <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span> ã€‚Bob æ¯å¤©éƒ½åœ¨æ€è€ƒå›æ–‡ã€‚ä»–å†³å®šä» <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span> ä¸­é€‰æ‹©ä¸€äº›å›æ–‡å­ä¸²å¹¶å‘Šè¯‰ Annaã€‚</p>\n<p>å¦‚æœ Bob å‘Šè¯‰çš„å›æ–‡ä¹‹ä¸€æ˜¯å¦ä¸€ä¸ªå›æ–‡çš„å­ä¸²ï¼ŒAnna ä¼šç”Ÿæ°”ã€‚Bob å¯ä»¥é€‰æ‹©æœ€å¤šå¤šå°‘ä¸ªå›æ–‡è€Œä¸ä¼šè®© Anna ç”Ÿæ°”ï¼Ÿ</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>â‰¤</mo><mn>300</mn></mrow><annotation encoding=\"application/x-tex\">N\\le 300</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8193em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">300</span></span></span></span></p>\n<p>æ˜¾ç„¶ï¼ŒåŒ…å«æ˜¯ä¸€ä¸ªååºå…³ç³»ã€‚æˆ‘ä»¬è¦æ±‚è§£çš„æ˜¯<strong>æœ€é•¿çš„äº’ç›¸ä¸åŒ…å«çš„å›æ–‡ä¸²åºåˆ—é•¿åº¦</strong>ï¼Œå®é™…ä¸Šå°±æ˜¯<strong>æœ€é•¿çš„åé“¾é•¿åº¦</strong>ã€‚</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi><mi>i</mi><mi>l</mi><mi>w</mi><mi>o</mi><mi>r</mi><mi>t</mi><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">Dilworth</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">lw</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">or</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">h</span></span></span></span>å®šç†è½¬<strong>æœ€å°çš„åé“¾è¦†ç›–</strong>ã€‚ç”±äºæˆ‘ä»¬èƒ½å¤Ÿå»ºç«‹å‡ºå®Œå¤‡çš„ååºå“ˆæ–¯å›¾ï¼ˆå®é™…ä¸Šéƒ½å¯ä»¥ï¼‰ï¼Œåˆè½¬<strong>æœ€å°åé“¾åˆ’åˆ†</strong>ï¼Œå³<strong>æœ€å°è·¯å¾„è¦†ç›–</strong>ã€‚</p>\n<p>æ±‚äºŒåˆ†å›¾æœ€å¤§åŒ¹é…ï¼Œå‚è€ƒç¤ºä¾‹1ï¼Œä½œå·®å³å¯ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">solve</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    string s;</span><br><span class=\"line\">    cin &gt;&gt; s;</span><br><span class=\"line\">    vector&lt;string&gt; pali;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; s.<span class=\"built_in\">size</span>(); i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">1</span>; i + j &lt;= s.<span class=\"built_in\">size</span>(); j++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            string t = s.<span class=\"built_in\">substr</span>(i, j);</span><br><span class=\"line\">            string r = t;</span><br><span class=\"line\">            <span class=\"built_in\">reverse</span>(r.<span class=\"built_in\">begin</span>(), r.<span class=\"built_in\">end</span>());</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (t == r)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                pali.<span class=\"built_in\">push_back</span>(t);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">sort</span>(pali.<span class=\"built_in\">begin</span>(), pali.<span class=\"built_in\">end</span>());</span><br><span class=\"line\">    pali.<span class=\"built_in\">erase</span>(<span class=\"built_in\">unique</span>(pali.<span class=\"built_in\">begin</span>(), pali.<span class=\"built_in\">end</span>()), pali.<span class=\"built_in\">end</span>());</span><br><span class=\"line\">    <span class=\"type\">int</span> sz = pali.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">    <span class=\"function\">MaxFlow&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">mf</span><span class=\"params\">(<span class=\"number\">2</span> * sz + <span class=\"number\">10</span>)</span></span>;</span><br><span class=\"line\">    <span class=\"type\">const</span> <span class=\"type\">int</span> S = <span class=\"number\">2</span> * sz, T = <span class=\"number\">2</span> * sz + <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; sz; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        mf.<span class=\"built_in\">addEdge</span>(S, i, <span class=\"number\">1</span>);</span><br><span class=\"line\">        mf.<span class=\"built_in\">addEdge</span>(sz + i, T, <span class=\"number\">1</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; sz; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt; sz; j++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (i == j)</span><br><span class=\"line\">                <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (pali[i].<span class=\"built_in\">find</span>(pali[j]) != string::npos)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                mf.<span class=\"built_in\">addEdge</span>(i, sz + j, <span class=\"number\">1</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; sz - mf.<span class=\"built_in\">flow</span>(S, T) &lt;&lt; endl;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"2-7-3-æœ€å¤§æµæœ€å°å‰²å®šç†\">2.7.3 æœ€å¤§æµæœ€å°å‰²å®šç†</h4>\n<p>æœ€å¤§æµ=æœ€å°å‰²ã€‚</p>\n<p>å‰²é›†å¥½æ¯”æ˜¯ä¸€ä¸ªææ€–åˆ†å­ æŠŠä½ å®¶å’Œè‡ªæ¥æ°´å‚ä¹‹é—´çš„æ°´ç®¡ç½‘ç»œç æ–­äº†ä¸€äº› ç„¶åè‡ªæ¥æ°´å‚æ— è®ºæ€ä¹ˆæ”¾æ°´ æ°´éƒ½åªèƒ½ä»æ°´ç®¡æ–­å£å“—å“—æµèµ°äº† ä½ å®¶å°±åœæ°´äº† å‰²çš„å¤§å°åº”è¯¥æ˜¯ææ€–åˆ†å­åº”è¯¥å…³å¿ƒçš„äº‹ æ¯•ç«Ÿç»†ç®¡å­å¥½å‰²ä¸€äº› è€Œæœ€å°å‰²èŠ±çš„åŠ›æ°”æœ€å°</p>\n<p>ç½‘ç»œçš„æœ€å¤§æµç­‰äºæœ€å°å‰²</p>\n<p>å…·ä½“çš„è¯æ˜åˆ†ä¸‰éƒ¨åˆ†</p>\n<ol>\n<li>ä»»æ„ä¸€ä¸ªæµéƒ½å°äºç­‰äºä»»æ„ä¸€ä¸ªå‰²ã€‚</li>\n</ol>\n<p>è¿™ä¸ªå¾ˆå¥½ç†è§£ï¼Œè‡ªæ¥æ°´å…¬å¸éšä¾¿ç»™ä½ å®¶é€šç‚¹æ°´æ„æˆä¸€ä¸ªæµï¼Œææ€–åˆ†å­éšä¾¿ç å‡ åˆ€ï¼Œç å‡ºä¸€ä¸ªå‰²ï¼Œç”±äºå®¹é‡é™åˆ¶ï¼Œæ¯ä¸€æ ¹çš„è¢«ç çš„æ°´ç®¡å­æµå‡ºçš„æ°´æµé‡éƒ½å°äºç®¡å­çš„å®¹é‡ï¼Œæ¯ä¸€æ ¹è¢«ç çš„æ°´ç®¡çš„æ°´æœ¬æ¥éƒ½è¦åˆ°ä½ å®¶çš„ï¼Œç°åœ¨æµåˆ°å¤–é¢ï¼ŒåŠ èµ·æ¥å¾—åˆ°çš„æµé‡è¿˜æ˜¯ç­‰äºåŸæ¥çš„æµã€‚ç®¡å­çš„å®¹é‡åŠ èµ·æ¥å°±æ˜¯å‰²ï¼Œæ‰€ä»¥æµå°äºç­‰äºå‰²ã€‚ç”±äºä¸Šé¢çš„æµå’Œå‰²éƒ½æ˜¯ä»»æ„æ„é€ çš„ï¼Œæ‰€ä»¥ä»»æ„ä¸€ä¸ªæµå°äºä»»æ„ä¸€ä¸ªå‰²ã€‚</p>\n<ol start=\"2\">\n<li>æ„é€ å‡ºä¸€ä¸ªæµç­‰äºä¸€ä¸ªå‰²ã€‚</li>\n</ol>\n<p>å½“è¾¾åˆ°æœ€å¤§æµæ—¶ï¼Œæ ¹æ®å¢å¹¿è·¯å®šç†ï¼Œæ®‹ç•™ç½‘ç»œä¸­<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>åˆ°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>å·²ç»æ²¡æœ‰é€šè·¯äº†ï¼Œå¦åˆ™è¿˜èƒ½ç»§ç»­å¢å¹¿ã€‚æˆ‘ä»¬æŠŠ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>èƒ½åˆ°çš„çš„ç‚¹é›†è®¾ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span>ï¼Œä¸èƒ½åˆ°çš„ç‚¹é›†ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>ï¼Œæ„é€ å‡ºä¸€ä¸ªå‰²é›†<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi><mo stretchy=\"false\">[</mo><mi>S</mi><mo separator=\"true\">,</mo><mi>T</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">C[S,T]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mclose\">]</span></span></span></span>ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span>åˆ°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>çš„è¾¹å¿…ç„¶æ»¡æµï¼Œå¦åˆ™å°±èƒ½ç»§ç»­å¢å¹¿ï¼Œè¿™äº›æ»¡æµè¾¹çš„æµé‡å’Œå°±æ˜¯å½“å‰çš„æµå³æœ€å¤§æµã€‚æŠŠè¿™äº›æ»¡æµè¾¹ä½œä¸ºå‰²ï¼Œå°±æ„é€ å‡ºäº†ä¸€ä¸ªå’Œæœ€å¤§æµç›¸ç­‰çš„å‰²ã€‚</p>\n<ol start=\"3\">\n<li>æœ€å¤§æµç­‰äºæœ€å°å‰²ã€‚</li>\n</ol>\n<p>è®¾ç›¸ç­‰çš„æµå’Œå‰²åˆ†åˆ«ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>F</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">F_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>å’Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>C</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">C_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼Œåˆ™å› ä¸ºä»»æ„ä¸€ä¸ªæµå°äºç­‰äºä»»æ„ä¸€ä¸ªå‰²ï¼Œä»»æ„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mo>â‰¤</mo><mi>F</mi><mi>m</mi><mo>=</mo><mi>C</mi><mi>m</mi><mo>â‰¤</mo></mrow><annotation encoding=\"application/x-tex\">Fâ‰¤Fm=Cmâ‰¤</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8193em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8193em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span></span></span></span>ä»»æ„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi></mrow><annotation encoding=\"application/x-tex\">C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span></span></span></span> ã€‚</p>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"2-7-4-æœ€å¤§æƒé—­åˆå­å›¾\">2.7.4 æœ€å¤§æƒé—­åˆå­å›¾</h4>\n<p>æœ€å¤§æƒé—­åˆå­å›¾ï¼šç»™å®šä¸€ä¸ªæœ‰å‘å›¾, é¡¶ç‚¹å¸¦æƒå€¼. ä½ å¯ä»¥é€‰ä¸­ä¸€äº›é¡¶ç‚¹, è¦æ±‚å½“é€‰ä¸­ä¸€ä¸ªç‚¹ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span> çš„æ—¶å€™, è‹¥å­˜åœ¨è¾¹ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo>â†’</mo><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">u\\rightarrow v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â†’</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span> åˆ™ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>â€‹ ä¹Ÿå¿…é¡»é€‰ä¸­. æœ€å¤§åŒ–é€‰ä¸­çš„ç‚¹çš„æ€»æƒå€¼.</p>\n<p>å»ºæ¨¡ï¼šè´Ÿç‚¹æƒç‚¹å‘é‡ç‚¹è¿è¾¹ï¼Œæºç‚¹å‘æ­£ç‚¹æƒç‚¹è¿è¾¹ï¼Œå›¾ä¸­åŸå…ˆçš„ç‚¹è¿æ— ç©·å¤§è¾¹ï¼Œè·‘æœ€å°å‰²å³å¯ï¼Œæœ€ç»ˆç»“æœå°±æ˜¯æ‰€æœ‰æ­£ç‚¹æƒä¹‹å’Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>âˆ’</mo></mrow><annotation encoding=\"application/x-tex\">-</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">âˆ’</span></span></span></span>æœ€å°å‰²ã€‚</p>\n<p>ç¤ºä¾‹ï¼š<strong>CFedu171 Best Subsequence</strong></p>\n<p>ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ $$a$$ ï¼Œå¤§å°ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> ã€‚</p>\n<p>æˆ‘ä»¬å°†æ•°ç»„çš„å€¼å®šä¹‰ä¸ºå…¶å¤§å°å‡å»æ•°ç»„æ‰€æœ‰å…ƒç´ æŒ‰ä½æˆ–ä¸­çš„è®¾ç½®ä½æ•°ã€‚</p>\n<p>ä¾‹å¦‚ï¼Œå¯¹äºæ•°ç»„ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[1, 0, 1, 2]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mclose\">]</span></span></span></span> ï¼ŒæŒ‰ä½æˆ–ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span></span></span></span> (åŒ…å« <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span> ä¸ªè®¾ç½®ä½)ï¼Œæ•°ç»„çš„å€¼ä¸º $$4-2=2$$ ã€‚</p>\n<p>æ‚¨çš„ä»»åŠ¡æ˜¯è®¡ç®—ç»™å®šæ•°ç»„çš„æŸä¸ªå­åºåˆ—çš„æœ€å¤§å¯èƒ½å€¼ã€‚</p>\n<p>æ˜¾ç„¶æ˜¯æœ€å¤§æƒé—­åˆå­å›¾é—®é¢˜ï¼Œæˆ–è€…å¯ä»¥ç†è§£ä¸ºäºŒè€…é€‰å…¶ä¸€é—®é¢˜ã€‚è¯¥ç‚¹è¦è¢«é€‰æ‹©ï¼Œè¿™äº›ä½ç½®éƒ½è¦è¢«æ‰£1.</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">solve</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"function\">vector&lt;i64&gt; <span class=\"title\">a</span><span class=\"params\">(n)</span></span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cin &gt;&gt; a[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    MaxFlow&lt;i64&gt; f;</span><br><span class=\"line\">    <span class=\"type\">int</span> sz = n + <span class=\"number\">60</span> + <span class=\"number\">2</span>;</span><br><span class=\"line\">    f.<span class=\"built_in\">init</span>(sz);</span><br><span class=\"line\">    <span class=\"type\">const</span> <span class=\"type\">int</span> s = n + <span class=\"number\">60</span>, t = n + <span class=\"number\">60</span> + <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        f.<span class=\"built_in\">addEdge</span>(s, i, <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">59</span>; j &gt;= <span class=\"number\">0</span>; j--)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> ((a[i] &gt;&gt; j) &amp; <span class=\"number\">1</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                f.<span class=\"built_in\">addEdge</span>(i, n + j, <span class=\"number\">1</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">59</span>; j &gt;= <span class=\"number\">0</span>; j--)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        f.<span class=\"built_in\">addEdge</span>(n + j, t, <span class=\"number\">1</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    i64 ans = f.<span class=\"built_in\">flow</span>(s, t);</span><br><span class=\"line\">    cout &lt;&lt; n - ans &lt;&lt; endl;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"2-7-5-äºŒè€…é€‰å…¶ä¸€é—®é¢˜\">2.7.5  äºŒè€…é€‰å…¶ä¸€é—®é¢˜</h4>\n<p>å°†è‹¥å¹²å…ƒç´ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>e</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>e</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>â€¦</mo><mo separator=\"true\">,</mo><msub><mi>e</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">e_1,e_2,â€¦,e_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">â€¦</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>åˆ’åˆ†åˆ°ä¸¤ä¸ªé›†åˆ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo separator=\"true\">,</mo><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">A,B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span>ä¸­ã€‚å¯¹äºå…ƒç´ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>e</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">e_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>,å®ƒè¢«åˆ’åˆ†åˆ°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>æˆ–<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span>ä¸­åˆ†åˆ«èƒ½è·å¾—ä¸€ä¸ª<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><msub><mi>e</mi><mi>i</mi></msub></msub></mrow><annotation encoding=\"application/x-tex\">a_{e_i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6807em;vertical-align:-0.2501em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span></span></span></span>æˆ–<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>b</mi><msub><mi>e</mi><mi>i</mi></msub></msub></mrow><annotation encoding=\"application/x-tex\">b_{e_i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9445em;vertical-align:-0.2501em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span></span></span></span>çš„åˆ†å€¼ã€‚é™¤æ­¤ä¹‹å¤–,è¿˜ç»™å‡ºè‹¥å¹²ä¸ªç»„åˆ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>C</mi><mi>i</mi></msub><mo>âˆˆ</mo><mi>E</mi></mrow><annotation encoding=\"application/x-tex\">C_i\\in E</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span></span></span></span>,å½“ç»„åˆä¸­çš„å…ƒç´ è¢«åŒæ—¶åˆ’åˆ†åˆ°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>æˆ–<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span>æ—¶,å¯ä»¥è·å¾—é¢å¤–çš„åˆ†å€¼<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>a</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">â€²</mo></msup></mrow><annotation encoding=\"application/x-tex\">a&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">â€²</span></span></span></span></span></span></span></span></span></span></span></span>æˆ–<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>b</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">â€²</mo></msup></mrow><annotation encoding=\"application/x-tex\">b&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">â€²</span></span></span></span></span></span></span></span></span></span></span></span>ã€‚æ±‚æœ€å¤§çš„åˆ†å€¼ã€‚</p>\n<p>åŸºæœ¬æ¨¡å‹æ˜¯è®¾ç«‹ä¸¤ä¸ªè¶…çº§æºç‚¹ï¼Œæ¯ä¸ªç‰©å“åˆ†åˆ«è¿ï¼Œæœ€å¤§æ”¶ç›Šå°±æ˜¯æ”¶ç›Šæ€»å’Œ-æœ€å°å‰²</p>\n<p>å¯¹äºåŒå±äºä¸€éçš„é¢å¤–ç»„åˆï¼Œåˆ™æ–°å»ºèŠ‚ç‚¹ï¼Œè¶…çº§æºç‚¹ï¼ˆä»¥<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>ç¤ºä¾‹ï¼‰å‘è¯¥æ–°èŠ‚ç‚¹æµé¢å¤–æ”¶ç›Š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>a</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">â€²</mo></msup></mrow><annotation encoding=\"application/x-tex\">a&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">â€²</span></span></span></span></span></span></span></span></span></span></span></span>ï¼Œä¸ºä¿è¯åç»­èŠ‚ç‚¹å¿…å®šåœ¨<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>éƒ¨ï¼Œè¯¥æ–°èŠ‚ç‚¹å‘è¯¥ç»„åˆçš„ä¸­é—´ç‚¹è¿æ— ç©·å¤§è¾¹ï¼Œè¿«ä½¿æœ€å°å‰²å¦‚æœä¿ç•™äº†<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>a</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">â€²</mo></msup></mrow><annotation encoding=\"application/x-tex\">a&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">â€²</span></span></span></span></span></span></span></span></span></span></span></span>è¾¹ï¼Œå°±å¿…é¡»éš”æ–­æ‰€æœ‰å’Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span>çš„è¾¹ï¼Œä»¥è¾¾æˆæ­£ç¡®æ€§ã€‚</p>\n<img src=\"https://pic4.zhimg.com/v2-3f06c22d87598fc1b5c1774376d303c3_r.jpg\" alt=\"img\" style=\"zoom:25%;\" />\n<p>ç¤ºä¾‹ï¼š<strong>2024æ­ç”µå¤šæ ¡ï¼ˆ5ï¼‰çŒ«å’ªä»¬ç‹‚æ¬¢</strong></p>\n<p>çŒ«å’ªä»¬ç”Ÿæ´»åœ¨æ ‘ä¸Šã€‚</p>\n<p>å…·ä½“æ¥è¯´ï¼Œæœ‰ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> åªçŒ«å’ªå’Œä¸¤æ£µå¤§å°ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>çš„æ ‘ã€‚çŒ«å’ªç¼–å·ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>âˆ¼</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">1âˆ¼n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆ¼</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> ï¼Œæ¯æ£µæ ‘ä¸Šçš„èŠ‚ç‚¹ç¼–å·ä¹Ÿä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>âˆ¼</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">1âˆ¼n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆ¼</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>ï¼ˆç¼–å·å„ä¸ç›¸åŒï¼‰ ã€‚</p>\n<p>ä»Šæ™šï¼Œæ¯åªçŒ«å’ªè¦åˆ†åˆ«é€‰æ‹©ä¸€æ£µæ ‘ï¼Œå¹¶å¾…åœ¨ä¸å…¶ç¼–å·ç›¸åŒçš„èŠ‚ç‚¹ã€‚</p>\n<p>åœ¨è¿™ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> åªçŒ«å’ªä¹‹ä¸­ï¼Œæœ‰ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> åªçŒ«å’ªæ˜¯ç‹‚æ¬¢çŒ«ã€‚ç‹‚æ¬¢çŒ«æ™šä¸Šä¸ä¼šç¡è§‰ï¼Œè€Œæ˜¯ä¼šé€‰æ‹©å¼€partyã€‚å…¶ä»–çŒ«å’ªåˆ™ä¼šé€‰æ‹©ç¡è§‰ã€‚</p>\n<p>æ¯æ¡æ ‘è¾¹éƒ½æœ‰ä¸€ä¸ªç‹‚æ¬¢å€¼ï¼Œå¦‚æœè¿™æ¡è¾¹è¿æ¥çš„ä¸¤ä¸ªèŠ‚ç‚¹åœ¨æ™šä¸Šéƒ½æœ‰ç‹‚æ¬¢çŒ«å¾…ç€ï¼Œè¿™ä¸ªç‹‚æ¬¢å€¼å°±ä¼šè¢«ç´¯åŠ åˆ°æ€»ç‹‚æ¬¢å€¼ä¸Šã€‚</p>\n<p>æœ€å¤§åŒ–ä»Šæ™šçš„æ€»ç‹‚æ¬¢å€¼ï¼Œå¹¶è¾“å‡ºè¿™ä¸ªå€¼ã€‚</p>\n<p>æ˜¾ç„¶æ˜¯äºŒè€…é€‰å…¶ä¸€é—®é¢˜ï¼Œæ¯åªçŒ«å’ªæœ‰é€‰æ‹©å·¦è¿˜æ˜¯é€‰æ‹©å³çš„é—®é¢˜ï¼Œæœ‰æœ€å¤š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">n-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>ç»„ç»„åˆä¼šæœ‰é¢å¤–æ”¶ç›Šã€‚ç‹‚æ¬¢çŒ«åªæœ‰<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>åªï¼Œæ¶‰åŠåˆ°çš„ç‹‚æ¬¢çŒ«æ‰å½¢æˆç»„é˜ŸèŠ‚ç‚¹ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">solve</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n, k;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; k;</span><br><span class=\"line\">    <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">cat</span><span class=\"params\">(k + <span class=\"number\">1</span>)</span></span>;</span><br><span class=\"line\">    map&lt;<span class=\"type\">int</span>, <span class=\"type\">int</span>&gt; mp;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= k; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cin &gt;&gt; cat[i];</span><br><span class=\"line\">        mp[cat[i]] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">const</span> <span class=\"type\">int</span> s = <span class=\"number\">0</span>, t = n + <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"function\">MaxFlow&lt;i64&gt; <span class=\"title\">flow</span><span class=\"params\">(<span class=\"number\">4</span> * n + <span class=\"number\">10</span>)</span></span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> virp = n + <span class=\"number\">2</span>;</span><br><span class=\"line\">    i64 ans = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt; n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> u, v, w;</span><br><span class=\"line\">        cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (mp[u] &amp;&amp; mp[v])</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            flow.<span class=\"built_in\">addEdge</span>(s, virp, w);</span><br><span class=\"line\">            flow.<span class=\"built_in\">addEdge</span>(virp, u, INT_MAX / <span class=\"number\">2</span>);</span><br><span class=\"line\">            flow.<span class=\"built_in\">addEdge</span>(virp, v, INT_MAX / <span class=\"number\">2</span>);</span><br><span class=\"line\">            ans += w;</span><br><span class=\"line\">            virp++;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt; n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> u, v, w;</span><br><span class=\"line\">        cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (mp[u] &amp;&amp; mp[v])</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            flow.<span class=\"built_in\">addEdge</span>(virp, t, w);</span><br><span class=\"line\">            flow.<span class=\"built_in\">addEdge</span>(u, virp, INT_MAX / <span class=\"number\">2</span>);</span><br><span class=\"line\">            flow.<span class=\"built_in\">addEdge</span>(v, virp, INT_MAX / <span class=\"number\">2</span>);</span><br><span class=\"line\">            ans += w;</span><br><span class=\"line\">            virp++;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; ans - flow.<span class=\"built_in\">flow</span>(s, t) &lt;&lt; endl;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"2-7-6-äºŒåˆ†å›¾æœ€å¤§è¾¹æƒåŒ¹é…\">2.7.6 äºŒåˆ†å›¾æœ€å¤§è¾¹æƒåŒ¹é…</h4>\n<p>äºŒåˆ†å›¾çš„æœ€å¤§æƒåŒ¹é…æ˜¯æŒ‡äºŒåˆ†å›¾ä¸­è¾¹æƒå’Œæœ€å¤§çš„åŒ¹é…ã€‚æ•°æ®ä¿è¯æœ‰è§£ã€‚</p>\n<p>è€ƒè™‘è´¹ç”¨æµã€‚</p>\n<p>ä¸ <strong>äºŒåˆ†å›¾æœ€å¤§åŒ¹é…</strong>ç±»ä¼¼ï¼ŒäºŒåˆ†å›¾çš„æœ€å¤§æƒåŒ¹é…ä¹Ÿå¯ä»¥è½¬åŒ–ä¸ºç½‘ç»œæµé—®é¢˜æ¥æ±‚è§£ã€‚</p>\n<p>é¦–å…ˆï¼Œåœ¨å›¾ä¸­æ–°å¢ä¸€ä¸ªæºç‚¹å’Œä¸€ä¸ªæ±‡ç‚¹ã€‚</p>\n<p>ä»æºç‚¹å‘äºŒåˆ†å›¾çš„æ¯ä¸ªå·¦éƒ¨ç‚¹è¿ä¸€æ¡æµé‡ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> ï¼Œè´¹ç”¨ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span> çš„è¾¹ï¼Œä»äºŒåˆ†å›¾çš„æ¯ä¸ªå³éƒ¨ç‚¹å‘æ±‡ç‚¹è¿ä¸€æ¡æµé‡ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> ï¼Œè´¹ç”¨ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span> çš„è¾¹ã€‚</p>\n<p>æ¥ä¸‹æ¥å¯¹äºäºŒåˆ†å›¾ä¸­æ¯ä¸€æ¡è¿æ¥å·¦éƒ¨ç‚¹ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span> å’Œå³éƒ¨ç‚¹ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span> ï¼Œè¾¹æƒä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span> çš„è¾¹ï¼Œåˆ™è¿ä¸€æ¡ä» <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span> åˆ° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>ï¼Œæµé‡ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> ï¼Œè´¹ç”¨ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span> çš„è¾¹ã€‚</p>\n<p>å¦å¤–ï¼Œè€ƒè™‘åˆ°<em><strong>æœ€å¤§æƒåŒ¹é…ä¸‹</strong></em>ï¼Œ<em><strong>åŒ¹é…è¾¹çš„æ•°é‡ä¸ä¸€å®šä¸æœ€å¤§åŒ¹é…çš„åŒ¹é…è¾¹æ•°é‡ç›¸ç­‰ï¼ˆä¸ä¸€å®šæœ€å¤§æµï¼‰</strong></em>ï¼Œå› æ­¤å¯¹äºæ¯ä¸ªå·¦éƒ¨ç‚¹ï¼Œè¿˜éœ€å‘æ±‡ç‚¹è¿ä¸€æ¡æµé‡ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> ï¼Œè´¹ç”¨ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span> çš„è¾¹ã€‚</p>\n<p>æ±‚è¿™ä¸ªç½‘ç»œçš„ <strong>æœ€å¤§è´¹ç”¨æœ€å¤§æµ</strong>å³å¯å¾—åˆ°ç­”æ¡ˆã€‚æ­¤æ—¶ï¼Œè¯¥ç½‘ç»œçš„æœ€å¤§æµé‡ä¸€å®šä¸ºå·¦éƒ¨ç‚¹çš„æ•°é‡ï¼Œè€Œæœ€å¤§æµé‡ä¸‹çš„æœ€å¤§è´¹ç”¨å³å¯¹åº”ä¸€ä¸ªæœ€å¤§æƒåŒ¹é…æ–¹æ¡ˆã€‚æœ€å¤§è´¹ç”¨æœ€å¤§æµå¯ä»¥ç›´æ¥è´Ÿè´¹ç”¨çš„æœ€å°è´¹ï¼ŒJianglyæ¨¡æ¿æ”¯æŒã€‚</p>\n<h4 id=\"2-7-7-äºŒåˆ†å›¾æœ€å°è¾¹æƒç‚¹è¦†ç›–\">2.7.7 äºŒåˆ†å›¾æœ€å°è¾¹æƒç‚¹è¦†ç›–</h4>\n<p>äºŒåˆ†å›¾çš„æœ€å°è¾¹æƒç‚¹è¦†ç›–æŒ‡æ‰¾åˆ°ä¸€ä¸ªè¾¹æƒå’Œæœ€å°çš„é¡¶ç‚¹è¦†ç›–ã€‚æ•°æ®ä¿è¯æœ‰è§£ã€‚</p>\n<p>è€ƒè™‘æœ€å°è¦†ç›–çš„ä¸€ç§æ„é€ æ–¹å¼ï¼š</p>\n<p>é€‰æ‹©ä¸€ä¸ªåŒ¹é…è¾¹é›†åˆ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>E</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">E_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼Œæ‰€æœ‰ä¸å±äº<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>E</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">E_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>åŒ…å«çš„ç‚¹é›†<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>V</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">V_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>çš„ç‚¹é€‰æ‹©ä¸€æ¡ä¸è‡ªå·±ç›¸é‚»çš„ç‚¹ä¸­è¾¹æƒæœ€å°çš„é‚£ä¸€ä¸ªç‚¹ï¼Œæ·»åŠ å¯¹åº”è¾¹ï¼ˆ<strong>å…è®¸é‡è¾¹</strong>ï¼‰ã€‚å¯ä»¥è¯æ˜æœ€ä¼˜è§£ä¸€å®šå¯ä»¥è¢«è¿™ç§æ„é€ æ–¹å¼æ„é€ ï¼Œä¸”æ˜¯å¦æ˜¯æœ€ä¼˜è§£ä¸€å®šå–å†³äº<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>E</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">E_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>çš„é€‰æ‹©ã€‚</p>\n<p>è®¾ç‚¹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>ä¸ºç«¯ç‚¹çš„è¾¹çš„æœ€å°è¾¹æƒä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi><msub><mi>m</mi><mi>u</mi></msub></mrow><annotation encoding=\"application/x-tex\">wm_u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼Œåˆ™æœ‰ä¸€ä¸ªéå¸¸ç®€å•çš„åŒ–ç®€ï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>C</mi><mi>o</mi><mi>s</mi><mi>t</mi><mo>=</mo><munder><mo>âˆ‘</mo><mrow><mi>e</mi><mo>âˆˆ</mo><msub><mi>E</mi><mn>1</mn></msub></mrow></munder><mi>c</mi><mo stretchy=\"false\">(</mo><mi>e</mi><mo stretchy=\"false\">)</mo><mo>+</mo><munder><mo>âˆ‘</mo><mrow><mi>v</mi><mo>âˆˆ</mo><mi>V</mi><mi mathvariant=\"normal\">\\</mi><msub><mi>V</mi><mn>1</mn></msub></mrow></munder><mi>w</mi><msub><mi>m</mi><mi>v</mi></msub><mo>=</mo><munder><mo>âˆ‘</mo><mrow><mi>v</mi><mo>âˆˆ</mo><mi>V</mi></mrow></munder><mi>w</mi><msub><mi>m</mi><mi>v</mi></msub><mo>+</mo><munder><mo>âˆ‘</mo><mrow><mi>e</mi><mo>âˆˆ</mo><msub><mi>E</mi><mn>1</mn></msub></mrow></munder><mo stretchy=\"false\">(</mo><mi>c</mi><mo stretchy=\"false\">(</mo><msub><mi>e</mi><mrow><mi>u</mi><mo separator=\"true\">,</mo><mi>v</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo>âˆ’</mo><mi>w</mi><msub><mi>m</mi><mi>u</mi></msub><mo>âˆ’</mo><mi>w</mi><msub><mi>m</mi><mi>v</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">Cost=\\sum_{e\\in E_1}c(e)+\\sum_{v\\in V\\backslash V_1}wm_v=\\sum_{v\\in V}wm_v+\\sum_{e\\in E_1}(c(e_{u,v})-wm_u-wm_v)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord mathnormal\">os</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4444em;vertical-align:-1.3944em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.05em;\"><span style=\"top:-1.8557em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"mrel mtight\">âˆˆ</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:-0.0576em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3944em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">e</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.566em;vertical-align:-1.516em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.05em;\"><span style=\"top:-1.809em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span><span class=\"mrel mtight\">âˆˆ</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord mtight\">\\</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:-0.2222em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.516em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3717em;vertical-align:-1.3217em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.05em;\"><span style=\"top:-1.8557em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span><span class=\"mrel mtight\">âˆˆ</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.22222em;\">V</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3217em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4444em;vertical-align:-1.3944em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.05em;\"><span style=\"top:-1.8557em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"mrel mtight\">âˆˆ</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:-0.0576em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">âˆ‘</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3944em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">c</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p>æœ€å°åŒ–ç¬¬äºŒé¡¹æˆæœ¬å³å¯ã€‚æ„å»ºä»¥ä¸‹ç½‘ç»œæµäºŒåˆ†å›¾è·‘æœ€å°è´¹ç”¨æµï¼š</p>\n<ul>\n<li>ä» <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span> å‘æ¯ä¸ª <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">X_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> æ·»åŠ ä¸€æ¡è¾¹ï¼Œå®¹é‡ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> ï¼Œæˆæœ¬ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span></li>\n<li>å¯¹äºæ¯ä¸ª <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo separator=\"true\">,</mo><msub><mi>Y</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(X_i,Y_j)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> ï¼Œä» <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">X_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> å‘ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Y</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">Y_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span> æ·»åŠ ä¸€æ¡è¾¹ï¼Œå®¹é‡ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> ï¼Œæˆæœ¬ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>c</mi><mo stretchy=\"false\">(</mo><msub><mi>e</mi><mrow><msub><mi>X</mi><mi>i</mi></msub><mo separator=\"true\">,</mo><msub><mi>Y</mi><mi>i</mi></msub></mrow></msub><mo stretchy=\"false\">)</mo><mo>âˆ’</mo><mi>w</mi><msub><mi>m</mi><msub><mi>X</mi><mi>i</mi></msub></msub><mo>âˆ’</mo><mi>w</mi><msub><mi>m</mi><msub><mi>Y</mi><mi>i</mi></msub></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(c(e_{X_i,Y_i})-wm_{X_i}-wm_{Y_i})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">c</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.0785em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mpunct mtight\">,</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.22222em;\">Y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.2222em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8334em;vertical-align:-0.2501em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.0785em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0001em;vertical-align:-0.2501em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.22222em;\">Y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.2222em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></li>\n<li>ä»æ¯ä¸ª <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Y</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">Y_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> å‘ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span> æ·»åŠ ä¸€æ¡è¾¹ï¼Œå®¹é‡ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> ï¼Œæˆæœ¬ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>.</li>\n<li>å¦å¤–ï¼Œè€ƒè™‘åˆ°<em><strong>æœ€å°è´¹åŒ¹é…ä¸‹</strong></em>ï¼Œ<em><strong>åŒ¹é…è¾¹çš„æ•°é‡ä¸ä¸€å®šä¸æœ€å¤§åŒ¹é…çš„åŒ¹é…è¾¹æ•°é‡ç›¸ç­‰ï¼ˆä¸ä¸€å®šæœ€å¤§æµï¼Œè¿™ä¸ªå¸¦æœ‰è´Ÿæˆæœ¬çš„æ›´ä¸ºæ˜æ˜¾ï¼‰</strong></em>ï¼Œå› æ­¤å¯¹äºæ¯ä¸ªå·¦éƒ¨ç‚¹ï¼Œè¿˜éœ€å‘æ±‡ç‚¹è¿ä¸€æ¡æµé‡ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> ï¼Œè´¹ç”¨ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span> çš„è¾¹ã€‚</li>\n</ul>\n<p>ç›´æ¥è·‘<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>M</mi><mi>i</mi><mi>n</mi><mi>c</mi><mi>o</mi><mi>s</mi><mi>t</mi><mi>F</mi><mi>l</mi><mi>o</mi><mi>w</mi><mi mathvariant=\"normal\">.</mi><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">MincostFlow.h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mord mathnormal\">in</span><span class=\"mord mathnormal\">cos</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">tFl</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord\">.</span><span class=\"mord mathnormal\">h</span></span></span></span>å°±è¡Œï¼ŒJianglyæ¨¡æ¿æ”¯æŒè´Ÿæ•°è´¹ç”¨ã€‚</p>\n<p>ç¤ºä¾‹1ï¼š<strong>ABC231H - Minimum Coloring</strong></p>\n<p>æˆ‘ä»¬æœ‰ä¸€ä¸ªç½‘æ ¼ï¼Œæœ‰ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>H</mi></mrow><annotation encoding=\"application/x-tex\">H</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span></span></span></span> è¡Œå’Œ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>W</mi></mrow><annotation encoding=\"application/x-tex\">W</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span></span></span></span> åˆ—ã€‚ä»¤ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(i,j)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">i</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">)</span></span></span></span> è¡¨ç¤ºä»é¡¶éƒ¨ç®—èµ·ç¬¬ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> è¡Œå’Œä»å·¦ä¾§ç®—èµ·ç¬¬ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span> åˆ—çš„æ–¹æ ¼ã€‚</p>\n<p>åœ¨è¿™ä¸ªç½‘æ ¼ä¸Šï¼Œæœ‰ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span> ä¸ªç™½è‰²æ£‹å­ï¼Œç¼–å·ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> è‡³ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span> ã€‚æ£‹å­ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> ä½äº <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi>A</mi><mi>i</mi></msub><mo separator=\"true\">,</mo><msub><mi>B</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(A_i,B_i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> ä¸Šã€‚</p>\n<p>æ‚¨å¯ä»¥æ”¯ä»˜ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>C</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">C_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> çš„è´¹ç”¨æ¥å°†æ£‹å­ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> æ”¹ä¸ºé»‘è‰²æ£‹å­ã€‚</p>\n<p>æ‰¾å‡ºåœ¨æ¯ä¸€è¡Œå’Œæ¯ä¸€åˆ—ä¸­è‡³å°‘æœ‰ä¸€ä¸ªé»‘è‰²æ£‹å­æ‰€éœ€çš„æœ€å°æ€»è´¹ç”¨ã€‚</p>\n<p>è£¸çš„æ¿å­ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">solve</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n, m, k;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; k;</span><br><span class=\"line\">    <span class=\"type\">const</span> <span class=\"type\">int</span> s = n + m, t = n + m + <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"function\">MinCostFlow&lt;i64&gt; <span class=\"title\">mcf</span><span class=\"params\">(n + m + <span class=\"number\">10</span>)</span></span>;</span><br><span class=\"line\">    <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">a</span><span class=\"params\">(n + m + <span class=\"number\">10</span>, INT_MAX / <span class=\"number\">2</span>)</span></span>;</span><br><span class=\"line\">    vector&lt;array&lt;<span class=\"type\">int</span>, 3&gt;&gt; <span class=\"built_in\">e</span>(k);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; k; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> u, v, w;</span><br><span class=\"line\">        cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class=\"line\">        u--;</span><br><span class=\"line\">        v--;</span><br><span class=\"line\">        e[i] = &#123;u, v, w&#125;;</span><br><span class=\"line\">        a[u] = <span class=\"built_in\">min</span>(a[u], w);</span><br><span class=\"line\">        a[n + v] = <span class=\"built_in\">min</span>(a[n + v], w);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    i64 ans = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        mcf.<span class=\"built_in\">addEdge</span>(s, i, <span class=\"number\">1</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        mcf.<span class=\"built_in\">addEdge</span>(i, t, <span class=\"number\">1</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        ans += a[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt; m; j++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        mcf.<span class=\"built_in\">addEdge</span>(n + j, t, <span class=\"number\">1</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        ans += a[n + j];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; k; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> [u, v, w] = e[i];</span><br><span class=\"line\">        mcf.<span class=\"built_in\">addEdge</span>(u, n + v, <span class=\"number\">1</span>, w - a[u] - a[n + v]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">auto</span> [flow, cost] = mcf.<span class=\"built_in\">flow</span>(s, t);</span><br><span class=\"line\">    cout &lt;&lt; ans + cost &lt;&lt; endl;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"2-7-8-å‰©ä½™ç‰©å“äº’ä¸ç›¸åŒé—®é¢˜\">2.7.8 å‰©ä½™ç‰©å“äº’ä¸ç›¸åŒé—®é¢˜</h4>\n<p>æ“ä½œåå‰©ä½™äº’ä¸ç›¸åŒï¼Œå¯ä»¥é€šè¿‡åˆ—ä¸¾å‡ºæ‰€æœ‰å‰©ä½™ç‰©å“ç§ç±»ä¹‹åæ¯ä¸ªåªå‘è¶…çº§æ±‡ç‚¹è¿ä¸€æ¡å®¹é‡ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>çš„è¾¹ï¼Œä»¥ç¡®ä¿æ¯ç§ç‰©å“åªä¼šå‡ºç°ä¸€æ¬¡ã€‚</p>\n<p>å‰©ä½™æ•°é‡é™åˆ¶ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>â€‹çš„æ—¶å€™åŒç†ï¼Œé™åˆ¶å®¹é‡å¤§å°å³å¯ã€‚</p>\n<p><strong>ç¤ºä¾‹1ï¼šï¼ˆ2024æˆéƒ½ç«™K)</strong></p>\n<p>æ‚¨æœ‰ä¸€ä¸ªç¥å¥‡çš„é›†åˆï¼Œæœ€åˆåŒ…å« <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> ä¸ªä¸åŒçš„æ•´æ•°ã€‚æ‚¨å‘ç°è¿™äº›æ•°å­—å¯ä»¥é€šè¿‡é™¤ä»¥å®ƒä»¬çš„å› æ•°æ¥äº§ç”Ÿèƒ½é‡ã€‚åœ¨æ¯ä¸ªæ­¥éª¤ä¸­ï¼Œæ‚¨å¯ä»¥ä»é›†åˆä¸­é€‰æ‹©ä»»ä½•å¤§äº <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> çš„æ•°å­—ï¼Œå°†å…¶åˆ é™¤ï¼Œç„¶åæ’å…¥å®ƒçš„ä¸€ä¸ªå› æ•°ã€‚æ‚¨æ’å…¥çš„å› æ•°ä¸å¾—ç­‰äºåŸå§‹æ•°å­—ã€‚æ­¤å¤–ï¼Œç”±äºç¥å¥‡é›†åˆçš„ä¸ç¨³å®šæ€§ï¼Œæ‚¨çš„æ“ä½œå¿…é¡»ç¡®ä¿é›†åˆä¸­çš„æ•°å­—ä¿æŒä¸åŒã€‚</p>\n<p>æ¯ä¸ªæ“ä½œéƒ½ä¼šäº§ç”Ÿä¸€ä¸ªèƒ½é‡å•ä½ï¼Œæ‚¨çš„ç›®æ ‡æ˜¯é€šè¿‡æ‰§è¡Œå°½å¯èƒ½å¤šçš„æ“ä½œæ¥æœ€å¤§åŒ–äº§ç”Ÿçš„æ€»èƒ½é‡ã€‚ç»™å®šé›†åˆä¸­çš„åˆå§‹æ•°å­—ï¼Œç¡®å®šå¯ä»¥äº§ç”Ÿçš„æœ€å¤§èƒ½é‡ï¼Œå³å¯æ‰§è¡Œçš„æœ€å¤§æ“ä½œæ•°ã€‚</p>\n<p>æ˜¾ç„¶æ¯ä¸ªæ•°éƒ½ä¼šå°½å¯èƒ½çš„æŒ‰æ­¥æ•°åˆ†è§£ï¼Œæœ€å¤§çš„æ“ä½œæ•°ä¸€å®šå–å†³äºéšåå‰©ä½™çš„å› æ•°ç»„åˆé—®é¢˜ã€‚è§„çº¦åˆ°äºŒåˆ†å›¾æœ€å¤§æƒåŒ¹é…å³å¯ã€‚</p>\n<p>åˆ†è§£å› æ•°ï¼Œè¶…çº§æºç‚¹å‘åˆå§‹æ•°è¿ä¸€æ¡å®¹é‡ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>ã€è´¹ç”¨ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>çš„è¾¹ï¼›åˆå§‹æ•°å­—å‘å¯¹åº”å› æ•°è¿å®¹é‡ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>ã€å¯¹åº”æ¶ˆè€—æ¬¡æ•°çš„è´¹ç”¨<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span>ï¼›å¯¹åº”å› æ•°å‘è¶…çº§ç»ˆç‚¹è¿å®¹é‡ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>ã€è´¹ç”¨ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>çš„è¾¹ã€‚è·‘æœ€å¤§è´¹ç”¨æµå³å¯ã€‚</p>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"2-7-9-å…¶ä»–è®°å½•\">2.7.9 å…¶ä»–è®°å½•</h4>\n<p>1.å°Mçš„ä½œç‰©(æœ€å°å‰²) å·§å¦™å°†é—®é¢˜è½¬åŒ–ä¸ºæœ€å°å‰²</p>\n<p>2.å¥¶ç‰›çš„ç”µä¿¡Telecowmunication æœ€å°å‰²è¾¹è½¬åŒ–ä¸ºæœ€å°å‰²ç‚¹ï¼Œæ–¹æ³•æ˜¯æ‹†ç‚¹æŠŠä¸€ä¸ªç‚¹æ‹†æˆä¸¤ä¸ªç‚¹ï¼Œç”¨1çš„è¾¹é•¿è¿èµ·æ¥ï¼Œä¸¤ä¸ªä¸åŒç‚¹ä¹‹é—´çš„è¿çº¿ç”¨INFè¿èµ·æ¥ï¼Œè¿™æ ·çš„æœ€å°å‰²å°±åªèƒ½å‰²1çš„ç‚¹ï¼Œç›¸å½“äºå‰²ç‚¹äº†</p>\n<p>3.æ•™è¾…çš„ç»„æˆ ä¹Ÿæ˜¯æ‹†ç‚¹ï¼Œæˆ‘ä»¬é™åˆ¶ä¸€ä¸ªç‚¹é€šè¿‡çš„æµé‡ï¼Œå°±æ˜¯æŠŠè¿™ä¸ªç‚¹æ‹†æˆä¸¤ä¸ªç‚¹ï¼Œä¸­é—´è¿ä¸€æ¡æˆ‘ä»¬è¦é™åˆ¶çš„æµé‡çš„å¤§å°çš„è¾¹</p>\n<p>4.ç‹¼æ‰å…”å­ å¯ä»¥ç›´æ¥ç½‘ç»œæµ ä¹Ÿå¯ä»¥æœ€å°å‰²è½¬å¹³é¢å›¾æœ€çŸ­è·¯ï¼ˆå¹³é¢å›¾æœ€å°å‰²=å¯¹å¶å›¾çš„æœ€çŸ­è·¯ï¼‰</p>\n<p>5.æ–¹æ ¼å–æ•°é—®é¢˜ï¼Œæœ‰æ¡ä»¶çš„æœ€å€¼ã€‚äºŒåˆ†å›¾ç‚¹æƒæœ€å¤§ç‹¬ç«‹é›†</p>\n<p>æŠŠæ–¹æ ¼æ ¹æ®i+jçš„å¥‡å¶æ€§åˆ†ä¸ºä¸¤ç±»ç‚¹ï¼Œå‘ç°ä¿ç•™ä¸€ä¸ªç‚¹çš„ä»£ä»·æ˜¯å–èµ°å‘¨å›´çš„å¦ä¸€ç±»çš„ç‚¹ï¼Œè½¬åŒ–ä¸ºæœ€å°å‰²ã€‚</p>\n<p>Sè¿ç™½ç‚¹ï¼Œå®¹é‡ä¸ºç‚¹æƒï¼Œé»‘ç‚¹è¿TåŒç†ï¼ŒåŒæ—¶ä¸€ä¸ªç‚¹å‘å‘¨å›´å››ä¸ªç‚¹è¿è¾¹ï¼Œè¾¹æƒä¸ºinfï¼Œè¿™æ ·è·‘å‡ºæ¥çš„æœ€å°å‰²ï¼Œèˆå¼ƒä¸€ä¸ªç‚¹ä¸ºæ–­å¼€ä»–ä¸ä¸€ä¸ªæºç‚¹çš„è¿æ¥ï¼Œæ„æ€å°±æ˜¯ä¸è¦è¿™ä¸ªç‚¹ï¼Œä¿ç•™ä¸‹æ¥çš„ç‚¹å°±æ˜¯æœ€å¤§çš„ï¼Œsum-dinic()å³å¯</p>\n<p>å¥—è·¯ï¼šæ–¹æ ¼ä¸­çš„ç‚¹çœ‹çœ‹èƒ½ä¸èƒ½åˆ†ä¸ºä¸¤ç±»ï¼Œå³åˆ†ä¸ºä¸€ä¸ªäºŒåˆ†å›¾ï¼ŒåŒç±»çš„ç‚¹æ˜¯å¯ä»¥å…±å­˜çš„ï¼Œç„¶åä¸èƒ½å…±å­˜çš„ä¸€å®šæ˜¯ä¸¤ç±»ä¹‹é—´ï¼Œä¸­é—´è¿infè¾¹è·‘æœ€å¤§æµï¼Œç­”æ¡ˆå°±æ˜¯æ€»å’Œå‡å»æœ€å°å‰²ã€‚</p>\n<div style=\"page-break-after: always;\"></div>\n<h2 id=\"3-ç”Ÿæˆæ ‘\">3. ç”Ÿæˆæ ‘</h2>\n<h4 id=\"3-1-ä¸¤ç§æœ€å°ç”Ÿæˆæ ‘\">3.1 ä¸¤ç§æœ€å°ç”Ÿæˆæ ‘</h4>\n<h5 id=\"3-1-1-Prim\">3.1.1 Prim</h5>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">prim</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">memset</span>(dis,<span class=\"number\">0x3f3f3f3f</span>,<span class=\"built_in\">sizeof</span>(dis));</span><br><span class=\"line\">    priority_queue&lt;node&gt;q;<span class=\"comment\">//æ‰€ä»¥è¿™é‡Œå…¶å®æ˜¯å°æ ¹å †ï¼Œå­˜çš„æ˜¯è¾¹ï¼ˆæ¯æ¬¡æŠ‰æ‹©æ—¶å¾…é€‰çš„è¾¹ï¼‰</span></span><br><span class=\"line\">    node t;t.to=<span class=\"number\">1</span>,t.val=<span class=\"number\">0</span>;dis[<span class=\"number\">1</span>]=<span class=\"number\">0</span>;</span><br><span class=\"line\">    q.<span class=\"built_in\">push</span>(t);<span class=\"comment\">//ï¼ˆæœ€å¼€å§‹é€‰æ‹©èµ·ç‚¹ï¼‰</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span>(q.<span class=\"built_in\">size</span>()!=<span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">        node now=q.<span class=\"built_in\">top</span>();q.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(vis[now.to]==<span class=\"number\">1</span>)<span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        vis[now.to]=<span class=\"number\">1</span>;</span><br><span class=\"line\">        ans+=now.val;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> i:edge[now.to])&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(!vis[i.to]&amp;&amp;dis[i.to]&gt;i.val)&#123;</span><br><span class=\"line\">                <span class=\"comment\">//æœ‰æ›´æ–°çš„è¾¹ï¼Œéƒ½æ˜¯å¯èƒ½è¦è¢«é€‰çš„è¾¹ï¼ŒåŠ å…¥é˜Ÿåˆ—ä¸­ï¼Œè¿™é‡Œçš„åˆ¤æ–­åªæœ‰è¾¹æƒï¼Œå› ä¸ºdisæ˜¯åˆ°å½“å‰é›†åˆçš„è·ç¦»</span></span><br><span class=\"line\">                dis[i.to]=i.val;</span><br><span class=\"line\">                q.<span class=\"built_in\">push</span>(i);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"3-1-2-Kruskal\">3.1.2 Kruskal</h5>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\">cin&gt;&gt;n&gt;&gt;m;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)fa[i]=i;<span class=\"comment\">//å¹¶æŸ¥é›†ç»´æŠ¤æ˜¯å¦åœ¨ç”Ÿæˆæ ‘é‡Œ</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=m;i++)&#123;</span><br><span class=\"line\">        cin&gt;&gt;u&gt;&gt;v&gt;&gt;sum;</span><br><span class=\"line\">        a[i].x=u,a[i].y=v,a[i].val=sum;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">sort</span>(a<span class=\"number\">+1</span>,a<span class=\"number\">+1</span>+m);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=m;i++)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(fa[<span class=\"built_in\">find</span>(a[i].x)]==fa[<span class=\"built_in\">find</span>(a[i].y)])<span class=\"keyword\">continue</span>;<span class=\"comment\">//å·²ç»åŠ å…¥äº†é‚£å°±ä¸è¦äº†</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">            <span class=\"built_in\">unions</span>(a[i].x,a[i].y);<span class=\"comment\">//åŠ è¾¹</span></span><br><span class=\"line\">            k++;</span><br><span class=\"line\">            ans+=a[i].val;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(k==n<span class=\"number\">-1</span>)<span class=\"keyword\">break</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(k&lt;n<span class=\"number\">-1</span>)cout&lt;&lt;<span class=\"string\">&quot;orz&quot;</span>;</span><br><span class=\"line\"><span class=\"keyword\">else</span> cout&lt;&lt;ans;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"3-2-Kruskalé‡æ„æ ‘\">*3.2 Kruskalé‡æ„æ ‘</h4>\n<p>Kruskal é‡æ„æ ‘å°±æ˜¯åŸºäº Kruskal çš„æœ€å°ç”Ÿæˆæ ‘ç®—æ³•åœ¨æ— å‘å›¾ä¸­å¾—å‡ºçš„æ ‘æ‰€æ„é€ è€Œæˆçš„æ ‘ã€‚</p>\n<p><strong>æ€§è´¨</strong></p>\n<ul>\n<li>æ˜¯ä¸€æ£µäºŒå‰æ ‘ã€‚</li>\n<li>å¦‚æœæ˜¯æŒ‰æœ€å°ç”Ÿæˆæ ‘å»ºç«‹çš„è¯æ˜¯ä¸€ä¸ªå¤§æ ¹å †ã€‚</li>\n<li><strong>å¼ºå¤§æ€§è´¨</strong>ï¼šåŸå›¾ä¸­ä¸¤ä¸ªç‚¹é—´æ‰€æœ‰è·¯å¾„ä¸Šçš„è¾¹æœ€å¤§æƒå€¼çš„æœ€å°å€¼ == æœ€å°ç”Ÿæˆæ ‘ä¸Šä¸¤ç‚¹ç®€å•è·¯å¾„çš„è¾¹æœ€å¤§æƒå€¼ == <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mi>r</mi><mi>u</mi><mi>s</mi><mi>k</mi><mi>a</mi><mi>l</mi></mrow><annotation encoding=\"application/x-tex\">Kruskal</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">Kr</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">ka</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span></span></span></span> é‡æ„æ ‘ä¸Šä¸¤ç‚¹ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mi>C</mi><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">LCA</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord mathnormal\">A</span></span></span></span> çš„ç‚¹æƒã€‚</li>\n</ul>\n<p>åˆ©ç”¨è¿™ä¸ªæ€§è´¨ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°åˆ°ç‚¹ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> çš„ç®€å•è·¯å¾„ä¸Šçš„è¾¹æœ€å¤§æƒå€¼çš„æœ€å°å€¼<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>â‰¤</mo><mi>v</mi><mi>a</mi><mi>l</mi></mrow><annotation encoding=\"application/x-tex\">â‰¤ val</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span></span></span></span>çš„æ‰€æœ‰ç‚¹ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>ã€‚å¯ä»¥å‘ç°éƒ½åœ¨ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mi>r</mi><mi>u</mi><mi>s</mi><mi>k</mi><mi>a</mi><mi>l</mi></mrow><annotation encoding=\"application/x-tex\">Kruskal</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">Kr</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">ka</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span></span></span></span> é‡æ„æ ‘ä¸Šçš„æŸä¸€æ£µå­æ ‘å†…ï¼Œä¸”æ°å¥½ä¸ºè¯¥å­æ ‘çš„æ‰€æœ‰å¶èŠ‚ç‚¹ã€‚</p>\n<p><strong>å…·ä½“ç»†èŠ‚</strong></p>\n<p>æˆ‘ä»¬åœ¨ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mi>r</mi><mi>u</mi><mi>s</mi><mi>k</mi><mi>a</mi><mi>l</mi></mrow><annotation encoding=\"application/x-tex\">Kruskal</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">Kr</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">ka</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span></span></span></span> é‡æ„æ ‘ä¸Šæ‰¾åˆ° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> åˆ°æ ¹çš„è·¯å¾„ä¸Šæƒå€¼ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>â‰¤</mo><mi>v</mi><mi>a</mi><mi>l</mi></mrow><annotation encoding=\"application/x-tex\">â‰¤val</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span></span></span></span> çš„æœ€æµ…çš„èŠ‚ç‚¹,è¿™å°±æ˜¯é‚£æ£µå­æ ‘çš„æ ¹èŠ‚ç‚¹ã€‚è¿™ä¸ªåˆ°æ—¶å€™ç±»ä¼¼æ±‚<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mi>C</mi><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">LCA</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord mathnormal\">A</span></span></span></span>ç”±é«˜åˆ°ä½å€å¢è·³å°±è¡Œäº†ï¼Œä¸€èˆ¬è¿™ç§æƒ…å†µä¸‹è¿˜æœ‰æ ‘ä¸Šçº¿æ®µæ ‘åˆå¹¶æˆ–è€…ä¹¦ä¸Šä¸»å¸­æ ‘ä¹‹ç±»çš„ã€‚</p>\n<ul>\n<li>å¦‚æœé¢˜ç›®è¦æ±‚æœ€å°æƒå€¼æœ€å¤§å€¼ï¼Œå¯ä»¥å»ºæœ€å¤§ç”Ÿæˆæ ‘çš„é‡æ„æ ‘ä»è€Œè¾¾åˆ°ä¸€æ ·çš„æ•ˆæœã€‚</li>\n</ul>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">Ex_Kruskal</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> cnt=n;</span><br><span class=\"line\">    <span class=\"built_in\">sort</span>(e<span class=\"number\">+1</span>,e+m<span class=\"number\">+1</span>,cmp);<span class=\"comment\">//å¯¹è¾¹æ’åº</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;<span class=\"number\">2</span>*n;++i) f[i]=i;<span class=\"comment\">//é¢„å¤„ç†å¹¶æŸ¥é›†</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=m;++i)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> u=<span class=\"built_in\">get</span>(e[i].x),v=<span class=\"built_in\">get</span>(e[i].y);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (u!=v)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            ++cnt;<span class=\"comment\">//æ–°ç‚¹</span></span><br><span class=\"line\">            f[u]=f[v]=cnt;<span class=\"comment\">//åˆå§‹åŒ–</span></span><br><span class=\"line\">            val[cnt]=e[i].z;<span class=\"comment\">//æ–°ç‚¹æƒä¸ºè¿™ä¸ªè¾¹æƒ</span></span><br><span class=\"line\">            <span class=\"built_in\">add</span>(cnt,u);<span class=\"built_in\">add</span>(cnt,v);<span class=\"comment\">//è¿è¾¹</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (cnt==<span class=\"number\">2</span>*n<span class=\"number\">-1</span>) <span class=\"keyword\">break</span>;<span class=\"comment\">//ä¸€å…±2*n-1ä¸ªç‚¹ï¼Œå»ºå¥½é€€å‡º</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h2 id=\"4-äºŒåˆ†å›¾æœ€å¤§åŒ¹é…-äºŒåˆ†å›¾æœ€å°ç‚¹è¦†ç›–\">4.  äºŒåˆ†å›¾æœ€å¤§åŒ¹é…/äºŒåˆ†å›¾æœ€å°ç‚¹è¦†ç›–</h2>\n<p>åŒˆç‰™åˆ©ç®—æ³•ï¼Œæˆ–è€…ç½‘ç»œæµã€‚</p>\n<p>åŒˆç‰™åˆ©ç®—æ³•,åˆ¤æ–­äºŒåˆ†å›¾ï¼šå¹¶æŸ¥é›†/dfsï¼ˆå³æŸ“è‰²æ³•/å¹¶æŸ¥é›†ï¼‰</p>\n<p>äºŒåˆ†å›¾æ˜¯ä»€ä¹ˆï¼ŸèŠ‚ç‚¹ç”±ä¸¤ä¸ªé›†åˆç»„æˆï¼Œä¸”ä¸¤ä¸ªé›†åˆå†…éƒ¨æ²¡æœ‰è¾¹çš„å›¾ã€‚è¿™å¼ å›¾ä¸Šçš„æ‰€æœ‰è¾¹çš„ä¸¤ä¸ªç«¯ç‚¹ï¼Œéƒ½åˆ†å±ä¸åŒçš„éƒ¨åˆ†ï¼Œæ— å‘å›¾</p>\n<p>æœ€å¤§åŒ¹é…ï¼šè¦æ±‚é€‰å‡ºä¸€äº›è¾¹ï¼Œä½¿å¾—è¿™äº›è¾¹æ²¡æœ‰å…¬å…±é¡¶ç‚¹ï¼Œä¸”è¾¹çš„æ•°é‡æœ€å¤§ã€‚</p>\n<p>äºŒåˆ†å›¾ä¸­ï¼Œæœ€å°ç‚¹è¦†ç›– = æœ€å¤§åŒ¹é…  æœ€å°ç‚¹è¦†ç›–ï¼šæŒ‡çš„æ˜¯åœ¨ä¸€ä¸ªå›¾ä¸­ï¼šä¸€ä¸ªç‚¹è¦†ç›–ä¸ä¹‹è¿æ¥çš„è¾¹ï¼Œæ±‚ç”¨æœ€å°‘çš„ç‚¹å¯ä»¥è¦†ç›–å›¾ã€‚</p>\n<p>äºŒåˆ†å›¾ä¸­ï¼Œæœ€å¤§ç‹¬ç«‹é›† = $n- $æœ€å°ç‚¹è¦†ç›–</p>\n<p>æœ€å¤§ç‹¬ç«‹é›†ï¼šä¸€ä¸ªç‚¹é›†ï¼Œé‡Œé¢çš„ç‚¹ä¸¤ä¸¤ä¸ç›¸é‚»</p>\n<p>ç®—æ³•æ­¥éª¤ï¼šå¦‚æœåæ¥çš„å’Œä»¥å‰çš„å‘ç”ŸçŸ›ç›¾ï¼Œåˆ™ä»¥å‰çš„è¢«ç»¿ä¼˜å…ˆé€€è®©ã€‚</p>\n<p>å¦‚æœä»¥å‰çš„é€€è®©ä¹‹åæ²¡æœ‰cpå¯å¤„ï¼Œåˆ™ä»¥å‰çš„æ‹’ç»é€€è®©ï¼Œæ–°æ¥çš„å»å¯»æ‰¾ä¸‹ä¸€ä¸ªåŒ¹é…ã€‚</p>\n<p>å¦‚æœæ–°æ¥çš„è°ä¹ŸåŒ¹é…ä¸ä¸Šäº†ï¼Œé‚£å°±è¿™ä¹ˆå•ç€å§ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//O(nm),ä½†æ˜¯Dinicå¯ä»¥sqrt(n)*m</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> N=<span class=\"number\">2</span>*<span class=\"number\">1e5</span><span class=\"number\">+2</span>;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> inf=<span class=\"number\">0x3f3f3f3f</span>;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> pair&lt;<span class=\"type\">int</span>,<span class=\"type\">int</span>&gt; P;</span><br><span class=\"line\"><span class=\"type\">int</span> n,m,e,u,v,ans;</span><br><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt;edge[<span class=\"number\">505</span>];</span><br><span class=\"line\"><span class=\"type\">int</span> vis[<span class=\"number\">505</span>],match[<span class=\"number\">505</span>];<span class=\"comment\">//matchï¼šä¸ºå³éƒ¨ç‚¹å»ºç«‹çš„æ•°ç»„ï¼Œå­˜çš„æ˜¯ä¸å®ƒåŒ¹é…çš„å·¦éƒ¨ç‚¹</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">bool</span> <span class=\"title\">check</span><span class=\"params\">(<span class=\"type\">int</span> x)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> i:edge[x])&#123;<span class=\"comment\">//æšä¸¾æ¯ä¸€ä¸ªå³éƒ¨ç‚¹</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!vis[i])&#123;<span class=\"comment\">//æ²¡è®¿é—®è¿‡</span></span><br><span class=\"line\">            vis[i]=<span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(!match[i]||<span class=\"built_in\">check</span>(match[i]))&#123;<span class=\"comment\">//å¯ä»¥ç›´æ¥åŒ¹é…oråŸå…ˆçš„iå¯ä»¥æ¢äºº</span></span><br><span class=\"line\">                match[i]=x;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    cin&gt;&gt;n&gt;&gt;m&gt;&gt;e;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=e;i++)&#123;</span><br><span class=\"line\">        cin&gt;&gt;u&gt;&gt;v;</span><br><span class=\"line\">        edge[u].<span class=\"built_in\">push_back</span>(v);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)&#123;</span><br><span class=\"line\">        <span class=\"built_in\">memset</span>(vis,<span class=\"number\">0</span>,<span class=\"built_in\">sizeof</span>(vis));<span class=\"comment\">//å¯¹äºæ¯ä¸€ä¸ªuçš„ç ”ç©¶ï¼Œå¯¹å¦ä¸€å¤–ä¸€åŠåªèƒ½è®¿é—®ä¸€æ¬¡ï¼Œæ•…æ¯æ¬¡éƒ½è¦æ¸…ç©º</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>(<span class=\"built_in\">check</span>(i))ans++;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout&lt;&lt;ans;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h2 id=\"5-æ ‘ä¸Šé—®é¢˜\">5.æ ‘ä¸Šé—®é¢˜</h2>\n<h3 id=\"5-1-æ ‘ä¸ŠLCA\">5.1  æ ‘ä¸ŠLCA</h3>\n<p>å…³äºå€å¢æ³•ä»¥åŠæ¬§æ‹‰åº<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">ST</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">ST</span></span></span></span>è¡¨åœ¨çº¿åšæ³•å‚è§æ•°æ®ç»“æ„éƒ¨åˆ†ã€‚è¿™é‡Œåªç»™å‡ºç¦»çº¿<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi><mi>a</mi><mi>r</mi><mi>j</mi><mi>a</mi><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">Tarjan</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">jan</span></span></span></span>ç®—æ³•ï¼Œå®ç°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo>+</mo><mi>m</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n+m)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mclose\">)</span></span></span></span>â€‹å¤æ‚åº¦ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;bits/stdc++.h&gt;</span><span class=\"comment\">//Tarjanç¦»çº¿ç®—æ³•</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> N=<span class=\"number\">5</span>*<span class=\"number\">1e5</span><span class=\"number\">+2</span>;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"type\">long</span> <span class=\"type\">long</span> ll;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">point</span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> x,i;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">vector&lt;vector&lt;<span class=\"type\">int</span>&gt; &gt;edge;</span><br><span class=\"line\">vector&lt;vector&lt;point&gt; &gt;q;</span><br><span class=\"line\"><span class=\"type\">int</span> dep[N],fa[N],vis[N],ans[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">find</span><span class=\"params\">(<span class=\"type\">int</span> x)</span></span>&#123;<span class=\"comment\">//è·¯å¾„å‹ç¼©</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(fa[x]!=x)&#123;</span><br><span class=\"line\">        fa[x]=<span class=\"built_in\">find</span>(fa[x]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> fa[x];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">unions</span><span class=\"params\">(<span class=\"type\">int</span> x,<span class=\"type\">int</span> y)</span></span>&#123;<span class=\"comment\">//xåˆå¹¶åˆ°yä¸Š</span></span><br><span class=\"line\">    fa[<span class=\"built_in\">find</span>(x)]=fa[<span class=\"built_in\">find</span>(y)];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"type\">int</span> x,<span class=\"type\">int</span> f)</span></span>&#123;<span class=\"comment\">/***1.**ä»¥sä¸ºæ ¹èŠ‚ç‚¹ï¼Œä»æ ¹èŠ‚ç‚¹å¼€å§‹ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">**2.**éå†è¯¥ç‚¹uæ‰€æœ‰å­èŠ‚ç‚¹vï¼Œå¹¶æ ‡è®°è¿™äº›å­èŠ‚ç‚¹vå·²è¢«è®¿é—®è¿‡ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">**3.**è‹¥æ˜¯vè¿˜æœ‰å­èŠ‚ç‚¹ï¼Œè¿”å›2ï¼Œå¦åˆ™ä¸‹ä¸€æ­¥ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">**4.**åˆå¹¶våˆ°uä¸Šã€‚</span></span><br><span class=\"line\"><span class=\"comment\">**5.**å¯»æ‰¾ä¸å½“å‰ç‚¹uæœ‰è¯¢é—®å…³ç³»çš„ç‚¹vã€‚</span></span><br><span class=\"line\"><span class=\"comment\">**6.**è‹¥æ˜¯vå·²ç»è¢«è®¿é—®è¿‡äº†ï¼Œåˆ™å¯ä»¥ç¡®è®¤uå’Œvçš„æœ€è¿‘å…¬å…±ç¥–å…ˆä¸ºvè¢«åˆå¹¶åˆ°çš„çˆ¶äº²èŠ‚ç‚¹aã€‚*/</span></span><br><span class=\"line\">    vis[x]=<span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> i:edge[x])&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(i!=f)&#123;</span><br><span class=\"line\">            <span class=\"built_in\">dfs</span>(i,x);</span><br><span class=\"line\">            <span class=\"built_in\">unions</span>(i,x);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> t:q[x])&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(vis[t.x])ans[t.i]=<span class=\"built_in\">find</span>(t.x);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n,m,s;<span class=\"type\">int</span> x,y;</span><br><span class=\"line\">    cin&gt;&gt;n&gt;&gt;m&gt;&gt;s;</span><br><span class=\"line\">    edge.<span class=\"built_in\">resize</span>(n<span class=\"number\">+1</span>);</span><br><span class=\"line\">    q.<span class=\"built_in\">resize</span>(n<span class=\"number\">+1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)fa[i]=i;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;n;i++)&#123;</span><br><span class=\"line\">        cin&gt;&gt;x&gt;&gt;y;</span><br><span class=\"line\">        edge[x].<span class=\"built_in\">push_back</span>(y);</span><br><span class=\"line\">        edge[y].<span class=\"built_in\">push_back</span>(x);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=m;i++)&#123;</span><br><span class=\"line\">        cin&gt;&gt;x&gt;&gt;y;</span><br><span class=\"line\">        q[x].<span class=\"built_in\">push_back</span>(&#123;y,i&#125;);<span class=\"comment\">//å¦ä¸€ä¸ªç›¸å…³ç‚¹å’Œç»„æ•°</span></span><br><span class=\"line\">        q[y].<span class=\"built_in\">push_back</span>(&#123;x,i&#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">dfs</span>(s,<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=m;i++)cout&lt;&lt;ans[i]&lt;&lt;endl;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*ä¸€ä¸ªç†Šå­©å­Linkä»ä¸€æ£µæœ‰æ ¹æ ‘çš„æœ€å·¦è¾¹æœ€åº•ä¸‹çš„ç»“ç‚¹çŒå²©æµ†ï¼ŒLinkè¡¨ç¤ºå¾ˆè®¨åŒè¿™ç§å€’ç€é•¿çš„æ ‘ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">å²©æµ†ä¼šä¸æ–­çš„æ³¨å…¥ï¼Œç›´åˆ°æ³¨æ»¡æ•´ä¸ªæ ‘â€¦</span></span><br><span class=\"line\"><span class=\"comment\">å¦‚æœå²©æµ†çŒæ»¡äº†ä¸€æ£µå­æ ‘ï¼ŒLinkå‘ç°æ ‘çš„å¦ä¸€è¾¹æœ‰ä¸€æ£µæ›´æ·±çš„å­æ ‘ï¼ŒLinkä¼šå…ˆå»å°†é‚£æ£µå­æ ‘çŒæ»¡ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">å²©æµ†åªæœ‰åœ¨è¿«ä¸å¾—å·²çš„æƒ…å†µä¸‹æ‰ä¼šå‘ä¸Šå‡é«˜ï¼Œæ‰¾åˆ°ä¸€ä¸ªæ–°çš„å­æ ‘ç»§ç»­æ³¨å…¥ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">æœº(yu)æ™º(chun)çš„Linkå‘ç°äº†æ‰¾LCAçš„å¥½æ–¹æ³•ï¼Œå³å¦‚æœä¸¤ä¸ªç»“ç‚¹éƒ½è¢«å²©æµ†çƒ§æ‰æ—¶ï¼Œä»–ä»¬çš„LCAå³ä¸ºé‚£æ£µå­æ ‘ä¸Šå²©æµ†æœ€é«˜çš„ä½ç½®*/</span></span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"5-2-æ ‘é“¾å‰–åˆ†\">5.2 æ ‘é“¾å‰–åˆ†</h3>\n<p>å‚è§æ•°æ®ç»“æ„éƒ¨åˆ†é™æ€æ ‘ç« èŠ‚ï¼Œå¯¹äºé•¿é“¾ã€é‡é“¾éƒ½æœ‰ã€‚</p>\n<p>è¿™é‡Œè´´å‡ºé‡é“¾å‰–åˆ†å¤´æ–‡ä»¶<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>H</mi><mi>L</mi><mi>D</mi><mi mathvariant=\"normal\">.</mi><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">HLD.h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord\">.</span><span class=\"mord mathnormal\">h</span></span></span></span>ã€‚è¿™ä¸ªæ˜¯ä»<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>å¼€å§‹çš„ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">     *@brief é‡é“¾å‰–åˆ†(jiangly)ç‰ˆæœ¬</span></span><br><span class=\"line\"><span class=\"comment\">     *@brief æ—¶é—´å¤æ‚åº¦O(n)</span></span><br><span class=\"line\"><span class=\"comment\">     *@brief ç©ºé—´å¤æ‚åº¦O(n)</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">struct</span> <span class=\"title class_\">HLD</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> n;</span><br><span class=\"line\">        std::vector&lt;<span class=\"type\">int</span>&gt; siz, top, dep, parent, dfn, enddfn, rk;</span><br><span class=\"line\">        std::vector&lt;std::vector&lt;<span class=\"type\">int</span>&gt;&gt; adj;</span><br><span class=\"line\">        <span class=\"type\">int</span> cur;</span><br><span class=\"line\">        <span class=\"built_in\">HLD</span>() &#123;&#125;</span><br><span class=\"line\">        <span class=\"built_in\">HLD</span>(<span class=\"type\">int</span> n)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"built_in\">init</span>(n);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">init</span><span class=\"params\">(<span class=\"type\">int</span> n)</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>-&gt;n = n;</span><br><span class=\"line\">            siz.<span class=\"built_in\">resize</span>(n);</span><br><span class=\"line\">            top.<span class=\"built_in\">resize</span>(n);</span><br><span class=\"line\">            dep.<span class=\"built_in\">resize</span>(n);</span><br><span class=\"line\">            parent.<span class=\"built_in\">resize</span>(n);</span><br><span class=\"line\">            dfn.<span class=\"built_in\">resize</span>(n);</span><br><span class=\"line\">            enddfn.<span class=\"built_in\">resize</span>(n);</span><br><span class=\"line\">            rk.<span class=\"built_in\">resize</span>(n);</span><br><span class=\"line\">            cur = <span class=\"number\">0</span>;</span><br><span class=\"line\">            adj.<span class=\"built_in\">assign</span>(n, &#123;&#125;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">add_edges</span><span class=\"params\">(<span class=\"type\">int</span> u, <span class=\"type\">int</span> v)</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            adj[u].<span class=\"built_in\">push_back</span>(v);</span><br><span class=\"line\">            adj[v].<span class=\"built_in\">push_back</span>(u);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">         * @brief é‡é“¾å‰–åˆ†ï¼ˆjianglyï¼‰ï¼Œåªèƒ½å‰–ä¸€æ¬¡ï¼Œä¸æ”¯æŒåŠ¨æ€æ ‘ï¼ŒèŠ‚ç‚¹ç¼–å·å’Œæ ‘å‰–ç¼–å·éƒ½æ˜¯ä»0å¼€å§‹ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">         * @param root æ ¹èŠ‚ç‚¹</span></span><br><span class=\"line\"><span class=\"comment\">         * @note é‡é“¾å‰–åˆ†å‰éœ€è¦å…ˆè°ƒç”¨initå‡½æ•°,è°ƒç”¨é‡é“¾å‰–åˆ†åï¼Œé‚»æ¥è¡¨vectorä¸­å­˜å‚¨çš„æ˜¯é‡é“¾å‰–åˆ†åçš„æ ‘ï¼Œæ²¡æœ‰æŒ‡å‘çˆ¶èŠ‚ç‚¹çš„è¾¹</span></span><br><span class=\"line\"><span class=\"comment\">         * @note é‡é“¾å‰–åˆ†åï¼Œdfnæ•°ç»„ä¸­å­˜å‚¨çš„æ˜¯èŠ‚ç‚¹çš„dfsåºï¼Œrkæ•°ç»„ä¸­å­˜å‚¨çš„æ˜¯dfsåºå¯¹åº”çš„èŠ‚ç‚¹ï¼Œenddfnæ•°ç»„ä¸­å­˜å‚¨çš„æ˜¯èŠ‚ç‚¹æ‰€å¯¹åº”å­æ ‘çš„dfsåºçš„ç»“æŸä½ç½®çš„åä¸€ä¸ªï¼ˆå·¦é—­å³å¼€ï¼‰ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">work</span><span class=\"params\">(<span class=\"type\">int</span> root = <span class=\"number\">0</span>)</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            top[root] = root;</span><br><span class=\"line\">            dep[root] = <span class=\"number\">0</span>;</span><br><span class=\"line\">            parent[root] = <span class=\"number\">-1</span>;</span><br><span class=\"line\">            <span class=\"built_in\">dfs1</span>(root);</span><br><span class=\"line\">            <span class=\"built_in\">dfs2</span>(root);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">dfs1</span><span class=\"params\">(<span class=\"type\">int</span> u)</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (parent[u] != <span class=\"number\">-1</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                adj[u].<span class=\"built_in\">erase</span>(std::<span class=\"built_in\">find</span>(adj[u].<span class=\"built_in\">begin</span>(), adj[u].<span class=\"built_in\">end</span>(), parent[u]));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            siz[u] = <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> &amp;v : adj[u])</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                parent[v] = u;</span><br><span class=\"line\">                dep[v] = dep[u] + <span class=\"number\">1</span>;</span><br><span class=\"line\">                <span class=\"built_in\">dfs1</span>(v);</span><br><span class=\"line\">                siz[u] += siz[v];</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (siz[v] &gt; siz[adj[u][<span class=\"number\">0</span>]])</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    std::<span class=\"built_in\">swap</span>(v, adj[u][<span class=\"number\">0</span>]);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">dfs2</span><span class=\"params\">(<span class=\"type\">int</span> u)</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            dfn[u] = cur++;</span><br><span class=\"line\">            rk[dfn[u]] = u;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> v : adj[u])</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                top[v] = v == adj[u][<span class=\"number\">0</span>] ? top[u] : v;</span><br><span class=\"line\">                <span class=\"built_in\">dfs2</span>(v);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            enddfn[u] = cur;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">         * @brief è¿”å›uåˆ°vçš„æœ€è¿‘å…¬å…±ç¥–å…ˆ</span></span><br><span class=\"line\"><span class=\"comment\">         * @param u èµ·ç‚¹</span></span><br><span class=\"line\"><span class=\"comment\">         * @param v ç»ˆç‚¹</span></span><br><span class=\"line\"><span class=\"comment\">         * @return è¿”å›uåˆ°vçš„æœ€è¿‘å…¬å…±ç¥–å…ˆèŠ‚ç‚¹</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">lca</span><span class=\"params\">(<span class=\"type\">int</span> u, <span class=\"type\">int</span> v)</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (top[u] != top[v])</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (dep[top[u]] &gt; dep[top[v]])</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    u = parent[top[u]];</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">else</span></span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    v = parent[top[v]];</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> dep[u] &lt; dep[v] ? u : v;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">         * @brief è¿”å›uåˆ°vçš„è·ç¦»</span></span><br><span class=\"line\"><span class=\"comment\">         * @param u èµ·ç‚¹</span></span><br><span class=\"line\"><span class=\"comment\">         * @param v ç»ˆç‚¹</span></span><br><span class=\"line\"><span class=\"comment\">         * @return è¿”å›uåˆ°vçš„è·ç¦»</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">dist</span><span class=\"params\">(<span class=\"type\">int</span> u, <span class=\"type\">int</span> v)</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> dep[u] + dep[v] - <span class=\"number\">2</span> * dep[<span class=\"built_in\">lca</span>(u, v)];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">         * @brief è·³è·ƒ</span></span><br><span class=\"line\"><span class=\"comment\">         * @param u èµ·ç‚¹</span></span><br><span class=\"line\"><span class=\"comment\">         * @param k è·³è·ƒè·ç¦»</span></span><br><span class=\"line\"><span class=\"comment\">         * @return è¿”å›è·³è·ƒåçš„èŠ‚ç‚¹</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">jump</span><span class=\"params\">(<span class=\"type\">int</span> u, <span class=\"type\">int</span> k)</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (dep[u] &lt; k)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"type\">int</span> d = dep[u] - k;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">while</span> (dep[top[u]] &gt; d)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                u = parent[top[u]];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">return</span> rk[dfn[u] - dep[u] + d];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">         * @brief åˆ¤æ–­uæ˜¯å¦æ˜¯vçš„ç¥–å…ˆ</span></span><br><span class=\"line\"><span class=\"comment\">         * @param u èµ·ç‚¹</span></span><br><span class=\"line\"><span class=\"comment\">         * @param v ç»ˆç‚¹</span></span><br><span class=\"line\"><span class=\"comment\">         * @return è¿”å›uæ˜¯å¦æ˜¯vçš„ç¥–å…ˆ</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"type\">bool</span> <span class=\"title\">isAncester</span><span class=\"params\">(<span class=\"type\">int</span> u, <span class=\"type\">int</span> v)</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> dfn[u] &lt;= dfn[v] &amp;&amp; dfn[v] &lt; enddfn[u];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">        int rootedParent(int u, int v)</span></span><br><span class=\"line\"><span class=\"comment\">        &#123;</span></span><br><span class=\"line\"><span class=\"comment\">            std::swap(u, v);</span></span><br><span class=\"line\"><span class=\"comment\">            if (u == v)</span></span><br><span class=\"line\"><span class=\"comment\">            &#123;</span></span><br><span class=\"line\"><span class=\"comment\">                return u;</span></span><br><span class=\"line\"><span class=\"comment\">            &#125;</span></span><br><span class=\"line\"><span class=\"comment\">            if (!isAncester(u, v))</span></span><br><span class=\"line\"><span class=\"comment\">            &#123;</span></span><br><span class=\"line\"><span class=\"comment\">                return parent[u];</span></span><br><span class=\"line\"><span class=\"comment\">            &#125;</span></span><br><span class=\"line\"><span class=\"comment\">            auto it = std::upper_bound(adj[u].begin(), adj[u].end(), v, [&amp;](int x, int y)</span></span><br><span class=\"line\"><span class=\"comment\">                                       &#123; return dfn[x] &lt; dfn[y]; &#125;) -</span></span><br><span class=\"line\"><span class=\"comment\">                      1;</span></span><br><span class=\"line\"><span class=\"comment\">            return *it;</span></span><br><span class=\"line\"><span class=\"comment\">        &#125;</span></span><br><span class=\"line\"><span class=\"comment\">        int rootedSize(int u, int v)</span></span><br><span class=\"line\"><span class=\"comment\">        &#123;</span></span><br><span class=\"line\"><span class=\"comment\">            if (u == v)</span></span><br><span class=\"line\"><span class=\"comment\">            &#123;</span></span><br><span class=\"line\"><span class=\"comment\">                return n;</span></span><br><span class=\"line\"><span class=\"comment\">            &#125;</span></span><br><span class=\"line\"><span class=\"comment\">            if (!isAncester(v, u))</span></span><br><span class=\"line\"><span class=\"comment\">            &#123;</span></span><br><span class=\"line\"><span class=\"comment\">                return siz[v];</span></span><br><span class=\"line\"><span class=\"comment\">            &#125;</span></span><br><span class=\"line\"><span class=\"comment\">            return n - siz[rootedParent(u, v)];</span></span><br><span class=\"line\"><span class=\"comment\">        &#125;</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">        int rootedLca(int a, int b, int c)</span></span><br><span class=\"line\"><span class=\"comment\">        &#123;</span></span><br><span class=\"line\"><span class=\"comment\">            return lca(a, b) ^ lca(b, c) ^ lca(c, a);</span></span><br><span class=\"line\"><span class=\"comment\">        &#125;*/</span></span><br><span class=\"line\">    &#125;;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"5-3-æ ‘çš„ç›´å¾„\">5.3 æ ‘çš„ç›´å¾„</h3>\n<p>æ ‘å½¢<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">dp</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">p</span></span></span></span>ï¼Œæ±‚å‡ºæ¯ä¸ªç‚¹çš„æœ€é•¿è·¯å’Œæ¬¡é•¿è·¯ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"type\">int</span> u,<span class=\"type\">int</span> fa)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> sum1=<span class=\"number\">0</span>,sum2=<span class=\"number\">0</span>;</span><br><span class=\"line\">    f[u]=<span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> i:edge[u])&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(i!=fa)&#123;</span><br><span class=\"line\">            <span class=\"built_in\">dfs</span>(i,u);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(f[i]&gt;sum1)sum2=sum1,sum1=f[i];</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(f[i]&gt;sum2)sum2=f[i];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(f[u]+sum1+sum2&gt;ans)ans=f[u]+sum1+sum2;</span><br><span class=\"line\">    f[u]+=sum1;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"5-4-æ ‘çš„é‡å¿ƒ\">5.4 æ ‘çš„é‡å¿ƒ</h3>\n<p>æ— æ ¹æ ‘çš„é‡å¿ƒç‚¹å®šä¹‰ä¸ºæ ‘ç§çš„ç‚¹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>ï¼Œä½¿å¾—<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>ç›¸é‚»çš„æ‰€æœ‰å­æ ‘çš„å­æ ‘å¤§å°å‡ä¸å¤§äºæ ‘å¤§å°çš„ä¸€åŠã€‚æ˜¾ç„¶ä¸€æ£µæ ‘æœ€å¤šåªæœ‰ä¸¤ä¸ªé‡å¿ƒï¼ˆå½“æ ‘èŠ‚ç‚¹ä¸ºå¥‡æ•°æ—¶ï¼‰ï¼Œä¸”ä¸¤ä¸ªé‡å¿ƒå¿…å®šç›¸é‚»ã€‚æ ¹æ®è¿™ä¸ªå¯ä»¥è¿›è¡Œä¸€å®šçš„äºŒåˆ†ï¼ˆ2024å—äº¬ç«™Gï¼‰</p>\n<p><strong>æ€§è´¨1</strong></p>\n<p>æŸä¸ªç‚¹æ˜¯æ ‘çš„<strong>é‡å¿ƒ</strong>ç­‰ä»·äºå®ƒæœ€å¤§å­æ ‘å¤§å°<strong>ä¸å¤§äº</strong>æ•´æ£µæ ‘å¤§å°çš„<strong>ä¸€åŠ</strong>ã€‚</p>\n<p><strong>æ€§è´¨2</strong></p>\n<p>æ ‘<strong>è‡³å¤šæœ‰ä¸¤ä¸ª</strong>é‡å¿ƒã€‚å¦‚æœæ ‘æœ‰ä¸¤ä¸ªé‡å¿ƒï¼Œé‚£ä¹ˆå®ƒä»¬<strong>ç›¸é‚»</strong>ã€‚æ­¤æ—¶æ ‘ä¸€å®šæœ‰<strong>å¶æ•°</strong>ä¸ªèŠ‚ç‚¹ï¼Œä¸”å¯ä»¥è¢«åˆ’åˆ†ä¸ºä¸¤ä¸ªå¤§å°ç›¸ç­‰çš„åˆ†æ”¯ï¼Œæ¯ä¸ªåˆ†æ”¯å„è‡ªåŒ…å«ä¸€ä¸ªé‡å¿ƒã€‚</p>\n<p><strong>æ€§è´¨3</strong></p>\n<p>æ ‘ä¸­æ‰€æœ‰ç‚¹åˆ°æŸä¸ªç‚¹çš„è·ç¦»å’Œä¸­ï¼Œåˆ°é‡å¿ƒçš„è·ç¦»å’Œæ˜¯æœ€å°çš„ï¼›å¦‚æœæœ‰ä¸¤ä¸ªé‡å¿ƒï¼Œé‚£ä¹ˆåˆ°å®ƒä»¬çš„è·ç¦»å’Œä¸€æ ·ã€‚åè¿‡æ¥ï¼Œè·ç¦»å’Œæœ€å°çš„ç‚¹ä¸€å®šæ˜¯é‡å¿ƒã€‚</p>\n<p><strong>æ€§è´¨4</strong></p>\n<p>å¾€æ ‘ä¸Šå¢åŠ æˆ–å‡å°‘ä¸€ä¸ªå¶å­ï¼Œå¦‚æœåŸèŠ‚ç‚¹æ•°æ˜¯å¥‡æ•°ï¼Œé‚£ä¹ˆé‡å¿ƒå¯èƒ½å¢åŠ ä¸€ä¸ªï¼ŒåŸé‡å¿ƒä»æ˜¯é‡å¿ƒï¼›å¦‚æœåŸèŠ‚ç‚¹æ•°æ˜¯å¶æ•°ï¼Œé‡å¿ƒå¯èƒ½å‡å°‘ä¸€ä¸ªï¼Œå¦ä¸€ä¸ªé‡å¿ƒä»æ˜¯é‡å¿ƒ</p>\n<p><strong>æ€§è´¨5</strong></p>\n<p>æŠŠä¸¤æ£µæ ‘é€šè¿‡ä¸€æ¡è¾¹ç›¸è¿å¾—åˆ°ä¸€æ£µæ–°çš„æ ‘ï¼Œåˆ™æ–°çš„é‡å¿ƒåœ¨è¾ƒå¤§çš„ä¸€æ£µæ ‘ä¸€ä¾§çš„è¿æ¥ç‚¹ä¸åŸé‡å¿ƒä¹‹é—´çš„ç®€å•è·¯å¾„ä¸Šã€‚å¦‚æœä¸¤æ£µæ ‘å¤§å°ä¸€æ ·ï¼Œåˆ™é‡å¿ƒå°±æ˜¯ä¸¤ä¸ªè¿æ¥ç‚¹ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">int</span> n, sz[MAXN], mss[MAXN]; <span class=\"comment\">// nï¼šæ€»ç»“ç‚¹æ•°ï¼ˆè¯·ä»å¤–éƒ¨ä¼ å…¥ï¼‰ï¼Œszï¼šæ ‘çš„å¤§å°ï¼Œmssï¼šæœ€å¤§å­æ ‘å¤§å°</span></span><br><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt; ctr; <span class=\"comment\">// é‡å¿ƒ</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"type\">int</span> p, <span class=\"type\">int</span> fa = <span class=\"number\">0</span>)</span> <span class=\"comment\">// æ‰¾é‡å¿ƒ</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    sz[p] = <span class=\"number\">1</span>, mss[p] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> [to, w] : edges[p])</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (to != fa)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"built_in\">dfs</span>(to, p);</span><br><span class=\"line\">            mss[p] = <span class=\"built_in\">max</span>(mss[p], sz[to]);</span><br><span class=\"line\">            sz[p] += sz[to];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    mss[p] = <span class=\"built_in\">max</span>(mss[p], n - sz[p]);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (mss[p] &lt;= n / <span class=\"number\">2</span>) ctr.<span class=\"built_in\">push_back</span>(p);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"5-5-æ ‘ä¸Šå·®åˆ†\">5.5 æ ‘ä¸Šå·®åˆ†</h3>\n<p>è§æ•°æ®ç»“æ„é™æ€æ ‘éƒ¨åˆ†ã€‚</p>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"5-6-æ ‘ä¸Šå¯å‘å¼åˆå¹¶\">5.6 æ ‘ä¸Šå¯å‘å¼åˆå¹¶</h3>\n<p>æ ‘ä¸Šå¯å‘å¼åˆå¹¶æ˜¯ä¸€ç§æš´åŠ›çš„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi><mi>r</mi><mi>i</mi><mi>c</mi><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">Trick</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>ï¼Œé€šè¿‡å°å­æ ‘ä¿¡æ¯å‘å¤§å­æ ‘åˆå¹¶ï¼Œå®ç°å’Œå¹¶æŸ¥é›†æŒ‰ç§©åˆå¹¶ä¸€æ ·çš„äºšçº¿æ€§å¤æ‚åº¦ã€‚ä¼°ç®—æŒ‰ç…§<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">nlogn</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">n</span></span></span></span>â€‹ç®—å°±è¡Œï¼Œä¹Ÿæ˜¯ä¸€ç§ä¹±æåšæ³•ã€‚</p>\n<p>ç¤ºä¾‹1: <strong>2024æ­ç”µå¤šæ ¡1 æ ‘</strong></p>\n<p>ç»™ä¸€æ£µæ ¹ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> çš„æœ‰æ ¹æ ‘ï¼Œç‚¹ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> å…·æœ‰ä¸€ä¸ªæƒå€¼ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">A_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> ã€‚</p>\n<p>å®šä¹‰ä¸€ä¸ªç‚¹å¯¹çš„å€¼ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>u</mi><mo separator=\"true\">,</mo><mi>v</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy=\"false\">(</mo><msub><mi>A</mi><mi>u</mi></msub><mo separator=\"true\">,</mo><msub><mi>A</mi><mi>v</mi></msub><mo stretchy=\"false\">)</mo><mo>Ã—</mo><mi mathvariant=\"normal\">âˆ£</mi><msub><mi>A</mi><mi>u</mi></msub><mo>âˆ’</mo><msub><mi>A</mi><mi>v</mi></msub><mi mathvariant=\"normal\">âˆ£</mi></mrow><annotation encoding=\"application/x-tex\">f(u,v)=max(A_u,A_v)Ã—|A_uâˆ’A_v|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">u</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">ma</span><span class=\"mord mathnormal\">x</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">âˆ£</span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">âˆ£</span></span></span></span> ã€‚</p>\n<p>ä½ éœ€è¦å¯¹äºæ¯ä¸ªèŠ‚ç‚¹ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> ï¼Œè®¡ç®— $ans_i=âˆ‘_{uâˆˆsubtree(i),vâˆˆsubtree(i)}f(u,v) $ï¼Œå…¶ä¸­ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mi>u</mi><mi>b</mi><mi>t</mi><mi>r</mi><mi>e</mi><mi>e</mi><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">subtree(i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">ree</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">)</span></span></span></span> è¡¨ç¤º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> çš„å­æ ‘ã€‚</p>\n<p>è¯·ä½ è¾“å‡º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>âŠ•</mo><mo stretchy=\"false\">(</mo><mi>a</mi><mi>n</mi><msub><mi>s</mi><mi>i</mi></msub><mtext>Â </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><msup><mn>2</mn><mn>64</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">âŠ•(ans_i\\ mod\\ 2^{64})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\">âŠ•</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">an</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\">Â </span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\">Â </span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">64</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> ï¼Œå…¶ä¸­ âŠ• è¡¨ç¤º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi><mi>O</mi><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">XOR</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">XOR</span></span></span></span>â€‹â€‹.</p>\n<p>æ˜¾ç„¶ç¡¬æŒ‰ç€ç»“ç‚¹ä¸å¥½æƒ³ã€‚</p>\n<p>è€ƒè™‘ä¸¤ä¸ªå­æ ‘åˆå¹¶ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mi>n</mi><msub><mi>s</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">ans_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">an</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>çš„ä¿¡æ¯æ˜¯ä¸€å®šè¦ç»§æ‰¿<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mi>n</mi><msub><mi>s</mi><mi>u</mi></msub><mo separator=\"true\">,</mo><mi>u</mi><mo>âˆˆ</mo><mi>s</mi><mi>o</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">ans_{u},u\\in son(i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">an</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">so</span><span class=\"mord mathnormal\">n</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">)</span></span></span></span>çš„ã€‚è€ƒè™‘ä¸åŒå±äºä¸¤ä¸ªå­æ ‘çš„ç‚¹å¦‚ä½•å¤„ç†ã€‚</p>\n<p>æƒå€¼æ ‘åˆå¹¶ï¼Œæƒå€¼æ ‘åŒºé—´åˆå¹¶çš„æ—¶å€™ï¼Œä¸€å®šæ˜¯å·¦éƒ¨åˆ†çš„åŒºé—´ç‚¹æƒå°äºå³éƒ¨åˆ†çš„åŒºé—´ç‚¹æƒã€‚æ‰€ä»¥ä¸¤éƒ¨åˆ†åˆå¹¶çš„æ—¶å€™å³åŠåŒºé—´çš„æ¯ä¸€ä¸ªç‚¹ä¼šé¢å¤–äº§ç”Ÿ</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mstyle mathsize=\"1.2em\"><mo>âˆ‘</mo><mo>âˆ’</mo><mi>s</mi><mi>u</mi><msub><mi>m</mi><mrow><mi>l</mi><mi>s</mi><mi>o</mi><mi>n</mi><mi>s</mi></mrow></msub><mo>Ã—</mo><mi>v</mi><mi>a</mi><msub><mi>l</mi><msub><mi>r</mi><mi>i</mi></msub></msub><mo>+</mo><mi>c</mi><mi>n</mi><msub><mi>t</mi><mrow><mi>l</mi><mi>s</mi><mi>o</mi><mi>n</mi></mrow></msub><mo>Ã—</mo><mi>v</mi><mi>a</mi><msubsup><mi>l</mi><msub><mi>r</mi><mi>i</mi></msub><mn>2</mn></msubsup></mstyle></mrow><annotation encoding=\"application/x-tex\">\\large\\sum -sum_{lsons}\\times val_{r_i}+cnt_{lson}\\times val_{r_i}^2\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.92em;vertical-align:-0.66em;\"></span><span class=\"mop op-symbol large-op sizing reset-size6 size7\" style=\"position:relative;top:0em;\">âˆ‘</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord sizing reset-size6 size7\">âˆ’</span><span class=\"mord mathnormal sizing reset-size6 size7\">s</span><span class=\"mord mathnormal sizing reset-size6 size7\">u</span><span class=\"mord sizing reset-size6 size7\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.313em;\"><span style=\"top:-2.65em;margin-left:0em;margin-right:0.0417em;\"><span class=\"pstrut\" style=\"height:2.8em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\">so</span><span class=\"mord mathnormal mtight\">n</span><span class=\"mord mathnormal mtight\">s</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin sizing reset-size6 size7\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1332em;vertical-align:-0.2999em;\"></span><span class=\"mord mathnormal sizing reset-size6 size7\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal sizing reset-size6 size7\">a</span><span class=\"mord sizing reset-size6 size7\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.137em;\"><span style=\"top:-2.65em;margin-left:-0.0197em;margin-right:0.0417em;\"><span class=\"pstrut\" style=\"height:2.8em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.4502em;margin-left:-0.0278em;margin-right:0.0625em;\"><span class=\"pstrut\" style=\"height:2.6em;\"></span><span class=\"sizing reset-size4 size2 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1498em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2499em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin sizing reset-size6 size7\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9181em;vertical-align:-0.18em;\"></span><span class=\"mord mathnormal sizing reset-size6 size7\">c</span><span class=\"mord mathnormal sizing reset-size6 size7\">n</span><span class=\"mord sizing reset-size6 size7\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.313em;\"><span style=\"top:-2.65em;margin-left:0em;margin-right:0.0417em;\"><span class=\"pstrut\" style=\"height:2.8em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\">so</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin sizing reset-size6 size7\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.4274em;vertical-align:-0.4163em;\"></span><span class=\"mord mathnormal sizing reset-size6 size7\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal sizing reset-size6 size7\">a</span><span class=\"mord sizing reset-size6 size7\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8426em;\"><span style=\"top:-2.553em;margin-left:-0.0197em;margin-right:0.0417em;\"><span class=\"pstrut\" style=\"height:2.8em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.4502em;margin-left:-0.0278em;margin-right:0.0625em;\"><span class=\"pstrut\" style=\"height:2.6em;\"></span><span class=\"sizing reset-size4 size2 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1498em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.213em;margin-right:0.0417em;\"><span class=\"pstrut\" style=\"height:2.8em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3469em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p>çº¿æ®µæ ‘ç»“ç‚¹ç»´æŠ¤åŒºé—´<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mi>u</mi><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">sum</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span></span></span></span>ã€åŒºé—´æ•°ä¸ªæ•°ã€åŒºé—´<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mi>u</mi><msup><mi>m</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">sum^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>å³å¯ã€‚ç„¶å<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">nlogn</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">n</span></span></span></span>â€‹çº¿æ®µæ ‘æ ‘ä¸Šå¯å‘å¼åˆå¹¶å³å¯ã€‚</p>\n<div style=\"page-break-after: always;\"></div>\n<p>ç¤ºä¾‹2ï¼š<strong>2024æ­ç”µå¤šæ ¡3 æ—…è¡Œ</strong></p>\n<p>æœ‰ä¸€æ£µ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> ä¸ªç»“ç‚¹çš„æ— æ ¹æ ‘ï¼Œæ¯ä¸ªç»“ç‚¹éƒ½æœ‰å¯¹åº”çš„ç±»å‹ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">c_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> å’Œæƒé‡ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">w_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> ï¼Œä½ éœ€è¦åœ¨è¿™æ£µæ ‘ä¸Šè§„åˆ’è‹¥å¹²æ¬¡æ—…è¡Œã€‚</p>\n<p>å¯¹äºä¸€æ¬¡æ—…è¡Œï¼Œä½ å°†ä»ä¸€ä¸ªæ ‘ä¸Šçš„ä¸€ä¸ªç»“ç‚¹å‡ºå‘ï¼Œæ²¿ç€æ ‘ä¸Šçš„è¾¹è¿›è¡Œæ—…è¡Œï¼Œæœ€ç»ˆåˆ°è¾¾å¦ä¸€ä¸ªå’Œèµ·ç‚¹ç±»å‹ç›¸åŒçš„ç»“ç‚¹ã€‚</p>\n<p>ä½ ä¼šè¿›è¡Œå¾ˆå¤šæ¬¡æ—…è¡Œï¼Œä½†ä½ å¸Œæœ›å¯¹äºæ¯ä¸ªç»“ç‚¹ï¼Œåœ¨æ‰€æœ‰æ—…è¡Œè·¯çº¿ä¸­æœ€å¤šåªä¼šç»è¿‡ä¸€æ¬¡ã€‚</p>\n<p>ä¸€æ¬¡æ—…è¡Œçš„ä»·å€¼æ˜¯èµ·å§‹ç‚¹å’Œç»ˆæ­¢ç‚¹çš„æƒé‡å’Œï¼Œä½ éœ€è¦è§„åˆ’æ—…è¡Œçš„æ–¹æ¡ˆä½¿å¾—æ—…è¡Œçš„æ€»æƒé‡å’Œæœ€å¤§ã€‚</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>âˆ‘</mo><mi>n</mi><mo>â‰¤</mo><mn>2</mn><mi>e</mi><mn>5</mn><mo separator=\"true\">,</mo><msub><mi>c</mi><mi>i</mi></msub><mo>â‰¤</mo><mi>n</mi><mo separator=\"true\">,</mo><msub><mi>w</mi><mi>i</mi></msub><mo>â‰¤</mo><mn>1</mn><mi>e</mi><mn>6</mn></mrow><annotation encoding=\"application/x-tex\">\\sum n\\le 2e5,c_i\\le n,w_i \\le 1e6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ‘</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\">e</span><span class=\"mord\">5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8304em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span><span class=\"mord mathnormal\">e</span><span class=\"mord\">6</span></span></span></span>â€‹</p>\n<p>å’Œå­æ ‘æœ‰å…³ï¼Œè€ƒè™‘å­æ ‘åˆå¹¶ã€‚</p>\n<p>ä¸€ä¸ªå­æ ‘å†…æœ€ä¼˜è§£ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><msub><mi>p</mi><mi>u</mi></msub></mrow><annotation encoding=\"application/x-tex\">dp_u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼Œé‚£ä¹ˆå…¶å’Œå¦ä¸€ä¸ªå­æ ‘<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><msub><mi>p</mi><mi>v</mi></msub></mrow><annotation encoding=\"application/x-tex\">dp_v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>è¿›è¡Œåˆå¹¶æ›´æ–°ã€‚é‚£ä¹ˆæœ‰ä¸¤ç§æ›´æ–°æ–¹å¼ï¼š</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle mathsize=\"1.2em\"><mi>d</mi><msub><mi>p</mi><mi>u</mi></msub><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy=\"false\">(</mo><mi>d</mi><msub><mi>p</mi><mi>u</mi></msub><mo>+</mo><mi>d</mi><msub><mi>p</mi><mi>v</mi></msub><mo separator=\"true\">,</mo><mo stretchy=\"false\">{</mo><msub><mi>f</mi><mrow><mi>u</mi><mo separator=\"true\">,</mo><mi>c</mi></mrow></msub><mo>+</mo><msub><mi>f</mi><mrow><mi>v</mi><mo separator=\"true\">,</mo><mi>c</mi></mrow></msub><mo stretchy=\"false\">}</mo><mo stretchy=\"false\">)</mo></mstyle></mrow><annotation encoding=\"application/x-tex\">\\large dp_u=max(dp_u+dp_v,\\{f_{u,c}+f_{v,c}\\})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0667em;vertical-align:-0.2333em;\"></span><span class=\"mord mathnormal sizing reset-size6 size7\">d</span><span class=\"mord sizing reset-size6 size7\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.137em;\"><span style=\"top:-2.65em;margin-left:0em;margin-right:0.0417em;\"><span class=\"pstrut\" style=\"height:2.8em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel sizing reset-size6 size7\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2em;vertical-align:-0.3em;\"></span><span class=\"mord mathnormal sizing reset-size6 size7\">ma</span><span class=\"mord mathnormal sizing reset-size6 size7\">x</span><span class=\"mopen sizing reset-size6 size7\">(</span><span class=\"mord mathnormal sizing reset-size6 size7\">d</span><span class=\"mord sizing reset-size6 size7\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.137em;\"><span style=\"top:-2.65em;margin-left:0em;margin-right:0.0417em;\"><span class=\"pstrut\" style=\"height:2.8em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin sizing reset-size6 size7\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2356em;vertical-align:-0.3356em;\"></span><span class=\"mord mathnormal sizing reset-size6 size7\">d</span><span class=\"mord sizing reset-size6 size7\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.137em;\"><span style=\"top:-2.65em;margin-left:0em;margin-right:0.0417em;\"><span class=\"pstrut\" style=\"height:2.8em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct sizing reset-size6 size7\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mopen sizing reset-size6 size7\">{</span><span class=\"mord sizing reset-size6 size7\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.137em;\"><span style=\"top:-2.65em;margin-left:-0.1076em;margin-right:0.0417em;\"><span class=\"pstrut\" style=\"height:2.8em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">c</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2796em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin sizing reset-size6 size7\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2356em;vertical-align:-0.3356em;\"></span><span class=\"mord sizing reset-size6 size7\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.137em;\"><span style=\"top:-2.65em;margin-left:-0.1076em;margin-right:0.0417em;\"><span class=\"pstrut\" style=\"height:2.8em;\"></span><span class=\"sizing reset-size7 size4 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">c</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2796em;\"><span></span></span></span></span></span></span><span class=\"mclose sizing reset-size6 size7\">})</span></span></span></span></p>\n<p>å…¶ä¸­<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mrow><mi>u</mi><mo separator=\"true\">,</mo><mi>c</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">f_{u,c}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">c</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>è¡¨ç¤º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>å­æ ‘ä¸Šä¼ ä¸€ä¸ªé¢œè‰²ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span></span></span></span>çš„è·¯å¾„æ¥å£æ‰€èƒ½æä¾›çš„æœ€å¤§æƒå€¼å’Œã€‚æ˜¾ç„¶<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><msub><mi>p</mi><mi>u</mi></msub></mrow><annotation encoding=\"application/x-tex\">dp_u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>æ˜¯ä¸æä¾›ä¸Šä¼ è·¯å¾„çš„ã€‚</p>\n<p>å¯¹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mrow><mi>u</mi><mo separator=\"true\">,</mo><mi>c</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">f_{u,c}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">c</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>â€‹çš„æ›´æ–°æœ‰ä¸‹åˆ—å¼å­ï¼Œå‡ºäºå¯å‘å¼åˆå¹¶ï¼Œå¦‚æœ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>ä¸Šä¼ è·¯å¾„ç©¿è¿‡<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>ï¼Œåˆ™ä¸èƒ½ä½¿ç”¨<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><msub><mi>p</mi><mi>u</mi></msub></mrow><annotation encoding=\"application/x-tex\">dp_u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mrow><mi>u</mi><mo separator=\"true\">,</mo><mi>c</mi></mrow></msub><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy=\"false\">(</mo><msub><mi>f</mi><mrow><mi>u</mi><mo separator=\"true\">,</mo><mi>c</mi></mrow></msub><mo>+</mo><mi>d</mi><msub><mi>p</mi><mi>v</mi></msub><mo separator=\"true\">,</mo><msub><mi>f</mi><mrow><mi>v</mi><mo separator=\"true\">,</mo><mi>c</mi></mrow></msub><mo>+</mo><msub><mo>âˆ‘</mo><mrow><mi>t</mi><mo>âˆˆ</mo><mi>s</mi><mi>o</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>u</mi><mo stretchy=\"false\">)</mo></mrow></msub><mi>d</mi><msub><mi>p</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f_{u,c}=max(f_{u,c}+dp_v,f_{v,c}+\\sum_{t\\in son(u)} dp_t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">c</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord mathnormal\">ma</span><span class=\"mord mathnormal\">x</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">c</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">c</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2247em;vertical-align:-0.4747em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2253em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mrel mtight\">âˆˆ</span><span class=\"mord mathnormal mtight\">so</span><span class=\"mord mathnormal mtight\">n</span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">u</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4747em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>â€‹</p>\n<p>å¯å‘å¼çº¿æ®µæ ‘åˆå¹¶å³å¯ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">pragma</span> GCC optimize(3, <span class=\"string\">&quot;Ofast&quot;</span>, <span class=\"string\">&quot;inline&quot;</span>)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">using</span> i64 = <span class=\"type\">long</span> <span class=\"type\">long</span>;</span><br><span class=\"line\"><span class=\"type\">const</span> i64 mod = <span class=\"number\">998244353</span>;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> endl <span class=\"string\">&#x27;\\n&#x27;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> int long long</span></span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">node</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> l, r;</span><br><span class=\"line\">    i64 f;</span><br><span class=\"line\">    i64 lz = <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">3e5</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\">node tree[maxn &lt;&lt; <span class=\"number\">5</span>];</span><br><span class=\"line\"><span class=\"type\">int</span> tot = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">newnode</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    tot++;</span><br><span class=\"line\">    tree[tot] = &#123;<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> tot;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">pushup</span><span class=\"params\">(<span class=\"type\">int</span> rt)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    tree[rt].f = <span class=\"built_in\">max</span>(tree[tree[rt].l].f, tree[tree[rt].r].f);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">pushd</span><span class=\"params\">(<span class=\"type\">int</span> rt)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (tree[rt].lz)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tree[rt].l)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            tree[tree[rt].l].f += tree[rt].lz;</span><br><span class=\"line\">            tree[tree[rt].l].lz += tree[rt].lz;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tree[rt].r)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            tree[tree[rt].r].f += tree[rt].lz;</span><br><span class=\"line\">            tree[tree[rt].r].lz += tree[rt].lz;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        tree[rt].lz = <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">upd</span><span class=\"params\">(<span class=\"type\">int</span> &amp;rt, <span class=\"type\">int</span> pos, <span class=\"type\">int</span> val, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!rt)</span><br><span class=\"line\">        rt = <span class=\"built_in\">newnode</span>();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cl == cr)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        tree[rt].f = val;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">pushd</span>(rt);</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (pos &lt;= mid)</span><br><span class=\"line\">        <span class=\"built_in\">upd</span>(tree[rt].l, pos, val, cl, mid);</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"built_in\">upd</span>(tree[rt].r, pos, val, mid + <span class=\"number\">1</span>, cr);</span><br><span class=\"line\">    <span class=\"built_in\">pushup</span>(rt);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">vector&lt;i64&gt; dp, dpson, w, c;</span><br><span class=\"line\"><span class=\"type\">int</span> n;</span><br><span class=\"line\">vector&lt;vector&lt;<span class=\"type\">int</span>&gt;&gt; con;</span><br><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt; root;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">merges</span><span class=\"params\">(<span class=\"type\">int</span> &amp;rt1, <span class=\"type\">int</span> &amp;rt2, <span class=\"type\">int</span> cl, <span class=\"type\">int</span> cr, i64 &amp;ans, i64 dpv, i64 dpson)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!rt1 || !rt2)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (rt1)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            tree[rt1].f += dpv;</span><br><span class=\"line\">            tree[rt1].lz += dpv;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            tree[rt2].f += dpson;</span><br><span class=\"line\">            tree[rt2].lz += dpson;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        rt1 |= rt2;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cl == cr)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        ans = <span class=\"built_in\">max</span>(ans, tree[rt1].f + tree[rt2].f);</span><br><span class=\"line\">        tree[rt1].f = <span class=\"built_in\">max</span>(tree[rt1].f + dpv, tree[rt2].f + dpson);</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> mid = (cl + cr) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">pushd</span>(rt1), <span class=\"built_in\">pushd</span>(rt2);</span><br><span class=\"line\">    <span class=\"built_in\">merges</span>(tree[rt1].l, tree[rt2].l, cl, mid, ans, dpv, dpson);</span><br><span class=\"line\">    <span class=\"built_in\">merges</span>(tree[rt1].r, tree[rt2].r, mid + <span class=\"number\">1</span>, cr, ans, dpv, dpson);</span><br><span class=\"line\">    <span class=\"built_in\">pushup</span>(rt1);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"type\">int</span> u, <span class=\"type\">int</span> f)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">upd</span>(root[u], c[u], w[u], <span class=\"number\">1</span>, n);</span><br><span class=\"line\">    dp[u] = <span class=\"number\">0</span>, dpson[u] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> &amp;v : con[u])</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (v == f)</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        <span class=\"built_in\">dfs</span>(v, u);</span><br><span class=\"line\">        i64 tmp = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"built_in\">merges</span>(root[u], root[v], <span class=\"number\">1</span>, n, tmp, dp[v], dpson[u]);</span><br><span class=\"line\">        dp[u] = <span class=\"built_in\">max</span>(dp[u] + dp[v], tmp);</span><br><span class=\"line\">        dpson[u] += dp[v];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">solve</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    tot = <span class=\"number\">0</span>;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    dp.<span class=\"built_in\">assign</span>(n + <span class=\"number\">1</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    dpson.<span class=\"built_in\">assign</span>(n + <span class=\"number\">1</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    w.<span class=\"built_in\">assign</span>(n + <span class=\"number\">1</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    c.<span class=\"built_in\">assign</span>(n + <span class=\"number\">1</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    root.<span class=\"built_in\">assign</span>(n + <span class=\"number\">1</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">        cin &gt;&gt; c[i];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">        cin &gt;&gt; w[i];</span><br><span class=\"line\">    con.<span class=\"built_in\">assign</span>(n + <span class=\"number\">1</span>, <span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;());</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt; n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> u, v;</span><br><span class=\"line\">        cin &gt;&gt; u &gt;&gt; v;</span><br><span class=\"line\">        con[u].<span class=\"built_in\">push_back</span>(v);</span><br><span class=\"line\">        con[v].<span class=\"built_in\">push_back</span>(u);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">dfs</span>(<span class=\"number\">1</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    cout &lt;&lt; dp[<span class=\"number\">1</span>] &lt;&lt; endl;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// freopen(&quot;1002.in&quot;, &quot;r&quot;, stdin);</span></span><br><span class=\"line\">    <span class=\"comment\">// freopen(&quot;1.out&quot;, &quot;w&quot;, stdout);</span></span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"type\">int</span> t = <span class=\"number\">1</span>;</span><br><span class=\"line\">    cin &gt;&gt; t;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (t--)</span><br><span class=\"line\">        <span class=\"built_in\">solve</span>();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<p>ç¤ºä¾‹3ï¼šï¼ˆæœªçŸ¥æ¥æºï¼Œæœ±çš„ä¾‹é¢˜ï¼‰</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//å¤„ç†å­æ ‘ç›¸å…³çš„é—®é¢˜ï¼Œä¸æ”¯æŒä¿®æ”¹ï¼Œnlognçš„å¤æ‚åº¦ï¼Œç¦»çº¿ç®—æ³•</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> LL long long </span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> MAXN = <span class=\"number\">1e5</span> + <span class=\"number\">10</span>;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"type\">int</span> <span class=\"title\">read</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"type\">char</span> c = <span class=\"built_in\">getchar</span>(); <span class=\"type\">int</span> x = <span class=\"number\">0</span>, f = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(c &lt; <span class=\"string\">&#x27;0&#x27;</span> || c &gt; <span class=\"string\">&#x27;9&#x27;</span>) &#123;<span class=\"keyword\">if</span>(c == <span class=\"string\">&#x27;-&#x27;</span>) f = <span class=\"number\">-1</span>; c = <span class=\"built_in\">getchar</span>();&#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(c &gt;= <span class=\"string\">&#x27;0&#x27;</span> &amp;&amp; c &lt;= <span class=\"string\">&#x27;9&#x27;</span>) x = x * <span class=\"number\">10</span> + c - <span class=\"string\">&#x27;0&#x27;</span>, c = <span class=\"built_in\">getchar</span>();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> x * f;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"type\">int</span> N, col[MAXN], son[MAXN], siz[MAXN], cnt[MAXN], Mx, Son;</span><br><span class=\"line\">LL sum = <span class=\"number\">0</span>, ans[MAXN];</span><br><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt; v[MAXN];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"type\">int</span> x, <span class=\"type\">int</span> fa)</span> </span>&#123;</span><br><span class=\"line\">    siz[x] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; v[x].<span class=\"built_in\">size</span>(); i++) &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> to = v[x][i];</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(to == fa) <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        <span class=\"built_in\">dfs</span>(to, x);</span><br><span class=\"line\">        siz[x] += siz[to];</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(siz[to] &gt; siz[son[x]]) son[x] = to;<span class=\"comment\">//è½»é‡é“¾å‰–åˆ†</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"type\">int</span> x, <span class=\"type\">int</span> fa,<span class=\"type\">int</span> c)</span> </span>&#123;<span class=\"comment\">//æš´åŠ›è®¡ç®—xçš„å­æ ‘é¢œè‰²å’Œï¼Œä¸è€ƒè™‘é‡è¾¹ï¼Œ</span></span><br><span class=\"line\">    cnt[col[x]] +=c;<span class=\"comment\">//è¿™é‡Œå¯èƒ½ä¼šå› é¢˜ç›®è€Œå¼‚</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(cnt[col[x]] &gt; Mx) Mx = cnt[col[x]], sum = col[x];</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(cnt[col[x]] == Mx) sum += (LL)col[x];</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; v[x].<span class=\"built_in\">size</span>(); i++) &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> to = v[x][i];</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(to == fa || to == Son) <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        <span class=\"built_in\">add</span>(to, x,c);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">dfs2</span><span class=\"params\">(<span class=\"type\">int</span> x, <span class=\"type\">int</span> fa, <span class=\"type\">int</span> opt)</span> </span>&#123;<span class=\"comment\">//å¤„ç†å½“å‰èŠ‚ç‚¹çš„ç­”æ¡ˆ</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; v[x].<span class=\"built_in\">size</span>(); i++) &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> to = v[x][i];</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(to == fa) <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(to != son[x]) <span class=\"built_in\">dfs2</span>(to, x, <span class=\"number\">0</span>);<span class=\"comment\">//ç®€å•çš„å¾€è½»è¾¹èµ°ç®—è½»è¾¹çš„ç­”æ¡ˆï¼Œopt = 0è¡¨ç¤ºé€’å½’å®Œæˆåæ¶ˆé™¤å¯¹è¯¥ç‚¹çš„å½±å“</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(son[x]) <span class=\"built_in\">dfs2</span>(son[x], x, <span class=\"number\">1</span>), Son = son[x];<span class=\"comment\">//ç»Ÿè®¡é‡å„¿å­çš„è´¡çŒ®ï¼Œä¸æ¶ˆé™¤å½±å“</span></span><br><span class=\"line\">    <span class=\"comment\">//è¿™æ—¶å€™çš„sumå’ŒMxéƒ½æ˜¯åªè€ƒè™‘é‡å„¿å­è®¡ç®—å‡ºæ¥çš„</span></span><br><span class=\"line\">    <span class=\"built_in\">add</span>(x, fa,<span class=\"number\">1</span>); Son = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"comment\">//æš´åŠ›ç»Ÿè®¡æ‰€æœ‰è½»å„¿å­çš„è´¡çŒ®ï¼Œä¼šé€’å½’æ‰€æœ‰è½»å„¿å­ï¼Œé™¤äº†å½“å‰èŠ‚ç‚¹çš„é‡å„¿å­ï¼Œè€Œä¸æ˜¯son[x]ï¼Œå› ä¸ºè½»å„¿å­çš„é‡å„¿å­æ˜¯éœ€è¦è®¡ç®—çš„ï¼Œè¿™é‡Œåªæ˜¯ä¸éœ€è¦è®¡ç®—xçš„é‡å„¿å­</span></span><br><span class=\"line\">    ans[x] = sum;<span class=\"comment\">//æ›´æ–°ç­”æ¡ˆ</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!opt) <span class=\"built_in\">add</span>(x,fa,<span class=\"number\">-1</span>), sum = <span class=\"number\">0</span>, Mx = <span class=\"number\">0</span>;<span class=\"comment\">//å¦‚æœéœ€è¦åˆ é™¤è´¡çŒ®çš„è¯å°±åˆ æ‰</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    N = <span class=\"built_in\">read</span>();</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= N; i++) col[i] = <span class=\"built_in\">read</span>();</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= N - <span class=\"number\">1</span>; i++) &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> x = <span class=\"built_in\">read</span>(), y = <span class=\"built_in\">read</span>();</span><br><span class=\"line\">        v[x].<span class=\"built_in\">push_back</span>(y); v[y].<span class=\"built_in\">push_back</span>(x);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">dfs</span>(<span class=\"number\">1</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">dfs2</span>(<span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= N; i++) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%I64d &quot;</span>, ans[i]);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h2 id=\"6-å›¾çš„è¿é€šæ€§\">6.å›¾çš„è¿é€šæ€§</h2>\n<h3 id=\"6-1-æ— å‘å›¾è¿é€šæ€§\">6.1 æ— å‘å›¾è¿é€šæ€§</h3>\n<p>æ— å‘å›¾çš„è¿é€šæ€§ä¸»è¦å…³äºç‚¹åŒè”é€šåˆ†é‡å’Œè¾¹åŒè”é€šåˆ†é‡ï¼Œç”¨äºæ“ä½œç¼©ç‚¹ä»¥åŠç¼©è¾¹ï¼Œä»è€ŒæŠŠæ— å‘å›¾ä¸­çš„ç¯åˆ æ‰ã€‚</p>\n<h4 id=\"6-1-1-å‰²ç‚¹\">6.1.1 å‰²ç‚¹</h4>\n<p>å¯¹äºä¸€ä¸ªæ— å‘å›¾ï¼Œå¦‚æœæŠŠä¸€ä¸ªç‚¹åˆ é™¤åè¿™ä¸ªå›¾çš„æå¤§è¿é€šåˆ†é‡æ•°å¢åŠ äº†ï¼Œé‚£ä¹ˆè¿™ä¸ªç‚¹å°±æ˜¯è¿™ä¸ªå›¾çš„å‰²ç‚¹ï¼ˆåˆç§°å‰²é¡¶ï¼‰ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> pb push_back</span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> N=<span class=\"number\">2e4</span><span class=\"number\">+1e3</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> n,m,ans;</span><br><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt; g[N];</span><br><span class=\"line\"><span class=\"type\">bool</span> cut[N];</span><br><span class=\"line\"><span class=\"type\">int</span> dfn[N],low[N],cnt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">tarjan</span><span class=\"params\">(<span class=\"type\">int</span> u,<span class=\"type\">int</span> root)</span></span>&#123;</span><br><span class=\"line\">    dfn[u]=low[u]=++cnt;</span><br><span class=\"line\">    <span class=\"type\">int</span> child=<span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> v:g[u])&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!dfn[v])&#123;</span><br><span class=\"line\">            <span class=\"built_in\">tarjan</span>(v,root),low[u]=<span class=\"built_in\">min</span>(low[u],low[v]);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(low[v]&gt;=dfn[u]&amp;&amp;u!=root) cut[u]=<span class=\"literal\">true</span>;<span class=\"comment\">//å¦‚æœå„¿å­çš„lowå€¼å¤§äºç­‰äºdfnï¼Œåˆ™ä»£è¡¨å…¶ä¸ºå„¿å­ä¸å…¶ä»–éå­æ ‘ç‚¹ç›¸è¿çš„å”¯ä¸€é€”å¾„</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span>(u==root) child++;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> low[u]=<span class=\"built_in\">min</span>(low[u],dfn[v]);<span class=\"comment\">//æ³¨æ„è¿™é‡Œæ˜¯dfn[v]</span></span><br><span class=\"line\">    <span class=\"comment\">//å› ä¸ºå‰²ç‚¹åˆ¤å®šæ³•åˆ™æ˜¯å°äºç­‰äºå·ï¼Œæ‰€ä»¥åœ¨æ±‚å‰²ç‚¹æ—¶ï¼Œä¸å¿…è€ƒè™‘çˆ¶èŠ‚ç‚¹å’Œé‡è¾¹çš„é—®é¢˜ï¼Œä»xå‡ºå‘èƒ½è®¿é—®åˆ°çš„æ‰€æœ‰ç‚¹çš„æ—¶é—´æˆ³éƒ½å¯ä»¥ç”¨æ¥æ›´æ–° lowx</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(child&gt;=<span class=\"number\">2</span>&amp;&amp;u==root)cut[u]=<span class=\"literal\">true</span>;<span class=\"comment\">//å¯¹æ ¹çš„å¤„ç†,å¤§äºä¸¤ä¸ªå­æ ‘</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    cin&gt;&gt;n&gt;&gt;m;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>,u,v;i&lt;=m;i++)&#123;</span><br><span class=\"line\">        cin&gt;&gt;u&gt;&gt;v;</span><br><span class=\"line\">        g[u].<span class=\"built_in\">pb</span>(v);g[v].<span class=\"built_in\">pb</span>(u);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!dfn[i]) <span class=\"built_in\">tarjan</span>(i,i);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(cut[i]) ans++;</span><br><span class=\"line\">    cout&lt;&lt;ans&lt;&lt;endl;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(cut[i]) cout&lt;&lt;i&lt;&lt;<span class=\"string\">&quot; &quot;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"6-1-2-å‰²è¾¹\">6.1.2 å‰²è¾¹</h4>\n<p>å¯¹äºä¸€ä¸ªæ— å‘å›¾ï¼Œå¦‚æœåˆ æ‰ä¸€æ¡è¾¹åå›¾ä¸­çš„è¿é€šåˆ†é‡æ•°å¢åŠ äº†ï¼Œåˆ™ç§°è¿™æ¡è¾¹ä¸ºæ¡¥æˆ–è€…å‰²è¾¹ã€‚ä¸¥è°¨æ¥è¯´ï¼Œå°±æ˜¯ï¼šå‡è®¾æœ‰è¿é€šå›¾ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi><mo>=</mo><mo stretchy=\"false\">(</mo><mi>V</mi><mo separator=\"true\">,</mo><mi>E</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">G=(V,E)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mclose\">)</span></span></span></span>â€‹ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi></mrow><annotation encoding=\"application/x-tex\">e</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">e</span></span></span></span>â€‹æ˜¯å…¶ä¸­ä¸€æ¡è¾¹ï¼ˆå³ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi><mo>âˆˆ</mo><mi>E</mi></mrow><annotation encoding=\"application/x-tex\">e\\in E</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span></span></span></span>â€‹)ï¼Œå¦‚æœ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi><mo>âˆ’</mo><mi>e</mi></mrow><annotation encoding=\"application/x-tex\">G-e</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">G</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">e</span></span></span></span>â€‹ æ˜¯ä¸è¿é€šçš„ï¼Œåˆ™è¾¹ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi></mrow><annotation encoding=\"application/x-tex\">e</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">e</span></span></span></span>â€‹æ˜¯å›¾<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi></mrow><annotation encoding=\"application/x-tex\">G</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span></span></span></span>â€‹çš„ä¸€æ¡å‰²è¾¹ï¼ˆæ¡¥)ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> pb push_back</span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> N=<span class=\"number\">200</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> n,m,sum;</span><br><span class=\"line\"><span class=\"type\">int</span> a[<span class=\"number\">200</span>][<span class=\"number\">200</span>];</span><br><span class=\"line\"><span class=\"type\">bool</span> cut[N];</span><br><span class=\"line\"><span class=\"type\">int</span> dfn[N],low[N],cnt,fa[N];</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">Edge</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> x,y;</span><br><span class=\"line\">&#125; edge[<span class=\"number\">5001</span>];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">bool</span> <span class=\"title\">cmp</span><span class=\"params\">(<span class=\"keyword\">struct</span> Edge a,<span class=\"keyword\">struct</span> Edge b)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(a.x==b.x)<span class=\"keyword\">return</span> a.y&lt;b.y;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> a.x&lt;b.x;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">tarjan</span><span class=\"params\">(<span class=\"type\">int</span> u)</span></span>&#123;</span><br><span class=\"line\">    dfn[u]=low[u]=++cnt;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> v=<span class=\"number\">1</span>; v&lt;=n; v++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!a[u][v])<span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!dfn[v])&#123;</span><br><span class=\"line\">            fa[v]=u,<span class=\"built_in\">tarjan</span>(v),low[u]=<span class=\"built_in\">min</span>(low[u],low[v]);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(low[v]&gt;dfn[u]) edge[++sum].x=u, edge[sum].y=v;<span class=\"comment\">//å„¿å­å›ä¸åˆ°çˆ¶äº²ä»¥ä¸Šçš„ä½ç½®</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(v!=fa[u])low[u]=<span class=\"built_in\">min</span>(low[u],dfn[v]);<span class=\"comment\">//æ³¨æ„è¿™é‡Œä¸èƒ½æ˜¯fa[u],ä¸ç„¶ä¸Šé¢çš„ifé‚£é‡Œä¸€å®šå–ä¸äº†å¤§äºå·ï¼</span></span><br><span class=\"line\">        <span class=\"comment\">//lowçš„æ„æ€è¿™é‡Œæ˜¯ä¸ç»è¿‡çˆ¶äº²èƒ½å›åˆ°çš„æœ€æ—©çš„ç‚¹</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    cin&gt;&gt;n&gt;&gt;m;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>,u,v;i&lt;=m;i++)&#123;</span><br><span class=\"line\">        cin&gt;&gt;u&gt;&gt;v;</span><br><span class=\"line\">        a[u][v]=a[v][u]=<span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>; i&lt;=n; i++) </span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!dfn[i])<span class=\"built_in\">tarjan</span>(i);<span class=\"comment\">//tarjan</span></span><br><span class=\"line\">    <span class=\"built_in\">sort</span>(edge<span class=\"number\">+1</span>,edge+sum<span class=\"number\">+1</span>,cmp);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=sum; i++) &#123;</span><br><span class=\"line\">        cout&lt;&lt;<span class=\"built_in\">min</span>(edge[i].x,edge[i].y)&lt;&lt;<span class=\"string\">&#x27; &#x27;</span>&lt;&lt;<span class=\"built_in\">max</span>(edge[i].x,edge[i].y)&lt;&lt;endl;<span class=\"comment\">//è¾“å‡º</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>å°è£…é£æ ¼ï¼š</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\">map&lt;array&lt;<span class=\"type\">int</span>, 3&gt;, <span class=\"type\">int</span>&gt; mp;</span><br><span class=\"line\">    <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">dfn</span><span class=\"params\">(n)</span>, <span class=\"title\">low</span><span class=\"params\">(n)</span>, <span class=\"title\">fa</span><span class=\"params\">(n)</span></span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\">    function&lt;<span class=\"type\">void</span>(<span class=\"type\">int</span>)&gt; tarjan = [&amp;](<span class=\"type\">int</span> u)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        dfn[u] = low[u] = ++cnt;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> [v, w] : newcon[u])</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!dfn[v])</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                fa[v] = u, <span class=\"built_in\">tarjan</span>(v), low[u] = <span class=\"built_in\">min</span>(low[u], low[v]);</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (low[v] &gt; dfn[u])</span><br><span class=\"line\">                    mp[&#123;u, v, w&#125;] = mp[&#123;v, u, w&#125;] = <span class=\"number\">1</span>; <span class=\"comment\">// å‰²è¾¹</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (v != fa[u])</span><br><span class=\"line\">                low[u] = <span class=\"built_in\">min</span>(low[u], dfn[v]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!dfn[i])</span><br><span class=\"line\">            <span class=\"built_in\">tarjan</span>(i);</span><br></pre></td></tr></table></figure>\n<h4 id=\"6-1-3-ç‚¹åŒ\">6.1.3 ç‚¹åŒ</h4>\n<p>è‹¥ä¸€ä¸ªæ— å‘å›¾ä¸­çš„å»æ‰ä»»æ„ä¸€ä¸ªç‚¹éƒ½ä¸ä¼šæ”¹å˜æ­¤å›¾çš„è¿é€šæ€§ï¼Œå³ä¸å­˜åœ¨å‰²ç‚¹ï¼Œåˆ™ç§°ä½œç‚¹åŒè¿é€šå›¾ã€‚ä¸€ä¸ªæ— å‘å›¾ä¸­çš„æ¯ä¸€ä¸ªæå¤§ç‚¹åŒè¿é€šå­å›¾ç§°ä½œæ­¤æ— å‘å›¾çš„ç‚¹åŒè¿é€šåˆ†é‡ã€‚</p>\n<p>å¯¹äºä¸¤ä¸ªç‚¹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo separator=\"true\">,</mo><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">u,v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>ï¼Œå¦‚æœåˆ é™¤é™¤ä»–ä»¬è‡ªå·±å¤–å“ªä¸€ä¸ªç‚¹éƒ½ä¸èƒ½ä½¿å…¶ä¸è”é€šï¼Œåˆ™ç§°ä¸¤ç‚¹ä¹‹é—´åŒè”é€šã€‚ç‚¹åŒè”é€šä¸å…·æœ‰ä¼ é€’æ€§ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/*ç‚¹åŒè¿é€šï¼šè‹¥å¯¹äºä¸€ä¸ªæ— å‘å›¾ï¼Œå…¶ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹å¯¹äºè¿™ä¸ªå›¾æœ¬èº«è€Œè¨€éƒ½ä¸æ˜¯å‰²ç‚¹ï¼Œåˆ™ç§°å…¶ç‚¹åŒè¿é€šã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåˆ é™¤ä»»æ„ç‚¹åŠå…¶ç›¸å…³è¾¹åï¼Œæ•´ä¸ªå›¾ä»ç„¶å±äºä¸€ä¸ªè¿é€šåˆ†é‡ã€‚</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">ç‚¹åŒè¿é€šåˆ†é‡ï¼šæ— å‘å›¾ä¸­ï¼Œæå¤§çš„ç‚¹åŒè¿é€šå­å›¾ã€‚ä¸è¿é€šåˆ†é‡ç±»ä¼¼ï¼ŒæŠ½ç¦»å‡ºä¸€äº›ç‚¹åŠå®ƒä»¬ä¹‹é—´çš„è¾¹ï¼Œä½¿å¾—æŠ½ç¦»å‡ºçš„å›¾æ˜¯ä¸€ä¸ªç‚¹åŒè¿é€šå›¾ï¼Œåœ¨è¿™ä¸ªå‰æä¸‹ï¼Œä½¿å¾—æŠ½ç¦»å‡ºçš„å›¾è¶Šå¤§è¶Šå¥½ã€‚*/</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*æ¡¥ï¼ˆå‰²è¾¹ï¼‰ä¸å±äºä»»ä½• e-DCCï¼ˆè¾¹åŒè¿é€šåˆ†é‡ï¼‰ï¼Œä½†æ˜¯å‰²ç‚¹å¯èƒ½å±äºå¤šä¸ª v-DCC*/</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;iostream&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;vector&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> N = <span class=\"number\">1000010</span>, M = <span class=\"number\">5000010</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> dfn[N], low[N], stack[N],cut[N];</span><br><span class=\"line\"><span class=\"type\">int</span> n, m, tot = <span class=\"number\">1</span>, num, root, top, sum, cnt;</span><br><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt; dcc[N * <span class=\"number\">2</span>];<span class=\"comment\">//dcc[i] å­˜å‚¨ç¼–å·ä¸º i çš„ v-DCC ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹</span></span><br><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt; edge[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">tarjan</span><span class=\"params\">(<span class=\"type\">int</span> u,<span class=\"type\">int</span> root)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//ä¸ç”¨ç‰¹åˆ«æ ¹èŠ‚ç‚¹æ˜¯ä¸æ˜¯å‰²ç‚¹ï¼Œå®ƒä¸€å®šå±äºå®ƒå„¿å­çš„ç‚¹åŒä¸­ï¼Œæ— è®ºæ˜¯ä¸æ˜¯å‰²ç‚¹</span></span><br><span class=\"line\">    dfn[u] = low[u] = ++cnt;</span><br><span class=\"line\">    stack[++top] = u;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (u == root &amp;&amp; edge[u].<span class=\"built_in\">size</span>() == <span class=\"number\">0</span>) &#123; <span class=\"comment\">//å­¤ç«‹ç‚¹ç›´æ¥å¤„ç†</span></span><br><span class=\"line\">        dcc[++sum].<span class=\"built_in\">push_back</span>(u);</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> v:edge[u]) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!dfn[v]) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">tarjan</span>(v,root);low[u] = <span class=\"built_in\">min</span>(low[u], low[v]);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (low[v] &gt;= dfn[u]) &#123;<span class=\"comment\">//uä¸ºå‰²ç‚¹ï¼ŒæŠŠæ ˆé‡Œuå‰çš„éƒ½è¦å‡ºå»</span></span><br><span class=\"line\">                sum++;</span><br><span class=\"line\">                <span class=\"type\">int</span> z;</span><br><span class=\"line\">                <span class=\"keyword\">do</span> &#123;<span class=\"comment\">//å¼¹æ ˆ</span></span><br><span class=\"line\">                    z = stack[top--];</span><br><span class=\"line\">                    dcc[sum].<span class=\"built_in\">push_back</span>(z);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">while</span> (z != v);<span class=\"comment\">//æŠŠvå¼¹èµ°åç›®å‰æ ˆé¡¶ä¸ºu(uä¸ºå‰²ç‚¹)ï¼Œuä¸èƒ½å¼¹èµ°å› ä¸ºå®ƒå±äºå¤šä¸ªç‚¹åŒï¼ˆè‡³å°‘2ï¼‰</span></span><br><span class=\"line\">                dcc[sum].<span class=\"built_in\">push_back</span>(u);<span class=\"comment\">//å•ç‹¬åŠ å…¥u</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; </span><br><span class=\"line\">        <span class=\"keyword\">else</span> low[u] = <span class=\"built_in\">min</span>(low[u], dfn[v]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"literal\">false</span>);</span><br><span class=\"line\">    cin&gt;&gt;n&gt;&gt;m;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>,u,v;i&lt;=m;i++)&#123;</span><br><span class=\"line\">        cin&gt;&gt;u&gt;&gt;v;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(u!=v)edge[u].<span class=\"built_in\">push_back</span>(v),edge[v].<span class=\"built_in\">push_back</span>(u);<span class=\"comment\">//åˆ¤è‡ªç¯</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!dfn[i])<span class=\"built_in\">tarjan</span>(i,i);</span><br><span class=\"line\">    <span class=\"comment\">//for (int i=1;i&lt;=n;i++)cout&lt;&lt;low[i]&lt;&lt;endl;</span></span><br><span class=\"line\">    cout&lt;&lt;sum&lt;&lt;endl;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=sum;i++) &#123; </span><br><span class=\"line\">        cout&lt;&lt;dcc[i].<span class=\"built_in\">size</span>();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> j:dcc[i])</span><br><span class=\"line\">            cout &lt;&lt; <span class=\"string\">&#x27; &#x27;</span> &lt;&lt; j;</span><br><span class=\"line\">        cout&lt;&lt;endl;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"6-1-4-è¾¹åŒ\">6.1.4 è¾¹åŒ</h4>\n<p>è‹¥ä¸€ä¸ªæ— å‘å›¾ä¸­çš„å»æ‰ä»»æ„ä¸€æ¡è¾¹éƒ½ä¸ä¼šæ”¹å˜æ­¤å›¾çš„è¿é€šæ€§ï¼Œå³ä¸å­˜åœ¨å‰²æ¡¥ï¼Œåˆ™ç§°ä½œè¾¹åŒè¿é€šå›¾ã€‚ä¸€ä¸ªæ— å‘å›¾ä¸­çš„æ¯ä¸€ä¸ªæå¤§è¾¹åŒè¿é€šå­å›¾ç§°ä½œæ­¤æ— å‘å›¾çš„è¾¹åŒè¿é€šåˆ†é‡ã€‚</p>\n<p>åœ¨ä¸€å¼ è¿é€šçš„æ— å‘å›¾ä¸­ï¼Œå¯¹äºä¸¤ä¸ªç‚¹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>å’Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>ï¼Œå¦‚æœæ— è®ºåˆ å»å“ªæ¡è¾¹ï¼ˆåªèƒ½åˆ å»ä¸€æ¡ï¼‰éƒ½ä¸èƒ½ä½¿å®ƒä»¬ä¸è¿é€šï¼Œæˆ‘ä»¬å°±è¯´<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>å’Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span> <strong>è¾¹åŒè¿é€š</strong>ã€‚è¾¹åŒè”é€šå…·æœ‰ä¼ é€’æ€§</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//è¾¹åŒè¿é€šåˆ†é‡ï¼Œå¾ˆæ˜¾ç„¶ï¼Œè¾¹åŒè¿é€šåˆ†é‡ä¸­æ²¡æœ‰å‰²è¾¹ï¼Œæ‰€ä»¥åªéœ€è¦å»æ‰æ‰€æœ‰æ¡¥è¾¹å‰©ä¸‹çš„å°±æ˜¯è¾¹åŒï¼Œè·‘dfså³å¯</span></span><br><span class=\"line\"><span class=\"comment\">//æ³¨æ„è¿™é‡Œå¯èƒ½æœ‰é‡è¾¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å­˜å›¾çš„æ—¶å€™é¢å¤–å­˜ä¸€ä¸‹æ¯è¾¹çš„æ•°é‡ï¼ˆmapï¼‰ï¼Œæ‰¾æ¡¥çš„æ—¶å€™æ­£å¸¸æ‰¾ï¼Œå¦‚æœéæ¡¥è¾¹æœ‰å¤šä¸ªä¸å½±å“ï¼Œæ¡¥è¾¹æœ‰å¤šä¸ªå°±è¯´æ˜é¢å¤–è¿èµ·æ¥äº†ä¸¤ä¸ªv-eccï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°æ¡¥è¾¹å°±æ•°é‡-1ï¼Œdfsçš„æ—¶å€™æ­£å¸¸dfsï¼Œå¦‚æœæ¡¥è¾¹è¿˜æœ‰é‚£å°±èµ°ï¼Œæ²¡æœ‰çš„è¯å°±è¯´æ˜æ˜¯ä¸€ä¸ªv-ecc</span></span><br><span class=\"line\"><span class=\"comment\">//ç”¨äºæ— å‘å›¾çš„ç¼©ç‚¹</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> pb push_back</span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> N=<span class=\"number\">5e5</span><span class=\"number\">+10</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> n,m,sum;</span><br><span class=\"line\"><span class=\"type\">int</span> dfn[N],low[N],cnt,fa[N],vis[N];</span><br><span class=\"line\">unordered_map&lt;<span class=\"type\">int</span>,<span class=\"type\">int</span>&gt;mp[N];</span><br><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt;edge[N],ans[N];<span class=\"comment\">//anså³æ˜¯bcc</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">tarjan</span><span class=\"params\">(<span class=\"type\">int</span> u)</span></span>&#123;</span><br><span class=\"line\">    dfn[u]=low[u]=++cnt;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> v:edge[u]) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!dfn[v])&#123;</span><br><span class=\"line\">            fa[v]=u,<span class=\"built_in\">tarjan</span>(v),low[u]=<span class=\"built_in\">min</span>(low[u],low[v]);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(low[v]&gt;dfn[u]) mp[u][v]--,mp[v][u]--;<span class=\"comment\">//å„¿å­å›ä¸åˆ°çˆ¶äº²ä»¥ä¸Šçš„ä½ç½®</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(v!=fa[u])low[u]=<span class=\"built_in\">min</span>(low[u],dfn[v]);<span class=\"comment\">//æ³¨æ„è¿™é‡Œä¸èƒ½æ˜¯fa[u],ä¸ç„¶ä¸Šé¢çš„ifé‚£é‡Œä¸€å®šå–ä¸äº†å¤§äºå·ï¼</span></span><br><span class=\"line\">        <span class=\"comment\">//lowçš„æ„æ€è¿™é‡Œæ˜¯ä¸ç»è¿‡çˆ¶äº²èƒ½å›åˆ°çš„æœ€æ—©çš„ç‚¹</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"type\">int</span> u,<span class=\"type\">int</span> k)</span></span>&#123;</span><br><span class=\"line\">    ans[k].<span class=\"built_in\">emplace_back</span>(u);</span><br><span class=\"line\">    vis[u]=<span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> v:edge[u])&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!vis[v]&amp;&amp;mp[u][v])&#123;</span><br><span class=\"line\">            <span class=\"built_in\">dfs</span>(v,k);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    cin&gt;&gt;n&gt;&gt;m;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>,u,v;i&lt;=m;i++)&#123;</span><br><span class=\"line\">        cin&gt;&gt;u&gt;&gt;v;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(u==v)<span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(mp[u].<span class=\"built_in\">find</span>(v)==mp[u].<span class=\"built_in\">end</span>()||mp[v].<span class=\"built_in\">find</span>(u)==mp[v].<span class=\"built_in\">end</span>())&#123;</span><br><span class=\"line\">            edge[u].<span class=\"built_in\">push_back</span>(v);</span><br><span class=\"line\">            edge[v].<span class=\"built_in\">push_back</span>(u);</span><br><span class=\"line\">            mp[u][v]=<span class=\"number\">1</span>;</span><br><span class=\"line\">            mp[v][u]=<span class=\"number\">1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span>  mp[u][v]++,mp[v][u]++;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>; i&lt;=n; i++) </span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!dfn[i])<span class=\"built_in\">tarjan</span>(i);<span class=\"comment\">//tarjan</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>; i&lt;=n; i++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!vis[i])&#123;</span><br><span class=\"line\">            sum++;</span><br><span class=\"line\">            <span class=\"built_in\">dfs</span>(i,sum);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout&lt;&lt;sum&lt;&lt;endl;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=sum;i++)&#123;</span><br><span class=\"line\">        cout&lt;&lt;ans[i].<span class=\"built_in\">size</span>()&lt;&lt;<span class=\"string\">&quot; &quot;</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> j:ans[i])cout&lt;&lt;j&lt;&lt;<span class=\"string\">&quot; &quot;</span>;</span><br><span class=\"line\">        cout&lt;&lt;endl;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"6-1-5-åœ†æ–¹æ ‘\">*6.1.5 åœ†æ–¹æ ‘</h4>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//ç‚¹åŒçš„å…³é”®æ€§è´¨:å¯¹äºä¸€ä¸ªç‚¹åŒä¸­çš„ä¸¤ç‚¹ï¼Œå®ƒä»¬ä¹‹é—´ç®€å•è·¯å¾„çš„å¹¶é›†ï¼Œæ°å¥½å®Œå…¨ç­‰äºè¿™ä¸ªç‚¹åŒã€‚</span></span><br><span class=\"line\"><span class=\"comment\">//å³åŒä¸€ä¸ªç‚¹åŒä¸­çš„ä¸¤ä¸åŒç‚¹ u,v ä¹‹é—´ä¸€å®šå­˜åœ¨ä¸€æ¡ç®€å•è·¯å¾„ç»è¿‡ç»™å®šçš„åœ¨åŒä¸€ä¸ªç‚¹åŒå†…çš„å¦ä¸€ç‚¹ wã€‚æ‰€ä»¥çœ‹åˆ°ç®€å•è·¯å¾„çš„æ—¶å€™ï¼Œå¯ä»¥è€ƒè™‘åœ†æ–¹æ ‘</span></span><br><span class=\"line\"><span class=\"comment\">//åœ†æ–¹æ ‘ï¼šç‚¹åŒå½“ä½œä¸€ä¸ªç‚¹ï¼Œè¿™ä¸ªç‚¹å’Œæ‰€æœ‰ç‚¹è¿è¾¹å½¢æˆçš„æ ‘ï¼Œè¿™æ ·ä¸åŒç‚¹åŒä¼šé å‰²ç‚¹è”ç³»èµ·æ¥å½¢æˆä¸€æ£µæ ‘</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> int long long</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> endl <span class=\"string\">&#x27;\\n&#x27;</span><span class=\"comment\">//äº¤äº’é¢˜å°±åˆ </span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> N = <span class=\"number\">100005</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> n,m, cnt;</span><br><span class=\"line\"><span class=\"type\">int</span> dfn[N], low[N], dfc;</span><br><span class=\"line\"><span class=\"type\">int</span> stk[N], tp;</span><br><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt; G[N], T[N * <span class=\"number\">2</span>];<span class=\"comment\">//ç›¸å…³æ•°ç»„å¼€ä¸¤å€ï¼ï¼ï¼</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">tarjan</span><span class=\"params\">(<span class=\"type\">int</span> u)</span> </span>&#123;</span><br><span class=\"line\">    low[u] = dfn[u] = ++dfc; <span class=\"comment\">//dfsåº</span></span><br><span class=\"line\">    stk[++tp] = u; </span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> v : G[u]) &#123; <span class=\"comment\">// éå† u çš„ç›¸é‚»èŠ‚ç‚¹</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!dfn[v]) &#123; </span><br><span class=\"line\">            <span class=\"built_in\">tarjan</span>(v); low[u] = <span class=\"built_in\">min</span>(low[u], low[v]); </span><br><span class=\"line\">            <span class=\"keyword\">if</span> (low[v] == dfn[u]) &#123; <span class=\"comment\">// æ‰¾åˆ°ä¸€ä¸ªä»¥ u ä¸ºæ ¹çš„ç‚¹åŒè¿é€šåˆ†é‡</span></span><br><span class=\"line\">                ++cnt; <span class=\"comment\">// å¢åŠ æ–¹ç‚¹ä¸ªæ•°</span></span><br><span class=\"line\">                <span class=\"keyword\">for</span> (<span class=\"type\">int</span> x = <span class=\"number\">0</span>; x != v; --tp) &#123;<span class=\"comment\">// å°†ç‚¹åŒä¸­é™¤äº† u çš„ç‚¹é€€æ ˆï¼Œå¹¶åœ¨åœ†æ–¹æ ‘ä¸­è¿è¾¹</span></span><br><span class=\"line\">                    x = stk[tp];</span><br><span class=\"line\">                    T[cnt].<span class=\"built_in\">push_back</span>(x);</span><br><span class=\"line\">                    T[x].<span class=\"built_in\">push_back</span>(cnt);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                T[cnt].<span class=\"built_in\">push_back</span>(u);</span><br><span class=\"line\">                T[u].<span class=\"built_in\">push_back</span>(cnt);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> low[u] = <span class=\"built_in\">min</span>(low[u], dfn[v]); <span class=\"comment\">// å·²è®¿é—®çš„å’Œ dfn å– min</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin&gt;&gt;n&gt;&gt;m;</span><br><span class=\"line\">    cnt = n; </span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= m; ++i) &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> u, v;cin&gt;&gt;u&gt;&gt;v;</span><br><span class=\"line\">        G[u].<span class=\"built_in\">push_back</span>(v); </span><br><span class=\"line\">        G[v].<span class=\"built_in\">push_back</span>(u);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// å¤„ç†éè¿é€šå›¾</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> u = <span class=\"number\">1</span>; u &lt;= n; ++u)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!dfn[u]) <span class=\"built_in\">tarjan</span>(u), --tp;</span><br><span class=\"line\">        <span class=\"comment\">// æ³¨æ„åˆ°é€€å‡º Tarjan æ—¶æ ˆä¸­è¿˜æœ‰ä¸€ä¸ªå…ƒç´ å³æ ¹ï¼Œå°†å…¶é€€æ ˆ</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"6-2-æœ‰å‘å›¾è¿é€šæ€§\">6.2 æœ‰å‘å›¾è¿é€šæ€§</h3>\n<h4 id=\"6-2-1-å¼ºè¿é€šåˆ†é‡\">6.2.1 å¼ºè¿é€šåˆ†é‡</h4>\n<p>å¼ºè¿é€šçš„å®šä¹‰æ˜¯ï¼šæœ‰å‘å›¾ G å¼ºè¿é€šæ˜¯æŒ‡ï¼ŒG ä¸­ä»»æ„ä¸¤ä¸ªç»“ç‚¹è¿é€šã€‚</p>\n<p>å¼ºè¿é€šåˆ†é‡ï¼ˆStrongly Connected Componentsï¼ŒSCCï¼‰çš„å®šä¹‰æ˜¯ï¼šæå¤§çš„å¼ºè¿é€šå­å›¾</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span> <span class=\"comment\">//O(n+m)</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> int long long</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> endl <span class=\"string\">&#x27;\\n&#x27;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> inf = <span class=\"number\">0x3f3f3f3f</span>;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> N = <span class=\"number\">1e5</span> + <span class=\"number\">10</span>;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> M = <span class=\"number\">1e6</span> + <span class=\"number\">10</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> n, m, u, v, cnt, sum;</span><br><span class=\"line\"><span class=\"type\">int</span> dfn[N], low[N], vis[N], belong[N], flag[N]; <span class=\"comment\">// belongçš„å«ä¹‰æ˜¯è¿™ä¸ªç‚¹æ˜¯å¦å±äºä¸€ä¸ªå¼ºè¿é€šåˆ†é‡ï¼Œlow[x] xèƒ½é€šè¿‡æœ‰å‘è¾¹èƒ½å›æº¯åˆ°çš„æœ€æ—©æ—¶é—´æ®µ</span></span><br><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt; edge[N];</span><br><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt; q[N];</span><br><span class=\"line\">stack&lt;<span class=\"type\">int</span>&gt; s;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">tarjan</span><span class=\"params\">(<span class=\"type\">int</span> x)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123; <span class=\"comment\">// tarjanç®—æ³•ï¼Œå¤„ç†xæ‰€åœ¨çš„è¿é€šå—çš„å¼ºè¿é€šåˆ†é‡</span></span><br><span class=\"line\">    dfn[x] = low[x] = ++cnt;</span><br><span class=\"line\">    vis[x] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    s.<span class=\"built_in\">push</span>(x);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> i : edge[x])</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!dfn[i])</span><br><span class=\"line\">            <span class=\"built_in\">tarjan</span>(i), low[x] = <span class=\"built_in\">min</span>(low[i], low[x]);</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (!belong[i])</span><br><span class=\"line\">            low[x] = <span class=\"built_in\">min</span>(dfn[i], low[x]);</span><br><span class=\"line\">        <span class=\"comment\">// å¦‚æœè¿™ä¸ªç‚¹ä¸å±äºä»»ä½•ä¸€ä¸ªå¼ºè¿é€šåˆ†é‡ï¼Œè¯´æ˜åœ¨æ ˆä¸­ï¼Œå³éœ€è¦è€ƒè™‘æ›´æ–°lowå€¼</span></span><br><span class=\"line\">        <span class=\"comment\">// ä¸åœ¨æ ˆé‡Œè¯´æ˜ä¸å¯èƒ½å­˜åœ¨äºä¸€ä¸ªå¼ºè¿é€šåˆ†é‡(è®¿é—®è¿‡äº†åˆä¸åœ¨æ ˆé‡Œï¼Œè¯´æ˜å·²ç»æ˜¯ä¸€ä¸ªå¼ºè¿é€šåˆ†é‡å‡ºå»äº†)</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (low[x] == dfn[x])</span><br><span class=\"line\">    &#123; <span class=\"comment\">// å›æº¯æ—¶æŠŠï¼ˆxåˆ°æ ˆé¡¶çš„ç‚¹ï¼‰å…¨å½’ä¸ºä¸€ä¸ªå¼ºè¿é€šåˆ†é‡</span></span><br><span class=\"line\">        ++sum;</span><br><span class=\"line\">        q[sum].<span class=\"built_in\">push_back</span>(x);</span><br><span class=\"line\">        vis[x] = <span class=\"number\">0</span>; <span class=\"comment\">// é€€æ ˆ</span></span><br><span class=\"line\">        belong[x] = sum;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (s.<span class=\"built_in\">top</span>() != x)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> t = s.<span class=\"built_in\">top</span>();</span><br><span class=\"line\">            s.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">            q[sum].<span class=\"built_in\">push_back</span>(t);</span><br><span class=\"line\">            belong[t] = sum;</span><br><span class=\"line\">            vis[t] = <span class=\"number\">0</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        s.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= m; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cin &gt;&gt; u &gt;&gt; v;</span><br><span class=\"line\">        edge[u].<span class=\"built_in\">push_back</span>(v);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!dfn[i])</span><br><span class=\"line\">            <span class=\"built_in\">tarjan</span>(i);</span><br><span class=\"line\">    cout &lt;&lt; sum &lt;&lt; endl;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!flag[i])</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"built_in\">sort</span>(q[belong[i]].<span class=\"built_in\">begin</span>(), q[belong[i]].<span class=\"built_in\">end</span>());</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> j : q[belong[i]])</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                flag[j] = <span class=\"number\">1</span>;</span><br><span class=\"line\">                cout &lt;&lt; j &lt;&lt; <span class=\"string\">&quot; &quot;</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            cout &lt;&lt; endl;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"6-2-2-ç¼©ç‚¹\">6.2.2 ç¼©ç‚¹</h4>\n<p>ç¼©ç‚¹çš„æœ¬è´¨å°±æ˜¯ä¸€ä¸ªç¯å¯ä»¥ç­‰æ•ˆå¤„ç†æˆä¸€ä¸ªç‚¹æ—¶ï¼Œæˆ‘ä»¬æŠŠæ—§å›¾çš„æ¯ä¸€ä¸ªå¼ºè¿é€šåˆ†é‡å½“ä½œä¸€ä¸ªç‚¹å»ºç«‹ä¸€ä¸ªæ–°å›¾ï¼Œå¹¶æŠŠä¸€ä¸ªç¯çš„ä¿¡æ¯å…¨éƒ¨ç»Ÿè®¡åˆ°ä¸€ä¸ªæ–°ç‚¹ä¸Šã€‚</p>\n<p>ç»™å®šä¸€ä¸ª <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>ä¸ªç‚¹ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span> æ¡è¾¹æœ‰å‘å›¾ï¼Œæ¯ä¸ªç‚¹æœ‰ä¸€ä¸ªæƒå€¼ï¼Œæ±‚ä¸€æ¡è·¯å¾„ï¼Œä½¿è·¯å¾„ç»è¿‡çš„ç‚¹æƒå€¼ä¹‹å’Œæœ€å¤§ã€‚ä½ åªéœ€è¦æ±‚å‡ºè¿™ä¸ªæƒå€¼å’Œã€‚</p>\n<p>å…è®¸å¤šæ¬¡ç»è¿‡ä¸€æ¡è¾¹æˆ–è€…ä¸€ä¸ªç‚¹ï¼Œä½†æ˜¯ï¼Œé‡å¤ç»è¿‡çš„ç‚¹ï¼Œæƒå€¼åªè®¡ç®—ä¸€æ¬¡ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span> <span class=\"comment\">//ç¼©ç‚¹çš„æœ¬è´¨å°±æ˜¯ä¸€ä¸ªç¯å¯ä»¥ç­‰æ•ˆå¤„ç†æˆä¸€ä¸ªç‚¹æ—¶ï¼Œæˆ‘ä»¬æŠŠæ—§å›¾çš„æ¯ä¸€ä¸ªå¼ºè¿é€šåˆ†é‡å½“ä½œä¸€ä¸ªç‚¹å»ºç«‹ä¸€ä¸ªæ–°å›¾ï¼Œå¹¶æŠŠä¸€ä¸ªç¯çš„ä¿¡æ¯å…¨éƒ¨ç»Ÿè®¡åˆ°ä¸€ä¸ªæ–°ç‚¹ä¸Š</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> int long long</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> endl <span class=\"string\">&#x27;\\n&#x27;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> inf = <span class=\"number\">0x3f3f3f3f</span>;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> N = <span class=\"number\">1e5</span> + <span class=\"number\">10</span>;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> M = <span class=\"number\">1e6</span> + <span class=\"number\">10</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> n, m, u, v, cnt, sum, k;</span><br><span class=\"line\"><span class=\"type\">int</span> dfn[N], low[N], vis[N], belong[N], a[N], b[N], in[N], c[N], f[N];</span><br><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt; edge[N];</span><br><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt; out[N];</span><br><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt; inn[N];</span><br><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt; q[N];</span><br><span class=\"line\">stack&lt;<span class=\"type\">int</span>&gt; s;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">topo</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    queue&lt;<span class=\"type\">int</span>&gt; q;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= sum; i++)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!in[i])</span><br><span class=\"line\">            q.<span class=\"built_in\">push</span>(i);</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (!q.<span class=\"built_in\">empty</span>())</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> u = q.<span class=\"built_in\">front</span>();</span><br><span class=\"line\">        q.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">        c[++k] = u;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> j : out[u])</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            in[j]--;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!in[j])</span><br><span class=\"line\">                q.<span class=\"built_in\">push</span>(j);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">tarjan</span><span class=\"params\">(<span class=\"type\">int</span> x)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123; <span class=\"comment\">// tarjanç®—æ³•</span></span><br><span class=\"line\">    dfn[x] = low[x] = ++cnt;</span><br><span class=\"line\">    vis[x] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    s.<span class=\"built_in\">push</span>(x);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> i : edge[x])</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!dfn[i])</span><br><span class=\"line\">            <span class=\"built_in\">tarjan</span>(i), low[x] = <span class=\"built_in\">min</span>(low[i], low[x]);</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (vis[i])</span><br><span class=\"line\">            low[x] = <span class=\"built_in\">min</span>(low[i], low[x]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (low[x] == dfn[x])</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        ++sum;</span><br><span class=\"line\">        q[sum].<span class=\"built_in\">push_back</span>(x);</span><br><span class=\"line\">        vis[x] = <span class=\"number\">0</span>;</span><br><span class=\"line\">        belong[x] = sum;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (s.<span class=\"built_in\">top</span>() != x)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> t = s.<span class=\"built_in\">top</span>();</span><br><span class=\"line\">            s.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">            q[sum].<span class=\"built_in\">push_back</span>(t);</span><br><span class=\"line\">            belong[t] = sum;</span><br><span class=\"line\">            vis[t] = <span class=\"number\">0</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        s.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">        cin &gt;&gt; a[i];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= m; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cin &gt;&gt; u &gt;&gt; v;</span><br><span class=\"line\">        edge[u].<span class=\"built_in\">push_back</span>(v);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!dfn[i])</span><br><span class=\"line\">            <span class=\"built_in\">tarjan</span>(i);</span><br><span class=\"line\">    <span class=\"comment\">// ç°åœ¨æœ‰sumä¸ªå¼ºè¿é€šåˆ†é‡ï¼Œæ¥ä¸‹æ¥å°†æ¯ä¸ªå¼ºè¿é€šåˆ†é‡çš„ä¿¡æ¯ç»Ÿè®¡åˆ°ä¸€ä¸ªç‚¹ä¸Š</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= sum; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> j : q[i])</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            b[i] += a[j];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// bæ•°ç»„å‚¨å­˜äº†æ¯ä¸ªå¼ºè¿é€šåˆ†é‡çš„æƒå€¼å’Œï¼Œç»Ÿè®¡å®Œæ¯•åå»ºç«‹æ–°å›¾</span></span><br><span class=\"line\">    <span class=\"comment\">// å»ºå›¾æ—¶æ³¨æ„è€ƒè™‘ï¼Œä¸¤ä¸ªå¼ºè¿é€šåˆ†é‡ä¹‹é—´å¯èƒ½ä¼šæœ‰å¤šé‡è¾¹ï¼ï¼æœç´¢æ—¶æ³¨æ„visæ•°ç»„</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> j : edge[i])</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (belong[i] == belong[j])</span><br><span class=\"line\">                <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">            out[belong[i]].<span class=\"built_in\">push_back</span>(belong[j]);</span><br><span class=\"line\">            inn[belong[j]].<span class=\"built_in\">push_back</span>(belong[i]);</span><br><span class=\"line\">            in[belong[j]]++;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">topo</span>();</span><br><span class=\"line\">    <span class=\"comment\">// æ‹“æ‰‘æ’åºæ¥å†³å®šdpè½¬ç§»é¡ºåºï¼Œå› ä¸ºä¸€ä¸ªç‚¹çš„æœ€ä¼˜è§£æ˜¯ä»å®ƒçš„æ‰€æœ‰æ¥è¾¹è½¬ç§»è¿‡æ¥çš„ï¼Œæ‹“æ‰‘æ’åºå†³å®šäº†åœ¨å¤„ç†å½“å‰ç‚¹æ—¶ï¼Œå®ƒçš„æ¥è¾¹å·²ç»å…¨éƒ¨å¤„ç†å¥½äº†</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= k; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> u = c[i];</span><br><span class=\"line\">        f[u] = b[u];</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> j : inn[u])</span><br><span class=\"line\">        &#123; <span class=\"comment\">// ç›´æ¥è½¬ç§»å°±å¯ä»¥</span></span><br><span class=\"line\">            f[u] = <span class=\"built_in\">max</span>(f[u], f[j] + b[u]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> ans = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= k; i++)</span><br><span class=\"line\">        ans = <span class=\"built_in\">max</span>(ans, f[i]);</span><br><span class=\"line\">    cout &lt;&lt; ans;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h4 id=\"6-2-3-2-SATé€‚å®šæ€§é—®é¢˜\">*6.2.3 2-SATé€‚å®šæ€§é—®é¢˜</h4>\n<p>æœ‰ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> ä¸ªå¸ƒå°”å˜é‡ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>âˆ¼</mo></mrow><annotation encoding=\"application/x-tex\">\\sim</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">âˆ¼</span></span></span></span><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼Œå¦æœ‰ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span> ä¸ªéœ€è¦æ»¡è¶³çš„æ¡ä»¶ï¼Œæ¯ä¸ªæ¡ä»¶çš„å½¢å¼éƒ½æ˜¯ ã€Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> ä¸º <code>true</code> / <code>false</code> æˆ– <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span> ä¸º <code>true</code> / <code>false</code>ã€ã€‚æ¯”å¦‚ ã€Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> ä¸ºçœŸæˆ– <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>3</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> ä¸ºå‡ã€ã€ã€Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>7</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_7</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">7</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> ä¸ºå‡æˆ– <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> ä¸ºå‡ã€ã€‚</p>\n<p>2-SAT é—®é¢˜çš„ç›®æ ‡æ˜¯ç»™æ¯ä¸ªå˜é‡èµ‹å€¼ä½¿å¾—æ‰€æœ‰æ¡ä»¶å¾—åˆ°æ»¡è¶³ã€‚</p>\n<p><strong>è¾“å…¥æ ¼å¼</strong></p>\n<p>ç¬¬ä¸€è¡Œä¸¤ä¸ªæ•´æ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> å’Œ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>ï¼Œæ„ä¹‰å¦‚é¢˜é¢æ‰€è¿°ã€‚</p>\n<p>æ¥ä¸‹æ¥ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span> è¡Œæ¯è¡Œ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span> ä¸ªæ•´æ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>ï¼Œè¡¨ç¤º ã€Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span> æˆ– <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span> ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>ã€(<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo separator=\"true\">,</mo><mi>b</mi><mo>âˆˆ</mo><mo stretchy=\"false\">{</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">a, b\\in \\{0,1\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">}</span></span></span></span>)</p>\n<p><strong>è¾“å‡ºæ ¼å¼</strong></p>\n<p>å¦‚æ— è§£ï¼Œè¾“å‡º <code>IMPOSSIBLE</code>ï¼›å¦åˆ™è¾“å‡º <code>POSSIBLE</code>ã€‚</p>\n<p>ä¸‹ä¸€è¡Œ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> ä¸ªæ•´æ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>âˆ¼</mo><msub><mi>x</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_1\\sim x_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆ¼</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ï¼ˆ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>âˆˆ</mo><mo stretchy=\"false\">{</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">x_i\\in\\{0,1\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6891em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âˆˆ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">}</span></span></span></span>ï¼‰ï¼Œè¡¨ç¤ºæ„é€ å‡ºçš„è§£ã€‚</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>n</mi><mo separator=\"true\">,</mo><mi>m</mi><mo>â‰¤</mo><mn>1</mn><msup><mn>0</mn><mn>6</mn></msup></mrow><annotation encoding=\"application/x-tex\">1\\leq n, m\\leq 10^6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8304em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">6</span></span></span></span></span></span></span></span></span></span></span></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/*å®é™…çš„é—®é¢˜é‡Œå¾€å¾€æ˜¯ç»™å‡ºä¸€ä¸ªæ›´ç»†è‡´çš„æƒ…æ™¯ï¼Œè€Œä¸”é¢˜å¹²ä¿¡æ¯ä¸­</span></span><br><span class=\"line\"><span class=\"comment\">ä¼šæœ‰äºŒé€‰ä¸€çš„æ ‡å¿—ï¼Œæ­¤æ—¶å¯ä»¥è€ƒè™‘å¾€2-satæ¨¡å‹ä¸Šè€ƒè™‘ã€‚è€ƒè™‘è¿‡ç¨‹ï¼Œå³</span></span><br><span class=\"line\"><span class=\"comment\">å»å¯»æ‰¾é¢˜ç›®ä¸­çš„é™åˆ¶ï¼ŒæŠŠäºŒé€‰ä¸€ç­‰ä¿¡æ¯ï¼Œè½¬åŒ–ä¸ºä¸€ä¸ªè•´å«å…³ç³»ï¼Œå³</span></span><br><span class=\"line\"><span class=\"comment\">a â‡’ b è¿™æ ·çš„å¼å­*/</span></span><br><span class=\"line\"><span class=\"comment\">// å…¶ä¸­ä¸€ä¸ªä¸æˆç«‹åˆ™å¦ä¸€ä¸ªä¸€å®šæˆç«‹</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span> <span class=\"comment\">//O(n+m)</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> int long long</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> endl <span class=\"string\">&#x27;\\n&#x27;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> inf = <span class=\"number\">0x3f3f3f3f</span>;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> N = <span class=\"number\">2e6</span> + <span class=\"number\">10</span>;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> M = <span class=\"number\">2e6</span> + <span class=\"number\">10</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> n, m, u, v, cnt, sum;</span><br><span class=\"line\"><span class=\"type\">int</span> dfn[N], low[N], vis[N], belong[N], flag[N]; <span class=\"comment\">// belongçš„å«ä¹‰æ˜¯è¿™ä¸ªç‚¹æ˜¯å¦å±äºä¸€ä¸ªå¼ºè¿é€šåˆ†é‡ï¼Œlow[x] xèƒ½é€šè¿‡æœ‰å‘è¾¹èƒ½å›æº¯åˆ°çš„æœ€æ—©æ—¶é—´æ®µ</span></span><br><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt; edge[N];</span><br><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt; q[N];</span><br><span class=\"line\">stack&lt;<span class=\"type\">int</span>&gt; s;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">tarjan</span><span class=\"params\">(<span class=\"type\">int</span> x)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123; <span class=\"comment\">// tarjanç®—æ³•ï¼Œå¤„ç†xæ‰€åœ¨çš„è¿é€šå—çš„å¼ºè¿é€šåˆ†é‡</span></span><br><span class=\"line\">    dfn[x] = low[x] = ++cnt;</span><br><span class=\"line\">    vis[x] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    s.<span class=\"built_in\">push</span>(x);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> i : edge[x])</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!dfn[i])</span><br><span class=\"line\">            <span class=\"built_in\">tarjan</span>(i), low[x] = <span class=\"built_in\">min</span>(low[i], low[x]);</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (!belong[i])</span><br><span class=\"line\">            low[x] = <span class=\"built_in\">min</span>(dfn[i], low[x]);</span><br><span class=\"line\">        <span class=\"comment\">// å¦‚æœè¿™ä¸ªç‚¹ä¸å±äºä»»ä½•ä¸€ä¸ªå¼ºè¿é€šåˆ†é‡ï¼Œè¯´æ˜åœ¨æ ˆä¸­ï¼Œå³éœ€è¦è€ƒè™‘æ›´æ–°lowå€¼</span></span><br><span class=\"line\">        <span class=\"comment\">// ä¸åœ¨æ ˆé‡Œè¯´æ˜ä¸å¯èƒ½å­˜åœ¨äºä¸€ä¸ªå¼ºè¿é€šåˆ†é‡(è®¿é—®è¿‡äº†åˆä¸åœ¨æ ˆé‡Œï¼Œè¯´æ˜å·²ç»æ˜¯ä¸€ä¸ªå¼ºè¿é€šåˆ†é‡å‡ºå»äº†)</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (low[x] == dfn[x])</span><br><span class=\"line\">    &#123; <span class=\"comment\">// å›æº¯æ—¶æŠŠï¼ˆxåˆ°æ ˆé¡¶çš„ç‚¹ï¼‰å…¨å½’ä¸ºä¸€ä¸ªå¼ºè¿é€šåˆ†é‡</span></span><br><span class=\"line\">        ++sum;</span><br><span class=\"line\">        q[sum].<span class=\"built_in\">push_back</span>(x);</span><br><span class=\"line\">        vis[x] = <span class=\"number\">0</span>; <span class=\"comment\">// é€€æ ˆ</span></span><br><span class=\"line\">        belong[x] = sum;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (s.<span class=\"built_in\">top</span>() != x)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> t = s.<span class=\"built_in\">top</span>();</span><br><span class=\"line\">            s.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">            q[sum].<span class=\"built_in\">push_back</span>(t);</span><br><span class=\"line\">            belong[t] = sum;</span><br><span class=\"line\">            vis[t] = <span class=\"number\">0</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        s.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"type\">int</span> a, <span class=\"type\">int</span> b)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    edge[a].<span class=\"built_in\">push_back</span>(b);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= m; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> a, b, x, y;</span><br><span class=\"line\">        cin &gt;&gt; a &gt;&gt; x; <span class=\"comment\">// ç¬¬aä¸ªæ•°ä¸ºxæˆ–ç¬¬bä¸ªæ•°ä¸ºy</span></span><br><span class=\"line\">        cin &gt;&gt; b &gt;&gt; y;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (x == <span class=\"number\">0</span> &amp;&amp; y == <span class=\"number\">0</span>) <span class=\"comment\">//&quot;å¦‚æœç¬¬aä¸ªæ•°ä¸º0æˆ–ç¬¬bä¸ªæ•°ä¸º0&quot;è‡³å°‘æ»¡è¶³å…¶ä¸€</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"built_in\">add</span>(a + n, b); <span class=\"comment\">// a=1åˆ™b=0</span></span><br><span class=\"line\">            <span class=\"built_in\">add</span>(b + n, a); <span class=\"comment\">// b=1åˆ™a=0</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (x == <span class=\"number\">0</span> &amp;&amp; y == <span class=\"number\">1</span>) <span class=\"comment\">//&quot;å¦‚æœç¬¬aä¸ªæ•°ä¸º0æˆ–ç¬¬bä¸ªæ•°ä¸º1&quot;è‡³å°‘æ»¡è¶³å…¶ä¸€</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"built_in\">add</span>(a + n, b + n); <span class=\"comment\">// a=1åˆ™b=1</span></span><br><span class=\"line\">            <span class=\"built_in\">add</span>(b, a);         <span class=\"comment\">// b=0åˆ™a=0</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (x == <span class=\"number\">1</span> &amp;&amp; y == <span class=\"number\">0</span>) <span class=\"comment\">//&quot;å¦‚æœç¬¬aä¸ªæ•°ä¸º1æˆ–ç¬¬bä¸ªæ•°ä¸º0&quot;è‡³å°‘æ»¡è¶³å…¶ä¸€</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"built_in\">add</span>(a, b);         <span class=\"comment\">// a=0åˆ™b=0</span></span><br><span class=\"line\">            <span class=\"built_in\">add</span>(b + n, a + n); <span class=\"comment\">// b=1åˆ™a=1</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (x == <span class=\"number\">1</span> &amp;&amp; y == <span class=\"number\">1</span>) <span class=\"comment\">//&quot;å¦‚æœç¬¬aä¸ªæ•°ä¸º1æˆ–ç¬¬bä¸ªæ•°ä¸º1&quot;è‡³å°‘æ»¡è¶³å…¶ä¸€</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"built_in\">add</span>(a, b + n); <span class=\"comment\">// a=0åˆ™b=1</span></span><br><span class=\"line\">            <span class=\"built_in\">add</span>(b, a + n); <span class=\"comment\">// b=0åˆ™a=1</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= <span class=\"number\">2</span> * n; i++)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!dfn[i])</span><br><span class=\"line\">            <span class=\"built_in\">tarjan</span>(i); <span class=\"comment\">// ä¸¤å€</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (belong[i] == belong[i + n]) <span class=\"comment\">// åŒä¸€å˜é‡çš„ä¸¤ç§å–å€¼åœ¨åŒä¸€å¼ºè”é€šåˆ†é‡é‡Œ,è¯´æ˜æ— è§£</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            cout &lt;&lt; <span class=\"string\">&quot;IMPOSSIBLE&quot;</span> &lt;&lt; endl;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; <span class=\"string\">&quot;POSSIBLE&quot;</span> &lt;&lt; endl; <span class=\"comment\">// å¦åˆ™å°±æ˜¯æœ‰è§£</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (belong[i] &gt; belong[i + n])</span><br><span class=\"line\">            cout &lt;&lt; <span class=\"number\">1</span> &lt;&lt; <span class=\"string\">&quot; &quot;</span>; <span class=\"comment\">// ä¸¤ç§å–å€¼ä¸­é€‰æ‹©æ‹“æ‰‘åºè¾ƒå¤§çš„é‚£ä¸ªå€¼ï¼Œè€Œå¼ºè”é€šåˆ†é‡ç¼–å·è¶Šå° -&gt; æ‹“æ‰‘åºè¶Šå¤§ -&gt; è¶Šä¼˜</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">            cout &lt;&lt; <span class=\"number\">0</span> &lt;&lt; <span class=\"string\">&quot; &quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h2 id=\"7-åŸºç¯æ ‘\">*7. åŸºç¯æ ‘</h2>\n<p>åŸºç¯æ ‘ï¼Œåªæœ‰ä¸€ä¸ªç¯çš„æ ‘ï¼Œè¾¹æ•°ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>.</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//1. æš´åŠ›åˆ è¾¹</span></span><br><span class=\"line\"><span class=\"comment\">//æ¯æ¬¡æ–­å¼€ç¯ä¸Šçš„ä¸€æ¡è¾¹è·‘ä¸€éç­”æ¡ˆï¼Œç„¶åå–æœ€å¤§å€¼  é€‚ç”¨äº:æ•°æ®è¾ƒå°ï¼Œä¸”ç¯ä¸ä¼šå½±å“ç­”æ¡ˆçš„é¢˜ç›®</span></span><br><span class=\"line\"><span class=\"comment\">//egï¼šæ—…è¡Œï¼Œæ¯æ¬¡çš„æ—…è¡Œä¸€å®šæ˜¯èµ°n-1æ¡è¾¹ï¼Œç›´æ¥æš´åŠ›æšä¸¾åˆ æ‰æŸä¸€æ¡è¾¹ï¼Œè·‘ä¸€æ¬¡ç­”æ¡ˆ ï¼Œn^2è¿‡</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> int long long</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> endl <span class=\"string\">&#x27;\\n&#x27;</span><span class=\"comment\">//äº¤äº’é¢˜å°±åˆ </span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> inf=<span class=\"number\">0x3f3f3f3f</span>;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> N=<span class=\"number\">2e5</span><span class=\"number\">+10</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> n,m,x[N],y[N],ans[N],cnt,tx,ty,sum[N],vis[N];</span><br><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt;edge[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"type\">int</span> u,<span class=\"type\">int</span> fa)</span></span>&#123;</span><br><span class=\"line\">    ans[++cnt]=u;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> i:edge[u])&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(i!=fa)&#123;</span><br><span class=\"line\">            <span class=\"built_in\">dfs</span>(i,u);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">dfs2</span><span class=\"params\">(<span class=\"type\">int</span> u,<span class=\"type\">int</span> fa)</span></span>&#123;</span><br><span class=\"line\">    vis[u]=<span class=\"number\">1</span>;</span><br><span class=\"line\">    sum[++cnt]=u;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> i:edge[u])&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(i!=fa)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>((i==tx&amp;&amp;u==ty)||(i==ty&amp;&amp;u==tx)||vis[i])<span class=\"keyword\">continue</span>;</span><br><span class=\"line\">            <span class=\"built_in\">dfs2</span>(i,u);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">bool</span> <span class=\"title\">check</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(sum[i]==ans[i])<span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(sum[i]&gt;ans[i])<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>);cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin&gt;&gt;n&gt;&gt;m;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> u,v,i=<span class=\"number\">1</span>;i&lt;=m;i++)&#123;</span><br><span class=\"line\">        cin&gt;&gt;u&gt;&gt;v;</span><br><span class=\"line\">        edge[u].<span class=\"built_in\">push_back</span>(v);</span><br><span class=\"line\">        edge[v].<span class=\"built_in\">push_back</span>(u);</span><br><span class=\"line\">        x[i]=u;y[i]=v;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)</span><br><span class=\"line\">        <span class=\"built_in\">sort</span>(edge[i].<span class=\"built_in\">begin</span>(),edge[i].<span class=\"built_in\">end</span>());</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(m==n<span class=\"number\">-1</span>)&#123;</span><br><span class=\"line\">        <span class=\"built_in\">dfs</span>(<span class=\"number\">1</span>,<span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)</span><br><span class=\"line\">            cout&lt;&lt;ans[i]&lt;&lt;<span class=\"string\">&quot; &quot;</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=m;i++)&#123;</span><br><span class=\"line\">        <span class=\"built_in\">memset</span>(vis,<span class=\"number\">0</span>,<span class=\"built_in\">sizeof</span>(vis));</span><br><span class=\"line\">        tx=x[i],ty=y[i];cnt=<span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"built_in\">dfs2</span>(<span class=\"number\">1</span>,<span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(cnt&lt;n)<span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(ans[<span class=\"number\">1</span>]==<span class=\"number\">0</span>)</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">1</span>;j&lt;=n;j++)ans[j]=sum[j];</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(<span class=\"built_in\">check</span>())</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">1</span>;j&lt;=n;j++)ans[j]=sum[j];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)</span><br><span class=\"line\">        cout&lt;&lt;ans[i]&lt;&lt;<span class=\"string\">&quot; &quot;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//2. æ–­è¾¹è·‘ä¸¤æ¬¡</span></span><br><span class=\"line\"><span class=\"comment\">//éª‘å£«ï¼Œæ¯ä¸ªäººæœ‰ä¸ªè®¨åŒçš„äººï¼Œé‚£ä¹ˆå°±æ˜¯nä¸ªç‚¹næ¡è¾¹ï¼Œå½¢æˆäº†åŸºç¯æ ‘ï¼Œæ³¨æ„åˆ°ç¯ä¸Šçš„æŸä¸€æ¡è¾¹ï¼Œæ„å‘³ç€uå’Œvä¸èƒ½åŒæ—¶é€‰ï¼Œæˆ‘ä»¬è®¡ç®—ä¸¤ç§æƒ…å†µï¼Œé€‰uå’Œé€‰v</span></span><br><span class=\"line\"><span class=\"comment\">//ç­‰ä»·äºå¼ºåˆ¶éš”å¼€è¿™ä¸¤ä¸ªäººå„è‡ªé€‰ä¸€æ¬¡</span></span><br><span class=\"line\"><span class=\"comment\">//æ­£ç¡®æ€§ï¼šæ¯ä¸ªäººåªæœ‰ä¸€ä¸ªè®¨åŒçš„äººï¼Œé‚£ä¹ˆæœ€ç»ˆæƒ…å†µä¸€å®šæ˜¯ï¼Œè¦ä¹ˆæœ‰ä»–ï¼Œè¦ä¹ˆæœ‰ä»–è®¨åŒçš„äººï¼Œä¸å¯èƒ½éƒ½æ²¡æœ‰ï¼Œæ‰€ä»¥è·‘ä¸¤æ¬¡æ˜¯æ­£ç¡®çš„</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> int long long</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> endl <span class=\"string\">&#x27;\\n&#x27;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> N 1000010</span></span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> inf=<span class=\"number\">0x3f3f3f3f</span>;</span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">int</span> w[N],d[N],n,vis[N],flag,f[N][<span class=\"number\">2</span>],ans;</span><br><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt;edge[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">dp</span><span class=\"params\">(<span class=\"type\">int</span> u)</span></span>&#123;</span><br><span class=\"line\">    vis[u]=<span class=\"number\">1</span>;</span><br><span class=\"line\">    f[u][<span class=\"number\">0</span>]=<span class=\"number\">0</span>;f[u][<span class=\"number\">1</span>]=w[u];</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> i:edge[u])&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(i!=flag)&#123;<span class=\"comment\">//ä¸èƒ½dpå›æ ¹</span></span><br><span class=\"line\">            <span class=\"built_in\">dp</span>(i);</span><br><span class=\"line\">            f[u][<span class=\"number\">0</span>]+=<span class=\"built_in\">max</span>(f[i][<span class=\"number\">0</span>],f[i][<span class=\"number\">1</span>]);</span><br><span class=\"line\">            f[u][<span class=\"number\">1</span>]+=f[i][<span class=\"number\">0</span>];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"type\">int</span> u)</span></span>&#123;</span><br><span class=\"line\">    vis[u]=<span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(vis[d[u]])flag=u;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"built_in\">dfs</span>(d[u]);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>);cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin&gt;&gt;n;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> u,v,i=<span class=\"number\">1</span>;i&lt;=n;i++)&#123;</span><br><span class=\"line\">        cin&gt;&gt;w[i]&gt;&gt;d[i];</span><br><span class=\"line\">        edge[d[i]].<span class=\"built_in\">push_back</span>(i);<span class=\"comment\">//å­˜çš„æ˜¯ä»‡æ¨ä»–çš„äººæœ‰å“ªäº›</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(vis[i])<span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        <span class=\"built_in\">dfs</span>(i);</span><br><span class=\"line\">        <span class=\"comment\">//ç°åœ¨å·²ç»æ‰¾åˆ°äº†ä¸€ä¸ªç¯ä¸Šçš„ä¸€æ¡è¾¹:flag å’Œ d[flag]</span></span><br><span class=\"line\">        <span class=\"comment\">//æˆ‘ä»¬å¼ºåˆ¶å…¶ä¸­ä¸€ä¸ªç‚¹ä¸é€‰</span></span><br><span class=\"line\">        <span class=\"built_in\">dp</span>(flag);</span><br><span class=\"line\">        <span class=\"type\">int</span> ans1=f[flag][<span class=\"number\">0</span>];<span class=\"comment\">//ä¸é€‰flag</span></span><br><span class=\"line\">        flag=d[flag];</span><br><span class=\"line\">        <span class=\"built_in\">dp</span>(flag);</span><br><span class=\"line\">        <span class=\"type\">int</span> ans2=f[flag][<span class=\"number\">0</span>];<span class=\"comment\">//ä¸é€‰d[flag]</span></span><br><span class=\"line\">        ans+=<span class=\"built_in\">max</span>(ans1,ans2);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout&lt;&lt;ans&lt;&lt;endl;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h1>Part 5. å­—ç¬¦ä¸²</h1>\n<p><em><strong>å¼ºåˆ¶è§„å®šï¼šæ‰€æœ‰ä¸å­—ç¬¦ä¸²ç›¸å…³çš„æ•°ç»„ä¸‹æ ‡æˆ–è€…å‡½æ•°æ¥å£å¦‚æœæœªç‰¹æ®Šè¯´æ˜ï¼Œéƒ½æ˜¯ä»<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>å¼€å§‹ã€‚</strong></em></p>\n<h2 id=\"1-å­—ç¬¦ä¸²å“ˆå¸Œï¼ˆåŒå“ˆå¸Œï¼‰\">1.å­—ç¬¦ä¸²å“ˆå¸Œï¼ˆåŒå“ˆå¸Œï¼‰</h2>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">template</span> &lt;<span class=\"type\">int</span> m1, <span class=\"type\">int</span> mod1, <span class=\"type\">int</span> m2, <span class=\"type\">int</span> mod2&gt;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">Stringhashs</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n;</span><br><span class=\"line\">    vector&lt;i64&gt; h1, h2, mi1, mi2;</span><br><span class=\"line\">    string s;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">init</span><span class=\"params\">(<span class=\"type\">int</span> n)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>-&gt;n = n;</span><br><span class=\"line\">        h<span class=\"number\">1.</span><span class=\"built_in\">resize</span>(n + <span class=\"number\">10</span>);  <span class=\"comment\">// h1[i]è¡¨ç¤ºå‰iä¸ªå­—ç¬¦çš„å“ˆå¸Œå€¼ï¼Œæ³¨æ„å“ˆå¸Œæ•°ç»„æ˜¯ä»1å¼€å§‹çš„</span></span><br><span class=\"line\">        h<span class=\"number\">2.</span><span class=\"built_in\">resize</span>(n + <span class=\"number\">10</span>);  <span class=\"comment\">// h2[i]è¡¨ç¤ºå‰iä¸ªå­—ç¬¦çš„å“ˆå¸Œå€¼</span></span><br><span class=\"line\">        mi<span class=\"number\">1.</span><span class=\"built_in\">resize</span>(n + <span class=\"number\">10</span>); <span class=\"comment\">// mi1[i]è¡¨ç¤ºm1^i,å“ˆå¸Œæ¨¡æ•°</span></span><br><span class=\"line\">        mi<span class=\"number\">2.</span><span class=\"built_in\">resize</span>(n + <span class=\"number\">10</span>); <span class=\"comment\">// mi2[i]è¡¨ç¤ºm2^i,å“ˆå¸Œæ¨¡æ•°</span></span><br><span class=\"line\">        mi1[<span class=\"number\">0</span>] = mi2[<span class=\"number\">0</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        s.<span class=\"built_in\">clear</span>();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            mi1[i] = (i64)mi1[i - <span class=\"number\">1</span>] * m1 % mod1;</span><br><span class=\"line\">            mi2[i] = (i64)mi2[i - <span class=\"number\">1</span>] * m2 % mod2;</span><br><span class=\"line\">            h1[i] = ((i64)h1[i - <span class=\"number\">1</span>] * m1 + s[i - <span class=\"number\">1</span>]) % mod1;</span><br><span class=\"line\">            h2[i] = ((i64)h2[i - <span class=\"number\">1</span>] * m2 + s[i - <span class=\"number\">1</span>]) % mod2;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">insert</span><span class=\"params\">(string s)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">assert</span>(s.<span class=\"built_in\">size</span>() &lt;= n);</span><br><span class=\"line\">        <span class=\"keyword\">this</span>-&gt;s = s;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; s.<span class=\"built_in\">size</span>(); i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            h1[i + <span class=\"number\">1</span>] = ((i64)h1[i] * m1 % mod1 + s[i]) % mod1;</span><br><span class=\"line\">            h2[i + <span class=\"number\">1</span>] = ((i64)h2[i] * m2 % mod2 + s[i]) % mod2;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">array&lt;<span class=\"type\">int</span>, 2&gt; <span class=\"title\">queryfullhash</span><span class=\"params\">(string s)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> h1 = <span class=\"number\">0</span>, h2 = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; s.<span class=\"built_in\">size</span>(); i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            h1 = ((i64)h1 * m1 % mod1 + s[i]) % mod1;</span><br><span class=\"line\">            h2 = ((i64)h2 * m2 % mod2 + s[i]) % mod2;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> &#123;h1, h2&#125;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">array&lt;<span class=\"type\">int</span>, 2&gt; <span class=\"title\">query</span><span class=\"params\">(<span class=\"type\">int</span> l, <span class=\"type\">int</span> r)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">assert</span>(n);</span><br><span class=\"line\">        <span class=\"built_in\">assert</span>(l &gt;= <span class=\"number\">0</span> &amp;&amp; r &lt; n &amp;&amp; l &lt;= r);</span><br><span class=\"line\">        l++, r++;</span><br><span class=\"line\">        <span class=\"type\">int</span> h1 = ((<span class=\"keyword\">this</span>-&gt;h1[r] - (i64)<span class=\"keyword\">this</span>-&gt;h1[l - <span class=\"number\">1</span>] * mi1[r - l + <span class=\"number\">1</span>] % mod1) % mod1 + mod1) % mod1;</span><br><span class=\"line\">        <span class=\"type\">int</span> h2 = ((<span class=\"keyword\">this</span>-&gt;h2[r] - (i64)<span class=\"keyword\">this</span>-&gt;h2[l - <span class=\"number\">1</span>] * mi2[r - l + <span class=\"number\">1</span>] % mod2) % mod2 + mod2) % mod2;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> &#123;h1, h2&#125;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> mod1 = <span class=\"number\">1e9</span> + <span class=\"number\">7</span>, mod2 = <span class=\"number\">998244353</span>;</span><br><span class=\"line\"><span class=\"keyword\">using</span> hashs = Stringhashs&lt;<span class=\"number\">131</span>, mod1, <span class=\"number\">13331</span>, mod2&gt;;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h2 id=\"2-KMPå­—ç¬¦ä¸²åŒ¹é…\">2.KMPå­—ç¬¦ä¸²åŒ¹é…</h2>\n<p>é€‚é…ï¼šæ–‡æœ¬ä¸²å›ºå®š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>ï¼Œå¤šä¸ªä¸»ä¸²<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span>ï¼Œè¯¢é—®<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>åœ¨<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span>ä¸­å‡ºç°çš„æ¬¡æ•°ã€‚æ—¶é—´å¤æ‚åº¦<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">âˆ£</mi><mi>T</mi><mi mathvariant=\"normal\">âˆ£</mi><mo>+</mo><mo>âˆ‘</mo><mi mathvariant=\"normal\">âˆ£</mi><mi>S</mi><mi mathvariant=\"normal\">âˆ£</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(|T|+\\sum |S|)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">âˆ£</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord\">âˆ£</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ‘</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">âˆ£</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord\">âˆ£</span><span class=\"mclose\">)</span></span></span></span></p>\n<h3 id=\"2-1-å‰ç¼€å‡½æ•°ä¸nxtæ•°ç»„\">2.1 å‰ç¼€å‡½æ•°ä¸nxtæ•°ç»„</h3>\n<p>å‰ç¼€å‡½æ•°å®šä¹‰ï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Ï€</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\pi[i]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">Ï€</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span></span></span></span>è¡¨ç¤º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mi mathvariant=\"normal\">.</mi><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">s.substr(0,i+1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord\">.</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>ä¸­å…¬å…±å‰åç¼€çš„é•¿åº¦ã€‚å³æœ‰<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><mi>Ï€</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo>âˆ’</mo><mn>1</mn><mo stretchy=\"false\">]</mo><mo>=</mo><mi>s</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo>âˆ’</mo><mi>Ï€</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo>+</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator=\"true\">,</mo><mi>i</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">s[0,\\cdots,\\pi[i]-1]=s[i-\\pi[i]+1,\\cdots,i]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">Ï€</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">Ï€</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span></span></span></span>ã€‚</p>\n<p>è§„å®šé•¿åº¦ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>çš„å­—ç¬¦ä¸²å‰ç¼€å‡½æ•°ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">prefix_function</span><span class=\"params\">(string s)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"type\">int</span> n = (<span class=\"type\">int</span>)s.<span class=\"built_in\">length</span>();</span><br><span class=\"line\">  <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">pi</span><span class=\"params\">(n)</span></span>;</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt; n; i++) &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> j = pi[i - <span class=\"number\">1</span>];</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (j &gt; <span class=\"number\">0</span> &amp;&amp; s[i] != s[j]) j = pi[j - <span class=\"number\">1</span>];</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (s[i] == s[j]) j++;</span><br><span class=\"line\">    pi[i] = j;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> pi;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>åŸºäºæ­¤ç»´æŠ¤çš„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mi>M</mi><mi>P</mi><mtext>Â </mtext><mi>n</mi><mi>x</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">KMP\\ nxt</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">MP</span><span class=\"mspace\">Â </span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">t</span></span></span></span>æ•°ç»„å°±æ˜¯æ–¹ä¾¿å¯»æ‰¾å¤±é…ä¹‹åä¸‹ä¸€ä¸ªé…å¯¹çš„ä½ç½®ï¼š</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\">nxt[<span class=\"number\">0</span>] = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>, j = <span class=\"number\">0</span>; i &lt; T.<span class=\"built_in\">size</span>(); i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (j &amp;&amp; T[i] != T[j])</span><br><span class=\"line\">                j = nxt[j - <span class=\"number\">1</span>];</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (T[i] == T[j])</span><br><span class=\"line\">                j++;</span><br><span class=\"line\">            nxt[i] = j;</span><br><span class=\"line\">        &#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-2-KMPå­—ç¬¦ä¸²æ¨¡å¼åŒ¹é…ç®—æ³•\">2.2 KMPå­—ç¬¦ä¸²æ¨¡å¼åŒ¹é…ç®—æ³•</h3>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mi>M</mi><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">KMP</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">MP</span></span></span></span>ç®—æ³•çš„ç²¾é«“åœ¨äºå½“å‰åŒ¹é…å¤±é…ä¹‹åæ¨¡å¼ä¸²<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>çš„æŒ‡é’ˆè·³åˆ°å“ªé‡Œå¼€å§‹é‡æ–°åŒ¹é…çš„é—®é¢˜ã€‚å› ä¸ºå·²åŒ¹é…éƒ¨åˆ†ä¿è¯äº†ä¸¤æ®µç›¸åŒï¼Œé‚£ä¹ˆåªéœ€è¦è·³åˆ°å…¬å…±å‰åç¼€çš„å‰ç¼€åä¸€ä½ç»§ç»­åŒ¹é…å°±è¡Œäº†ã€‚å‰ç¼€å‡½æ•°æ˜¯å¯¹æ¨¡å¼ä¸²<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>æ±‚è§£çš„ã€‚</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mi>M</mi><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">KMP</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">MP</span></span></span></span>åŒ¹é…æ€æƒ³ä¸åªå±€é™äºå­—ç¬¦ä¸²åŒ¹é…ï¼Œä¸åŒ¹é…æœ‰å…³çš„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">dp</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">p</span></span></span></span>é¢˜ä¹Ÿä¼šåˆ©ç”¨åˆ°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mi>x</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">nxt</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">t</span></span></span></span>æ•°ç»„çš„æ€æƒ³æ¥ä¼˜åŒ–<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">dp</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">p</span></span></span></span>ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">KMP</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    string T;</span><br><span class=\"line\">    vector&lt;<span class=\"type\">int</span>&gt; nxt;</span><br><span class=\"line\">    <span class=\"built_in\">KMP</span>(string T) : <span class=\"built_in\">T</span>(T)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        nxt.<span class=\"built_in\">resize</span>(T.<span class=\"built_in\">size</span>());</span><br><span class=\"line\">        nxt[<span class=\"number\">0</span>] = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>, j = <span class=\"number\">0</span>; i &lt; T.<span class=\"built_in\">size</span>(); i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (j &amp;&amp; T[i] != T[j])</span><br><span class=\"line\">                j = nxt[j - <span class=\"number\">1</span>];</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (T[i] == T[j])</span><br><span class=\"line\">                j++;</span><br><span class=\"line\">            nxt[i] = j;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">match</span><span class=\"params\">(string S)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        vector&lt;<span class=\"type\">int</span>&gt; res;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>, j = <span class=\"number\">0</span>; i &lt; S.<span class=\"built_in\">size</span>(); i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (j &amp;&amp; S[i] != T[j])</span><br><span class=\"line\">                j = nxt[j - <span class=\"number\">1</span>];</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (S[i] == T[j])</span><br><span class=\"line\">                j++;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (j == T.<span class=\"built_in\">size</span>())</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                res.<span class=\"built_in\">push_back</span>(i - j + <span class=\"number\">1</span>);</span><br><span class=\"line\">                j = nxt[j - <span class=\"number\">1</span>];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<p>ç¤ºä¾‹1:<strong>2024æ¹–å—çœèµ› ç»æ–‡</strong></p>\n<p>é¢˜ç›®å¤§æ„ï¼šæœ‰ä¸€ä¸ªé•¿åº¦ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>â‰¤</mo><mn>1000</mn></mrow><annotation encoding=\"application/x-tex\">n\\le 1000</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1000</span></span></span></span>çš„ç©ºä¸²å’Œé•¿åº¦ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>â‰¤</mo><mn>100</mn></mrow><annotation encoding=\"application/x-tex\">t\\le 100</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">100</span></span></span></span>çš„æ¨¡å¼ä¸²<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>ï¼Œè¯¢é—®æœ‰å¤šå°‘ç”¨å°å†™è‹±æ–‡å­—æ¯å¡«å……ç©ºä¸²çš„æ–¹æ¡ˆæ•°ï¼Œä½¿å¾—<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>äºå…¶ä¸­ä¸ç›¸äº¤çš„å‡ºç°ç²¾å‡†<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>æ¬¡ã€‚</p>\n<p>è®¾<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><msub><mi>p</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi><mo separator=\"true\">,</mo><mi>l</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">dp_{i,j,l}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>è¡¨ç¤ºå‰<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>ä¸ªå­—ç¬¦å·²ç»åŒ¹é…äº†<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>ä¸ªå®Œæ•´æ–‡æœ¬ä¸²ï¼Œç°åœ¨æ­£åœ¨åŒ¹é…<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi></mrow><annotation encoding=\"application/x-tex\">l</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span></span></span></span>ä½ç½®çš„æ–¹æ¡ˆæ•°ã€‚æšä¸¾<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>26</mn></mrow><annotation encoding=\"application/x-tex\">26</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">26</span></span></span></span>ä¸ªå°å†™å­—æ¯ï¼Œåˆå§‹åŒ¹é…æŒ‡é’ˆ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mi>r</mi><mi>e</mi><mo>=</mo><mi>l</mi></mrow><annotation encoding=\"application/x-tex\">pre=l</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">re</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span></span></span></span></p>\n<p>å¦‚æœ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mo stretchy=\"false\">[</mo><mi>p</mi><mi>r</mi><mi>e</mi><mo stretchy=\"false\">]</mo><mo>=</mo><mo>=</mo><mi>c</mi><mi>h</mi><mi>a</mi><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">s[pre]==char</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">re</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">==</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">ha</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span>ï¼Œåˆ™ç›´æ¥æœ‰<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><mi>j</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><mi>p</mi><mi>r</mi><mi>e</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">]</mo><mo>+</mo><mo>=</mo><mi>d</mi><mi>p</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><mi>j</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><mi>l</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">dp[i][j][pre+1]+=dp[i][j][l]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">]</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">re</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span><span class=\"mord\">+</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">]</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mclose\">]</span></span></span></span>ï¼Œæ»¡ä¸€ä¸ªåˆ™<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>è¿›ä½ã€‚</p>\n<p>å¦‚æœè¯¥å­—ç¬¦å¯¼è‡´äº†<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mi>a</mi><mi>i</mi><mi>l</mi></mrow><annotation encoding=\"application/x-tex\">fail</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\">ai</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span></span></span></span>åŒ¹é…ï¼Œåˆ™ç±»ä¼¼<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mi>M</mi><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">KMP</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">MP</span></span></span></span>è·³è½¬<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mi>r</mi><mi>e</mi><mo>=</mo><mi>n</mi><mi>x</mi><mi>t</mi><mo stretchy=\"false\">[</mo><mi>p</mi><mi>r</mi><mi>e</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">pre=nxt[pre-1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">re</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">re</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>ï¼Œç»§ç»­ä¸‹ä¸€ä¸ªä½ç½®çš„åŒ¹é…ï¼Œç›´åˆ°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mi>r</mi><mi>e</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">pre=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">re</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>ã€‚å¦‚æœ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mi>r</mi><mi>e</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">pre=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">re</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>éƒ½æœªèƒ½åŒ¹é…ï¼Œåˆ™è¯´æ˜ä¸‹ä¸€ä¸ªä½ç½®åªèƒ½ä»å¤´å¼€å§‹ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">bool</span> flag = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"keyword\">for</span> (<span class=\"type\">int</span> pre = l; <span class=\"number\">1</span>; pre = nxt[pre - <span class=\"number\">1</span>])</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (s[pre] == <span class=\"string\">&#x27;a&#x27;</span> + m)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (pre == sz - <span class=\"number\">1</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (j + <span class=\"number\">1</span> &lt;= k)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                dp[i + <span class=\"number\">1</span>][j + <span class=\"number\">1</span>][<span class=\"number\">0</span>] += dp[i][j][l];</span><br><span class=\"line\">                dp[i + <span class=\"number\">1</span>][j + <span class=\"number\">1</span>][<span class=\"number\">0</span>] %= mod;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            dp[i + <span class=\"number\">1</span>][j][pre + <span class=\"number\">1</span>] += dp[i][j][l];</span><br><span class=\"line\">            dp[i + <span class=\"number\">1</span>][j][pre + <span class=\"number\">1</span>] %= mod;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        flag = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!pre)</span><br><span class=\"line\">        <span class=\"keyword\">break</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>å®Œæ•´ä»£ç ï¼š</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">solve</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n, k;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; k;</span><br><span class=\"line\">    string s;</span><br><span class=\"line\">    cin &gt;&gt; s;</span><br><span class=\"line\">    <span class=\"type\">int</span> sz = s.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">    <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">nxt</span><span class=\"params\">(sz)</span></span>;</span><br><span class=\"line\">    nxt[<span class=\"number\">0</span>] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>, j = <span class=\"number\">0</span>; i &lt; sz; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (j &amp;&amp; s[i] != s[j])</span><br><span class=\"line\">            j = nxt[j - <span class=\"number\">1</span>];</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (s[i] == s[j])</span><br><span class=\"line\">            j++;</span><br><span class=\"line\">        nxt[i] = j;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    vector&lt;vector&lt;vector&lt;i64&gt;&gt;&gt; <span class=\"built_in\">dp</span>(n + <span class=\"number\">1</span>, vector&lt;vector&lt;i64&gt;&gt;(k + <span class=\"number\">1</span>, <span class=\"built_in\">vector</span>&lt;i64&gt;(sz + <span class=\"number\">1</span>)));</span><br><span class=\"line\">    dp[<span class=\"number\">0</span>][<span class=\"number\">0</span>][<span class=\"number\">0</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++)              <span class=\"comment\">// å‰iä¸ªå­—ç¬¦</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt;= k; j++)         <span class=\"comment\">// å·²ç»åŒ¹é…äº†jä¸ª</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> l = <span class=\"number\">0</span>; l &lt; sz; l++)     <span class=\"comment\">// æ­£åœ¨åŒ¹é…ç¬¬lä¸ª</span></span><br><span class=\"line\">                <span class=\"keyword\">for</span> (<span class=\"type\">int</span> m = <span class=\"number\">0</span>; m &lt; <span class=\"number\">26</span>; m++) <span class=\"comment\">// æšä¸¾å­—ç¬¦</span></span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"type\">bool</span> flag = <span class=\"number\">0</span>;</span><br><span class=\"line\">                    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> pre = l; <span class=\"number\">1</span>; pre = nxt[pre - <span class=\"number\">1</span>])</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        <span class=\"keyword\">if</span> (s[pre] == <span class=\"string\">&#x27;a&#x27;</span> + m)</span><br><span class=\"line\">                        &#123;</span><br><span class=\"line\">                            <span class=\"keyword\">if</span> (pre == sz - <span class=\"number\">1</span>)</span><br><span class=\"line\">                            &#123;</span><br><span class=\"line\">                                <span class=\"keyword\">if</span> (j + <span class=\"number\">1</span> &lt;= k)</span><br><span class=\"line\">                                &#123;</span><br><span class=\"line\">                                    dp[i + <span class=\"number\">1</span>][j + <span class=\"number\">1</span>][<span class=\"number\">0</span>] += dp[i][j][l];</span><br><span class=\"line\">                                    dp[i + <span class=\"number\">1</span>][j + <span class=\"number\">1</span>][<span class=\"number\">0</span>] %= mod;</span><br><span class=\"line\">                                &#125;</span><br><span class=\"line\">                            &#125;</span><br><span class=\"line\">                            <span class=\"keyword\">else</span></span><br><span class=\"line\">                            &#123;</span><br><span class=\"line\">                                dp[i + <span class=\"number\">1</span>][j][pre + <span class=\"number\">1</span>] += dp[i][j][l];</span><br><span class=\"line\">                                dp[i + <span class=\"number\">1</span>][j][pre + <span class=\"number\">1</span>] %= mod;</span><br><span class=\"line\">                            &#125;</span><br><span class=\"line\">                            flag = <span class=\"number\">1</span>;</span><br><span class=\"line\">                            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                        <span class=\"keyword\">if</span> (!pre)</span><br><span class=\"line\">                            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (!flag)</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        dp[i + <span class=\"number\">1</span>][j][<span class=\"number\">0</span>] += dp[i][j][l];</span><br><span class=\"line\">                        dp[i + <span class=\"number\">1</span>][j][<span class=\"number\">0</span>] %= mod;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    i64 ans = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; sz; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        ans += dp[n][k][i];</span><br><span class=\"line\">        ans %= mod;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"3-å­—å…¸æ ‘Trie\">3. å­—å…¸æ ‘Trie</h3>\n<p>å†™æ³•è§æ•°æ®ç»“æ„éƒ¨åˆ†<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>01</mn></mrow><annotation encoding=\"application/x-tex\">01</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">01</span></span></span></span>Trie,æ²¡æœ‰æœ¬è´¨åŒºåˆ«ã€‚</p>\n<h3 id=\"4-Manacheré©¬æ‹‰è½¦ç®—æ³•\">4. Manacheré©¬æ‹‰è½¦ç®—æ³•</h3>\n<p>ä¸€ç§éå¸¸ä¼˜ç§€çš„ä»¥çº¿æ€§æ—¶é—´å¤æ‚åº¦æ±‚è§£å­—ç¬¦ä¸²ä¸­æœ€é•¿å›æ–‡å­ä¸²çš„ç®—æ³•ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">manacher</span><span class=\"params\">(string t)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    string s;</span><br><span class=\"line\">    <span class=\"type\">int</span> tot = <span class=\"number\">0</span>;</span><br><span class=\"line\">    s.<span class=\"built_in\">push_back</span>(<span class=\"string\">&#x27;$&#x27;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; t.<span class=\"built_in\">size</span>(); i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        s.<span class=\"built_in\">push_back</span>(<span class=\"string\">&#x27;#&#x27;</span>);</span><br><span class=\"line\">        s.<span class=\"built_in\">push_back</span>(t[i]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    s.<span class=\"built_in\">push_back</span>(<span class=\"string\">&#x27;#&#x27;</span>);</span><br><span class=\"line\">    <span class=\"type\">int</span> ans = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">d</span><span class=\"params\">(s.size() + <span class=\"number\">10</span>)</span></span>;</span><br><span class=\"line\">    d[<span class=\"number\">0</span>] = <span class=\"number\">1</span>; <span class=\"comment\">// d[i]ä»£è¡¨iä¸ºä¸­å¿ƒçš„æœ€å¤§åŠå¾„-1,ä¹Ÿè¡¨ç¤ºåŸå›æ–‡ä¸²é•¿åº¦</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>, l = <span class=\"number\">0</span>, r = <span class=\"number\">0</span>; i &lt; s.<span class=\"built_in\">size</span>(); ++i)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (i &lt;= r)</span><br><span class=\"line\">            d[i] = <span class=\"built_in\">min</span>(d[l + r - i], r - i + <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (s[i + d[i]] == s[i - d[i]])</span><br><span class=\"line\">            d[i]++;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (d[i] + i - <span class=\"number\">1</span> &gt; r)</span><br><span class=\"line\">            r = d[i] + i - <span class=\"number\">1</span>, l = i - d[i] + <span class=\"number\">1</span>;</span><br><span class=\"line\">        ans = <span class=\"built_in\">max</span>(ans, d[i]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ans - <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"5-ACè‡ªåŠ¨æœº\">5. ACè‡ªåŠ¨æœº</h3>\n<p>ä¸<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mi>M</mi><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">KMP</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">MP</span></span></span></span>äº’è¡¥ï¼Œæœ¬è´¨ä¾æ—§æ˜¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mi>M</mi><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">KMP</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">MP</span></span></span></span>ï¼Œå®ç°çš„æ˜¯å¤šæ¨¡å¼ä¸²<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub><mo>â†’</mo><msub><mi>T</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">T_1\\to T_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â†’</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>åŒ¹é…å”¯ä¸€ä¸»ä¸²<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span>â€‹.å¤æ‚åº¦<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>2</mn><mo>âˆ‘</mo><mi mathvariant=\"normal\">âˆ£</mi><msub><mi>T</mi><mi>i</mi></msub><mi mathvariant=\"normal\">âˆ£</mi><mo>+</mo><mi mathvariant=\"normal\">âˆ£</mi><mi>S</mi><mi mathvariant=\"normal\">âˆ£</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(2\\sum|T_i|+|S|)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ‘</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">âˆ£</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">âˆ£</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">âˆ£</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord\">âˆ£</span><span class=\"mclose\">)</span></span></span></span></p>\n<p>å­—å…¸æ ‘ä¸Šæ„å»º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mi>a</mi><mi>i</mi><mi>l</mi></mrow><annotation encoding=\"application/x-tex\">Fail</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\">ai</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span></span></span></span>æŒ‡é’ˆçš„æ€è·¯ä¸<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mi>x</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">nxt</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">t</span></span></span></span>æ•°ç»„æå…¶ç›¸ä¼¼ã€‚è€ƒè™‘æœ¬æ¨¡æ¿ä¸­å¦‚æœæœ‰<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo mathvariant=\"normal\">â‰ </mo><mi>s</mi><mo stretchy=\"false\">[</mo><mi>j</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">s[i]\\neq s[j]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\"><span class=\"mrel\"><span class=\"mord vbox\"><span class=\"thinbox\"><span class=\"rlap\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"inner\"><span class=\"mord\"><span class=\"mrel\">î€ </span></span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel\">=</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">]</span></span></span></span>ï¼Œåˆ™<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi><mo>=</mo><mi>n</mi><mi>x</mi><mi>t</mi><mo stretchy=\"false\">[</mo><mi>j</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">j=nxt[j-1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>å«ä¹‰ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>åŒ¹é…å¤±è´¥åæ‰€è·³è·ƒçš„ä½ç½®ã€‚<strong>ç¬¬<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>ä¸ªå¤±é…äº†ï¼Œè‚¯å®šè¦è·³è·ƒ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">i-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7429em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>çš„ä¸‹ä¸€ä¸ªé€‚é…ç‚¹ï¼Œä¹Ÿå°±æ˜¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mi>x</mi><mi>t</mi><mo stretchy=\"false\">[</mo><mi>j</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">nxt[j-1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span></strong></p>\n<p>è€ƒè™‘å­—å…¸æ ‘ä¸­ï¼Œå¦‚æœç»“ç‚¹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>å¤±é…ï¼Œæ„å‘³ç€ç»“ç‚¹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>çš„æ‰€æœ‰å„¿å­éƒ½ä¸é€‚é…ä¸‹ä¸€ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯ç»“ç‚¹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>çš„çˆ¶äº²æ˜¯é€‚é…ä¸Šä¸€ä¸ªå­—ç¬¦çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å»è·³è½¬ä¸‹ä¸€ä¸ªå¯¹åº”ä¸Šä¸€ä¸ªå­—ç¬¦çš„ç»“ç‚¹ï¼Œè¿™ä¸ªå°±æ˜¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>ç»“ç‚¹çˆ¶äº²æ‰€æŒ‡å‘çš„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mi>a</mi><mi>i</mi><mi>l</mi></mrow><annotation encoding=\"application/x-tex\">Fail</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\">ai</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span></span></span></span>â€‹ç»“ç‚¹ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">int</span> Fail = trie[u].fail;</span><br><span class=\"line\"><span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">26</span>; i++)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> v = trie[u].son[i];</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!v)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        trie[u].son[i] = trie[Fail].son[i];</span><br><span class=\"line\">        <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    trie[v].fail = trie[Fail].son[i];</span><br><span class=\"line\">    in[trie[v].fail]++;</span><br><span class=\"line\">    q.<span class=\"built_in\">push</span>(v);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ä¸‹é¢æ˜¯æ¨¡æ¿ï¼Œæ¯é‡æ–°ä¸€æ¬¡æ–°ä¸»ä¸²<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span>éƒ½è¦é‡æ–°è·³ä¸€é<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mi>a</mi><mi>i</mi><mi>l</mi></mrow><annotation encoding=\"application/x-tex\">Fail</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\">ai</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span></span></span></span>æŒ‡é’ˆã€‚</p>\n<p>ç‰ˆæœ¬1ï¼šï¼ˆåªæ±‚æœ‰å¤šå°‘ä¸ªæ–‡æœ¬ä¸²<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>äºä¸»ä¸²<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span>ä¸­å‡ºç°è¿‡ï¼‰</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// æ„å»ºå­—å…¸å›¾å®ç°è‡ªåŠ¨è·³è½¬ï¼Œæ„å»ºå¤±é…æŒ‡é’ˆå®ç°å¤šæ¨¡å¼åŒ¹é…ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">// æœ¬é¢˜ACè‡ªåŠ¨æœºè§£å†³æ±‚æœ‰å¤šå°‘ä¸ªä¸åŒçš„æ¨¡å¼ä¸²åœ¨æ–‡æœ¬ä¸²é‡Œå‡ºç°è¿‡ï¼Œä¸”ä¸¤ä¸ªæ¨¡å¼ä¸²ä¸åŒå½“ä¸”ä»…å½“ä»–ä»¬ç¼–å·ä¸åŒï¼›</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"type\">long</span> <span class=\"type\">long</span> ll;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">AC</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">const</span> <span class=\"type\">static</span> <span class=\"type\">int</span> N = <span class=\"number\">1</span> * <span class=\"number\">1e6</span> + <span class=\"number\">4</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> t[N][<span class=\"number\">30</span>], idx, q; <span class=\"comment\">// t[i][j]:è¡¨ç¤ºä¸€ä¸ªèŠ‚ç‚¹ï¼Œçˆ¶èŠ‚ç‚¹çš„ç¼–å·ä¸ºI,è‡ªå·±çš„å­—ç¬¦æ˜¯jï¼Œidxæ˜¯èŠ‚ç‚¹æ€»æ•°</span></span><br><span class=\"line\">    <span class=\"type\">int</span> cnt[N];           <span class=\"comment\">// è®°å½•ä»¥è¿™ä¸ªç‚¹ä¸ºç»“å°¾æœ‰å‡ ä¸ªå•è¯</span></span><br><span class=\"line\">    <span class=\"type\">int</span> fail[N];          <span class=\"comment\">// å¤±é…æŒ‡é’ˆï¼Œä»iè·³åˆ°jå°±è¯´æ˜ï¼Œword(j)æ˜¯içš„æœ€é•¿åç¼€ï¼ï¼</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">getnum</span><span class=\"params\">(<span class=\"type\">char</span> ch)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123; <span class=\"comment\">// å­—ç¬¦è½¬ä¸ºæ•°å­—</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (ch &gt;= <span class=\"string\">&#x27;a&#x27;</span> &amp;&amp; ch &lt;= <span class=\"string\">&#x27;z&#x27;</span>)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> ch - <span class=\"string\">&#x27;a&#x27;</span> + <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">insert</span><span class=\"params\">(string s)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;                              <span class=\"comment\">// æ’å…¥</span></span><br><span class=\"line\">        <span class=\"type\">int</span> p = <span class=\"number\">0</span>, len = s.<span class=\"built_in\">size</span>(); <span class=\"comment\">// ä»0èŠ‚ç‚¹å¼€å§‹</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; len; i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> c = <span class=\"built_in\">getnum</span>(s[i]);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!t[p][c])</span><br><span class=\"line\">                t[p][c] = ++idx; <span class=\"comment\">// åˆ›å»ºèŠ‚ç‚¹</span></span><br><span class=\"line\">            p = t[p][c];         <span class=\"comment\">// æŠŠçˆ¶èŠ‚ç‚¹æ›´æ”¹ä¸ºä¸Šä¸ªèŠ‚ç‚¹</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        cnt[p]++; <span class=\"comment\">// ä»¥è¯¥ç‚¹ä¸ºç»“å°¾çš„å•è¯æ•°é‡ï¼Œå› ä¸ºä¸ä¿è¯æ¨¡å¼ä¸²ä¸€è‡´</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">build</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        queue&lt;<span class=\"type\">int</span>&gt; q;</span><br><span class=\"line\">        <span class=\"built_in\">memset</span>(fail, <span class=\"number\">0</span>, <span class=\"built_in\">sizeof</span>(fail));</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= <span class=\"number\">26</span>; i++)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (t[<span class=\"number\">0</span>][i])</span><br><span class=\"line\">                q.<span class=\"built_in\">push</span>(t[<span class=\"number\">0</span>][i]);</span><br><span class=\"line\">        <span class=\"comment\">// æ ¹èŠ‚ç‚¹çš„é¦–å­—ç¬¦å…¥é˜Ÿ</span></span><br><span class=\"line\">        <span class=\"comment\">// ä¸ç›´æ¥å°†0å…¥é˜Ÿæ˜¯ä¸ºäº†é¿å…æŒ‡å‘è‡ªå·±</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (!q.<span class=\"built_in\">empty</span>())</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> k = q.<span class=\"built_in\">front</span>();</span><br><span class=\"line\">            q.<span class=\"built_in\">pop</span>(); <span class=\"comment\">// å½“å‰ç»“ç‚¹</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= <span class=\"number\">26</span>; i++)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (t[k][i])</span><br><span class=\"line\">                &#123;                                  <span class=\"comment\">// å¦‚æœå­èŠ‚ç‚¹å­˜åœ¨</span></span><br><span class=\"line\">                    fail[t[k][i]] = t[fail[k]][i]; <span class=\"comment\">// æ„å»ºå½“å‰çš„failæŒ‡é’ˆ</span></span><br><span class=\"line\">                    <span class=\"comment\">// åŸç†ï¼Œä¸Šä¸€å±‚çš„failå·²ç»æ±‚å‡ºï¼Œä¾‹å¦‚ä¸Šä¸€å±‚ä¸ºherï¼Œè‡ªå·±æ˜¯sï¼Œrçš„failæŒ‡å‘äº†erï¼Œè‹¥ræœ‰è¿™ä¸ªå­èŠ‚ç‚¹sï¼Œç”±äºeræ˜¯herçš„æœ€é•¿åç¼€ï¼Œé‚£ä¹ˆerså¿…ç„¶æ˜¯hersçš„æœ€é•¿åç¼€ã€‚</span></span><br><span class=\"line\">                    <span class=\"comment\">// å¦å¤–ç»“åˆelseçš„ä»£ç  ï¼ŒåŸæœ¬æŒ‰é“ç†å¦‚æœæ²¡æœ‰sè¿™ä¸ªèŠ‚ç‚¹åº”ä¸æ–­è·³failï¼Œä½†è¿™é‡Œä¸ºä»€ä¹ˆä¸ç”¨å‘¢ï¼Ÿå› ä¸ºå¦‚æœè·³å®Œfailçš„è¯èƒ½æ¢åˆ°ä¸€æ¡é“¾ï¼Œåˆ™elseçš„ä»£ç èƒ½å¤Ÿå¸®åŠ©ä¸€æ­¥è·³è¿‡å»æ‰€ä»¥å¯ä»¥ä¸€æ­¥ï¼Œå¦‚æœä¸èƒ½ï¼Œåˆ™èµ‹å€¼ä¸º0ï¼ŒåŒæ ·ä¹Ÿæ˜¯æ ¹èŠ‚ç‚¹ï¼Œå®Œç¾</span></span><br><span class=\"line\">                    q.<span class=\"built_in\">push</span>(t[k][i]); <span class=\"comment\">// å…¥é˜Ÿ</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">else</span></span><br><span class=\"line\">                    t[k][i] = t[fail[k]][i];</span><br><span class=\"line\">                <span class=\"comment\">// åŒ¹é…åˆ°ç©ºå­—ç¬¦ï¼Œåˆ™ç´¢å¼•åˆ°çˆ¶èŠ‚ç‚¹failæŒ‡é’ˆå¯¹åº”çš„å­—ç¬¦ï¼Œä»¥ä¾›åç»­æŒ‡é’ˆçš„æ„å»º</span></span><br><span class=\"line\">                <span class=\"comment\">// ç±»ä¼¼å¹¶å·®é›†çš„è·¯å¾„å‹ç¼©ï¼ŒæŠŠä¸å­˜åœ¨çš„tr[k][i]å…¨éƒ¨æŒ‡å‘tr[fail[k]][i]</span></span><br><span class=\"line\">                <span class=\"comment\">// è¿™å¥è¯åœ¨åé¢åŒ¹é…ä¸»ä¸²çš„æ—¶å€™ä¹Ÿèƒ½å¸®åŠ©è·³è½¬</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">queryy</span><span class=\"params\">(string S)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> len = S.<span class=\"built_in\">size</span>(), p = <span class=\"number\">0</span>, ans = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; len; i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            p = t[p][<span class=\"built_in\">getnum</span>(S[i])];</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = p; j &amp;&amp; ~cnt[j]; j = fail[j])</span><br><span class=\"line\">                ans += cnt[j], cnt[j] = <span class=\"number\">-1</span>; <span class=\"comment\">// ç­”æ¡ˆåŠ ä¸Šç»“å°¾ï¼Œcnt[j]=-1å°±æ˜¯ä»¥ååˆ«åœ¨ç»Ÿè®¡è¿™é‡Œç›¸å…³çš„äº†ï¼Œé˜²æ­¢é‡å¤</span></span><br><span class=\"line\">            <span class=\"comment\">// è¿™ä¸ªç‚¹å¼€å§‹è·³failæ•°ç»„ï¼Œæ±‚å¾—ä¸ä¹‹ç›¸å…³çš„åç¼€çš„å•è¯æœ‰æ²¡æœ‰</span></span><br><span class=\"line\">            <span class=\"comment\">// åˆ†æj&amp;&amp;~cnt[j]:åªæœ‰=-1æ—¶å–åæ‰æ˜¯0ï¼Œæ‰€ä»¥ç»“æŸæ¡ä»¶ä¸ºè·³åˆ°æ ¹èŠ‚ç‚¹ï¼ˆj=0ï¼‰æˆ–è€…åˆ°è¾¾äº†æ±‚è¿‡çš„ç‚¹</span></span><br><span class=\"line\">            <span class=\"comment\">// å› ä¸ºæœ¬é¢˜è¦æ±‚æœ‰å¤šå°‘ä¸ªæ¨¡å¼ä¸²å‡ºç°è¿‡ï¼Œæ‰€ä»¥ä¸èƒ½é‡å¤è´¡çŒ®</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">AC ac;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    string s;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cin &gt;&gt; s;</span><br><span class=\"line\">        ac.<span class=\"built_in\">insert</span>(s);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ac.<span class=\"built_in\">build</span>();</span><br><span class=\"line\">    cin &gt;&gt; s;</span><br><span class=\"line\">    cout &lt;&lt; ac.<span class=\"built_in\">queryy</span>(s) &lt;&lt; endl;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<p>ç‰ˆæœ¬2ï¼šè¿”å›æ¯ä¸€ä¸ª<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">T_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>â€‹çš„å‡ºç°æ¬¡æ•°</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">AC</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">const</span> <span class=\"type\">static</span> <span class=\"type\">int</span> maxn = <span class=\"number\">2e5</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> n, cnt = <span class=\"number\">1</span>, vis[maxn], ans, in[maxn &lt;&lt; <span class=\"number\">5</span>], Map[maxn];</span><br><span class=\"line\">    <span class=\"keyword\">struct</span> <span class=\"title class_\">Trie</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> son[<span class=\"number\">26</span>], fail, flag, ans;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">clear</span><span class=\"params\">()</span> </span>&#123; <span class=\"built_in\">memset</span>(son, <span class=\"number\">0</span>, <span class=\"built_in\">sizeof</span>(son)), fail = flag = ans = <span class=\"number\">0</span>; &#125;</span><br><span class=\"line\">    &#125; trie[maxn &lt;&lt; <span class=\"number\">5</span>];</span><br><span class=\"line\">    queue&lt;<span class=\"type\">int</span>&gt; q;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">init</span><span class=\"params\">(<span class=\"type\">int</span> _n)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt;= cnt; i++)</span><br><span class=\"line\">            trie[i].<span class=\"built_in\">clear</span>();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">            vis[i] = <span class=\"number\">0</span>;</span><br><span class=\"line\">        cnt = <span class=\"number\">1</span>;</span><br><span class=\"line\">        n = _n;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">insert</span><span class=\"params\">(string t, <span class=\"type\">int</span> num)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> u = <span class=\"number\">1</span>, len = t.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; len; i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> v = t[i] - <span class=\"string\">&#x27;a&#x27;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!trie[u].son[v])</span><br><span class=\"line\">                trie[u].son[v] = ++cnt;</span><br><span class=\"line\">            u = trie[u].son[v];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!trie[u].flag)</span><br><span class=\"line\">            trie[u].flag = num;</span><br><span class=\"line\">        Map[num] = trie[u].flag;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">getFail</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">26</span>; i++)</span><br><span class=\"line\">            trie[<span class=\"number\">0</span>].son[i] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        q.<span class=\"built_in\">push</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (!q.<span class=\"built_in\">empty</span>())</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> u = q.<span class=\"built_in\">front</span>();</span><br><span class=\"line\">            q.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">            <span class=\"type\">int</span> Fail = trie[u].fail;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">26</span>; i++)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"type\">int</span> v = trie[u].son[i];</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (!v)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    trie[u].son[i] = trie[Fail].son[i];</span><br><span class=\"line\">                    <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                trie[v].fail = trie[Fail].son[i];</span><br><span class=\"line\">                in[trie[v].fail]++;</span><br><span class=\"line\">                q.<span class=\"built_in\">push</span>(v);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">topu</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= cnt; i++)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (in[i] == <span class=\"number\">0</span>)</span><br><span class=\"line\">                q.<span class=\"built_in\">push</span>(i);</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (!q.<span class=\"built_in\">empty</span>())</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> u = q.<span class=\"built_in\">front</span>();</span><br><span class=\"line\">            q.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">            vis[trie[u].flag] = trie[u].ans;</span><br><span class=\"line\">            <span class=\"type\">int</span> v = trie[u].fail;</span><br><span class=\"line\">            in[v]--;</span><br><span class=\"line\">            trie[v].ans += trie[u].ans;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (in[v] == <span class=\"number\">0</span>)</span><br><span class=\"line\">                q.<span class=\"built_in\">push</span>(v);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">query</span><span class=\"params\">(string s)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> u = <span class=\"number\">1</span>, len = s.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; len; i++)</span><br><span class=\"line\">            u = trie[u].son[s[i] - <span class=\"string\">&#x27;a&#x27;</span>], trie[u].ans++;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">querys</span><span class=\"params\">(string s)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        vector&lt;<span class=\"type\">int</span>&gt; res;</span><br><span class=\"line\">        <span class=\"built_in\">query</span>(s);</span><br><span class=\"line\">        <span class=\"built_in\">topu</span>();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">            res.<span class=\"built_in\">push_back</span>(vis[Map[i]]);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">AC ac;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    ac.<span class=\"built_in\">init</span>(n);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        string t;</span><br><span class=\"line\">        cin &gt;&gt; t;</span><br><span class=\"line\">        ac.<span class=\"built_in\">insert</span>(t, i);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ac.<span class=\"built_in\">getFail</span>();</span><br><span class=\"line\">    string s;</span><br><span class=\"line\">    cin &gt;&gt; s;</span><br><span class=\"line\">    <span class=\"keyword\">auto</span> res = ac.<span class=\"built_in\">querys</span>(s);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> i : res)</span><br><span class=\"line\">        cout &lt;&lt; i &lt;&lt; endl;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"6-åç¼€æ•°ç»„SA\">6. åç¼€æ•°ç»„SA</h3>\n<p><em><strong>Warning: æ­¤å¤„SAæ•°ç»„çš„å­—ç¬¦ä¸²ä¸‹æ ‡å®šä¹‰æ˜¯ä»1å¼€å§‹çš„ï¼</strong></em></p>\n<p>åç¼€æ•°ç»„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mi>a</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">sa[i]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">a</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span></span></span></span>è¡¨ç¤ºçš„æ˜¯å­—å…¸åºæ’åç¬¬<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>å°çš„åç¼€æ˜¯åŸæ¥å­—ç¬¦ä¸²ä¸­å“ªä¸€ä¸ªåç¼€ã€‚</p>\n<p>æ’åæ•°ç»„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mi>k</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">rk[i]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span></span></span></span>è¡¨ç¤ºåŸæ¥å­—ç¬¦ä¸²çš„åç¼€ä¸­ç¬¬<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>ä¸ªåç¼€æ˜¯å¤šå°‘å­—å…¸åºã€‚</p>\n<p>ç¬¬<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>ä¸ªåç¼€çš„å®šä¹‰ï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo>â‹¯</mo><mi>n</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">s[i\\cdots n]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">â‹¯</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">]</span></span></span></span></p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(nlogn)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>æ±‚æ³•ï¼š</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">SufArray</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">const</span> <span class=\"type\">static</span> <span class=\"type\">int</span> maxn = <span class=\"number\">1e6</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\">    <span class=\"comment\">// rk[i] i çš„æ’å  sa[i] ç¬¬iå</span></span><br><span class=\"line\">    <span class=\"comment\">// å­—ç¬¦ä¸²çš„åºå·  +k å°±æ˜¯å¾€åèµ°kä¸ª</span></span><br><span class=\"line\">    <span class=\"type\">int</span> rk[maxn + <span class=\"number\">10</span>], sa[maxn + <span class=\"number\">10</span>], n, lstrk[maxn + <span class=\"number\">10</span>], lstsa[maxn], w,</span><br><span class=\"line\">        m = <span class=\"number\">127</span>, cnt[maxn], h[maxn], f[maxn][<span class=\"number\">20</span>];</span><br><span class=\"line\">    string s;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> siz n * sizeof(int)</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">init</span><span class=\"params\">(string _s)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        s = _s;</span><br><span class=\"line\">        m = <span class=\"number\">127</span>;</span><br><span class=\"line\">        n = s.<span class=\"built_in\">length</span>();</span><br><span class=\"line\">        <span class=\"built_in\">memset</span>(cnt, <span class=\"number\">0</span>, <span class=\"keyword\">sizeof</span> cnt);</span><br><span class=\"line\">        <span class=\"built_in\">memset</span>(sa, <span class=\"number\">0</span>, <span class=\"keyword\">sizeof</span> sa);</span><br><span class=\"line\">        <span class=\"built_in\">memset</span>(rk, <span class=\"number\">0</span>, <span class=\"keyword\">sizeof</span> rk);</span><br><span class=\"line\">        <span class=\"built_in\">memset</span>(h, <span class=\"number\">0</span>, <span class=\"keyword\">sizeof</span> h);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; ++i)</span><br><span class=\"line\">            ++cnt[rk[i] = s[i - <span class=\"number\">1</span>]];</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= m; ++i)</span><br><span class=\"line\">            cnt[i] += cnt[i - <span class=\"number\">1</span>];</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = n; i &gt;= <span class=\"number\">1</span>; --i)</span><br><span class=\"line\">            sa[cnt[rk[i]]--] = i;</span><br><span class=\"line\">        <span class=\"built_in\">memcpy</span>(lstrk + <span class=\"number\">1</span>, rk + <span class=\"number\">1</span>, siz);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> p = <span class=\"number\">0</span>, i = <span class=\"number\">1</span>; i &lt;= n; ++i)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (lstrk[sa[i]] == lstrk[sa[i - <span class=\"number\">1</span>]])</span><br><span class=\"line\">                rk[sa[i]] = p;</span><br><span class=\"line\">            <span class=\"keyword\">else</span></span><br><span class=\"line\">                rk[sa[i]] = ++p;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (w = <span class=\"number\">1</span>; w &lt; n; w &lt;&lt;= <span class=\"number\">1</span>, m = n)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> p = <span class=\"number\">0</span>, i = n; i &gt;= n - w + <span class=\"number\">1</span>; --i)</span><br><span class=\"line\">                lstsa[++p] = i;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> p = w, i = <span class=\"number\">1</span>; i &lt;= n; ++i)</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (sa[i] &gt; w)</span><br><span class=\"line\">                    lstsa[++p] = sa[i] - w;</span><br><span class=\"line\">            <span class=\"built_in\">memset</span>(cnt, <span class=\"number\">0</span>, <span class=\"keyword\">sizeof</span> cnt);</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; ++i)</span><br><span class=\"line\">                ++cnt[rk[lstsa[i]]];</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= m; ++i)</span><br><span class=\"line\">                cnt[i] += cnt[i - <span class=\"number\">1</span>];</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = n; i &gt;= <span class=\"number\">1</span>; --i)</span><br><span class=\"line\">                sa[cnt[rk[lstsa[i]]]--] = lstsa[i];</span><br><span class=\"line\">            <span class=\"built_in\">memcpy</span>(lstrk + <span class=\"number\">1</span>, rk + <span class=\"number\">1</span>, siz);</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> p = <span class=\"number\">0</span>, i = <span class=\"number\">1</span>; i &lt;= n; ++i)</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (lstrk[sa[i]] == lstrk[sa[i - <span class=\"number\">1</span>]] &amp;&amp; lstrk[sa[i] + w] == lstrk[sa[i - <span class=\"number\">1</span>] + w])</span><br><span class=\"line\">                    rk[sa[i]] = p;</span><br><span class=\"line\">                <span class=\"keyword\">else</span></span><br><span class=\"line\">                    rk[sa[i]] = ++p;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>, k = <span class=\"number\">0</span>; i &lt;= n; ++i)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (rk[i] == <span class=\"number\">0</span>)</span><br><span class=\"line\">                <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (k)</span><br><span class=\"line\">                --k;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (s[i + k - <span class=\"number\">1</span>] == s[sa[rk[i] - <span class=\"number\">1</span>] + k - <span class=\"number\">1</span>])</span><br><span class=\"line\">                ++k;</span><br><span class=\"line\">            h[rk[i]] = k;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"built_in\">memset</span>(f, <span class=\"number\">0x3f</span>, <span class=\"keyword\">sizeof</span> f);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; ++i)</span><br><span class=\"line\">            f[i][<span class=\"number\">0</span>] = h[i];</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">1</span>; (<span class=\"number\">1</span> &lt;&lt; j) &lt;= n; ++j)</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n - (<span class=\"number\">1</span> &lt;&lt; j) + <span class=\"number\">1</span>; ++i)</span><br><span class=\"line\">                f[i][j] = <span class=\"built_in\">min</span>(f[i][j - <span class=\"number\">1</span>], f[i + (<span class=\"number\">1</span> &lt;&lt; (j - <span class=\"number\">1</span>))][j - <span class=\"number\">1</span>]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">lcp</span><span class=\"params\">(<span class=\"type\">int</span> x, <span class=\"type\">int</span> y)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123; <span class=\"comment\">// åç¼€xå’Œåç¼€yçš„æœ€é•¿å…¬å…±å‰ç¼€</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (x == y)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> n - y + <span class=\"number\">1</span>;</span><br><span class=\"line\">        x = rk[x], y = rk[y];</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (x &gt;= y)</span><br><span class=\"line\">            <span class=\"built_in\">swap</span>(x, y);</span><br><span class=\"line\">        <span class=\"type\">int</span> k = <span class=\"built_in\">log2</span>(y - (x + <span class=\"number\">1</span>) + <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">min</span>(f[x + <span class=\"number\">1</span>][k], f[y - (<span class=\"number\">1</span> &lt;&lt; k) + <span class=\"number\">1</span>][k]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; SA;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">solve</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    string s;</span><br><span class=\"line\">    cin &gt;&gt; s;</span><br><span class=\"line\">    SA.<span class=\"built_in\">init</span>(s);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= SA.n; i++)</span><br><span class=\"line\">        cout &lt;&lt; SA.sa[i] &lt;&lt; <span class=\"string\">&#x27; &#x27;</span>;</span><br><span class=\"line\">    cout &lt;&lt; endl;</span><br><span class=\"line\">    <span class=\"comment\">// for (int i = 1; i &lt;= SA.n; i++)</span></span><br><span class=\"line\">    <span class=\"comment\">//     cout &lt;&lt; SA.h[i] &lt;&lt; &#x27; &#x27;;</span></span><br><span class=\"line\">    <span class=\"comment\">// cout &lt;&lt; endl;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"7-SAæ•°ç»„-çº¿æ€§SA-IS\">7. SAæ•°ç»„(çº¿æ€§SA-IS)</h3>\n<p><strong>Warningï¼šæ­¤å¤„SAæ•°ç»„ä»¥åŠheightæ•°ç»„æ˜¯ä»0å¼€å§‹çš„</strong></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">SA</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n;</span><br><span class=\"line\">    vector&lt;<span class=\"type\">int</span>&gt; sa, rk;</span><br><span class=\"line\">    vector&lt;i64&gt; h;</span><br><span class=\"line\">    <span class=\"built_in\">SA</span>(string s)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        n = s.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">        s.<span class=\"built_in\">push_back</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">        sa.<span class=\"built_in\">resize</span>(n);</span><br><span class=\"line\">        h.<span class=\"built_in\">resize</span>(n - <span class=\"number\">1</span>);</span><br><span class=\"line\">        rk.<span class=\"built_in\">resize</span>(n);</span><br><span class=\"line\">        <span class=\"built_in\">iota</span>(sa.<span class=\"built_in\">begin</span>(), sa.<span class=\"built_in\">end</span>(), <span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"built_in\">sort</span>(sa.<span class=\"built_in\">begin</span>(), sa.<span class=\"built_in\">end</span>(), [&amp;](<span class=\"type\">int</span> a, <span class=\"type\">int</span> b)</span><br><span class=\"line\">             &#123; <span class=\"keyword\">return</span> s[a] &lt; s[b]; &#125;);</span><br><span class=\"line\">        rk[sa[<span class=\"number\">0</span>]] = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt; n; ++i)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            rk[sa[i]] = rk[sa[i - <span class=\"number\">1</span>]] + (s[sa[i]] != s[sa[i - <span class=\"number\">1</span>]]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">int</span> k = <span class=\"number\">1</span>;</span><br><span class=\"line\">        vector&lt;<span class=\"type\">int</span>&gt; tmp, <span class=\"built_in\">cnt</span>(n);</span><br><span class=\"line\">        tmp.<span class=\"built_in\">reserve</span>(n);</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (rk[sa[n - <span class=\"number\">1</span>]] &lt; n - <span class=\"number\">1</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            tmp.<span class=\"built_in\">clear</span>();</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; k; ++i)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                tmp.<span class=\"built_in\">push_back</span>(n - k + i);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> i : sa)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (i &gt;= k)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    tmp.<span class=\"built_in\">push_back</span>(i - k);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"built_in\">fill</span>(cnt.<span class=\"built_in\">begin</span>(), cnt.<span class=\"built_in\">end</span>(), <span class=\"number\">0</span>);</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; ++i)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                ++cnt[rk[i]];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt; n; ++i)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                cnt[i] += cnt[i - <span class=\"number\">1</span>];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = n - <span class=\"number\">1</span>; i &gt;= <span class=\"number\">0</span>; --i)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                sa[--cnt[rk[tmp[i]]]] = tmp[i];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"built_in\">swap</span>(rk, tmp);</span><br><span class=\"line\">            rk[sa[<span class=\"number\">0</span>]] = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt; n; ++i)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                rk[sa[i]] = rk[sa[i - <span class=\"number\">1</span>]] + (tmp[sa[i - <span class=\"number\">1</span>]] &lt; tmp[sa[i]] || sa[i - <span class=\"number\">1</span>] + k == n || tmp[sa[i - <span class=\"number\">1</span>] + k] &lt; tmp[sa[i] + k]);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            k *= <span class=\"number\">2</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>, j = <span class=\"number\">0</span>; i &lt; n; ++i)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (rk[i] == <span class=\"number\">0</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                j = <span class=\"number\">0</span>;</span><br><span class=\"line\">                <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (j -= j &gt; <span class=\"number\">0</span>; i + j &lt; n &amp;&amp; sa[rk[i] - <span class=\"number\">1</span>] + j &lt; n &amp;&amp; s[i + j] == s[sa[rk[i] - <span class=\"number\">1</span>] + j];)</span><br><span class=\"line\">                ++j;</span><br><span class=\"line\">            h[rk[i] - <span class=\"number\">1</span>] = j;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">solve</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    string s;</span><br><span class=\"line\">    cin &gt;&gt; s;</span><br><span class=\"line\">    <span class=\"function\">SA <span class=\"title\">sa</span><span class=\"params\">(s)</span></span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; s.<span class=\"built_in\">size</span>(); i++)</span><br><span class=\"line\">        cout &lt;&lt; sa.sa[i] + <span class=\"number\">1</span> &lt;&lt; <span class=\"string\">&quot; &quot;</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"8-åç¼€è‡ªåŠ¨æœºSAM\">8. åç¼€è‡ªåŠ¨æœºSAM</h3>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mi>A</mi><mi>M</mi></mrow><annotation encoding=\"application/x-tex\">SAM</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span>è‡ªåŠ¨æœºæ˜¯ä¸€ç§å‹ç¼©å­ä¸²ä¿¡æ¯çš„è‡ªåŠ¨æœºï¼Œå¯ä»¥åœ¨çº¿æ€§æ—¶é—´å†…è§£å†³ä»¥ä¸‹é—®é¢˜ï¼š</p>\n<ul>\n<li>åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æœç´¢ä¸€ä¸ªå­—ç¬¦ä¸²çš„æ‰€æœ‰å‡ºç°ä½ç½®ã€‚</li>\n<li>è®¡ç®—ç»™å®šçš„å­—ç¬¦ä¸²ä¸­æœ‰å¤šå°‘ä¸ªä¸åŒçš„å­ä¸²ã€‚</li>\n</ul>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">struct</span> <span class=\"title class_\">SAM</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//rootæ˜¯1</span></span><br><span class=\"line\">    <span class=\"type\">int</span> size, last, len[N &lt;&lt; <span class=\"number\">1</span>], fa[N &lt;&lt; <span class=\"number\">1</span>], tr[N &lt;&lt; <span class=\"number\">1</span>][<span class=\"number\">31</span>];</span><br><span class=\"line\">    <span class=\"type\">int</span> nxt[N &lt;&lt; <span class=\"number\">1</span>], head[N &lt;&lt; <span class=\"number\">1</span>], to[N &lt;&lt; <span class=\"number\">1</span>], ecnt = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> cnt[N &lt;&lt; <span class=\"number\">1</span>], first_pos[N &lt;&lt; <span class=\"number\">1</span>], is_clone[N &lt;&lt; <span class=\"number\">1</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> sfor(x, i) for(int i = 0; i &lt;= 30; ++i) <span class=\"keyword\">if</span>(tr[x][i])</span></span><br><span class=\"line\">    <span class=\"built_in\">SAM</span>() &#123;</span><br><span class=\"line\">        size = last = ecnt = <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">extend</span><span class=\"params\">(<span class=\"type\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> cur = ++ size,u;</span><br><span class=\"line\">        cnt[cur] = <span class=\"number\">1</span>, first_pos[cur] = len[cur] = len[last] + <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(u = last; u &amp;&amp; !tr[u][x]; u = fa[u]) tr[u][x] = cur;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!u) fa[cur] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> v = tr[u][x];</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(len[v] == len[u] + <span class=\"number\">1</span>) fa[cur] = v;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"type\">int</span> clone = ++ size;</span><br><span class=\"line\">                len[clone] = len[u] + <span class=\"number\">1</span>, fa[clone] = fa[v], first_pos[clone] = first_pos[v], is_clone[clone] = <span class=\"number\">1</span>;</span><br><span class=\"line\">                <span class=\"built_in\">memcpy</span>(tr[clone], tr[v], <span class=\"built_in\">sizeof</span>(tr[v]));<span class=\"comment\">//æ—¶é—´å¤æ‚åº¦åœ¨è¿™ä¸ªåœ°æ–¹</span></span><br><span class=\"line\">                <span class=\"keyword\">for</span>(; u &amp;&amp; tr[u][x] == v; u = fa[u]) tr[u][x] = clone;</span><br><span class=\"line\">                fa[cur] = fa[v] = clone;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> last = cur;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//cntæ•°ç»„è¡¨ç¤ºendposçš„å¤§å°ï¼Œé»˜è®¤æ˜¯çœŸå®å¤§å°</span></span><br><span class=\"line\">    <span class=\"comment\">//dæ•°ç»„è¡¨ç¤ºä¸‹é¢å¯ä»¥èµ°å¤šå°‘è·¯å¾„ï¼Œé»˜è®¤å’Œendposé›†åˆå¤§å°æœ‰å…³</span></span><br><span class=\"line\">    <span class=\"comment\">//æ¯ä¸ªç»“ç‚¹çš„endposé›†åˆèµ·å§‹å°±æ˜¯ç»ˆç‚¹ç»“ç‚¹çš„endposçš„é›†åˆ</span></span><br><span class=\"line\"><span class=\"comment\">//=========================================å»ºæ ‘=========================================</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"type\">int</span> x, <span class=\"type\">int</span> y)</span> </span>&#123;</span><br><span class=\"line\">        nxt[++ecnt] = head[x], to[ecnt] = y, head[x] = ecnt;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">build_tree</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i = <span class=\"number\">2</span>; i &lt;= size; ++i) <span class=\"built_in\">add</span>(fa[i], i);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//===========================================æ±‚occ=========================================</span></span><br><span class=\"line\">    <span class=\"type\">int</span> pos[N &lt;&lt; <span class=\"number\">1</span>], f[N &lt;&lt; <span class=\"number\">1</span>][<span class=\"number\">20</span>];<span class=\"comment\">//posä»£è¡¨s[1...r]å¯¹åº”çš„ç»“ç‚¹</span></span><br><span class=\"line\">    <span class=\"comment\">//è°ƒç”¨çš„æ—¶å€™pos[r] = extend(s[r] - &#x27;a&#x27; + 1);</span></span><br><span class=\"line\">    <span class=\"comment\">//è°ƒç”¨æ—¶å…ˆå»ºæ ‘ å¹¶æ±‚å¾—cnt</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">get_f</span><span class=\"params\">(<span class=\"type\">int</span> x = <span class=\"number\">1</span>)</span></span>&#123;<span class=\"comment\">//éå†åç¼€é“¾æ¥æ ‘</span></span><br><span class=\"line\">        f[x][<span class=\"number\">0</span>] = fa[x];</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= <span class=\"number\">19</span>; ++i) f[x][i] = f[f[x][i - <span class=\"number\">1</span>]][i - <span class=\"number\">1</span>];</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i = head[x]; i; i = nxt[i]) <span class=\"keyword\">if</span>(fa[x] != to[i]) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">get_f</span>(to[i]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">node</span><span class=\"params\">(<span class=\"type\">int</span> l, <span class=\"type\">int</span> r)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> now = pos[r];</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i = <span class=\"number\">19</span>; i &gt;= <span class=\"number\">0</span>; --i) <span class=\"keyword\">if</span>(len[f[now][i]] &gt;= r-l<span class=\"number\">+1</span>) now = f[now][i];</span><br><span class=\"line\">        <span class=\"keyword\">return</span> now;<span class=\"comment\">//æ‰¾åˆ°l...ræ‰€åœ¨çš„ç»“ç‚¹</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">occ</span><span class=\"params\">(<span class=\"type\">int</span> l, <span class=\"type\">int</span> r)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> cnt[<span class=\"built_in\">node</span>(l, r)];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"><span class=\"comment\">//==========================================æ±‚ç»“ç‚¹çš„cnt=======================================</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">Get_cnt</span><span class=\"params\">(<span class=\"type\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i = head[x]; i; i = nxt[i]) <span class=\"built_in\">Get_cnt</span>(to[i]), cnt[x] += cnt[to[i]];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//è°ƒç”¨æ—¶å…ˆå»ºæ ‘</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">get_cnt</span><span class=\"params\">(<span class=\"type\">int</span> type = <span class=\"number\">1</span>)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(type == <span class=\"number\">0</span>) <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= size; ++i) cnt[i] = <span class=\"number\">1</span>;    <span class=\"comment\">//ä¸åŒä½ç½®çš„å­ä¸²ç®—ä½œä¸€ä¸ª å¼ºåˆ¶æ¯ä¸ªå­ä¸²åªå‡ºç°ä¸€æ¬¡</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"built_in\">Get_cnt</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">endpos</span><span class=\"params\">(<span class=\"type\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">        queue&lt;<span class=\"type\">int</span>&gt; q;</span><br><span class=\"line\">        vector&lt;<span class=\"type\">int</span>&gt; ep;</span><br><span class=\"line\">        q.<span class=\"built_in\">push</span>(x);</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(!q.<span class=\"built_in\">empty</span>()) &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> now = q.<span class=\"built_in\">front</span>();</span><br><span class=\"line\">            q.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(!is_clone[now])  <span class=\"comment\">//æ˜¯ç»ˆç‚¹ç»“ç‚¹</span></span><br><span class=\"line\">                ep.<span class=\"built_in\">push_back</span>(first_pos[now]);</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i = head[now]; i; i = nxt[i])</span><br><span class=\"line\">                q.<span class=\"built_in\">push</span>(to[i]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ep;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//éå†åç¼€æ ‘ï¼šç”¨å›¾é‚£ä¸€å¥— ä»1å¼€å§‹ //éå†åç¼€è‡ªåŠ¨æœºï¼šä»1å¼€å§‹ç”¨trè½¬ç§»</span></span><br><span class=\"line\">    ll d[N], ans[N];<span class=\"comment\">//dè®°å½•äº†ä»xå¼€å§‹å¾€ä¸‹æœ‰å‡ æ¡è·¯å¾„ ansè®°å½•äº†ä»xå¼€å§‹ï¼Œå¾€ä¸‹æ‰€æœ‰è·¯å¾„ä¸Šä¸åŒå­ä¸²çš„æ€»é•¿åº¦ã€‚</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">get_d</span><span class=\"params\">(<span class=\"type\">int</span> x = <span class=\"number\">1</span>)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(d[x]) <span class=\"keyword\">return</span> ;</span><br><span class=\"line\">        d[x] = cnt[x];</span><br><span class=\"line\">        <span class=\"built_in\">sfor</span>(x, i) <span class=\"built_in\">get_d</span>(tr[x][i]), d[x] += d[tr[x][i]];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">debug</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;--------Debug_SAM--------&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= size; ++i)</span><br><span class=\"line\">            cout &lt;&lt; <span class=\"string\">&quot;i = &quot;</span> &lt;&lt; i &lt;&lt; <span class=\"string\">&quot;, endpos_size = &quot;</span> &lt;&lt; cnt[i] &lt;&lt; <span class=\"string\">&quot;, fa = &quot;</span> &lt;&lt; fa[i] &lt;&lt; <span class=\"string\">&quot;, len = &quot;</span> &lt;&lt; len[i] &lt;&lt; <span class=\"string\">&quot;, d = &quot;</span> &lt;&lt; d[i] &lt;&lt; endl;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= size; ++i) &#123;</span><br><span class=\"line\">            cout &lt;&lt; <span class=\"string\">&quot;i = &quot;</span> &lt;&lt; i &lt;&lt; <span class=\"string\">&quot; can trans to &quot;</span> &lt;&lt; endl;</span><br><span class=\"line\">            <span class=\"built_in\">sfor</span>(i, j)  cout &lt;&lt; tr[i][j] &lt;&lt; <span class=\"string\">&quot; by &quot;</span> &lt;&lt; <span class=\"built_in\">char</span>(j + <span class=\"string\">&#x27;a&#x27;</span> - <span class=\"number\">1</span>) &lt;&lt; endl;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;--------End_Debug--------&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; sam;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h1>Part 6. åŠ¨æ€è§„åˆ’</h1>\n<h2 id=\"1-sosdpï¼ˆé«˜ç»´å‰ç¼€å’Œdp\">1. sosdpï¼ˆé«˜ç»´å‰ç¼€å’Œdp)</h2>\n<p>å¯¹äºæ‰€æœ‰çš„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>,<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mo>â‰¤</mo><mi>i</mi><mo>â‰¤</mo><msup><mn>2</mn><mi>n</mi></msup><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">0â‰¤iâ‰¤2^nâˆ’1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7955em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7477em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>,æ±‚è§£<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mo>âˆ‘</mo><mrow><mi>j</mi><mo>âŠ‚</mo><mi>i</mi></mrow></msub><msub><mi>a</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">âˆ‘_{jâŠ‚i}a_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1858em;vertical-align:-0.4358em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ‘</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">âŠ‚</span><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>ã€‚</p>\n<p>ä»¥<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><msup><mn>2</mn><mi>n</mi></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n2^n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>çš„å¤æ‚åº¦ç®¡ç†å­é›†å‰ç¼€å’Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">dp</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">p</span></span></span></span>â€‹ã€‚</p>\n<p>å­é›†ï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>å¯¹åº”æ˜¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>çš„ä½ç½®ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>å¿…é¡»å¯¹åº”ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span>(<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt; n; j++) </span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">1</span> &lt;&lt; n; i++)</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(i &gt;&gt; j &amp; <span class=\"number\">1</span>) f[i] += f[i ^ (<span class=\"number\">1</span> &lt;&lt; j)];</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>è¶…é›†ï¼š<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>å¯¹åº”æ˜¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>çš„ä½ç½®ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>å¿…é¡»å¯¹åº”<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span>(<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt; n; j++) </span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">1</span> &lt;&lt; n; i++)</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!(i &gt;&gt; j &amp; <span class=\"number\">1</span>)) f[i] += f[i ^ (<span class=\"number\">1</span> &lt;&lt; j)];</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>ç¤ºä¾‹1ï¼šï¼ˆ2024æ¹–å—çœèµ›ï¼‰</p>\n<p>ç»™å‡ºä¸€ä¸ªé•¿åº¦ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>çš„æ­£æ•´æ•°ä¸² ã€‚ç°åœ¨å¯ä»¥æŠŠä¸¤ä¸ªæ²¡æœ‰é‡å çš„è¿ç»­å­ä¸²å‰åæ‹¼æ¥èµ·æ¥ï¼Œä½†æ˜¯è¦æ±‚æ‹¼æ¥ä¹‹åçš„æ•°ä¸²ä¸­æ¯ä¸ªæ­£æ•´æ•°ä¸èƒ½å‡ºç°è¶…è¿‡<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>æ¬¡ã€‚è¯·é—®èƒ½æ‹¼æ¥å‡ºæ¥çš„ç¬¦åˆè¦æ±‚çš„æ•°å­—ä¸²çš„æœ€å¤§é•¿åº¦æ˜¯å¤šå°‘ã€‚ä¿è¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>â‰¤</mo><mn>18</mn></mrow><annotation encoding=\"application/x-tex\">a_i\\le18</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.786em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">â‰¤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">18</span></span></span></span>.</p>\n<p>æ•°æ®èŒƒå›´ä¸€çœ¼çŠ¶å‹<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">dp</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">p</span></span></span></span>ï¼Œè€ƒè™‘ç»´æŠ¤å‡ºç°ä¸è¶…è¿‡ä¸€æ¬¡ã€‚æ˜¾ç„¶ä¸¤ä¸ªä¸²çš„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mi>a</mi><mi>s</mi><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">mask</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">ma</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>ä½çš„äº¤é›†ä¸º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>ï¼Œè€ƒè™‘ä¸²<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>çš„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mi>a</mi><mi>s</mi><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">mask</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">ma</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>ä½<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span>ï¼Œåˆ™æ˜¾ç„¶ä¸²<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span>çš„<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mi>a</mi><mi>s</mi><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">mask</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">ma</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>å¿…å®šæœ‰<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mi>a</mi><mi>s</mi><msub><mi>k</mi><mi>B</mi></msub><mo>âŠ‚</mo><mo stretchy=\"false\">(</mo><msup><mn>2</mn><mn>18</mn></msup><mo>âŠ•</mo><mi>m</mi><mi>a</mi><mi>s</mi><msub><mi>k</mi><mi>A</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">mask_B\\subset(2^{18}\\oplus mask_A)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">ma</span><span class=\"mord mathnormal\">s</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05017em;\">B</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">âŠ‚</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">18</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âŠ•</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">ma</span><span class=\"mord mathnormal\">s</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">A</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></p>\n<p>ä¸²é•¿åº¦ä¸è¶…è¿‡<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>18</mn></mrow><annotation encoding=\"application/x-tex\">18</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">18</span></span></span></span>ï¼Œæš´åŠ›æšä¸¾æ‰€æœ‰åˆæ³•ä¸²åˆå§‹åŒ–<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">dp</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">p</span></span></span></span>æ•°ç»„ï¼Œç„¶åè·‘<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mi>o</mi><mi>s</mi><mi>d</mi><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">sosdp</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">sos</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">p</span></span></span></span>ç»´æŠ¤å­é›†<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">max</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ma</span><span class=\"mord mathnormal\">x</span></span></span></span>ï¼Œæœ€åæš´åŠ›æ£€æŸ¥ä¸€åœˆå°±è¡Œäº†ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> B = (<span class=\"number\">1</span> &lt;&lt; <span class=\"number\">18</span>) - <span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> mp[<span class=\"number\">2</span> * B];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">a</span><span class=\"params\">(n + <span class=\"number\">1</span>)</span></span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">        cin &gt;&gt; a[i], a[i]--;</span><br><span class=\"line\">    <span class=\"type\">int</span> i = <span class=\"number\">1</span>, j = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> bit = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        bit = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt; <span class=\"number\">18</span> &amp;&amp; j + i &lt;= n; j++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> ((bit &gt;&gt; a[i + j]) &amp; <span class=\"number\">1</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            bit ^= (<span class=\"number\">1</span> &lt;&lt; a[i + j]);</span><br><span class=\"line\">            mp[bit] = <span class=\"built_in\">max</span>(mp[bit], j + <span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> ans = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt; <span class=\"number\">18</span>; j++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt;= B; i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (i &gt;&gt; j &amp; <span class=\"number\">1</span>)</span><br><span class=\"line\">                mp[i] = <span class=\"built_in\">max</span>(mp[i], mp[i ^ (<span class=\"number\">1</span> &lt;&lt; j)]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt;= B; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        ans = <span class=\"built_in\">max</span>(ans, mp[i] + mp[B ^ i]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h2 id=\"2-çº¿æ€§dp\">2.çº¿æ€§dp</h2>\n<h3 id=\"2-1-LIS-O-nlogn-â€‹\">2.1 LIS (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(nlogn)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>â€‹)</h3>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> N = <span class=\"number\">1e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> inf = <span class=\"number\">0x3f3f3f3f</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> a[N], dp[N], dp2[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n, ans = <span class=\"number\">0</span>;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cin &gt;&gt; a[i];</span><br><span class=\"line\">        dp[i] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// O(nlogn)åšæ³•</span></span><br><span class=\"line\">    <span class=\"type\">int</span> maxx = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"built_in\">memset</span>(dp2, inf, <span class=\"built_in\">sizeof</span>(dp2));</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> j = <span class=\"built_in\">lower_bound</span>(dp2, dp2 + n, a[i]) - dp2;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (j + <span class=\"number\">1</span> &gt; maxx)</span><br><span class=\"line\">            maxx = j + <span class=\"number\">1</span>;</span><br><span class=\"line\">        dp2[j] = a[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; maxx &lt;&lt; endl;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>å•è°ƒæ ˆä¼˜åŒ–ï¼š</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">int</span> arr[maxn], sta[maxn];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">        cin &gt;&gt; arr[i];</span><br><span class=\"line\">    <span class=\"type\">int</span> len = <span class=\"number\">1</span>;</span><br><span class=\"line\">    sta[len] = arr[<span class=\"number\">1</span>];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">2</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (arr[i] &gt; sta[len])</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            sta[++len] = arr[i];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> tem = <span class=\"built_in\">lower_bound</span>(sta + <span class=\"number\">1</span>, sta + <span class=\"number\">1</span> + len, arr[i]) - sta;</span><br><span class=\"line\">            sta[tem] = arr[i];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; len &lt;&lt; endl;</span><br><span class=\"line\">    <span class=\"comment\">// system(&quot;pause&quot;);</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"2-2-èƒŒåŒ…\">2.2 èƒŒåŒ…</h3>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> N = <span class=\"number\">1e6</span> + <span class=\"number\">2</span>;</span><br><span class=\"line\"><span class=\"comment\">// ç‰©å“å®¹ç§¯ä¸æƒé‡</span></span><br><span class=\"line\"><span class=\"type\">int</span> c[N], w[N], dp[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 01èƒŒåŒ…</span></span><br><span class=\"line\">    <span class=\"comment\">// ç‰©å“æ•°ç›®ä¸èƒŒåŒ…ä½“ç§¯</span></span><br><span class=\"line\">    <span class=\"type\">int</span> n, v;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)        <span class=\"comment\">// æšä¸¾æ‰€æœ‰ç‰©å“</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = v; j &gt;= c[i]; j--) <span class=\"comment\">// æšä¸¾èƒŒåŒ…ä½“ç§¯</span></span><br><span class=\"line\">            dp[j] = <span class=\"built_in\">max</span>(dp[j], dp[j - c[i]] + w[i]);</span><br><span class=\"line\">    <span class=\"comment\">// åˆ†ç»„èƒŒåŒ…</span></span><br><span class=\"line\">    <span class=\"comment\">// t[k][i]è¡¨ç¤ºç¬¬kç»„çš„ç¬¬iä»¶ç‰©å“çš„ç¼–å·æ˜¯å¤šå°‘</span></span><br><span class=\"line\">    <span class=\"type\">int</span> ts, m, cnt[N], t[N][N];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> k = <span class=\"number\">1</span>; k &lt;= ts; k++)                                        <span class=\"comment\">// å¾ªç¯æ¯ä¸€ç»„</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = m; i &gt;= <span class=\"number\">0</span>; i--)                                     <span class=\"comment\">// å¾ªç¯èƒŒåŒ…å®¹é‡</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">1</span>; j &lt;= cnt[k]; j++)                            <span class=\"comment\">// å¾ªç¯è¯¥ç»„çš„æ¯ä¸€ä¸ªç‰©å“</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (i &gt;= w[t[k][j]])                                     <span class=\"comment\">// èƒŒåŒ…å®¹é‡å……è¶³</span></span><br><span class=\"line\">                    dp[i] = <span class=\"built_in\">max</span>(dp[i], dp[i - w[t[k][j]]] + c[t[k][j]]); <span class=\"comment\">// åƒ0 - 1èƒŒåŒ…ä¸€æ ·çŠ¶æ€è½¬ç§»</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"2-3-æ•´æ•°åˆ’åˆ†\">2.3 æ•´æ•°åˆ’åˆ†</h3>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\">ll dp[maxn][maxn];</span><br><span class=\"line\">ll f[maxn][maxn], g[maxn][maxn];</span><br><span class=\"line\"><span class=\"type\">int</span> n, k;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">div1</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// dp[i][j] ä»£è¡¨å°†iåˆ’åˆ†ä¸ºä¸å¤§äºjçš„åˆ’åˆ†æ•°(å…è®¸é‡å¤æ•°å­—)</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">1</span>; j &lt;= k; j++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (j == <span class=\"number\">1</span>)</span><br><span class=\"line\">                dp[i][j] = <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (i == j)</span><br><span class=\"line\">                dp[i][j] = dp[i][j - <span class=\"number\">1</span>] + <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (i &lt; j)</span><br><span class=\"line\">                dp[i][j] = dp[i][i];</span><br><span class=\"line\">            <span class=\"keyword\">else</span></span><br><span class=\"line\">                dp[i][j] = dp[i][j - <span class=\"number\">1</span>] + dp[i - j][j];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">div2</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// dp[i][j] ä»£è¡¨å°†iåˆ’åˆ†ä¸ºä¸å¤§äºjçš„åˆ’åˆ†æ•°(æ²¡æœ‰é‡å¤æ•°å­—)</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">1</span>; j &lt;= k; j++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (j == <span class=\"number\">1</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (i == <span class=\"number\">1</span>)</span><br><span class=\"line\">                    dp[i][j] = <span class=\"number\">1</span>;</span><br><span class=\"line\">                <span class=\"keyword\">else</span></span><br><span class=\"line\">                    dp[i][j] = <span class=\"number\">0</span>; <span class=\"comment\">// åˆå§‹åŒ–ä¸åŒå³å¯, è½¬ç§»æ–¹ç¨‹ä¾æ—§ç›¸åŒ.</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (i == j)</span><br><span class=\"line\">                dp[i][j] = dp[i][j - <span class=\"number\">1</span>] + <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (i &lt; j)</span><br><span class=\"line\">                dp[i][j] = dp[i][i];</span><br><span class=\"line\">            <span class=\"keyword\">else</span></span><br><span class=\"line\">                dp[i][j] = dp[i][j - <span class=\"number\">1</span>] + dp[i - j][j - <span class=\"number\">1</span>];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">div3</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// dp[i][j]ä¸ºå°†iæ°å¥½åˆ’åˆ†ä¸ºjä¸ªæ•´æ•°çš„åˆ’åˆ†æ•°</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">1</span>; j &lt;= k; j++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (i == j)</span><br><span class=\"line\">                dp[i][j] = <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (i &lt; j)</span><br><span class=\"line\">                dp[i][j] = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span></span><br><span class=\"line\">                dp[i][j] = dp[i - <span class=\"number\">1</span>][j - <span class=\"number\">1</span>] + dp[i - j][j];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">div4</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// è®¾f[i][j]ä¸ºå°†iæ°å¥½åˆ’åˆ†ä¸ºjä¸ªå¥‡æ•°ä¹‹å’Œçš„åˆ’åˆ†æ•°</span></span><br><span class=\"line\">    <span class=\"comment\">//  g[i][j]ä¸ºå°†iæ°å¥½åˆ’åˆ†ä¸ºjä¸ªå¶æ•°ä¹‹å’Œçš„åˆ’åˆ†æ•°ã€‚</span></span><br><span class=\"line\">    f[<span class=\"number\">0</span>][<span class=\"number\">0</span>] = g[<span class=\"number\">0</span>][<span class=\"number\">0</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">1</span>; j &lt;= k; j++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (i &lt; j)</span><br><span class=\"line\">                f[i][j] = g[i][j] = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                f[i][j] = f[i - <span class=\"number\">1</span>][j - <span class=\"number\">1</span>] + g[i - j][j];</span><br><span class=\"line\">                g[i][j] = f[i - j][j];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">div5</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// dp[i][j] ä»£è¡¨iåˆ’åˆ†ä¸ºä¸å¤šäºjä¸ªæ­£æ•´æ•°çš„åˆ’åˆ†æ•°</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">1</span>; j &lt;= k; j++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (i == <span class=\"number\">1</span> || j == <span class=\"number\">1</span>)</span><br><span class=\"line\">                dp[i][j] = <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (i == j)</span><br><span class=\"line\">                dp[i][j] = dp[i][j - <span class=\"number\">1</span>] + <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (i &lt; j)</span><br><span class=\"line\">                dp[i][j] = dp[i][i];</span><br><span class=\"line\">            <span class=\"keyword\">else</span></span><br><span class=\"line\">                dp[i][j] = dp[i][j - <span class=\"number\">1</span>] + dp[i - j][j];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"2-4-æ•°ä½dp\">2.4 æ•°ä½dp</h3>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">int</span> a[maxn], f[maxn][maxn][<span class=\"number\">2</span>];</span><br><span class=\"line\"><span class=\"comment\">// f[len][state],çŠ¶å‹çš„stateè®°å½•çŠ¶æ€</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"type\">int</span> pos, <span class=\"type\">int</span> pre, <span class=\"type\">bool</span> limit, <span class=\"type\">bool</span> lead0, <span class=\"type\">int</span> cnt)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!pos)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span>;  <span class=\"comment\">// çœ‹æƒ…å†µreturn 1è¿˜æ˜¯cnt</span></span><br><span class=\"line\">    <span class=\"keyword\">auto</span>&amp; now = f[pos][pre][limit];</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!lead0 &amp;&amp; ~now)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> now;</span><br><span class=\"line\">    <span class=\"type\">int</span> up = limit ? a[pos] : <span class=\"number\">9</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> res = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt;= up; i++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!lead0 &amp;&amp; <span class=\"built_in\">abs</span>(i - pre) &lt; <span class=\"number\">2</span>)</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;  <span class=\"comment\">// ä¿è¯æšä¸¾çš„è¦åˆæ³•</span></span><br><span class=\"line\">        res += <span class=\"built_in\">dfs</span>(pos - <span class=\"number\">1</span>, i, limit &amp;&amp; i == up, lead0 &amp;&amp; i == <span class=\"number\">0</span>, cnt);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!lead0)</span><br><span class=\"line\">        now = res;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">solve</span><span class=\"params\">(<span class=\"type\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> len = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (x &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        a[++len] = x % <span class=\"number\">10</span>;</span><br><span class=\"line\">        x /= <span class=\"number\">10</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">dfs</span>(len, <span class=\"number\">0</span>, <span class=\"literal\">true</span>, <span class=\"literal\">true</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"2-5-å››è¾¹å½¢ä¸ç­‰å¼ä¼˜åŒ–dp\">2.5 å››è¾¹å½¢ä¸ç­‰å¼ä¼˜åŒ–dp</h3>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">int</span> m[maxn][maxn],dp[maxn][maxn],sum[maxn],arr[maxn];</span><br><span class=\"line\"><span class=\"comment\">//mæ˜¯åŒºé—´åˆ†å‰²ç‚¹</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n;cin&gt;&gt;n;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)&#123;</span><br><span class=\"line\">        cin&gt;&gt;arr[i];</span><br><span class=\"line\">        sum[i]=sum[i<span class=\"number\">-1</span>]+arr[i];</span><br><span class=\"line\">        m[i][i]=i;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> len=<span class=\"number\">2</span>;len&lt;=n;len++)&#123;<span class=\"comment\">//æšä¸¾åŒºé—´é•¿åº¦ï¼Œä¹Ÿæ˜¯å¯¹è§’çº¿æ¡æ•°</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>,j=len;j&lt;=n;i++,j++)&#123;</span><br><span class=\"line\">            dp[i][j]=inf;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"type\">int</span> k=m[i][j<span class=\"number\">-1</span>];k&lt;=m[i<span class=\"number\">+1</span>][j];k++)&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(dp[i][k]+dp[k<span class=\"number\">+1</span>][j]+sum[j]-sum[i<span class=\"number\">-1</span>]&lt;dp[i][j])&#123;</span><br><span class=\"line\">                    dp[i][j]=dp[i][k]+dp[k<span class=\"number\">+1</span>][j]+sum[j]-sum[i<span class=\"number\">-1</span>];</span><br><span class=\"line\">                    m[i][j]=k;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout&lt;&lt;dp[<span class=\"number\">1</span>][n]&lt;&lt;endl;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"2-6-çŠ¶æ€å‹ç¼©dp\">2.6 çŠ¶æ€å‹ç¼©dp</h3>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">1</span> &lt;&lt; <span class=\"number\">16</span>;</span><br><span class=\"line\">db f[<span class=\"number\">17</span>][<span class=\"number\">1</span> &lt;&lt; <span class=\"number\">17</span>]; <span class=\"comment\">// å½“å‰åˆ°ç¬¬iä¸ªå¥¶é…ªï¼Œå¹¶ä¸”å·²ç»ç»è¿‡çš„çŠ¶æ€ä¸ºj</span></span><br><span class=\"line\">db d[<span class=\"number\">17</span>][<span class=\"number\">17</span>];</span><br><span class=\"line\">db x[<span class=\"number\">17</span>] = &#123;<span class=\"number\">0</span>&#125;, y[<span class=\"number\">17</span>] = &#123;<span class=\"number\">0</span>&#125;;</span><br><span class=\"line\"><span class=\"function\">db <span class=\"title\">dis</span><span class=\"params\">(<span class=\"type\">int</span> i, <span class=\"type\">int</span> j)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">sqrt</span>((x[i] - x[j]) * (x[i] - x[j]) + (y[i] - y[j]) * (y[i] - y[j]));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> n = <span class=\"built_in\">read</span>();</span><br><span class=\"line\">    <span class=\"built_in\">memset</span>(f, <span class=\"number\">127</span>, <span class=\"built_in\">sizeof</span>(f));</span><br><span class=\"line\">    db ans = f[<span class=\"number\">0</span>][<span class=\"number\">0</span>];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">        cin &gt;&gt; x[i] &gt;&gt; y[i];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt;= n; i++)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = i + <span class=\"number\">1</span>; j &lt;= n; j++)</span><br><span class=\"line\">            d[i][j] = d[j][i] = <span class=\"built_in\">dis</span>(i, j); <span class=\"comment\">// åˆå§‹åŒ–ä»»æ„ä¸¤ä¸ªå¥¶é…ªä¹‹é—´çš„è·ç¦»</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">        f[i][<span class=\"number\">1</span> &lt;&lt; (i - <span class=\"number\">1</span>)] = d[<span class=\"number\">0</span>][i];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt; (<span class=\"number\">1</span> &lt;&lt; n); j++)</span><br><span class=\"line\">    &#123; <span class=\"comment\">// æšä¸¾å½“å‰å·²ç»èµ°è¿‡çš„çŠ¶æ€</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">        &#123;\t\t\t\t\t\t\t\t   <span class=\"comment\">// æšä¸¾å½“å‰å·²ç»åˆ°ç¬¬iä¸ªå¥¶é…ª</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> ((j &amp; (<span class=\"number\">1</span> &lt;&lt; (i - <span class=\"number\">1</span>))) == <span class=\"number\">0</span>) <span class=\"comment\">// æœ¬åº”å·²ç»åˆ°äº†iä¸ªå¥¶é…ªï¼Œä½†æ˜¯è¿˜æ²¡èµ°è¿‡iä¸åˆé¢˜æ„</span></span><br><span class=\"line\">                <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> k = <span class=\"number\">1</span>; k &lt;= n; k++)</span><br><span class=\"line\">            &#123; <span class=\"comment\">// æšä¸¾ä¸Šä¸€ä¸ªèµ°åˆ°çš„å¥¶é…ª</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (i == k)</span><br><span class=\"line\">                    <span class=\"keyword\">continue</span>;\t\t\t\t   <span class=\"comment\">// é‡å¤äº†è·³è¿‡</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> ((j &amp; (<span class=\"number\">1</span> &lt;&lt; (k - <span class=\"number\">1</span>))) == <span class=\"number\">0</span>) <span class=\"comment\">// ç›®å‰èµ°è¿‡çš„jæ²¡èµ°è¿‡k</span></span><br><span class=\"line\">                    <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">                f[i][j] = <span class=\"built_in\">min</span>(f[i][j], f[k][j - (<span class=\"number\">1</span> &lt;&lt; (i - <span class=\"number\">1</span>))] + d[i][k]);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">        ans = <span class=\"built_in\">min</span>(ans, f[i][(<span class=\"number\">1</span> &lt;&lt; n) - <span class=\"number\">1</span>]);</span><br><span class=\"line\">    cout &lt;&lt; fixed &lt;&lt; <span class=\"built_in\">setprecision</span>(<span class=\"number\">2</span>) &lt;&lt; ans &lt;&lt; endl;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<div style=\"page-break-after: always;\"></div>\n<h3 id=\"2-7-æœ€çŸ­è·¯ä¼˜åŒ–dp\">2.7 æœ€çŸ­è·¯ä¼˜åŒ–dp</h3>\n<p>æœ€çŸ­è·¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">dp</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">p</span></span></span></span>åæ•ˆæ€§é—®é¢˜ä¼šè¢«æœ€çŸ­è·¯ä¼˜åŒ–æ‰ã€‚</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">int</span> n, m;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> int long long</span></span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">2e5</span> + <span class=\"number\">9</span>;</span><br><span class=\"line\">vector&lt;pair&lt;<span class=\"type\">int</span>, <span class=\"type\">int</span>&gt;&gt; connects[maxn];</span><br><span class=\"line\"><span class=\"type\">int</span> a[maxn];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">add_edge</span><span class=\"params\">(<span class=\"type\">int</span> u, <span class=\"type\">int</span> v, <span class=\"type\">int</span> w)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    connects[u].<span class=\"built_in\">push_back</span>(&#123;v, w&#125;);</span><br><span class=\"line\">    connects[v].<span class=\"built_in\">push_back</span>(&#123;u, w&#125;);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt; dist, dist1;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">Dijkstra_queue0</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">using</span> pi = pair&lt;<span class=\"type\">int</span>, <span class=\"type\">int</span>&gt;;</span><br><span class=\"line\">    <span class=\"function\">vector&lt;<span class=\"type\">bool</span>&gt; <span class=\"title\">vis</span><span class=\"params\">(n + <span class=\"number\">1</span>, <span class=\"number\">0</span>)</span></span>;</span><br><span class=\"line\">    priority_queue&lt;pi, vector&lt;pi&gt;, greater&lt;pi&gt;&gt; q;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        q.<span class=\"built_in\">push</span>(&#123;dist[i], i&#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (!q.<span class=\"built_in\">empty</span>())</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> [dis, u] = q.<span class=\"built_in\">top</span>();</span><br><span class=\"line\">        q.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (vis[u])</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        vis[u] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> [v, w] : connects[u])</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (vis[v])</span><br><span class=\"line\">                <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (dist[v] &gt; dist[u] + w)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                dist[v] = dist[u] + w;</span><br><span class=\"line\">                q.<span class=\"built_in\">push</span>(&#123;dist[v], v&#125;);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">Dijkstra_queue1</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">using</span> pi = pair&lt;<span class=\"type\">int</span>, <span class=\"type\">int</span>&gt;;</span><br><span class=\"line\">    <span class=\"function\">vector&lt;<span class=\"type\">bool</span>&gt; <span class=\"title\">vis</span><span class=\"params\">(n + <span class=\"number\">1</span>, <span class=\"number\">0</span>)</span></span>;</span><br><span class=\"line\">    priority_queue&lt;pi, vector&lt;pi&gt;, greater&lt;pi&gt;&gt; q;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        q.<span class=\"built_in\">push</span>(&#123;dist1[i], i&#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (!q.<span class=\"built_in\">empty</span>())</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> [dis, u] = q.<span class=\"built_in\">top</span>();</span><br><span class=\"line\">        q.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (vis[u])</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        vis[u] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> [v, w] : connects[u])</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> now = <span class=\"built_in\">min</span>(dist[u], dist1[u] + w);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (now &lt; dist1[v])</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                dist1[v] = now;</span><br><span class=\"line\">                q.<span class=\"built_in\">push</span>(&#123;dist1[v], v&#125;);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= m; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> u, v, w;</span><br><span class=\"line\">        cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class=\"line\">        <span class=\"built_in\">add_edge</span>(u, v, w);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    dist.<span class=\"built_in\">resize</span>(n + <span class=\"number\">10</span>), dist<span class=\"number\">1.</span><span class=\"built_in\">resize</span>(n + <span class=\"number\">10</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        cin &gt;&gt; a[i];</span><br><span class=\"line\">        dist[i] = dist1[i] = a[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">Dijkstra_queue0</span>();</span><br><span class=\"line\">    <span class=\"built_in\">Dijkstra_queue1</span>();</span><br><span class=\"line\">    cout &lt;&lt; *<span class=\"built_in\">max_element</span>(dist<span class=\"number\">1.</span><span class=\"built_in\">begin</span>() + <span class=\"number\">1</span>, dist<span class=\"number\">1.</span><span class=\"built_in\">end</span>()) &lt;&lt; endl;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","tags":["ACM","ICPC","ç®—æ³•æ¨¡ç‰ˆ"]},{"title":"Mini App","url":"/post/c1183a76.html","content":"<h2 id=\"ä½œä¸šè¦æ±‚\">ä½œä¸šè¦æ±‚</h2>\n<p><strong>ä½œä¸šè¯´æ˜ï¼š</strong><br>\nä¸ªäººä½œä¸šã€‚ä¸é™ä¸»é¢˜ï¼Œä¸é™åŠŸèƒ½ï¼Œåšå‡ºä¸€æ¬¾Mini App</p>\n<p><strong>å…·ä½“è¦æ±‚ï¼š</strong><br>\n1.åŠŸèƒ½è¦æ±‚ï¼šå¯ä½¿ç”¨ä»»æ„ç•Œé¢æ¡†æ¶å®Œæˆè‡³å°‘ä¸€ä¸ªçš„åŠŸèƒ½ç‚¹<br>\n2.æŠ€æœ¯è¦æ±‚ï¼šéœ€è¦ä½¿ç”¨åˆ°ç½‘ç»œã€å­˜å‚¨ç­‰æŠ€æœ¯ç‚¹ä¸­è‡³å°‘ä¸€æ¡<br>\n3.æ€§èƒ½è¦æ±‚ï¼šä¸å¡é¡¿ã€æ— æ˜æ˜¾èµ„æºæ³„éœ²</p>\n<p><strong>æäº¤è¦æ±‚ï¼š</strong><br>\n1.äº§å“æŠ¥å‘Šï¼šä¸é™äºppt/word/pdfæ ¼å¼ï¼Œå†…å®¹éœ€è‡³å°‘åŒ…æ‹¬ â‘ äº§å“åŠŸèƒ½ä»‹ç»ï¼›â‘¡ç¨‹åºæ¦‚è¦è®¾è®¡ï¼›â‘¢è½¯ä»¶æ¶æ„å›¾ï¼›â‘£æŠ€æœ¯äº®ç‚¹åŠå…¶å®ç°åŸç†ï¼ˆéå¿…é€‰ï¼‰<br>\n2.æºä»£ç ï¼šè¦æ±‚æäº¤åˆ°GitHub/gitee repoä»“åº“ï¼Œå°†ä»“åº“åœ°å€ç²˜è´´åˆ°txtæäº¤å³å¯<br>\n3.æ¼”ç¤ºå½•å±ï¼šmkv, mp4, avi, rm, rmvbæ ¼å¼ä¼˜å…ˆ<br>\n4.æäº¤æ—¶é—´ï¼š11æœˆ30æ—¥æ™š12ç‚¹å‰</p>\n<p><strong>æäº¤æ ¼å¼ï¼š</strong><br>\nè¯·å°†ä»¥ä¸Šä¸‰ä¸ªå†…å®¹åˆå¹¶åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹å¹¶å‹ç¼©ï¼Œå‘½åï¼šå­¦æ ¡+å§“å+Android/iOS+Appåç§°<br>\nä¸Šä¼ è‡³ï¼š<br>\nè…¾è®¯å®¢æˆ·ç«¯èè‹±ç­è¯¾ç¨‹å¤§ä½œä¸šæäº¤</p>\n<p><strong>æ ·ä¾‹å‚è€ƒï¼š</strong><br>\nä¾‹1ï¼šã€Šè¡¨æƒ…å›¾åº“ã€‹<br>\n1.åŠŸèƒ½è¦æ±‚ï¼šä½¿ç”¨ç½‘æ ¼/åˆ—è¡¨ï¼Œå±•ç¤ºè¡¨æƒ…å›¾åº“<br>\n2.æŠ€æœ¯è¦æ±‚ï¼šä½¿ç”¨ DB å­˜å‚¨å›¾ç‰‡æ–‡ä»¶ä¿¡æ¯ï¼Œä½¿ç”¨æ–‡ä»¶å­˜å‚¨è¡¨æƒ…å›¾ç‰‡<br>\n3.æ€§èƒ½è¦æ±‚ï¼šå¿«é€Ÿæ‰“å¼€è¶…è¿‡1000å¼ å›¾ç‰‡çš„å›¾åº“ï¼Œæ˜¾ç¤ºå›¾ç‰‡æµç•…æ»‘åŠ¨ä¸å¡é¡¿ï¼Œå†…å­˜èµ„æºä¸æ³„éœ²</p>\n<p>ä¾‹2ï¼šã€Šå¾®ä¿¡æ–‡æœ¬/å›¾ç‰‡èŠå¤©ã€‹<br>\n1.åŠŸèƒ½è¦æ±‚ï¼šä»¿ç…§å¾®ä¿¡åšä¸€ä¸ªå¯ä»¥æ–‡æœ¬/å›¾ç‰‡èŠå¤©çš„ç•Œé¢<br>\n2.æŠ€æœ¯è¦æ±‚ï¼šèƒ½å¤Ÿè¿›è¡Œä¸¤äººä»¥ä¸Šçš„èŠå¤©ï¼Œèƒ½å¤Ÿå‘é€æ–‡æœ¬/å›¾ç‰‡<br>\n3.æ€§èƒ½è¦æ±‚ï¼šèŠå¤©åˆ—è¡¨ä¸Šä¸‹æ»‘åŠ¨ä¸å¡é¡¿ï¼Œæ²¡æœ‰èµ„æºæ³„éœ²</p>\n<p>æ³¨ï¼šä»¥ä¸Šä»…ä¸ºæ ·ä¾‹å‚è€ƒï¼ŒåŒå­¦ä»¬å¯ä»¥ä»»æ„é€‰æ‹©è‡ªå·±æƒ³åšçš„ Mini Appã€‚</p>\n<h2 id=\"ã€Šè¡¨æƒ…å›¾åº“ã€‹Webå¼€å‘æµç¨‹\">ã€Šè¡¨æƒ…å›¾åº“ã€‹Webå¼€å‘æµç¨‹</h2>\n<h3 id=\"æŠ€æœ¯æ¶æ„\">æŠ€æœ¯æ¶æ„</h3>\n<p>æˆ‘ä»¬å°†ä½¿ç”¨ä»¥ä¸‹æŠ€æœ¯ï¼š</p>\n<ul>\n<li><strong>HTML</strong>ï¼šè´Ÿè´£ç½‘é¡µç»“æ„ã€‚</li>\n<li><strong>CSS</strong>ï¼šè´Ÿè´£é¡µé¢å¸ƒå±€å’Œæ ·å¼ã€‚</li>\n<li><strong>JavaScript</strong>ï¼šæ§åˆ¶é¡µé¢é€»è¾‘ï¼Œæ“ä½œ IndexedDB æ•°æ®åº“ã€‚</li>\n<li><strong>IndexedDB</strong>ï¼šç”¨äºå­˜å‚¨å›¾ç‰‡çš„æ–‡ä»¶ä¿¡æ¯ï¼ˆåŒ…æ‹¬è·¯å¾„ã€æ ‡é¢˜å’Œåˆ†ç±»ï¼‰ã€‚<br>\nå›¾ç‰‡æ–‡ä»¶å­˜å‚¨åœ¨æ–‡ä»¶ç³»ç»Ÿï¼ˆ<code>assets</code> æ–‡ä»¶å¤¹ï¼‰ä¸­ï¼Œæ•°æ®åº“åªå­˜å‚¨å›¾ç‰‡çš„å…ƒæ•°æ®ã€‚</li>\n</ul>\n<h3 id=\"å¼€å‘ç¯å¢ƒå‡†å¤‡\">å¼€å‘ç¯å¢ƒå‡†å¤‡</h3>\n<p>1.å·¥å…·ï¼š</p>\n<ul>\n<li>ä¸‹è½½å¹¶å®‰è£… <a href=\"https://code.visualstudio.com/\"><code>VS Code</code></a> ä½œä¸ºä»£ç ç¼–è¾‘å™¨ã€‚</li>\n<li>å®‰è£…æµè§ˆå™¨æ’ä»¶ <code>Live Server</code>ï¼Œç”¨äºè¿è¡Œæœ¬åœ°ç½‘é¡µã€‚<br>\n2.æ–‡ä»¶å¤¹ç»“æ„ï¼š åˆ›å»ºä¸€ä¸ªåä¸º è¡¨æƒ…å›¾åº“ çš„æ–‡ä»¶å¤¹ï¼Œå†…éƒ¨æ–‡ä»¶ç»„ç»‡å¦‚ä¸‹ï¼š</li>\n</ul>\n<h3 id=\"é¡¹ç›®å®ç°æµç¨‹\">é¡¹ç›®å®ç°æµç¨‹</h3>\n<h3 id=\"è¿è¡Œé¡¹ç›®\">è¿è¡Œé¡¹ç›®</h3>\n","tags":["Mini App","è…¾è®¯"]},{"title":"Mirror Maze","url":"/post/593f2d9e.html","content":"<h1><a href=\"https://ac.nowcoder.com/acm/contest/81596/I\">I-Mirror Maze_2024ç‰›å®¢æš‘æœŸå¤šæ ¡è®­ç»ƒè¥1</a></h1>\n<h2 id=\"é¢˜ç›®å¤§æ„\"><strong>é¢˜ç›®å¤§æ„</strong></h2>\n<p>æœ‰ä¸€ä¸ª <em>n Ã— m</em> çš„çŸ©å½¢é•œå­è¿·å®«ï¼Œé•œå­æœ‰ â€œ<em>\\</em>, /, -, |â€ å››ç§ï¼Œæ¯ç§é•œå­æœ‰ç‰¹å®šçš„å…‰çº¿åå°„æ–¹å‘ï¼Œæ³¨æ„ç›´æ¥é€šè¿‡é•œå­çš„æƒ…å†µä¸ç®—è¢«åå°„ã€‚</p>\n<p>æœ‰ <em>q</em> ä¸ªè¯¢é—®ï¼Œæ¯ä¸ªè¯¢é—®ç»™å®šä¸€ä¸ªç‚¹å…‰æº (<em>x, y, dir</em>)ï¼Œè¡¨ç¤ºåœ¨ (<em>x, y</em>) ä½ç½®å‘ <em>dir</em> æ–¹å‘å‘å°„ä¸€æŸå…‰çº¿ï¼Œé—®ç»è¿‡è¶³å¤Ÿçš„æ—¶é—´ä¹‹åï¼Œè¿™æŸå…‰çº¿è¢«å¤šå°‘ä¸ªä¸åŒçš„é•œå­åå°„è¿‡ã€‚</p>\n<p><em>1 â‰¤ n, m â‰¤ 1000, 1 â‰¤ q â‰¤ 10<sup>5</sup></em></p>\n<h2 id=\"é¢˜è§£\"><strong>é¢˜è§£</strong></h2>\n<p>å› ä¸ºå…‰è·¯å¯é€†ï¼Œæ‰€ä»¥ä¸å¯èƒ½æœ‰å…‰æŸåˆ†å‰æˆ–è€…æ±‡åˆçš„æƒ…å†µï¼Œæ‰€ä»¥æ‰€æœ‰çš„å…‰æŸä¼šæ„æˆè‹¥å¹²ä¸ªç¯å’Œè‹¥å¹²æ¡é“¾ã€‚</p>\n<p>æ‰€ä»¥æˆ‘ä»¬è¦åšçš„å°±æ˜¯æŠŠè¿™äº›å…‰ç¯å’Œå…‰é“¾æŠ½å‡ºæ¥ï¼Œç„¶åé¢„å¤„ç†å‡ºæ¯ä¸ªç‚¹å…‰æºçš„ç­”æ¡ˆï¼Œè¯¢é—®å°±æŸ¥è¡¨ <em>O(1)</em> å›ç­”å³å¯ã€‚</p>\n<p>æ—¶é—´å¤æ‚åº¦ï¼š<em>O(nm + q)</em>ã€‚</p>\n<h2 id=\"ä»£ç \"><strong>ä»£ç </strong></h2>\n<figure class=\"highlight cpp\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> </span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> pii pair</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> tii tuple</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> all(a) a.begin(), a.end()</span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">1e3</span> + <span class=\"number\">10</span>;</span><br><span class=\"line\"><span class=\"type\">char</span> ch[maxn][maxn];</span><br><span class=\"line\"><span class=\"type\">int</span> n, m, ans[maxn][maxn][<span class=\"number\">4</span>];</span><br><span class=\"line\"><span class=\"type\">int</span> vis[maxn][maxn][<span class=\"number\">4</span>];</span><br><span class=\"line\">vector vec;<span class=\"comment\">//å­˜å‚¨ç»è¿‡äº†å“ªäº›é•œå­çš„å“ªäº›çŠ¶æ€</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">bool</span> <span class=\"title\">istan</span><span class=\"params\">(<span class=\"type\">int</span> x, <span class=\"type\">int</span> y, <span class=\"type\">int</span> dir)</span> </span>&#123;  <span class=\"comment\">// æ ‡è®°æŸä¸ªçŠ¶æ€æ˜¯å¦ä¼šç»è¿‡é•œå­çš„åå°„</span></span><br><span class=\"line\">    <span class=\"type\">char</span> tem = ch[x][y];</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (tem == <span class=\"string\">&#x27;/&#x27;</span> || tem == <span class=\"string\">&#x27;\\\\&#x27;</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (tem == <span class=\"string\">&#x27;-&#x27;</span> &amp;&amp; (dir == <span class=\"number\">0</span> || dir == <span class=\"number\">1</span>))</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (tem == <span class=\"string\">&#x27;|&#x27;</span> &amp;&amp; (dir == <span class=\"number\">2</span> || dir == <span class=\"number\">3</span>))</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"type\">int</span> x, <span class=\"type\">int</span> y, <span class=\"type\">int</span> dir)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// æ ¹æ®é¢˜æ„æ¨¡æ‹Ÿåå°„è¿‡ç¨‹ï¼Œè¶Šç•Œï¼ˆé“¾ï¼‰æˆ–è€…è®¿é—®è¿‡ï¼ˆç¯ï¼‰é€€å‡º</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (x &lt; <span class=\"number\">1</span> || x &gt; n || y &lt; <span class=\"number\">1</span> || y &gt; m)  <span class=\"comment\">// é“¾çš„é€€å‡ºæ¡ä»¶</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (vis[x][y][dir])  <span class=\"comment\">// ç¯çš„é€€å‡ºæ¡ä»¶</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    vec.<span class=\"built_in\">push_back</span>(<span class=\"built_in\">tii</span>(x, y, dir));</span><br><span class=\"line\">    vis[x][y][dir] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (ch[x][y] == <span class=\"string\">&#x27;/&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (dir == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">dfs</span>(x, y + <span class=\"number\">1</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (dir == <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">dfs</span>(x, y - <span class=\"number\">1</span>, <span class=\"number\">2</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (dir == <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">dfs</span>(x + <span class=\"number\">1</span>, y, <span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"built_in\">dfs</span>(x - <span class=\"number\">1</span>, y, <span class=\"number\">0</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (ch[x][y] == <span class=\"string\">&#x27;\\\\&#x27;</span>) &#123; <span class=\"comment\">//æ³¨æ„å¤šåŠ ä¸€ä¸ª&#x27;\\&#x27;</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (dir == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">dfs</span>(x, y - <span class=\"number\">1</span>, <span class=\"number\">2</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (dir == <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">dfs</span>(x, y + <span class=\"number\">1</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (dir == <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">dfs</span>(x - <span class=\"number\">1</span>, y, <span class=\"number\">0</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"built_in\">dfs</span>(x + <span class=\"number\">1</span>, y, <span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (ch[x][y] == <span class=\"string\">&#x27;-&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (dir == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">dfs</span>(x + <span class=\"number\">1</span>, y, <span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (dir == <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">dfs</span>(x - <span class=\"number\">1</span>, y, <span class=\"number\">0</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (dir == <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">dfs</span>(x, y - <span class=\"number\">1</span>, <span class=\"number\">2</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span></span><br><span class=\"line\">            <span class=\"built_in\">dfs</span>(x, y + <span class=\"number\">1</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (ch[x][y] == <span class=\"string\">&#x27;|&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (dir == <span class=\"number\">0</span>)</span><br><span class=\"line\">            <span class=\"built_in\">dfs</span>(x - <span class=\"number\">1</span>, y, <span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (dir == <span class=\"number\">1</span>)</span><br><span class=\"line\">            <span class=\"built_in\">dfs</span>(x + <span class=\"number\">1</span>, y, <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (dir == <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">dfs</span>(x, y + <span class=\"number\">1</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"built_in\">dfs</span>(x, y - <span class=\"number\">1</span>, <span class=\"number\">2</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">solve1</span><span class=\"params\">(<span class=\"type\">int</span> x, <span class=\"type\">int</span> y, <span class=\"type\">int</span> dir)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// å¤„ç†é“¾</span></span><br><span class=\"line\">    vec.<span class=\"built_in\">clear</span>();</span><br><span class=\"line\">    <span class=\"built_in\">dfs</span>(x, y, dir);</span><br><span class=\"line\">    <span class=\"built_in\">reverse</span>(<span class=\"built_in\">all</span>(vec));  <span class=\"comment\">// å€’å™éå†çŠ¶æ€æ›´æ–°ç­”æ¡ˆ</span></span><br><span class=\"line\">    set s;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> [a, b, c] : vec) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"built_in\">istan</span>(a, b, c))</span><br><span class=\"line\">            s.<span class=\"built_in\">insert</span>(<span class=\"built_in\">pii</span>(a, b));</span><br><span class=\"line\">        ans[a][b][c] = s.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">solve2</span><span class=\"params\">(<span class=\"type\">int</span> x, <span class=\"type\">int</span> y, <span class=\"type\">int</span> dir)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// å¤„ç†ç¯</span></span><br><span class=\"line\">    vec.<span class=\"built_in\">clear</span>();</span><br><span class=\"line\">    <span class=\"built_in\">dfs</span>(x, y, dir);</span><br><span class=\"line\">    set s;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> [a, b, c] : vec) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"built_in\">istan</span>(a, b, c))</span><br><span class=\"line\">            s.<span class=\"built_in\">insert</span>(<span class=\"built_in\">pii</span>(a, b));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">auto</span> [a, b, c] : vec)</span><br><span class=\"line\">        ans[a][b][c] = s.<span class=\"built_in\">size</span>();  <span class=\"comment\">// ç¯ä¸Šçš„ç­”æ¡ˆéƒ½ä¸€æ ·</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"literal\">false</span>);</span><br><span class=\"line\">    cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>), cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">1</span>; j &lt;= m; j++)</span><br><span class=\"line\">            cin &gt;&gt; ch[i][j];</span><br><span class=\"line\">    <span class=\"comment\">/***** 0ï¼Œ1ï¼Œ2ï¼Œ3åˆ†åˆ«è¡¨ç¤ºä¸ºå‘ä¸Šã€ä¸‹ã€å·¦ã€å³å°„å…¥çš„å…‰çº¿ *****/</span></span><br><span class=\"line\">    <span class=\"comment\">// ä»è¾¹ç•Œå°„å…¥çš„å…‰çº¿ä¸€å®šæ˜¯é“¾</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">        <span class=\"built_in\">solve1</span>(i, <span class=\"number\">1</span>, <span class=\"number\">3</span>), <span class=\"built_in\">solve1</span>(i, m, <span class=\"number\">2</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">1</span>; j &lt;= m; j++)</span><br><span class=\"line\">        <span class=\"built_in\">solve1</span>(<span class=\"number\">1</span>, j, <span class=\"number\">1</span>), <span class=\"built_in\">solve1</span>(n, j, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"comment\">// è¿˜æœªè®¿é—®çš„çŠ¶æ€ï¼Œä¸€å®šæ˜¯ç¯ä¸Šçš„çŠ¶æ€</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">1</span>; j &lt;= m; j++)</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> k = <span class=\"number\">0</span>; k &lt; <span class=\"number\">4</span>; k++)</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (!vis[i][j][k]) &#123;</span><br><span class=\"line\">                    <span class=\"built_in\">solve2</span>(i, j, k);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> q;</span><br><span class=\"line\">    cin &gt;&gt; q;</span><br><span class=\"line\">    map mp;</span><br><span class=\"line\">    mp[<span class=\"string\">&quot;above&quot;</span>] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    mp[<span class=\"string\">&quot;below&quot;</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    mp[<span class=\"string\">&quot;left&quot;</span>] = <span class=\"number\">2</span>;</span><br><span class=\"line\">    mp[<span class=\"string\">&quot;right&quot;</span>] = <span class=\"number\">3</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (q--) &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> x, y;</span><br><span class=\"line\">        string str;</span><br><span class=\"line\">        cin &gt;&gt; x &gt;&gt; y &gt;&gt; str;</span><br><span class=\"line\">        <span class=\"comment\">// å…ˆæ ¹æ®æ–¹å‘åç§»ä¸€æ ¼</span></span><br><span class=\"line\">        <span class=\"type\">int</span> tem = mp[str];</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tem == <span class=\"number\">0</span>)</span><br><span class=\"line\">            x--;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (tem == <span class=\"number\">1</span>)</span><br><span class=\"line\">            x++;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (tem == <span class=\"number\">2</span>)</span><br><span class=\"line\">            y--;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">            y++;</span><br><span class=\"line\">        cout &lt;&lt; ans[x][y][tem] &lt;&lt; <span class=\"string\">&quot;\\n&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","tags":["ACM","Mirror Maze"]},{"title":"Hello World","url":"/post/4a17b156.html","content":"<p>Welcome to <a href=\"https://hexo.io/\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\">Quick Start</h2>\n<h3 id=\"Create-a-new-post\">Create a new post</h3>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\">Writing</a></p>\n<h3 id=\"Run-server\">Run server</h3>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/server.html\">Server</a></p>\n<h3 id=\"Generate-static-files\">Generate static files</h3>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ hexo generate</span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\">Deploy to remote sites</h3>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ hexo deploy</span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/one-command-deployment.html\">Deployment</a></p>\n"},{"title":"ã€Šè½¯ä»¶å·¥ç¨‹ã€‹å¤ä¹ ","url":"/post/c5fb3a3a.html","content":"<h2 id=\"1-2-è½¯ä»¶åŠå…¶ç‰¹ç‚¹\">1.2 è½¯ä»¶åŠå…¶ç‰¹ç‚¹</h2>\n<h3 id=\"è½¯ä»¶çš„ç»„æˆ\">è½¯ä»¶çš„ç»„æˆ</h3>\n<p>ç¨‹åºã€æ•°æ®å’Œç›¸å…³æ–‡æ¡£</p>\n<h3 id=\"è½¯ä»¶çš„ç”Ÿå‘½å‘¨æœŸ\">è½¯ä»¶çš„ç”Ÿå‘½å‘¨æœŸ</h3>\n<p>éœ€æ±‚åˆ†æã€è½¯ä»¶è®¾è®¡ã€ç¼–ç å®ç°ã€è½¯ä»¶æµ‹è¯•ã€éƒ¨ç½²è¿è¡Œã€ä½¿ç”¨ç»´æŠ¤ã€‚</p>\n<h3 id=\"è½¯ä»¶çš„åˆ†ç±»\">è½¯ä»¶çš„åˆ†ç±»</h3>\n<p><strong>åº”ç”¨è½¯ä»¶</strong><br>\n<strong>ç³»ç»Ÿè½¯ä»¶</strong><br>\n<strong>æ”¯æ’‘è½¯ä»¶</strong></p>\n<h3 id=\"å¼€æºè½¯ä»¶çš„ä¼˜åŠ¿\">å¼€æºè½¯ä»¶çš„ä¼˜åŠ¿</h3>\n<h4 id=\"å¼€æºè½¯ä»¶çš„å¥½å¤„\"><strong>å¼€æºè½¯ä»¶çš„å¥½å¤„</strong></h4>\n<p>æºä»£ç å¯è‡ªç”±ä¼ æ’­<br>\næ¿€å‘åˆ›ä½œè€…çš„çƒ­æƒ…<br>\nå…è´¹ä½¿ç”¨é™ä½æˆæœ¬</p>\n<h4 id=\"å¼€æºè½¯ä»¶çš„ä¼˜åŠ¿-2\"><strong>å¼€æºè½¯ä»¶çš„ä¼˜åŠ¿</strong></h4>\n<p><strong>é‡‡è´­å’Œå¼€å‘çš„æˆæœ¬æ›´ä½</strong>ï¼šå¼€æºè½¯ä»¶é€šå¸¸æ˜¯å…è´¹çš„ï¼Œå³ä½¿è¦ä»˜è´¹ï¼Œå…¶è´¹ç”¨ä¹Ÿéå¸¸ä½å»‰<br>\n<strong>è½¯ä»¶è´¨é‡æ›´é«˜ã€æ›´å®‰å…¨</strong>ï¼šæ ¸å¿ƒä»£ç éƒ½åœ¨å…¬ä¼—çš„è§†é‡ä¹‹ä¸­ï¼Œä»£ç é—®é¢˜ï¼ˆå¦‚ç¼ºé™·ã€å®‰å…¨æ¼æ´ç­‰ï¼‰å¾ˆå®¹æ˜“è¢«äººå‘ç°<br>\n<strong>è½¯ä»¶ç ”åˆ¶å’Œäº¤ä»˜çš„æ›´å¿«</strong>ï¼šåŸºäºå¼€æºè½¯ä»¶çš„é¡¹ç›®å¼€å‘å¯ä»¥æ›´ä¸ºå¿«é€Ÿåœ°ç»™ç”¨æˆ·äº¤ä»˜è½¯ä»¶äº§å“<br>\n<strong>è½¯ä»¶åŠŸèƒ½æ›´ä¸ºå¼ºå¤§</strong>ï¼šå¤§é‡çš„è½¯ä»¶å¼€å‘è€…ä¸ä»…å‚ä¸è½¯ä»¶å¼€å‘ï¼Œè´¡çŒ®ä»–ä»¬çš„ä»£ç ï¼Œè€Œä¸”è¿˜å‚ä¸è½¯ä»¶çš„åˆ›æ–°ï¼Œæå‡ºå’Œæ„æ€è½¯ä»¶éœ€æ±‚ï¼Œä¸æ–­å®Œå–„è½¯ä»¶åŠŸèƒ½</p>\n<h3 id=\"è½¯ä»¶è´¨é‡è¦ç´ \">è½¯ä»¶è´¨é‡è¦ç´ </h3>\n<p>æ­£ç¡®æ€§ã€å¯é æ€§ã€å¥å£®æ€§ã€æœ‰æ•ˆæ€§ã€å®‰å…¨æ€§ã€å¯ç»´æŠ¤æ€§ã€å¯ç§»æ¤æ€§ã€å¯é‡ç”¨æ€§ã€å¯ç†è§£æ€§ã€å¯ä¿¡æ€§ã€æŒç»­æ€§ã€å¯ç”¨æ€§ã€äº’æ“ä½œæ€§ã€‚</p>\n<h2 id=\"2-è½¯ä»¶å·¥ç¨‹æ¦‚è¿°\">2 è½¯ä»¶å·¥ç¨‹æ¦‚è¿°</h2>\n<h3 id=\"è½¯ä»¶å±æœºçš„è¡¨ç°\">è½¯ä»¶å±æœºçš„è¡¨ç°</h3>\n<p>å¼€å‘æˆæœ¬é«˜<br>\nè¿›åº¦éš¾ä»¥æ§åˆ¶<br>\nè´¨é‡éš¾ä»¥ä¿è¯<br>\nè½¯ä»¶ç»´æŠ¤å›°éš¾<br>\nå¤±è´¥é£é™©å¾ˆå¤§</p>\n<h3 id=\"è½¯ä»¶å·¥ç¨‹çš„è¦ç´ \">è½¯ä»¶å·¥ç¨‹çš„è¦ç´ </h3>\n<p><img src=\"image.png\" alt=\"alt text\"></p>\n<h3 id=\"è½¯ä»¶å·¥ç¨‹çš„åŸåˆ™\">è½¯ä»¶å·¥ç¨‹çš„åŸåˆ™</h3>\n<p>æŠ½è±¡å’Œå»ºæ¨¡ã€æ¨¡å—åŒ–ã€è½¯ä»¶é‡ç”¨ã€ä¿¡æ¯éšè—ã€å…³æ³¨ç‚¹åˆ†ç¦»ã€åˆ†è€Œæ²»ä¹‹ã€åŒå‘è¿½è¸ªåŸåˆ™ã€å·¥å…·è¾…åŠ©ã€‚</p>\n<h2 id=\"3-1-è½¯ä»¶è¿‡ç¨‹æ¨¡å‹\">3.1 è½¯ä»¶è¿‡ç¨‹æ¨¡å‹</h2>\n<h3 id=\"å…¸å‹è½¯ä»¶è¿‡ç¨‹æ¨¡å‹\">å…¸å‹è½¯ä»¶è¿‡ç¨‹æ¨¡å‹</h3>\n<p><strong>ç€‘å¸ƒæ¨¡å‹ã€å¢é‡æ¨¡å‹ã€è¿­ä»£æ¨¡å‹ã€åŸå‹æ¨¡å‹ã€èºæ—‹æ¨¡å‹</strong>ã€åŸºäºæ„ä»¶çš„è¿‡ç¨‹æ¨¡å‹ã€UPæ¨¡å‹ã€‚</p>\n<h2 id=\"3-2-æ•æ·è½¯ä»¶å¼€å‘æ–¹æ³•\">3.2 æ•æ·è½¯ä»¶å¼€å‘æ–¹æ³•</h2>\n<h3 id=\"æ•æ·å¼€å‘çš„æ¦‚å¿µå’Œè§‚ç‚¹\">æ•æ·å¼€å‘çš„æ¦‚å¿µå’Œè§‚ç‚¹</h3>\n<h3 id=\"æ•æ·å‡†åˆ™\">æ•æ·å‡†åˆ™</h3>\n<h3 id=\"æ•æ·å¼€å‘ä»£è¡¨æ–¹æ³•\">æ•æ·å¼€å‘ä»£è¡¨æ–¹æ³•</h3>\n<h2 id=\"4-è½¯ä»¶éœ€æ±‚åˆ†æåŸºç¡€\">4 è½¯ä»¶éœ€æ±‚åˆ†æåŸºç¡€</h2>\n<h3 id=\"åˆ©ç›Šç›¸å…³æ–¹\">åˆ©ç›Šç›¸å…³æ–¹</h3>\n<h3 id=\"è½¯ä»¶éœ€æ±‚çš„ç±»åˆ«\">è½¯ä»¶éœ€æ±‚çš„ç±»åˆ«</h3>\n<h3 id=\"é¢å‘å¯¹è±¡çš„éœ€æ±‚åˆ†ææ–¹æ³•\">é¢å‘å¯¹è±¡çš„éœ€æ±‚åˆ†ææ–¹æ³•</h3>\n<h2 id=\"5-è·å–è½¯ä»¶éœ€æ±‚\">5 è·å–è½¯ä»¶éœ€æ±‚</h2>\n<h3 id=\"è·å–è½¯ä»¶éœ€æ±‚çš„æ–¹æ³•\">è·å–è½¯ä»¶éœ€æ±‚çš„æ–¹æ³•</h3>\n<h3 id=\"ç”¨ä¾‹å›¾\">ç”¨ä¾‹å›¾</h3>\n<h2 id=\"6-åˆ†æè½¯ä»¶éœ€æ±‚\">6 åˆ†æè½¯ä»¶éœ€æ±‚</h2>\n<h3 id=\"é¡ºåºå›¾\">é¡ºåºå›¾</h3>\n<h3 id=\"ç±»å›¾\">ç±»å›¾</h3>\n<h3 id=\"çŠ¶æ€å›¾\">çŠ¶æ€å›¾</h3>\n<h3 id=\"åˆ†æè½¯ä»¶éœ€æ±‚è¿‡ç¨‹\">åˆ†æè½¯ä»¶éœ€æ±‚è¿‡ç¨‹</h3>\n<h3 id=\"è½¯ä»¶éœ€æ±‚æ–‡æ¡£\">è½¯ä»¶éœ€æ±‚æ–‡æ¡£</h3>\n<h2 id=\"7-è½¯ä»¶è®¾è®¡åŸºç¡€\">7 è½¯ä»¶è®¾è®¡åŸºç¡€</h2>\n<h3 id=\"è½¯ä»¶è®¾è®¡çš„è´¨é‡è¦æ±‚\">è½¯ä»¶è®¾è®¡çš„è´¨é‡è¦æ±‚</h3>\n<h3 id=\"è½¯ä»¶è®¾è®¡åŸåˆ™\">è½¯ä»¶è®¾è®¡åŸåˆ™</h3>\n<h2 id=\"8-è½¯ä»¶ä½“ç³»ç»“æ„è®¾è®¡\">8 è½¯ä»¶ä½“ç³»ç»“æ„è®¾è®¡</h2>\n<h3 id=\"å¸¸ç”¨è½¯ä»¶ä½“ç³»ç»“æ„é£æ ¼\">å¸¸ç”¨è½¯ä»¶ä½“ç³»ç»“æ„é£æ ¼</h3>\n<h2 id=\"10-è½¯ä»¶è¯¦ç»†è®¾è®¡\">10 è½¯ä»¶è¯¦ç»†è®¾è®¡</h2>\n<h3 id=\"è¯¦ç»†è®¾è®¡è¿‡ç¨‹\">è¯¦ç»†è®¾è®¡è¿‡ç¨‹</h3>\n<h3 id=\"æ´»åŠ¨å›¾\">æ´»åŠ¨å›¾</h3>\n<h3 id=\"ç”¨ä¾‹è®¾è®¡\">ç”¨ä¾‹è®¾è®¡</h3>\n<h3 id=\"ç±»è®¾è®¡\">ç±»è®¾è®¡</h3>\n<h3 id=\"æ•°æ®è®¾è®¡\">æ•°æ®è®¾è®¡</h3>\n<h2 id=\"13-è½¯ä»¶æµ‹è¯•\">13 è½¯ä»¶æµ‹è¯•</h2>\n<h3 id=\"è½¯ä»¶æµ‹è¯•è¿‡ç¨‹\">è½¯ä»¶æµ‹è¯•è¿‡ç¨‹</h3>\n<h3 id=\"è½¯ä»¶æµ‹è¯•åŸåˆ™\">è½¯ä»¶æµ‹è¯•åŸåˆ™</h3>\n<h3 id=\"è½¯ä»¶æµ‹è¯•æŠ€æœ¯\">è½¯ä»¶æµ‹è¯•æŠ€æœ¯</h3>\n<h2 id=\"15-è½¯ä»¶ç»´æŠ¤å’Œæ¼”åŒ–\">15 è½¯ä»¶ç»´æŠ¤å’Œæ¼”åŒ–</h2>\n<h3 id=\"è½¯ä»¶ç»´æŠ¤çš„å½¢å¼\">è½¯ä»¶ç»´æŠ¤çš„å½¢å¼</h3>\n<h3 id=\"è½¯ä»¶ç»´æŠ¤æŠ€æœ¯\">è½¯ä»¶ç»´æŠ¤æŠ€æœ¯</h3>\n","tags":["å¤ä¹ ","è½¯ä»¶å·¥ç¨‹"]},{"title":"Pythonçˆ¬è™«","url":"/post/c386cf1b.html","content":"<h1>å‰è¨€</h1>\n<p>ç”±äºä¸“ä¸šé€‰ä¿®å¤§æ•°æ®çš„ç»“è¯¾å°ç»„ä½œä¸šé‡Œï¼Œæœ‰ä¸€ä¸ªçˆ¬è™«çš„åˆ†å·¥ï¼Œæˆ‘è‡ªå‘Šå¥‹å‹‡é€‰æ‹©è¿™éƒ¨åˆ†å·¥ä½œï¼Œå¸Œæœ›ä»¥æ­¤ä½œä¸ºåŠ¨åŠ›è®©è‡ªå·±å­¦ä¹ ä¸€ä¸‹æ—©å°±å¬è¯´ä½†ä¸€ç›´æ²¡æœ‰å»åšçš„çˆ¬è™«å·¥ä½œï¼Œè¿™é‡Œå°±æŠŠå­¦ä¹ åˆ°çš„éƒ¨åˆ†ä»¥åŠä½œä¸šè¿‡ç¨‹é‡Œçš„ä¸€äº›ç»éªŒå’Œä»£ç åˆ†äº«ä¸€ä¸‹ï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®åŠ©åˆ°éœ€è¦çˆ¬å–<strong>Bç«™</strong>ï¼Œ<strong>çŸ¥ä¹</strong>å’Œ<strong>å¾®åš</strong>æ•°æ®çš„äººä»¬ã€‚</p>\n<p>è¿‡ç¨‹ä¸­å‚è€ƒäº†ä¸€äº›æ–‡ç« ï¼Œä»¥ä¸‹3ä¸ªé“¾æ¥æ˜¯æºä»£ç çš„æ¥æºï¼š<br>\n<a href=\"https://zhuanlan.zhihu.com/p/587307689\" title=\"çŸ¥ä¹çˆ¬è™«\">çŸ¥ä¹çˆ¬è™«</a><br>\n<a href=\"https://gitcode.com/gh_mirrors/bi/Bilivideoinfo\" title=\"Bç«™çˆ¬è™«\">Bç«™çˆ¬è™«</a><br>\n<a href=\"https://blog.csdn.net/m0_46235332/article/details/122682412\" title=\"å¾®åšçˆ¬è™«\">å¾®åšçˆ¬è™«</a></p>\n<p>æ‰€æœ‰çš„å®Œæ•´æºç æ”¾åœ¨æˆ‘çš„Githubä»“åº“é‡Œ<br>\n<a href=\"https://github.com/FunTotal/Crawler\" title=\"çˆ¬è™«å®Œæ•´ä»£ç Githubé“¾æ¥\">çˆ¬è™«å®Œæ•´ä»£ç Githubé“¾æ¥</a></p>\n<h1>åŸºç¡€çŸ¥è¯†</h1>\n<p>å¦‚æœæœ‰å­¦ä¹ è¿‡è®¡ç®—æœºç½‘ç»œçš„è¯ï¼Œåº”è¯¥ä¼šå¯¹æµè§ˆå™¨çš„åŸç†æœ‰ä¸€äº›åŸºæœ¬äº†è§£ã€‚ï¼ˆä¸‹é¢è¿™äº›æ˜¯æˆ‘å‡­è‡ªå·±çš„è®¤è¯†è¯´çš„ï¼Œä¸ä¸€å®šä¿çœŸï¼‰æµè§ˆå™¨åœ¨è®¿é—®ç½‘å€æ—¶ï¼Œä¼šå‘é€æ•°æ®åŒ…ï¼ŒæœåŠ¡å™¨æ¥æ”¶è¯·æ±‚åå°±ä¼šæŠŠç½‘ç«™çš„HTMLä»£ç å‘è¿‡æ¥ï¼Œæœ€åæˆ‘ä»¬çœ‹åˆ°çš„æ•ˆæœæ˜¯è¿™æ®µHTMLä»£ç æ¸²æŸ“åçš„ç»“æœï¼Œå½“ç„¶æˆ‘ä»¬éœ€è¦çš„ä¿¡æ¯è‚¯å®šä¹ŸåŒ…å«æ­£åœ¨è¿™æ®µHTMLä»£ç é‡Œã€‚</p>\n<p>è€Œçˆ¬è™«å°±æ˜¯æ¨¡æ‹Ÿæµè§ˆå™¨ï¼Œå¿«é€Ÿå‘éœ€è¦çš„ç½‘é¡µå‘é€è¯·æ±‚ï¼Œæ¥å—HTMLä»£ç åç›´æ¥ä»é‡Œé¢æå–éœ€è¦çš„ä¿¡æ¯ï¼Œä¹‹åç»§ç»­å‘ä¸‹ä¸€ä¸ªç½‘é¡µå‘é€è¯·æ±‚ã€‚æ‰€ä»¥å®é™…ä¸Šçˆ¬è™«èƒ½çˆ¬å–åˆ°çš„ä¿¡æ¯ï¼Œä»äººå·¥è§’åº¦ä¹Ÿéƒ½æ˜¯æ‰‹åŠ¨èƒ½çœ‹åˆ°çš„ä¿¡æ¯ã€‚ä½†æ˜¯ç”±äºçˆ¬è™«å› ä¸ºé€Ÿåº¦è¿œå¿«äºçœŸå®çš„äººç±»ï¼Œæ‰€ä»¥ä¼šå¯¹ç½‘ç«™é€ æˆè´Ÿæ‹…ï¼Œæ‰€ä»¥å¤§éƒ¨åˆ†çš„ç½‘ç«™éƒ½æ˜¯ä¸æ”¯æŒçˆ¬è™«è¿™ç§è¡Œä¸ºï¼Œå½“ç„¶æˆ‘ä»¬åœ¨çˆ¬è™«çš„è¿‡ç¨‹ä¹Ÿä¼šé€šè¿‡ä¼ªè£…ï¼Œè®©ç½‘ç«™çœ‹ä¸å‡ºæ¥æˆ‘ä»¬æ˜¯çˆ¬è™«ã€‚è€Œä¸”çˆ¬è™«çš„æ—¶å€™è¿˜è¦æ³¨æ„éµå®ˆæ³•å¾‹ï¼Œä¸è¦åšè¿æ³•çš„äº‹æƒ…ã€‚</p>\n<h2 id=\"Cookie\">Cookie</h2>\n<h3 id=\"Cookieä»‹ç»\">Cookieä»‹ç»</h3>\n<p>ç„¶åæ˜¯å¤§éƒ¨åˆ†ç½‘ç«™çš„çˆ¬è™«éƒ½éœ€è¦æˆ‘ä»¬æä¾›ä¸€ä¸ªCookieæ‰èƒ½è¿›è¡Œçˆ¬å–ï¼ŒCookieåœ¨æˆ‘çš„ç†è§£é‡Œå°±æ˜¯ç½‘ç«™ç™»å½•è´¦å·åçš„å‡­è¯ï¼Œæœ‰äº†Cookieåå¯¹ç½‘é¡µå‘é€è¯·æ±‚ï¼Œåœ¨ç½‘é¡µçš„è§†è§’ä¸Šçœ‹å°±æ˜¯ä¸€ä¸ªç™»å½•è´¦å·çš„ç”¨æˆ·å‘é€çš„è¯·æ±‚ã€‚ä¸ç„¶ç°åœ¨å¾ˆå¤šç½‘ç«™éƒ½æœ‰ç™»å½•æ‰èƒ½æŸ¥çœ‹å®Œæ•´å†…å®¹çš„é™åˆ¶ï¼Œæ²¡æœ‰Cookieå°±çˆ¬å–ä¸äº†ï¼Œè€Œä¸”æŸç§ç¨‹åº¦ä¸Šéœ€è¦Cookieä¹Ÿèµ·åˆ°äº†åçˆ¬è™«çš„æ•ˆæœã€‚</p>\n<h3 id=\"CookieæŸ¥çœ‹\">CookieæŸ¥çœ‹</h3>\n<p>é‚£ä¹ˆè¦å¦‚ä½•æŸ¥çœ‹è‡ªå·±çš„Cookieï¼Œé¦–å…ˆåœ¨æµè§ˆå™¨ï¼ˆæˆ‘ä»¥EDGEæµè§ˆå™¨ä¸ºä¾‹ï¼‰æ‰“å¼€ç›®æ ‡ç½‘ç«™åæŒ‰ä¸‹F12å¯åŠ¨å¼€å‘è€…æ¨¡å¼ï¼Œç„¶åé€‰æ‹©<strong>ç½‘ç»œ</strong>ä¸€æ ï¼Œå¹¶ä¸”æ³¨æ„<strong>ç¦ç”¨ç¼“å­˜</strong>ã€‚<br>\n<a href=\"./Python%E7%88%AC%E8%99%AB%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93_Bilibili%EF%BC%8C%E7%9F%A5%E4%B9%8E%EF%BC%8C%E5%BE%AE%E5%8D%9A%20-%20TJUHuangTao%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/3483649-20250120110442096-862140735.png\"><img src=\"./Python%E7%88%AC%E8%99%AB%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93_Bilibili%EF%BC%8C%E7%9F%A5%E4%B9%8E%EF%BC%8C%E5%BE%AE%E5%8D%9A%20-%20TJUHuangTao%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/3483649-20250120110442096-862140735.png\" alt=\"\"></a><br>\næ­¤æ—¶æµè§ˆå™¨å°±å¯ä»¥è¿›å…¥ç±»ä¼¼Wiresharkä¸€æ ·çš„æŠ“åŒ…æ¨¡å¼ï¼Œå†æ¬¡<strong>æŒ‰ä¸‹F5åˆ·æ–°ç½‘é¡µ</strong>ï¼Œå°±èƒ½å¤Ÿçœ‹åˆ°æµè§ˆå™¨æ•è·äº†å¾ˆå¤šçš„æ•°æ®åŒ…ï¼Œåœ¨ç­›é€‰å™¨ä¸€æ é€‰ä¸­<strong>Fetch/XHR</strong>åï¼Œéšä¾¿ç‚¹å‡ ä¸ªåŒ…ï¼Œå¾€ä¸‹æ‹‰å°±èƒ½å¤Ÿçœ‹åˆ°åœ¨è¯·æ±‚æ ‡å¤´é‡Œä¼šæœ‰Cookieå­—æ®µã€‚<br>\n<a href=\"./Python%E7%88%AC%E8%99%AB%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93_Bilibili%EF%BC%8C%E7%9F%A5%E4%B9%8E%EF%BC%8C%E5%BE%AE%E5%8D%9A%20-%20TJUHuangTao%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/3483649-20250120110731085-1650259284.png\"><img src=\"./Python%E7%88%AC%E8%99%AB%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93_Bilibili%EF%BC%8C%E7%9F%A5%E4%B9%8E%EF%BC%8C%E5%BE%AE%E5%8D%9A%20-%20TJUHuangTao%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/3483649-20250120110731085-1650259284.png\" alt=\"\"></a><br>\nä¸Šå›¾ä¸­é©¬èµ›å…‹æ‰çš„ä¸€å¤§æ®µå°±æ˜¯çŸ¥ä¹çš„Cookieï¼ˆCookieæ˜¯æœ‰éšç§æ€§çš„ï¼Œæ‹¥æœ‰åˆ«äººçš„Cookieç›¸å½“äºç™»å½•åˆ«äººçš„è´¦å·ï¼Œæ‰€ä»¥Cookieéœ€è¦ä¿æŠ¤å¥½ï¼Œä¸èƒ½åœ¨ç½‘ä¸Šæš´éœ²ï¼‰<br>\nå¦‚æœå†ä¸‹æ‹‰ï¼Œè¿˜èƒ½çœ‹åˆ°UAå­—æ®µ<br>\n<a href=\"./Python%E7%88%AC%E8%99%AB%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93_Bilibili%EF%BC%8C%E7%9F%A5%E4%B9%8E%EF%BC%8C%E5%BE%AE%E5%8D%9A%20-%20TJUHuangTao%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/3483649-20250120112912925-619349750.png\"><img src=\"./Python%E7%88%AC%E8%99%AB%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93_Bilibili%EF%BC%8C%E7%9F%A5%E4%B9%8E%EF%BC%8C%E5%BE%AE%E5%8D%9A%20-%20TJUHuangTao%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/3483649-20250120112912925-619349750.png\" alt=\"\"></a><br>\nè¿™ä¸ªå°±ä»£è¡¨ç€ä½ çš„ç”µè„‘çš„ä¿¡æ¯ï¼Œæ‰€ä»¥åœ¨çˆ¬è™«çš„æ—¶å€™ï¼Œä¸€èˆ¬ä¹Ÿä¼šé™„ä¸Šè¿™ä¸ªä¿¡æ¯ï¼Œæ¥ä¼ªè£…çš„æ›´åƒä¸€ä¸ªæµè§ˆå™¨ï¼Œä¸ºäº†è£…çš„æ›´åƒä¸€ç‚¹ï¼Œå¯ä»¥å¤šå‡†å¤‡å‡ ä¸ªUAï¼Œæ¯æ¬¡çˆ¬è™«çš„æ—¶å€™éšæœºé€‰å–ä¸€ä¸ªï¼Œèƒ½å¤Ÿä¼ªè£…çš„æ›´å¥½ã€‚</p>\n<h1>Bilibili</h1>\n<h2 id=\"åŠŸèƒ½\">åŠŸèƒ½</h2>\n<p>éœ€è¦è‡ªå·±å‡†å¤‡å¸Œæœ›çˆ¬å–çš„é“¾æ¥ä»£ç ï¼Œå¯ä»¥çˆ¬å–å¯¹åº”é“¾æ¥è§†é¢‘çš„æ ‡é¢˜ã€æ ‡ç­¾ã€ä½œè€…ã€æ’­æ”¾é‡ã€ç‚¹èµæŠ•å¸æ”¶è—ç­‰æ•°æ®ï¼Œä¸éœ€è¦Cookieã€‚</p>\n<h2 id=\"ä»‹ç»\">ä»‹ç»</h2>\n<p>çˆ¬å–Bç«™è§†é¢‘æˆ‘é‡‡ç”¨çš„æ˜¯ä¸‹é¢ä»“åº“åœ°å€çš„æºä»£ç <br>\n<a href=\"https://gitcode.com/gh_mirrors/bi/Bilivideoinfo\" title=\"Bç«™çˆ¬è™«\">Bç«™çˆ¬è™«</a><br>\nå®ƒéœ€è¦ä½ å…ˆå‡†å¤‡å¥½ä¸€ä¸ªæ–‡ä»¶ï¼Œé‡Œé¢æ˜¯éœ€è¦çˆ¬å–çš„Bç«™é“¾æ¥ï¼Œä¹‹åè¿è¡Œä»£ç å°±å¯ä»¥çˆ¬å–è¿™äº›é“¾æ¥çš„å¾ˆå¤šä¿¡æ¯ï¼Œå¹¶ä¸”çˆ¬å–å¤±è´¥çš„ä¹Ÿä¼šè®°å½•ä¸‹æ¥å“ªäº›å¤±è´¥äº†ã€‚<br>\n<a href=\"./Python%E7%88%AC%E8%99%AB%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93_Bilibili%EF%BC%8C%E7%9F%A5%E4%B9%8E%EF%BC%8C%E5%BE%AE%E5%8D%9A%20-%20TJUHuangTao%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/3483649-20250120113509501-1345055223.png\"><img src=\"./Python%E7%88%AC%E8%99%AB%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93_Bilibili%EF%BC%8C%E7%9F%A5%E4%B9%8E%EF%BC%8C%E5%BE%AE%E5%8D%9A%20-%20TJUHuangTao%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/3483649-20250120113509501-1345055223.png\" alt=\"\"></a></p>\n<p>é‚£ä¹ˆæ€ä¹ˆå‡†å¤‡å¾…çˆ¬å–é“¾æ¥ï¼Œæˆ‘çš„åšæ³•æ˜¯å»Githubä¸Šæ‰¾ä¸€ä¸‹åˆ«äººå¤‡ä»½çš„Bç«™çƒ­é—¨æ¦œå†å²æ•°æ®ï¼Œé‡Œé¢æœ‰è®°å½•æ¯ä¸€å¤©Bç«™çƒ­é—¨è§†é¢‘çš„é“¾æ¥ï¼Œç„¶åæŠŠé‚£äº›é“¾æ¥æå–åˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œï¼Œä¹‹åå°±å¯ä»¥è¿›è¡Œçˆ¬å–ã€‚</p>\n<h2 id=\"ä»£ç \">ä»£ç </h2>\n<p>ç‚¹å‡»æŸ¥çœ‹ä»£ç </p>\n<p>**</p>\n<p>highlighter- python</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">import re</span><br><span class=\"line\">import requests</span><br><span class=\"line\">from bs4 import BeautifulSoup</span><br><span class=\"line\">from openpyxl import Workbook</span><br><span class=\"line\">import random</span><br><span class=\"line\">import time</span><br><span class=\"line\"></span><br><span class=\"line\">def write_error_log(message):</span><br><span class=\"line\">    with open(&quot;video_errorlist.txt&quot;, &quot;a&quot;) as file:</span><br><span class=\"line\">        file.write(message + &quot;\\n&quot;)</span><br><span class=\"line\"></span><br><span class=\"line\">def is_url(video_id_or_url):</span><br><span class=\"line\">    return video_id_or_url.startswith(&quot;http&quot;) or video_id_or_url.startswith(&quot;https&quot;)</span><br><span class=\"line\"></span><br><span class=\"line\">def get_video_url(video_id_or_url):</span><br><span class=\"line\">    if is_url(video_id_or_url):</span><br><span class=\"line\">        return video_id_or_url</span><br><span class=\"line\">    else:</span><br><span class=\"line\">        return f&quot;https://www.bilibili.com/video/&#123;video_id_or_url&#125;&quot;</span><br><span class=\"line\"></span><br><span class=\"line\"># åçˆ¬è™«</span><br><span class=\"line\">agent = [</span><br><span class=\"line\">            &#x27;Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_8; en-us) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/5.0 (Windows; U; Windows NT 6.1; en-us) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0)&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:2.0.1) Gecko/20100101 Firefox/4.0.1&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/5.0 (Windows NT 6.1; rv:2.0.1) Gecko/20100101 Firefox/4.0.1&#x27;,</span><br><span class=\"line\">            &#x27;Opera/9.80 (Macintosh; Intel Mac OS X 10.6.8; U; en) Presto/2.8.131 Version/11.11&#x27;,</span><br><span class=\"line\">            &#x27;Opera/9.80 (Windows NT 6.1; U; en) Presto/2.8.131 Version/11.11&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_0) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.56 Safari/535.11&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Maxthon 2.0)&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; TencentTraveler 4.0)&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; The World)&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; SE 2.X MetaSr 1.0; SE 2.X MetaSr 1.0; .NET CLR 2.0.50727; SE 2.X MetaSr 1.0)&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)&#x27;</span><br><span class=\"line\">            &#x27;Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.72 Mobile Safari/537.36&#x27;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">ua = random.choice(agent)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">headers = &#123;</span><br><span class=\"line\">    &#x27;user-agent&#x27;: ua,#UserAgent().chrome,</span><br><span class=\"line\">    &#x27;Referer&#x27;:&#x27;https://www.bilibili.com/&#x27;,</span><br><span class=\"line\">    &#x27;x-requested-with&#x27;: &#x27;XMLHttpRequest&#x27;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">input_file = &quot;idlist.txt&quot; #å¾…çˆ¬å–é“¾æ¥å­˜åœ¨è¿™ä¸ªæ–‡ä»¶é‡Œ</span><br><span class=\"line\">output_file = &quot;output.xlsx&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">new_wb = Workbook()</span><br><span class=\"line\">new_ws = new_wb.active</span><br><span class=\"line\">new_ws.append(</span><br><span class=\"line\">    [&quot;æ ‡é¢˜&quot;, &quot;é“¾æ¥&quot;, &quot;upä¸»&quot;, &quot;upä¸»id&quot;, &quot;ç²¾ç¡®æ’­æ”¾æ•°&quot;, &quot;å†å²ç´¯è®¡å¼¹å¹•æ•°&quot;, &quot;ç‚¹èµæ•°&quot;, &quot;æŠ•ç¡¬å¸æšæ•°&quot;, &quot;æ”¶è—äººæ•°&quot;, &quot;è½¬å‘äººæ•°&quot;,</span><br><span class=\"line\">     &quot;å‘å¸ƒæ—¶é—´&quot;, &quot;è§†é¢‘æ—¶é•¿(ç§’)&quot;, &quot;è§†é¢‘ç®€ä»‹&quot;, &quot;ä½œè€…ç®€ä»‹&quot;, &quot;æ ‡ç­¾&quot;, &quot;è§†é¢‘aid&quot;])</span><br><span class=\"line\"></span><br><span class=\"line\">with open(input_file, &quot;r&quot;) as file:</span><br><span class=\"line\">    id_list = file.readlines()</span><br><span class=\"line\"></span><br><span class=\"line\">i = 0</span><br><span class=\"line\">for video_id_or_url in id_list:</span><br><span class=\"line\">    i += 1</span><br><span class=\"line\">    url = get_video_url(video_id_or_url.strip())</span><br><span class=\"line\">    try:</span><br><span class=\"line\">        # time.sleep(1)</span><br><span class=\"line\">        response = requests.get(url, headers=headers)</span><br><span class=\"line\">        soup = BeautifulSoup(response.text, &quot;html.parser&quot;)</span><br><span class=\"line\"></span><br><span class=\"line\">        # è§†é¢‘ aidã€è§†é¢‘æ—¶é•¿å’Œä½œè€… id</span><br><span class=\"line\">        initial_state_script = soup.find(&quot;script&quot;, text=re.compile(&quot;window.__INITIAL_STATE__&quot;))</span><br><span class=\"line\">        initial_state_text = initial_state_script.string</span><br><span class=\"line\"></span><br><span class=\"line\">        author_id_pattern = re.compile(r&#x27;&quot;mid&quot;:(\\d+)&#x27;)</span><br><span class=\"line\">        video_aid_pattern = re.compile(r&#x27;&quot;aid&quot;:(\\d+)&#x27;)</span><br><span class=\"line\">        video_duration_pattern = re.compile(r&#x27;&quot;duration&quot;:(\\d+)&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">        author_id = author_id_pattern.search(initial_state_text).group(1)</span><br><span class=\"line\">        video_aid = video_aid_pattern.search(initial_state_text).group(1)</span><br><span class=\"line\">        video_duration_raw = int(video_duration_pattern.search(initial_state_text).group(1))</span><br><span class=\"line\">        video_duration = video_duration_raw - 2</span><br><span class=\"line\"></span><br><span class=\"line\">        # æå–æ ‡é¢˜</span><br><span class=\"line\">        title_raw = soup.find(&quot;title&quot;).text</span><br><span class=\"line\">        title = re.sub(r&quot;_å“”å“©å“”å“©_bilibili&quot;, &quot;&quot;, title_raw).strip()</span><br><span class=\"line\"></span><br><span class=\"line\">        # æå–æ ‡ç­¾</span><br><span class=\"line\">        keywords_content = soup.find(&quot;meta&quot;, itemprop=&quot;keywords&quot;)[&quot;content&quot;]</span><br><span class=\"line\">        content_without_title = keywords_content.replace(title + &#x27;,&#x27;, &#x27;&#x27;)</span><br><span class=\"line\">        keywords_list = content_without_title.split(&#x27;,&#x27;)</span><br><span class=\"line\">        tags = &quot;,&quot;.join(keywords_list[:-4])</span><br><span class=\"line\"></span><br><span class=\"line\">        meta_description = soup.find(&quot;meta&quot;, itemprop=&quot;description&quot;)[&quot;content&quot;]</span><br><span class=\"line\">        numbers = re.findall(</span><br><span class=\"line\">            r&#x27;[\\s\\S]*?è§†é¢‘æ’­æ”¾é‡ (\\d+)ã€å¼¹å¹•é‡ (\\d+)ã€ç‚¹èµæ•° (\\d+)ã€æŠ•ç¡¬å¸æšæ•° (\\d+)ã€æ”¶è—äººæ•° (\\d+)ã€è½¬å‘äººæ•° (\\d+)&#x27;,</span><br><span class=\"line\">            meta_description)</span><br><span class=\"line\"></span><br><span class=\"line\">        # æå–ä½œè€…</span><br><span class=\"line\">        author_search = re.search(r&quot;è§†é¢‘ä½œè€…\\s*([^,]+)&quot;, meta_description)</span><br><span class=\"line\">        if author_search:</span><br><span class=\"line\">            author = author_search.group(1).strip()</span><br><span class=\"line\">        else:</span><br><span class=\"line\">            author = &quot;æœªæ‰¾åˆ°ä½œè€…&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">        # æå–ä½œè€…ç®€ä»‹</span><br><span class=\"line\">        author_desc_pattern = re.compile(r&#x27;ä½œè€…ç®€ä»‹ (.+?),&#x27;)</span><br><span class=\"line\">        author_desc_match = author_desc_pattern.search(meta_description)</span><br><span class=\"line\">        if author_desc_match:</span><br><span class=\"line\">            author_desc = author_desc_match.group(1)</span><br><span class=\"line\">        else:</span><br><span class=\"line\">            author_desc = &quot;æœªæ‰¾åˆ°ä½œè€…ç®€ä»‹&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">        # æå–è§†é¢‘ç®€ä»‹</span><br><span class=\"line\">        meta_parts = re.split(r&#x27;,\\s*&#x27;, meta_description)</span><br><span class=\"line\">        if meta_parts:</span><br><span class=\"line\">            video_desc = meta_parts[0].strip()</span><br><span class=\"line\">        else:</span><br><span class=\"line\">            video_desc = &quot;æœªæ‰¾åˆ°è§†é¢‘ç®€ä»‹&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">        if numbers:</span><br><span class=\"line\">            views, danmaku, likes, coins, favorites, shares = [int(n) for n in numbers[0]]</span><br><span class=\"line\">            publish_date = soup.find(&quot;meta&quot;, itemprop=&quot;uploadDate&quot;)[&quot;content&quot;]</span><br><span class=\"line\">            new_ws.append([title, url, author, author_id, views, danmaku, likes, coins, favorites, shares, publish_date, video_duration, video_desc, author_desc, tags, video_aid])</span><br><span class=\"line\">            print(f&quot;ç¬¬&#123;i&#125;è¡Œè§†é¢‘&#123;url&#125;å·²å®Œæˆçˆ¬å–&quot;)</span><br><span class=\"line\">        else:</span><br><span class=\"line\">            print(f&quot;ç¬¬&#123;i&#125;è¡Œè§†é¢‘ &#123;url&#125;æœªæ‰¾åˆ°ç›¸å…³æ•°æ®ï¼Œå¯èƒ½ä¸ºåˆ†é›†è§†é¢‘&quot;)</span><br><span class=\"line\"></span><br><span class=\"line\">    except Exception as e:</span><br><span class=\"line\">        write_error_log(f&quot;ç¬¬&#123;i&#125;è¡Œè§†é¢‘å‘ç”Ÿé”™è¯¯ï¼š&#123;e&#125;&quot;)</span><br><span class=\"line\">        print(f&quot;ç¬¬&#123;i&#125;è¡Œå‘ç”Ÿé”™è¯¯ï¼Œå·²è®°å½•åˆ°é”™è¯¯æ—¥å¿—:å‡ºé”™æ•°æ®ä¸º&#123;video_id_or_url&#125;&quot;)</span><br><span class=\"line\"></span><br><span class=\"line\">new_wb.save(output_file)</span><br></pre></td></tr></table></figure>\n<h1>çŸ¥ä¹</h1>\n<h2 id=\"åŠŸèƒ½-2\">åŠŸèƒ½</h2>\n<p>çˆ¬å–ä¸€ä¸ªé—®é¢˜ä¸‹çš„å›ç­”å†…å®¹å’Œå›ç­”çš„åˆ›å»ºæ—¶é—´</p>\n<h2 id=\"ä»‹ç»-2\">ä»‹ç»</h2>\n<p>çŸ¥ä¹çš„çˆ¬å–æ˜¯ä¾æ®ä»¥ä¸‹é“¾æ¥æ–‡ç« é‡Œçš„æ•™ç¨‹<br>\n<a href=\"https://zhuanlan.zhihu.com/p/587307689\" title=\"çŸ¥ä¹çˆ¬è™«\">çŸ¥ä¹çˆ¬è™«</a><br>\nå¤§è‡´æ€è·¯æ˜¯å‘ç°çŸ¥ä¹çš„å›ç­”é‡Œä¼šæœ‰ä¸€ä¸ªåŒ…ï¼ŒæŒ‡å‘ä¸‹ä¸€ä¸ªå›ç­”çš„idï¼Œå°±ç±»ä¼¼é“¾è¡¨ä¸€æ ·ï¼Œä»ä¸€ä¸ªåˆå§‹çš„é“¾æ¥å¼€å§‹ï¼Œä¸æ–­åœ°æŠŠä¸‹ä¸€ä¸ªå›ç­”çš„idå­˜èµ·æ¥ï¼Œå°±æŠŠé—®é¢˜ä¸‹çš„å›ç­”çš„idéƒ½è®°å½•ä¸‹æ¥ï¼Œä¹‹åå†æ ¹æ®è¿™äº›idçˆ¬å–å¯¹åº”çš„å›ç­”å†…å®¹ã€‚<br>\nå…·ä½“çš„ï¼Œåˆ†ä¸ºä¸¤ä¸ªæ–‡ä»¶ï¼Œç¬¬ä¸€ä¸ªcrawler.pyå°±æ˜¯è®°å½•answer_idï¼Œç¬¬äºŒä¸ªcrawler2.pyæ˜¯æ ¹æ®answer_idçˆ¬å–å†…å®¹ï¼Œä¸‹é¢ä¼šä»‹ç»ä¸€ä¸‹å…·ä½“æ€ä¹ˆä¿®æ”¹ä»£ç æ¥çˆ¬å–éœ€è¦çš„å†…å®¹ã€‚</p>\n<h2 id=\"éœ€è¦ä¿®æ”¹çš„å†…å®¹\">éœ€è¦ä¿®æ”¹çš„å†…å®¹</h2>\n<p>é¦–å…ˆæ˜¯crawler.pyé‡Œçš„template<br>\n<a href=\"./Python%E7%88%AC%E8%99%AB%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93_Bilibili%EF%BC%8C%E7%9F%A5%E4%B9%8E%EF%BC%8C%E5%BE%AE%E5%8D%9A%20-%20TJUHuangTao%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/3483649-20250120115908028-348043365.png\"><img src=\"./Python%E7%88%AC%E8%99%AB%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93_Bilibili%EF%BC%8C%E7%9F%A5%E4%B9%8E%EF%BC%8C%E5%BE%AE%E5%8D%9A%20-%20TJUHuangTao%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/3483649-20250120115908028-348043365.png\" alt=\"\"></a></p>\n<p>éœ€è¦åœ¨å¾…çˆ¬å–é—®é¢˜ï¼Œç±»ä¼¼æ‰¾Cookieä¸€æ ·ï¼Œæ‰¾åˆ°ä¸‹é¢è¿™ä¸ªåŒ… feeds?..è¿™ä¸ªåŒ…ï¼Œé‡Œé¢çš„è¯·æ±‚URLæ›¿æ¢æ‰crawler.pyé‡Œçš„templateã€‚<br>\n<a href=\"./Python%E7%88%AC%E8%99%AB%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93_Bilibili%EF%BC%8C%E7%9F%A5%E4%B9%8E%EF%BC%8C%E5%BE%AE%E5%8D%9A%20-%20TJUHuangTao%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/3483649-20250120114629184-286111761.png\"><img src=\"./Python%E7%88%AC%E8%99%AB%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93_Bilibili%EF%BC%8C%E7%9F%A5%E4%B9%8E%EF%BC%8C%E5%BE%AE%E5%8D%9A%20-%20TJUHuangTao%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/3483649-20250120114629184-286111761.png\" alt=\"\"></a></p>\n<p>è®°å¾—ç½‘å€é‡Œé¢çš„offset=åé¢è¦åŠ ä¸€ä¸ª{offset}ï¼Œå°±æ˜¯æ¨¡ä»¿ä¹‹å‰å†™åœ¨é‚£é‡Œçš„æ ¼å¼<br>\n<a href=\"./Python%E7%88%AC%E8%99%AB%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93_Bilibili%EF%BC%8C%E7%9F%A5%E4%B9%8E%EF%BC%8C%E5%BE%AE%E5%8D%9A%20-%20TJUHuangTao%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/3483649-20250120120257903-1894029061.png\"><img src=\"./Python%E7%88%AC%E8%99%AB%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93_Bilibili%EF%BC%8C%E7%9F%A5%E4%B9%8E%EF%BC%8C%E5%BE%AE%E5%8D%9A%20-%20TJUHuangTao%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/3483649-20250120120257903-1894029061.png\" alt=\"\"></a></p>\n<p>ç„¶åæ˜¯ä»£ç é‡Œçš„Cookieæ›¿æ¢ä¸ºè‡ªå·±çŸ¥ä¹çš„Cookieï¼Œè´´åœ¨å•å¼•å·é‡Œé¢<br>\n<a href=\"./Python%E7%88%AC%E8%99%AB%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93_Bilibili%EF%BC%8C%E7%9F%A5%E4%B9%8E%EF%BC%8C%E5%BE%AE%E5%8D%9A%20-%20TJUHuangTao%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/3483649-20250120120403580-3517804.png\"><img src=\"./Python%E7%88%AC%E8%99%AB%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93_Bilibili%EF%BC%8C%E7%9F%A5%E4%B9%8E%EF%BC%8C%E5%BE%AE%E5%8D%9A%20-%20TJUHuangTao%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/3483649-20250120120403580-3517804.png\" alt=\"\"></a></p>\n<p>æœ€åæŠŠä»£ç é‡Œheadersé‡Œçš„referä¹Ÿæ¢ä¸€ä¸‹ï¼ˆè¿™ä¸ªå¥½åƒä¸æ¢ä¹Ÿè¡Œï¼Œä½†æˆ‘æ˜¯æ¢äº†ï¼‰ï¼Œreferå­—æ®µå°±åœ¨Cookieä¸‹é¢ä¸€ç‚¹<br>\n<a href=\"./Python%E7%88%AC%E8%99%AB%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93_Bilibili%EF%BC%8C%E7%9F%A5%E4%B9%8E%EF%BC%8C%E5%BE%AE%E5%8D%9A%20-%20TJUHuangTao%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/3483649-20250120120550647-1354037006.png\"><img src=\"./Python%E7%88%AC%E8%99%AB%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93_Bilibili%EF%BC%8C%E7%9F%A5%E4%B9%8E%EF%BC%8C%E5%BE%AE%E5%8D%9A%20-%20TJUHuangTao%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/3483649-20250120120550647-1354037006.png\" alt=\"\"></a></p>\n<p>**</p>\n<p>highlighter- 1c</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">headers = &#123;</span><br><span class=\"line\">    &#x27;cookie&#x27; : cookie,</span><br><span class=\"line\">    &#x27;user-agent&#x27;: ua,#UserAgent().chrome,</span><br><span class=\"line\">    &#x27;Referer&#x27;:&#x27;https://www.zhihu.com/question/654859896/answer/3487198664&#x27;,</span><br><span class=\"line\">    &#x27;x-requested-with&#x27;: &#x27;XMLHttpRequest&#x27;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ä¹‹åå°±å¯ä»¥çˆ¬å–ï¼Œå¯¹äºä¿å­˜ä¿¡æ¯æ–¹é¢ï¼Œå®æµ‹çŸ¥ä¹çš„åçˆ¬æœ‰ç‚¹å¼ºï¼Œçˆ¬ä¸ªä¸¤ç™¾å¤šé¢å°±æç¤ºè¯´å¯¹æ–¹ä¸»æœºå¼ºåˆ¶æ–­å¼€è¿æ¥ï¼Œæ‰€ä»¥å¯ä»¥åœ¨ä»£ç è®¾ç½®ä¸€ä¸‹æ¯çˆ¬å–è‹¥å¹²é¡µå°±ä¿å­˜ä¸€æ¬¡ã€‚</p>\n<p>**</p>\n<p>highlighter- reasonml</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\"># æ¯éš”100æ¡ä¿å­˜ä¸€æ¬¡ä¿¡æ¯</span><br><span class=\"line\">if (page % 100 == 0):</span><br><span class=\"line\">    df = pd.DataFrame(&#123;&#x27;answer_id&#x27;: answer_ids&#125;)  # é‡æ–°åˆ›å»ºdf</span><br><span class=\"line\">    df.to_csv(&#x27;answer_id.csv&#x27;, index=True)</span><br></pre></td></tr></table></figure>\n<p>ç„¶åå°±å¯ä»¥ä½¿ç”¨crawler2.pyæ¥çˆ¬å–è¿™äº›answeridå¯¹åº”çš„å›ç­”ï¼Œéœ€è¦åœ¨crawler2.pyé‡Œä¿®æ”¹ä¸‹é¢çº¢çº¿æ ‡å‡ºçš„éƒ¨åˆ†ï¼ŒCookieå’Œreferå’Œå‰é¢ç±»ä¼¼ï¼Œä¸‹é¢é‚£ä¸ªurlé‚£é‡Œè®°å¾—æŠŠé—®é¢˜çš„idæ¢æˆå¯¹åº”çš„ä½ è¦çˆ¬å–çš„é‚£ä¸ªé—®é¢˜çš„idï¼Œå°±æ˜¯ç½‘é¡µåœ°å€é‡Œé¢èƒ½æ˜æ˜¾çœ‹å‡ºæ¥ã€‚<br>\n<a href=\"./Python%E7%88%AC%E8%99%AB%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93_Bilibili%EF%BC%8C%E7%9F%A5%E4%B9%8E%EF%BC%8C%E5%BE%AE%E5%8D%9A%20-%20TJUHuangTao%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/3483649-20250120121047473-648090074.png\"><img src=\"./Python%E7%88%AC%E8%99%AB%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93_Bilibili%EF%BC%8C%E7%9F%A5%E4%B9%8E%EF%BC%8C%E5%BE%AE%E5%8D%9A%20-%20TJUHuangTao%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/3483649-20250120121047473-648090074.png\" alt=\"\"></a></p>\n<p>ä¹‹åè¿è¡Œå°±å¯ä»¥çˆ¬å–äº†ï¼ŒåŒæ ·è®°å¾—æ¯éš”ä¸€æ®µä¿å­˜ä¸€æ¬¡ï¼Œä»£ç é‡Œæ˜¯ç›´æ¥ä¿å­˜åœ¨ä¸åŒçš„æ–‡ä»¶é‡Œï¼Œæˆ‘é€šè¿‡clean.pyè¿›è¡Œæ•´åˆå’Œå»é‡ã€‚å…·ä½“çš„åº”è¯¥çœ‹çœ‹clean.pyå°±çŸ¥é“æ€ä¹ˆæ”¹äº†ï¼Œåªè¦ä¿®æ”¹ä¸€ä¸‹æ–‡ä»¶è·¯å¾„åŸºæœ¬å°±okã€‚</p>\n<h2 id=\"å®Œæ•´ä»£ç \">å®Œæ•´ä»£ç </h2>\n<h3 id=\"crawler-py\"><a href=\"http://crawler.py\">crawler.py</a></h3>\n<p>ç‚¹å‡»æŸ¥çœ‹ä»£ç </p>\n<p>**</p>\n<p>highlighter- llvm</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">import requests</span><br><span class=\"line\">import pandas as pd</span><br><span class=\"line\">import time</span><br><span class=\"line\">import random</span><br><span class=\"line\"></span><br><span class=\"line\">template = &#x27;https://www.zhihu.com/api/v4/questions/656533798/feeds?include=data%5B*%5D.is_normal%2Cadmin_closed_comment%2Creward_info%2Cis_collapsed%2Cannotation_action%2Cannotation_detail%2Ccollapse_reason%2Cis_sticky%2Ccollapsed_by%2Csuggest_edit%2Ccomment_count%2Ccan_comment%2Ccontent%2Ceditable_content%2Cattachment%2Cvoteup_count%2Creshipment_settings%2Ccomment_permission%2Ccreated_time%2Cupdated_time%2Creview_info%2Crelevant_info%2Cquestion%2Cexcerpt%2Cis_labeled%2Cpaid_info%2Cpaid_info_content%2Creaction_instruction%2Crelationship.is_authorized%2Cis_author%2Cvoting%2Cis_thanked%2Cis_nothelp%3Bdata%5B*%5D.author.follower_count%2Cvip_info%2Ckvip_info%2Cbadge%5B*%5D.topics%3Bdata%5B*%5D.settings.table_of_content.enabled&amp;offset=&#123;offset&#125;&amp;limit=3&amp;order=default&amp;ws_qiangzhisafe=1&amp;platform=desktop&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">df = pd.DataFrame()</span><br><span class=\"line\"># dfæœ‰ä¸‰åˆ—ï¼Œanswer_idå’Œcontentä»¥åŠåˆ›å»ºæ—¥æœŸ</span><br><span class=\"line\">df[&#x27;answer_id&#x27;] = []</span><br><span class=\"line\">df[&#x27;content&#x27;] = []</span><br><span class=\"line\">df[&#x27;created_time&#x27;] = []</span><br><span class=\"line\"></span><br><span class=\"line\">answer_ids = []</span><br><span class=\"line\"></span><br><span class=\"line\">agent = [</span><br><span class=\"line\">            &#x27;Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_8; en-us) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/5.0 (Windows; U; Windows NT 6.1; en-us) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0)&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:2.0.1) Gecko/20100101 Firefox/4.0.1&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/5.0 (Windows NT 6.1; rv:2.0.1) Gecko/20100101 Firefox/4.0.1&#x27;,</span><br><span class=\"line\">            &#x27;Opera/9.80 (Macintosh; Intel Mac OS X 10.6.8; U; en) Presto/2.8.131 Version/11.11&#x27;,</span><br><span class=\"line\">            &#x27;Opera/9.80 (Windows NT 6.1; U; en) Presto/2.8.131 Version/11.11&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_0) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.56 Safari/535.11&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Maxthon 2.0)&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; TencentTraveler 4.0)&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; The World)&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; SE 2.X MetaSr 1.0; SE 2.X MetaSr 1.0; .NET CLR 2.0.50727; SE 2.X MetaSr 1.0)&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)&#x27;</span><br><span class=\"line\">            &#x27;Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.72 Mobile Safari/537.36&#x27;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">ua = random.choice(agent)</span><br><span class=\"line\"></span><br><span class=\"line\">cookies = [</span><br><span class=\"line\">    &#x27;&#x27;</span><br><span class=\"line\">]</span><br><span class=\"line\">cookie = random.choice(cookies)</span><br><span class=\"line\">headers = &#123;</span><br><span class=\"line\">    &#x27;cookie&#x27; : cookie,</span><br><span class=\"line\">    &#x27;user-agent&#x27;: ua,#UserAgent().chrome,</span><br><span class=\"line\">    &#x27;Referer&#x27;:&#x27;https://www.zhihu.com/question/654859896/answer/3487198664&#x27;,</span><br><span class=\"line\">    &#x27;x-requested-with&#x27;: &#x27;XMLHttpRequest&#x27;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"># ç¬¬ä¸€æ¡ä½¿ç”¨æ¨¡ç‰ˆï¼Œåé¢çš„éƒ½æ˜¯nextæ¥è·å–</span><br><span class=\"line\">url0 = template.format(offset=0)</span><br><span class=\"line\">resp0 = requests.get(url0, headers=headers)</span><br><span class=\"line\">for data in resp0.json()[&#x27;data&#x27;]:</span><br><span class=\"line\">        answer_id = data[&#x27;target&#x27;][&#x27;id&#x27;]</span><br><span class=\"line\">        answer_ids.append(answer_id)</span><br><span class=\"line\">next = resp0.json()[&#x27;paging&#x27;][&#x27;next&#x27;]</span><br><span class=\"line\"></span><br><span class=\"line\">for page in range(1,5001):# è¿™é‡Œè‡ªå·±ä¼°ç®—ä¸€ä¸‹ï¼Œæ¯é¡µæ˜¯5æ¡æ•°æ®</span><br><span class=\"line\">    #å¯¹ç¬¬pageé¡µè¿›è¡Œè®¿é—®</span><br><span class=\"line\">    headers1 = &#123;</span><br><span class=\"line\">    &#x27;cookie&#x27; : random.choice(cookies),</span><br><span class=\"line\">    &#x27;user-agent&#x27;: random.choice(agent),#UserAgent().chrome,</span><br><span class=\"line\">    &#x27;Referer&#x27;:&#x27;https://www.zhihu.com/question/654859896/answer/3487198664&#x27;,</span><br><span class=\"line\">    &#x27;x-requested-with&#x27;: &#x27;XMLHttpRequest&#x27;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    resp = requests.get(next, headers=headers1)</span><br><span class=\"line\">    print(&#x27;æ­£åœ¨çˆ¬å–ç¬¬&#x27; + str(page) + &#x27;é¡µ&#x27;)</span><br><span class=\"line\">    </span><br><span class=\"line\">    for data in resp.json()[&#x27;data&#x27;]:</span><br><span class=\"line\">        answer_id = data[&#x27;target&#x27;][&#x27;id&#x27;]</span><br><span class=\"line\">        # æ·»åŠ answer_idåˆ°dfä¸­</span><br><span class=\"line\">        answer_ids.append(answer_id)</span><br><span class=\"line\">    next = resp.json()[&#x27;paging&#x27;][&#x27;next&#x27;]</span><br><span class=\"line\">    time.sleep(random.randint(1,4))</span><br><span class=\"line\">    # æ¯éš”100æ¡ä¿å­˜ä¸€æ¬¡ä¿¡æ¯</span><br><span class=\"line\">    if (page % 100 == 0):</span><br><span class=\"line\">        df = pd.DataFrame(&#123;&#x27;answer_id&#x27;: answer_ids&#125;)  # é‡æ–°åˆ›å»ºdf</span><br><span class=\"line\">        df.to_csv(&#x27;answer_id.csv&#x27;, index=True)</span><br></pre></td></tr></table></figure>\n<h3 id=\"crawler2-py\"><a href=\"http://crawler2.py\">crawler2.py</a></h3>\n<p>ç‚¹å‡»æŸ¥çœ‹ä»£ç </p>\n<p>**</p>\n<p>highlighter- python</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">from bs4 import BeautifulSoup</span><br><span class=\"line\">import pandas as pd</span><br><span class=\"line\">import random</span><br><span class=\"line\">import requests</span><br><span class=\"line\">import pandas as pd</span><br><span class=\"line\">import time</span><br><span class=\"line\">import random</span><br><span class=\"line\"></span><br><span class=\"line\">contents = []</span><br><span class=\"line\">created_times = []</span><br><span class=\"line\">agent = [</span><br><span class=\"line\">            &#x27;Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_8; en-us) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/5.0 (Windows; U; Windows NT 6.1; en-us) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0)&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:2.0.1) Gecko/20100101 Firefox/4.0.1&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/5.0 (Windows NT 6.1; rv:2.0.1) Gecko/20100101 Firefox/4.0.1&#x27;,</span><br><span class=\"line\">            &#x27;Opera/9.80 (Macintosh; Intel Mac OS X 10.6.8; U; en) Presto/2.8.131 Version/11.11&#x27;,</span><br><span class=\"line\">            &#x27;Opera/9.80 (Windows NT 6.1; U; en) Presto/2.8.131 Version/11.11&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_0) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.56 Safari/535.11&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Maxthon 2.0)&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; TencentTraveler 4.0)&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; The World)&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; SE 2.X MetaSr 1.0; SE 2.X MetaSr 1.0; .NET CLR 2.0.50727; SE 2.X MetaSr 1.0)&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)&#x27;</span><br><span class=\"line\">            &#x27;Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.72 Mobile Safari/537.36&#x27;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">ua = random.choice(agent)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">headers = &#123;</span><br><span class=\"line\">    &#x27;cookie&#x27; : &#x27;&#x27;,</span><br><span class=\"line\">    &#x27;user-agent&#x27;: ua,#UserAgent().chrome,</span><br><span class=\"line\">    &#x27;Referer&#x27;:&#x27;https://www.zhihu.com/question/654859896/answer/3487198664&#x27;,</span><br><span class=\"line\">    &#x27;x-requested-with&#x27;: &#x27;XMLHttpRequest&#x27;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"># è¯»å–answer_id.csvæ–‡ä»¶</span><br><span class=\"line\">df = pd.read_csv(&#x27;answer_id.csv&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\"># æå–answer_idåˆ—</span><br><span class=\"line\">answer_ids = df[&#x27;answer_id&#x27;].tolist()</span><br><span class=\"line\">cookies = [</span><br><span class=\"line\">    &#x27;&#x27;</span><br><span class=\"line\">]</span><br><span class=\"line\">batch = 0</span><br><span class=\"line\">for answer_id in answer_ids:</span><br><span class=\"line\">    print(&#x27;æ­£åœ¨çˆ¬å–answer_idä¸º&#123;answer_id&#125;çš„æ•°æ®&#x27;.format(answer_id=answer_id))</span><br><span class=\"line\">    url = &#x27;https://www.zhihu.com/question/654859896/answer/&#123;answer_id&#125;&#x27;.format(answer_id=answer_id)</span><br><span class=\"line\">    try:</span><br><span class=\"line\">        headers1 = &#123;</span><br><span class=\"line\">        &#x27;cookie&#x27; : random.choice(cookies),</span><br><span class=\"line\">        &#x27;user-agent&#x27;: random.choice(agent),#UserAgent().chrome,</span><br><span class=\"line\">        &#x27;Referer&#x27;:&#x27;https://www.zhihu.com/question/654859896/answer/3487198664&#x27;,</span><br><span class=\"line\">        &#x27;x-requested-with&#x27;: &#x27;XMLHttpRequest&#x27;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        resp = requests.get(url, headers=headers1)</span><br><span class=\"line\">        soup = BeautifulSoup(resp.text, &#x27;html.parser&#x27;)</span><br><span class=\"line\">        # æŸ¥æ‰¾content</span><br><span class=\"line\">        content = soup.find(&#x27;div&#x27;, class_=&#x27;RichContent-inner&#x27;).text</span><br><span class=\"line\">        contents.append(content)</span><br><span class=\"line\">        time_element = soup.find(&#x27;span&#x27;, &#123;&#x27;data-tooltip&#x27;: True&#125;)</span><br><span class=\"line\">        if time_element:</span><br><span class=\"line\">            created_time = time_element[&#x27;data-tooltip&#x27;].replace(&#x27;å‘å¸ƒäº &#x27;, &#x27;&#x27;)</span><br><span class=\"line\">            created_times.append(created_time)</span><br><span class=\"line\">        else:</span><br><span class=\"line\">            created_times.append(&#x27;-&#x27;)</span><br><span class=\"line\">    except Exception as e:</span><br><span class=\"line\">        print(f&#x27;çˆ¬å–answer_idä¸º&#123;answer_id&#125;çš„æ•°æ®æ—¶å‡ºç°å¼‚å¸¸ï¼š&#123;e&#125;&#x27;)</span><br><span class=\"line\">        break</span><br><span class=\"line\">    </span><br><span class=\"line\">    time.sleep(random.randint(1,2))</span><br><span class=\"line\"></span><br><span class=\"line\">    # æ¯çˆ¬å–500ä¸ªå›ç­”å°±ä¿å­˜ä¸€æ¬¡æ•°æ®,ä¿å­˜åœ¨ä¸åŒçš„æ–‡ä»¶ä¸­</span><br><span class=\"line\">    if len(contents) % 500 == 0:</span><br><span class=\"line\">        new_data = &#123;&#x27;answer_id&#x27;: answer_ids[:len(contents)], &#x27;content&#x27;: contents, &#x27;created_time&#x27; : created_times[:len(contents)]&#125;</span><br><span class=\"line\">        new_df = pd.DataFrame(new_data)</span><br><span class=\"line\">        new_df.to_csv(f&#x27;text_&#123;batch&#125;.csv&#x27;, index=True)</span><br><span class=\"line\">        batch += 1</span><br></pre></td></tr></table></figure>\n<h1>å¾®åš</h1>\n<h2 id=\"åŠŸèƒ½-3\">åŠŸèƒ½</h2>\n<p>å¯¹äºä¸€ä¸ªè¯é¢˜ï¼Œçˆ¬å–è¯é¢˜é“¾æ¥,æ¥¼ä¸»ID,è¯é¢˜å†…å®¹,æ¥¼ä¸»æ˜µç§°,æ¥¼ä¸»æ€§åˆ«,æ˜¯å¦è®¤è¯,è®¤è¯ç±»å‹,æ˜¯å¦è®¤è¯é‡‘v,å‘åšæ•°é‡,å…³æ³¨äººæ•°,ç²‰ä¸æ•°,å¾®åšç­‰çº§,å‘å¸ƒæ—¥æœŸ,å‘å¸ƒæ—¶é—´,è½¬å‘é‡,è¯„è®ºé‡,ç‚¹èµé‡ã€‚è¿™äº›ä¿¡æ¯ã€‚</p>\n<h2 id=\"ä»‹ç»-3\">ä»‹ç»</h2>\n<p>å¾®åšçš„çˆ¬è™«ä»£ç æ˜¯æ¥æºäºä»¥ä¸‹é“¾æ¥ï¼Œé“¾æ¥é‡Œé¢æœ‰çˆ¬å–è¯„è®ºçš„å†…å®¹ï¼Œä½†æ˜¯æˆ‘ä½œä¸šé‡Œä¸éœ€è¦ï¼Œæˆ‘å°±æŠŠè¿™ä¸ªåŠŸèƒ½åˆ äº†ï¼Œéœ€è¦çˆ¬å–è¯„è®ºçš„å¯ä»¥å»ä¸‹é¢é“¾æ¥çœ‹çœ‹ã€‚<br>\n<a href=\"https://blog.csdn.net/m0_46235332/article/details/122682412\" title=\"å¾®åšçˆ¬è™«\">å¾®åšçˆ¬è™«</a></p>\n<h2 id=\"å…·ä½“æ“ä½œ\">å…·ä½“æ“ä½œ</h2>\n<p>å¾®åšçˆ¬è™«æ¯”è¾ƒéº»çƒ¦ï¼Œå¥½åƒæ˜¯æœ‰é™åˆ¶ä¸€æ¬¡æ€§æœ€å¤šçˆ¬å–50é¢ï¼Œæ‰€ä»¥åªèƒ½æ‰‹åŠ¨é€šè¿‡ç­›é€‰æ—¶é—´ï¼Œçˆ¬50é¢åçœ‹æœ€åä¸€æ¡æ¶ˆæ¯çš„æ—¶é—´ï¼ŒæŠŠç­›é€‰æ—¶é—´æˆªæ­¢åˆ°é‚£é‡Œï¼Œå†æ¥ç€çˆ¬50é¢ï¼Œæ¯æ¬¡éƒ½å¾—æ‰‹åŠ¨è°ƒï¼Œå¾ˆéº»çƒ¦ã€‚</p>\n<p>éœ€è¦ä¿®æ”¹çš„å†…å®¹å¦‚ä¸‹ï¼š<br>\n<a href=\"./Python%E7%88%AC%E8%99%AB%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93_Bilibili%EF%BC%8C%E7%9F%A5%E4%B9%8E%EF%BC%8C%E5%BE%AE%E5%8D%9A%20-%20TJUHuangTao%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/3483649-20250120122007874-1159636649.png\"><img src=\"./Python%E7%88%AC%E8%99%AB%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93_Bilibili%EF%BC%8C%E7%9F%A5%E4%B9%8E%EF%BC%8C%E5%BE%AE%E5%8D%9A%20-%20TJUHuangTao%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/3483649-20250120122007874-1159636649.png\" alt=\"\"></a></p>\n<p>é‡Œé¢çš„Cookieå’ŒRefererå°±ä¸ç”¨è¯´äº†ï¼Œè€ç”Ÿå¸¸è°ˆï¼Œä¸»è¦è¯´ä¸€ä¸‹æœ€åº•ä¸‹é‚£ä¸ªbaseurlï¼Œå°±æ˜¯åœ¨å¾®åšé‡Œé¢é«˜çº§æœç´¢ï¼Œç­›é€‰æ—¶é—´åï¼Œå¾—åˆ°çš„ç½‘å€ã€‚<br>\n<a href=\"./Python%E7%88%AC%E8%99%AB%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93_Bilibili%EF%BC%8C%E7%9F%A5%E4%B9%8E%EF%BC%8C%E5%BE%AE%E5%8D%9A%20-%20TJUHuangTao%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/3483649-20250120122145488-1694643046.png\"><img src=\"./Python%E7%88%AC%E8%99%AB%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93_Bilibili%EF%BC%8C%E7%9F%A5%E4%B9%8E%EF%BC%8C%E5%BE%AE%E5%8D%9A%20-%20TJUHuangTao%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/3483649-20250120122145488-1694643046.png\" alt=\"\"></a><br>\n<a href=\"./Python%E7%88%AC%E8%99%AB%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93_Bilibili%EF%BC%8C%E7%9F%A5%E4%B9%8E%EF%BC%8C%E5%BE%AE%E5%8D%9A%20-%20TJUHuangTao%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/3483649-20250120122206095-1956403865.png\"><img src=\"./Python%E7%88%AC%E8%99%AB%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93_Bilibili%EF%BC%8C%E7%9F%A5%E4%B9%8E%EF%BC%8C%E5%BE%AE%E5%8D%9A%20-%20TJUHuangTao%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/3483649-20250120122206095-1956403865.png\" alt=\"\"></a><br>\nä¸Šé¢çš„ç½‘å€å°±æ˜¯baseurlï¼Œæ›¿æ¢åç›´æ¥è¿è¡Œå°±å¯ä»¥å¼€çˆ¬äº†ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä»£ç é‡Œæœ‰ä¸€æ®µæ˜¯å†™csvçš„è¡¨å¤´çš„è¯­å¥ï¼Œå› ä¸ºå‰é¢è¯´äº†å¾—å¤šæ¬¡çˆ¬å–ï¼Œæ‰€ä»¥åªæœ‰ç¬¬ä¸€æ¬¡çˆ¬å–çš„æ—¶å€™éœ€è¦å†™è¡¨å¤´ï¼Œåé¢å°±å¾—æŠŠå†™è¡¨å¤´çš„è¯­å¥æ³¨é‡Šæ‰ã€‚<br>\n<a href=\"./Python%E7%88%AC%E8%99%AB%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93_Bilibili%EF%BC%8C%E7%9F%A5%E4%B9%8E%EF%BC%8C%E5%BE%AE%E5%8D%9A%20-%20TJUHuangTao%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/3483649-20250120122359649-689719132.png\"><img src=\"./Python%E7%88%AC%E8%99%AB%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93_Bilibili%EF%BC%8C%E7%9F%A5%E4%B9%8E%EF%BC%8C%E5%BE%AE%E5%8D%9A%20-%20TJUHuangTao%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/3483649-20250120122359649-689719132.png\" alt=\"\"></a></p>\n<h2 id=\"å®Œæ•´ä»£ç -2\">å®Œæ•´ä»£ç </h2>\n<p>ç‚¹å‡»æŸ¥çœ‹ä»£ç </p>\n<p>**</p>\n<p>highlighter- python</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\"># -*- coding: utf-8 -*-</span><br><span class=\"line\"> </span><br><span class=\"line\">&#x27;&#x27;&#x27;</span><br><span class=\"line\">å¾®åšçˆ¬è™«ï¼Œçˆ¬å–ä¸€ä¸ªä¸»é¢˜ä¸‹çš„åšæ–‡å†…å®¹ï¼Œåšä¸»ä¿¡æ¯ï¼Œè¯„è®ºç­‰å„ç§ä¿¡æ¯</span><br><span class=\"line\">&#x27;&#x27;&#x27;</span><br><span class=\"line\"> </span><br><span class=\"line\">import requests, random, re</span><br><span class=\"line\">import time</span><br><span class=\"line\">import os</span><br><span class=\"line\">import csv</span><br><span class=\"line\">import sys</span><br><span class=\"line\">import json</span><br><span class=\"line\">import importlib</span><br><span class=\"line\"># from fake_useragent import UserAgent</span><br><span class=\"line\">from lxml import etree</span><br><span class=\"line\">import datetime</span><br><span class=\"line\">import pandas as pd</span><br><span class=\"line\">from selenium import webdriver</span><br><span class=\"line\">import urllib.request</span><br><span class=\"line\"> </span><br><span class=\"line\"># è®°å½•èµ·å§‹æ—¶é—´</span><br><span class=\"line\">importlib.reload(sys)</span><br><span class=\"line\">startTime = time.time()</span><br><span class=\"line\">&#x27;&#x27;&#x27;</span><br><span class=\"line\">è®¾ç½®æ–‡ä»¶å‚¨å­˜çš„è·¯å¾„ </span><br><span class=\"line\">&#x27;&#x27;&#x27;</span><br><span class=\"line\">path1=&#x27;./weibo_content_gaokao.csv&#x27;#å­˜å–çš„æ˜¯å¾®åšåšæ–‡çš„ä¿¡æ¯ï¼ˆä¸åŒ…å«è¯„è®ºï¼‰</span><br><span class=\"line\">csvfile1 = open(path1, &#x27;a&#x27;, newline=&#x27;&#x27;, encoding=&#x27;utf-8-sig&#x27;) #&#x27;a&#x27;æ˜¯è¿½åŠ æ¨¡å¼, &#x27;w&#x27;æ˜¯é‡å†™</span><br><span class=\"line\">writer_1=csv.writer(csvfile1)</span><br><span class=\"line\"></span><br><span class=\"line\"># csvå¤´éƒ¨</span><br><span class=\"line\">writer_1.writerow((&#x27;è¯é¢˜é“¾æ¥&#x27;,  &#x27;æ¥¼ä¸»ID&#x27;, &#x27;è¯é¢˜å†…å®¹&#x27;,&#x27;æ¥¼ä¸»æ˜µç§°&#x27;, &#x27;æ¥¼ä¸»æ€§åˆ«&#x27;,&#x27;æ˜¯å¦è®¤è¯&#x27;,&#x27;è®¤è¯ç±»å‹&#x27;,</span><br><span class=\"line\">                   &#x27;æ˜¯å¦è®¤è¯é‡‘v&#x27;,&#x27;å‘åšæ•°é‡&#x27;,&#x27;å…³æ³¨äººæ•°&#x27;,&#x27;ç²‰ä¸æ•°&#x27;,&#x27;å¾®åšç­‰çº§&#x27;, &#x27;å‘å¸ƒæ—¥æœŸ&#x27;,</span><br><span class=\"line\">                   &#x27;å‘å¸ƒæ—¶é—´&#x27;, &#x27;è½¬å‘é‡&#x27;, &#x27;è¯„è®ºé‡&#x27;, &#x27;ç‚¹èµé‡&#x27;))        #å¾®åšåšæ–‡çš„ä¿¡æ¯ï¼ˆä¸åŒ…å«è¯„è®ºï¼‰</span><br><span class=\"line\"></span><br><span class=\"line\"># --------------------------------------------å¤´éƒ¨ä¿¡æ¯-----------------------------------------------------</span><br><span class=\"line\">ip_list = [</span><br><span class=\"line\">            &#123;&#x27;http&#x27;: &#x27;http://118.193.47.193:8118&#x27;&#125;, # æ¹–å—é•¿æ²™</span><br><span class=\"line\">            &#123;&#x27;http&#x27;: &#x27;http://58.20.234.243:9091&#x27;&#125;, # æ¹–å—æ¹˜æ½­</span><br><span class=\"line\">            &#123;&#x27;http&#x27;: &#x27;http://58.20.235.180:9091&#x27;&#125;, # æ¹–å—æ¹˜æ½­</span><br><span class=\"line\">            &#123;&quot;http&quot;: &quot;http://112.115.57.20:3128&quot;&#125;,</span><br><span class=\"line\">            &#123;&#x27;http&#x27;: &#x27;http://121.41.171.223:3128&#x27;&#125;,</span><br><span class=\"line\">            &#123;&quot;http&quot;: &quot;http://124.88.67.54:80&quot;&#125;,</span><br><span class=\"line\">            &#123;&quot;http&quot;: &quot;http://61.135.217.7:80&quot;&#125;,</span><br><span class=\"line\">            &#123;&quot;http&quot;: &quot;http://42.231.165.132:8118&quot;&#125;,</span><br><span class=\"line\">            &#123;&quot;http&quot;: &quot;http://10.10.1.10:3128&quot;&#125;,</span><br><span class=\"line\">            &#123;&quot;https&quot;: &quot;http://10.10.1.10:1080&quot;&#125;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">ip = random.choice(ip_list)</span><br><span class=\"line\"></span><br><span class=\"line\"># åçˆ¬è™«</span><br><span class=\"line\">agent = [</span><br><span class=\"line\">            &#x27;Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_8; en-us) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/5.0 (Windows; U; Windows NT 6.1; en-us) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0)&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:2.0.1) Gecko/20100101 Firefox/4.0.1&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/5.0 (Windows NT 6.1; rv:2.0.1) Gecko/20100101 Firefox/4.0.1&#x27;,</span><br><span class=\"line\">            &#x27;Opera/9.80 (Macintosh; Intel Mac OS X 10.6.8; U; en) Presto/2.8.131 Version/11.11&#x27;,</span><br><span class=\"line\">            &#x27;Opera/9.80 (Windows NT 6.1; U; en) Presto/2.8.131 Version/11.11&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_0) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.56 Safari/535.11&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Maxthon 2.0)&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; TencentTraveler 4.0)&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; The World)&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; SE 2.X MetaSr 1.0; SE 2.X MetaSr 1.0; .NET CLR 2.0.50727; SE 2.X MetaSr 1.0)&#x27;,</span><br><span class=\"line\">            &#x27;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)&#x27;</span><br><span class=\"line\">            &#x27;Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.72 Mobile Safari/537.36&#x27;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">ua = random.choice(agent)</span><br><span class=\"line\"></span><br><span class=\"line\">cookie_list = [</span><br><span class=\"line\">    # æ‰‹æœºå·</span><br><span class=\"line\">    &#123;&#x27;cookie&#x27;:&#x27;&#x27;&#125;</span><br><span class=\"line\">]</span><br><span class=\"line\"></span><br><span class=\"line\">cookie = random.choice(cookie_list)[&#x27;cookie&#x27;]</span><br><span class=\"line\"></span><br><span class=\"line\">headers = &#123;</span><br><span class=\"line\">    &#x27;cookie&#x27;: cookie,</span><br><span class=\"line\">    &#x27;user-agent&#x27;: ua,#UserAgent().chrome,</span><br><span class=\"line\">    &#x27;Referer&#x27;:&#x27;https://m.weibo.cn/search?containerid=100103type%3D1%26q%3D%E6%98%A5%E8%8A%82&#x27;,</span><br><span class=\"line\">    &#x27;x-requested-with&#x27;: &#x27;XMLHttpRequest&#x27;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"># # -----------------------------------çˆ¬å–è¯¥ä¸»é¢˜é¦–é¡µçš„æ¯ä¸ªä¸»é¢˜çš„ID------------------------------------------</span><br><span class=\"line\">&#x27;&#x27;&#x27;</span><br><span class=\"line\">æ‰¾å‡ºå‘å¸ƒè€…idï¼Œå¹¶å­˜å…¥åˆ—è¡¨ï¼Œç”¨äºæ‰¾æ¯ä¸ªå…·ä½“åšå®¢çš„ç½‘å€</span><br><span class=\"line\">&#x27;&#x27;&#x27;</span><br><span class=\"line\">comments_ID = []</span><br><span class=\"line\">baseurl = &#x27;https://s.weibo.com/weibo?q=%23%E9%AB%98%E8%80%83%23&amp;xsort=hot&amp;suball=1&amp;timescope=custom%3A2015-01-01%3A2016-05-12-20&amp;Refer=g&#x27;</span><br><span class=\"line\">def get_title_id():</span><br><span class=\"line\">    for page in range(1, 51):  # æ¯ä¸ªé¡µé¢å¤§çº¦æœ‰9ä¸ªè¯é¢˜</span><br><span class=\"line\">        headers = &#123;</span><br><span class=\"line\">            &#x27;cookie&#x27;: cookie,</span><br><span class=\"line\">            &#x27;user-agent&#x27;: ua,</span><br><span class=\"line\">            &#x27;Referer&#x27;: f&#x27;&#123;baseurl&#125;&amp;page=&#123;page&#125;&#x27;,</span><br><span class=\"line\">            &#x27;x-requested-with&#x27;: &#x27;XMLHttpRequest&#x27;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        time.sleep(1)</span><br><span class=\"line\">        api_url = f&quot;&#123;baseurl&#125;&amp;page=&#123;page&#125;&quot;</span><br><span class=\"line\"> </span><br><span class=\"line\">        rep1 = requests.get(url=api_url, headers=headers)</span><br><span class=\"line\">        try:</span><br><span class=\"line\">            rep=rep1.text # è·å–IDå€¼å¹¶å†™å…¥åˆ—è¡¨comment_IDä¸­</span><br><span class=\"line\">            comment_ID=re.findall(&#x27;(?&lt;=mid=&quot;)\\d&#123;16&#125;&#x27;, rep)</span><br><span class=\"line\">            comments_ID.extend(comment_ID)</span><br><span class=\"line\">            print(page,&quot;é¡µidè·å–æˆåŠŸï¼&quot;,comment_ID)</span><br><span class=\"line\">        except:</span><br><span class=\"line\">            print(page,&quot;é¡µidè·å–æœ‰è¯¯ï¼&quot;)</span><br><span class=\"line\"> </span><br><span class=\"line\"> </span><br><span class=\"line\"># -----------------------------------çˆ¬å–è¯¥ä¸»é¢˜ä¸‹æ¯ä¸ªåšå®¢çš„è¯¦æƒ…é¡µé¢ ------------------------------------------</span><br><span class=\"line\"> </span><br><span class=\"line\">&#x27;&#x27;&#x27;</span><br><span class=\"line\">è¯¥ä¸»é¢˜ä¸‹æ¯ä¸ªåšå®¢ä¸»çš„è¯¦æƒ…ï¼ˆåŒ…æ‹¬è¯é¢˜å†…å®¹ã€æ¥¼ä¸»idã€æ¥¼ä¸»æ˜µç§°ã€æ¥¼ä¸»æ€§åˆ«ã€å‘å¸ƒæ—¶é—´ã€æ—¥æœŸã€</span><br><span class=\"line\">å‘å¸ƒæ—¶é—´ã€è½¬å‘é‡ã€è¯„è®ºé‡ã€ç‚¹èµé‡ï¼‰</span><br><span class=\"line\">ï¼ˆåˆ©ç”¨æ­£åˆ™è¡¨è¾¾å¼æŠ“å–ï¼‰</span><br><span class=\"line\">&#x27;&#x27;&#x27;</span><br><span class=\"line\">is_continue=&#x27;y&#x27;</span><br><span class=\"line\">start_date = pd.to_datetime(&#x27;2015/01/01&#x27;)</span><br><span class=\"line\">end_date = pd.to_datetime(&#x27;2024/12/31&#x27;)</span><br><span class=\"line\">def spider_title(comment_ID):</span><br><span class=\"line\"></span><br><span class=\"line\">    article_url = &#x27;https://m.weibo.cn/detail/&#x27; + comment_ID</span><br><span class=\"line\">    print(&quot;article_url = &quot;, article_url)</span><br><span class=\"line\">    time.sleep(1)</span><br><span class=\"line\"></span><br><span class=\"line\">    try:</span><br><span class=\"line\">        html_text = requests.get(url=article_url, headers=headers).text</span><br><span class=\"line\">        # å‘å¸ƒæ—¥æœŸ</span><br><span class=\"line\">        created_title_time = re.findall(&#x27;.*?&quot;created_at&quot;: &quot;(.*?)&quot;.*?&#x27;, html_text)[0].split(&#x27; &#x27;)</span><br><span class=\"line\">        # print(created_title_time)</span><br><span class=\"line\">        # æ—¥æœŸ</span><br><span class=\"line\">        if &#x27;Jan&#x27; in created_title_time:</span><br><span class=\"line\">            title_created_YMD = &quot;&#123;&#125;/&#123;&#125;/&#123;&#125;&quot;.format(created_title_time[-1], &#x27;01&#x27;, created_title_time[2])</span><br><span class=\"line\">        elif &#x27;Feb&#x27; in created_title_time:</span><br><span class=\"line\">            title_created_YMD = &quot;&#123;&#125;/&#123;&#125;/&#123;&#125;&quot;.format(created_title_time[-1], &#x27;02&#x27;, created_title_time[2])</span><br><span class=\"line\">        elif &#x27;Mar&#x27; in created_title_time:</span><br><span class=\"line\">            title_created_YMD = &quot;&#123;&#125;/&#123;&#125;/&#123;&#125;&quot;.format(created_title_time[-1], &#x27;03&#x27;, created_title_time[2])</span><br><span class=\"line\">        elif &#x27;Apr&#x27; in created_title_time:</span><br><span class=\"line\">            title_created_YMD = &quot;&#123;&#125;/&#123;&#125;/&#123;&#125;&quot;.format(created_title_time[-1], &#x27;04&#x27;, created_title_time[2])</span><br><span class=\"line\">        elif &#x27;May&#x27; in created_title_time:</span><br><span class=\"line\">            title_created_YMD = &quot;&#123;&#125;/&#123;&#125;/&#123;&#125;&quot;.format(created_title_time[-1], &#x27;05&#x27;, created_title_time[2])</span><br><span class=\"line\">        elif &#x27;Jun&#x27; in created_title_time:</span><br><span class=\"line\">            title_created_YMD = &quot;&#123;&#125;/&#123;&#125;/&#123;&#125;&quot;.format(created_title_time[-1], &#x27;06&#x27;, created_title_time[2])</span><br><span class=\"line\">        elif &#x27;July&#x27; in created_title_time:</span><br><span class=\"line\">            title_created_YMD = &quot;&#123;&#125;/&#123;&#125;/&#123;&#125;&quot;.format(created_title_time[-1], &#x27;07&#x27;, created_title_time[2])</span><br><span class=\"line\">        elif &#x27;Aug&#x27; in created_title_time:</span><br><span class=\"line\">            title_created_YMD = &quot;&#123;&#125;/&#123;&#125;/&#123;&#125;&quot;.format(created_title_time[-1], &#x27;08&#x27;, created_title_time[2])</span><br><span class=\"line\">        elif &#x27;Sep&#x27; in created_title_time:</span><br><span class=\"line\">            title_created_YMD = &quot;&#123;&#125;/&#123;&#125;/&#123;&#125;&quot;.format(created_title_time[-1], &#x27;09&#x27;, created_title_time[2])</span><br><span class=\"line\">        elif &#x27;Oct&#x27; in created_title_time:</span><br><span class=\"line\">            title_created_YMD = &quot;&#123;&#125;/&#123;&#125;/&#123;&#125;&quot;.format(created_title_time[-1], &#x27;10&#x27;, created_title_time[2])</span><br><span class=\"line\">        elif &#x27;Nov&#x27; in created_title_time:</span><br><span class=\"line\">            title_created_YMD = &quot;&#123;&#125;/&#123;&#125;/&#123;&#125;&quot;.format(created_title_time[-1], &#x27;11&#x27;, created_title_time[2])</span><br><span class=\"line\">        elif &#x27;Dec&#x27; in created_title_time:</span><br><span class=\"line\">            title_created_YMD = &quot;&#123;&#125;/&#123;&#125;/&#123;&#125;&quot;.format(created_title_time[-1], &#x27;12&#x27;, created_title_time[2])</span><br><span class=\"line\">        # print(&quot;title_created_YMD = &quot;, title_created_YMD)</span><br><span class=\"line\"> </span><br><span class=\"line\">        print(&#x27;å‘å¸ƒæ—¥æœŸï¼š&#x27;,title_created_YMD)</span><br><span class=\"line\">        time2 = pd.to_datetime(title_created_YMD)</span><br><span class=\"line\"> </span><br><span class=\"line\">        if start_date&lt;= time2 &lt;= end_date:</span><br><span class=\"line\">            # è¯é¢˜å†…å®¹</span><br><span class=\"line\">            find_title = re.findall(&#x27;.*?&quot;text&quot;: &quot;(.*?)&quot;,.*?&#x27;, html_text)[0]</span><br><span class=\"line\">            title_text = re.sub(&#x27;&lt;(S*?)[^&gt;]*&gt;.*?|&lt;.*? /&gt;&#x27;, &#x27;&#x27;, find_title)  # æ­£åˆ™åŒ¹é…æ‰htmlæ ‡ç­¾</span><br><span class=\"line\"></span><br><span class=\"line\">            # æ¥¼ä¸»ID</span><br><span class=\"line\">            title_user_id = re.findall(&#x27;.*?&quot;id&quot;: (.*?),.*?&#x27;, html_text)[1]</span><br><span class=\"line\"></span><br><span class=\"line\">            # æ¥¼ä¸»æ˜µç§°</span><br><span class=\"line\">            title_user_NicName = re.findall(&#x27;.*?&quot;screen_name&quot;: &quot;(.*?)&quot;,.*?&#x27;, html_text)[0]</span><br><span class=\"line\"></span><br><span class=\"line\">            # æ¥¼ä¸»æ€§åˆ«</span><br><span class=\"line\">            title_user_gender = re.findall(&#x27;.*?&quot;gender&quot;: &quot;(.*?)&quot;,.*?&#x27;, html_text)[0]</span><br><span class=\"line\"></span><br><span class=\"line\">            verified=re.findall(&#x27;.*?&quot;verified&quot;: (.*?),.*?&#x27;, html_text)[0]#æ¥¼ä¸»æ˜¯å¦è®¤è¯</span><br><span class=\"line\">            if verified==&#x27;true&#x27;:</span><br><span class=\"line\">                verified_type_ext = re.findall(&#x27;.*?&quot;verified_type_ext&quot;: (.*?),.*?&#x27;, html_text)[0] # æ¥¼ä¸»æ˜¯å¦é‡‘v</span><br><span class=\"line\">            else:</span><br><span class=\"line\">                verified_type_ext=0</span><br><span class=\"line\">            # print(verified_type_ext)</span><br><span class=\"line\">            content_num=re.findall(&#x27;.*?&quot;statuses_count&quot;: (.*?),.*?&#x27;, html_text)[0] #æ¥¼ä¸»å‘åšæ•°é‡</span><br><span class=\"line\">            verified_type=re.findall(&#x27;.*?&quot;verified_type&quot;: (.*?),.*?&#x27;, html_text)[0]#æ¥¼ä¸»è®¤è¯ç±»å‹</span><br><span class=\"line\">            urank=re.findall(&#x27;.*?&quot;urank&quot;: (.*?),.*?&#x27;, html_text)[0]#æ¥¼ä¸»å¾®åšç­‰çº§</span><br><span class=\"line\">            guanzhu=re.findall(&#x27;.*?&quot;follow_count&quot;: (.*?),.*?&#x27;, html_text)[0]#æ¥¼ä¸»å…³æ³¨æ•°</span><br><span class=\"line\">            fensi=eval(re.findall(&#x27;.*?&quot;followers_count&quot;: (.*?),.*?&#x27;, html_text)[0])#æ¥¼ä¸»ç²‰ä¸æ•°</span><br><span class=\"line\"></span><br><span class=\"line\">            # å‘å¸ƒæ—¶é—´</span><br><span class=\"line\">            add_title_time = created_title_time[3]</span><br><span class=\"line\">            print(&quot;add_title_time = &quot;, add_title_time)</span><br><span class=\"line\">            #å½“è¯¥æ¡å¾®åšæ˜¯æ˜¯è½¬å‘å¾®åšæ—¶ï¼Œä¼šæœ‰ä¸€ä¸ªåŸå¾®åšçš„è½¬å‘è¯„è®ºç‚¹èµé‡ï¼Œä»¥åŠæœ¬æ¡å¾®åšçš„è½¬å‘è¯„è®ºç‚¹èµé‡ï¼Œæ­¤æ—¶éœ€è¦çš„æ˜¯ç¬¬2ä¸ªå…ƒç´ </span><br><span class=\"line\">            if len(re.findall(&#x27;.*?&quot;reposts_count&quot;: (.*?),.*?&#x27;, html_text))&gt;1:</span><br><span class=\"line\">                # è½¬å‘é‡</span><br><span class=\"line\">                reposts_count = re.findall(&#x27;.*?&quot;reposts_count&quot;: (.*?),.*?&#x27;, html_text)[1]</span><br><span class=\"line\">                # è¯„è®ºé‡</span><br><span class=\"line\">                comments_count = re.findall(&#x27;.*?&quot;comments_count&quot;: (.*?),.*?&#x27;, html_text)[1]</span><br><span class=\"line\">                print(&quot;comments_count = &quot;, comments_count)</span><br><span class=\"line\">                # ç‚¹èµé‡</span><br><span class=\"line\">                attitudes_count = re.findall(&#x27;.*?&quot;attitudes_count&quot;: (.*?),.*?&#x27;, html_text)[1]</span><br><span class=\"line\">                # æ¯ä¸ªajaxä¸€æ¬¡åŠ è½½20æ¡æ•°æ®</span><br><span class=\"line\">                comment_count = int(int(comments_count) / 20)</span><br><span class=\"line\">            else:</span><br><span class=\"line\">                # è½¬å‘é‡</span><br><span class=\"line\">                reposts_count = re.findall(&#x27;.*?&quot;reposts_count&quot;: (.*?),.*?&#x27;, html_text)[0]</span><br><span class=\"line\">                # print(&quot;reposts_count = &quot;, reposts_count)</span><br><span class=\"line\"></span><br><span class=\"line\">                # è¯„è®ºé‡</span><br><span class=\"line\">                comments_count = re.findall(&#x27;.*?&quot;comments_count&quot;: (.*?),.*?&#x27;, html_text)[0]</span><br><span class=\"line\">                print(&quot;comments_count = &quot;, comments_count)</span><br><span class=\"line\"></span><br><span class=\"line\">                # ç‚¹èµé‡</span><br><span class=\"line\">                attitudes_count = re.findall(&#x27;.*?&quot;attitudes_count&quot;: (.*?),.*?&#x27;, html_text)[0]</span><br><span class=\"line\">                # print(&quot;attitudes_count = &quot;, attitudes_count)</span><br><span class=\"line\"></span><br><span class=\"line\">                # æ¯ä¸ªajaxä¸€æ¬¡åŠ è½½20æ¡æ•°æ®</span><br><span class=\"line\">                comment_count = int(int(comments_count) / 20)</span><br><span class=\"line\"></span><br><span class=\"line\">            # position1æ˜¯è®°å½•</span><br><span class=\"line\">            position11 = (article_url, title_user_id, title_text, title_user_NicName, title_user_gender, verified, verified_type,</span><br><span class=\"line\">            verified_type_ext, content_num, guanzhu, fensi, urank, title_created_YMD, add_title_time,reposts_count, comments_count, attitudes_count)</span><br><span class=\"line\"></span><br><span class=\"line\">            # å†™å…¥æ•°æ®</span><br><span class=\"line\">            writer_1.writerow(position11)</span><br><span class=\"line\">            print(&#x27;å†™å…¥åšæ–‡ä¿¡æ¯æ•°æ®æˆåŠŸï¼&#x27;)</span><br><span class=\"line\">            return comment_count, title_user_id, title_created_YMD,title_text</span><br><span class=\"line\"></span><br><span class=\"line\">            global is_continue</span><br><span class=\"line\">        else:</span><br><span class=\"line\">            is_continue = input(&#x27;æ—¥æœŸè¶…å‡ºèŒƒå›´,æ˜¯å¦ç»§ç»­çˆ¬å–åšæ–‡ä¿¡æ¯?(y/n, é»˜è®¤: y) â€”â€”&gt; &#x27;)#è¾“å…¥æ˜¯å¦ç»§ç»­çˆ¬å–</span><br><span class=\"line\">            if is_continue == &#x27;y&#x27; or is_continue == &#x27;yes&#x27; or not is_continue:</span><br><span class=\"line\">                pass</span><br><span class=\"line\">            else:</span><br><span class=\"line\">                print(&#x27;æ—¥æœŸè¶…å‡ºèŒƒå›´ï¼Œåœæ­¢çˆ¬å–åšæ–‡ä¿¡æ¯ï¼&#x27;)</span><br><span class=\"line\">                # è®¡ç®—ä½¿ç”¨æ—¶é—´</span><br><span class=\"line\">                endTime = time.time()</span><br><span class=\"line\">                useTime = (endTime - startTime) / 60</span><br><span class=\"line\">                print(&quot;è¯¥æ¬¡æ‰€è·çš„ä¿¡æ¯ä¸€å…±ä½¿ç”¨%såˆ†é’Ÿ&quot; % useTime)</span><br><span class=\"line\">                sys.exit(0)</span><br><span class=\"line\">            return is_continue</span><br><span class=\"line\">    except:</span><br><span class=\"line\">        print(&#x27;åšæ–‡ç½‘é¡µè§£æé”™è¯¯ï¼Œæˆ–å¾®åšä¸å­˜åœ¨æˆ–æš‚æ— æŸ¥çœ‹æƒé™ï¼&#x27;)</span><br><span class=\"line\">        pass</span><br><span class=\"line\"> </span><br><span class=\"line\"> </span><br><span class=\"line\"></span><br><span class=\"line\"># -------------------------------------------------ä¸»å‡½æ•°---------------------------------------------------</span><br><span class=\"line\">def main():</span><br><span class=\"line\">    count_title = len(comments_ID)</span><br><span class=\"line\">    for count, comment_ID in enumerate(comments_ID):</span><br><span class=\"line\">        print(&quot;æ­£åœ¨çˆ¬å–ç¬¬%sæ¡å¾®åšï¼Œä¸€å…±æ‰¾åˆ°ä¸ª%sæ¡å¾®åšéœ€è¦çˆ¬å–&quot; % (count + 1, count_title))</span><br><span class=\"line\"></span><br><span class=\"line\">        try:</span><br><span class=\"line\">            maxPage,title_user_id,title_created_YMD,title_text = spider_title(comment_ID)</span><br><span class=\"line\">        except:</span><br><span class=\"line\">            if is_continue == &#x27;y&#x27; or is_continue == &#x27;yes&#x27; or not is_continue:</span><br><span class=\"line\">                print(&quot;--------------------------åˆ†éš”ç¬¦---------------------------&quot;)</span><br><span class=\"line\">                pass</span><br><span class=\"line\">            else:</span><br><span class=\"line\">                sys.exit(0)</span><br><span class=\"line\">        print(&quot;--------------------------åˆ†éš”ç¬¦---------------------------&quot;)</span><br><span class=\"line\">    csvfile1.close()</span><br><span class=\"line\">    </span><br><span class=\"line\">if __name__ == &#x27;__main__&#x27;:</span><br><span class=\"line\">    # è·å–è¯é¢˜ID</span><br><span class=\"line\">    get_title_id()</span><br><span class=\"line\">    # ä¸»å‡½æ•°æ“ä½œ</span><br><span class=\"line\">    main()</span><br><span class=\"line\">    # è®¡ç®—ä½¿ç”¨æ—¶é—´</span><br><span class=\"line\">    endTime = time.time()</span><br><span class=\"line\">    useTime = (endTime - startTime) / 60</span><br><span class=\"line\">    print(&quot;è¯¥æ¬¡æ‰€è·çš„ä¿¡æ¯ä¸€å…±ä½¿ç”¨%såˆ†é’Ÿ&quot; % useTime)</span><br><span class=\"line\">    # print(&#x27;é”™è¯¯é¡µé¢:&#x27;,error_page_list)</span><br></pre></td></tr></table></figure>","tags":["Python","çˆ¬è™«"]},{"title":"ä¸Šæµ·","url":"/post/ff9c3d7d.html","content":""},{"title":"ä¹ æ¦‚é‡ç‚¹","url":"/post/bd442674.html","content":"<p><strong>å£°æ˜ï¼šæ ¹æ®2023å¹´@tjuSEé‡ç‚¹æ•´ç†ï¼Œç”±@zhyæ‘˜å–é‡åˆé‡ç‚¹è€Œæ¥ã€‚</strong></p>\n<h2 id=\"ç¬¬äºŒç« -ä»¥ä¸­å›½å¼ç°ä»£åŒ–å…¨é¢æ¨è¿›ä¸­åæ°‘æ—ä¼Ÿå¤§å¤å…´\">ç¬¬äºŒç«  ä»¥ä¸­å›½å¼ç°ä»£åŒ–å…¨é¢æ¨è¿›ä¸­åæ°‘æ—ä¼Ÿå¤§å¤å…´</h2>\n<h3 id=\"ç¬¬äºŒèŠ‚-ä¸­å›½å¼ç°ä»£åŒ–æ˜¯å¼ºå›½å»ºè®¾ã€æ°‘æ—å¤å…´çš„å”¯ä¸€æ­£ç¡®é“è·¯\">ç¬¬äºŒèŠ‚ ä¸­å›½å¼ç°ä»£åŒ–æ˜¯å¼ºå›½å»ºè®¾ã€æ°‘æ—å¤å…´çš„å”¯ä¸€æ­£ç¡®é“è·¯</h3>\n<h4 id=\"â… -ä¸­å›½å¼ç°ä»£åŒ–æ˜¯ä¸­å›½å…±äº§å…šé¢†å¯¼äººæ°‘é•¿æœŸæ¢ç´¢å’Œå®è·µçš„é‡å¤§æˆæœ\">â…  ä¸­å›½å¼ç°ä»£åŒ–æ˜¯ä¸­å›½å…±äº§å…šé¢†å¯¼äººæ°‘é•¿æœŸæ¢ç´¢å’Œå®è·µçš„é‡å¤§æˆæœ</h4>\n<p><strong>(é—®ï¼šå¦‚ä½•ç†è§£ä¸­å›½å¼ç°ä»£åŒ–æ˜¯ä¸­å›½å…±äº§å…šé¢†å¯¼äººæ°‘é•¿æœŸæ¢ç´¢å’Œå®è·µçš„é‡å¤§æˆæœ?)</strong><br>\nâ‘  <strong>æ–°æ°‘ä¸»ä¸»ä¹‰é©å‘½æ—¶æœŸï¼Œ<strong>æˆ‘ä»¬å…šå›¢ç»“å¸¦é¢†äººæ°‘è¿›è¡Œé©å‘½æ–—äº‰ï¼Œå–å¾—æ–°æ°‘ä¸»ä¸»ä¹‰é©å‘½çš„èƒœåˆ©ï¼Œä¸ºå®ç°ç°ä»£åŒ–åˆ›é€ äº†</strong>æ ¹æœ¬ç¤¾ä¼šæ¡ä»¶</strong>ã€‚<br>\nâ‘¡ <strong>æ”¹é©å¼€æ”¾å’Œç¤¾ä¼šä¸»ä¹‰ç°ä»£åŒ–å»ºè®¾æ–°æ—¶æœŸï¼Œ<strong>æˆ‘ä»¬å…šä½œå‡ºæŠŠå…šå’Œå›½å®¶å·¥ä½œä¸­å¿ƒè½¬ç§»åˆ°ç»æµå»ºè®¾ä¸Šæ¥ã€å®è¡Œæ”¹é©å¼€æ”¾çš„å†å²æ€§å†³ç­–ï¼Œå¼€å¯äº†ä¸­å›½å¼ç°ä»£åŒ–çš„</strong>æ–°é•¿å¾</strong>ã€‚<br>\nâ‘¢ <strong>è¿›å…¥æ–°æ—¶ä»£ï¼Œ</strong> æˆ‘ä»¬å…šå›´ç»•è§£å†³ç°ä»£åŒ–å»ºè®¾ä¸­å­˜åœ¨çš„çªå‡ºçŸ›ç›¾å’Œé—®é¢˜ï¼Œä¸æ–­å®ç°ç†è®ºå’Œå®è·µä¸Šçš„ <strong>åˆ›æ–°çªç ´ï¼Œ</strong> æˆåŠŸæ¨è¿›å’Œæ‹“å±•äº†ä¸­å›½å¼ç°ä»£åŒ–ã€‚</p>\n<h4 id=\"â…¡-ä¸­å›½å¼ç°ä»£åŒ–çš„ä¸­å›½ç‰¹è‰²\">â…¡ ä¸­å›½å¼ç°ä»£åŒ–çš„ä¸­å›½ç‰¹è‰²</h4>\n<p><strong>(é—®ï¼šä¸­å›½å¼ç°ä»£åŒ–ä¸­å›½ç‰¹è‰²çš„å«ä¹‰?)</strong><br>\nâ‘  ä¸­å›½å¼ç°ä»£åŒ–æ˜¯<strong>äººå£è§„æ¨¡å·¨å¤§çš„ç°ä»£åŒ–</strong>ã€‚<br>\nâ‘¡ ä¸­å›½å¼ç°ä»£åŒ–æ˜¯<strong>å…¨ä½“äººæ°‘å…±åŒå¯Œè£•çš„ç°ä»£åŒ–</strong>ã€‚<br>\nâ‘¢ ä¸­å›½å¼ç°ä»£åŒ–æ˜¯<strong>ç‰©è´¨æ–‡æ˜å’Œç²¾ç¥æ–‡æ˜ç›¸åè°ƒçš„ç°ä»£åŒ–</strong>ã€‚<br>\nâ‘£ ä¸­å›½å¼ç°ä»£åŒ–æ˜¯<strong>äººä¸è‡ªç„¶å’Œè°å…±ç”Ÿçš„ç°ä»£åŒ–</strong>ã€‚<br>\nâ‘¤ ä¸­å›½å¼ç°ä»£åŒ–æ˜¯<strong>èµ°å’Œå¹³å‘å±•é“è·¯çš„ç°ä»£åŒ–</strong>ã€‚</p>\n<h4 id=\"â…¢-ä¸­å›½å¼ç°ä»£åŒ–çš„æœ¬è´¨è¦æ±‚\">â…¢ ä¸­å›½å¼ç°ä»£åŒ–çš„æœ¬è´¨è¦æ±‚</h4>\n<p><strong>(é—®ä¸€ï¼šä¸­å›½å¼ç°ä»£åŒ–çš„æœ¬è´¨è¦æ±‚æ˜¯ä»€ä¹ˆ?)</strong><br>\n<strong>åšæŒä¸­å›½å…±äº§å…šé¢†å¯¼ï¼ŒåšæŒä¸­å›½ç‰¹è‰²ç¤¾ä¼šä¸»ä¹‰ï¼Œå®ç°é«˜è´¨é‡å‘å±•ï¼Œå‘å±•å…¨è¿‡ç¨‹äººæ°‘æ°‘ä¸»ï¼Œä¸°å¯Œäººæ°‘ç²¾ç¥ä¸–ç•Œï¼Œå®ç°å…¨ä½“äººæ°‘å…±åŒå¯Œè£•ï¼Œä¿ƒè¿›äººä¸è‡ªç„¶å’Œè°å…±ç”Ÿï¼Œæ¨åŠ¨æ„å»ºäººç±»å‘½è¿å…±åŒä½“ï¼Œåˆ›é€ äººç±»æ–‡æ˜æ–°å½¢æ€ã€‚</strong><br>\n<strong>(é—®äºŒï¼šä¸ºä»€ä¹ˆè¦å¼ºè°ƒå…šåœ¨ä¸­å›½å¼ç°ä»£åŒ–å»ºè®¾ä¸­çš„é¢†å¯¼åœ°ä½?)</strong><br>\nâ‘  å…šçš„é¢†å¯¼å†³å®šä¸­å›½å¼ç°ä»£åŒ–çš„æ ¹æœ¬æ€§è´¨ã€‚<br>\nâ‘¡ å…šçš„é¢†å¯¼ç¡®ä¿ä¸­å›½å¼ç°ä»£åŒ–é”šå®šå¥‹æ–—ç›®æ ‡è¡Œç¨³è‡´è¿œã€‚<br>\nâ‘¢ å…šçš„é¢†å¯¼æ¿€å‘å»ºè®¾ä¸­å›½å¼ç°ä»£åŒ–çš„å¼ºåŠ²åŠ¨åŠ›ã€‚<br>\nâ‘£ å…šçš„é¢†å¯¼å‡èšå»ºè®¾ä¸­å›½å¼ç°ä»£åŒ–çš„ç£…ç¤´åŠ›é‡ã€‚</p>\n<h4 id=\"â…£-ä¸­å›½å¼ç°ä»£åŒ–åˆ›é€ äº†äººç±»æ–‡æ˜æ–°å½¢æ€\">â…£ ä¸­å›½å¼ç°ä»£åŒ–åˆ›é€ äº†äººç±»æ–‡æ˜æ–°å½¢æ€</h4>\n<p><strong>(é—®ï¼šä¸ºä»€ä¹ˆè¯´ä¸­å›½å¼ç°ä»£åŒ–åˆ›é€ äº†äººç±»æ–‡æ˜æ–°å½¢æ€?)</strong><br>\nâ‘  ä¸­å›½å¼ç°ä»£åŒ–æä¾›äº†ä¸€ç§<strong>å…¨æ–°çš„ç°ä»£åŒ–æ¨¡å¼</strong>ã€‚<br>\nâ‘¡ ä¸­å›½å¼ç°ä»£åŒ–æ˜¯å¯¹<strong>è¥¿æ–¹å¼ç°ä»£åŒ–ç†è®ºå’Œå®è·µ</strong>çš„é‡å¤§è¶…è¶Šã€‚<br>\nâ‘¢ ä¸­å›½å¼ç°ä»£åŒ–ä¸º<strong>å¹¿å¤§å‘å±•ä¸­å›½å®¶</strong>æä¾›äº†å…¨æ–°é€‰æ‹©ã€‚</p>\n<h2 id=\"ç¬¬å…­ç« -æ¨åŠ¨é«˜è´¨é‡å‘å±•\">ç¬¬å…­ç«  æ¨åŠ¨é«˜è´¨é‡å‘å±•</h2>\n<h3 id=\"ç¬¬ä¸€èŠ‚-å®Œæ•´ã€å‡†ç¡®ã€å…¨é¢è´¯å½»æ–°å‘å±•ç†å¿µ\">ç¬¬ä¸€èŠ‚ å®Œæ•´ã€å‡†ç¡®ã€å…¨é¢è´¯å½»æ–°å‘å±•ç†å¿µ</h3>\n<h4 id=\"â… -æˆ‘å›½è¿›å…¥æ–°å‘å±•é˜¶æ®µ\">â…  æˆ‘å›½è¿›å…¥æ–°å‘å±•é˜¶æ®µ</h4>\n<p><strong>(é—®ï¼šæ–°å‘å±•é˜¶æ®µçš„å«ä¹‰?)</strong><br>\nâ‘  æˆ‘å›½<strong>ç»æµå¢é•¿é€Ÿåº¦</strong>ä»é«˜é€Ÿè½¬å‘ä¸­é«˜é€Ÿï¼Œ<strong>å‘å±•æ–¹å¼</strong>ä»è§„æ¨¡é€Ÿåº¦å‹è½¬å‘è´¨é‡æ•ˆç‡å‹ï¼Œ<strong>ç»æµç»“æ„</strong>è°ƒæ•´ä»å¢é‡æ‰©èƒ½ä¸ºä¸»è½¬å‘è°ƒæ•´å­˜é‡ã€åšä¼˜å¢é‡å¹¶ä¸¾ï¼Œ<strong>å‘å±•åŠ¨åŠ›</strong>ä»ä¸»è¦ä¾é èµ„æºå’Œä½æˆæœ¬åŠ³åŠ¨åŠ›ç­‰è¦ç´ æŠ•å…¥è½¬å‘åˆ›æ–°é©±åŠ¨ã€‚<br>\nâ‘¡ æ–°å‘å±•é˜¶æ®µæ˜¯æˆ‘å›½<strong>ç¤¾ä¼šä¸»ä¹‰åˆçº§é˜¶æ®µå†å²è¿›ç¨‹ä¸­</strong>çš„ä¸€ä¸ªé‡è¦é˜¶æ®µï¼Œæ˜¯ä¸­å›½å…±äº§å…šå¸¦é¢†äººæ°‘è¿æ¥ä»ç«™èµ·æ¥ã€å¯Œèµ·æ¥åˆ°å¼ºèµ·æ¥<strong>å†å²æ€§è·¨è¶Š</strong>çš„æ–°é˜¶æ®µï¼Œæ˜¯<strong>å…¨é¢å»ºè®¾ç¤¾ä¼šä¸»ä¹‰ç°ä»£åŒ–å›½å®¶ã€å‘ç¬¬äºŒä¸ªç™¾å¹´å¥‹æ–—ç›®æ ‡è¿›å†›</strong>çš„é‡è¦é˜¶æ®µã€‚<br>\nâ‘¢ è¿›å…¥æ–°å‘å±•é˜¶æ®µï¼Œæˆ‘å›½å‘å±•çš„å›½å†…å¤–ç¯å¢ƒè¿›ä¸€æ­¥å‘ç”Ÿæ·±åˆ»å˜åŒ–ï¼Œé¢å¯¹æ–°çš„æˆ˜ç•¥æœºé‡ã€æ–°çš„æˆ˜ç•¥ä»»åŠ¡æ–°çš„æˆ˜ç•¥è¦æ±‚ã€æ–°çš„æˆ˜ç•¥ç¯å¢ƒï¼Œ<strong>éœ€è¦è§£å†³çš„çŸ›ç›¾å’Œé—®é¢˜æ¯”ä»¥å¾€æ›´åŠ é”™ç»¼å¤æ‚</strong>ã€‚</p>\n<h4 id=\"â…¡-è´¯å½»æ–°å‘å±•ç†å¿µæ˜¯å…³ç³»æˆ‘å›½å‘å±•å…¨å±€çš„ä¸€åœºæ·±åˆ»å˜é©\">â…¡ è´¯å½»æ–°å‘å±•ç†å¿µæ˜¯å…³ç³»æˆ‘å›½å‘å±•å…¨å±€çš„ä¸€åœºæ·±åˆ»å˜é©</h4>\n<p><strong>(é—®ä¸€ï¼šä¸ºä»€ä¹ˆè´¯å½»æ–°å‘å±•ç†å¿µæ˜¯å…³ç³»æˆ‘å›½å‘å±•å…¨å±€çš„ä¸€åœºæ·±åˆ»å˜é©?å¦‚ä½•ç†è§£?)</strong><br>\n<strong>è´¯å½»æ–°å‘å±•ç†å¿µæ˜¯æ–°æ—¶ä»£æˆ‘å›½å‘å±•å£®å¤§çš„å¿…ç”±ä¹‹è·¯ã€‚</strong><br>\nâ‘  å‘å±•ç†å¿µæ˜¯å‘å±•è¡ŒåŠ¨çš„å…ˆå¯¼ï¼Œæ˜¯ç®¡å…¨å±€ã€ç®¡æ ¹æœ¬ã€ç®¡æ–¹å‘ã€ç®¡é•¿è¿œçš„ä¸œè¥¿ï¼Œæ˜¯å‘å±•æ€è·¯ã€å‘å±•æ–¹å¼å‘å±•ç€åŠ›ç‚¹çš„é›†ä¸­ä½“ç°ã€‚<br>\nâ‘¡ æ–°å‘å±•ç†å¿µå…·æœ‰<strong>ä¸°å¯Œçš„ç§‘å­¦å†…æ¶µ</strong>å’Œå…·ä½“çš„å®è·µè¦æ±‚ã€‚<strong>(åˆ›æ–°ã€åè°ƒã€ç»¿è‰²ã€å¼€æ”¾ã€å…±äº«)</strong><br>\nâ‘¢ æ–°å‘å±•ç†å¿µæ˜¯æŒ‡æŒ¥æ£’ã€çº¢ç»¿ç¯ï¼Œæ˜¯å¼•é¢†æˆ‘å›½å‘å±•å…¨å±€æ·±åˆ»å˜é©çš„ç§‘å­¦æŒ‡å¼•ï¼Œå¿…é¡»å®Œæ•´ã€å‡†ç¡®ã€å…¨é¢åœ°ç†è§£å’ŒæŠŠæ¡ã€‚<br>\n<strong>(é—®äºŒï¼šæ–°å‘å±•ç†å¿µçš„ä¸°å¯Œç§‘å­¦å†…æ¶µ?)</strong><br>\nâ‘  <strong>åˆ›æ–°</strong>æ˜¯å¼•é¢†å‘å±•çš„ç¬¬ä¸€åŠ¨åŠ›<br>\nâ‘¡ <strong>åè°ƒ</strong>æ˜¯æŒç»­å¥åº·å‘å±•çš„å†…åœ¨è¦æ±‚<br>\nâ‘¢ <strong>ç»¿è‰²</strong>æ˜¯æ°¸ç»­å‘å±•çš„å¿…è¦æ¡ä»¶å’Œäººæ°‘å¯¹ç¾å¥½ç”Ÿæ´»è¿½æ±‚çš„é‡è¦ä½“ç°<br>\nâ‘£ <strong>å¼€æ”¾</strong>æ˜¯å›½å®¶ç¹è£å‘å±•çš„å¿…ç”±ä¹‹è·¯<br>\nâ‘¤ <strong>å…±äº«</strong>æ˜¯ä¸­å›½ç‰¹è‰²ç¤¾ä¼šä¸»ä¹‰çš„æœ¬è´¨è¦æ±‚<br>\n<strong>(é—®ä¸‰ï¼šå¦‚ä½•æŠŠæ–°å‘å±•ç†å¿µ?)</strong><br>\nâ‘  è¦<strong>ä»æ ¹æœ¬å®—æ—¨ä¸Š</strong>æŠŠæ¡æ–°å‘å±•ç†å¿µï¼ŒåšæŒä»¥äººæ°‘ä¸ºä¸­å¿ƒçš„å‘å±•æ€æƒ³ã€‚<br>\nâ‘¡ è¦<strong>ä»é—®é¢˜å¯¼å‘ä¸Š</strong>æŠŠæ¡æ–°å‘å±•ç†å¿µï¼Œåˆ‡å®è§£å†³å‘å±•ä¸å¹³è¡¡ä¸å……åˆ†é—®é¢˜ï¼Œ<br>\nâ‘¢ è¦<strong>ä»å¿§æ‚£æ„è¯†ä¸Š</strong>æŠŠæ¡æ–°å‘å±•ç†å¿µï¼Œç§¯æä¸»åŠ¨ã€æœªé›¨ç¼ªã€‚</p>\n<h4 id=\"â…¢-ä»¥æ–°å‘å±•ç†å¿µå¼•é¢†é«˜è´¨é‡å‘å±•\">â…¢ ä»¥æ–°å‘å±•ç†å¿µå¼•é¢†é«˜è´¨é‡å‘å±•</h4>\n<p><strong>(é—®ä¸€ï¼šé«˜è´¨é‡å‘å±•çš„å«ä¹‰?)</strong><br>\né«˜è´¨é‡å‘å±•ï¼Œæ˜¯èƒ½å¤Ÿå¾ˆå¥½<strong>æ»¡è¶³äººæ°‘æ—¥ç›Šå¢é•¿çš„ç¾å¥½ç”Ÿæ´»éœ€è¦</strong>çš„å‘å±•ï¼Œæ˜¯<strong>ä½“ç°æ–°å‘å±•ç†å¿µ</strong>çš„å‘å±•ï¼Œæ˜¯<strong>åˆ›æ–°</strong>æˆä¸ºç¬¬ä¸€åŠ¨åŠ›ã€<strong>åè°ƒ</strong>æˆä¸ºå†…ç”Ÿç‰¹ç‚¹ã€<strong>ç»¿è‰²</strong>æˆä¸ºæ™®éå½¢æ€ã€<strong>å¼€æ”¾</strong>æˆä¸ºå¿…ç”±ä¹‹è·¯ã€<strong>å…±äº«</strong>æˆä¸ºæ ¹æœ¬ç›®çš„çš„å‘å±•ã€‚<br>\n<strong>(é—®äºŒï¼šé«˜è´¨é‡å‘å±•çš„é‡å¤§æˆ˜ç•¥æ„ä¹‰?)</strong><br>\nâ‘  é«˜è´¨é‡å‘å±•ä¸ºå…¨é¢å»ºè®¾ç¤¾ä¼šä¸»ä¹‰ç°ä»£åŒ–å›½å®¶æä¾›æ›´ä¸º<strong>åšå®çš„ç‰©è´¨åŸºç¡€</strong>ã€‚<br>\nâ‘¡ é«˜è´¨é‡å‘å±•æ˜¯ä¸æ–­æ»¡è¶³äººæ°‘å¯¹ç¾å¥½ç”Ÿæ´»éœ€è¦çš„<strong>é‡è¦ä¿è¯</strong>ã€‚<br>\nâ‘¢ é«˜è´¨é‡å‘å±•æ˜¯ç»´æŠ¤å›½å®¶é•¿æ²»ä¹…å®‰çš„<strong>å¿…ç„¶è¦æ±‚</strong>ã€‚<br>\n<strong>(é—®ä¸‰ï¼šå¦‚ä½•æ¨åŠ¨é«˜è´¨é‡å‘å±•?)</strong><br>\nâ‘  è¦æ›´å¥½ç»Ÿç­¹è´¨çš„æœ‰æ•ˆæå‡å’Œé‡çš„åˆç†å¢é•¿ã€‚<br>\nâ‘¡ è¦ä¿æŒç»æµç¤¾ä¼šå‘å±•ç¨³å®šæ€§ã€‚<br>\nâ‘¢ è¦ä»¥æ”¹é©åˆ›æ–°ä¸ºæ ¹æœ¬åŠ¨åŠ›ã€‚</p>\n<h3 id=\"ç¬¬äºŒèŠ‚-åšæŒå’Œå®Œå–„ç¤¾ä¼šä¸»ä¹‰åŸºæœ¬ç»æµåˆ¶åº¦-é—®-å¦‚ä½•åšæŒå’Œå®Œå–„ç¤¾ä¼šä¸»ä¹‰åŸºæœ¬ç»æµåˆ¶åº¦-æ€ä¹ˆåš\">ç¬¬äºŒèŠ‚ åšæŒå’Œå®Œå–„ç¤¾ä¼šä¸»ä¹‰åŸºæœ¬ç»æµåˆ¶åº¦(é—®:å¦‚ä½•åšæŒå’Œå®Œå–„ç¤¾ä¼šä¸»ä¹‰åŸºæœ¬ç»æµåˆ¶åº¦?æ€ä¹ˆåš?)</h3>\n<h4 id=\"â… -åšæŒå’Œå®Œå–„ç¤¾ä¼šä¸»ä¹‰åŸºæœ¬ç»æµåˆ¶åº¦æ˜¯å®ç°é«˜è´¨é‡å‘å±•çš„ä¿éšœ\">â…  åšæŒå’Œå®Œå–„ç¤¾ä¼šä¸»ä¹‰åŸºæœ¬ç»æµåˆ¶åº¦æ˜¯å®ç°é«˜è´¨é‡å‘å±•çš„ä¿éšœ</h4>\n<p><strong>(é—®ï¼šç¤¾ä¼šä¸»ä¹‰åŸºæœ¬ç»æµåˆ¶åº¦çš„å†…å®¹?)</strong><br>\nç­”:å°†å…¬æœ‰åˆ¶ä¸ºä¸»ä½“ã€å¤šç§æ‰€æœ‰åˆ¶ç»æµå…±åŒå‘å±•ï¼ŒæŒ‰åŠ³åˆ†é…ä¸ºä¸»ä½“ã€å¤šç§åˆ†é…æ–¹å¼å¹¶å­˜ï¼Œç¤¾ä¼šä¸»ä¹‰å¸‚åœºç»æµä½“åˆ¶ç­‰å…±åŒä½œä¸ºç¤¾ä¼šä¸»ä¹‰åŸºæœ¬ç»æµåˆ¶åº¦ã€‚</p>\n<h4 id=\"â…¡-åšæŒâ€œä¸¤ä¸ªæ¯«ä¸åŠ¨æ‘‡â€\">â…¡ åšæŒâ€œä¸¤ä¸ªæ¯«ä¸åŠ¨æ‘‡â€</h4>\n<p><strong>(é—®ï¼šâ€œä¸¤ä¸ªæ¯«ä¸åŠ¨æ‘‡â€çš„å«ä¹‰?)</strong><br>\nç­”:è¦æ¯«ä¸åŠ¨æ‘‡å·©å›ºå’Œå‘å±•å…¬æœ‰åˆ¶ç»æµï¼Œæ¯«ä¸åŠ¨æ‘‡é¼“åŠ±ã€æ”¯æŒã€å¼•å¯¼éå…¬æœ‰åˆ¶ç»æµå‘å±•ã€‚</p>\n<h4 id=\"â…¢-åšæŒæŒ‰åŠ³åˆ†é…ä¸ºä¸»ä½“ã€å¤šç§åˆ†é…æ–¹å¼å¹¶å­˜\">â…¢ åšæŒæŒ‰åŠ³åˆ†é…ä¸ºä¸»ä½“ã€å¤šç§åˆ†é…æ–¹å¼å¹¶å­˜</h4>\n<p>è€ƒç‚¹ä¸€:åŸºæœ¬åˆ†é…åˆ¶åº¦æ˜¯ç”±æˆ‘å›½ç¤¾ä¼šä¸»ä¹‰æ€§è´¨å’ŒåŸºæœ¬å›½æƒ…å†³å®šçš„ã€‚<br>\nè€ƒç‚¹äºŒ:åšæŒå’Œå®Œå–„åŸºæœ¬åˆ†é…åˆ¶åº¦ï¼Œè¦åŠªåŠ›æ¨åŠ¨å±…æ°‘æ”¶å…¥å¢é•¿å’Œç»æµå¢é•¿åŒæ­¥ã€åŠ³åŠ¨æŠ¥é…¬æé«˜å’ŒåŠ³åŠ¨ç”Ÿäº§ç‡æé«˜åŒæ­¥ã€‚<br>\n<strong>(é—®ï¼šåšæŒå’Œå®Œå–„åŸºæœ¬åˆ†é…åˆ¶åº¦æ€ä¹ˆåš?)</strong><br>\nâ‘  å¥å…¨å·¥èµ„å†³å®šå’Œæ­£å¸¸å¢é•¿æœºåˆ¶<br>\nâ‘¡ å¥å…¨ç”Ÿäº§è¦ç´ ç”±å¸‚åœºè¯„ä»·è´¡çŒ®ã€æŒ‰è´¡çŒ®å†³å®šæŠ¥é…¬çš„æœºåˆ¶ã€‚</p>\n<h4 id=\"â…£-æ„å»ºé«˜æ°´å¹³ç¤¾ä¼šä¸»ä¹‰å¸‚åœºç»æµä½“åˆ¶\">â…£ æ„å»ºé«˜æ°´å¹³ç¤¾ä¼šä¸»ä¹‰å¸‚åœºç»æµä½“åˆ¶</h4>\n<p><strong>(é—®ï¼šå¦‚ä½•æ„å»ºé«˜æ°´å¹³ç¤¾ä¼šä¸»ä¹‰å¸‚åœºç»æµä½“åˆ¶?æ€ä¹ˆåš?)</strong><br>\nâ‘  æ„å»ºé«˜æ°´å¹³ç¤¾ä¼šä¸»ä¹‰å¸‚åœºç»æµä½“åˆ¶ï¼Œå…³é”®æ˜¯è¦å¤„ç†å¥½æ”¿åºœå’Œå¸‚åœºçš„å…³ç³»ã€‚(å¸‚åœºåœ¨èµ„æºé…ç½®ä¸­èµ·å†³å®šæ€§ä½œç”¨ï¼Œæ›´å¥½åœ°å‘æŒ¥æ”¿åºœä½œç”¨ã€‚)<br>\nâ‘¡ åŠ å¿«å»ºè®¾é«˜æ ‡å‡†å¸‚åœºä½“ç³»ã€‚(ç»Ÿä¸€å¼€æ”¾ã€ç«äº‰æœ‰åºã€åˆ¶åº¦å®Œå¤‡ã€æ²»ç†å®Œå–„çš„é«˜æ ‡å‡†å¸‚åœºä½“ç³»)â‘¢ æ¨è¿›å®è§‚ç»æµæ²»ç†ä½“ç³»å’Œæ²»ç†èƒ½åŠ›ç°ä»£åŒ–ã€‚<br>\nâ‘£ ä¾æ³•è§„èŒƒå’Œå¼•å¯¼èµ„æœ¬å¥åº·å‘å±•ã€‚</p>\n<h2 id=\"ç¬¬ä¹ç« -å…¨é¢ä¾æ³•æ²»å›½\">ç¬¬ä¹ç«  å…¨é¢ä¾æ³•æ²»å›½</h2>\n<h3 id=\"ç¬¬ä¸€èŠ‚-åšæŒä¸­å›½ç‰¹è‰²ç¤¾ä¼šä¸»ä¹‰æ³•æ²»é“è·¯\">ç¬¬ä¸€èŠ‚ åšæŒä¸­å›½ç‰¹è‰²ç¤¾ä¼šä¸»ä¹‰æ³•æ²»é“è·¯</h3>\n<h4 id=\"â… -å…¨é¢ä¾æ³•æ²»å›½æ˜¯å›½å®¶æ²»ç†çš„ä¸€åœºæ·±åˆ»é©å‘½\">â…  å…¨é¢ä¾æ³•æ²»å›½æ˜¯å›½å®¶æ²»ç†çš„ä¸€åœºæ·±åˆ»é©å‘½</h4>\n<p><strong>é—®ï¼šå…¨é¢ä¾æ³•æ²»å›½æ˜¯å›½å®¶æ²»ç†çš„ä¸€åœºæ·±åˆ»é©å‘½ï¼Œæˆ‘ä»¬å…šæ˜¯å¦‚ä½•æ¨è¿›çš„?(å…¨é¢ä¾æ³•æ²»å›½å…·ä½“ä½“ç°åœ¨å“ªäº›æ–¹é¢?å¦‚ä½•ç†è§£â€œé©å‘½&quot;?)</strong></p>\n<p>â‘  åšæŒä¾å®ªæ²»å›½<br>\nâ‘¡ å®Œå–„ç«‹æ³•ä½“åˆ¶<br>\nâ‘¢ æ¨è¿›æ³•æ²»æ”¿åºœå»ºè®¾<br>\nâ‘£ æ·±åŒ–å¸æ³•ä½“åˆ¶æ”¹é©<br>\nâ‘¤ å®è¡Œå›½å®¶æœºå…³æ™®æ³•è´£ä»»åˆ¶<br>\nâ‘¥ æ·±å…¥æ¨è¿›ä¾è§„æ²»å…š</p>\n<h4 id=\"â…¡-å…¨é¢ä¾æ³•æ²»å›½çš„å”¯ä¸€æ­£ç¡®é“è·¯\">â…¡ å…¨é¢ä¾æ³•æ²»å›½çš„å”¯ä¸€æ­£ç¡®é“è·¯</h4>\n<p>æˆ‘ä»¬å…šé¢†å¯¼äººæ°‘é•¿æœŸæ¢ç´¢èµ°å‡ºçš„ä¸­å›½ç‰¹è‰²ç¤¾ä¼šä¸»ä¹‰æ³•æ²»é“è·¯ï¼Œæ˜¯å…¨é¢ä¾æ³•æ²»å›½çš„å”¯ä¸€æ­£ç¡®é“è·¯ã€‚</p>\n<p><strong>é—®ï¼šåšæŒå’Œæ‹“å±•ä¸­å›½ç‰¹è‰²ç¤¾ä¼šä¸»ä¹‰æ³•æ²»é“è·¯è¦æŠŠæ¡çš„æ ¸å¿ƒè¦ä¹‰ä»¥åŠåšæŒçš„åŸåˆ™?(èµ°ä¸­å›½ç‰¹è‰²ç¤¾ä¼šä¸»ä¹‰æ³•æ²»é“è·¯æ€ä¹ˆåš?ä¸­å›½ç‰¹è‰²ç¤¾ä¼šä¸»ä¹‰æ³•æ²»é“è·¯çš„è¦æ±‚?)</strong><br>\nâ‘  ä¸­å›½ç‰¹è‰²ç¤¾ä¼šä¸»ä¹‰æ³•æ²»é“è·¯çš„æ ¸å¿ƒè¦ä¹‰ï¼Œå°±æ˜¯è¦åšæŒå…šçš„é¢†å¯¼ï¼ŒåšæŒä¸­å›½ç‰¹è‰²ç¤¾ä¼šä¸»ä¹‰åˆ¶åº¦ï¼Œè´¯å½»ä¸­å›½ç‰¹è‰²ç¤¾ä¼šä¸»ä¹‰æ³•æ²»ç†è®ºã€‚<br>\nâ‘¡ åšæŒä¸­å›½å…±äº§å…šçš„é¢†å¯¼ã€‚<br>\nâ‘¢ åšæŒä»¥äººæ°‘ä¸ºä¸­å¿ƒã€‚<br>\nâ‘£ åšæŒæ³•å¾‹é¢å‰äººäººå¹³ç­‰ã€‚<br>\nâ‘¤ åšæŒä¾æ³•æ²»å›½å’Œä»¥å¾·æ²»å›½ç›¸ç»“åˆã€‚<br>\nâ‘¥ åšæŒä»ä¸­å›½å®é™…å‡ºå‘ã€‚</p>\n<h4 id=\"â…¢-ç»Ÿç­¹å¤„ç†å…¨é¢ä¾æ³•æ²»å›½çš„é‡å¤§å…³ç³»\">â…¢ ç»Ÿç­¹å¤„ç†å…¨é¢ä¾æ³•æ²»å›½çš„é‡å¤§å…³ç³»</h4>\n<p><strong>é—®ï¼šå…¨é¢ä¾æ³•æ²»å›½è¦æ­£ç¡®å¤„ç†å“ªäº›é‡å¤§å…³ç³»?</strong><br>\nâ‘  æ­£ç¡®å¤„ç†æ”¿æ²»å’Œæ³•æ²»çš„å…³ç³»ã€‚<br>\nâ‘¡æ­£ç¡®å¤„ç†æ”¹é©å’Œæ³•æ²»çš„å…³ç³»ï¼Œ<br>\nâ‘¢æ­£ç¡®å¤„ç†ä¾æ³•æ²»å›½å’Œä»¥å¾·æ²»å›½çš„å…³ç³»<br>\nâ‘£ æ­£ç¡®å¤„ç†ä¾æ³•æ²»å›½å’Œä¾è§„æ²»å…šçš„å…³ç³»ã€‚</p>\n<h2 id=\"ç¬¬åå…­ç« -ä¸­å›½ç‰¹è‰²å¤§å›½å¤–äº¤å’Œæ¨åŠ¨æ„å»ºäººç±»å‘½è¿å…±åŒä½“\">ç¬¬åå…­ç«  ä¸­å›½ç‰¹è‰²å¤§å›½å¤–äº¤å’Œæ¨åŠ¨æ„å»ºäººç±»å‘½è¿å…±åŒä½“</h2>\n<h3 id=\"ç¬¬äºŒèŠ‚-å…¨é¢æ¨è¿›ä¸­å›½ç‰¹è‰²å¤§å›½å¤–äº¤-é—®-å…¨é¢æ¨è¿›ä¸­å›½ç‰¹è‰²å¤§å›½å¤–äº¤æ€ä¹ˆåš\">ç¬¬äºŒèŠ‚ å…¨é¢æ¨è¿›ä¸­å›½ç‰¹è‰²å¤§å›½å¤–äº¤(é—®:å…¨é¢æ¨è¿›ä¸­å›½ç‰¹è‰²å¤§å›½å¤–äº¤æ€ä¹ˆåš?)</h3>\n<h4 id=\"â… -åšæŒèµ°å’Œå¹³å‘å±•é“è·¯\">â…  åšæŒèµ°å’Œå¹³å‘å±•é“è·¯</h4>\n<p><strong>(é—®ä¸€ï¼šä¸­å›½ä¸ºä»€ä¹ˆåšæŒèµ°å’Œå¹³å‘å±•é“è·¯?)</strong><br>\nâ‘  èµ°å’Œå¹³å‘å±•é“è·¯æ˜¯ç”±ä¸­å›½å…±äº§å…šæ€§è´¨å®—æ—¨å’Œæˆ‘å›½ç¤¾ä¼šä¸»ä¹‰åˆ¶åº¦å†³å®šçš„ã€‚<br>\nâ‘¡ èµ°å’Œå¹³å‘å±•é“è·¯æ˜¯åŸºäºä¸­å›½å†å²æ–‡åŒ–ä¼ ç»Ÿä½œå‡ºçš„å¿…ç„¶é€‰æ‹©ã€‚<br>\nâ‘¢ èµ°å’Œå¹³å‘å±•é“è·¯ç¬¦åˆå†å²æ½®æµã€é¡ºåº”ä¸–ç•Œå¤§åŠ¿ã€‚<br>\n<strong>(é—®äºŒï¼šå¦‚ä½•ç†è§£åšæŒèµ°å’Œå¹³å‘å±•é“è·¯?)</strong><br>\nâ‘  èµ°å’Œå¹³å‘å±•é“è·¯ï¼Œæ˜¯å¯¹å›½é™…ç¤¾ä¼šå…³æ³¨ä¸­å›½å‘å±•èµ°å‘çš„å›åº”ï¼Œæ›´æ˜¯ä¸­å›½äººæ°‘å¯¹å®ç°è‡ªèº«å‘å±•ç›®æ ‡çš„è‡ªä¿¡å’Œè‡ªè§‰ã€‚<br>\næ€ä¹ˆåš: â‘¡ èµ°å’Œå¹³å‘å±•é“è·¯ï¼Œå°±è¦åšå®šå¥‰è¡Œç‹¬ç«‹è‡ªä¸»çš„å’Œå¹³å¤–äº¤æ”¿ç­–ã€‚<br>\nâ‘¢ èµ°å’Œå¹³å‘å±•é“è·¯ï¼Œæ—¢è¦é€šè¿‡ç»´æŠ¤ä¸–ç•Œå’Œå¹³å‘å±•è‡ªå·±ï¼Œåˆè¦é€šè¿‡è‡ªèº«å‘å±•ç»´æŠ¤ä¸–ç•Œå’Œå¹³</p>\n<h4 id=\"â…¡-æ¨åŠ¨æ„å»ºæ–°å‹å›½é™…å…³ç³»\">â…¡ æ¨åŠ¨æ„å»ºæ–°å‹å›½é™…å…³ç³»</h4>\n<p><strong>(é—®ï¼šæ¨åŠ¨æ„å»ºæ–°å‹å›½é™…å…³ç³»æ€ä¹ˆåš?)</strong><br>\nâ‘  æ¨è¿›å¤§å›½åè°ƒåˆä½œï¼Œæ„å»ºå’Œå¹³å…±å¤„ã€æ€»ä½“ç¨³å®šã€å‡è¡¡å‘å±•çš„å¤§å›½å…³ç³»æ ¼å±€ï¼Œæ˜¯ä¸­å›½å¯¹å¤–å…³ç³»çš„é‡è¦å†…å®¹ã€‚<br>\nâ‘¡ åšæŒäº²è¯šæƒ å®¹å’Œä¸é‚»ä¸ºå–„ã€ä»¥é‚»ä¸ºä¼´å‘¨è¾¹å¤–äº¤æ–¹é’ˆï¼Œæ·±åŒ–åŒå‘¨è¾¹å›½å®¶å‹å¥½äº’ä¿¡å’Œåˆ©ç›Šèåˆã€‚<br>\nâ‘¢ ç§‰æŒçœŸå®äº²è¯šç†å¿µå’Œæ­£ç¡®ä¹‰åˆ©è§‚ï¼ŒåŠ å¼ºåŒå‘å±•ä¸­å›½å®¶å›¢ç»“åˆä½œã€‚<br>\nâ‘£ ç§‰æŒæ±‚åŒå­˜å¼‚ã€ç›¸äº’å°Šé‡ã€äº’å­¦äº’é‰´ç†å¿µï¼Œæ„å»ºæ–°å‹æ”¿å…šå…³ç³»ã€‚</p>\n<h4 id=\"â…¢-åšå†³ç»´æŠ¤å›½å®¶ä¸»æƒã€å®‰å…¨ã€å‘å±•åˆ©ç›Š\">â…¢ åšå†³ç»´æŠ¤å›½å®¶ä¸»æƒã€å®‰å…¨ã€å‘å±•åˆ©ç›Š</h4>\n<p>â‘  æˆ‘å›½å¤–äº¤å·¥ä½œå§‹ç»ˆç«™åœ¨ç»´æŠ¤å›½å®¶åˆ©ç›Šå’Œæ°‘æ—å°Šä¸¥çš„å‰çº¿ã€‚<br>\nâ‘¡ ç»´æŠ¤å›½å®¶ä¸»æƒã€å®‰å…¨ã€å‘å±•åˆ©ç›Šï¼Œå¿…é¡»æ•¢äºæ–—äº‰ã€å–„äºæ–—äº‰ã€‚</p>\n<h4 id=\"â…£-åšæŒå¤–äº¤ä¸ºæ°‘\">â…£ åšæŒå¤–äº¤ä¸ºæ°‘</h4>\n<p><strong>(é—®ï¼šæ€ä¹ˆåš?)</strong><br>\nâ‘  åšæŒå¤–äº¤ä¸ºæ°‘ï¼Œå°±è¦åšå®šç»´æŠ¤æˆ‘å›½æµ·å¤–å…¬æ°‘å’Œæ³•äººæ­£å½“æƒç›Šã€‚<br>\nâ‘¡ ç§¯æå¼€å±•æ°‘é—´å¤–äº¤ã€‚</p>\n<h2 id=\"ç¬¬åä¸ƒç« -å…¨é¢ä»ä¸¥æ²»å…š\">ç¬¬åä¸ƒç«  å…¨é¢ä»ä¸¥æ²»å…š</h2>\n<h3 id=\"ç¬¬äºŒèŠ‚-ä»¥æ”¿æ²»å»ºè®¾ä¸ºç»Ÿé¢†æ·±å…¥æ¨è¿›å…šçš„å»ºè®¾-é—®-å…šçš„å»ºè®¾çš„æ€»ä½“å¸ƒå±€æ˜¯ä»€ä¹ˆ\">ç¬¬äºŒèŠ‚ ä»¥æ”¿æ²»å»ºè®¾ä¸ºç»Ÿé¢†æ·±å…¥æ¨è¿›å…šçš„å»ºè®¾(é—®:å…šçš„å»ºè®¾çš„æ€»ä½“å¸ƒå±€æ˜¯ä»€ä¹ˆ?)</h3>\n<h4 id=\"â… -æŠŠå…šçš„æ”¿æ²»å»ºè®¾æ‘†åœ¨é¦–ä½\">â…  æŠŠå…šçš„æ”¿æ²»å»ºè®¾æ‘†åœ¨é¦–ä½</h4>\n<p><strong>(é—®ï¼šå…šçš„æ”¿æ²»å»ºè®¾æ‘†åœ¨é¦–ä½ï¼Œè¯¥æ€ä¹ˆåš?)</strong><br>\næ——å¸œé²œæ˜è®²æ”¿æ²»æ˜¯æˆ‘ä»¬å…šä½œä¸ºé©¬å…‹æ€ä¸»ä¹‰æ”¿å…šçš„æ ¹æœ¬è¦æ±‚ã€‚<br>\nâ‘  ä¿è¯å…¨å…šæœä»ä¸­å¤®ï¼Œç»´æŠ¤å…šä¸­å¤®æƒå¨å’Œé›†ä¸­ç»Ÿä¸€é¢†å¯¼ï¼Œæ˜¯å…šçš„æ”¿æ²»å»ºè®¾çš„é¦–è¦ä»»åŠ¡ã€‚<br>\nâ‘¡ å‘æŒ¥å…šçš„æ”¿æ²»å»ºè®¾çš„ç»Ÿé¢†æ€§ä½œç”¨ï¼Œå¿…é¡»æŠŠå‡†æ”¿æ²»æ–¹å‘ã€ç«™ç¨³æ”¿æ²»ç«‹åœºã€è¥é€ è‰¯å¥½æ”¿æ²»ç”Ÿæ€ã€æé«˜æ”¿æ²»<br>\nèƒ½åŠ›ã€‚</p>\n<h4 id=\"â…¡-æ€æƒ³å»ºè®¾æ˜¯å…šçš„åŸºç¡€æ€§å»ºè®¾\">â…¡ æ€æƒ³å»ºè®¾æ˜¯å…šçš„åŸºç¡€æ€§å»ºè®¾</h4>\n<p><strong>(é—®ï¼šä¸ºä»€ä¹ˆè¦åŠ å¼ºå…šçš„æ€æƒ³å»ºè®¾?)</strong><br>\nâ‘  åŠ å¼ºæ€æƒ³å»ºè®¾æ˜¯åšå®ˆç†æƒ³ä¿¡å¿µã€åšå®šé©å‘½æ„å¿—çš„å‰æã€‚<br>\nâ‘¡ åŠ å¼ºæ€æƒ³å»ºè®¾æ˜¯ä¿æŒæ”¿æ²»ä¸Šæ¸…é†’åšå®šã€è¡ŒåŠ¨ä¸Šå›¢ç»“ç»Ÿä¸€çš„è¦æ±‚ã€‚<br>\nâ‘¢ åŠ å¼ºæ€æƒ³å»ºè®¾æ˜¯è´¯å½»å…šçš„ç†è®ºå’Œè·¯çº¿æ–¹é’ˆæ”¿ç­–ã€æ¨è¿›å…šå’Œå›½å®¶äº‹ä¸šå‘å±•çš„é‡è¦ä¿éšœã€‚</p>\n<h4 id=\"â…¢-è´¯å½»æ–°æ—¶ä»£å…šçš„ç»„ç»‡è·¯çº¿\">â…¢ è´¯å½»æ–°æ—¶ä»£å…šçš„ç»„ç»‡è·¯çº¿</h4>\n<p><strong>(é—®ï¼šå¦‚ä½•è´¯å½»æ–°æ—¶ä»£å…šçš„ç»„ç»‡è·¯çº¿?æ€ä¹ˆåš?)</strong><br>\nâ‘  ä¸¥å¯†å…šçš„ç»„ç»‡ä½“ç³»æ˜¯é‡ç‚¹ã€‚<br>\nâ‘¡ å»ºè®¾é«˜ç´ è´¨ä¸“ä¸šåŒ–å¹²éƒ¨é˜Ÿä¼æ˜¯å…³é”®ã€‚</p>\n<h4 id=\"â…£-ä»¥ä¸¥çš„åŸºè°ƒå¼ºåŒ–æ­£é£è‚ƒçºª\">â…£ ä»¥ä¸¥çš„åŸºè°ƒå¼ºåŒ–æ­£é£è‚ƒçºª</h4>\n<p><strong>(é—®ï¼šå¼ºåŒ–æ­£é£è‚ƒçºªçš„å«ä¹‰?)</strong><br>\nâ‘  ä½œé£é—®é¢˜æ ¸å¿ƒæ˜¯å…šåŒäººæ°‘ç¾¤ä¼—çš„å…³ç³»é—®é¢˜ã€‚åŠ å¼ºä½œé£å»ºè®¾ï¼Œå¿…é¡»ç´§ç´§å›´ç»•ä¿æŒå…šåŒäººæ°‘ç¾¤ä¼—çš„è¡€è‚‰è”ç³»ã€‚<br>\nâ‘¡ å…šè¦ç®¡å…šã€ä»ä¸¥æ²»å…šï¼Œå°±è¦é ä¸¥æ˜çºªå¾‹å’Œè§„çŸ©ã€‚</p>\n<h4 id=\"â…¤-æŠŠåˆ¶åº¦å»ºè®¾è´¯ç©¿åˆ°å…šçš„å„é¡¹å»ºè®¾ä¹‹ä¸­\">â…¤ æŠŠåˆ¶åº¦å»ºè®¾è´¯ç©¿åˆ°å…šçš„å„é¡¹å»ºè®¾ä¹‹ä¸­</h4>\n<p><strong>(é—®ï¼šæŠŠåˆ¶åº¦å»ºè®¾è´¯ç©¿åˆ°å…šçš„å„é¡¹å»ºè®¾ä¹‹ä¸­ï¼Œè¯¥æ€ä¹ˆåš?)</strong><br>\nâ‘  åšæŒåˆ¶åº¦æ²»å…šã€ä¾è§„æ²»å…šï¼Œå°±æ˜¯é åˆ¶åº¦ç®¡æƒã€ç®¡äº‹ã€å®˜äººã€‚<br>\nâ‘¡ åˆ¶å®šåˆ¶åº¦å¾ˆé‡è¦ï¼Œæ›´é‡è¦çš„æ˜¯æŠ“è½å®ã€‚</p>\n\n\n\t<div class=\"row\">\n    <embed src=\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/pdf/ä¹ æ¦‚/ä¹ æ¦‚é‡ç‚¹æ•´ç†.pdf\" width=\"100%\" height=\"550\" type=\"application/pdf\">\n\t</div>\n\n\n","tags":["å¤ä¹ ","ä¹ æ¦‚"]},{"title":"entertainment","url":"/post/5dcf0f53.html","content":"<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â ˆâ¢†â £â¡€â €â£€â£€â£¤â£¤â£¤â£¶â£¶â£¶â£¶â£¶â£¶â£¶â£¶â£¶â£¦â£¤â£¤â£¤â£„â£€â£€â¡€â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢€â£ â£¤â£·â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£·â£¶â£¦â£¤â£€â£€â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢€â£ â£´â£¾â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¶â£¤â£„â¡€â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â£ â£¶â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£·â£¶â¡„â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â €â €â €â €â €â €â €â €â €â €â €â£ â£¾â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡„â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â €â €â €â €â €â €â €â €â €â¢ â£¾â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡‡â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â €â €â €â €â €â €â €â €â£°â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â ‡â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â ¤â ¤â£„â£€â €â €â €â €â €â €â£¼â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡¿â ¿â¢¿â¡Ÿâ €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â£ â ‹â£¸â£·â£¤â¡€â €â €â£¼â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡¿â ¿â ›â ‹â ‰â ‰â ›â “â ¦â¡€â ˆâ ¢â¡€â €â €â €â €â €â €â €â£€â ¤â â ‚â ‰â ‰â ‰â ‰â â ’â ‚â ¤â¡€â €â €â €â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â£ â¢â£¼â£¿â£¿â£¿â£¿â£¦â£¼â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡¿â Ÿâ ›â ›â ›â ‰â ‰â â¢„â €â €â €â €â €â €â €â €â €â €â â¢„â¡ˆâ¢†â €â €â €â €â  â Šâ â €â €â €â €â£€â£ â£¤â ¤â ¤â ¤â ¤â£ˆâ â¡„â €â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â ˆâ ›â ¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡‰â €â €â €â €â €â €â €â €â €â €â ¢â¡€â €â €â €â €â €â €â €â €â €â €â ˆâ ¢â£§â €â €â¡”â â €â €â €â£ â£´â¡¿â ¿â ­â ¤â£„â¡€â €â €â €â ‰â¢ºâ¡„â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â €â €â €â¢€â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡¿â Ÿâ ›â â €â ™â »â£„â €â €â €â €â €â €â €â €â €â €â ˆâ ‘â ¤â¡€â €â €â €â €â €â €â €â €â €â ˆâ¢§â¡°â €â €â €â£ â â ‹â €â €â €â €â €â €â ™â¢¦â €â €â €â €â¢¹â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â¢€â£¤â£¶â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â ¿â ›â ‹â ™â¢„â €â €â €â €â €â €â ˆâ ³â¡€â €â €â €â €â €â €â €â €â €â €â €â ˆâ â ¢â ¤â¢€â£°â¡†â£€â£€â£€â €â¢€â¡ƒâ €â €â¡°â â €â €â €â €â €â €â €â €â €â €â ƒâ €â €â €â¢¸â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â¢€â£´â£¿â£¿â£¿â£¿â¡¿â ™â ¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡¿â ¿â ›â ‹â ‰â¢£â €â €â €â €â €â ±â¢„â €â €â €â €â €â €â ˆâ ¢â¡€â €â €â €â €â €â â¡€â €â €â €â €â €â €â¡´â ¥â£·â â ‰â €â €â €â ˆâ ‘â¢´â â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢¸â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â£¿â£¿â£¿â£¿â£¿â¡Ÿâ â €â €â¢ â ƒâ €â €â €â €â €â ˆâ£¹â£¿â¡¿â£¿â£¿â ¿â Ÿâ ›â ‹â¡Ÿâ â €â €â €â €â €â €â ±â¡€â €â €â €â €â ˆâ ³â¡€â €â €â €â €â €â €â ˆâ¢¢â €â €â €â €â €â¢ â €â €â €â €â €â €â €â¢€â ‡â €â €â €â €â €â €â €â €â¢£â €â €â €â €â €â €â €â €â €â €â €â „â €â €â €â¡Œâ €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â¢›â¢¿â£¿â£¿â Ÿâ €â €â €â¢€â ‡â €â¡â €â €â €â €â €â£¿â â €â €â €â €â €â €â¢ â ‡â €â €â €â €â €â €â €â €â ™â¡„â €â €â €â €â €â ™â£¦â¡€â €â €â €â €â €â €â¡‘â¡„â €â €â €â €â¢³â €â €â €â €â¢€â €â¢¸â €â €â €â €â €â €â €â €â €â¢¸â£„â¡€â €â €â €â €â €â €â €â£€â Šâ €â €â €â¡â €â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â£ â ¶â ‹â â €â €â €â €â â €â£¸â ƒâ €â €â €â €â¢°â¡Ÿâ €â €â €â €â €â €â €â¢¸â €â €â €â €â €â €â €â €â €â €â ˜â£„â €â €â €â €â €â ˜â¢¿â£¦â¡€â €â €â €â €â ˜â¡Œâ¢†â €â €â €â ˆâ¢â ‰â â €â €â €â ˜â¡„â €â €â €â €â €â €â €â¢ â£â ‰â ‰â ‘â ’â ¤â ¤â ¤â ¤â Šâ €â €â €â €â¡°â â €â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â €â €â €â €â¡°â €â¢ â£¿â €â €â €â €â €â£¿â ƒâ €â €â €â €â €â €â €â¢¸â €â €â €â €â €â €â €â €â €â €â €â ¸â¡„â €â €â €â €â €â €â ¹â£¿â£„â €â €â €â €â ±â¡œâ£§â¡±â €â €â ˜â¡„â €â €â €â €â €â ‘â ¦â£€â¡€â €â¢€â£ â£´â¢¿â¢¿â£·â£¤â£„â¡€â €â €â €â €â €â €â €â¡ â Šâ €â €â €â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â €â €â €â¢ â ƒâ €â£¾â¡‡â €â €â €â €â¢ â£¿â €â €â €â €â €â €â €â €â¢¸â €â €â €â €â €â €â €â €â €â €â €â €â¢¹â¡ˆâ¢†â €â €â €â €â €â ¹â£¿â£¦â¡€â €â €â €â¢±â ¬â£·â£…â €â €â¢£â €â €â €â €â €â €â €â£¸â¡¿â ‹â ‰â â¡¿â ˆâ¢®â¢»â¡»â ¿â£¿â£¶â£’â¡’â ’â ’â ‚â ‰â €â €â €â €â €â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â €â €â €â¡ˆâ €â£¸â£¿â €â €â €â €â €â¢¸â¡â €â €â €â €â €â €â €â €â¢¸â¡„â €â €â €â €â €â €â €â €â €â €â €â €â¢§â ¸â¡„â €â €â €â €â €â¢¹â¡„â ‰â ‡â ‚â ¤â£€â ƒâ ˜â£¿â¡„â €â ˆâ¡†â €â €â €â €â¢ â¡¾â ‹â €â €â €â €â ‡â €â¢¸â §â¡â¢¦â¡€â €â €â €â ‰â â ’â ‚â €â¢€â£€â ²â –â Šâ €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â €â €â¢€â ‡â €â¡¿â¡‡â €â €â €â €â €â¡¿â¡‡â €â €â €â €â €â €â €â €â¢¸â¡‡â €â €â €â €â €â €â €â €â €â €â €â €â ˜â¡†â¢±â¡€â €â €â €â €â €â¢³â €â ¸â¡„â €â €â ‰â¢¢â£¸â£¿â¡€â €â¢¸â €â €â¢€â ´â ‹â €â €â €â €â¢€â¡¸â €â €â ˆâ¡‡â ˆâ ²â£Œâ ²â¢„â¡€â €â ‰â ‰â ­â£‰â â €â €â €â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â €â €â¢¸â €â €â¡‡â¡‡â €â €â €â €â €â¡‡â¡‡â €â €â €â °â €â €â €â €â¢¸â£·â €â €â €â €â €â €â €â €â €â €â €â €â €â¢¹â €â£‡â €â €â €â €â €â ˆâ¡‡â €â ˆâ ‘â ²â¢¤â£¤â£½â¡â¢ƒâ €â ˆâ¡„â â €â €â €â €â €â €â €â£¾â ƒâ €â €â €â¢³â €â €â €â ™â ¢â£â¡²â¢¤â£€â£€â €â ‰â €â ’â  â ¤â „â €â €â¢¤â ”â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â €â €â¡‡â €â¢ â¢°â¢ â €â €â €â €â¢ â¡‡â¡‡â €â €â €â €â¡„â €â €â €â ˜â£¿â£‡â €â €â €â €â €â €â €â €â €â €â €â €â ˜â¡†â ¸â¡„â €â €â¢¸â¡€â €â¢»â €â €â €â €â €â¢«â¡©â µâ£®â¡†â €â¢±â â¢„â£€â¡€â£€â£€â£€â¡¾â ƒâ €â €â €â €â¢¸â¡„â €â €â €â €â €â ‰â ›â ²â ¯â£­â¡­â ›â ‹â â¢€â£€â ¤â â â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â €â €â¡‡â €â¢¸â£¸â¡˜â €â €â €â €â €â£§â ƒâ €â €â €â €â£‡â €â €â €â €â¡Ÿâ£¿â¡„â €â €â €â €â €â €â €â €â €â €â €â €â¢§â €â£‡â €â €â¢¸â¡‡â €â ˆâ¡‡â €â£€â „â ‚â â ³â£„â ˆâ¢»â €â ˆâ¡†â ¢â¢½â£„â¢€â£€â¡™â¢¦â¡’â ’â ¦â¢”â¡Šâ ‰â ³â¡€â €â €â €â €â €â €â €â €â €â ˆâ ‰â ‰â ‰â â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â €â €â €â €â¢¸â¡‡â¡‡â €â €â €â£€â£€â£¿â£°â €â €â €â €â¢¸â €â €â €â €â£‡â ˜â£·â¡€â €â €â €â €â €â €â €â €â €â €â €â¢¸â €â£¿â €â €â¢¸â£¿â €â£€â£·â Šâ €â €â €â €â €â €â ‰â ‰â¡‡â¡€â£§â£¤â£¼â ¿â¢‡â¡¤â €â ‘â£‡â â ’â¢’â£¡â£€â£±â ƒâ €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â €â €â¡€â €â¢¸â¡‡â¡‡â €â¢¯â ­â ­â µâ¢¶â¡â¡‡â €â €â €â ˆâ¡‡â €â €â €â¢¸â €â ˆâ¢·â¡€â €â €â €â €â €â €â €â €â €â €â¢¸â €â£¿â €â €â¢¸â£¿â¡Ÿâ â¢¸â €â €â €â €â €â¢€â£ â£¶â£¿â£¿â£·â¢»â¡¿â â €â ›â €â €â €â ˆâ£–â¢¶â£¿â£¿â¡¿â ¿â¡†â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â €â €â¡‡â €â¢¸â¡‡â¢§â €â €â €â €â£€â£¤â£·â£¿â €â €â €â €â£¿â¡€â €â €â ˜â¡†â €â ˆâ¢³â¡€â €â €â €â €â €â €â €â €â €â¢¸â €â¡â €â €â Šâ¡»â¢¸â €â£¼â €â €â£ â£¶â£¿â£¿â£¿â£¿â£Ÿâ¢›â ‰â¡â¡â €â €â €â €â €â €â €â£˜â €â €â €â €â €â¢°â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â €â €â¢ƒâ €â¢¸â¢¹â ¸â €â €â¢°â£¿â¢¿â£›â£¿â£½â¡¦â €â €â €â¢¹â£·â €â €â €â¢±â €â €â €â ³â¡€â €â €â °â¡€â €â €â €â €â¡¼â¢°â¢§â¡€â €â €â¡‡â ¸â¡â¡‡â£´â£¿â¡¿â¢›â£¿â£¿â£¿â£¿â£¿â ¸â €â ‡â¡‡â €â €â €â €â €â €â €â£¿â¡†â €â €â €â €â ˜â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â €â €â ¸â¡€â ˆâ¢¸â €â ‡â €â €â °â Ÿâ ‹â ‰â£§â ¹â¡„â €â €â ¸â£¿â¢³â¡’â ‰â ™â¡â ‰â ‰â ‰â ›â£†â €â €â ˜â¢¦â¡€â €â¢ â¢§â¡Ÿâ €â¢³â¡€â¢ â ƒâ¢ â¢£â¢³â¡¿â ›â¢¶â£¿â£¿â£¿â£¿â£¿â£¿â ƒâ¡â €â¢¡â €â €â €â €â¢€â ‡â¢¸â¡â£¿â €â €â €â €â €â¢‡â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â €â €â €â¢ƒâ €â¡˜â¡€â¢¸â €â €â €â €â €â €â ¸â¡„â¢§â €â €â €â£¿â €â ±â¡„â €â ˜â¡„â €â €â €â ˆâ ³â¡„â €â ˆâ »â¡¢â£¼â£¿â â €â €â ‘â£¼â €â¢¸â¡â €â €â €â €â »â¢¿â£¿â£¿â£¿â ¿â ‚â¢£â €â¢ºâ €â €â €â â ‹â£ â£¿â ‡â¢¹â¡†â €â €â €â €â ˜â¡€â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â €â €â €â ˆâ¢†â¡‡â¡‡â €â£†â €â €â €â €â €â €â¢³â¡ˆâ¢§â €â €â¢¸â €â €â ˆâ ¢â¡€â ™â£„â €â €â ’â ’â ¨â ³â¢„â£€â¡¼â «â£™â¡¦â¢„â£€â €â ˆâ ³â¢¯â â €â €â €â €â €â ˆâ ‰â â €â €â €â¢¸â €â¢¸â €â €â£¾â£â¡´â Ÿâ ‰â €â €â£§â €â €â €â €â €â¢‡â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â €â €â €â €â ˜â£‡â¢¿â¡€â¢¸â¡„â €â €â €â €â €â ˆâ¢§â ˜â¢†â €â ˜â¡‡â €â €â €â ˆâ “â ¬â£¢â¡€â €â €â €â €â â ‰â ‘â ²â¢¬â ·â£¦â£â¡‰â ’â ²â ¿â ­â ¶â ¤â €â €â €â €â €â €â €â €â €â ˜â¡€â¢¸â €â£°â£¿â£¿â£„â €â €â €â €â¢¿â €â €â €â €â €â ˜â¡„â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â €â €â €â €â¢€â£¸â¡¼â£—â¢ºâ£¿â¡›â ›â ›â ›â ²â¢¦â¢¸â£§â ˆâ¢†â €â¢±â£„â €â €â €â €â €â €â£‰â£‘â£¢â£¤â£¤â¡¤â €â €â¢ â¢‡â¡´â ‹â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¡‡â£¸â¢°â£¿â¡â¢¸â£¿â£§â €â €â €â¢¸â¡‡â €â €â €â €â €â¢±â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â €â €â£ â¡¶â ‹â ‘â¡Œâ¡Ÿâ£¿â¡¿â£§â €â €â €â €â €â €â¢»â£·â¡ˆâ¢£â ˆâ£¿â£·â£¤â£´â£¿â ¿â ¿â ›â Ÿâ ›â ‰â €â €â €â  â Ÿâ ‰â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¡‡â£¿â¢¿â£¿â¡‡â£¿â£¿â£¿â£§â €â €â¢¸â£¿â €â €â €â €â €â €â¢‡â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â €â£°â ‹â €â €â €â ‡â¢°â¡‡â¢§â ¹â£§â €â €â €â €â €â €â¢»â£·â£„â ³â¡¹â£¿â£¸â£·â£„â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¡‡â¡¿â ˜â£¿â£·â£¿â£¿â£¿â£¿â£¦â €â ˜â£¿â¡†â  â¡€â €â €â €â ˆâ¡†â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â¡€â  â â €â €â €â €â ¸â¡˜â£‡â¢¸â €â ˜â£·â¡€â €â €â €â €â €â¢»â¡â ¢â¡™â¢¿â£¿â¢¿â ™â¢§â¡€â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢€â¡´â¡‡â¡‡â €â£¿â£¿â£¿â£¿â£¿â ¿â ›â €â €â£¿â£§â €â ±â¡€â €â €â €â ˜â¡„â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â  â£¾â¢›â£·â ¶â €â €â €â €â €â¢±â ˜â£¼â €â €â£¿â¡·â£„â €â €â €â €â €â ¹â¡„â ™â¢®â¡¹â£‡â ‰â£¦â£µâ¡„â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â  â ‚â €â €â €â €â €â£ â£¾â£¦â¢â¡‡â¢°â£¿â¡Ÿâ ‹â ‰â €â €â €â €â €â¢¸â ˆâ£‡â €â ˜â£†â €â €â €â ˜â¡„â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â£¿â Ÿâ ¸â €â €â €â €â €â €â£¾â£§â¢¹â¡„â¢ â¡Ÿâ£·â¡˜â¢¦â¡€â €â €â €â €â ¹â¡„â €â ˆâ ªâ£·â¢½â €â »â¢¦â €â €â €â €â €â €â €â €â €â €â €â €â € â ¤â â €â €â €â €â €â €â €â¢€â ”â â¢¸â£¿â¢¸â €â ¸â£¿â¡‡â €â €â €â €â €â €â €â ¸â €â ˜â¢†â €â ˆâ¢·â¡€â €â €â ˜â¡„â €â €â €â €â €â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â â €â €â €â €â €â €â €â¢°â ›â£¿â£‡â ¹â£¼â ƒâ ¹â£·â €â ™â¢¦â €â €â €â €â ™â£„â €â €â ˆâ¢¹â ¿â£¦â£ˆâ ‘â¢„â¡€â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢€â ”â â €â €â ˆâ¡‡â£¾â €â €â£¿â ƒâ €â €â €â €â €â €â €â €â¡‡â €â €â €â €â ˆâ¢¿â£¦â¡€â €â ˆâ¢†â €â €â €â €â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â €â €â €â €â €â €â¡Œâ €â ¸â£¿â£·â¡˜â¢¦â¡€â ¹â¡‡â €â €â¢¹â£¦â¡€â €â €â ˆâ¢¢â¡€â €â¢¸â €â ˆâ ‰â ›â ¦â£­â¡™â “â ¶â¢¤â ¤â£ â£¤â£€â£€â£€â£€â£€â£€â£€â¡€â €â£€â œâ â €â €â €â €â¢°â¢£â£§â¡€â €â¢¸â €â €â €â €â €â €â €â €â €â¡‡â €â €â €â €â €â €â ™â¢¿â£¦â¡€â €â ³â¡€â €â €â €â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â €â €â €â €â €â¢€â ƒâ €â£¸â£¿â¡¿â£¿â ¶â£â¢¦â£½â£†â €â €â¢¿â£â ²â¢¤â¡€â €â ™â ¢â£¼â¡€â €â €â €â €â €â €â €â €â ˜â¡„â ˜â£¿â¡„â €â €â¢˜â£¿â €â €â ˆâ â €â €â €â €â €â €â €â¡¼â¡˜â ‹â ³â£„â¢¸â¡€â €â €â €â¡†â €â €â €â €â¡‡â €â €â €â €â €â €â €â €â ˜â£â ¢â£„â ˜â¢¦â£¤â¡€â €â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â €â €â €â €â €â¡â €â¢ â£¿â¡Ÿâ €â ˆâ ³â£®â£¹â£¿â ›â¢§â¡„â ˆâ¢»â¡€â €â ‰â “â ¦â¢¤â£ˆâ£™â¡“â ¦â£„â£€â£€â¡€â €â €â €â¢§â €â ¸â¡·â €â£´â Ÿâ¢¿â¡€â €â €â €â €â €â €â €â£€â¡´â¡¿â£¹â ƒâ €â €â ˜â¢§â¡‡â €â €â €â¡‡â €â €â €â €â¡‡â €â €â €â¢€â£€â£€â£€â£€â£€â£ˆâ£†â €â ‘â¢¤â¡™â¢¿â£·â£¦â£„â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â €â €â €â €â¢°â €â¢ â£¿â¡Ÿâ €â €â €â €â ˆâ£¿â¡Ÿâ €â €â ™â£¦â¡€â ±â¡„â €â €â €â €â €â¢»â ‰â ‰â ‰â ‰â ‰â â €â €â €â¢¸â €â €â¢±â¡â â €â €â ‰â “â ¶â¢¤â£„â£€â¡ â â â£°â¡¿â â €â €â €â €â ¨â¡‡â €â €â €â¡‡â €â €â €â €â£¿â â ˆâ ‰â â €â €â €â €â €â €â ‰â ³â¢„â €â ˆâ ²â£¿â£¿â£¿â£¿â£¶â£¤â£€â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â €â €â €â¢ â¢ƒâ ”â£»â¡¿â €â €â €â €â €â¢°â£¿â €â¡‡â €â¢ â£¿â£¿â ¦â£˜â¢¦â¡€â €â €â €â ¸â¡¦â ´â ¶â ¶â ¶â ¶â ¶â ¶â ¶â â ’â ºâ£â €â €â €â €â €â €â¢°â¡Ÿâ ‰â €â ‘â£¶â£¼â Ÿâ €â €â €â €â €â €â¢ â¡‡â €â €â¢ â â €â €â €â €â£¿â €â €â €â €â €â €â €â €â €â €â €â €â €â £â¡€â €â €â ™â ¿â£¿â£¿â¡§â ˆâ “</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â €â €â €â¡â €â£°â£¿â â €â €â €â €â €â¢¸â¡â €â¡‡â €â¢¸â£¿â£¿â €â ˆâ ™â ›â ²â ¤â¡€â €â¢‡â €â €â €â €â €â €â €â €â €â €â €â¢¹â¡†â €â €â €â €â¢ â£â¡€â €â¢ â¡´â Ÿâ£·â¡€â €â €â €â €â €â €â£¸â¢‡â €â €â£¸â €â €â €â €â¡€â¡‡â €â €â €â €â €â €â €â €â €â €â €â €â €â €â ±â €â €â €â €â ˆâ »â¢¿â¡€â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â €â €â¡œâ €â¢ â¢»â ‡â €â €â €â €â €â €â¢¸â ƒâ €â¢£â €â¢¸â£¿â¢¿â €â €â €â¢€â €â €â €â €â¡â¡„â €â €â €â €â €â €â €â €â €â €â¢ â£·â¡€â €â €â €â£¿â£¿â£¿â£¦â£€â£€â£´â£¿â£·â¡„â €â €â €â €â¢ â£¿â ˆâ¢¦â €â¡‡â €â €â €â¢¸â¡‡â¡‡â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â ±â €â €â €â €â €â €â ™â¢¦</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â €â¢°â €â  â ƒâ¡â €â €â €â €â €â €â €â£¾â €â €â ˆâ¡†â¡¿â£¿â ˜â¡‡â €â €â£¨â €â €â €â €â¢·â¡¹â¡€â €â €â €â €â €â €â €â €â£°â£¿â£¿â£§â €â €â£¾â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£·â£„â €â €â¢€â£¾â¡‡â  â¡ˆâ¢ â ƒâ €â €â €â¢¸â£§â¡‡â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢‡â €â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â €â¢ â ƒâ¡ â ƒâ¢€â¡‡â €â €â €â €â¢€â¡„â €â¡‡â €â €â €â¢¸â¡‡â¡â €â¢§â €â €â£¿â¡†â €â €â €â ˜â¡—â£â£„â €â €â €â €â €â €â£ â£¿â£¿â£¿â£¿â£€â£¼â£¿â£¿â£¿â£¿â¡¿â Ÿâ ‰â¢¿â£¿â£¿â£¿â£¿â£†â¢€â£¾â£¿â ƒâ €â¢¡â¡â €â €â €â €â¢¸â£¿â ƒâ €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â ˜â¢†â €â €â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â¢€â †â¡°â â €â¢¸â â €â €â €â €â¢¸â¡‡â €â¡‡â €â €â €â €â£§â¡‡â €â ¸â¡€â €â£¿â£·â¡€â €â €â €â¢¹â¡€â ™â ³â ¦â£„â €â €â£°â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡¿â ‹â €â €â €â €â¢¹â£¿â£¿â£¿â£¿â£¿â£¿â¡â €â¢€â¡¼â €â €â €â €â €â£¾â£¿â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â ˜â£¦â¡€â €â €â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â €â¡Œâ¡â â €â €â¡¾â €â €â €â €â €â¢¸â¢»â €â£§â €â €â €â €â£¾â¡‡â €â €â¡‡â €â¢»â£¿â£§â €â €â €â €â¢³â €â €â €â €â €â£°â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â €â €â£€â£€â €â£¼â£¿â£¿â£¿â£¿â£¿â¡¿â €â¢€â£¾â ƒâ €â €â €â €â£°â£¿â¡¿â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â ˆâ¡â¢¦â¡€â €â €</span></span><br><span class=\"line\"><span class=\"comment\">â €â¡°â¡œâ â €â €â¢€â¡‡â €â €â €â €â €â¡â ˜â¡‡â¢¹â €â €â €â¢¸â£¿â¢¸â €â €â ˜â¡„â ˜â£¿â£¿â£§â €â €â €â €â¢£â¡€â €â €â£ â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡¿â Ÿâ ¿â£¿â¡Ÿâ »â£¿â£¿â£¿â£¿â£¿â£¿â ƒâ£ â£¿â â €â €â €â €â¢€â£¿â£¿â ‡â €â €â¢ â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â£¹â£†â¡™â ¢â¡€</span></span><br><span class=\"line\"><span class=\"comment\">â¢°â¡µâ €â €â €â €â¢¸â €â €â €â €â €â¢ â ‡â €â¢³â¡˜â¡†â €â¢€â ‡â¢»â¡¼â¡€â €â €â ±â¡€â ¹â¡Ÿâ£¿â£§â¡€â €â €â €â ³â¡€â£ â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡¿â â €â €â¢¿â£¿â €â¢¸â£¿â£¿â£¿â£¿â£§â£¾â£¿â â €â €â €â €â¢€â£¾â£¿â£¿â¡„â €â €â¢¸â£†â €â €â €â €â €â €â €â €â €â €â €â¢€â¡ â ¤â ’â ‰â €â €â¢³â €â ˆ                                </span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> int long long</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> endl <span class=\"string\">&#x27;\\n&#x27;</span><span class=\"comment\">//äº¤äº’é¢˜å°±åˆ </span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> inf=<span class=\"number\">0x3f3f3f3f</span>;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> N=<span class=\"number\">2e6</span><span class=\"number\">+10</span>;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> mod=<span class=\"number\">1e9</span><span class=\"number\">+7</span>;</span><br><span class=\"line\"><span class=\"type\">int</span> r,c;</span><br><span class=\"line\">vector&lt;<span class=\"type\">int</span>&gt;sum[N],edge[N];</span><br><span class=\"line\">string s;</span><br><span class=\"line\"><span class=\"type\">int</span> vis[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">bool</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"type\">int</span> u,<span class=\"type\">int</span> fa)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">//cout&lt;&lt;u&lt;&lt;endl;</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> v:edge[u])&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(v==fa)<span class=\"keyword\">continue</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(vis[v]==vis[u])<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span>(vis[v]==<span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span>(vis[u]==<span class=\"number\">1</span>)vis[v]=<span class=\"number\">2</span>;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">else</span> vis[v]=<span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\t\t<span class=\"built_in\">dfs</span>(v,u);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">solve</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">\tcin&gt;&gt;r&gt;&gt;c;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=c;i++)sum[i].<span class=\"built_in\">clear</span>();</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=<span class=\"number\">2</span>*r;i++)vis[i]=<span class=\"number\">0</span>,edge[i].<span class=\"built_in\">clear</span>();</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=r;i++)&#123;</span><br><span class=\"line\">\t\tcin&gt;&gt;s;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">0</span>;j&lt;c;j++)&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span>(s[j]==<span class=\"string\">&#x27;1&#x27;</span>)sum[j<span class=\"number\">+1</span>].<span class=\"built_in\">push_back</span>(i);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(c&amp;<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(sum[(c<span class=\"number\">+1</span>)/<span class=\"number\">2</span>].<span class=\"built_in\">size</span>()&gt;<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">\t\t\tcout&lt;&lt;<span class=\"number\">0</span>&lt;&lt;endl;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=r;i++)&#123;</span><br><span class=\"line\">\t\tedge[i].<span class=\"built_in\">push_back</span>(i+r);</span><br><span class=\"line\">\t\tedge[i+r].<span class=\"built_in\">push_back</span>(i);</span><br><span class=\"line\">\t&#125;<span class=\"comment\">//è¿è¾¹ä»£è¡¨ä¸å…±å­˜</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=c/<span class=\"number\">2</span>;i++)&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(sum[i].<span class=\"built_in\">size</span>()+sum[c-i<span class=\"number\">+1</span>].<span class=\"built_in\">size</span>()&gt;<span class=\"number\">2</span>)&#123;</span><br><span class=\"line\">\t\t\tcout&lt;&lt;<span class=\"number\">0</span>&lt;&lt;endl;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(sum[i].<span class=\"built_in\">size</span>()+sum[c-i<span class=\"number\">+1</span>].<span class=\"built_in\">size</span>()==<span class=\"number\">2</span>)&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span>(sum[i].<span class=\"built_in\">size</span>()==<span class=\"number\">1</span>)&#123;<span class=\"comment\">//ä¸€èµ·ç¿»</span></span><br><span class=\"line\">\t\t\t<span class=\"comment\">//cout&lt;&lt;&quot;s&quot;;</span></span><br><span class=\"line\">\t\t\t\t<span class=\"type\">int</span> u=sum[i][<span class=\"number\">0</span>],v=sum[c-i<span class=\"number\">+1</span>][<span class=\"number\">0</span>];</span><br><span class=\"line\">\t\t\t\t<span class=\"comment\">//cout&lt;&lt;i&lt;&lt;&quot; &quot;&lt;&lt;c-i+1&lt;&lt;&quot; &quot;&lt;&lt;u&lt;&lt;&quot; &quot;&lt;&lt;v&lt;&lt;endl;</span></span><br><span class=\"line\">\t\t\t\tedge[u].<span class=\"built_in\">push_back</span>(v+r);</span><br><span class=\"line\">\t\t\t\tedge[v+r].<span class=\"built_in\">push_back</span>(u);</span><br><span class=\"line\">\t\t\t\tedge[v].<span class=\"built_in\">push_back</span>(u+r);</span><br><span class=\"line\">\t\t\t\tedge[u+r].<span class=\"built_in\">push_back</span>(v);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">else</span> &#123;<span class=\"comment\">//ä¸€ä¸ªç¿»ä¸€ä¸ªä¸ç¿»</span></span><br><span class=\"line\">\t\t\t\t<span class=\"type\">int</span> u,v;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span>(sum[i].<span class=\"built_in\">size</span>())u=sum[i][<span class=\"number\">0</span>],v=sum[i][<span class=\"number\">1</span>];</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">else</span> u=sum[c-i<span class=\"number\">+1</span>][<span class=\"number\">0</span>],v=sum[c-i<span class=\"number\">+1</span>][<span class=\"number\">1</span>];</span><br><span class=\"line\">\t\t\t\tedge[u].<span class=\"built_in\">push_back</span>(v);</span><br><span class=\"line\">\t\t\t\tedge[v].<span class=\"built_in\">push_back</span>(u);</span><br><span class=\"line\">\t\t\t\tedge[v+r].<span class=\"built_in\">push_back</span>(u+r);</span><br><span class=\"line\">\t\t\t\tedge[u+r].<span class=\"built_in\">push_back</span>(v+r);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"type\">int</span> ans=<span class=\"number\">1</span>;</span><br><span class=\"line\">\t<span class=\"comment\">/*for(int i=1;i&lt;=2*r;i++)&#123;</span></span><br><span class=\"line\"><span class=\"comment\">\t\tcout&lt;&lt;i&lt;&lt;&quot;i: &quot;;</span></span><br><span class=\"line\"><span class=\"comment\">\t\tfor(auto v:edge[i])&#123;</span></span><br><span class=\"line\"><span class=\"comment\">\t\t\tcout&lt;&lt;v&lt;&lt;&quot; &quot;;</span></span><br><span class=\"line\"><span class=\"comment\">\t\t&#125;</span></span><br><span class=\"line\"><span class=\"comment\">\t\tcout&lt;&lt;endl;</span></span><br><span class=\"line\"><span class=\"comment\">\t&#125;*/</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=<span class=\"number\">2</span>*r;i++)&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(vis[i])<span class=\"keyword\">continue</span>;</span><br><span class=\"line\">\t\tvis[i]=<span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(<span class=\"built_in\">dfs</span>(i,i))&#123;</span><br><span class=\"line\">\t\t\tans=(ans*<span class=\"number\">2</span>)%mod;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\tcout&lt;&lt;<span class=\"number\">0</span>&lt;&lt;endl;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tcout&lt;&lt;ans&lt;&lt;endl;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">signed</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>);cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">\t<span class=\"type\">int</span> T=<span class=\"number\">1</span>;</span><br><span class=\"line\">\tcin&gt;&gt;T;</span><br><span class=\"line\">\t<span class=\"keyword\">while</span>(T--)&#123;<span class=\"built_in\">solve</span>();&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>"},{"title":"åˆ©ç”¨ Pytorch æ„å»ºä¸ä¼˜åŒ– AlexNet æ·±å±‚å·ç§¯ç¥ç»ç½‘ç»œ","url":"/post/5feefdcb.html","content":"<p><strong>AlexNetçš„æ¨¡å‹å½’ä¸€åŒ–æ–¹æ³•çš„æ¯”è¾ƒåˆ†æ</strong><br>\nI. å¯¹ AlexNet çš„å½’ä¸€åŒ–æ–¹æ³•è¿›è¡Œæ¯”è¾ƒåˆ†ææˆ–æ”¹è¿›ï¼›<br>\nII. æ¯”è¾ƒè‡³å°‘ä¸‰ç§çš„å½’ä¸€åŒ–æ–¹æ³•ï¼ˆä¾‹å¦‚æ— å½’ä¸€åŒ– , BN, LN, GNç­‰ï¼‰ï¼›<br>\nIII. åœ¨MNIST/Cifar-10æ•°æ®é›†åˆ†ææ¯”è¾ƒä¸åŒå½’ä¸€åŒ–æ–¹æ³•åœ¨ä¸åŒBatch-sizeä¸‹çš„æ€§èƒ½ã€‚</p>\n\n\n\t<div class=\"row\">\n    <embed src=\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/pdf/AlexNet/åˆ©ç”¨Pytorchæ„å»ºä¸ä¼˜åŒ–AlexNetæ·±å±‚å·ç§¯ç¥ç»ç½‘ç»œ.pdf\" width=\"100%\" height=\"550\" type=\"application/pdf\">\n\t</div>\n\n\n","tags":["AlexNet","Pytorch","æ·±å±‚å·ç§¯ç¥ç»ç½‘ç»œ"]},{"title":"ä»é›¶å¼€å§‹å­¦å†™è„šæœ¬ã€ç¬¬ä¸€å¤©ã€‘","url":"/post/39ccbdd3.html","content":"<h2 id=\"ä¸€ã€æ–°å»ºé¡¹ç›®\">ä¸€ã€æ–°å»ºé¡¹ç›®</h2>\n<p><img src=\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/%E8%84%9A%E6%9C%AC/day1-1.png\" alt=\"\"></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/%E8%84%9A%E6%9C%AC/day1-2.png\" alt=\"\"></p>\n<h2 id=\"äºŒã€å®‰è£…-selenium\">äºŒã€å®‰è£… selenium</h2>\n<blockquote>\n<p>selenium æ˜¯æµè§ˆå™¨è‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·ã€‚</p>\n</blockquote>\n<p>æ§åˆ¶å°è¾“å…¥</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">pip install selenium</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/%E8%84%9A%E6%9C%AC/day1-3.png\" alt=\"\"></p>\n<h2 id=\"ä¸‰ã€ä¸‹è½½-Microsoft-Edge-WebDriver\">ä¸‰ã€ä¸‹è½½ Microsoft Edge WebDriver</h2>\n<blockquote>\n<p>æµè§ˆå™¨é©±åŠ¨ï¼Œä»£ç æ‰“å¼€æµè§ˆå™¨å¿…é¡»è¦æœ‰æµè§ˆå™¨çš„é©±åŠ¨,ä¸åŒç‰ˆæœ¬çš„æµè§ˆå™¨é©±åŠ¨ä¹Ÿæ˜¯ä¸ä¸€æ ·çš„</p>\n<p><strong>ä¸‹è½½åœ°å€</strong>ï¼š<a href=\"https://developer.microsoft.com/en-us/microsoft-edge/tools/webdriver/?form=MA13LH\">https://developer.microsoft.com/en-us/microsoft-edge/tools/webdriver/?form=MA13LH</a></p>\n</blockquote>\n<p><strong>Microsoft Edge æµè§ˆå™¨ æŸ¥çœ‹ç‰ˆæœ¬</strong></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/%E8%84%9A%E6%9C%AC/day1-4.png\" alt=\"\"></p>\n<p>æ‰“å¼€ <a href=\"https://developer.microsoft.com/en-us/microsoft-edge/tools/webdriver/?form=MA13LH\">https://developer.microsoft.com/en-us/microsoft-edge/tools/webdriver/?form=MA13LH</a></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/%E8%84%9A%E6%9C%AC/day1-5.png\" alt=\"\"></p>\n<p><strong>éšæ„è§£å‹è‡³ä¸€ä¸ªç›®å½•</strong></p>\n<h2 id=\"å››ã€ä»£ç æ‰“å¼€æµè§ˆå™¨\">å››ã€ä»£ç æ‰“å¼€æµè§ˆå™¨</h2>\n<p>1.æ–°å»º <a href=\"http://openEdgedriver.py\">openEdgedriver.py</a> æ–‡ä»¶</p>\n<p>2.å†™å…¥ä»£ç </p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> selenium <span class=\"keyword\">import</span> webdriver</span><br><span class=\"line\"><span class=\"keyword\">from</span> selenium.webdriver.edge.service <span class=\"keyword\">import</span> Service</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æŒ‡å®š WebDriver è·¯å¾„</span></span><br><span class=\"line\">path = <span class=\"string\">&quot;D:/temp/msedgedriver.exe&quot;</span>  <span class=\"comment\"># æ›¿æ¢ä¸ºä½ çš„ msedgedriver.exe è·¯å¾„</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ä½¿ç”¨ Service ç±»</span></span><br><span class=\"line\">service = Service(path)</span><br><span class=\"line\">browser = webdriver.Edge(service=service)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ‰“å¼€ ç™¾åº¦ç½‘é¡µ</span></span><br><span class=\"line\">browser.get(<span class=\"string\">&#x27;[edge://newtab/](https://www.baidu.com)&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># é˜²æ­¢æµè§ˆå™¨é€€å‡º</span></span><br><span class=\"line\"><span class=\"built_in\">input</span>(<span class=\"string\">&quot;æŒ‰å›è½¦é”®é€€å‡º...&quot;</span>)</span><br><span class=\"line\">browser.quit()</span><br></pre></td></tr></table></figure>\n<p>3.è¿è¡Œ <a href=\"http://openEdgedriver.py\">openEdgedriver.py</a> æ–‡ä»¶</p>\n<p><strong>å°†è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨å¹¶ä¸”è®¿é—®ç›®æ ‡é¡µé¢ <a href=\"https://www.baidu.com\">edge://newtab/</a></strong></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/%E8%84%9A%E6%9C%AC/day1-6.png\" alt=\"\"></p>\n<h2 id=\"äº”ã€å®ç°é¡µé¢é‡Œæœç´¢æ¡†è¾“å…¥å†…å®¹ï¼Œå¹¶ç‚¹å‡»æŸ¥è¯¢\">äº”ã€å®ç°é¡µé¢é‡Œæœç´¢æ¡†è¾“å…¥å†…å®¹ï¼Œå¹¶ç‚¹å‡»æŸ¥è¯¢</h2>\n<p>æ—¢ç„¶æ˜¯è„šæœ¬ï¼Œæˆ‘ä»¬ä¸èƒ½åªæ˜¯è®¿é—®é¡µé¢ï¼Œè‚¯å®šè¿˜è¦æœ‰ç‚¹å‡»äº‹ä»¶</p>\n<blockquote>\n<p>è¿›å…¥é¡µé¢ <a href=\"https://www.baidu.com\">https://www.baidu.com</a> æŸ¥çœ‹é¡µé¢æºä»£ç ï¼Œæˆ‘ä»¬å‘ç°ï¼Œè¾“å…¥æ¡†&lt;input&gt;æ ‡ç­¾çš„ id ä¸º search-blog-words ï¼›æŸ¥è¯¢æŒ‰é’®&lt;a&gt; æ ‡ç­¾æœ‰ä¸ªå±æ€§ class ,ä¸º btn-search-blog</p>\n</blockquote>\n<p>æŸ¥è¯¢ id ä¸º search-blog-wordsçš„å±æ€§ï¼Œå‘å…¶è¾“å…¥â€œäº¬ä¸œå‡†ç‚¹ç§’æ€è„šæœ¬â€</p>\n<blockquote>\n<p>browser.find_element_by_id(â€œsearch-blog-wordsâ€).send_keys(â€œäº¬ä¸œå‡†ç‚¹ç§’æ€è„šæœ¬â€)</p>\n</blockquote>\n<p>æŸ¥è¯¢æŒ‰é’® clsss åç§°ä¸º btn-search-blog çš„æ ‡ç­¾ï¼Œç‚¹å‡»æŒ‰é’®</p>\n<blockquote>\n<p>browser.find_element_by_class_name(â€˜btn-search-blogâ€™).click()</p>\n</blockquote>\n<p><strong>åˆ†åˆ«æ˜¯è¾“å…¥å†…å®¹ï¼Œç‚¹å‡»æŸ¥è¯¢ã€‚æ–°ä¿®æ”¹åçš„ä»£ç ä¸º</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> selenium <span class=\"keyword\">import</span> webdriver</span><br><span class=\"line\"><span class=\"keyword\">from</span> selenium.webdriver.edge.service <span class=\"keyword\">import</span> Service</span><br><span class=\"line\"><span class=\"keyword\">from</span> selenium.webdriver.common.by <span class=\"keyword\">import</span> By  <span class=\"comment\"># å¯¼å…¥ By ç±»</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æŒ‡å®š WebDriver è·¯å¾„</span></span><br><span class=\"line\">path = <span class=\"string\">&quot;D:/temp/msedgedriver.exe&quot;</span>  <span class=\"comment\"># æ›¿æ¢ä¸ºä½ çš„ msedgedriver.exe è·¯å¾„</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ä½¿ç”¨ Service ç±»</span></span><br><span class=\"line\">service = Service(path)</span><br><span class=\"line\">browser = webdriver.Edge(service=service)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ‰“å¼€ç™¾åº¦é¦–é¡µ</span></span><br><span class=\"line\">browser.get(<span class=\"string\">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å®šä½æœç´¢æ¡†å¹¶è¾“å…¥å†…å®¹</span></span><br><span class=\"line\">browser.find_element(By.ID, <span class=\"string\">&quot;kw&quot;</span>).send_keys(<span class=\"string\">&quot;äººé—´è¯è¯&quot;</span>)  <span class=\"comment\"># è¾“å…¥å†…å®¹</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å®šä½æœç´¢æŒ‰é’®å¹¶ç‚¹å‡»</span></span><br><span class=\"line\">browser.find_element(By.ID, <span class=\"string\">&quot;su&quot;</span>).click()  <span class=\"comment\"># ç‚¹å‡»æœç´¢æŒ‰é’®</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># é˜²æ­¢æµè§ˆå™¨é€€å‡º</span></span><br><span class=\"line\"><span class=\"built_in\">input</span>(<span class=\"string\">&quot;æŒ‰å›è½¦é”®é€€å‡º...&quot;</span>)</span><br><span class=\"line\">browser.quit()</span><br></pre></td></tr></table></figure>\n<p>å†æ¬¡è¿è¡Œä»£ç </p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/%E8%84%9A%E6%9C%AC/day1-7.png\" alt=\"\"></p>\n","tags":["Script"]},{"title":"ä»é›¶å¼€å§‹å­¦å†™è„šæœ¬ã€ç¬¬äºŒå¤©ã€‘","url":"/post/bc49d0da.html","content":""},{"title":"åˆ†ç›˜","url":"/post/7e23b7a4.html","content":"<h1>æ–°ç”µè„‘å¦‚ä½•ä»Cç›˜åˆ†å‡ºDç›˜ï¼Ÿå…¶å®å¾ˆç®€å•ï¼</h1>\n<p>æ–°è´­ä¹°çš„ç”µè„‘é€šå¸¸åªæœ‰ä¸€ä¸ªåˆ†åŒºï¼Œä¹Ÿå°±æ˜¯<a href=\"https://www.disktool.cn/jiaocheng-new/how-to-partition-hard-drive-in-windows10.html\">åªæœ‰Cç›˜</a>ï¼Œè¿™æ„å‘³ç€ç³»ç»Ÿå’Œè½¯ä»¶éƒ½ä¼šè¢«å®‰è£…åœ¨è¿™ä¸ªç›˜ä¸Šï¼Œæ–‡ä»¶ä¹Ÿä¼šå­˜å‚¨åœ¨åŒä¸€ä¸ªä½ç½®ï¼Œè¿™æ ·ä½¿ç”¨èµ·æ¥å¹¶ä¸æ–¹ä¾¿ã€‚å¦‚æœç”µè„‘é­å—ç—…æ¯’æ”»å‡»æˆ–è€…ç³»ç»Ÿæ•…éšœéœ€è¦é‡æ–°å®‰è£…ç³»ç»Ÿï¼Œå¾ˆå¯èƒ½ä¼šå¯¼è‡´é‡è¦æ–‡ä»¶çš„ä¸¢å¤±ã€‚æ­¤å¤–ï¼Œæ–‡ä»¶çš„å­˜å‚¨å’Œç®¡ç†ä¹Ÿä¼šå˜å¾—ä¸ä¾¿ï¼Œéš¾ä»¥è¿›è¡Œæœ‰æ•ˆçš„åˆ†ç±»ã€æŸ¥æ‰¾å’Œæµè§ˆã€‚</p>\n<p>æ–°ç”µè„‘å¦‚ä½•ä»Cç›˜åˆ†å‡ºDç›˜ï¼Ÿå…¶å®å¾ˆç®€å•ï¼æ“ä½œä¹Ÿå¹¶ä¸å¤æ‚ï¼Œå³ä¾¿æ˜¯ç”µè„‘å°ç™½ä¹Ÿèƒ½è½»æ¾å®Œæˆã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å…·ä½“çš„æ­¥éª¤ï¼Œè€Œä¸”æ“ä½œå®Œæˆåæ— éœ€é‡å¯ç”µè„‘ï¼Œåªéœ€å‡ åˆ†é’Ÿå°±èƒ½æå®šã€‚</p>\n<h2 id=\"æ–¹æ³•ä¸€ï¼šä½¿ç”¨ç£ç›˜ç®¡ç†ä»Cç›˜åˆ†å‡ºDç›˜\">æ–¹æ³•ä¸€ï¼šä½¿ç”¨ç£ç›˜ç®¡ç†ä»Cç›˜åˆ†å‡ºDç›˜</h2>\n<p><a href=\"https://www.disktool.cn/content-center/win10-comes-with-hard-disk-partition-369.html\">ç£ç›˜ç®¡ç†</a>æ˜¯Windowsä¸­è‡ªå¸¦ç³»ç»Ÿå®ç”¨ç¨‹åºï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬ç®¡ç†ç£ç›˜å’Œåˆ†åŒºã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å®ƒå¯¹åˆ†åŒºè¿›è¡Œä¸€äº›ç®€å•çš„åŸºç¡€è°ƒæ•´ï¼Œæ¯”å¦‚å‹ç¼©å·ã€æ‰©å±•å·ã€åˆ é™¤å·ã€æ›´æ”¹ç›˜ç¬¦ç­‰ã€‚</p>\n<ol>\n<li>åŒæ—¶æŒ‰<strong>Win+R</strong>è¾“å…¥<strong>diskmgmt.msc</strong>å¹¶æŒ‰<strong>å›è½¦</strong>é”®æ‰“å¼€ç£ç›˜ç®¡ç†ã€‚</li>\n</ol>\n<p><img src=\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/%E5%88%86%E7%9B%98/diskmgmt.png\" alt=\"\"></p>\n<ol start=\"2\">\n<li>é€‰æ‹©ä¸€ä¸ªç©ºé—²ç©ºé—´æ¯”è¾ƒå¤§çš„ç£ç›˜è¿›è¡Œå‹ç¼©ï¼Œæ¯”å¦‚æˆ‘ä»¬å¸Œæœ›æŠŠDç›˜çš„ä¸€äº›ç£ç›˜ç©ºé—´è°ƒæ•´åˆ°Cç›˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€‰ä¸­Dç›˜ï¼Œç„¶åå†å…¶ä¸Šç‚¹å‡»é¼ æ ‡å³é”®ï¼Œåœ¨å¼¹å‡ºçš„èœå•ä¸­é€‰æ‹©**â€œå‹ç¼©å·â€**ã€‚</li>\n</ol>\n<p><img src=\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/%E5%88%86%E7%9B%98/ys1.png\" alt=\"\"></p>\n<ol start=\"3\">\n<li>ç„¶ååœ¨è¾“å…¥å‹ç¼©ç©ºé—´é‡ï¼ˆMBï¼‰é‡Œå¡«å†™è¦å‹ç¼©å‡ºçš„ç©ºé—´ï¼Œç„¶åç‚¹å‡»**â€œå‹ç¼©â€**å³å¯ã€‚</li>\n</ol>\n<p><img src=\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/%E5%88%86%E7%9B%98/ys2.png\" alt=\"\"></p>\n<p><strong>âœ å…¬å¼ï¼š</strong> è¾“å…¥å‹ç¼©ç©ºé—´æ€»é‡=å‹ç¼©å‰çš„æ€»è®¡å¤§å°-å‹ç¼©åçš„æ€»è®¡å¤§å°ï¼ˆC ç›˜ç©ºé—´å¤§å°ï¼‰ï¼Œ1GB=1024MBï¼Œä¸¾ä¾‹ï¼šæ€»å¤§å° 1000GBï¼Œé¢„ç•™Cç›˜ 200GBï¼Œè¾“å…¥å‹ç¼©ç©ºé—´é‡=1000GB-200GB=800GB=1024MBx800=819200MBã€‚</p>\n<ol start=\"4\">\n<li>å‹ç¼©å®Œåï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç£ç›˜å·ä¸­ä¼šå¤šå‡ºä¸€ä¸ªé»‘è‰²åˆ†åŒºçš„**â€œæœªåˆ†åŒºç£ç›˜â€<strong>ï¼›ç„¶åæˆ‘ä»¬åªéœ€è¦å°†è¯¥æœªåˆ†åŒºç£ç›˜ç©ºé—´åˆ†é…ç»™Cç›˜å³å¯ã€‚å³é”®ç‚¹å‡»éœ€è¦æ‰©å……å®¹é‡çš„ç›˜ç¬¦ï¼Œç„¶ååœ¨å¼¹å‡ºçš„èœå•ä¸­é€‰æ‹©</strong>â€œæ‰©å±•å·â€**ã€‚</li>\n</ol>\n<p><img src=\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/%E5%88%86%E7%9B%98/kz1.png\" alt=\"\"></p>\n<p><strong>âœ æ³¨æ„ï¼š</strong> æ‰©å±•å·åªèƒ½åˆå¹¶ç›¸é‚»çš„æœªåˆ†é…ç©ºé—´ï¼Œè‹¥å‹ç¼©å‡ºçš„æœªåˆ†é…ç©ºé—´ä¸ä½ æƒ³è¦åˆå¹¶çš„åˆ†åŒºä¸ç›¸é‚»ï¼Œä½ å¯ä»¥<a href=\"https://www.disktool.cn/jiaocheng-new/2019/how-to-move-partition.html\">ç§»åŠ¨åˆ†åŒº</a>å°†æœªåˆ†é…ç©ºé—´ç§»åŠ¨åˆ°ç›¸é‚»çš„ä½ç½®ã€‚</p>\n<ol start=\"5\">\n<li>ä¹‹åä¼šå¼¹å‡ºå¦‚ä¸‹æ‰©å±•å·æ“ä½œå‘å¯¼å¯¹è¯æ¡†ç•Œé¢ï¼Œé€‰æ‹©ä½ æƒ³è¦å°†å¤šå°‘æœªåˆ†é…ç©ºé—´ç”¨äºæ‰©å±•åˆ†åŒºï¼Œè®¾ç½®å®Œæ¯•åå•å‡»**â€œä¸‹ä¸€æ­¥â€**ã€‚</li>\n</ol>\n<p><img src=\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/%E5%88%86%E7%9B%98/kz2.png\" alt=\"\"></p>\n<ol start=\"6\">\n<li>æŒ‰ç…§æç¤ºæµç¨‹æ“ä½œå®Œæ¯•ä¹‹åï¼Œå•å‡»**â€œå®Œæˆâ€**ä»¥é€€å‡ºæ‰©å±•å·å‘å¯¼å³å¯ã€‚</li>\n</ol>\n<p><img src=\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/%E5%88%86%E7%9B%98/kz3.png\" alt=\"\"></p>\n<h2 id=\"æ–¹æ³•äºŒï¼šä½¿ç”¨åˆ†åŒºåŠ©æ‰‹ä»Cç›˜åˆ†å‡ºDç›˜\">æ–¹æ³•äºŒï¼šä½¿ç”¨åˆ†åŒºåŠ©æ‰‹ä»Cç›˜åˆ†å‡ºDç›˜</h2>\n<p>å¦‚æœä½ è§‰å¾—ç£ç›˜ç®¡ç†åˆ›å»ºåˆ†åŒºæ­¥éª¤å¤ªå¤šï¼Œå¯ä»¥ä½¿ç”¨å…è´¹çš„ç£ç›˜åˆ†åŒºç®¡ç†è½¯ä»¶â€“<a href=\"https://www.disktool.cn/feature.html\">å‚²æ¢…åˆ†åŒºåŠ©æ‰‹</a>ï¼Œå®ƒçš„â€œæ‹†åˆ†åˆ†åŒºâ€åŠŸèƒ½å¯ä»¥ç›´æ¥æ‹†åˆ†Cç›˜ï¼Œåˆ›å»ºæ–°çš„åˆ†åŒºã€‚è½»æ¾çš„å°†å¤§åˆ†åŒºæ‹†åˆ†ä¸ºä¸€ä¸ªæˆ–å¤šä¸ªå°åˆ†åŒºã€‚</p>\n<ol>\n<li>ä¸‹è½½å®‰è£…å¯åŠ¨å‚²æ¢…åˆ†åŒºåŠ©æ‰‹ï¼Œå³é”®å•å‡»æœ‰å¤šä½™ç©ºé—´çš„Cç›˜ï¼Œé€‰æ‹©**â€œæ‹†åˆ†åˆ†åŒºâ€**ã€‚</li>\n</ol>\n<p><img src=\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/%E5%88%86%E7%9B%98/1.png\" alt=\"\"></p>\n<ol start=\"2\">\n<li>å·¦å³ç§»åŠ¨ä¸­é—´çš„åœ†åœˆè°ƒæ•´åˆ†åŒºå¤§å°ï¼Œç‚¹å‡»**â€œé«˜çº§â€<strong>è®¾ç½®åˆ†åŒºå·æ ‡ç­‰ï¼Œæ— è¯¯åç‚¹å‡»</strong>â€œç¡®è®¤â€**ã€‚</li>\n</ol>\n<p><img src=\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/%E5%88%86%E7%9B%98/2.png\" alt=\"\"></p>\n<p><strong>âœ æ³¨æ„ï¼š<strong>å¦‚æœåˆ†åŒºå­˜åœ¨äºSSDä¸Šï¼Œä½ å¯ä»¥ç‚¹å‡»é«˜çº§ï¼Œå‹¾é€‰</strong>â€œå…è®¸åˆ†åŒºå¯¹é½ä»¥ä¼˜åŒ–SSDçš„æ€§èƒ½â€</strong>ã€‚</p>\n<ol start=\"3\">\n<li>è¿”å›ä¸»ç•Œé¢ï¼Œç‚¹å‡»**â€œæäº¤â€<strong>ä»¥æŸ¥çœ‹æ“ä½œé¢„è§ˆï¼Œæ— è¯¯åç‚¹å‡»</strong>â€œæ‰§è¡Œâ€**å¼€å§‹åˆ›å»ºæ–°åˆ†åŒºã€‚</li>\n</ol>\n<p><img src=\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/%E5%88%86%E7%9B%98/3.png\" alt=\"\"></p>\n<h2 id=\"æ–¹æ³•ä¸‰ï¼šä½¿ç”¨Diskpartåˆ†åŒºç£ç›˜\">æ–¹æ³•ä¸‰ï¼šä½¿ç”¨Diskpartåˆ†åŒºç£ç›˜</h2>\n<p>Diskpartæ˜¯Windowsä¸­çš„å‘½ä»¤æç¤ºç¬¦ï¼Œä½¿ç”¨è¿™ä¸ªå‘½ä»¤å»åˆ†åŒºåä¸ç”¨é‡å¯ç³»ç»Ÿä¹Ÿå¯ä»¥ç”Ÿæ•ˆã€‚é€šè¿‡Diskpartä¹Ÿå¯ä»¥å¯¹<a href=\"https://www.disktool.cn/content-center/hard-disk-repartition-method-369.html\">ç¡¬ç›˜è¿›è¡Œé‡æ–°åˆ†åŒº</a>ï¼Œä¸è¿‡éœ€è¦æŒæ¡ä¸€å®šçš„çŸ¥è¯†æ‰èƒ½æ“ä½œã€‚å…·ä½“çš„æ­¥éª¤å¦‚ä¸‹ï¼š</p>\n<p>1.æŒ‰**â€œWindows + Râ€<strong>é”®ï¼Œåœ¨å¼¹å‡ºçš„</strong>â€œè¿è¡Œâ€<strong>å¯¹è¯æ¡†ä¸­è¾“å…¥</strong>â€œdiskpartâ€<strong>ï¼Œå¹¶æŒ‰</strong>â€œå›è½¦â€**é”®ã€‚</p>\n<p>2.è¾“å…¥**â€œlist diskâ€**å‘½ä»¤ï¼ŒæŸ¥çœ‹ç”µè„‘ç£ç›˜çš„æ‰€æœ‰ç£ç›˜çš„æƒ…å†µã€‚</p>\n<p>3.è¾“å…¥**â€œselect disk Aâ€**å‘½ä»¤ï¼Œå…¶ä¸­Aä»£è¡¨éœ€è¦åˆ›å»ºçš„åˆ†åŒºçš„ç¼–å·ã€‚</p>\n<p>4.è¾“å…¥**â€œcleanâ€**å‘½ä»¤ï¼Œæ¸…ç©ºAç£ç›˜åˆ†åŒºï¼Œä½¿ä¹‹æˆä¸ºæœªåˆ†é…ç£ç›˜åˆ†åŒºã€‚</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/%E5%88%86%E7%9B%98/clean.png\" alt=\"\"></p>\n<p>5.æ ¹æ®å®é™…çš„åˆ›å»ºç£ç›˜åˆ†åŒºçš„éœ€æ±‚é”®å…¥ä»¥ä¸‹å‘½ä»¤ã€‚</p>\n<p>ğŸ§° <strong>create partition primary size=n</strong>(åˆ›å»ºä¸»åˆ†åŒº)<br>\nğŸ§° <strong>create partition primary size=n</strong>(åˆ›å»ºä¸»åˆ†åŒº)<br>\nğŸ§° <strong>create partition logical size=n</strong>(åˆ›å»ºé€»è¾‘åˆ†åŒº)</p>\n<h2 id=\"ç»“è¯­\">ç»“è¯­</h2>\n<p>ä»¥ä¸Šå°±æ˜¯æ–°ç”µè„‘ä»Cç›˜åˆ†å‡ºDç›˜çš„3ç§æ–¹æ³•ï¼Œå»ºè®®ä½¿ç”¨åˆ†åŒºåŠ©æ‰‹æ–°å»ºDç›˜ï¼Œç®€å•æœ‰æ•ˆã€‚å¸Œæœ›æœ¬æ–‡å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼å‚²æ¢…åˆ†åŒºåŠ©æ‰‹é™¤äº†å¯ä»¥æ–°å»ºåˆ†åŒºã€‚å®ƒè¿˜æä¾›äº†å¾ˆå¤šWindowsè‡ªå¸¦ç£ç›˜ç®¡ç†å·¥å…·æ— æ³•å®Œæˆçš„åˆ†åŒºåŠŸèƒ½ï¼Œæ¯”å¦‚åˆ¶ä½œå¯åŠ¨å…‰ç›˜ã€<a href=\"https://www.disktool.cn/content-center/gpt-mbr/how-to-convert-gpt-to-mbr-without-data-loss.html\">æ— æŸè½¬æ¢MBRä¸GPT</a>ã€ç£ç›˜æµ‹é€Ÿç­‰ã€‚èµ¶ç´§ä¸‹è½½è¯•ä¸€è¯•å§ï¼</p>\n","tags":["åˆ†ç›˜"]},{"title":"åˆ©ç”¨ Pytorch æ„å»ºä¸åˆ†æ Perceptronï¼ˆæ„ŸçŸ¥æœºï¼‰ å•å±‚ç¥ç»ç½‘ç»œ","url":"/post/ac348add.html","content":"","tags":["Pytorch","Perceptron","å•å±‚ç¥ç»ç½‘ç»œ"]},{"title":"åˆ©ç”¨ Pytorch æ„å»ºä¸åˆ†æ Pix2Pix æ¨¡å‹çš„ä¼˜åŒ–ä¸æ”¹è¿›","url":"/post/76830c84.html","content":"<embed src=\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/pdf/Pix2Pix/åˆ©ç”¨Pytorchæ„å»ºä¸åˆ†æPix2Pixæ¨¡å‹çš„ä¼˜åŒ–ä¸æ”¹è¿›.pdf\" width=\"100%\" height=\"700px\" type=\"application/pdf\">","tags":["Pytorch","Pix2Pix","cGAN","æ¡ä»¶ç”Ÿæˆå¯¹æŠ—ç½‘ç»œæ¨¡å‹"]},{"title":"å•è°ƒæ ˆåšé¢˜æ€»ç»“","url":"/post/ae5bbdb8.html","content":"<h1>åŸºç¡€</h1>\n<h2 id=\"æ¯æ—¥æ¸©åº¦\">æ¯æ—¥æ¸©åº¦</h2>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/***** æ‰¾åé¢ç¬¬ä¸€ä¸ªå¤§ *****/</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">dailyTemperatures</span><span class=\"params\">(vector&lt;<span class=\"type\">int</span>&gt;&amp; temperatures)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> n=temperatures.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">        <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">ans</span><span class=\"params\">(n)</span></span>;</span><br><span class=\"line\">        </span><br><span class=\"line\">        stack&lt;<span class=\"type\">int</span>&gt; s;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;n;i++)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span>(!s.<span class=\"built_in\">empty</span>()&amp;&amp;temperatures[s.<span class=\"built_in\">top</span>()]&lt;temperatures[i])&#123; <span class=\"comment\">//æ ˆä¸­ç»´æŠ¤ä¸‹æ ‡å†™æ³•</span></span><br><span class=\"line\">                ans[s.<span class=\"built_in\">top</span>()]=i-s.<span class=\"built_in\">top</span>();</span><br><span class=\"line\">                s.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            s.<span class=\"built_in\">push</span>(i);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h2 id=\"å•†å“æŠ˜æ‰£åçš„æœ€ç»ˆä»·æ ¼\">å•†å“æŠ˜æ‰£åçš„æœ€ç»ˆä»·æ ¼</h2>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/***** æ‰¾åé¢ç¬¬ä¸€ä¸ªå°äºç­‰äº *****/</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">finalPrices</span><span class=\"params\">(vector&lt;<span class=\"type\">int</span>&gt;&amp; prices)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> n=prices.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">        <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">ans</span><span class=\"params\">(n)</span></span>;</span><br><span class=\"line\"> </span><br><span class=\"line\">        stack&lt;<span class=\"type\">int</span>&gt; s;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;n;i++)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span>(!s.<span class=\"built_in\">empty</span>()&amp;&amp;prices[s.<span class=\"built_in\">top</span>()]&gt;=prices[i])&#123;</span><br><span class=\"line\">                ans[s.<span class=\"built_in\">top</span>()]=prices[s.<span class=\"built_in\">top</span>()]-prices[i];</span><br><span class=\"line\">                s.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            s.<span class=\"built_in\">push</span>(i);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">while</span>(!s.<span class=\"built_in\">empty</span>())&#123;</span><br><span class=\"line\">            ans[s.<span class=\"built_in\">top</span>()]=prices[s.<span class=\"built_in\">top</span>()];</span><br><span class=\"line\">            s.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h2 id=\"ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ -I\">ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  I</h2>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/***** æ‰¾åé¢ç¬¬ä¸€ä¸ªå¤§ *****/</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">nextGreaterElement</span><span class=\"params\">(vector&lt;<span class=\"type\">int</span>&gt;&amp; nums1, vector&lt;<span class=\"type\">int</span>&gt;&amp; nums2)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">ans</span><span class=\"params\">(nums<span class=\"number\">1.</span>size())</span></span>;</span><br><span class=\"line\">        unordered_map&lt;<span class=\"type\">int</span>,<span class=\"type\">int</span>&gt; hashmap;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">//å¤„ç†nums2</span></span><br><span class=\"line\">        stack&lt;<span class=\"type\">int</span>&gt; s;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;nums<span class=\"number\">2.</span><span class=\"built_in\">size</span>();i++)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span>(!s.<span class=\"built_in\">empty</span>()&amp;&amp;nums2[s.<span class=\"built_in\">top</span>()]&lt;nums2[i])&#123;</span><br><span class=\"line\">                <span class=\"type\">int</span> temp=nums2[s.<span class=\"built_in\">top</span>()];</span><br><span class=\"line\">                hashmap[temp]=nums2[i];</span><br><span class=\"line\">                s.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            s.<span class=\"built_in\">push</span>(i);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;nums<span class=\"number\">1.</span><span class=\"built_in\">size</span>();i++)&#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> temp=nums1[i];</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(hashmap[temp]) ans[i]=hashmap[temp];</span><br><span class=\"line\">            <span class=\"keyword\">else</span> ans[i]=<span class=\"number\">-1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h2 id=\"ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ -II\">ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  II</h2>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/***** å¾ªç¯æ‰¾åé¢ç¬¬ä¸€ä¸ªå¤§ *****/</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">nextGreaterElements</span><span class=\"params\">(vector&lt;<span class=\"type\">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> n=nums.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">        <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">ans</span><span class=\"params\">(n,<span class=\"number\">-1</span>)</span></span>;</span><br><span class=\"line\"> </span><br><span class=\"line\">        stack&lt;<span class=\"type\">int</span>&gt; s;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">2</span>*n<span class=\"number\">-1</span>;i++)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span>(!s.<span class=\"built_in\">empty</span>()&amp;&amp;nums[s.<span class=\"built_in\">top</span>()]&lt;nums[i%n])&#123;</span><br><span class=\"line\">                ans[s.<span class=\"built_in\">top</span>()]=nums[i%n];</span><br><span class=\"line\">                s.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            s.<span class=\"built_in\">push</span>(i%n);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h2 id=\"æœ€å¤§å®½åº¦å¡\">æœ€å¤§å®½åº¦å¡</h2>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/*å•è°ƒé€’å‡æ ˆ*/</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">maxWidthRamp</span><span class=\"params\">(vector&lt;<span class=\"type\">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class=\"line\">        stack&lt;<span class=\"type\">int</span>&gt; s;</span><br><span class=\"line\">        <span class=\"type\">int</span> n = nums.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>;i &lt; n;i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (s.<span class=\"built_in\">empty</span>() || nums[s.<span class=\"built_in\">top</span>()] &gt; nums[i]) &#123;<span class=\"comment\">//è¦æŠŠç¬¬ä¸€ä¸ªæ•°æ®push</span></span><br><span class=\"line\">                s.<span class=\"built_in\">push</span>(i);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">int</span> ans = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = n - <span class=\"number\">1</span>;i &gt;= <span class=\"number\">0</span>;i--) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (!s.<span class=\"built_in\">empty</span>() &amp;&amp; nums[s.<span class=\"built_in\">top</span>()]&lt;=nums[i]) &#123;</span><br><span class=\"line\">                ans = <span class=\"built_in\">max</span>(ans,i - s.<span class=\"built_in\">top</span>());</span><br><span class=\"line\">                s.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h2 id=\"è½¦é˜Ÿ\">è½¦é˜Ÿ</h2>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/***** æ’åº+å•è°ƒæ ˆ *****/</span></span><br><span class=\"line\"><span class=\"comment\">/***** æ ¹æ®ä½ç½®ç”±å°åˆ°å¤§æ’åºï¼Œä½ç½®å¤§çš„å·¦ä¾§ï¼ˆä½ç½®å°ï¼‰çš„æ—¶é—´ä¸åº”æ›´å°ç­‰-&gt;ï¼ˆä¸¥æ ¼ï¼‰å•è°ƒé€’å‡æ ˆ *****/</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">carFleet</span><span class=\"params\">(<span class=\"type\">int</span> target, vector&lt;<span class=\"type\">int</span>&gt;&amp; position, vector&lt;<span class=\"type\">int</span>&gt;&amp; speed)</span> </span>&#123;</span><br><span class=\"line\">        map&lt;<span class=\"type\">int</span>,<span class=\"type\">int</span>&gt; ps; <span class=\"comment\">//è‡ªåŠ¨æ’åº</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;position.<span class=\"built_in\">size</span>();i++)&#123;</span><br><span class=\"line\">            ps[position[i]]=speed[i];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        stack&lt;<span class=\"type\">double</span>&gt; s;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span>&amp; [pos,spd]:ps)&#123;</span><br><span class=\"line\">            <span class=\"type\">double</span> time=<span class=\"built_in\">double</span>(target-pos)/spd;</span><br><span class=\"line\">            <span class=\"keyword\">while</span>(!s.<span class=\"built_in\">empty</span>()&amp;&amp;s.<span class=\"built_in\">top</span>()&lt;=time)&#123;</span><br><span class=\"line\">                s.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            s.<span class=\"built_in\">push</span>(time);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> s.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h1>çŸ©å½¢é¢ç§¯ï¼ˆå®Œç»“ï¼‰</h1>\n<h2 id=\"æŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢\">æŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢</h2>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/***** å•è°ƒæ ˆçš„å…¶ä¸­ä¸€ç§å†™æ³•---å¤„ç†æ ˆä¸­å…ƒç´  *****/</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">largestRectangleArea</span><span class=\"params\">(vector&lt;<span class=\"type\">int</span>&gt;&amp; heights)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> n = heights.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">        <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">left</span><span class=\"params\">(n,<span class=\"number\">-1</span>)</span>, <span class=\"title\">right</span><span class=\"params\">(n,n)</span></span>; <span class=\"comment\">//å·¦è¾¹ç¬¬ä¸€ä¸ªå°çš„ä½ç½®ã€å³è¾¹ç¬¬ä¸€ä¸ªå°çš„ä½ç½®</span></span><br><span class=\"line\">        </span><br><span class=\"line\">        stack&lt;<span class=\"type\">int</span>&gt; s;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;n;i++)&#123; <span class=\"comment\">//å¤„ç†å³è¾¹</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">while</span>(!s.<span class=\"built_in\">empty</span>()&amp;&amp;heights[s.<span class=\"built_in\">top</span>()]&gt;heights[i])&#123;</span><br><span class=\"line\">\t\t\t\tright[s.<span class=\"built_in\">top</span>()]=i;</span><br><span class=\"line\">\t\t\t\ts.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\ts.<span class=\"built_in\">push</span>(i);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">        s = <span class=\"built_in\">stack</span>&lt;<span class=\"type\">int</span>&gt; (); <span class=\"comment\">//æ¸…ç©ºæ ˆ</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=n<span class=\"number\">-1</span>;i&gt;=<span class=\"number\">0</span>;i--)&#123; <span class=\"comment\">//å¤„ç†å·¦è¾¹</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">while</span>(!s.<span class=\"built_in\">empty</span>()&amp;&amp;heights[s.<span class=\"built_in\">top</span>()]&gt;heights[i])&#123;</span><br><span class=\"line\">\t\t\t\tleft[s.<span class=\"built_in\">top</span>()]=i;</span><br><span class=\"line\">\t\t\t\ts.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\ts.<span class=\"built_in\">push</span>(i);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"type\">int</span> ans = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++) &#123;</span><br><span class=\"line\">            ans = <span class=\"built_in\">max</span>(ans, (right[i] - left[i] - <span class=\"number\">1</span>) * heights[i]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h2 id=\"å¥½å­æ•°ç»„çš„æœ€å¤§åˆ†æ•°\">å¥½å­æ•°ç»„çš„æœ€å¤§åˆ†æ•°</h2>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/***** å•è°ƒæ ˆçš„å¦ä¸€ç§å†™æ³•---å¤„ç†å½“å‰å…ƒç´  *****/</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">maximumScore</span><span class=\"params\">(vector&lt;<span class=\"type\">int</span>&gt;&amp; nums, <span class=\"type\">int</span> k)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> n=nums.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">        <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">left</span><span class=\"params\">(n,<span class=\"number\">-1</span>)</span>,<span class=\"title\">right</span><span class=\"params\">(n,n)</span></span>; <span class=\"comment\">//å·¦è¾¹ç¬¬ä¸€å°çš„ç¼–å·ã€å³è¾¹ç¬¬ä¸€å°çš„ç¼–å·</span></span><br><span class=\"line\"> </span><br><span class=\"line\">        stack&lt;<span class=\"type\">int</span>&gt; s;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;n;i++)&#123; <span class=\"comment\">//å¤„ç†å·¦è¾¹</span></span><br><span class=\"line\">            <span class=\"keyword\">while</span>(!s.<span class=\"built_in\">empty</span>()&amp;&amp;nums[s.<span class=\"built_in\">top</span>()]&gt;=nums[i]) s.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(!s.<span class=\"built_in\">empty</span>()) left[i]=s.<span class=\"built_in\">top</span>();</span><br><span class=\"line\">            s.<span class=\"built_in\">push</span>(i);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">        s=<span class=\"built_in\">stack</span>&lt;<span class=\"type\">int</span>&gt; ();</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=n<span class=\"number\">-1</span>;i&gt;=<span class=\"number\">0</span>;i--)&#123; <span class=\"comment\">//å¤„ç†å³è¾¹</span></span><br><span class=\"line\">            <span class=\"keyword\">while</span>(!s.<span class=\"built_in\">empty</span>()&amp;&amp;nums[s.<span class=\"built_in\">top</span>()]&gt;=nums[i]) s.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(!s.<span class=\"built_in\">empty</span>()) right[i]=s.<span class=\"built_in\">top</span>();</span><br><span class=\"line\">            s.<span class=\"built_in\">push</span>(i);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"type\">int</span> ans=<span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;n;i++)&#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> h=nums[i],l=left[i],r=right[i];</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(l&lt;k&amp;&amp;r&gt;k)&#123; <span class=\"comment\">//å¤šäº†ä¸€ä¸ªåŒºé—´åˆ¤æ–­</span></span><br><span class=\"line\">                ans=<span class=\"built_in\">max</span>(ans,h*(r-l<span class=\"number\">-1</span>));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;   </span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h2 id=\"æœ€å¤§çŸ©å½¢\">æœ€å¤§çŸ©å½¢</h2>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">maximalRectangle</span><span class=\"params\">(vector&lt;vector&lt;<span class=\"type\">char</span>&gt;&gt;&amp; matrix)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> n=matrix.<span class=\"built_in\">size</span>(); <span class=\"comment\">//è¡Œæ•°</span></span><br><span class=\"line\">        <span class=\"type\">int</span> m=matrix[<span class=\"number\">0</span>].<span class=\"built_in\">size</span>(); <span class=\"comment\">//åˆ—æ•°</span></span><br><span class=\"line\">        vector&lt;vector&lt;<span class=\"type\">int</span>&gt;&gt; <span class=\"built_in\">left</span>(n,<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;(m,<span class=\"number\">0</span>));</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;n;i++)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">0</span>;j&lt;m;j++)&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(matrix[i][j]==<span class=\"string\">&#x27;1&#x27;</span>)&#123;</span><br><span class=\"line\">                    left[i][j]=(j==<span class=\"number\">0</span>?<span class=\"number\">1</span>:left[i][j<span class=\"number\">-1</span>]<span class=\"number\">+1</span>); <span class=\"comment\">//å¾€å·¦èƒ½å¤Ÿå»¶ç”³çš„æœ€å¤§é•¿åº¦</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">int</span> ret=<span class=\"number\">0</span>;</span><br><span class=\"line\"> </span><br><span class=\"line\">        <span class=\"comment\">//å¯¹äºæ¯ä¸€åˆ—ï¼Œä½¿ç”¨åŸºäºæŸ±çŠ¶å›¾æ±‚æœ€å¤§çŸ©å½¢çš„æ–¹æ³•</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">0</span>;j&lt;m;j++)&#123;</span><br><span class=\"line\">            <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">up</span><span class=\"params\">(n,<span class=\"number\">0</span>)</span>,<span class=\"title\">down</span><span class=\"params\">(n,<span class=\"number\">0</span>)</span></span>;</span><br><span class=\"line\"> </span><br><span class=\"line\">            stack&lt;<span class=\"type\">int</span>&gt; s;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;n;i++)&#123; </span><br><span class=\"line\">                <span class=\"keyword\">while</span>(!s.<span class=\"built_in\">empty</span>()&amp;&amp;left[s.<span class=\"built_in\">top</span>()][j]&gt;=left[i][j])&#123;</span><br><span class=\"line\">                    s.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                up[i]=s.<span class=\"built_in\">empty</span>()?<span class=\"number\">-1</span>:s.<span class=\"built_in\">top</span>(); <span class=\"comment\">//ä¸Šè¾¹ç¬¬ä¸€ä¸ªå°äºçš„ç¼–å·</span></span><br><span class=\"line\">                s.<span class=\"built_in\">push</span>(i);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            s=<span class=\"built_in\">stack</span>&lt;<span class=\"type\">int</span>&gt;();<span class=\"comment\">//æ¸…ç©ºæ ˆ</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=n<span class=\"number\">-1</span>;i&gt;=<span class=\"number\">0</span>;i--)&#123;</span><br><span class=\"line\">                <span class=\"keyword\">while</span>(!s.<span class=\"built_in\">empty</span>()&amp;&amp;left[s.<span class=\"built_in\">top</span>()][j]&gt;=left[i][j])&#123;</span><br><span class=\"line\">                    s.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                down[i]=s.<span class=\"built_in\">empty</span>()?n:s.<span class=\"built_in\">top</span>(); <span class=\"comment\">//ä¸‹è¾¹ç¬¬ä¸€ä¸ªå°äºçš„ç¼–å·</span></span><br><span class=\"line\">                s.<span class=\"built_in\">push</span>(i);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;n;i++)&#123;</span><br><span class=\"line\">                <span class=\"type\">int</span> width=down[i]-up[i]<span class=\"number\">-1</span>;</span><br><span class=\"line\">                <span class=\"type\">int</span> area=width*left[i][j];</span><br><span class=\"line\">                ret=<span class=\"built_in\">max</span>(ret,area);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">        <span class=\"keyword\">return</span> ret;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h2 id=\"ç»Ÿè®¡å…¨-1-å­çŸ©å½¢\">ç»Ÿè®¡å…¨ 1 å­çŸ©å½¢</h2>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">numSubmat</span><span class=\"params\">(vector&lt;vector&lt;<span class=\"type\">int</span>&gt;&gt;&amp; mat)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> n=mat.<span class=\"built_in\">size</span>();</span><br><span class=\"line\">        <span class=\"type\">int</span> m=mat[<span class=\"number\">0</span>].<span class=\"built_in\">size</span>();</span><br><span class=\"line\">        <span class=\"function\">vector&lt;<span class=\"type\">int</span>&gt; <span class=\"title\">height</span><span class=\"params\">(m)</span></span>;</span><br><span class=\"line\"> </span><br><span class=\"line\">        <span class=\"comment\">/*å•è°ƒæ ˆæ±‚å·¦å³æ›´å°å€¼(åŒæ—¶å¤„ç†)*/</span></span><br><span class=\"line\">        <span class=\"keyword\">auto</span> calc=[&amp;]()-&gt;<span class=\"type\">int</span>&#123;</span><br><span class=\"line\">            vector&lt;<span class=\"type\">int</span>&gt; <span class=\"built_in\">left</span>(m,<span class=\"number\">-1</span>),<span class=\"built_in\">right</span>(m,m);</span><br><span class=\"line\"> </span><br><span class=\"line\">            stack&lt;<span class=\"type\">int</span>&gt; s;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;m;i++)&#123;</span><br><span class=\"line\">                <span class=\"keyword\">while</span>(!s.<span class=\"built_in\">empty</span>()&amp;&amp;height[s.<span class=\"built_in\">top</span>()]&gt;height[i])&#123;</span><br><span class=\"line\">                    right[s.<span class=\"built_in\">top</span>()]=i;</span><br><span class=\"line\">                    s.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(!s.<span class=\"built_in\">empty</span>())&#123;</span><br><span class=\"line\">                    left[i]=s.<span class=\"built_in\">top</span>();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                s.<span class=\"built_in\">push</span>(i);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">            <span class=\"type\">int</span> ans=<span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"comment\">/* è®¡ç®—ç»“æœæ—¶, ä¹˜æ³•åŸç† * çŸ©é˜µé«˜åº¦ */</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;m;i++)&#123;</span><br><span class=\"line\">                ans+=(right[i]-i)*(i-left[i])*height[i];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\"> </span><br><span class=\"line\">        <span class=\"type\">int</span> ans=<span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;n;i++)&#123; <span class=\"comment\">/* éå†æ¯ä¸€è¡Œçš„é«˜åº¦, æ›´æ–°æ”¹è¡Œçš„é«˜åº¦å€¼ä½¿ç”¨å•è°ƒæ ˆè®¡ç®—å·¦ä¾§æ›´å°å€¼å’Œå³ä¾§æ›´å°å€¼,å†è®¡ç®—æ¯ä¸ªå°çŸ©é˜µå‡ºç°çš„æ¬¡æ•°*/</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">0</span>;j&lt;m;j++)&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(mat[i][j]==<span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">                    height[j]=<span class=\"number\">0</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">                    height[j]++;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            ans+=<span class=\"built_in\">calc</span>();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h2 id=\"æ¥é›¨æ°´\">æ¥é›¨æ°´</h2>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">trap</span><span class=\"params\">(vector&lt;<span class=\"type\">int</span>&gt;&amp; height)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> ans=<span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> n=height.<span class=\"built_in\">size</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">        stack&lt;<span class=\"type\">int</span>&gt; s;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;n;i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (!s.<span class=\"built_in\">empty</span>() &amp;&amp; height[s.<span class=\"built_in\">top</span>()]&lt;height[i]) &#123;</span><br><span class=\"line\">                <span class=\"type\">int</span> top = s.<span class=\"built_in\">top</span>();</span><br><span class=\"line\">                s.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (s.<span class=\"built_in\">empty</span>()) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"type\">int</span> left = s.<span class=\"built_in\">top</span>();</span><br><span class=\"line\">                <span class=\"type\">int</span> currWidth = i - left - <span class=\"number\">1</span>;</span><br><span class=\"line\">                <span class=\"type\">int</span> currHeight = <span class=\"built_in\">min</span>(height[left], height[i]) - height[top];</span><br><span class=\"line\">                ans += currWidth * currHeight;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            s.<span class=\"built_in\">push</span>(i);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"comment\">/***** ä¸èƒ½å•çº¯æ‰¾å·¦è¾¹ç¬¬ä¸€ä¸ªå¤§ã€å³è¾¹ç¬¬ä¸€ä¸ªå¤§ *****/</span></span><br><span class=\"line\"><span class=\"comment\">/*è¿™ç§æƒ…å†µä¼šå¤šç®—</span></span><br><span class=\"line\"><span class=\"comment\">*   *</span></span><br><span class=\"line\"><span class=\"comment\">** **</span></span><br><span class=\"line\"><span class=\"comment\">** **</span></span><br><span class=\"line\"><span class=\"comment\">*****</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n<h1>æœ€å°å­—å…¸åº</h1>\n<h2 id=\"ç§»æ‰-K-ä½æ•°å­—\">ç§»æ‰ K ä½æ•°å­—</h2>\n","tags":["å•è°ƒæ ˆ","ç¼–ç¨‹","c++"]},{"title":"åšå®¢ä¸­åµŒå…¥PDFæ–‡ä»¶å¸¸è§æ–¹æ³•","url":"/post/b093ff5b.html","content":"<p>åœ¨Hexoæ¡†æ¶ä¸­ä½¿ç”¨Butterflyä¸»é¢˜æ—¶ï¼Œå¯ä»¥åœ¨åšå®¢æ–‡ç« ä¸­æ’å…¥PDFæ–‡ä»¶ã€‚ä»¥ä¸‹æ˜¯å‡ ç§å¸¸è§çš„æ–¹æ³•ï¼š</p>\n<hr>\n<h3 id=\"æ–¹æ³•ä¸€ï¼šä½¿ç”¨-embed-æ ‡ç­¾\"><strong>æ–¹æ³•ä¸€ï¼šä½¿ç”¨<code>&lt;embed&gt;</code>æ ‡ç­¾</strong></h3>\n<p>ç›´æ¥åœ¨Markdownæ–‡ä»¶ä¸­ä½¿ç”¨HTMLçš„<code>&lt;embed&gt;</code>æ ‡ç­¾åµŒå…¥PDFæ–‡ä»¶ã€‚</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">embed</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;/path/to/your/file.pdf&quot;</span> <span class=\"attr\">width</span>=<span class=\"string\">&quot;100%&quot;</span> <span class=\"attr\">height</span>=<span class=\"string\">&quot;600px&quot;</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;application/pdf&quot;</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n<ul>\n<li><strong><code>src</code></strong>ï¼šPDFæ–‡ä»¶çš„è·¯å¾„ï¼ˆå¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„æˆ–ç»å¯¹è·¯å¾„ï¼‰ã€‚</li>\n<li><strong><code>width</code> å’Œ <code>height</code></strong>ï¼šè®¾ç½®åµŒå…¥PDFçš„å®½åº¦å’Œé«˜åº¦ã€‚</li>\n<li><strong><code>type</code></strong>ï¼šæŒ‡å®šæ–‡ä»¶ç±»å‹ä¸º<code>application/pdf</code>ã€‚</li>\n</ul>\n<hr>\n<h3 id=\"æ–¹æ³•äºŒï¼šä½¿ç”¨-iframe-æ ‡ç­¾\"><strong>æ–¹æ³•äºŒï¼šä½¿ç”¨<code>&lt;iframe&gt;</code>æ ‡ç­¾</strong></h3>\n<p>ä½¿ç”¨<code>&lt;iframe&gt;</code>æ ‡ç­¾åµŒå…¥PDFæ–‡ä»¶ã€‚</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">iframe</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;/path/to/your/file.pdf&quot;</span> <span class=\"attr\">width</span>=<span class=\"string\">&quot;100%&quot;</span> <span class=\"attr\">height</span>=<span class=\"string\">&quot;600px&quot;</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\"><span class=\"tag\">&lt;/<span class=\"name\">iframe</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n<ul>\n<li><strong><code>src</code></strong>ï¼šPDFæ–‡ä»¶çš„è·¯å¾„ã€‚</li>\n<li><strong><code>width</code> å’Œ <code>height</code></strong>ï¼šè®¾ç½®åµŒå…¥PDFçš„å®½åº¦å’Œé«˜åº¦ã€‚</li>\n</ul>\n<hr>\n<h3 id=\"æ–¹æ³•ä¸‰ï¼šä½¿ç”¨PDF-js\"><strong>æ–¹æ³•ä¸‰ï¼šä½¿ç”¨PDF.js</strong></h3>\n<p>PDF.js æ˜¯ä¸€ä¸ªå¼€æºçš„PDFé˜…è¯»å™¨åº“ï¼Œå¯ä»¥åœ¨ç½‘é¡µä¸­åµŒå…¥PDFæ–‡ä»¶ã€‚</p>\n<ol>\n<li>\n<p><strong>ä¸‹è½½PDF.js</strong>ï¼š</p>\n<ul>\n<li>ä» <a href=\"https://mozilla.github.io/pdf.js/\">PDF.jså®˜ç½‘</a> ä¸‹è½½æœ€æ–°ç‰ˆæœ¬ã€‚</li>\n<li>è§£å‹åå°†æ–‡ä»¶å¤¹ï¼ˆä¾‹å¦‚<code>pdfjs</code>ï¼‰æ”¾åˆ°Hexoåšå®¢çš„<code>source</code>ç›®å½•ä¸‹ã€‚</li>\n</ul>\n</li>\n<li>\n<p><strong>åœ¨æ–‡ç« ä¸­åµŒå…¥PDF</strong>ï¼š<br>\nåœ¨Markdownæ–‡ä»¶ä¸­æ’å…¥ä»¥ä¸‹ä»£ç ï¼š</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">iframe</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;/pdfjs/web/viewer.html?file=/path/to/your/file.pdf&quot;</span> <span class=\"attr\">width</span>=<span class=\"string\">&quot;100%&quot;</span> <span class=\"attr\">height</span>=<span class=\"string\">&quot;600px&quot;</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\"><span class=\"tag\">&lt;/<span class=\"name\">iframe</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n<ul>\n<li><strong><code>src</code></strong>ï¼šæŒ‡å‘PDF.jsçš„<code>viewer.html</code>æ–‡ä»¶ï¼Œå¹¶é€šè¿‡<code>file</code>å‚æ•°æŒ‡å®šPDFæ–‡ä»¶çš„è·¯å¾„ã€‚</li>\n<li><strong><code>width</code> å’Œ <code>height</code></strong>ï¼šè®¾ç½®åµŒå…¥PDFçš„å®½åº¦å’Œé«˜åº¦ã€‚</li>\n</ul>\n</li>\n<li>\n<p><strong>éƒ¨ç½²</strong>ï¼š<br>\nç¡®ä¿PDFæ–‡ä»¶å’ŒPDF.jsæ–‡ä»¶å¤¹åœ¨éƒ¨ç½²åèƒ½å¤Ÿæ­£ç¡®è®¿é—®ã€‚</p>\n</li>\n</ol>\n<hr>\n<h3 id=\"æ–¹æ³•å››ï¼šä½¿ç”¨Google-Docs-Viewer\"><strong>æ–¹æ³•å››ï¼šä½¿ç”¨Google Docs Viewer</strong></h3>\n<p>é€šè¿‡Google Docs Vieweråœ¨çº¿é¢„è§ˆPDFæ–‡ä»¶ã€‚</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">iframe</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;https://docs.google.com/viewer?url=https://yourdomain.com/path/to/your/file.pdf&amp;embedded=true&quot;</span> <span class=\"attr\">width</span>=<span class=\"string\">&quot;100%&quot;</span> <span class=\"attr\">height</span>=<span class=\"string\">&quot;600px&quot;</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\"><span class=\"tag\">&lt;/<span class=\"name\">iframe</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n<ul>\n<li><strong><code>src</code></strong>ï¼šæŒ‡å‘Google Docs Viewerçš„URLï¼Œå¹¶é€šè¿‡<code>url</code>å‚æ•°æŒ‡å®šPDFæ–‡ä»¶çš„å®Œæ•´URLã€‚</li>\n<li><strong><code>width</code> å’Œ <code>height</code></strong>ï¼šè®¾ç½®åµŒå…¥PDFçš„å®½åº¦å’Œé«˜åº¦ã€‚</li>\n</ul>\n<hr>\n<h3 id=\"æ–¹æ³•äº”ï¼šä½¿ç”¨Butterflyä¸»é¢˜çš„æ ‡ç­¾æ’ä»¶\"><strong>æ–¹æ³•äº”ï¼šä½¿ç”¨Butterflyä¸»é¢˜çš„æ ‡ç­¾æ’ä»¶</strong></h3>\n<p>Butterflyä¸»é¢˜æ”¯æŒè‡ªå®šä¹‰æ ‡ç­¾æ’ä»¶ï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªPDFåµŒå…¥æ’ä»¶ã€‚</p>\n<ol>\n<li>\n<p><strong>åˆ›å»ºæ ‡ç­¾æ’ä»¶</strong>ï¼š<br>\nåœ¨Hexoåšå®¢çš„<code>scripts</code>æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„JavaScriptæ–‡ä»¶ï¼Œä¾‹å¦‚<code>pdf.js</code>ï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><span class=\"line\">hexo.<span class=\"property\">extend</span>.<span class=\"property\">tag</span>.<span class=\"title function_\">register</span>(<span class=\"string\">&#x27;pdf&#x27;</span>, <span class=\"keyword\">function</span>(<span class=\"params\">args</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> path = args[<span class=\"number\">0</span>];</span><br><span class=\"line\">  <span class=\"keyword\">const</span> width = args[<span class=\"number\">1</span>] || <span class=\"string\">&#x27;100%&#x27;</span>;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> height = args[<span class=\"number\">2</span>] || <span class=\"string\">&#x27;600px&#x27;</span>;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"string\">`&lt;embed src=&quot;<span class=\"subst\">$&#123;path&#125;</span>&quot; width=&quot;<span class=\"subst\">$&#123;width&#125;</span>&quot; height=&quot;<span class=\"subst\">$&#123;height&#125;</span>&quot; type=&quot;application/pdf&quot;&gt;`</span>;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p><strong>åœ¨æ–‡ç« ä¸­ä½¿ç”¨æ ‡ç­¾æ’ä»¶</strong>ï¼š<br>\nåœ¨Markdownæ–‡ä»¶ä¸­ä½¿ç”¨ä»¥ä¸‹è¯­æ³•ï¼š</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"code\"><pre><span class=\"line\">&#123;% pdf /path/to/your/file.pdf %&#125;</span><br></pre></td></tr></table></figure>\n<p>æˆ–è€…æŒ‡å®šå®½åº¦å’Œé«˜åº¦ï¼š</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"code\"><pre><span class=\"line\">&#123;% pdf /path/to/your/file.pdf 100% 800px %&#125;</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<hr>\n<h3 id=\"æ–¹æ³•å…­ï¼šç›´æ¥é“¾æ¥PDFæ–‡ä»¶\"><strong>æ–¹æ³•å…­ï¼šç›´æ¥é“¾æ¥PDFæ–‡ä»¶</strong></h3>\n<p>å¦‚æœä¸éœ€è¦åµŒå…¥PDFæ–‡ä»¶ï¼Œå¯ä»¥ç›´æ¥æä¾›ä¸‹è½½é“¾æ¥ã€‚</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"code\"><pre><span class=\"line\">[<span class=\"string\">ä¸‹è½½PDFæ–‡ä»¶</span>](<span class=\"link\">/path/to/your/file.pdf</span>)</span><br></pre></td></tr></table></figure>\n<hr>\n<h3 id=\"æ³¨æ„äº‹é¡¹\"><strong>æ³¨æ„äº‹é¡¹</strong></h3>\n<ol>\n<li>\n<p><strong>è·¯å¾„é—®é¢˜</strong>ï¼š</p>\n<ul>\n<li>å¦‚æœPDFæ–‡ä»¶æ”¾åœ¨<code>source</code>ç›®å½•ä¸‹ï¼Œè·¯å¾„åº”è¯¥æ˜¯ç›¸å¯¹äº<code>source</code>ç›®å½•çš„è·¯å¾„ã€‚</li>\n<li>ä¾‹å¦‚ï¼Œå¦‚æœPDFæ–‡ä»¶æ”¾åœ¨<code>source/files/example.pdf</code>ï¼Œè·¯å¾„åº”ä¸º<code>/files/example.pdf</code>ã€‚</li>\n</ul>\n</li>\n<li>\n<p><strong>æ–‡ä»¶å¤§å°</strong>ï¼š</p>\n<ul>\n<li>å¦‚æœPDFæ–‡ä»¶è¾ƒå¤§ï¼ŒåŠ è½½æ—¶é—´å¯èƒ½ä¼šè¾ƒé•¿ï¼Œå»ºè®®ä¼˜åŒ–PDFæ–‡ä»¶å¤§å°ã€‚</li>\n</ul>\n</li>\n<li>\n<p><strong>éƒ¨ç½²æµ‹è¯•</strong>ï¼š</p>\n<ul>\n<li>åœ¨æœ¬åœ°æµ‹è¯•æ—¶ï¼Œç¡®ä¿è·¯å¾„å’Œæ–‡ä»¶éƒ½èƒ½æ­£ç¡®è®¿é—®ã€‚</li>\n<li>éƒ¨ç½²åæ£€æŸ¥PDFæ–‡ä»¶æ˜¯å¦èƒ½å¤Ÿæ­£å¸¸åŠ è½½ã€‚</li>\n</ul>\n</li>\n</ol>\n<p>é€šè¿‡ä»¥ä¸Šæ–¹æ³•ï¼Œä½ å°±å¯ä»¥åœ¨Hexoåšå®¢çš„Butterflyä¸»é¢˜ä¸­è½»æ¾æ’å…¥PDFæ–‡ä»¶å•¦ã€‚</p>\n"},{"title":"åŠ¨æ€è§„åˆ’åšé¢˜æ€»ç»“","url":"/post/35c38ce3.html","content":"<h1>å…¥é—¨ DP</h1>\n<h2 id=\"çˆ¬æ¥¼æ¢¯\">çˆ¬æ¥¼æ¢¯</h2>\n<h3 id=\"çˆ¬æ¥¼æ¢¯-2\">çˆ¬æ¥¼æ¢¯</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">climbStairs</span><span class=\"params\">(<span class=\"type\">int</span> n)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt; <span class=\"title function_\">f</span><span class=\"params\">(n+<span class=\"number\">1</span>)</span>;     </span><br><span class=\"line\">        f[<span class=\"number\">0</span>]=<span class=\"number\">1</span>,f[<span class=\"number\">1</span>]=<span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">2</span>;i&lt;=n;i++)&#123;</span><br><span class=\"line\">            f[i]=f[i<span class=\"number\">-1</span>]+f[i<span class=\"number\">-2</span>];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> f[n];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"comment\">/*ç”±äºè¿™é‡Œçš„ f(x) åªå’Œ f(xâˆ’1) ä¸ f(xâˆ’2) æœ‰å…³ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨ã€Œæ»šåŠ¨æ•°ç»„æ€æƒ³ã€æŠŠç©ºé—´å¤æ‚åº¦ä¼˜åŒ–æˆ O(1)*/</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">climbStairs</span><span class=\"params\">(<span class=\"type\">int</span> n)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> p = <span class=\"number\">0</span>, q = <span class=\"number\">0</span>, r = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++) &#123;</span><br><span class=\"line\">            p = q; </span><br><span class=\"line\">            q = r; </span><br><span class=\"line\">            r = p + q;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"ä½¿ç”¨æœ€å°èŠ±è´¹çˆ¬æ¥¼æ¢¯\">ä½¿ç”¨æœ€å°èŠ±è´¹çˆ¬æ¥¼æ¢¯</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">minCostClimbingStairs</span><span class=\"params\">(<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&amp; cost)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> n = cost.size();</span><br><span class=\"line\">        <span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt; <span class=\"title function_\">dp</span><span class=\"params\">(n + <span class=\"number\">1</span>)</span>;</span><br><span class=\"line\">        dp[<span class=\"number\">0</span>] = dp[<span class=\"number\">1</span>] = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">2</span>; i &lt;= n; i++) &#123;</span><br><span class=\"line\">            dp[i] = min(dp[i - <span class=\"number\">1</span>] + cost[i - <span class=\"number\">1</span>], dp[i - <span class=\"number\">2</span>] + cost[i - <span class=\"number\">2</span>]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> dp[n];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"ç»„åˆæ€»å’Œ-â…£\">ç»„åˆæ€»å’Œ â…£</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/*æœ¬è´¨æ˜¯çˆ¬æ¥¼æ¢¯ï¼Œç›¸å½“äºæ¯æ¬¡å¾€ä¸Šçˆ¬ nums[i] æ­¥*/</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">long</span> <span class=\"type\">long</span> <span class=\"title function_\">combinationSum4</span><span class=\"params\">(<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&amp; nums, <span class=\"type\">int</span> target)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">vector</span>&lt;<span class=\"type\">long</span> <span class=\"type\">long</span>&gt; <span class=\"title function_\">dp</span><span class=\"params\">(target + <span class=\"number\">1</span>)</span>;</span><br><span class=\"line\">        dp[<span class=\"number\">0</span>] = <span class=\"number\">1</span>; <span class=\"comment\">//åªæœ‰å½“ä¸é€‰å–ä»»ä½•å…ƒç´ æ—¶ï¼Œå…ƒç´ ä¹‹å’Œæ‰ä¸º 0ï¼Œå› æ­¤åªæœ‰ 1 ç§æ–¹æ¡ˆã€‚</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= target; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span>&amp; num : nums) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (num &lt;= i&amp;&amp; dp[i - num] &lt; INT_MAX - dp[i]) &#123;</span><br><span class=\"line\">                    dp[i] += dp[i - num];</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> dp[target];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"comment\">/*å¦ä¸€ç§å†™æ³•*/</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">combinationSum4</span><span class=\"params\">(<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt; &amp;nums, <span class=\"type\">int</span> target)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// ä½¿ç”¨ unsigned å¯ä»¥è®©æº¢å‡ºä¸æŠ¥é”™</span></span><br><span class=\"line\">        <span class=\"comment\">// å¯¹äºæº¢å‡ºçš„æ•°æ®ï¼Œä¸ä¼šå½±å“ç­”æ¡ˆçš„æ­£ç¡®æ€§ï¼ˆé¢˜ç›®ä¿è¯ï¼‰</span></span><br><span class=\"line\">        <span class=\"built_in\">vector</span>&lt;<span class=\"type\">unsigned</span>&gt; <span class=\"title function_\">f</span><span class=\"params\">(target + <span class=\"number\">1</span>)</span>;</span><br><span class=\"line\">        f[<span class=\"number\">0</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= target; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> x : nums) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (x &lt;= i) &#123;</span><br><span class=\"line\">                    f[i] += f[i - x];</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> f[target];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"ç»Ÿè®¡æ„é€ å¥½å­—ç¬¦ä¸²çš„æ–¹æ¡ˆæ•°\">ç»Ÿè®¡æ„é€ å¥½å­—ç¬¦ä¸²çš„æ–¹æ¡ˆæ•°</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">countGoodStrings</span><span class=\"params\">(<span class=\"type\">int</span> low, <span class=\"type\">int</span> high, <span class=\"type\">int</span> zero, <span class=\"type\">int</span> one)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">const</span> <span class=\"type\">int</span> MOD = <span class=\"number\">1&#x27;000&#x27;000&#x27;007</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> ans = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt; <span class=\"title function_\">f</span><span class=\"params\">(high + <span class=\"number\">1</span>)</span>; <span class=\"comment\">// f[i] è¡¨ç¤ºæ„é€ é•¿ä¸º i çš„å­—ç¬¦ä¸²çš„æ–¹æ¡ˆæ•°</span></span><br><span class=\"line\">        f[<span class=\"number\">0</span>] = <span class=\"number\">1</span>; <span class=\"comment\">// æ„é€ ç©ºä¸²çš„æ–¹æ¡ˆæ•°ä¸º 1</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= high; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (i &gt;= zero) f[i] = f[i - zero];</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (i &gt;= one)  f[i] = (f[i] + f[i - one]) % MOD;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (i &gt;= low)  ans = (ans + f[i]) % MOD;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"ç»Ÿè®¡æ‰“å­—æ–¹æ¡ˆæ•°\">ç»Ÿè®¡æ‰“å­—æ–¹æ¡ˆæ•°</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">countTexts</span><span class=\"params\">(<span class=\"built_in\">string</span> pressedKeys)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> m = <span class=\"number\">1000000007</span>;</span><br><span class=\"line\">        <span class=\"built_in\">vector</span>&lt;<span class=\"type\">long</span> <span class=\"type\">long</span>&gt; dp3 = &#123;<span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">4</span>&#125;;   <span class=\"comment\">// è¿ç»­æŒ‰å¤šæ¬¡ 3 ä¸ªå­—æ¯æŒ‰é”®å¯¹åº”çš„æ–¹æ¡ˆæ•°</span></span><br><span class=\"line\">        <span class=\"built_in\">vector</span>&lt;<span class=\"type\">long</span> <span class=\"type\">long</span>&gt; dp4 = &#123;<span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">4</span>&#125;;   <span class=\"comment\">// è¿ç»­æŒ‰å¤šæ¬¡ 4 ä¸ªå­—æ¯æŒ‰é”®å¯¹åº”çš„æ–¹æ¡ˆæ•°</span></span><br><span class=\"line\">        <span class=\"type\">int</span> n = pressedKeys.size();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">4</span>; i &lt; n + <span class=\"number\">1</span>; ++i) &#123;</span><br><span class=\"line\">            dp3.push_back((dp3[i<span class=\"number\">-1</span>] + dp3[i<span class=\"number\">-2</span>] + dp3[i<span class=\"number\">-3</span>]) % m);</span><br><span class=\"line\">            dp4.push_back((dp4[i<span class=\"number\">-1</span>] + dp4[i<span class=\"number\">-2</span>] + dp4[i<span class=\"number\">-3</span>] + dp4[i<span class=\"number\">-4</span>]) % m);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">long</span> <span class=\"type\">long</span> res = <span class=\"number\">1</span>;   <span class=\"comment\">// æ€»æ–¹æ¡ˆæ•°</span></span><br><span class=\"line\">        <span class=\"type\">int</span> cnt = <span class=\"number\">1</span>;   <span class=\"comment\">// å½“å‰å­—ç¬¦è¿ç»­å‡ºç°çš„æ¬¡æ•°</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt; n; ++i) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (pressedKeys[i] == pressedKeys[i<span class=\"number\">-1</span>]) &#123;</span><br><span class=\"line\">                ++cnt;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">// å¯¹æŒ‰é”®å¯¹åº”å­—ç¬¦æ•°é‡è®¨è®ºå¹¶æ›´æ–°æ€»æ–¹æ¡ˆæ•°</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (pressedKeys[i<span class=\"number\">-1</span>] == <span class=\"string\">&#x27;7&#x27;</span> || pressedKeys[i<span class=\"number\">-1</span>] == <span class=\"string\">&#x27;9&#x27;</span>) &#123;</span><br><span class=\"line\">                    res *= dp4[cnt];</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    res *= dp3[cnt];</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                res %= m;</span><br><span class=\"line\">                cnt = <span class=\"number\">1</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// æ›´æ–°æœ€åä¸€æ®µè¿ç»­å­—ç¬¦å­ä¸²å¯¹åº”çš„æ–¹æ¡ˆæ•°</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (pressedKeys[n<span class=\"number\">-1</span>] == <span class=\"string\">&#x27;7&#x27;</span> || pressedKeys[n<span class=\"number\">-1</span>] == <span class=\"string\">&#x27;9&#x27;</span>) &#123;</span><br><span class=\"line\">            res *= dp4[cnt];</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            res *= dp3[cnt];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        res %= m;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h2 id=\"æ‰“å®¶åŠ«èˆ\">æ‰“å®¶åŠ«èˆ</h2>\n<h3 id=\"æ‰“å®¶åŠ«èˆ-2\">æ‰“å®¶åŠ«èˆ</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/*é¢˜æ„è½¬åŒ–ä¸ºï¼šä»åºåˆ—ä¸­é€‰æ‹©å­åºåˆ—ä½¿å¾—å®ƒä»¬çš„å’Œæœ€å¤§ï¼Œæ•°ä¸èƒ½æœ‰ç›¸é‚»*/</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">rob</span><span class=\"params\">(<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&amp; nums)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> n=nums.size();</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(n==<span class=\"number\">1</span>) <span class=\"keyword\">return</span> nums[<span class=\"number\">0</span>];</span><br><span class=\"line\">        <span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt; <span class=\"title function_\">dp</span><span class=\"params\">(n,<span class=\"number\">0</span>)</span>; <span class=\"comment\">//ç”¨ dp[i] è¡¨ç¤ºå‰ i é—´æˆ¿å±‹èƒ½å·çªƒåˆ°çš„æœ€é«˜æ€»é‡‘é¢</span></span><br><span class=\"line\">        dp[<span class=\"number\">0</span>]=nums[<span class=\"number\">0</span>];</span><br><span class=\"line\">        dp[<span class=\"number\">1</span>]=max(nums[<span class=\"number\">0</span>],nums[<span class=\"number\">1</span>]);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">2</span>;i&lt;n;i++)&#123;</span><br><span class=\"line\">            dp[i]=max(dp[i<span class=\"number\">-2</span>]+nums[i],dp[i<span class=\"number\">-1</span>]);</span><br><span class=\"line\">        &#125;  </span><br><span class=\"line\">        <span class=\"keyword\">return</span> dp[n<span class=\"number\">-1</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"comment\">/*ä¸Šè¿°æ–¹æ³•ä½¿ç”¨äº†æ•°ç»„å­˜å‚¨ç»“æœã€‚è€ƒè™‘åˆ°æ¯é—´æˆ¿å±‹çš„æœ€é«˜æ€»é‡‘é¢åªå’Œè¯¥æˆ¿å±‹çš„å‰ä¸¤é—´æˆ¿å±‹çš„æœ€é«˜æ€»é‡‘é¢ç›¸å…³ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨æ»šåŠ¨æ•°ç»„ï¼Œåœ¨æ¯ä¸ªæ—¶åˆ»åªéœ€è¦å­˜å‚¨å‰ä¸¤é—´æˆ¿å±‹çš„æœ€é«˜æ€»é‡‘é¢ã€‚*/</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">rob</span><span class=\"params\">(<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&amp; nums)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> n=nums.size();</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(n==<span class=\"number\">1</span>) <span class=\"keyword\">return</span> nums[<span class=\"number\">0</span>];</span><br><span class=\"line\">        <span class=\"type\">int</span> first=nums[<span class=\"number\">0</span>],second=max(nums[<span class=\"number\">0</span>],nums[<span class=\"number\">1</span>]);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">2</span>;i&lt;n;i++)&#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> temp=second;</span><br><span class=\"line\">            second=max(first+nums[i],second);</span><br><span class=\"line\">            first=temp;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> second;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"åˆ é™¤å¹¶è·å¾—ç‚¹æ•°\">åˆ é™¤å¹¶è·å¾—ç‚¹æ•°</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">private:</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">rob</span><span class=\"params\">(<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&amp; nums)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> n=nums.size();</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(n==<span class=\"number\">1</span>) <span class=\"keyword\">return</span> nums[<span class=\"number\">0</span>];</span><br><span class=\"line\">        <span class=\"type\">int</span> first=nums[<span class=\"number\">0</span>],second=max(nums[<span class=\"number\">0</span>],nums[<span class=\"number\">1</span>]);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">2</span>;i&lt;n;i++)&#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> temp=second;</span><br><span class=\"line\">            second=max(first+nums[i],second);</span><br><span class=\"line\">            first=temp;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> second;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">deleteAndEarn</span><span class=\"params\">(<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&amp; nums)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> maxval=<span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> val:nums)&#123;</span><br><span class=\"line\">            maxval=max(maxval,val);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;sum(maxval+<span class=\"number\">1</span>,<span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> val:nums)&#123;</span><br><span class=\"line\">            sum[val]+=val;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> rob(sum);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"ç»Ÿè®¡æ”¾ç½®æˆ¿å­çš„æ–¹å¼æ•°\">ç»Ÿè®¡æ”¾ç½®æˆ¿å­çš„æ–¹å¼æ•°</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/*å•ç‹¬è€ƒè™‘ä¸€ä¾§çš„æˆ¿å­ï¼Œå®šä¹‰ f[i] è¡¨ç¤ºå‰ i ä¸ªåœ°å—çš„æ”¾ç½®æ–¹æ¡ˆæ•°ï¼Œå…¶ä¸­ç¬¬ i ä¸ªåœ°å—å¯ä»¥æ”¾æˆ¿å­ï¼Œä¹Ÿå¯ä»¥ä¸æ”¾æˆ¿å­ã€‚*/</span></span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> mod=<span class=\"number\">1e9</span>+<span class=\"number\">7</span>;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">countHousePlacements</span><span class=\"params\">(<span class=\"type\">int</span> n)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">vector</span>&lt;<span class=\"type\">long</span> <span class=\"type\">long</span>&gt; <span class=\"title function_\">f</span><span class=\"params\">(n+<span class=\"number\">1</span>,<span class=\"number\">0</span>)</span>;</span><br><span class=\"line\">        f[<span class=\"number\">0</span>]=<span class=\"number\">1</span>;</span><br><span class=\"line\">        f[<span class=\"number\">1</span>]=<span class=\"number\">2</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">2</span>;i&lt;=n;i++)&#123;</span><br><span class=\"line\">            f[i]=(f[i<span class=\"number\">-1</span>]+f[i<span class=\"number\">-2</span>])%mod;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> f[n]*f[n]%mod;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"æ‰“å®¶åŠ«èˆ-II\">æ‰“å®¶åŠ«èˆ II</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/*ç¬¬ä¸€é—´æˆ¿å±‹å’Œæœ€åä¸€é—´æˆ¿å±‹ä¸åŒæ—¶å·çªƒ*/</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">robRange</span><span class=\"params\">(<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&amp; nums, <span class=\"type\">int</span> start, <span class=\"type\">int</span> end)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> first = nums[start], second = max(nums[start], nums[start + <span class=\"number\">1</span>]);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = start + <span class=\"number\">2</span>; i &lt;= end; i++) &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> temp = second;</span><br><span class=\"line\">            second = max(first + nums[i], second);</span><br><span class=\"line\">            first = temp;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> second;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">rob</span><span class=\"params\">(<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&amp; nums)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> length = nums.size();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (length == <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> nums[<span class=\"number\">0</span>];</span><br><span class=\"line\">        &#125; </span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (length == <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> max(nums[<span class=\"number\">0</span>], nums[<span class=\"number\">1</span>]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> max(robRange(nums, <span class=\"number\">0</span>, length - <span class=\"number\">2</span>), robRange(nums, <span class=\"number\">1</span>, length - <span class=\"number\">1</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"æ–½å’’çš„æœ€å¤§æ€»ä¼¤å®³\">æ–½å’’çš„æœ€å¤§æ€»ä¼¤å®³</h3>\n<h2 id=\"æœ€å¤§å­æ•°ç»„å’Œ\">æœ€å¤§å­æ•°ç»„å’Œ</h2>\n<blockquote>\n<p><em>å®šä¹‰çŠ¶æ€ f[i] è¡¨ç¤ºä»¥ a[i] ç»“å°¾çš„æœ€å¤§å­æ•°ç»„å’Œï¼Œä¸å’Œ i å·¦è¾¹æ‹¼èµ·æ¥å°±æ˜¯f[i]=a[i]ï¼Œå’Œ i å·¦è¾¹æ‹¼èµ·æ¥å°±æ˜¯f[i]=f[iâˆ’1]+a[i]ï¼Œå–æœ€å¤§å€¼å°±å¾—åˆ°äº†çŠ¶æ€è½¬ç§»æ–¹ç¨‹ f[i]=max(f[iâˆ’1],0)+a[i]ï¼Œç­”æ¡ˆä¸º max(f)ã€‚è¿™ä¸ªåšæ³•ä¹Ÿå«åš Kadane ç®—æ³•ã€‚</em></p>\n</blockquote>\n<h3 id=\"æœ€å¤§å­æ•°ç»„å’Œ-2\">æœ€å¤§å­æ•°ç»„å’Œ</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/*æ¨¡æ¿é¢˜*/</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">maxSubArray</span><span class=\"params\">(<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&amp; nums)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt; <span class=\"title function_\">dp</span><span class=\"params\">(nums.size())</span>;</span><br><span class=\"line\">        dp[<span class=\"number\">0</span>]=nums[<span class=\"number\">0</span>];</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;nums.size();i++)&#123;</span><br><span class=\"line\">            dp[i]=max(dp[i<span class=\"number\">-1</span>],<span class=\"number\">0</span>)+nums[i];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ranges::max(dp);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"æ‰¾åˆ°æœ€å¤§å¼€é”€çš„å­å­—ç¬¦ä¸²\">æ‰¾åˆ°æœ€å¤§å¼€é”€çš„å­å­—ç¬¦ä¸²</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/*ä¸€ç‚¹è½¬åŒ–+æ¨¡æ¿é¢˜*/</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">maximumCostSubstring</span><span class=\"params\">(<span class=\"built_in\">string</span> s, <span class=\"built_in\">string</span> chars, <span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&amp; vals)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt; <span class=\"title function_\">m</span><span class=\"params\">(<span class=\"number\">26</span>+<span class=\"number\">1</span>)</span>;</span><br><span class=\"line\">        iota(m.begin(),m.end(),<span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;chars.size();i++)&#123;</span><br><span class=\"line\">            m[chars[i]-<span class=\"string\">&#x27;a&#x27;</span>+<span class=\"number\">1</span>]=vals[i];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">        <span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt; <span class=\"title function_\">dp</span><span class=\"params\">(s.size())</span>;</span><br><span class=\"line\">        dp[<span class=\"number\">0</span>]=m[s[<span class=\"number\">0</span>]-<span class=\"string\">&#x27;a&#x27;</span>+<span class=\"number\">1</span>];</span><br><span class=\"line\">        <span class=\"type\">int</span> ans=max(<span class=\"number\">0</span>,dp[<span class=\"number\">0</span>]);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;s.size();i++)&#123;</span><br><span class=\"line\">            dp[i]=max(dp[i<span class=\"number\">-1</span>],<span class=\"number\">0</span>)+m[s[i]-<span class=\"string\">&#x27;a&#x27;</span>+<span class=\"number\">1</span>];</span><br><span class=\"line\">            ans=max(ans,dp[i]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"ä»»æ„å­æ•°ç»„å’Œçš„ç»å¯¹å€¼çš„æœ€å¤§å€¼\">ä»»æ„å­æ•°ç»„å’Œçš„ç»å¯¹å€¼çš„æœ€å¤§å€¼</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/*é¢˜ç›®è½¬åŒ–ä¸ºmax(æœ€å¤§å­æ•°ç»„å’Œï¼Œ-æœ€å°å­æ•°ç»„å’Œï¼Œ0)*/</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">maxAbsoluteSum</span><span class=\"params\">(<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&amp; nums)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt; <span class=\"title function_\">dp</span><span class=\"params\">(nums.size())</span>;</span><br><span class=\"line\">        dp[<span class=\"number\">0</span>]=nums[<span class=\"number\">0</span>];</span><br><span class=\"line\">        <span class=\"type\">int</span> ans1=dp[<span class=\"number\">0</span>];</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;nums.size();i++)&#123;</span><br><span class=\"line\">            dp[i]=max(dp[i<span class=\"number\">-1</span>],<span class=\"number\">0</span>)+nums[i];</span><br><span class=\"line\">            ans1=max(ans1,dp[i]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">        <span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt; <span class=\"title function_\">dp1</span><span class=\"params\">(nums.size())</span>;</span><br><span class=\"line\">        dp1[<span class=\"number\">0</span>]=nums[<span class=\"number\">0</span>];</span><br><span class=\"line\">        <span class=\"type\">int</span> ans2=dp1[<span class=\"number\">0</span>];</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;nums.size();i++)&#123;</span><br><span class=\"line\">            dp1[i]=min(dp1[i<span class=\"number\">-1</span>],<span class=\"number\">0</span>)+nums[i];</span><br><span class=\"line\">            ans2=min(ans2,dp1[i]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">int</span> ans=max(<span class=\"number\">0</span>,ans1);</span><br><span class=\"line\">        ans=max(ans,-ans2);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"K-æ¬¡ä¸²è”åæœ€å¤§å­æ•°ç»„ä¹‹å’Œ\">K æ¬¡ä¸²è”åæœ€å¤§å­æ•°ç»„ä¹‹å’Œ</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">è€ƒè™‘ä¸¤ç§æƒ…å†µï¼š</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">1.å¦‚æœk=1ï¼Œé‚£å°±æ˜¯æ­£å¸¸DPã€‚</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">2.k&gt;1æ—¶ä¹Ÿè€ƒè™‘ä¸¤ç§æƒ…å†µï¼šæ•°ç»„æ‰€æœ‰å…ƒç´ å’Œå¤§äº0ï¼Œæ•°ç»„æ‰€æœ‰å…ƒç´ å’Œå°äºç­‰äº0ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">é¦–å…ˆè®¡ç®—ä¸¤ä¸ªç›¸æ¥çš„DPä¹Ÿå°±æ˜¯k=2çš„æƒ…å†µï¼Œå¦‚æœæ•°ç»„å…ƒç´ å’Œå¤§äº0ï¼Œé‚£å¯ä»¥çœ‹æˆå†ç¬¬ä¸€æ®µç»“å°¾ç¬¬äºŒæ®µå¼€å¤´æ’å…¥k-2ä¸ªæ­£æ•°ï¼Œå¦‚æœæ•°ç»„æ‰€æœ‰å…ƒç´ å’Œä¸ºè´Ÿï¼Œé‚£k=2çš„æƒ…å†µå°±æ˜¯æœ€å¤§çš„æƒ…å†µã€‚</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">kConcatenationMaxSum</span><span class=\"params\">(<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&amp; arr, <span class=\"type\">int</span> k)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">const</span> <span class=\"type\">int</span> mod=<span class=\"number\">1e9</span>+<span class=\"number\">7</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> n=arr.size();</span><br><span class=\"line\">        <span class=\"type\">long</span> <span class=\"type\">long</span> sum=<span class=\"number\">0</span>,presum=<span class=\"number\">0</span>,result=<span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;n*(k&gt;<span class=\"number\">1</span>?<span class=\"number\">2</span>:<span class=\"number\">1</span>);i++)&#123;</span><br><span class=\"line\">            <span class=\"type\">long</span> <span class=\"type\">long</span> num=arr[i%n];</span><br><span class=\"line\">            presum=max(presum,<span class=\"number\">0ll</span>)+num;</span><br><span class=\"line\">            result=max(result,presum);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(i&lt;n) sum+=num;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(sum&gt;<span class=\"number\">0</span>&amp;&amp;k&gt;<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">            result=(result+sum*(k<span class=\"number\">-2</span>)%mod)%mod;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">1.sum&gt;0ã€k=2æ—¶ï¼Œæœ€å¤§å­æ•°ç»„å’Œå¦‚æœæ²¡æœ‰è·¨è¿‡ä¸¤ä¸ªæ•°ç»„ï¼Œé‚£å²‚ä¸æ˜¯ä¸èƒ½åœ¨ä¸­é—´æ’å…¥k-2ä¸ªsumå—ï¼Ÿ</span></span><br><span class=\"line\"><span class=\"comment\">åè¯æ³•ï¼Œåè®¾sum&gt;0æ—¶ï¼Œå¦‚æœæœ€å¤§å­æ•°ç»„å’Œæ²¡æœ‰è·¨è¿‡ä¸¤ä¸ªæ•°ç»„ã€‚ä»Låˆ°Rçš„å­æ•°ç»„çš„å’Œæœ€å¤§ï¼ˆ0&lt;=L&lt;=R&lt;n-1ï¼‰ï¼Œè€ƒè™‘Rå‘å³nä¸ªæ•°(R+1åˆ°R+n)ï¼Œè¿™nä¸ªæ•°ä¸€å®šæ˜¯å’Œarrçš„æ•°æ˜¯ä¸€æ ·çš„ï¼ˆå¾ªç¯äº†ï¼‰ï¼Œé‚£ä¹ˆè¿™nä¸ªæ•°çš„å’Œæ˜¯sumï¼Œå¤§äº0ã€‚æ‰€ä»¥ä»Låˆ°R+nçš„å­æ•°ç»„çš„å’Œè¦æ›´å¤§ï¼Œè€Œè¿™ä¸ªå­æ•°ç»„è·¨è¿‡äº†ä¸¤ä¸ªæ•°ç»„ï¼Œä¸åè®¾çŸ›ç›¾ã€‚æ‰€ä»¥è¿™æ ·åšæ˜¯å¯¹çš„ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">2.sum&lt;=0æ—¶ï¼Œä¸ºä»€ä¹ˆå¯ä»¥åŒ–å½’åˆ°k=2çš„æƒ…å†µï¼Ÿ</span></span><br><span class=\"line\"><span class=\"comment\">è¿˜æ˜¯åè¯æ³•ï¼Œå‡è®¾æœ€å¤§å­æ•°ç»„çš„é•¿åº¦&gt;2nï¼Œé‚£ä¸€å®šåŒ…æ‹¬ä¸€ä¸ªå®Œæ•´çš„arræ•°ç»„ï¼Œé‚£ä¹ˆå› ä¸ºsum&lt;=0ï¼Œæ‰€ä»¥æ‹¿æ‰è¿™ä¸€éƒ¨åˆ†ï¼ŒæŠŠå‰åæ‹¼æ¥åœ¨ä¸€èµ·ï¼ˆè¿™æ ·åšæ˜¾ç„¶æ˜¯åˆæ³•çš„ï¼‰ï¼Œè¿™æ ·åšç»“æœåªä¼šæ›´ä¼˜ï¼Œå¦‚æ­¤æ“ä½œä¸‹å»ï¼Œå°±å¯ä»¥åˆ’å½’åˆ°k=2çš„æƒ…å†µäº†ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"ç¯å½¢å­æ•°ç»„çš„æœ€å¤§å’Œ\">ç¯å½¢å­æ•°ç»„çš„æœ€å¤§å’Œ</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">maxSubarraySumCircular</span><span class=\"params\">(<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&amp; nums)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> n=nums.size();</span><br><span class=\"line\">        <span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt; <span class=\"title function_\">qianmax</span><span class=\"params\">(n)</span>; <span class=\"comment\">//å‰ç¼€æœ€å¤§å€¼</span></span><br><span class=\"line\">        <span class=\"type\">int</span> presum=nums[<span class=\"number\">0</span>];</span><br><span class=\"line\">        qianmax[<span class=\"number\">0</span>]=nums[<span class=\"number\">0</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">int</span> pre=nums[<span class=\"number\">0</span>];</span><br><span class=\"line\">        <span class=\"type\">int</span> ans=pre;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;n;i++)&#123;</span><br><span class=\"line\">            pre=max(pre,<span class=\"number\">0</span>)+nums[i];</span><br><span class=\"line\">            ans=max(ans,pre);</span><br><span class=\"line\"></span><br><span class=\"line\">            presum+=nums[i];</span><br><span class=\"line\">            qianmax[i]=max(qianmax[i<span class=\"number\">-1</span>],presum);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">int</span> housum=<span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=n<span class=\"number\">-1</span>;i&gt;<span class=\"number\">0</span>;i--)&#123; <span class=\"comment\">//æšä¸¾åç¼€å’Œ</span></span><br><span class=\"line\">            housum+=nums[i];</span><br><span class=\"line\">            ans=max(ans,housum+qianmax[i<span class=\"number\">-1</span>]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"æ‹¼æ¥æ•°ç»„çš„æœ€å¤§åˆ†æ•°\">æ‹¼æ¥æ•°ç»„çš„æœ€å¤§åˆ†æ•°</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/*è½¬æ¢æˆæœ€å¤§å­æ•°ç»„å’Œ*/</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">solve</span><span class=\"params\">(<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt; &amp;nums1, <span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt; &amp;nums2)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> sum = <span class=\"number\">0</span>, maxSum = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>, s = <span class=\"number\">0</span>; i &lt; nums1.size(); i++) &#123;</span><br><span class=\"line\">            sum += nums1[i];</span><br><span class=\"line\">            s = max(s,<span class=\"number\">0</span>)+(nums2[i] - nums1[i]);</span><br><span class=\"line\">            maxSum = max(maxSum, s);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> sum + maxSum;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">maximumsSplicedArray</span><span class=\"params\">(<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt; &amp;nums1, <span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt; &amp;nums2)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> max(solve(nums1, nums2), solve(nums2, nums1));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"æ‰©å±•ï¼‰ä¹˜ç§¯æœ€å¤§å­æ•°ç»„\">(æ‰©å±•ï¼‰ä¹˜ç§¯æœ€å¤§å­æ•°ç»„</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">maxProduct</span><span class=\"params\">(<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&amp; nums)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">vector</span> &lt;<span class=\"type\">long</span>&gt; maxF(nums.begin(),nums.end()), minF(nums.begin(), nums.end());</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt; nums.size(); i++) &#123;</span><br><span class=\"line\">            maxF[i] = max(maxF[i - <span class=\"number\">1</span>] * nums[i], max((<span class=\"type\">long</span>)nums[i], minF[i - <span class=\"number\">1</span>] * nums[i]));</span><br><span class=\"line\">            minF[i] = min(minF[i - <span class=\"number\">1</span>] * nums[i], min((<span class=\"type\">long</span>)nums[i], maxF[i - <span class=\"number\">1</span>] * nums[i]));</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(minF[i]&lt;INT_MIN) &#123;</span><br><span class=\"line\">                minF[i]=nums[i];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *max_element(maxF.begin(), maxF.end());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"comment\">/*ä¼˜åŒ–ç©ºé—´*/</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">maxProduct</span><span class=\"params\">(<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&amp; nums)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">long</span> maxF = nums[<span class=\"number\">0</span>], minF = nums[<span class=\"number\">0</span>], ans = nums[<span class=\"number\">0</span>];</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt; nums.size(); i++) &#123;</span><br><span class=\"line\">            <span class=\"type\">long</span> mx = maxF, mn = minF;</span><br><span class=\"line\">            maxF = max(mx * nums[i], max((<span class=\"type\">long</span>)nums[i], mn * nums[i]));</span><br><span class=\"line\">            minF = min(mn * nums[i], min((<span class=\"type\">long</span>)nums[i], mx * nums[i]));</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(minF&lt;INT_MIN) &#123;</span><br><span class=\"line\">                minF=nums[i];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            ans = max(maxF, ans);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h1>ç½‘æ ¼å›¾ DP</h1>\n<h2 id=\"åŸºç¡€\">åŸºç¡€</h2>\n<h3 id=\"ç å®çš„æœ€é«˜ä»·å€¼\">ç å®çš„æœ€é«˜ä»·å€¼</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">jewelleryValue</span><span class=\"params\">(<span class=\"built_in\">vector</span>&lt;<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&gt;&amp; frame)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> n=frame.size();</span><br><span class=\"line\">        <span class=\"type\">int</span> m=frame[<span class=\"number\">0</span>].size();</span><br><span class=\"line\">        <span class=\"built_in\">vector</span>&lt;<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&gt; f(n,<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;(m));</span><br><span class=\"line\">        f[<span class=\"number\">0</span>][<span class=\"number\">0</span>]=frame[<span class=\"number\">0</span>][<span class=\"number\">0</span>];</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;n;i++)&#123; <span class=\"comment\">//å¤„ç†ç¬¬ä¸€åˆ—</span></span><br><span class=\"line\">            f[i][<span class=\"number\">0</span>]=f[i<span class=\"number\">-1</span>][<span class=\"number\">0</span>]+frame[i][<span class=\"number\">0</span>];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">1</span>;j&lt;m;j++)&#123; <span class=\"comment\">//å¤„ç†ç¬¬ä¸€è¡Œ</span></span><br><span class=\"line\">            f[<span class=\"number\">0</span>][j]=f[<span class=\"number\">0</span>][j<span class=\"number\">-1</span>]+frame[<span class=\"number\">0</span>][j];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;n;i++)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">1</span>;j&lt;m;j++)&#123;</span><br><span class=\"line\">                f[i][j]=max(f[i<span class=\"number\">-1</span>][j],f[i][j<span class=\"number\">-1</span>])+frame[i][j];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> f[n<span class=\"number\">-1</span>][m<span class=\"number\">-1</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\">/*æ³¨æ„åˆ°çŠ¶æ€è½¬ç§»æ–¹ç¨‹ä¸­ï¼Œf(i,j) åªä¼šä» f(iâˆ’1,j) å’Œ f(i,jâˆ’1) è½¬ç§»è€Œæ¥ï¼Œè€Œä¸ f(iâˆ’2,â‹¯) ä»¥åŠæ›´æ—©çš„çŠ¶æ€æ— å…³ï¼Œå› æ­¤æˆ‘ä»¬åŒä¸€æ—¶åˆ»åªéœ€è¦å­˜å‚¨æœ€åä¸¤è¡Œçš„çŠ¶æ€ï¼Œå³ä½¿ç”¨ä¸¤ä¸ªé•¿åº¦ä¸º n çš„ä¸€ä½æ•°ç»„ä»£æ›¿ nÃ—m çš„äºŒç»´æ•°ç»„ fï¼Œäº¤æ›¿åœ°è¿›è¡ŒçŠ¶æ€è½¬ç§»ï¼Œå‡å°‘ç©ºé—´å¤æ‚åº¦ã€‚*/</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">jewelleryValue</span><span class=\"params\">(<span class=\"built_in\">vector</span>&lt;<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&gt;&amp; frame)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> n=frame.size();</span><br><span class=\"line\">        <span class=\"type\">int</span> m=frame[<span class=\"number\">0</span>].size();</span><br><span class=\"line\">        <span class=\"built_in\">vector</span>&lt;<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&gt; f(<span class=\"number\">2</span>,<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;(m));</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;n;i++)&#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> pos=i%<span class=\"number\">2</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">0</span>;j&lt;m;j++)&#123;</span><br><span class=\"line\">                f[pos][j]=<span class=\"number\">0</span>;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(i&gt;<span class=\"number\">0</span>) f[pos][j]=max(f[pos][j],f[<span class=\"number\">1</span>-pos][j]);</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(j&gt;<span class=\"number\">0</span>) f[pos][j]=max(f[pos][j],f[pos][j<span class=\"number\">-1</span>]);</span><br><span class=\"line\">                f[pos][j]+=frame[i][j];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> f[(n<span class=\"number\">-1</span>)%<span class=\"number\">2</span>][m<span class=\"number\">-1</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"ä¸åŒè·¯å¾„\">ä¸åŒè·¯å¾„</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">uniquePaths</span><span class=\"params\">(<span class=\"type\">int</span> m, <span class=\"type\">int</span> n)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">vector</span>&lt;<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&gt; f(m,<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;(n));</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;m;i++) f[i][<span class=\"number\">0</span>]=<span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">0</span>;j&lt;n;j++) f[<span class=\"number\">0</span>][j]=<span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;m;i++)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">1</span>;j&lt;n;j++)&#123;</span><br><span class=\"line\">                f[i][j]=f[i<span class=\"number\">-1</span>][j]+f[i][j<span class=\"number\">-1</span>];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> f[m<span class=\"number\">-1</span>][n<span class=\"number\">-1</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"comment\">/*æ­¤å¤–ï¼Œç”±äº f(i,j) ä»…ä¸ç¬¬ i è¡Œå’Œç¬¬ iâˆ’1 è¡Œçš„çŠ¶æ€æœ‰å…³ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ»šåŠ¨æ•°ç»„ä»£æ›¿ä»£ç ä¸­çš„äºŒç»´æ•°ç»„ï¼Œä½¿ç©ºé—´å¤æ‚åº¦é™ä½ä¸º O(n)ã€‚*/</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">uniquePaths</span><span class=\"params\">(<span class=\"type\">int</span> m, <span class=\"type\">int</span> n)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt; <span class=\"title function_\">f</span><span class=\"params\">(n,<span class=\"number\">1</span>)</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt; m; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">1</span>; j &lt; n; j++) &#123;</span><br><span class=\"line\">                f[j]+=f[j<span class=\"number\">-1</span>];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> f[n - <span class=\"number\">1</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"ä¸åŒè·¯å¾„-II\">ä¸åŒè·¯å¾„ II</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">uniquePathsWithObstacles</span><span class=\"params\">(<span class=\"built_in\">vector</span>&lt;<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&gt;&amp; obstacleGrid)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> m=obstacleGrid.size();</span><br><span class=\"line\">        <span class=\"type\">int</span> n=obstacleGrid[<span class=\"number\">0</span>].size();</span><br><span class=\"line\">        <span class=\"built_in\">vector</span>&lt;<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&gt; f(m,<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;(n));</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;m;i++)&#123; <span class=\"comment\">//å¤„ç†ç¬¬ä¸€åˆ—</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span>(obstacleGrid[i][<span class=\"number\">0</span>]==<span class=\"number\">1</span>)&#123; <span class=\"comment\">//æœ‰éšœç¢ </span></span><br><span class=\"line\">                f[i][<span class=\"number\">0</span>]=<span class=\"number\">0</span>; </span><br><span class=\"line\">                <span class=\"keyword\">break</span>; <span class=\"comment\">//åé¢éƒ½åˆ°è¾¾ä¸äº†</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> f[i][<span class=\"number\">0</span>]=<span class=\"number\">1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">0</span>;j&lt;n;j++)&#123;  <span class=\"comment\">//å¤„ç†ç¬¬ä¸€è¡Œ</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span>(obstacleGrid[<span class=\"number\">0</span>][j]==<span class=\"number\">1</span>)&#123; <span class=\"comment\">//æœ‰éšœç¢</span></span><br><span class=\"line\">                f[<span class=\"number\">0</span>][j]=<span class=\"number\">0</span>; </span><br><span class=\"line\">                <span class=\"keyword\">break</span>; <span class=\"comment\">//åé¢éƒ½åˆ°è¾¾ä¸äº†</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> f[<span class=\"number\">0</span>][j]=<span class=\"number\">1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;m;i++)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">1</span>;j&lt;n;j++)&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(obstacleGrid[i][j]==<span class=\"number\">1</span>) f[i][j]=<span class=\"number\">0</span>;</span><br><span class=\"line\">                <span class=\"keyword\">else</span> f[i][j]=f[i<span class=\"number\">-1</span>][j]+f[i][j<span class=\"number\">-1</span>];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> f[m<span class=\"number\">-1</span>][n<span class=\"number\">-1</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"æœ€å°è·¯å¾„å’Œ\">æœ€å°è·¯å¾„å’Œ</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">minPathSum</span><span class=\"params\">(<span class=\"built_in\">vector</span>&lt;<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&gt;&amp; grid)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> n=grid.size();</span><br><span class=\"line\">        <span class=\"type\">int</span> m=grid[<span class=\"number\">0</span>].size();</span><br><span class=\"line\">        <span class=\"built_in\">vector</span>&lt;<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&gt; dp(n,<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;(m));</span><br><span class=\"line\">        dp[<span class=\"number\">0</span>][<span class=\"number\">0</span>]=grid[<span class=\"number\">0</span>][<span class=\"number\">0</span>];</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;n;i++) dp[i][<span class=\"number\">0</span>]=dp[i<span class=\"number\">-1</span>][<span class=\"number\">0</span>]+grid[i][<span class=\"number\">0</span>];</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">1</span>;j&lt;m;j++) dp[<span class=\"number\">0</span>][j]=dp[<span class=\"number\">0</span>][j<span class=\"number\">-1</span>]+grid[<span class=\"number\">0</span>][j];</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;n;i++)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">1</span>;j&lt;m;j++)&#123;</span><br><span class=\"line\">                dp[i][j]=min(dp[i<span class=\"number\">-1</span>][j],dp[i][j<span class=\"number\">-1</span>])+grid[i][j];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> dp[n<span class=\"number\">-1</span>][m<span class=\"number\">-1</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"ä¸‰è§’å½¢æœ€å°è·¯å¾„å’Œ\">ä¸‰è§’å½¢æœ€å°è·¯å¾„å’Œ</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">minimumTotal</span><span class=\"params\">(<span class=\"built_in\">vector</span>&lt;<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&gt;&amp; triangle)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> n=triangle.size();</span><br><span class=\"line\">        <span class=\"built_in\">vector</span>&lt;<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&gt; dp(n,<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;(n));</span><br><span class=\"line\">        dp[<span class=\"number\">0</span>][<span class=\"number\">0</span>]=triangle[<span class=\"number\">0</span>][<span class=\"number\">0</span>];</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;n;i++)&#123;</span><br><span class=\"line\">            dp[i][<span class=\"number\">0</span>]=dp[i<span class=\"number\">-1</span>][<span class=\"number\">0</span>]+triangle[i][<span class=\"number\">0</span>]; <span class=\"comment\">//ç¬¬ä¸€åˆ—åªèƒ½ä»ä¸Šé¢è½¬ç§»</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">1</span>;j&lt;i;j++)&#123;</span><br><span class=\"line\">                dp[i][j]=min(dp[i<span class=\"number\">-1</span>][j<span class=\"number\">-1</span>],dp[i<span class=\"number\">-1</span>][j])+triangle[i][j];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            dp[i][i]=dp[i<span class=\"number\">-1</span>][i<span class=\"number\">-1</span>]+triangle[i][i];<span class=\"comment\">//æœ€åä¸€åˆ—åªèƒ½ä»å·¦ä¸Šè½¬ç§»</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *min_element(dp[n<span class=\"number\">-1</span>].begin(),dp[n<span class=\"number\">-1</span>].end());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"comment\">/*å¯ä»¥å‘ç°ï¼Œdp[i][j] åªä¸ dp[iâˆ’1][..] æœ‰å…³ï¼Œè€Œä¸ dp[iâˆ’2][..] åŠä¹‹å‰çš„çŠ¶æ€æ— å…³ï¼Œå› æ­¤æˆ‘ä»¬ä¸å¿…å­˜å‚¨è¿™äº›æ— å…³çš„çŠ¶æ€ã€‚å…·ä½“åœ°ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸¤ä¸ªé•¿åº¦ä¸º n çš„ä¸€ç»´æ•°ç»„è¿›è¡Œè½¬ç§»ï¼Œå°† i æ ¹æ®å¥‡å¶æ€§æ˜ å°„åˆ°å…¶ä¸­ä¸€ä¸ªä¸€ç»´æ•°ç»„ï¼Œé‚£ä¹ˆ iâˆ’1 å°±æ˜ å°„åˆ°äº†å¦ä¸€ä¸ªä¸€ç»´æ•°ç»„ã€‚è¿™æ ·æˆ‘ä»¬ä½¿ç”¨è¿™ä¸¤ä¸ªä¸€ç»´æ•°ç»„ï¼Œäº¤æ›¿åœ°è¿›è¡ŒçŠ¶æ€è½¬ç§»ã€‚*/</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">minimumTotal</span><span class=\"params\">(<span class=\"built_in\">vector</span>&lt;<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&gt;&amp; triangle)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> n=triangle.size();</span><br><span class=\"line\">        <span class=\"built_in\">vector</span>&lt;<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&gt; dp(<span class=\"number\">2</span>,<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;(n));</span><br><span class=\"line\">        dp[<span class=\"number\">0</span>][<span class=\"number\">0</span>]=triangle[<span class=\"number\">0</span>][<span class=\"number\">0</span>];</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;n;i++)&#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> cur=i%<span class=\"number\">2</span>; <span class=\"comment\">//å½“å‰è¡Œ</span></span><br><span class=\"line\">            <span class=\"type\">int</span> pre=<span class=\"number\">1</span>-cur; <span class=\"comment\">//ä¸Šä¸€è¡Œ</span></span><br><span class=\"line\">            dp[cur][<span class=\"number\">0</span>]=dp[pre][<span class=\"number\">0</span>]+triangle[i][<span class=\"number\">0</span>]; <span class=\"comment\">//ç¬¬ä¸€åˆ—åªèƒ½ä»ä¸Šé¢è½¬ç§»</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">1</span>;j&lt;i;j++)&#123;</span><br><span class=\"line\">                dp[cur][j]=min(dp[pre][j<span class=\"number\">-1</span>],dp[pre][j])+triangle[i][j];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            dp[cur][i]=dp[pre][i<span class=\"number\">-1</span>]+triangle[i][i];<span class=\"comment\">//æœ€åä¸€åˆ—åªèƒ½ä»å·¦ä¸Šè½¬ç§»</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *min_element(dp[(n<span class=\"number\">-1</span>)%<span class=\"number\">2</span>].begin(),dp[(n<span class=\"number\">-1</span>)%<span class=\"number\">2</span>].end());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"ä¸‹é™è·¯å¾„æœ€å°å’Œ\">ä¸‹é™è·¯å¾„æœ€å°å’Œ</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">minFallingPathSum</span><span class=\"params\">(<span class=\"built_in\">vector</span>&lt;<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&gt;&amp; matrix)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> n=matrix.size();</span><br><span class=\"line\">        <span class=\"built_in\">vector</span>&lt;<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&gt; dp(n,<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;(n));</span><br><span class=\"line\">        copy(matrix[<span class=\"number\">0</span>].begin(),matrix[<span class=\"number\">0</span>].end(),dp[<span class=\"number\">0</span>].begin());</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;n;i++)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">0</span>;j&lt;n;j++)&#123;</span><br><span class=\"line\">                <span class=\"type\">int</span> minn=dp[i<span class=\"number\">-1</span>][j]; <span class=\"comment\">//éƒ½èƒ½ä»æ­£ä¸Šæ–¹è½¬ç§»</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span>(j&gt;<span class=\"number\">0</span>)&#123; <span class=\"comment\">//å¯ä»¥ä»å·¦ä¸Šæ–¹è½¬ç§»</span></span><br><span class=\"line\">                    minn=min(minn,dp[i<span class=\"number\">-1</span>][j<span class=\"number\">-1</span>]);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(j&lt;n<span class=\"number\">-1</span>)&#123; <span class=\"comment\">//å¯ä»¥ä»å³ä¸Šæ–¹è½¬ç§»</span></span><br><span class=\"line\">                    minn=min(minn,dp[i<span class=\"number\">-1</span>][j+<span class=\"number\">1</span>]);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                dp[i][j]=minn+matrix[i][j];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *min_element(dp[n<span class=\"number\">-1</span>].begin(),dp[n<span class=\"number\">-1</span>].end());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"çŸ©é˜µä¸­ç§»åŠ¨çš„æœ€å¤§æ¬¡æ•°\">çŸ©é˜µä¸­ç§»åŠ¨çš„æœ€å¤§æ¬¡æ•°</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">maxMoves</span><span class=\"params\">(<span class=\"built_in\">vector</span>&lt;<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&gt;&amp; grid)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> ans=<span class=\"number\">0</span>; <span class=\"type\">bool</span> flag=<span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> n=grid.size();</span><br><span class=\"line\">        <span class=\"type\">int</span> m=grid[<span class=\"number\">0</span>].size();</span><br><span class=\"line\">        <span class=\"built_in\">vector</span>&lt;<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&gt; dp(n,<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;(m)); <span class=\"comment\">//dp[i][j]==1è¡¨ç¤º(i,j)ä½ç½®å¯åˆ°è¾¾</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;n;i++) dp[i][<span class=\"number\">0</span>]=<span class=\"number\">1</span>; </span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">1</span>;j&lt;m;j++)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(!flag) <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">            flag=<span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;n;i++)&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(grid[i][j<span class=\"number\">-1</span>]&lt;grid[i][j]&amp;&amp;dp[i][j<span class=\"number\">-1</span>])&#123;</span><br><span class=\"line\">                    dp[i][j]=<span class=\"number\">1</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(i&gt;<span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span>(grid[i<span class=\"number\">-1</span>][j<span class=\"number\">-1</span>]&lt;grid[i][j]&amp;&amp;dp[i<span class=\"number\">-1</span>][j<span class=\"number\">-1</span>])&#123;</span><br><span class=\"line\">                        dp[i][j]=<span class=\"number\">1</span>;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(i&lt;n<span class=\"number\">-1</span>)&#123;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span>(grid[i+<span class=\"number\">1</span>][j<span class=\"number\">-1</span>]&lt;grid[i][j]&amp;&amp;dp[i+<span class=\"number\">1</span>][j<span class=\"number\">-1</span>])&#123;</span><br><span class=\"line\">                        dp[i][j]=<span class=\"number\">1</span>;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(dp[i][j])&#123;</span><br><span class=\"line\">                    flag=<span class=\"number\">1</span>;</span><br><span class=\"line\">                    ans=j;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">//ans+=1;</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"ç½‘æ ¼ä¸­çš„æœ€å°è·¯å¾„ä»£ä»·\">ç½‘æ ¼ä¸­çš„æœ€å°è·¯å¾„ä»£ä»·</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">minPathCost</span><span class=\"params\">(<span class=\"built_in\">vector</span>&lt;<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&gt;&amp; grid, <span class=\"built_in\">vector</span>&lt;<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&gt;&amp; moveCost)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> m=grid.size(),n=grid[<span class=\"number\">0</span>].size();</span><br><span class=\"line\">        <span class=\"built_in\">vector</span>&lt;<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&gt; dp(<span class=\"number\">2</span>,<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;(n));</span><br><span class=\"line\">        dp[<span class=\"number\">0</span>]=grid[<span class=\"number\">0</span>];</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;m;i++)&#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> cur=i%<span class=\"number\">2</span>; <span class=\"comment\">//å½“å‰è¡Œ</span></span><br><span class=\"line\">            <span class=\"type\">int</span> pre=<span class=\"number\">1</span>-cur; <span class=\"comment\">//ä¸Šä¸€è¡Œ</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">0</span>;j&lt;n;j++)&#123; <span class=\"comment\">//å½“å‰è¡Œæ¯ä¸€åˆ—</span></span><br><span class=\"line\">                dp[cur][j]=INT_MAX;</span><br><span class=\"line\">                <span class=\"keyword\">for</span>(<span class=\"type\">int</span> k=<span class=\"number\">0</span>;k&lt;n;k++)&#123; <span class=\"comment\">//ä¸Šä¸€è¡Œæ¯ä¸€åˆ—</span></span><br><span class=\"line\">                    dp[cur][j]=min(dp[cur][j],dp[pre][k]+moveCost[grid[i<span class=\"number\">-1</span>][k]][j]+grid[i][j]);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *min_element(dp[(m<span class=\"number\">-1</span>)%<span class=\"number\">2</span>].begin(),dp[(m<span class=\"number\">-1</span>)%<span class=\"number\">2</span>].end());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"ä¸‹é™è·¯å¾„æœ€å°å’Œ-II\">ä¸‹é™è·¯å¾„æœ€å°å’Œ II</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">minFallingPathSum</span><span class=\"params\">(<span class=\"built_in\">vector</span>&lt;<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&gt;&amp; grid)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> n=grid.size(),m=grid[<span class=\"number\">0</span>].size();</span><br><span class=\"line\">        <span class=\"built_in\">vector</span>&lt;<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&gt; dp(<span class=\"number\">2</span>,<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;(m));</span><br><span class=\"line\">        dp[<span class=\"number\">0</span>]=grid[<span class=\"number\">0</span>];</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;n;i++)&#123; </span><br><span class=\"line\">            <span class=\"type\">int</span> cur=i%<span class=\"number\">2</span>; <span class=\"comment\">//å½“å‰è¡Œ</span></span><br><span class=\"line\">            <span class=\"type\">int</span> pre=<span class=\"number\">1</span>-cur; <span class=\"comment\">//ä¸Šä¸€è¡Œ</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">0</span>;j&lt;m;j++)&#123; <span class=\"comment\">//å½“å‰è¡Œæ¯ä¸€åˆ—</span></span><br><span class=\"line\">                dp[cur][j]=INT_MAX;</span><br><span class=\"line\">                <span class=\"keyword\">for</span>(<span class=\"type\">int</span> k=<span class=\"number\">0</span>;k&lt;m;k++)&#123; <span class=\"comment\">//ä¸Šä¸€è¡Œæ¯ä¸€åˆ—</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span>(j!=k)&#123;</span><br><span class=\"line\">                        dp[cur][j]=min(dp[cur][j],dp[pre][k]+grid[i][j]);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *min_element(dp[(n<span class=\"number\">-1</span>)%<span class=\"number\">2</span>].begin(),dp[(n<span class=\"number\">-1</span>)%<span class=\"number\">2</span>].end());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h2 id=\"è¿›é˜¶\">è¿›é˜¶</h2>\n<h3 id=\"çŸ©é˜µçš„æœ€å¤§éè´Ÿç§¯\">çŸ©é˜µçš„æœ€å¤§éè´Ÿç§¯</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">maxProductPath</span><span class=\"params\">(<span class=\"built_in\">vector</span>&lt;<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&gt;&amp; grid)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">const</span> <span class=\"type\">int</span> mod=<span class=\"number\">1e9</span>+<span class=\"number\">7</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> m=grid.size(),n=grid[<span class=\"number\">0</span>].size();</span><br><span class=\"line\">        <span class=\"built_in\">vector</span>&lt;<span class=\"built_in\">vector</span>&lt;<span class=\"type\">long</span> <span class=\"type\">long</span>&gt;&gt; maxgt(m,<span class=\"built_in\">vector</span>&lt;<span class=\"type\">long</span> <span class=\"type\">long</span>&gt;(n));</span><br><span class=\"line\">        <span class=\"built_in\">vector</span>&lt;<span class=\"built_in\">vector</span>&lt;<span class=\"type\">long</span> <span class=\"type\">long</span>&gt;&gt; minlt(m,<span class=\"built_in\">vector</span>&lt;<span class=\"type\">long</span> <span class=\"type\">long</span>&gt;(n));</span><br><span class=\"line\">        maxgt[<span class=\"number\">0</span>][<span class=\"number\">0</span>]=minlt[<span class=\"number\">0</span>][<span class=\"number\">0</span>]=grid[<span class=\"number\">0</span>][<span class=\"number\">0</span>];</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">1</span>;j&lt;n;j++)&#123; <span class=\"comment\">//å¤„ç†ç¬¬ä¸€è¡Œ</span></span><br><span class=\"line\">            maxgt[<span class=\"number\">0</span>][j]=minlt[<span class=\"number\">0</span>][j]=maxgt[<span class=\"number\">0</span>][j<span class=\"number\">-1</span>]*grid[<span class=\"number\">0</span>][j];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;m;i++)&#123; <span class=\"comment\">//å¤„ç†ç¬¬ä¸€åˆ—</span></span><br><span class=\"line\">            maxgt[i][<span class=\"number\">0</span>]=minlt[i][<span class=\"number\">0</span>]=maxgt[i<span class=\"number\">-1</span>][<span class=\"number\">0</span>]*grid[i][<span class=\"number\">0</span>];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;m;i++)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">1</span>;j&lt;n;j++)&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(grid[i][j]&gt;=<span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">                    maxgt[i][j]=max(maxgt[i<span class=\"number\">-1</span>][j],maxgt[i][j<span class=\"number\">-1</span>])*grid[i][j];</span><br><span class=\"line\">                    minlt[i][j]=min(minlt[i<span class=\"number\">-1</span>][j],minlt[i][j<span class=\"number\">-1</span>])*grid[i][j];</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">                    maxgt[i][j]=min(minlt[i<span class=\"number\">-1</span>][j],minlt[i][j<span class=\"number\">-1</span>])*grid[i][j];</span><br><span class=\"line\">                    minlt[i][j]=max(maxgt[i<span class=\"number\">-1</span>][j],maxgt[i][j<span class=\"number\">-1</span>])*grid[i][j];</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(maxgt[m<span class=\"number\">-1</span>][n<span class=\"number\">-1</span>]&lt;<span class=\"number\">0</span>) <span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> maxgt[m<span class=\"number\">-1</span>][n<span class=\"number\">-1</span>]%mod;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"æœ€å¤§å¾—åˆ†çš„è·¯å¾„æ•°ç›®\">æœ€å¤§å¾—åˆ†çš„è·¯å¾„æ•°ç›®</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\">using PII = <span class=\"built_in\">pair</span>&lt;<span class=\"type\">int</span>, <span class=\"type\">int</span>&gt;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">private:</span><br><span class=\"line\">    <span class=\"type\">static</span> <span class=\"type\">constexpr</span> <span class=\"type\">int</span> mod = (<span class=\"type\">int</span>)<span class=\"number\">1e9</span> + <span class=\"number\">7</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">void</span> <span class=\"title function_\">update</span><span class=\"params\">(<span class=\"built_in\">vector</span>&lt;<span class=\"built_in\">vector</span>&lt;PII&gt;&gt;&amp; dp, <span class=\"type\">int</span> n, <span class=\"type\">int</span> x, <span class=\"type\">int</span> y, <span class=\"type\">int</span> u, <span class=\"type\">int</span> v)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (u &gt;= n || v &gt;= n || dp[u][v].first == <span class=\"number\">-1</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (dp[u][v].first &gt; dp[x][y].first) &#123;</span><br><span class=\"line\">            dp[x][y] = dp[u][v];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (dp[u][v].first == dp[x][y].first) &#123;</span><br><span class=\"line\">            dp[x][y].second += dp[u][v].second;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (dp[x][y].second &gt;= mod) &#123;</span><br><span class=\"line\">                dp[x][y].second -= mod;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt; <span class=\"title function_\">pathsWithMaxScore</span><span class=\"params\">(<span class=\"built_in\">vector</span>&lt;<span class=\"built_in\">string</span>&gt;&amp; board)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> n = board.size();</span><br><span class=\"line\">        <span class=\"built_in\">vector</span>&lt;<span class=\"built_in\">vector</span>&lt;PII&gt;&gt; dp(n, <span class=\"built_in\">vector</span>&lt;PII&gt;(n, &#123;<span class=\"number\">-1</span>, <span class=\"number\">0</span>&#125;));</span><br><span class=\"line\">        dp[n - <span class=\"number\">1</span>][n - <span class=\"number\">1</span>] = &#123;<span class=\"number\">0</span>, <span class=\"number\">1</span>&#125;;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = n - <span class=\"number\">1</span>; i &gt;= <span class=\"number\">0</span>; i--) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = n - <span class=\"number\">1</span>; j &gt;= <span class=\"number\">0</span>; j--) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (!(i == n - <span class=\"number\">1</span> &amp;&amp; j == n - <span class=\"number\">1</span>) &amp;&amp; board[i][j] != <span class=\"string\">&#x27;X&#x27;</span>) &#123;</span><br><span class=\"line\">                    update(dp, n, i, j, i + <span class=\"number\">1</span>, j);</span><br><span class=\"line\">                    update(dp, n, i, j, i, j + <span class=\"number\">1</span>);</span><br><span class=\"line\">                    update(dp, n, i, j, i + <span class=\"number\">1</span>, j + <span class=\"number\">1</span>);</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (dp[i][j].first != <span class=\"number\">-1</span>) &#123;</span><br><span class=\"line\">                        dp[i][j].first += (board[i][j] == <span class=\"string\">&#x27;E&#x27;</span> ? <span class=\"number\">0</span> : board[i][j] - <span class=\"string\">&#x27;0&#x27;</span>);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> dp[<span class=\"number\">0</span>][<span class=\"number\">0</span>].first == <span class=\"number\">-1</span> ? <span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&#123;<span class=\"number\">0</span>, <span class=\"number\">0</span>&#125; : <span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&#123;dp[<span class=\"number\">0</span>][<span class=\"number\">0</span>].first, dp[<span class=\"number\">0</span>][<span class=\"number\">0</span>].second&#125;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"çŸ©é˜µä¸­å’Œèƒ½è¢«-K-æ•´é™¤çš„è·¯å¾„\">çŸ©é˜µä¸­å’Œèƒ½è¢« K æ•´é™¤çš„è·¯å¾„</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/*æŠŠè·¯å¾„å’Œæ¨¡ k çš„ç»“æœå½“æˆä¸€ä¸ªæ‰©å±•ç»´åº¦*/</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\">public:</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"title function_\">numberOfPaths</span><span class=\"params\">(<span class=\"built_in\">vector</span>&lt;<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;&gt; &amp;grid, <span class=\"type\">int</span> k)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">const</span> <span class=\"type\">int</span> mod = <span class=\"number\">1e9</span> + <span class=\"number\">7</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> m = grid.size(), n = grid[<span class=\"number\">0</span>].size(), f[m + <span class=\"number\">1</span>][n + <span class=\"number\">1</span>][k];</span><br><span class=\"line\">        <span class=\"built_in\">memset</span>(f, <span class=\"number\">0</span>, <span class=\"keyword\">sizeof</span>(f)); <span class=\"comment\">// f[i][j][v] è¡¨ç¤ºä»å·¦ä¸Šèµ°åˆ° (i,j)ï¼Œä¸”è·¯å¾„å’Œæ¨¡ k çš„ç»“æœä¸º v æ—¶çš„è·¯å¾„æ•°</span></span><br><span class=\"line\">        f[<span class=\"number\">0</span>][<span class=\"number\">1</span>][<span class=\"number\">0</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; m; ++i)</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">0</span>; j &lt; n; ++j)</span><br><span class=\"line\">                <span class=\"keyword\">for</span> (<span class=\"type\">int</span> v = <span class=\"number\">0</span>; v &lt; k; ++v)</span><br><span class=\"line\">                    f[i + <span class=\"number\">1</span>][j + <span class=\"number\">1</span>][(v + grid[i][j]) % k] = (f[i + <span class=\"number\">1</span>][j][v] + f[i][j + <span class=\"number\">1</span>][v]) % mod;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> f[m][n][<span class=\"number\">0</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"comment\">/*ä»£ç å®ç°æ—¶ï¼Œä¸ºäº†é¿å…åˆ¤æ–­æ˜¯å¦è¶Šç•Œï¼Œå¯ä»¥æŠŠä¸‹æ ‡éƒ½åŠ ä¸€ã€‚æ­¤æ—¶å¯ä»¥è®¾åˆå§‹å€¼ f[0][1][0]=1ï¼ˆæˆ–è€… f[1][0][0]=1ï¼‰ç®€åŒ–ä¸€ç‚¹ç‚¹ä»£ç ã€‚*/</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"åœ°ä¸‹åŸæ¸¸æˆ\">åœ°ä¸‹åŸæ¸¸æˆ</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h1>èƒŒåŒ…</h1>\n<h2 id=\"0-1-èƒŒåŒ…\">0-1 èƒŒåŒ…</h2>\n<blockquote>\n<p><em>æ¯ä¸ªç‰©å“åªèƒ½é€‰ä¸€æ¬¡</em></p>\n</blockquote>\n<h3 id=\"å’Œä¸ºç›®æ ‡å€¼çš„æœ€é•¿å­åºåˆ—çš„é•¿åº¦\">å’Œä¸ºç›®æ ‡å€¼çš„æœ€é•¿å­åºåˆ—çš„é•¿åº¦</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h2 id=\"å®Œå…¨èƒŒåŒ…\">å®Œå…¨èƒŒåŒ…</h2>\n<h2 id=\"å¤šé‡èƒŒåŒ…\">å¤šé‡èƒŒåŒ…</h2>\n<h2 id=\"åˆ†ç»„èƒŒåŒ…\">åˆ†ç»„èƒŒåŒ…</h2>\n<h1>ç»å…¸çº¿æ€§ DP</h1>\n<h2 id=\"æœ€é•¿å…¬å…±å­åºåˆ—ï¼ˆLCSï¼‰\">æœ€é•¿å…¬å…±å­åºåˆ—ï¼ˆLCSï¼‰</h2>\n<blockquote>\n<p><em>ä¸€èˆ¬å®šä¹‰f[i][j]è¡¨ç¤ºå¯¹(s[:i],t[:j])çš„æ±‚è§£ç»“æœã€‚</em></p>\n</blockquote>\n<h3 id=\"æœ€é•¿å…¬å…±å­åºåˆ—\">æœ€é•¿å…¬å…±å­åºåˆ—</h3>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">longestCommonSubsequence</span><span class=\"params\">(string text1, string text2)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> m=text<span class=\"number\">1.</span><span class=\"built_in\">size</span>(),n=text<span class=\"number\">2.</span><span class=\"built_in\">size</span>();</span><br><span class=\"line\">        vector&lt;vector&lt;<span class=\"type\">int</span>&gt;&gt; <span class=\"built_in\">dp</span>(m<span class=\"number\">+1</span>,<span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;(n<span class=\"number\">+1</span>)); </span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=m;i++)&#123;</span><br><span class=\"line\">            <span class=\"type\">char</span> c1=text1[i<span class=\"number\">-1</span>];</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">1</span>;j&lt;=n;j++)&#123;</span><br><span class=\"line\">                <span class=\"type\">char</span> c2=text2[j<span class=\"number\">-1</span>];</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(c1==c2)&#123;</span><br><span class=\"line\">                    dp[i][j]=dp[i<span class=\"number\">-1</span>][j<span class=\"number\">-1</span>]<span class=\"number\">+1</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">                    dp[i][j]=<span class=\"built_in\">max</span>(dp[i<span class=\"number\">-1</span>][j],dp[i][j<span class=\"number\">-1</span>]);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> dp[m][n];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"ä¸¤ä¸ªå­—ç¬¦ä¸²çš„åˆ é™¤æ“ä½œ\">ä¸¤ä¸ªå­—ç¬¦ä¸²çš„åˆ é™¤æ“ä½œ</h3>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">minDistance</span><span class=\"params\">(string word1, string word2)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> m = word<span class=\"number\">1.</span><span class=\"built_in\">size</span>();</span><br><span class=\"line\">        <span class=\"type\">int</span> n = word<span class=\"number\">2.</span><span class=\"built_in\">size</span>();</span><br><span class=\"line\">        vector&lt;vector&lt;<span class=\"type\">int</span>&gt;&gt; <span class=\"built_in\">dp</span>(m + <span class=\"number\">1</span>, <span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;(n + <span class=\"number\">1</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= m; i++) &#123;</span><br><span class=\"line\">            <span class=\"type\">char</span> c1 = word1[i - <span class=\"number\">1</span>];</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">1</span>; j &lt;= n; j++) &#123;</span><br><span class=\"line\">                <span class=\"type\">char</span> c2 = word2[j - <span class=\"number\">1</span>];</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (c1 == c2) &#123;</span><br><span class=\"line\">                    dp[i][j] = dp[i - <span class=\"number\">1</span>][j - <span class=\"number\">1</span>] + <span class=\"number\">1</span>;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    dp[i][j] = <span class=\"built_in\">max</span>(dp[i - <span class=\"number\">1</span>][j], dp[i][j - <span class=\"number\">1</span>]);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">int</span> lcs = dp[m][n];</span><br><span class=\"line\">        <span class=\"keyword\">return</span> m - lcs + n - lcs;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"ä¸¤ä¸ªå­—ç¬¦ä¸²çš„æœ€å°ASCIIåˆ é™¤å’Œ\">ä¸¤ä¸ªå­—ç¬¦ä¸²çš„æœ€å°ASCIIåˆ é™¤å’Œ</h3>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">minimumDeleteSum</span><span class=\"params\">(string s1, string s2)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> m = s<span class=\"number\">1.</span><span class=\"built_in\">size</span>();</span><br><span class=\"line\">        <span class=\"type\">int</span> n = s<span class=\"number\">2.</span><span class=\"built_in\">size</span>();</span><br><span class=\"line\">        vector&lt;vector&lt;<span class=\"type\">int</span>&gt;&gt; <span class=\"built_in\">dp</span>(m + <span class=\"number\">1</span>, <span class=\"built_in\">vector</span>&lt;<span class=\"type\">int</span>&gt;(n + <span class=\"number\">1</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= m; ++i) &#123;</span><br><span class=\"line\">            dp[i][<span class=\"number\">0</span>] = dp[i - <span class=\"number\">1</span>][<span class=\"number\">0</span>] + s1[i - <span class=\"number\">1</span>];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">1</span>; j &lt;= n; ++j) &#123;</span><br><span class=\"line\">            dp[<span class=\"number\">0</span>][j] = dp[<span class=\"number\">0</span>][j - <span class=\"number\">1</span>] + s2[j - <span class=\"number\">1</span>];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= m; i++) &#123;</span><br><span class=\"line\">            <span class=\"type\">char</span> c1 = s1[i - <span class=\"number\">1</span>];</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">1</span>; j &lt;= n; j++) &#123;</span><br><span class=\"line\">                <span class=\"type\">char</span> c2 = s2[j - <span class=\"number\">1</span>];</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (c1 == c2) &#123;</span><br><span class=\"line\">                    dp[i][j] = dp[i - <span class=\"number\">1</span>][j - <span class=\"number\">1</span>];</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    dp[i][j] = <span class=\"built_in\">min</span>(dp[i - <span class=\"number\">1</span>][j] + s1[i - <span class=\"number\">1</span>], dp[i][j - <span class=\"number\">1</span>] + s2[j - <span class=\"number\">1</span>]);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> dp[m][n];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"ç¼–è¾‘è·ç¦»\">ç¼–è¾‘è·ç¦»</h3>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h2 id=\"æœ€é•¿é€’å¢å­åºåˆ—ï¼ˆLISï¼‰\">æœ€é•¿é€’å¢å­åºåˆ—ï¼ˆLISï¼‰</h2>\n","tags":["ç¼–ç¨‹","åŠ¨æ€è§„åˆ’"]},{"title":"å›½å®¶æµ·æ´‹åšç‰©é¦†","url":"/post/1a5d7ab5.html","content":""},{"title":"å›¾è®ºç®—æ³•åšé¢˜æ€»ç»“","url":"/post/ebf888f5.html","content":""},{"title":"åŸºäºVirtualBoxè™šæ‹Ÿæœºå®‰è£…Ubuntuæ•™ç¨‹","url":"/post/4381ab4e.html","content":"<h2 id=\"ä¸€-ä¸‹è½½å®‰è£…VirtualBox\">ä¸€. ä¸‹è½½å®‰è£…VirtualBox</h2>\n<ol>\n<li>\n<p><a href=\"https://www.virtualbox.org/wiki/Downloads\">å®˜ç½‘ä¸‹è½½VirtualBoxå®‰è£…ç¨‹åº</a>ï¼Œæˆ‘çš„ç‰ˆæœ¬ï¼ˆreleased July 28 2021ï¼‰ï¼šVirtualBox 6.1.26 for Windows hosts x86/amd64</p>\n</li>\n<li>\n<p>ä¸‹è½½å¥½äº†å®‰è£…VirtualBoxï¼Œä¸€è·¯<code>Next</code>å°±å¯ä»¥äº†,è¿™ä¸ªæ¯”è¾ƒç®€å•ã€‚</p>\n</li>\n<li>\n<p>è¿è¡ŒVirtulBoxç¨‹åº, å¦‚ä¸‹å›¾ï¼š</p>\n</li>\n</ol>\n<center>\n<img src=\"https://s2.loli.net/2024/12/06/wV8GSWjOA7szHuf.png\" width=\"80%\" />\n</center>\n<ol start=\"4\">\n<li>é…ç½®VirtualBoxã€‚æŒ‰ <code>CTRL+G</code>æ‰“å¼€å…¨å±€è®¾å®šï¼Œæ ¹æ®éœ€è¦å¯ä»¥è®¾å®šè™šæ‹Ÿè„‘ä½ç½®å’Œç•Œé¢è¯­è¨€ï¼š<br>\n<br>\nä¿®æ”¹<code>é»˜è®¤è™šæ‹Ÿè„‘ä½ç½®</code>æ¯”å¦‚<code>D:\\VirtualBox VMs</code>å¯ä»¥è®©è‡ªå·±æ›´æ–¹ä¾¿çš„æŸ¥æ‰¾ï¼Œå¤‡ä»½å®‰è£…å¥½çš„è™šæ‹Ÿæœºã€‚</li>\n</ol>\n<center>\n<img src=\"https://s2.loli.net/2024/12/06/c6gMmE9kOTUKePa.png\" width=\"80%\" />\n</center>\n<p>â€ƒâ€ƒâ€ƒå¦‚æœç•Œé¢æ˜¯è‹±æ–‡ï¼Œå¯ä»¥æ”¹æˆä¸­æ–‡ï¼š</p>\n<center>\n<img src=\"https://s2.loli.net/2024/12/06/Ui6OyNV37F9pfZ8.png\" width=\"80%\" />\n</center>\n<ol start=\"5\">\n<li>å®‰è£…VirtualBox Extension Packï¼ˆæ–°æ‰‹å¯ä»¥ä¸åšï¼‰<br>\n<br>\n<a href=\"https://download.virtualbox.org/virtualbox/6.1.4/Oracle_VM_VirtualBox_Extension_Pack-6.1.4.vbox-extpack\">ä¸‹è½½</a>, åŒå‡»å®‰è£…ï¼Œæ”¯æŒUSB 2.0 å’ŒUSB 3.0 è®¾å¤‡, VirtualBox RDP, ç£ç›˜åŠ å¯†ï¼Œè™šæ‹Ÿæœºå¿«ç…§ç­‰åŠŸèƒ½ã€‚</li>\n</ol>\n<h2 id=\"äºŒã€å®‰è£…Ubuntu\">äºŒã€å®‰è£…Ubuntu</h2>\n<h3 id=\"åˆ›å»ºè™šæ‹Ÿæœº\">åˆ›å»ºè™šæ‹Ÿæœº</h3>\n<ol>\n<li>è¿è¡ŒVirtulBoxç¨‹åºï¼Œç‚¹å‡»â€œæ–°å»ºâ€æŒ‰é’®ï¼Œæ–°å»ºä¸€ä¸ªè™šæ‹Ÿæœºã€‚</li>\n</ol>\n<center>\n<img src=\"https://s2.loli.net/2024/12/06/BUaJM38DxXOEISC.png\" width=\"80%\" />\n</center>\n<ol start=\"2\">\n<li>è™šæ‹Ÿæœºåç§°å¯ä»¥éšæ„è¾“å…¥ï¼Œç¤ºä¾‹ï¼š<code>zhy</code>ã€‚æ“ä½œç³»ç»Ÿé€‰æ‹©Linuxï¼Œç‰ˆæœ¬é€‰æ‹©ubuntu(64-bit)ã€‚ç‚¹å‡»â€œä¸‹ä¸€æ­¥â€ã€‚</li>\n</ol>\n<center>\n<img src=\"https://s2.loli.net/2024/12/06/Ov6DCRIuglzAwrP.png\" width=\"80%\" />\n</center>\n<ol start=\"3\">\n<li>è®¾å®šè™šæ‹Ÿæœºçš„å†…å­˜ï¼Œæ­¤å†…å­˜å³ä¸ºè™šæ‹Ÿæœºæ‰€å ç”¨çš„ç³»ç»Ÿå†…å­˜ï¼Œå¯éšæ„ä¿®æ”¹ï¼Œå»ºè®®ä¸è¦è¶…è¿‡ç³»ç»Ÿå†…å­˜çš„1/2ã€‚<br>\né¦–å…ˆäº†è§£è‡ªå·±çš„ç¬”è®°æœ¬ç”µè„‘ç³»ç»Ÿå†…å­˜å¤§å°ï¼Œâ€œæˆ‘çš„ç”µè„‘â€-&gt;â€œå±æ€§â€ã€‚æ ·æœºä¸º16Gã€‚<br>\nä¸ºäº†æ–¹ä¾¿ä»¥åç¼–ç¨‹å­¦ä¹ ä½¿ç”¨ï¼Œè¿™é‡Œå°†è™šæ‹Ÿå†…å­˜è®¾ä¸º4Gã€‚ç‚¹å‡»â€œä¸‹ä¸€æ­¥â€ã€‚</li>\n</ol>\n<center>\n<img src=\"https://s2.loli.net/2024/12/06/PI3uBHkc1NQ4DhJ.png\" width=\"80%\" />\n</center>\n<ol start=\"4\">\n<li>ä¸ºè™šæ‹Ÿæœºåˆ›å»ºä¸€å—è™šæ‹Ÿç¡¬ç›˜ã€‚é€‰æ‹©â€œç°åœ¨åˆ›å»ºè™šæ‹Ÿç¡¬ç›˜â€ï¼Œå¹¶å•å‡»â€œåˆ›å»ºâ€ã€‚</li>\n</ol>\n<center>\n<img src=\"https://s2.loli.net/2024/12/06/uxgviweoWYF7AmR.png\" width=\"80%\" />\n</center>\n   å¦‚æœä½ å®‰è£…æœ‰é—®é¢˜ï¼Œå¯ä»¥åœ¨`é»˜è®¤è™šæ‹Ÿè„‘ä½ç½®`æ¯”å¦‚`D:\\VirtualBox VMs`å¤„æ‹·è´åˆ«äººå®‰è£…å¥½çš„XXX.vdiæ–‡ä»¶ï¼Œåœ¨æ­¤é€‰æ‹©â€œä½¿ç”¨å·²æœ‰çš„è™šæ‹Ÿç¡¬ç›˜æ–‡ä»¶â€ï¼Œç„¶åé€‰ä¸­æ‹·è´è¿‡æ¥çš„vdiæ–‡ä»¶å°±å¯ä»¥äº†ï¼Œä¸‹é¢çš„å®‰è£…å°±ä¸ç”¨åšäº†ã€‚\n<p><strong>åœ¨æ­¤å¼ºçƒˆå»ºè®®æŠŠæ•™ç¨‹èµ°å®Œï¼Œå‡ºé”™äº†ä¹Ÿä¼šæœ‰ä¸ä¸€æ ·çš„æ”¶è·</strong></p>\n<ol start=\"5\">\n<li>é€‰æ‹©è™šæ‹Ÿç¡¬ç›˜æ–‡ä»¶ç±»å‹ã€‚é€‰æ‹©é»˜è®¤çš„VDIï¼ˆVirtualBoxç£ç›˜æ˜ åƒï¼‰ï¼Œå¹¶å•å‡»â€œä¸‹ä¸€æ­¥â€ã€‚</li>\n</ol>\n<center>\n<img src=\"https://s2.loli.net/2024/12/06/aXFf74RUsb5B1DW.png\" width=\"80%\" />\n</center>\n<ol start=\"6\">\n<li>é€‰æ‹©â€œåŠ¨æ€æ‰©å±•â€ï¼Œå¹¶å•å‡»â€œä¸‹ä¸€æ­¥â€ã€‚<br>\nå› ä¸ºåˆ†é…ç»™è™šæ‹Ÿæœºçš„å†…å­˜ç©ºé—´è¾ƒå¤§ï¼Œä½¿ç”¨æ—¶é€æ¸å ç”¨ç£ç›˜ç©ºé—´ï¼Œé—²ç½®æ—¶è‡ªåŠ¨ç¼©å‡æ¯”è¾ƒåˆç†ï¼Œæ‰€ä»¥é€‰æ‹©åŠ¨æ€æ‰©å±•ç±»å‹ã€‚</li>\n</ol>\n<center>\n<img src=\"https://s2.loli.net/2024/12/06/6Todt8VHPwBabZX.png\" width=\"80%\" />\n</center>\n<ol start=\"7\">\n<li>è¾“å…¥è™šæ‹Ÿç¡¬ç›˜æ–‡ä»¶çš„åç§°ï¼Œå¹¶é€‰æ‹©ä¿å­˜ä½ç½®ã€‚<br>\né€‰æ‹©è™šæ‹Ÿç¡¬ç›˜å¤§å°æ—¶ä¸€å®šå…ˆç¡®å®šä¿å­˜æ‰€åœ¨ä½ç½®ç£ç›˜çš„å¯ç”¨å¤§å°ã€‚å¯ç”¨ç©ºé—´ä¸º500Gï¼Œè™šæ‹Ÿç¡¬ç›˜å¤§å°è®¾ç½®ä¸º10Gã€‚å•å‡»â€œåˆ›å»ºâ€ã€‚</li>\n</ol>\n<center>\n<img src=\"https://s2.loli.net/2024/12/06/Y1TEbI2jc4Fkis9.png\" width=\"80%\" />\n</center>\n<ol start=\"8\">\n<li>è™šæ‹Ÿæœºåˆ›å»ºå®Œæˆã€‚ä¹Ÿå°±æ˜¯è¯´Ubuntuæ‰€éœ€çš„ç¡¬ä»¶èµ„æºå‡†å¤‡å¥½äº†ï¼Œç›¸å½“äºä¹°äº†ä¸€ä¸ªæ²¡æœ‰å®‰è£…æ“ä½œç³»ç»Ÿçš„ç”µè„‘ä¸»æœºã€‚</li>\n</ol>\n<center>\n<img src=\"https://s2.loli.net/2024/12/06/6mFDeJh9cHsoCbQ.png\" width=\"80%\" />\n</center>\n<h3 id=\"å®‰è£…Ubuntu-ç³»ç»Ÿè½¯ä»¶\">å®‰è£…Ubuntu ç³»ç»Ÿè½¯ä»¶</h3>\n<p>â€ƒåœ¨è™šæ‹Ÿæœºä¸Šå®‰è£…Ubuntuå’Œåœ¨çœŸå®æœºå™¨ä¸Šå®‰è£…æ²¡æœ‰å¤§çš„å·®åˆ«ã€‚</p>\n<p>â€ƒ<strong>å®˜ç½‘ä¸‹è½½ï¼ˆä¸æ¨èï¼‰</strong><br>\nâ€ƒå¯ä»¥ç›´æ¥è®¿é—®<a href=\"https://cn.ubuntu.com/\">Ubuntuå®˜ç½‘</a>è¿›è¡Œä¸‹è½½ï¼Œä½†ç”±äºæœåŠ¡å™¨åœ¨å›½å¤–ï¼Œä¸‹è½½é€Ÿåº¦ä¼šéå¸¸éå¸¸æ…¢ï¼Œæ¨èä½¿ç”¨å›½å†…çš„ä¸€äº›é•œåƒç«™ä¸‹è½½ã€‚<br>\nâ€ƒ<strong>é•œåƒä¸‹è½½</strong><br>\nâ€ƒä¸ªäººæ¨è<a href=\"https://mirrors.tuna.tsinghua.edu.cn/\">æ¸…åå¤§å­¦å¼€æºè½¯ä»¶é•œåƒç«™</a>ã€‚</p>\n<ol>\n<li>è¿›å…¥ä¹‹åæœç´¢Ubuntuï¼Œé€‰æ‹©â€œubuntu-releasesâ€ã€‚</li>\n</ol>\n<center>\n<img src=\"https://s2.loli.net/2024/12/07/8DxnGiw1QrjhVR9.png\" width=\"80%\" />\n</center>\n<ol start=\"2\">\n<li>æ ¹æ®ä¸ªäººä½“éªŒï¼Œå¼ºçƒˆæ¨èé€‰æ‹©20.04ç‰ˆæœ¬ï¼ˆæˆªè‡³å‘æ–‡æ—¶é—´ï¼‰ã€‚</li>\n</ol>\n<center>\n<img src=\"https://s2.loli.net/2024/12/07/EmOAqMUvDk6JH2N.png\" width=\"80%\" />\n</center>\n<ol start=\"3\">\n<li>é€‰æ‹©â€œubuntu-20.04.6-desktop-amd64.isoâ€è¿›è¡Œä¸‹è½½</li>\n</ol>\n<center>\n<img src=\"https://s2.loli.net/2024/12/07/YkesCc46KwqvIub.png\" width=\"80%\" />\n</center>\n<ol start=\"4\">\n<li>åŒå‡»å¯åŠ¨åˆ›å»ºå¥½çš„è™šæ‹Ÿæœº</li>\n</ol>\n<center>\n<img src=\"https://s2.loli.net/2024/12/07/DJfizcujNO7oSRe.png\" width=\"80%\" />\n</center>\nå¼¹å‡ºä¸‹å›¾å¯¹è¯æ¡†ï¼Œé€‰æ‹©å¯åŠ¨ç›˜ã€‚å•å‡»å³ä¾§æ–‡ä»¶å¤¹å°å›¾æ ‡ã€‚\n<center>\n<img src=\"https://s2.loli.net/2024/12/07/QpPLAmoDwtslZEN.png\" width=\"80%\" />\n</center>\n<p>é€‰æ‹©è™šæ‹Ÿå…‰ç›˜æ–‡ä»¶ubuntu-20.04.6.-desktop-amd64.isoï¼Œå•å‡»â€œå¯åŠ¨â€ã€‚</p>\n<center>\n<img src=\"https://s2.loli.net/2024/12/07/Co1ONqVjIac7DnK.png\" width=\"80%\" />\n</center>\n<ol start=\"5\">\n<li>è¿›å…¥å®‰è£…ç•Œé¢ã€‚ é€‰æ‹©â€œä¸­æ–‡ç®€ä½“â€ï¼Œé€‰æ‹©â€œå®‰è£…Ubuntuâ€</li>\n</ol>\n<center>\n<img src=\"https://s2.loli.net/2024/12/07/fN83Bec7irMAdWo.png\" width=\"80%\" />\n</center>\n<ol start=\"6\">\n<li>é€‰æ‹©â€œç»§ç»­â€ã€‚ ç½‘ç»œçŠ¶å†µä¸å¥½å¯ä»¥ä¸é€‰æ‹©â€œå®‰è£…Ubuntuæ—¶ä¸‹è½½æ›´æ–°â€</li>\n</ol>\n<center>\n<img src=\"https://s2.loli.net/2024/12/07/QcKatrVeqIpmw7J.png\" width=\"80%\" />\n</center>\n<ol start=\"7\">\n<li>é€‰æ‹©â€œæ¸…é™¤æ•´ä¸ªç£ç›˜å¹¶å®‰è£…Ubuntuâ€å•å‡»â€œç°åœ¨å®‰è£…â€<br>\n<br>\nå¼¹å‡ºè­¦å‘Šæ¡†ï¼Œé€‰æ‹©â€œç»§ç»­â€ã€‚</li>\n</ol>\n<center>\n<img src=\"https://s2.loli.net/2024/12/07/doFsbU7IuhjYy9L.png\" width=\"80%\" />\n</center>\n<ol start=\"8\">\n<li>å®‰è£…è¿‡ç¨‹ä¸­æ—¶åŒºï¼Œç”¨é¼ æ ‡å•å‡»åœ°å›¾ä¸­çš„â€œä¸­å›½â€ï¼Œå°±ä¼šé€‰æ‹©â€œä¸Šæµ·â€ï¼Œå•å‡»â€œç»§ç»­â€ï¼Œè¯­è¨€é€‰â€œæ±‰è¯­â€ã€‚</li>\n</ol>\n<center>\n<img src=\"https://s2.loli.net/2024/12/07/vF5qPY2yWjN8dOp.png\" width=\"80%\" />\n</center>\n<center>\n<img src=\"https://s2.loli.net/2024/12/07/vw3OeZxm2Mt1HRS.png\" width=\"80%\" />\n</center>\n<ol start=\"9\">\n<li>è¾“å…¥ä¸ªäººä¿¡æ¯ï¼šç”¨æˆ·åï¼Œå£ä»¤ç­‰ã€‚å•å‡»â€œç»§ç»­â€ï¼Œå®‰è£…è¿‡ç¨‹å¯èƒ½éœ€è¦å‡ ååˆ†é’Ÿï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚</li>\n</ol>\n<center>\n<img src=\"https://s2.loli.net/2024/12/07/C4OJgIzNfKsvy2d.png\" width=\"80%\" />\n</center>\n<center>\n<img src=\"https://s2.loli.net/2024/12/07/LviOMRdTNaprWj9.png\" width=\"80%\" />\n</center>\n<ol start=\"10\">\n<li>å®‰è£…å®Œæ¯•ï¼Œé‡å¯ä¸€ä¸‹Ubuntuã€‚</li>\n</ol>\n<center>\n<img src=\"https://s2.loli.net/2024/12/07/X4JRekfNnozGrHQ.png\" width=\"80%\" />\n</center>\n<h2 id=\"å®‰è£…VirtualBoxè™šæ‹Ÿæœºå¢å¼ºåŠŸèƒ½\">å®‰è£…VirtualBoxè™šæ‹Ÿæœºå¢å¼ºåŠŸèƒ½</h2>\n<p>æ³¨æ„ï¼šä»¥ä¸‹éœ€è¦è¾“å…¥å‘½ä»¤ä»£ç æ—¶è¯·æ³¨æ„ä¹‹é—´çš„ç©ºæ ¼ï¼ä»¥åŠæ–‡ä»¶åç›¸äº’å¯¹åº”ï¼</p>\n<ol>\n<li>è¿›å…¥è™šæ‹ŸæœºUbuntuç³»ç»Ÿï¼Œå®‰è£…VirtualBoxå¢å¼ºåŠŸèƒ½ï¼Œè¿™å¯ä»¥æå¤§çš„æé«˜è™šæ‹Ÿæœºæ•ˆç‡ã€‚é¦–å…ˆç‚¹å‡»VBoxèœå•æ çš„â€œè®¾å¤‡â€é¡¹ï¼Œé€‰æ‹©æœ€ä¸‹é¢çš„â€œå®‰è£…å¢å¼ºåŠŸèƒ½â€ã€‚</li>\n</ol>\n<center>\n<img src=\"https://s2.loli.net/2024/12/07/X4JRekfNnozGrHQ.png\" width=\"80%\" />\n</center>\n<ol start=\"3\">\n<li>\n<p>è¿™æ—¶å¯ä»¥çœ‹åˆ°æ¡Œé¢å¤šå‡ºä¸€ä¸ªå…‰ç›˜å›¾æ ‡ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™é‡è¯•æœ¬æ­¥ã€‚</p>\n</li>\n<li>\n<p>æŒ‰<code>CTRL+ALT+T</code>æ‰“å¼€â€œç»ˆç«¯â€ã€‚è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼ˆ<strong>æ³¨æ„ç©ºæ ¼ï¼æ³¨æ„è·¯å¾„ã€æ–‡ä»¶åç›¸äº’å¯¹åº”ã€‚</strong>ï¼‰</p>\n</li>\n</ol>\n<p>è¾“å…¥å‘½ä»¤æ—¶è¦æ ¹æ®è‡ªå·±çš„æƒ…å†µä¿®æ”¹ï¼Œæ–‡ä»¶åç”¨<code>Tab</code>è¡¥å…¨ï¼Œå‡å°‘å½•å…¥é”™è¯¯ã€‚</p>\n<center>\n<img src=\"https://s2.loli.net/2024/12/07/X4JRekfNnozGrHQ.png\" width=\"80%\" />\n</center>\n<p>ç­‰å¾…å‡ åˆ†é’Ÿå°±å®‰è£…å¥½äº†ï¼</p>\n<h3 id=\"åˆ†é…å…±äº«æ•°æ®ç©ºé—´-æ˜“å‡ºé”™ï¼Œæ–°æ‰‹å¯ä»¥ä¸åš\">åˆ†é…å…±äº«æ•°æ®ç©ºé—´(æ˜“å‡ºé”™ï¼Œæ–°æ‰‹å¯ä»¥ä¸åš)</h3>\n<p>ä¸ºäº†æ–¹ä¾¿è™šæ‹Ÿæœºå’Œå®¿ä¸»æœºä¹‹é—´çš„æ•°æ®ä¼ è¾“ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºè™šæ‹Ÿæœºè®¾ç½®ä¸€ä¸ªå’Œä¸»æœºå…±äº«çš„â€œæ•°æ®ç©ºé—´â€ã€‚VBoxä¸ºæˆ‘ä»¬æä¾›äº†è¿™ä¸ªåŠŸèƒ½ã€‚</p>\n<ol>\n<li>åœ¨VBoxä¸»ç•Œé¢å·¦ä¾§é€‰æ‹©åˆšåˆšåˆ›å»ºå¥½çš„è™šæ‹Ÿæœºï¼Œç‚¹å‡»ä¸Šæ–¹çš„â€œè®¾ç½®â€æŒ‰é’®ï¼Œè¿›å…¥è™šæ‹Ÿæœºé…ç½®ç•Œé¢ã€‚ç‚¹å‡»å·¦ä¾§â€œå…±äº«æ–‡ä»¶å¤¹â€æŒ‰é’®ï¼Œåœ¨æ–°çª—å£ä¸­ä»»æ„é€‰æ‹©ä¸€ä¸ªæœ¬åœ°æ–‡ä»¶å¤¹ä½œä¸ºå…±äº«æ–‡ä»¶å¤¹ã€‚ç¤ºä¾‹é€‰æ‹©æ–‡ä»¶å¤¹ä½ç½®ä¸ºC:\\rocshareï¼Œä¸è¦å‹¾é€‰â€œåªè¯»åˆ†é…â€ã€‚å•å‡»â€œç¡®å®šâ€ï¼Œå¹¶å…³é—­è®¾ç½®çª—å£ã€‚</li>\n</ol>\n<p><img src=\"./%E5%9F%BA%E4%BA%8EVirtualBox%E5%AE%89%E8%A3%85(Ubuntu,openEuler)%E5%9B%BE%E6%96%87%E6%95%99%E7%A8%8B%20-%20%E5%A8%84%E8%80%81%E5%B8%88%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/741560-20161030093638484-754721120.png\" alt=\"\"></p>\n<p><img src=\"./%E5%9F%BA%E4%BA%8EVirtualBox%E5%AE%89%E8%A3%85(Ubuntu,openEuler)%E5%9B%BE%E6%96%87%E6%95%99%E7%A8%8B%20-%20%E5%A8%84%E8%80%81%E5%B8%88%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/741560-20161030094135281-471357754.png\" alt=\"\"></p>\n<p><img src=\"./%E5%9F%BA%E4%BA%8EVirtualBox%E5%AE%89%E8%A3%85(Ubuntu,openEuler)%E5%9B%BE%E6%96%87%E6%95%99%E7%A8%8B%20-%20%E5%A8%84%E8%80%81%E5%B8%88%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/741560-20161030093648984-2094658791.png\" alt=\"\"></p>\n<ol start=\"2\">\n<li>å¯åŠ¨Ubuntuï¼Œæ‰“å¼€ç»ˆç«¯çª—å£ã€‚ï¼ˆæ³¨æ„ç©ºæ ¼ï¼ï¼‰<br>\nä¸€ä¸ªè¦ç‚¹æ˜¯ï¼šå‘½ä»¤ï¼Œæ–‡ä»¶åè¦é€šè¿‡<code>Tab</code>è¡¥å…¨ï¼Œè¿™æ ·å°±ä¼šå‡å°‘å½•å…¥é”™è¯¯ã€‚</li>\n</ol>\n<ul>\n<li>è¾“å…¥å‘½ä»¤â€œsudo mkdir /mnt/sharedâ€ã€‚å›è½¦åé”®å…¥å¯†ç ã€‚</li>\n<li>ç»§ç»­è¾“å…¥å‘½ä»¤â€œsudo mount â€“t vboxsf rocshare /mnt/shared&quot; //æ³¨æ„rocshare /mnt/shared è¦è·Ÿæ®è‡ªå·±çš„æƒ…å†µä¿®æ”¹</li>\n<li>è¾“å…¥å‘½ä»¤â€œsudo gedit /etc/fstabâ€</li>\n</ul>\n<ol start=\"3\">\n<li>åœ¨å¼¹å‡ºçš„æ–‡æœ¬æœ«å°¾æ·»åŠ ä¸€è¡Œä¸‹é¢çš„å†…å®¹ï¼š</li>\n</ol>\n<ul>\n<li>â€œrocshare /mnt/shared vboxsf rw,gid=100,uid=1000,auto 0 0â€</li>\n</ul>\n<ol start=\"4\">\n<li>ç°åœ¨æ‰“å¼€/mnt/sharedæ–‡ä»¶å¤¹ï¼Œå°±å¯ä»¥çœ‹åˆ°ä¸»æœºå¯¹åº”å…±äº«æ–‡ä»¶å¤¹rocshareä¸­çš„å†…å®¹äº†ã€‚è¿™å°±æ˜¯å®¿ä¸»æœºå’Œè™šæ‹Ÿæœºä¹‹é—´çš„æ¡¥æ¢ã€‚</li>\n</ol>\n<p>æ¯”å¦‚æˆ‘ä»¬åœ¨Ubuntuä¸­ç”¨touchå‘½ä»¤æ–°å»ºä¸€ä¸ªtesttestçš„æ–‡ä»¶ï¼Œåˆ°å®¿ä¸»æœºçš„c://rocshareä¸­å°±èƒ½çœ‹åˆ°è¿™ä¸ªæ–‡ä»¶ã€‚</p>\n<p><img src=\"./%E5%9F%BA%E4%BA%8EVirtualBox%E5%AE%89%E8%A3%85(Ubuntu,openEuler)%E5%9B%BE%E6%96%87%E6%95%99%E7%A8%8B%20-%20%E5%A8%84%E8%80%81%E5%B8%88%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/741560-20161030095516359-1565360436.png\" alt=\"\"></p>\n<p><img src=\"./%E5%9F%BA%E4%BA%8EVirtualBox%E5%AE%89%E8%A3%85(Ubuntu,openEuler)%E5%9B%BE%E6%96%87%E6%95%99%E7%A8%8B%20-%20%E5%A8%84%E8%80%81%E5%B8%88%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/741560-20161030095524640-2011954975.png\" alt=\"\"></p>\n<ol start=\"5\">\n<li>è‡³æ­¤ï¼Œè™šæ‹Ÿæœºå®‰è£…é…ç½®å®Œæˆã€‚</li>\n</ol>\n<h2 id=\"é…ç½®Ubuntu\">é…ç½®Ubuntu</h2>\n<p>Ubuntuçš„ä½¿ç”¨å¯ä»¥å‚è€ƒ<a href=\"http://www.cnblogs.com/rocedu/p/4902411.html\">åˆ«å‡ºå¿ƒè£çš„Linuxå‘½ä»¤å­¦ä¹ æ³•</a>.</p>\n<ol>\n<li>é€šè¿‡<code>sudo apt-get update;sudo apt-get upgrade</code> æ›´æ–°ä¸€ä¸‹ç³»ç»Ÿã€‚</li>\n</ol>\n<p><img src=\"./%E5%9F%BA%E4%BA%8EVirtualBox%E5%AE%89%E8%A3%85(Ubuntu,openEuler)%E5%9B%BE%E6%96%87%E6%95%99%E7%A8%8B%20-%20%E5%A8%84%E8%80%81%E5%B8%88%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/741560-20161030110713000-318570997.png\" alt=\"\"></p>\n<ol start=\"2\">\n<li>å®‰è£…è½¯ä»¶ã€‚Ubuntuä¸­å®‰è£…è½¯ä»¶æ¯”è¾ƒç®€å•ï¼Œä½¿ç”¨<code>sudo apt-get install XXX</code>å°±å¯ä»¥å®‰è£…XXXè½¯ä»¶ï¼Œæ¯”å¦‚æˆ‘ä»¬å¸¸ç”¨çš„Vim,å°±å¯ä»¥ç”¨<code>sudo apt-get install Vim</code>æ¥å®‰è£…ã€‚</li>\n</ol>\n<p><img src=\"./%E5%9F%BA%E4%BA%8EVirtualBox%E5%AE%89%E8%A3%85(Ubuntu,openEuler)%E5%9B%BE%E6%96%87%E6%95%99%E7%A8%8B%20-%20%E5%A8%84%E8%80%81%E5%B8%88%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/741560-20161030110919031-429532360.png\" alt=\"install vim\"></p>\n<p>æ³¨æ„ï¼šUbuntuä¸­ä½¿ç”¨åˆ°æŸä¸ªæ²¡æœ‰å®‰è£…çš„è½¯ä»¶æ—¶ï¼Œä¼šæœ‰è´´å¿ƒçš„æç¤ºï¼Œå¦‚ä¸Šå›¾ã€‚</p>\n<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>apt-cache search XXXX</code>æ¥æŸ¥æ‰¾è½¯ä»¶åº“ä¸­æœ‰æ²¡æœ‰æˆ‘ä»¬æƒ³è¦å®‰è£…çš„è½¯ä»¶ã€‚æ¯”å¦‚æˆ‘ä»¬æƒ³çœ‹çœ‹æœ‰æ²¡æœ‰å¸¸ç”¨çš„è°ƒè¯•å·¥å…·cgdb,å°±å¯ä»¥ä½¿ç”¨<code>apt-cache search cgdb</code>æ¥æŸ¥æ‰¾ï¼š</p>\n<p><img src=\"./%E5%9F%BA%E4%BA%8EVirtualBox%E5%AE%89%E8%A3%85(Ubuntu,openEuler)%E5%9B%BE%E6%96%87%E6%95%99%E7%A8%8B%20-%20%E5%A8%84%E8%80%81%E5%B8%88%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/741560-20161030112106046-695358617.png\" alt=\"\"></p>\n<p>æ‰¾åˆ°åå°±å¯ä»¥é€šè¿‡<code>sudo apt-get install cgdb</code>æ¥å®‰è£…äº†ã€‚</p>\n<p>æˆ‘ä»¬å¯ä»¥ä¸€æ¬¡å®‰è£…å¤šä¸ªè½¯ä»¶ï¼Œæ¯”å¦‚<code>sudo apt-get install git ddd</code>å°±ä¼šå®‰è£…åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶å·¥å…·gitå’Œå›¾å½¢åŒ–è°ƒè¯•å·¥å…·dddï¼š</p>\n<p><img src=\"./%E5%9F%BA%E4%BA%8EVirtualBox%E5%AE%89%E8%A3%85(Ubuntu,openEuler)%E5%9B%BE%E6%96%87%E6%95%99%E7%A8%8B%20-%20%E5%A8%84%E8%80%81%E5%B8%88%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/741560-20161030112525687-2083766394.png\" alt=\"\"></p>\n<p>è¿™æé†’æˆ‘ä»¬å¯ä»¥å†™ä¸ªè„šæœ¬ç®€åŒ–è½¯ä»¶çš„å®‰è£…ï¼Œä½ å¯ä»¥æºæºä¸æ–­çš„æŠŠè‡ªå·±ç”¨çš„è½¯ä»¶æ·»åŠ åˆ°è¿™ä¸ªè„šæœ¬ä¸­ï¼Œæ–¹ä¾¿æ—¥åè‡ªå·±å®‰è£…æ–°ç³»ç»Ÿï¼š</p>\n<p><img src=\"./%E5%9F%BA%E4%BA%8EVirtualBox%E5%AE%89%E8%A3%85(Ubuntu,openEuler)%E5%9B%BE%E6%96%87%E6%95%99%E7%A8%8B%20-%20%E5%A8%84%E8%80%81%E5%B8%88%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/741560-20161030113309812-1973136131.png\" alt=\"\"></p>\n<p><img src=\"./%E5%9F%BA%E4%BA%8EVirtualBox%E5%AE%89%E8%A3%85(Ubuntu,openEuler)%E5%9B%BE%E6%96%87%E6%95%99%E7%A8%8B%20-%20%E5%A8%84%E8%80%81%E5%B8%88%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/741560-20161030113321468-101934690.png\" alt=\"\"></p>\n<p>æˆ‘çš„å®‰è£…è„šæœ¬ä¾›å¤§å®¶èƒ½å‚è€ƒï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/sh</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># update system</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">sudo</span> apt-get update</span><br><span class=\"line\"><span class=\"built_in\">sudo</span> apt-get grade </span><br><span class=\"line\"><span class=\"built_in\">sudo</span> apt-get autoremove</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># utilities</span></span><br><span class=\"line\"><span class=\"built_in\">sudo</span> apt-get install krusader unace unrar zip unzip p7zip-full p7zip-rar sharutils rar uudeview mpack  arj cabextract file-roller</span><br><span class=\"line\"><span class=\"built_in\">sudo</span> apt-get install apvlv biff bsdgames byobu calcurse curl dia dia2code dtach dump fbset filezilla  freemind gimp  htop iotop jhead ksnapshot multitail moreutils pandoc planner powertop putty python-pip retext rpm screen sniffit socat stardict tmux tpp tree  vlc vnc4server xvnc4viewer wireshark xchm xpdf tweak</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># cheat </span></span><br><span class=\"line\"><span class=\"built_in\">sudo</span> pip install docopt pygments</span><br><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/chrisallenlane/cheat.git</span><br><span class=\"line\"><span class=\"built_in\">cd</span> cheat</span><br><span class=\"line\"><span class=\"built_in\">sudo</span> python setup.py install  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#vi </span></span><br><span class=\"line\"><span class=\"built_in\">cd</span> ~/.vim/bundle</span><br><span class=\"line\">wget http://www.vim.org/scripts/download_script.php?src_id=9679</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#java</span></span><br><span class=\"line\"><span class=\"built_in\">sudo</span> apt-get install eclipse  eclipse-wtp eclipse-emf eclipse-gef netbeans  gaphor umbrello umlet</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#programming</span></span><br><span class=\"line\"><span class=\"built_in\">sudo</span> apt-get install ascii automake bison bison-doc bluefish  cgdb clang cmake codeblocks codeblocks-dbg codeblocks-dev cscope cvs dia ddd doxygen doxygen-doc doxygen-gui dstat eclipse eclipse-cdt eclipse-cdt-qt  eclipse-cdt-valgrind eclipse-eclox eclipse-egit  eclipse-egit-mylyn eclipse-mylyn  exuberant-ctags flex fossil fp-compiler fp-ide  g++ gcc gdb  git gitk git-gui git-doc git-cvs git-svn git-sh gnustep groovy ifstat indent jedit jython  libncurses5-dev ncurses-doc libasound2-dev libasound2-doc manpages-posix manpages-posix-dev  nasm python-django python-django-doc qtcreator splint sqlite3 libsqlite3-dev sqlitebrowser sqliteman swig2.0 sysstat tcl8.5 tcl8.5-doc tk8.5 tk8.5-doc txt2tags python-pip qtcreator ruby1.9.3  qt4-qmake qtcreator jruby subversion tidy valgrind vim scala </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#security</span></span><br><span class=\"line\"><span class=\"built_in\">sudo</span> apt-get install lib32z1 libc6-dev-i386     //64-&gt;32</span><br><span class=\"line\"><span class=\"built_in\">sudo</span> apt-get install lib32readline-gplv2-dev</span><br></pre></td></tr></table></figure>\n<h2 id=\"å®‰è£…è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜\">å®‰è£…è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜</h2>\n<h3 id=\"ç•Œé¢æ˜¾ç¤ºä¸å…¨\">ç•Œé¢æ˜¾ç¤ºä¸å…¨</h3>\n<pre><code>  æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®åˆ†è¾¨ç‡ï¼Œæ‰€ä»¥æœªå®‰è£…å¥½ä¹‹å‰æˆ‘ä»¬å¯ä»¥é€šè¿‡ç»ˆç«¯ä¿®æ”¹åˆ†è¾¨ç‡æ¥è§£å†³ã€‚\n</code></pre>\n<ol>\n<li><code>Ctrl+Alt+t</code>æ‰“å¼€ç»ˆç«¯é¢æ¿</li>\n</ol>\n<center>\n<img src=\"https://s2.loli.net/2024/12/07/V7dy4rNz5FXgsLC.png\" width=\"80%\" />\n</center>\n<ol start=\"2\">\n<li>è¾“å…¥<code>xrandr</code>ç„¶åå›è½¦ï¼ŒæŸ¥çœ‹æ”¯æŒçš„æ‰€æœ‰åˆ†è¾¨ç‡ã€‚</li>\n</ol>\n<center>\n<img src=\"https://s2.loli.net/2024/12/07/egZc47lbwQ1KmvE.png\" width=\"80%\" />\n</center>\n<ol start=\"3\">\n<li>é€‰æ‹©å…¶ä¸­ä¸€ä¸ªæ¯”è¾ƒå¤§çš„åˆ†è¾¨ç‡ï¼Œæ¯”å¦‚è¾“å…¥ï¼š<code>xrandr -s 1920x1080</code>ï¼Œç„¶åå›è½¦ã€‚</li>\n</ol>\n<center>\n<img src=\"https://s2.loli.net/2024/12/07/dav6WrY2VbGHUu7.png\" width=\"80%\" />\n</center>\n<ol start=\"4\">\n<li>å°±å¯ä»¥è§£å†³é—®é¢˜äº†ã€‚</li>\n</ol>\n<center>\n<img src=\"https://s2.loli.net/2024/12/07/Mn7kD9vlrHS4Z6E.png\" width=\"80%\" />\n</center>\n<h3 id=\"å®‰è£…å¢å¼ºåŠŸèƒ½æ—¶ã€æœªèƒ½åŠ è½½è™šæ‹Ÿå…‰ç›˜ã€‘\">å®‰è£…å¢å¼ºåŠŸèƒ½æ—¶ã€æœªèƒ½åŠ è½½è™šæ‹Ÿå…‰ç›˜ã€‘</h3>\n<ol>\n<li>è¿›å…¥ç³»ç»Ÿåœ¨ä¾§è¾¹æ‰¾åˆ°å¦‚å›¾åŠ è½½çš„è™šæ‹Ÿå…‰é©±ï¼Œå³å‡»ï¼Œç‚¹å‡»å¼¹å‡ºï¼Œç„¶åå°±å¯æ­£å¸¸å®‰è£…å¢å¼ºåŠŸèƒ½äº†ã€‚</li>\n</ol>\n<center>\n<img src=\"https://s2.loli.net/2024/12/07/tfUlRFo97yDsOjI.png\" width=\"80%\" />\n</center>\n<ol>\n<li>ç»ˆç«¯ä¾æ¬¡è¾“å…¥ã€‚</li>\n</ol>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">sudo</span> apt-get update</span><br><span class=\"line\"><span class=\"built_in\">sudo</span> apt-get install build-essential gcc make perl dkms</span><br><span class=\"line\">reboot</span><br></pre></td></tr></table></figure>","tags":["æ•™ç¨‹","VirtualBox","Ubuntu"]},{"title":"æˆ‘çš„2024","url":"/post/6bc0cde8.html","content":"<p><strong>2024å¹´æ ¡å›­å¡æ”¯å‡ºç»Ÿè®¡</strong></p>\n<div class=\"gallery-container\" data-type=\"data\" data-button=\"\">\n      <div class=\"gallery-data\">[{\"url\":\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/æˆ‘çš„2024/1.png\",\"alt\":\"\"},{\"url\":\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/æˆ‘çš„2024/2.png\",\"alt\":\"\"}]</div>\n      <div class=\"gallery-items\">\n      </div>\n    </div>\n<p>å“ˆå“ˆï¼Œæˆ‘æ€ä¹ˆè¿™ä¹ˆâ€œçˆ±â€å…°å›­ï¼Œä¸»è¦æ˜¯å› ä¸ºè¿‘ã€‚æ— è®ºæ˜¯å¯’æš‘å‡ç•™åœ¨å®éªŒå®¤é›†è®­ï¼Œè¿˜æ˜¯å¹³æ—¶ä¸Šè¯¾åœ¨45æ•™/46æ•™ï¼Œåˆé¥­é€‰æ‹©åœ¨å…°å›­åƒçœŸçš„æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œåƒå®Œåé¡ºè·¯å›å®¿èˆç¡åˆè§‰ã€‚</p>\n<p>æ™šé¥­åœ¨<strong>å–œå®¶å¾·</strong>ã€‚</p>\n<div class=\"gallery-container\" data-type=\"data\" data-button=\"\">\n      <div class=\"gallery-data\">[{\"url\":\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/æˆ‘çš„2024/food-0.jpg\",\"alt\":\"\"}]</div>\n      <div class=\"gallery-items\">\n      </div>\n    </div>\n<p><strong>ä¸–çºªé’Ÿ</strong><s>å¥½å¤šäººå•Š</s>å¥½å¤šæ°”çƒå•Šï¼Œâ€œ2025ï¼Œä½ å¥½â€ï¼Œâ€œæ–°å¹´å¿«ä¹â€ã€‚</p>\n<div class=\"gallery-container\" data-type=\"data\" data-button=\"\">\n      <div class=\"gallery-data\">[{\"url\":\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/æˆ‘çš„2024/ball-2.jpg\",\"alt\":\"\"},{\"url\":\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/æˆ‘çš„2024/ball-3.jpg\",\"alt\":\"\"},{\"url\":\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/æˆ‘çš„2024/ball-1.jpg\",\"alt\":\"\"}]</div>\n      <div class=\"gallery-items\">\n      </div>\n    </div>\n<p>åˆé¥­åœ¨<strong>å…‹èŒ—é¦™æ¸¯èŒ¶é¤å…</strong>ã€‚</p>\n<div class=\"gallery-container\" data-type=\"data\" data-button=\"\">\n      <div class=\"gallery-data\">[{\"url\":\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/æˆ‘çš„2024/food-1.jpg\",\"alt\":\"\"},{\"url\":\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/æˆ‘çš„2024/food-2.jpg\",\"alt\":\"\"},{\"url\":\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/æˆ‘çš„2024/food-3.jpg\",\"alt\":\"\"},{\"url\":\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/æˆ‘çš„2024/food-4.jpg\",\"alt\":\"\"},{\"url\":\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/æˆ‘çš„2024/food-5.jpg\",\"alt\":\"\"},{\"url\":\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/æˆ‘çš„2024/food-6.jpg\",\"alt\":\"\"},{\"url\":\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/æˆ‘çš„2024/food-7.jpg\",\"alt\":\"\"}]</div>\n      <div class=\"gallery-items\">\n      </div>\n    </div>\n<p>ä¸‹åˆæ‰“å¡äº†ä¸€ç›´æƒ³å»çš„<strong>é’Ÿä¹¦é˜</strong>ã€‚</p>\n<div class=\"gallery-container\" data-type=\"data\" data-button=\"\">\n      <div class=\"gallery-data\">[{\"url\":\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/æˆ‘çš„2024/library-4.jpg\",\"alt\":\"\"},{\"url\":\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/æˆ‘çš„2024/library-1.jpg\",\"alt\":\"\"},{\"url\":\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/æˆ‘çš„2024/library-2.jpg\",\"alt\":\"\"},{\"url\":\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/image/æˆ‘çš„2024/library-3.jpg\",\"alt\":\"\"}]</div>\n      <div class=\"gallery-items\">\n      </div>\n    </div>"},{"title":"æˆ‘çš„21å²","url":"/post/bba48da1.html","content":"<div class=\"hbe hbe-container\" id=\"hexo-blog-encrypt\" data-wpm=\"Oh, this is an invalid password. Check and try again, please.\" data-whm=\"OOPS, these decrypted content may changed, but you can still have a look.\">\n  <script id=\"hbeData\" type=\"hbeData\" data-hmacdigest=\"db9b6f686e835f1dd63f6a1cfa40d4e48018067bc88dc444e5522dd63de09136\">ff5bd91e40b47e4b70872304ecb021a0647b42402a31da9ddb99f625124df4b96d3bb55d4d81f2e8e1c7a549fcc4ab46940c6599b0028b32a7a88b0bc73b864b9dd3fdb43a7946591c41cc110225689192cbbf1e67c589ccaaa7891b4eada7e3fb0bf7f2637d437b48809daf5f372d50a43d065cd34a7d1bb4e6d8dd4ff426b58660df355869814dcafb54c96653e7d89c47a148e55435bd839659922bbd251b11ed2b5b2b8740157ea69d9ef8a0dd8c457b90f8923f3a18ffa8304a83d6ad1bee6f32c8bdeb0f4a2854eb18fde5467740ea28644d382c52b1f43f789f51bbb301db46310f112c1758ab3ebc789202655f368febf7e4a835fdcf620dda18c2252e82bb004e06f0cae1bc18818d4653f34013b7edd241c7a7794aa03c1f4bc44d4cc0cd6cd08f73f233fb946a291ffe017ebdb59e5c4b8347fa68e816d8ce47ac34608c683b03962b3db245f57b8faa6ea1ce74d1e4b6d0bff365a851eadb8c0a828af30477fa311bd4dc0c76b4d4cfb1b583655b59ac0f0946f3874991bc96ba354bc297a323994125fd5407c1d7c27371b1831ae0e300ed6362d303bf9a07a6452833e2f6f172751e77c8a28546f279632a6a54aac70a122f728b45766f776b34b92a2dfc556d109b79110e270915bd53684f494a80ab5c8dd8e4f0d7fc72b682ec24f10d984d1e331de52683ebb5956336eed6675a9538be3873190f27be18180145bd758ec163f7da02466df0c7638c7d33d38b1a648b1b35d4fb75eb2aab818c2f93475fe3ecad098d922e41c0ddfa7297e91dc1a89d9cb8df15308fe5993c4e1853db32d5e23de8e1b3ed91557a2d8089635399aa4b2ba3e04a4a45ae3f4c107b3e2e1574b70a375cd11dfeae55475db5e731ec1c02a00bb9407174797f7a9921a7b2732e743e339e45ed786e3fe00a77ada8e2fdfb743077185babc612a49ed80edbf4a8ffcd0965bab84e9dc4e46311cfe46f48e4ff11373eb29be9a3c957d9f3a28d4da03f97490e39b91d9ad8baf44d8e637cc10c6987c6781cf90c31676cd0644d1dd11eb2c2bc84d555d1dc98a068a2a5197e79e5c8aba3644b24563e50930264e45087add7eca21d715d9a219369a649854145dd59f116b1fa16222eaa123b65cb77f52238df2dea9cfbc460e972c833c9eb46ab0358df7f803c03207ba70a9de118a60558b8d3e2ecb436695ad6d95207665e626b3fd500ec6b3c84c1a53bbe7f1a12075133cd7bcd3ced734ec3e8cc5919de248631b6ec3a83949e266f85e98ecce9e04ffa72ce2521a10cb275f52da4d0921be830d3f24d4f31447c03214d5bb5eddff8abc6cfb94a2251da35ce0210980494e3c1de50b36b</script>\n  <div class=\"hbe hbe-content\">\n    <div class=\"hbe hbe-input hbe-input-default\">\n      <input class=\"hbe hbe-input-field hbe-input-field-default\" type=\"password\" id=\"hbePass\">\n      <label class=\"hbe hbe-input-label hbe-input-label-default\" for=\"hbePass\">\n        <span class=\"hbe hbe-input-label-content hbe-input-label-content-default\">Hey, password is required here.</span>\n      </label>\n    </div>\n  </div>\n</div>\n<script data-pjax src=\"/lib/hbe.js\"></script><link href=\"/css/hbe.style.css\" rel=\"stylesheet\" type=\"text/css\">","tags":["ç”Ÿæ—¥"]},{"title":"æ•°å€¼è®¡ç®—æ–¹æ³•","url":"/post/298117e1.html","content":"<h2 id=\"æ’å€¼æ³•\">æ’å€¼æ³•</h2>\n<p><strong>å®ç°èŒƒå¾·è’™å¾·å¤šé¡¹å¼æ’å€¼ã€æ‹‰æ ¼æœ—æ—¥æ’å€¼ã€ç‰›é¡¿æ’å€¼ã€åˆ†æ®µçº¿æ€§ã€åˆ†æ®µä¸‰æ¬¡ Hermite æ’å€¼ï¼Œå¹¶å®Œæˆå„æ–¹æ³•ä¹‹é—´çš„å¯¹æ¯”ã€‚</strong><br>\n<font color=red>è¾“å…¥</font>ï¼šæ’å€¼åŒºé—´ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>b</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[a, b]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mclose\">]</span></span></span></span>ï¼Œå‚æ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo separator=\"true\">,</mo><mi>d</mi><mo separator=\"true\">,</mo><mi>e</mi><mo separator=\"true\">,</mo><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">c, d, e, f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span> ä½œä¸ºæ ‡å‡†å‡½æ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>c</mi><mo>â‹…</mo><mi>sin</mi><mo>â¡</mo><mi>d</mi><mi>x</mi><mo>+</mo><mi>e</mi><mo>â‹…</mo><mi>cos</mi><mo>â¡</mo><mi>f</mi><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">f(x) = c \\cdot \\sin dx + e \\cdot \\cos fx</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4445em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\"></span><span class=\"mop\">sin</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4445em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">â‹…</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mop\">cos</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\">x</span></span></span></span> çš„å€¼ï¼Œå‚æ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">n+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> ä½œä¸ºé‡‡æ ·ç‚¹çš„ä¸ªæ•°ï¼Œå‚æ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span> ä½œä¸ºå®éªŒç‚¹çš„ä¸ªæ•°ã€‚<br>\n<font color=red>è¦æ±‚</font>ï¼šåœ¨åŒºé—´ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>b</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[a, b]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mclose\">]</span></span></span></span> ä¸Šå‡åŒ€é‡‡é›†ä¸ªé‡‡é›†ç‚¹ï¼Œåˆ©ç”¨è¿™ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">n+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> ä¸ªé‡‡é›†ç‚¹ï¼Œåˆ†åˆ«ä½¿ç”¨èŒƒå¾·è’™å¾·å¤šé¡¹å¼æ’å€¼ã€æ‹‰æ ¼æœ—æ—¥æ’å€¼ã€ç‰›é¡¿æ’å€¼ã€åˆ†æ®µçº¿æ€§ã€åˆ†æ®µä¸‰æ¬¡ Hermite æ’å€¼è¿›è¡Œæ’å€¼ï¼Œæ±‚å‡º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">L(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>ï¼Œä¹‹åå†é€‰å– <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span> ä¸ªç‚¹ä½œä¸ºå®éªŒç‚¹ï¼Œè®¡ç®—åœ¨è¿™ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span> ä¸ªå®éªŒç‚¹ä¸Šæ’å€¼å‡½æ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">L(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span> ä¸ç›®æ ‡å‡½æ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span> çš„å¹³å‡è¯¯å·®ã€‚åŒæ—¶å¯¹æ¯”å„æ’å€¼æ–¹æ³•ä¹‹é—´çš„ç²¾åº¦å·®å¼‚ã€‚<br>\n<font color=red>è¾“å‡º</font>ï¼šå¯¹æ¯”å‡½æ•°æ›²çº¿ï¼Œå¹³å‡è¯¯å·®ã€‚</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># èŒƒå¾·è’™å¾·å¤šé¡¹å¼æ’å€¼</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">vandermonde_interpolation</span>(<span class=\"params\">x, y, x_values</span>):</span><br><span class=\"line\">    n = <span class=\"built_in\">len</span>(x)</span><br><span class=\"line\">    coefficients = []</span><br><span class=\"line\">    c = []</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(n):</span><br><span class=\"line\">        coeff = []</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(n):</span><br><span class=\"line\">            coeff.append(x[i]**j)</span><br><span class=\"line\">        coefficients.append(coeff)</span><br><span class=\"line\">        c.append(y[i])</span><br><span class=\"line\">    A = np.array(coefficients)</span><br><span class=\"line\">    inv_A = np.linalg.inv(A)</span><br><span class=\"line\">    a = inv_A.dot(c)</span><br><span class=\"line\">    <span class=\"built_in\">sum</span> = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(n):</span><br><span class=\"line\">        <span class=\"built_in\">sum</span> += a[i] * x_values ** i</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">sum</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ‹‰æ ¼æœ—æ—¥æ’å€¼</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">lagrange_interpolation</span>(<span class=\"params\">x, y, x_values</span>):</span><br><span class=\"line\">    n = <span class=\"built_in\">len</span>(x)</span><br><span class=\"line\">    result = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(n):</span><br><span class=\"line\">        p = y[i]</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(n):</span><br><span class=\"line\">            <span class=\"keyword\">if</span> j != i:</span><br><span class=\"line\">                p *= (x_values - x[j]) / (x[i] - x[j])</span><br><span class=\"line\">        result += p</span><br><span class=\"line\">    <span class=\"keyword\">return</span> result</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç‰›é¡¿æ’å€¼</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">newton_interpolation</span>(<span class=\"params\">x, y, x_values</span>):</span><br><span class=\"line\">    n = <span class=\"built_in\">len</span>(x)</span><br><span class=\"line\">    coefficients = []</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(n-<span class=\"number\">1</span>, <span class=\"number\">0</span>, -<span class=\"number\">1</span>):</span><br><span class=\"line\">        divided_diff = (y[i] - y[i-<span class=\"number\">1</span>]) / (x[i] - x[i-<span class=\"number\">1</span>])</span><br><span class=\"line\">        coefficients.append(divided_diff)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(n-i-<span class=\"number\">1</span>, <span class=\"number\">0</span>, -<span class=\"number\">1</span>):</span><br><span class=\"line\">            divided_diff = (-divided_diff + coefficients[j-<span class=\"number\">1</span>]) / (x[n-j] - x[i-<span class=\"number\">1</span>])</span><br><span class=\"line\">            coefficients[j-<span class=\"number\">1</span>] = divided_diff</span><br><span class=\"line\">    coefficients.append(y[<span class=\"number\">0</span>])</span><br><span class=\"line\">    result = coefficients[<span class=\"number\">0</span>]</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(n-<span class=\"number\">2</span>, -<span class=\"number\">1</span>, -<span class=\"number\">1</span>):</span><br><span class=\"line\">        result = result * (x_values - x[i]) + coefficients[n-<span class=\"number\">1</span>-i]</span><br><span class=\"line\">    <span class=\"keyword\">return</span> result</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ†æ®µçº¿æ€§æ’å€¼</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">piecewise_linear_interpolation</span>(<span class=\"params\">x, y, x_values</span>):</span><br><span class=\"line\">    n = <span class=\"built_in\">len</span>(x)</span><br><span class=\"line\">    result = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(n-<span class=\"number\">1</span>):</span><br><span class=\"line\">        mask = (x[i] &lt;= x_values) &amp; (x_values &lt; x[i+<span class=\"number\">1</span>])</span><br><span class=\"line\">        slope = (y[i+<span class=\"number\">1</span>] - y[i]) / (x[i+<span class=\"number\">1</span>] - x[i])</span><br><span class=\"line\">        result += ((y[i] + slope * (x_values - x[i]))*mask)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (x_values == x[n-<span class=\"number\">1</span>]):</span><br><span class=\"line\">        result = y[n-<span class=\"number\">1</span>]</span><br><span class=\"line\">    <span class=\"keyword\">return</span> result</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ†æ®µä¸‰æ¬¡Hermiteæ’å€¼</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">piecewise_cubic_hermite_interpolation</span>(<span class=\"params\">x, y, yy, x_values</span>):</span><br><span class=\"line\">    n = <span class=\"built_in\">len</span>(x)</span><br><span class=\"line\">    result = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(n-<span class=\"number\">1</span>):</span><br><span class=\"line\">        <span class=\"keyword\">if</span> ((x[i] &lt;= x_values) &amp; (x_values &lt; x[i+<span class=\"number\">1</span>])):</span><br><span class=\"line\">            ai = (<span class=\"number\">1</span>+<span class=\"number\">2</span>*(x_values-x[i])/(x[i+<span class=\"number\">1</span>]-x[i]))*((x_values-x[i+<span class=\"number\">1</span>])/(x[i]-x[i+<span class=\"number\">1</span>]))**<span class=\"number\">2</span></span><br><span class=\"line\">            bi = (x_values - x[i])*((x_values-x[i+<span class=\"number\">1</span>])/(x[i]-x[i+<span class=\"number\">1</span>]))**<span class=\"number\">2</span></span><br><span class=\"line\">            ai1 = (<span class=\"number\">1</span>+<span class=\"number\">2</span>*(x_values-x[i+<span class=\"number\">1</span>])/(x[i]-x[i+<span class=\"number\">1</span>]))*((x_values-x[i])/(x[i+<span class=\"number\">1</span>]-x[i]))**<span class=\"number\">2</span></span><br><span class=\"line\">            bi1 = (x_values - x[i+<span class=\"number\">1</span>])*((x_values-x[i])/(x[i+<span class=\"number\">1</span>]-x[i]))**<span class=\"number\">2</span></span><br><span class=\"line\">            result += (y[i] * ai +yy[i] * bi +y[i+<span class=\"number\">1</span>] * ai1 +yy[i+<span class=\"number\">1</span>] * bi1)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (x_values == x[n-<span class=\"number\">1</span>]):</span><br><span class=\"line\">        result = y[n-<span class=\"number\">1</span>]</span><br><span class=\"line\">    <span class=\"keyword\">return</span> result</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç›®æ ‡å‡½æ•°</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">target_function</span>(<span class=\"params\">c,d,e,f,x</span>):</span><br><span class=\"line\">    <span class=\"keyword\">return</span> [(c*np.sin(d*val)+e*np.cos(f*val)) <span class=\"keyword\">for</span> val <span class=\"keyword\">in</span> x] </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç›®æ ‡å‡½æ•°å¯¼å‡½æ•°</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">derivative_function</span>(<span class=\"params\">c,d,e,f,x</span>):</span><br><span class=\"line\">    <span class=\"keyword\">return</span> [(c*d*np.cos(d*val)-e*f*np.sin(f*val)) <span class=\"keyword\">for</span> val <span class=\"keyword\">in</span> x]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è®¡ç®—å¹³å‡è¯¯å·®</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">compute_average_error</span>(<span class=\"params\">f, g, x_values</span>):</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">sum</span>([<span class=\"built_in\">abs</span>(f[i] - g[i]) <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(x_values))]) / <span class=\"built_in\">len</span>(x_values)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è®¾ç½®æ’å€¼åŒºé—´å’Œå‚æ•°</span></span><br><span class=\"line\">a = <span class=\"built_in\">float</span>(<span class=\"built_in\">input</span>())</span><br><span class=\"line\">b = <span class=\"built_in\">float</span>(<span class=\"built_in\">input</span>())</span><br><span class=\"line\">c = <span class=\"built_in\">float</span>(<span class=\"built_in\">input</span>())</span><br><span class=\"line\">d = <span class=\"built_in\">float</span>(<span class=\"built_in\">input</span>())</span><br><span class=\"line\">e = <span class=\"built_in\">float</span>(<span class=\"built_in\">input</span>())</span><br><span class=\"line\">f = <span class=\"built_in\">float</span>(<span class=\"built_in\">input</span>())</span><br><span class=\"line\">num_samples = <span class=\"built_in\">int</span>(<span class=\"built_in\">input</span>())</span><br><span class=\"line\">num_experiments = <span class=\"built_in\">int</span>(<span class=\"built_in\">input</span>())</span><br><span class=\"line\">x_values = [a + (b - a) * i / (num_samples - <span class=\"number\">1</span>) <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(num_samples)]</span><br><span class=\"line\">ys = target_function(c,d,e,f,x_values)</span><br><span class=\"line\">yy = derivative_function(c,d,e,f,x_values)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è®¡ç®—å®éªŒç‚¹</span></span><br><span class=\"line\">experiment_points = [a + (b - a) * i / (num_experiments - <span class=\"number\">1</span>) <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(num_experiments)]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è®¡ç®—å„æ’å€¼æ–¹æ³•çš„æ’å€¼ç»“æœå’Œå¹³å‡è¯¯å·®</span></span><br><span class=\"line\">vandermonde_interpolated = [vandermonde_interpolation(x_values, ys, val) <span class=\"keyword\">for</span> val <span class=\"keyword\">in</span> experiment_points]</span><br><span class=\"line\">vandermonde_error = compute_average_error(target_function(c,d,e,f,experiment_points), vandermonde_interpolated, experiment_points)</span><br><span class=\"line\"></span><br><span class=\"line\">lagrange_interpolated = [lagrange_interpolation(x_values, ys, val) <span class=\"keyword\">for</span> val <span class=\"keyword\">in</span> experiment_points]</span><br><span class=\"line\">lagrange_error = compute_average_error(target_function(c,d,e,f,experiment_points), lagrange_interpolated, experiment_points)</span><br><span class=\"line\"></span><br><span class=\"line\">newton_interpolated = [newton_interpolation(x_values, ys, val) <span class=\"keyword\">for</span> val <span class=\"keyword\">in</span> experiment_points]</span><br><span class=\"line\">newton_error = compute_average_error(target_function(c,d,e,f,experiment_points), newton_interpolated, experiment_points)</span><br><span class=\"line\"></span><br><span class=\"line\">piecewise_linear_interpolated = [piecewise_linear_interpolation(x_values, ys, val) <span class=\"keyword\">for</span> val <span class=\"keyword\">in</span> experiment_points]</span><br><span class=\"line\">piecewise_linear_error = compute_average_error(target_function(c,d,e,f,experiment_points), piecewise_linear_interpolated, experiment_points)</span><br><span class=\"line\"></span><br><span class=\"line\">piecewise_cubic_hermite_interpolated = [piecewise_cubic_hermite_interpolation(x_values, ys, yy, val) <span class=\"keyword\">for</span> val <span class=\"keyword\">in</span> experiment_points]</span><br><span class=\"line\">piecewise_cubic_hermite_error = compute_average_error(target_function(c,d,e,f,experiment_points), piecewise_cubic_hermite_interpolated, experiment_points)</span><br><span class=\"line\"></span><br><span class=\"line\">fig = plt.figure(num = <span class=\"number\">1</span>,dpi = <span class=\"number\">120</span>)</span><br><span class=\"line\">ax = plt.subplot(<span class=\"number\">1</span>,<span class=\"number\">1</span>,<span class=\"number\">1</span>)</span><br><span class=\"line\"> <span class=\"comment\"># åæ ‡è½´</span></span><br><span class=\"line\">ax = plt.gca()  <span class=\"comment\"># get current axis è·å¾—åæ ‡è½´å¯¹è±¡</span></span><br><span class=\"line\">ax.spines[<span class=\"string\">&#x27;right&#x27;</span>].set_color(<span class=\"string\">&#x27;none&#x27;</span>)  <span class=\"comment\"># å°†å³è¾¹ è¾¹æ²¿çº¿é¢œè‰²è®¾ç½®ä¸ºç©º å…¶å®å°±ç›¸å½“äºæŠ¹æ‰è¿™æ¡è¾¹</span></span><br><span class=\"line\">ax.spines[<span class=\"string\">&#x27;top&#x27;</span>].set_color(<span class=\"string\">&#x27;none&#x27;</span>)</span><br><span class=\"line\">ax.xaxis.set_ticks_position(<span class=\"string\">&#x27;bottom&#x27;</span>)</span><br><span class=\"line\">ax.yaxis.set_ticks_position(<span class=\"string\">&#x27;left&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\"># è®¾ç½®ä¸­å¿ƒçš„ä¸ºï¼ˆ0ï¼Œ0ï¼‰çš„åæ ‡è½´</span></span><br><span class=\"line\">ax.spines[<span class=\"string\">&#x27;bottom&#x27;</span>].set_position((<span class=\"string\">&#x27;data&#x27;</span>, <span class=\"number\">0</span>))  <span class=\"comment\"># æŒ‡å®š data è®¾ç½®çš„bottom(ä¹Ÿå°±æ˜¯æŒ‡å®šçš„xè½´)ç»‘å®šåˆ°yè½´çš„0è¿™ä¸ªç‚¹ä¸Š</span></span><br><span class=\"line\">ax.spines[<span class=\"string\">&#x27;left&#x27;</span>].set_position((<span class=\"string\">&#x27;data&#x27;</span>, <span class=\"number\">0</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">x=<span class=\"built_in\">list</span>(np.arange(a,b,<span class=\"number\">0.01</span>))<span class=\"comment\">#æ­¤å¤„å¯è°ƒæ•´è‡ªå˜é‡å–å€¼èŒƒå›´ï¼Œä»¥ä¾¿é€‰æ‹©åˆé€‚çš„è§‚å¯Ÿå°ºåº¦</span></span><br><span class=\"line\">y=[]</span><br><span class=\"line\">y1=[]</span><br><span class=\"line\">y2=[]</span><br><span class=\"line\">y3=[]</span><br><span class=\"line\">y4=[]</span><br><span class=\"line\">y5=[]</span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(x)):</span><br><span class=\"line\">    y = target_function(c,d,e,f,x)</span><br><span class=\"line\">    y1.append(vandermonde_interpolation(x_values, ys, x[i]))</span><br><span class=\"line\">    y2.append(lagrange_interpolation(x_values, ys, x[i]))</span><br><span class=\"line\">    y3.append(newton_interpolation(x_values, ys, x[i]))</span><br><span class=\"line\">    y4.append(piecewise_linear_interpolation(x_values, ys, x[i]))</span><br><span class=\"line\">    y5.append(piecewise_cubic_hermite_interpolation(x_values, ys, yy, x[i]))</span><br><span class=\"line\">    </span><br><span class=\"line\"></span><br><span class=\"line\">ax.plot(x,y,label = <span class=\"string\">&quot;Target Function&quot;</span>,color =<span class=\"string\">&quot;blueviolet&quot;</span>)</span><br><span class=\"line\">ax.plot(x_values,ys, marker = <span class=\"string\">&quot;*&quot;</span>,linestyle = <span class=\"string\">&quot;&quot;</span>, color = <span class=\"string\">&quot;blueviolet&quot;</span>)</span><br><span class=\"line\">ax.plot(x,y1,label = <span class=\"string\">&quot;vandermonde interpolation\\n average error=%f&quot;</span>%vandermonde_error,color =<span class=\"string\">&quot;red&quot;</span>)</span><br><span class=\"line\">ax.plot(experiment_points, vandermonde_interpolated, marker = <span class=\"string\">&quot;o&quot;</span>,linestyle = <span class=\"string\">&quot;&quot;</span>, color = <span class=\"string\">&quot;red&quot;</span>)</span><br><span class=\"line\">ax.plot(x,y2,label = <span class=\"string\">&quot;lagrange interpolation\\n average error=%f&quot;</span>%lagrange_error,color =<span class=\"string\">&quot;yellow&quot;</span>)</span><br><span class=\"line\">ax.plot(experiment_points, lagrange_interpolated, marker = <span class=\"string\">&quot;o&quot;</span>,linestyle = <span class=\"string\">&quot;&quot;</span>, color = <span class=\"string\">&quot;yellow&quot;</span>)</span><br><span class=\"line\">ax.plot(x,y3,label = <span class=\"string\">&quot;newton interpolation\\n average error=%f&quot;</span>%newton_error,color =<span class=\"string\">&quot;green&quot;</span>)</span><br><span class=\"line\">ax.plot(experiment_points, newton_interpolated, marker = <span class=\"string\">&quot;o&quot;</span>,linestyle = <span class=\"string\">&quot;&quot;</span>, color = <span class=\"string\">&quot;green&quot;</span>)</span><br><span class=\"line\">ax.plot(x,y4,label = <span class=\"string\">&quot;piecewise linear interpolation\\n average error=%f&quot;</span>%piecewise_linear_error,color =<span class=\"string\">&quot;blue&quot;</span>)</span><br><span class=\"line\">ax.plot(experiment_points, piecewise_linear_interpolated, marker = <span class=\"string\">&quot;o&quot;</span>,linestyle = <span class=\"string\">&quot;&quot;</span>, color = <span class=\"string\">&quot;blue&quot;</span>)</span><br><span class=\"line\">ax.plot(x,y5,label = <span class=\"string\">&quot;piecewise cubic hermite interpolation\\n average error=%f&quot;</span>%piecewise_cubic_hermite_error,color =<span class=\"string\">&quot;purple&quot;</span>)</span><br><span class=\"line\">ax.plot(experiment_points, piecewise_cubic_hermite_interpolated, marker = <span class=\"string\">&quot;o&quot;</span>,linestyle = <span class=\"string\">&quot;&quot;</span>, color = <span class=\"string\">&quot;purple&quot;</span>)</span><br><span class=\"line\"><span class=\"comment\">#ax.set_xlim(0,2)</span></span><br><span class=\"line\"><span class=\"comment\">#plt.draw()</span></span><br><span class=\"line\">plt.legend()</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\n<h2 id=\"å‡½æ•°é€¼è¿‘\">å‡½æ•°é€¼è¿‘</h2>\n<p><strong>å®ç°æœ€ä½³å¹³æ–¹é€¼è¿‘ä¸æœ€å°äºŒä¹˜æ‹Ÿåˆï¼Œå¹¶å®Œæˆä¸¤ç§æ–¹æ³•ä¹‹é—´çš„å¯¹æ¯”ã€‚</strong><br>\n<font color=red>è¾“å…¥</font>ï¼šå‡½æ•°åŒºé—´ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>b</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[a, b]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mclose\">]</span></span></span></span>ï¼Œå‚æ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span></span></span></span> ä½œä¸ºæ ‡å‡†å‡½æ•°<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>c</mi><msup><mi>x</mi><mn>2</mn></msup></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">f(x)=\\frac{1}{1+cx^2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2484em;vertical-align:-0.4033em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mbin mtight\">+</span><span class=\"mord mathnormal mtight\">c</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7463em;\"><span style=\"top:-2.786em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4033em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>çš„å€¼ï¼Œå‚æ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> ä½œä¸ºæ‰€æ„é€ çš„é€¼è¿‘å¤šé¡¹å¼çš„æ¬¡æ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mn>3</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(k=1,2,3)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">3</span><span class=\"mclose\">)</span></span></span></span> ã€‚å‚æ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">n+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> ä½œä¸ºé‡‡æ ·ç‚¹çš„ä¸ªæ•°ï¼Œå‚æ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span> ä½œä¸ºå®éªŒç‚¹çš„ä¸ªæ•°ã€‚<br>\n<font color=red>è¦æ±‚</font>ï¼šè¦æ±‚é€‰ç”¨å‹’è®©å¾·æ­£äº¤å¤šé¡¹å¼ä½œæœ€ä½³å¹³æ–¹é€¼è¿‘ï¼›åœ¨åŒºé—´ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>b</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[a, b]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mclose\">]</span></span></span></span> ä¸Šå‡åŒ€é‡‡é›† <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> ä¸ªé‡‡é›†ç‚¹ï¼Œåˆ©ç”¨è¿™ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">n+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> ä¸ªé‡‡é›†ç‚¹ï¼Œè®¡ç®—é‡‡é›†ç‚¹ä¸Šçš„å‡½æ•°å€¼ï¼Œæ„é€ æœ€å°äºŒä¹˜æ‹Ÿåˆå¤šé¡¹å¼å‡½æ•°ã€‚ä¹‹åå†é€‰å– <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span> ä¸ªç‚¹ä½œä¸ºå®éªŒç‚¹ï¼Œè®¡ç®—åœ¨è¿™ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span> ä¸ªå®éªŒç‚¹ä¸Šæ‰€æ„é€ çš„é€¼è¿‘å‡½æ•°ä¸ç»™å®šçš„ç›®æ ‡å‡½æ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span> çš„å¹³å‡è¯¯å·®ã€‚åŒæ—¶å¯¹æ¯”ä¸¤ç§é€¼è¿‘æ–¹æ³•ä¹‹é—´çš„ç²¾åº¦å·®å¼‚ã€‚<br>\n<font color=red>è¾“å‡º</font>ï¼šå¯¹æ¯”å‡½æ•°æ›²çº¿ï¼Œå¹³å‡è¯¯å·®ã€‚</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> sympy <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\">plt.rcParams[<span class=\"string\">&#x27;font.sans-serif&#x27;</span>]=[<span class=\"string\">&#x27;SimHei&#x27;</span>]</span><br><span class=\"line\">plt.rcParams[<span class=\"string\">&#x27;axes.unicode_minus&#x27;</span>] = <span class=\"literal\">False</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">qpow</span>(<span class=\"params\">a,n</span>):</span><br><span class=\"line\">    ans=<span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> n!=<span class=\"number\">0</span>:</span><br><span class=\"line\">        <span class=\"keyword\">if</span> n&amp;<span class=\"number\">1</span>:</span><br><span class=\"line\">            ans*=a</span><br><span class=\"line\">        a*=a</span><br><span class=\"line\">        n&gt;&gt;=<span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> ans</span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">F</span>(<span class=\"params\">x</span>):</span><br><span class=\"line\">    res = <span class=\"number\">1</span>/(<span class=\"number\">1</span>+c*x*x)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res</span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">cntpf</span>():</span><br><span class=\"line\">    t = symbols(<span class=\"string\">&#x27;t&#x27;</span>)</span><br><span class=\"line\">    <span class=\"comment\"># (b-a)*t/2+(b+a)/2</span></span><br><span class=\"line\">    fp[<span class=\"number\">0</span>] = integrate(<span class=\"number\">1</span> / (<span class=\"number\">1</span> + c * ((b - a) * t / <span class=\"number\">2</span> + (b + a) / <span class=\"number\">2</span>) * ((b - a) * t / <span class=\"number\">2</span> + (b + a) / <span class=\"number\">2</span>)),(t, -<span class=\"number\">1</span>, <span class=\"number\">1</span>)).evalf()</span><br><span class=\"line\">    fp[<span class=\"number\">1</span>] = integrate((<span class=\"number\">1</span> / (<span class=\"number\">1</span> + c * ((b - a) * t / <span class=\"number\">2</span> + (b + a) / <span class=\"number\">2</span>) * ((b - a) * t / <span class=\"number\">2</span> + (b + a) / <span class=\"number\">2</span>))) * (t),(t, -<span class=\"number\">1</span>, <span class=\"number\">1</span>)).evalf()</span><br><span class=\"line\">    fp[<span class=\"number\">2</span>] = integrate((<span class=\"number\">1</span> / (<span class=\"number\">1</span> + c * ((b - a) * t / <span class=\"number\">2</span> + (b + a) / <span class=\"number\">2</span>) * ((b - a) * t / <span class=\"number\">2</span> + (b + a) / <span class=\"number\">2</span>))) * (<span class=\"number\">3</span> * t * t / <span class=\"number\">2</span> - <span class=\"number\">1</span> / <span class=\"number\">2</span>),(t, -<span class=\"number\">1</span>, <span class=\"number\">1</span>)).evalf()</span><br><span class=\"line\">    fp[<span class=\"number\">3</span>] = integrate((<span class=\"number\">1</span> / (<span class=\"number\">1</span> + c * ((b - a) * t / <span class=\"number\">2</span> + (b + a) / <span class=\"number\">2</span>) * ((b - a) * t / <span class=\"number\">2</span> + (b + a) / <span class=\"number\">2</span>))) * (<span class=\"number\">5</span> * t * t * t / <span class=\"number\">2</span> - <span class=\"number\">3</span> * t / <span class=\"number\">2</span>),(t, -<span class=\"number\">1</span>, <span class=\"number\">1</span>)).evalf()</span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">bsa</span>(<span class=\"params\">inp</span>):</span><br><span class=\"line\">    res=<span class=\"number\">0</span></span><br><span class=\"line\">    inp =(<span class=\"number\">2</span> * inp -a - b) / (b - a)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">0</span>,k):</span><br><span class=\"line\">        res+=(<span class=\"number\">2</span>*i+<span class=\"number\">1</span>)*fp[i]*qpow(inp,i)/<span class=\"number\">2</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> res</span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">setup</span>():</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">0</span>,<span class=\"number\">100</span>):</span><br><span class=\"line\">        vispa[i]=<span class=\"number\">0</span></span><br><span class=\"line\">        vispb[i]=<span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">initx</span>():</span><br><span class=\"line\">    d=(b-a)/n</span><br><span class=\"line\">    x[<span class=\"number\">0</span>]=a</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1</span>,n):</span><br><span class=\"line\">        x[i]=x[i-<span class=\"number\">1</span>]+d</span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">compa</span>(<span class=\"params\">i</span>):</span><br><span class=\"line\">    <span class=\"keyword\">if</span> vispa[i]==<span class=\"number\">1</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span>  pa[i]</span><br><span class=\"line\">    up=<span class=\"number\">0</span></span><br><span class=\"line\">    down=<span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">0</span>,n):</span><br><span class=\"line\">        up+=comP(i-<span class=\"number\">1</span>,x[j])*comP(i-<span class=\"number\">1</span>,x[j])*x[j]</span><br><span class=\"line\">        down += comP(i - <span class=\"number\">1</span>, x[j]) * comP(i - <span class=\"number\">1</span>, x[j])</span><br><span class=\"line\">    res=up/down</span><br><span class=\"line\">    vispa[i] = <span class=\"number\">1</span></span><br><span class=\"line\">    pa[i] = res</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res</span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">compb</span>(<span class=\"params\">i</span>):</span><br><span class=\"line\">    <span class=\"keyword\">if</span> vispb[i]==<span class=\"number\">1</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> pb[i]</span><br><span class=\"line\">    up = <span class=\"number\">0</span></span><br><span class=\"line\">    down = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">0</span>, n):</span><br><span class=\"line\">        up += comP(i, x[j]) * comP(i, x[j])</span><br><span class=\"line\">        down += comP(i - <span class=\"number\">1</span>, x[j]) * comP(i - <span class=\"number\">1</span>, x[j])</span><br><span class=\"line\">    res=up/down</span><br><span class=\"line\">    vispb[i] = <span class=\"number\">1</span></span><br><span class=\"line\">    pb[i] = res</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res</span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">comP</span>(<span class=\"params\">i,inp</span>):</span><br><span class=\"line\">    res=<span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> i==<span class=\"number\">0</span>:</span><br><span class=\"line\">        res=<span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">elif</span> i==<span class=\"number\">1</span>:</span><br><span class=\"line\">        res = (inp -compa(<span class=\"number\">1</span>))*comP(<span class=\"number\">0</span>, inp)</span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        res = (inp -compa(i))*comP(i - <span class=\"number\">1</span>, inp)-compb(i - <span class=\"number\">1</span>) * comP(i - <span class=\"number\">2</span>, inp)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> res</span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">lsf</span>(<span class=\"params\">inp</span>):</span><br><span class=\"line\">    initx()</span><br><span class=\"line\">    res=<span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">0</span>,k):</span><br><span class=\"line\">        up=<span class=\"number\">0</span></span><br><span class=\"line\">        down=<span class=\"number\">0</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">0</span>,n):</span><br><span class=\"line\">            up += F(x[j]) * comP(i, x[j])</span><br><span class=\"line\">            down += comP(i, x[j]) * comP(i, x[j])</span><br><span class=\"line\">        res += comP(i, inp)*up / down</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res</span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">bsaerror</span>(<span class=\"params\">inp</span>):</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">abs</span>(bsa(inp)-F(inp))</span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">lsferror</span>(<span class=\"params\">inp</span>):</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">abs</span>(lsf(inp)-F(inp))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#å…¨å±€å˜é‡</span></span><br><span class=\"line\">x=[<span class=\"literal\">None</span>]*<span class=\"number\">200</span></span><br><span class=\"line\">fp=[<span class=\"literal\">None</span>]*<span class=\"number\">50</span></span><br><span class=\"line\">vispa=[<span class=\"number\">0</span>]*<span class=\"number\">100</span></span><br><span class=\"line\">vispb=[<span class=\"number\">0</span>]*<span class=\"number\">100</span></span><br><span class=\"line\">pa=[<span class=\"literal\">None</span>]*<span class=\"number\">200</span></span><br><span class=\"line\">pb=[<span class=\"literal\">None</span>]*<span class=\"number\">200</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#ä¸»å‡½æ•°æ®µ</span></span><br><span class=\"line\">a, b, c = <span class=\"built_in\">map</span>(<span class=\"built_in\">int</span>, <span class=\"built_in\">input</span>(<span class=\"string\">&quot;è¾“å…¥a,b,c: &quot;</span>).split())</span><br><span class=\"line\">n , k = <span class=\"built_in\">map</span>(<span class=\"built_in\">int</span>, <span class=\"built_in\">input</span>(<span class=\"string\">&quot;è¾“å…¥n,k: &quot;</span>).split())</span><br><span class=\"line\">m=<span class=\"built_in\">input</span>(<span class=\"string\">&quot;è¯·è¾“å…¥æµ‹è¯•ç»„æ•°ï¼š&quot;</span>)</span><br><span class=\"line\">tst = <span class=\"built_in\">input</span>(<span class=\"string\">&quot;è¯·è¾“å…¥æµ‹è¯•ç”¨ä¾‹ï¼š&quot;</span>).split()</span><br><span class=\"line\"></span><br><span class=\"line\">setup() <span class=\"comment\">#åˆå§‹åŒ–fpæ•°ç»„</span></span><br><span class=\"line\">cntpf() <span class=\"comment\">#åˆå§‹åŒ–fpæ•°ç»„</span></span><br><span class=\"line\"></span><br><span class=\"line\">bsax=<span class=\"built_in\">range</span>(<span class=\"built_in\">int</span>(a),<span class=\"built_in\">int</span>(b))</span><br><span class=\"line\">bsay=[]</span><br><span class=\"line\">bsae=<span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> bsax:</span><br><span class=\"line\">    bsay.append(bsa(i))</span><br><span class=\"line\">    </span><br><span class=\"line\">lsfx=<span class=\"built_in\">range</span>(<span class=\"built_in\">int</span>(a),<span class=\"built_in\">int</span>(b))</span><br><span class=\"line\">lsfy=[]</span><br><span class=\"line\">lsfe=<span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> lsfx:</span><br><span class=\"line\">    lsfy.append(lsf(i))</span><br><span class=\"line\">    </span><br><span class=\"line\">nx=<span class=\"built_in\">range</span>(<span class=\"built_in\">int</span>(a),<span class=\"built_in\">int</span>(b))</span><br><span class=\"line\">ny=[]</span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> nx:</span><br><span class=\"line\">    ny.append(F(i))</span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> tst:</span><br><span class=\"line\">    bsae+=bsaerror(<span class=\"built_in\">float</span>(i))</span><br><span class=\"line\">    lsfe+=lsferror(<span class=\"built_in\">float</span>(i))</span><br><span class=\"line\">bsae/=<span class=\"built_in\">float</span>(m)</span><br><span class=\"line\">lsfe/=<span class=\"built_in\">float</span>(m)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;æœ€ä½³å¹³æ–¹é€¼è¿‘çš„å¹³å‡è¯¯å·®ä¸º%f&#x27;</span>%bsae)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;æœ€å°äºŒä¹˜æ‹Ÿåˆçš„å¹³å‡è¯¯å·®ä¸º%f&#x27;</span>%lsfe)</span><br><span class=\"line\">plt.plot(bsax, bsay, label=<span class=\"string\">&#x27;æœ€ä½³å¹³æ–¹é€¼è¿‘&#x27;</span>, color=<span class=\"string\">&#x27;red&#x27;</span>)</span><br><span class=\"line\">plt.plot(lsfx, lsfy, label=<span class=\"string\">&#x27;æœ€å°äºŒä¹˜æ‹Ÿåˆ&#x27;</span>, color=<span class=\"string\">&#x27;blue&#x27;</span>)</span><br><span class=\"line\">plt.plot(nx, ny, label=<span class=\"string\">&#x27;åŸå‡½æ•°&#x27;</span>, color=<span class=\"string\">&#x27;orange&#x27;</span>)</span><br><span class=\"line\">plt.legend()</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;å‡½æ•°é€¼è¿‘å¯¹æ¯”å‡½æ•°&#x27;</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;x&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;y&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\n<h2 id=\"æ•°å€¼ç§¯åˆ†\">æ•°å€¼ç§¯åˆ†</h2>\n<p><strong>å®ç°å¤åŒ–æ¢¯å½¢å…¬å¼å’Œé¾™è´æ ¼ç®—æ³•è®¡ç®—ç§¯åˆ†ï¼Œå¹¶å®Œæˆä¸¤ç§æ–¹æ³•ä¹‹é—´çš„ç²¾åº¦å¯¹æ¯”ã€‚</strong><br>\n<font color=red>è¾“å…¥</font>ï¼šå‡½æ•°åŒºé—´ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>b</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[a, b]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mclose\">]</span></span></span></span>ï¼Œè¢«ç§¯å‡½æ•°ä¸º <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msqrt><mi>x</mi></msqrt><mi>l</mi><mi>n</mi><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">f(x) =\\sqrt{x}lnx</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.04em;vertical-align:-0.2397em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8003em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord mathnormal\">x</span></span></span><span style=\"top:-2.7603em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"1.08em\" viewBox=\"0 0 400000 1080\" preserveAspectRatio=\"xMinYMin slice\"><path d=\"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z\"/></svg></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2397em;\"><span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">x</span></span></span></span>ï¼Œå‚æ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span> ä½œä¸ºæ­¥é•¿ã€‚å‚æ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Îµ</mi></mrow><annotation encoding=\"application/x-tex\">Îµ</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">Îµ</span></span></span></span> ä½œä¸ºè¦æ±‚æ»¡è¶³çš„ç²¾åº¦æ¡ä»¶ã€‚<br>\n<font color=red>è¦æ±‚</font>ï¼šå–ä¸åŒçš„æ­¥é•¿ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>ï¼Œè¦æ±‚ç”¨å¤åŒ–æ¢¯å½¢å…¬å¼å’Œé¾™è´æ ¼ç®—æ³•åˆ†åˆ«è®¡ç®—ç§¯åˆ†å€¼è®¡ç®—å½“ç²¾åº¦è¾¾åˆ° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Îµ</mi></mrow><annotation encoding=\"application/x-tex\">Îµ</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">Îµ</span></span></span></span> æ—¶ï¼Œæ‰€éœ€è¦ç­‰åˆ†ç§¯åˆ†åŒºé—´çš„æ¬¡æ•°ï¼ˆå‡è®¾æ¯æ¬¡éƒ½æ˜¯äºŒç­‰åˆ†ï¼‰åŠ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span> çš„å¤§å°ã€‚å½“è¾¾åˆ°ç²¾åº¦è¦æ±‚æ—¶ï¼Œå¯¹æ¯”ä¸¤ç§æ–¹æ³•éœ€è¦åˆ’åˆ†æ¬¡æ•°åŠæ­¥é•¿ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span> çš„å¤§å°ã€‚<br>\n<font color=red>è¾“å‡º</font>ï¼šæ•°å€¼ç§¯åˆ†è®¡ç®—ç»“æœï¼Œåˆ’åˆ†æ¬¡æ•°ï¼Œæ­¥é•¿ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span> çš„å¤§å°ã€‚</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> math</span><br><span class=\"line\"><span class=\"comment\">#åˆå§‹åŒ–å˜é‡</span></span><br><span class=\"line\">vis = [[<span class=\"number\">0</span> <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1000</span>)] <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1000</span>)]</span><br><span class=\"line\">T = [[<span class=\"number\">0</span> <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1000</span>)] <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1000</span>)]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">f</span>(<span class=\"params\">x</span>):</span><br><span class=\"line\">    res=math.sqrt(x)*math.log(x,math.e)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">F</span>(<span class=\"params\">x</span>):</span><br><span class=\"line\">    x3=x*x*x</span><br><span class=\"line\">    res=<span class=\"number\">2</span>*math.log(x,math.e)*math.sqrt(x3)/<span class=\"number\">3</span>-<span class=\"number\">4</span>*math.sqrt(x3)/<span class=\"number\">9</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> res</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#ä½¿ç”¨ç‰›é¡¿è±å¸ƒå°¼èŒ¨å…¬å¼ç›´æ¥ç§¯åˆ†</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">Fitg</span>(<span class=\"params\">a,b</span>):</span><br><span class=\"line\">    res=F(b)-F(a)</span><br><span class=\"line\">    <span class=\"keyword\">return</span>  res</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#ä½¿ç”¨å¤åˆæ¢¯å½¢æ±‚ç§¯å…¬å¼ç›´æ¥ç§¯åˆ†</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">ctqf</span>(<span class=\"params\">n</span>):</span><br><span class=\"line\">    h=(b-a)/n</span><br><span class=\"line\">    res=<span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> k <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(n):</span><br><span class=\"line\">        res+=f(a+k*h)+f(a+(k+<span class=\"number\">1</span>)*h)</span><br><span class=\"line\">    res=res*h/<span class=\"number\">2</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> res</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#è®¡ç®—Tçš„å€¼</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">cntT</span>(<span class=\"params\">m,k</span>):</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(vis[m][k]==<span class=\"number\">1</span>):</span><br><span class=\"line\">        <span class=\"keyword\">return</span> T[m][k]</span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        vis[m][k] == <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>(m==<span class=\"number\">0</span> <span class=\"keyword\">and</span> k==<span class=\"number\">0</span>):</span><br><span class=\"line\">            T[m][k]=(b-a)*(f(a)+f(b))/<span class=\"number\">2</span></span><br><span class=\"line\">        <span class=\"keyword\">elif</span>(m==<span class=\"number\">0</span>):</span><br><span class=\"line\">            n=<span class=\"number\">1</span>&lt;&lt;(k-<span class=\"number\">1</span>)</span><br><span class=\"line\">            h=(b-a)/n</span><br><span class=\"line\">            sm=<span class=\"number\">0</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(n):</span><br><span class=\"line\">                sm+=f(a+(<span class=\"number\">2</span>*i+<span class=\"number\">1</span>)*h/<span class=\"number\">2</span>)</span><br><span class=\"line\">            sm=sm*h/<span class=\"number\">2</span></span><br><span class=\"line\">            T[m][k]=cntT(m,k-<span class=\"number\">1</span>)/<span class=\"number\">2</span>+sm</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            fourm=math.<span class=\"built_in\">pow</span>(<span class=\"number\">4</span>,m)</span><br><span class=\"line\">            T[m][k]=fourm*cntT(m-<span class=\"number\">1</span>,k+<span class=\"number\">1</span>)/(fourm-<span class=\"number\">1</span>)-cntT(m-<span class=\"number\">1</span>,k)/(fourm-<span class=\"number\">1</span>)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> T[m][k]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#ä½¿ç”¨é¾™è´æ ¼ç§¯åˆ†æ±‚ç§¯</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">Romberg</span>(<span class=\"params\">m</span>):</span><br><span class=\"line\">    <span class=\"keyword\">return</span> cntT(m,<span class=\"number\">0</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">a,b =<span class=\"built_in\">map</span>(<span class=\"built_in\">float</span>,<span class=\"built_in\">input</span>(<span class=\"string\">&quot;è¯·è¾“å…¥ç§¯åˆ†åŒºé—´a,b: &quot;</span>).split())</span><br><span class=\"line\">e=<span class=\"built_in\">float</span>(<span class=\"built_in\">input</span>(<span class=\"string\">&quot;è¯·è¾“å…¥ç²¾åº¦æ¡ä»¶e: &quot;</span>))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> k <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1000</span>):</span><br><span class=\"line\">    n=<span class=\"number\">1</span>&lt;&lt;k</span><br><span class=\"line\">    eps=<span class=\"built_in\">abs</span>(ctqf(n)-Fitg(a,b))</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(eps&lt;e):</span><br><span class=\"line\">        h=(b-a)/n</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;å¤åˆæ¢¯å½¢æ±‚ç§¯å…¬å¼çš„è®¡ç®—ç»“æœä¸ºï¼š%f&#x27;</span>%(ctqf(n)))</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;åˆ’åˆ†æ¬¡æ•°ä¸ºï¼š%d&#x27;</span>%(k))</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;æ­¥é•¿ä¸ºï¼š%f&#x27;</span> % (h))</span><br><span class=\"line\">        <span class=\"keyword\">break</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> k <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1</span>,<span class=\"number\">1000</span>):</span><br><span class=\"line\">    n=<span class=\"number\">1</span>&lt;&lt;k</span><br><span class=\"line\">    eps=<span class=\"built_in\">abs</span>(Romberg(k)-Romberg(k-<span class=\"number\">1</span>))</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(eps&lt;e):</span><br><span class=\"line\">        h=(b-a)/n</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;é¾™è´æ ¼æ±‚ç§¯å…¬å¼çš„è®¡ç®—ç»“æœä¸ºï¼š%f&#x27;</span>%(Romberg(k)))</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;åˆ’åˆ†æ¬¡æ•°ä¸ºï¼š%d&#x27;</span>%(k))</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;æ­¥é•¿ä¸ºï¼š%f&#x27;</span> % (h))</span><br><span class=\"line\">        <span class=\"keyword\">break</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"çº¿æ€§æ–¹ç¨‹ç»„çš„ç›´æ¥è§£æ³•\">çº¿æ€§æ–¹ç¨‹ç»„çš„ç›´æ¥è§£æ³•</h2>\n<p><strong>1. ç¼–å†™åˆ—ä¸»å…ƒæ¶ˆå…ƒæ³•çš„é€šç”¨ç¨‹åºã€‚</strong><br>\n<font color=red>è¾“å…¥</font>ï¼šçŸ©é˜µ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span> å’Œå‘é‡ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>ã€‚<br>\n<font color=red>è¾“å‡º</font>ï¼šæ¶ˆå…ƒåçš„å¢å¹¿çŸ©é˜µåŠæ–¹ç¨‹ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mi>x</mi><mo>=</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">Ax=b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span> çš„æ ¹å€¼ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>x</mi><mo>âˆ—</mo></msup></mrow><annotation encoding=\"application/x-tex\">x^*</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6887em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">âˆ—</span></span></span></span></span></span></span></span></span></span></span>ã€‚<br>\n<font color=red>è¦æ±‚1</font>ï¼šé€‰å–è¿›è¡Œæµ‹è¯•ï¼Œæ‰“å°å‡ºä¸Šè¿°ç¨‹åºçš„è¾“å‡ºã€‚<br>\n<font color=red>è¦æ±‚2</font>ï¼šéšæœºç”Ÿæˆ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> é˜¶ï¼ˆ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>&gt;=20ï¼Œå…·ä½“å€¼è‡ªå®šï¼‰æ–¹é˜µ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>âˆ—</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">n*1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4653em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> ç»´éé›¶å‘é‡ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>ï¼Œæ±‚è§£ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>ã€‚</p>\n<p><strong>2. ç¼–å†™ä½¿ç”¨LUåˆ†è§£æ³•æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„çš„é€šç”¨ç¨‹åºã€‚</strong><br>\n<font color=red>è¾“å…¥</font>ï¼šçŸ©é˜µ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span> å’Œå‘é‡ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>ã€‚<br>\n<font color=red>è¾“å‡º</font>ï¼šå¯¹çŸ©é˜µ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span> è¿›è¡Œ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mi>U</mi></mrow><annotation encoding=\"application/x-tex\">LU</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">LU</span></span></span></span> åˆ†è§£åçš„ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span> å’Œ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>U</mi></mrow><annotation encoding=\"application/x-tex\">U</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span></span></span></span>ï¼Œä»¥åŠæ–¹ç¨‹ç»„çš„æ ¹å€¼ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>x</mi><mo>âˆ—</mo></msup></mrow><annotation encoding=\"application/x-tex\">x^*</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6887em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">âˆ—</span></span></span></span></span></span></span></span></span></span></span>ã€‚<br>\n<font color=red>è¦æ±‚1</font>ï¼šé€‰å–è¿›è¡Œæµ‹è¯•ï¼Œæ‰“å°è¾“å‡ºç»“æœã€‚<br>\n<font color=red>è¦æ±‚2</font>ï¼šéšæœºç”Ÿæˆ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> é˜¶ï¼ˆ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>&gt;=20ï¼Œå…·ä½“å€¼è‡ªå®šï¼‰æ–¹é˜µ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>âˆ—</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">n*1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4653em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> ç»´éé›¶å‘é‡ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>ï¼Œæ±‚è§£ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>ã€‚</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;iostream&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;algorithm&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;ctime&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;random&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">int</span> n;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn=<span class=\"number\">200</span>;</span><br><span class=\"line\"><span class=\"type\">double</span> inA[maxn][maxn];</span><br><span class=\"line\"><span class=\"type\">double</span> A[maxn][maxn];</span><br><span class=\"line\"><span class=\"type\">double</span> L[maxn][maxn];</span><br><span class=\"line\"><span class=\"type\">double</span> U[maxn][maxn];</span><br><span class=\"line\"><span class=\"type\">double</span> ans[maxn];</span><br><span class=\"line\"><span class=\"type\">double</span> ansy[maxn];</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">Pivot</span><span class=\"params\">()</span></span>;<span class=\"comment\">//åˆ—ä¸»å…ƒæ¶ˆå…ƒæ³•</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">copyA</span><span class=\"params\">()</span></span>;<span class=\"comment\">//å°†è¾“å…¥çŸ©é˜µå¤åˆ¶ç»™A</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">printA</span><span class=\"params\">()</span></span>;<span class=\"comment\">//æ‰“å°çŸ©é˜µA</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">printb</span><span class=\"params\">()</span></span>;<span class=\"comment\">//æ‰“å°å‘é‡b</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">exc</span><span class=\"params\">(<span class=\"type\">int</span> i,<span class=\"type\">int</span> j)</span></span>;<span class=\"comment\">//äº¤æ¢è¡Œ</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">Minus</span><span class=\"params\">(<span class=\"type\">int</span> i,<span class=\"type\">int</span> j,<span class=\"type\">double</span> mult)</span></span>;<span class=\"comment\">//ç¬¬jè¡Œå‡ç¬¬iè¡Œ</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">printans</span><span class=\"params\">()</span></span>;<span class=\"comment\">//æ‰“å°ç­”æ¡ˆ</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">LU</span><span class=\"params\">()</span></span>;<span class=\"comment\">//LUåˆ†è§£æ³•</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">iscorrect</span><span class=\"params\">()</span></span>;<span class=\"comment\">//å›ä»£åˆ¤æ–­ç­”æ¡ˆæ˜¯å¦æ­£ç¡®</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">double</span> <span class=\"title\">gerandom</span><span class=\"params\">(<span class=\"type\">double</span> a,<span class=\"type\">double</span> b)</span></span>;<span class=\"comment\">//ç”Ÿæˆaåˆ°bdoubleç±»å‹çš„éšæœºæ•°</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> T;</span><br><span class=\"line\">     cout&lt;&lt;<span class=\"string\">&quot;please input T :&quot;</span>;</span><br><span class=\"line\">     cin&gt;&gt;T;</span><br><span class=\"line\">     <span class=\"keyword\">while</span> (T--)</span><br><span class=\"line\">     &#123;</span><br><span class=\"line\">         cout &lt;&lt; <span class=\"string\">&quot;please input n :&quot;</span>;</span><br><span class=\"line\">         cin &gt;&gt; n;</span><br><span class=\"line\">         cout &lt;&lt; <span class=\"string\">&quot;enter 1 if you want to use your own input or 2 if you want your input to be random&quot;</span>&lt;&lt;endl;</span><br><span class=\"line\">         <span class=\"type\">int</span> cho;</span><br><span class=\"line\">         cin&gt;&gt;cho;</span><br><span class=\"line\">         <span class=\"keyword\">if</span> (cho == <span class=\"number\">1</span>)</span><br><span class=\"line\">         &#123;</span><br><span class=\"line\">             cout &lt;&lt; <span class=\"string\">&quot;please input matrix A :&quot;</span> &lt;&lt; endl;</span><br><span class=\"line\">             <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">             &#123;</span><br><span class=\"line\">                 <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">1</span>; j &lt;= n; j++)</span><br><span class=\"line\">                 &#123;</span><br><span class=\"line\">                     cin &gt;&gt; inA[i][j];</span><br><span class=\"line\">                 &#125;</span><br><span class=\"line\">             &#125;</span><br><span class=\"line\">             cout &lt;&lt; <span class=\"string\">&quot;please input vector b :&quot;</span> &lt;&lt; endl;</span><br><span class=\"line\">             <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">             &#123;</span><br><span class=\"line\">                 cin &gt;&gt; inA[i][n + <span class=\"number\">1</span>];</span><br><span class=\"line\">             &#125;</span><br><span class=\"line\">         &#125;</span><br><span class=\"line\">         <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">            <span class=\"type\">double</span> a,b;</span><br><span class=\"line\">            cout &lt;&lt; <span class=\"string\">&quot;please input the range of the random number :&quot;</span> &lt;&lt; endl;</span><br><span class=\"line\">            cin&gt;&gt;a&gt;&gt;b;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">             &#123;</span><br><span class=\"line\">                 <span class=\"keyword\">for</span> (<span class=\"type\">int</span> j = <span class=\"number\">1</span>; j &lt;= n; j++)</span><br><span class=\"line\">                 &#123;</span><br><span class=\"line\">                    inA[i][j]=<span class=\"built_in\">gerandom</span>(a,b);</span><br><span class=\"line\">                 &#125;</span><br><span class=\"line\">             &#125;</span><br><span class=\"line\">             <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)</span><br><span class=\"line\">             &#123;</span><br><span class=\"line\">                inA[i][n + <span class=\"number\">1</span>]=<span class=\"built_in\">gerandom</span>(a,b);</span><br><span class=\"line\">             &#125;</span><br><span class=\"line\">         &#125;</span><br><span class=\"line\">         cout &lt;&lt; <span class=\"string\">&quot;enter 1-Pivot or 2-LU:&quot;</span> &lt;&lt; endl;</span><br><span class=\"line\">         cin&gt;&gt;cho;</span><br><span class=\"line\">         <span class=\"keyword\">if</span>(cho==<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">            <span class=\"built_in\">Pivot</span>();</span><br><span class=\"line\">         &#125;</span><br><span class=\"line\">         <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">            <span class=\"built_in\">LU</span>();</span><br><span class=\"line\">         &#125;</span><br><span class=\"line\">         <span class=\"built_in\">printans</span>();</span><br><span class=\"line\">         <span class=\"built_in\">iscorrect</span>();</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">printA</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">1</span>;j&lt;=n;j++)&#123;</span><br><span class=\"line\">            cout&lt;&lt;inA[i][j]&lt;&lt;<span class=\"string\">&quot; &quot;</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        cout&lt;&lt;endl;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">copyA</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">1</span>;j&lt;=n<span class=\"number\">+1</span>;j++)&#123;</span><br><span class=\"line\">            A[i][j]=inA[i][j];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">exc</span><span class=\"params\">(<span class=\"type\">int</span> i,<span class=\"type\">int</span> j)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> k=<span class=\"number\">1</span>;k&lt;=n<span class=\"number\">+1</span>;k++)&#123;</span><br><span class=\"line\">        <span class=\"built_in\">swap</span>(A[i][k],A[j][k]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">Minus</span><span class=\"params\">(<span class=\"type\">int</span> i,<span class=\"type\">int</span> j,<span class=\"type\">double</span> mult)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> k=<span class=\"number\">1</span>;k&lt;=n<span class=\"number\">+1</span>;k++)&#123;</span><br><span class=\"line\">        A[j][k]-=A[i][k]*mult;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">printans</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)&#123;</span><br><span class=\"line\">        cout&lt;&lt;ans[i]&lt;&lt;<span class=\"string\">&quot; &quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout&lt;&lt;endl;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">Pivot</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">copyA</span>();</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> t=<span class=\"number\">1</span>;t&lt;=n<span class=\"number\">-1</span>;t++)&#123;</span><br><span class=\"line\">        <span class=\"type\">double</span> nman=<span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> maxi=<span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=t;i&lt;=n;i++)&#123;</span><br><span class=\"line\">            <span class=\"type\">double</span> tp=<span class=\"built_in\">abs</span>(A[i][t]);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(tp&gt;=nman)&#123;</span><br><span class=\"line\">                maxi=i;</span><br><span class=\"line\">                nman=tp;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">exc</span>(t,maxi);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=t<span class=\"number\">+1</span>;i&lt;=n;i++)&#123;</span><br><span class=\"line\">            <span class=\"type\">double</span> multi=A[i][t]/A[t][t];</span><br><span class=\"line\">            <span class=\"built_in\">Minus</span>(t,i,multi);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> t=n;t&gt;=<span class=\"number\">1</span>;t--)&#123;</span><br><span class=\"line\">        <span class=\"type\">double</span> right=A[t][n<span class=\"number\">+1</span>];</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=n;j&gt;t;j--)&#123;</span><br><span class=\"line\">            right-=A[t][j]*ans[j];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        ans[t]=right/A[t][t];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">iscorrect</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> tag=<span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)&#123;</span><br><span class=\"line\">        <span class=\"type\">double</span> myans=<span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">1</span>;j&lt;=n;j++)&#123;</span><br><span class=\"line\">            myans+=inA[i][j]*ans[j];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(<span class=\"built_in\">abs</span>(myans-inA[i][n<span class=\"number\">+1</span>])&gt;=<span class=\"number\">1e-4</span>)&#123;</span><br><span class=\"line\">            tag=<span class=\"number\">0</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(tag)&#123;</span><br><span class=\"line\">        cout&lt;&lt;<span class=\"string\">&quot;answer is correct!&quot;</span>&lt;&lt;endl;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">        cout&lt;&lt;<span class=\"string\">&quot;answer is wrong!&quot;</span>&lt;&lt;endl;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">LU</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">copyA</span>();</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)&#123;</span><br><span class=\"line\">        U[<span class=\"number\">1</span>][i]=A[<span class=\"number\">1</span>][i];</span><br><span class=\"line\">        L[i][i]=<span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">2</span>;i&lt;=n;i++)&#123;</span><br><span class=\"line\">        L[i][<span class=\"number\">1</span>]=A[i][<span class=\"number\">1</span>]/U[<span class=\"number\">1</span>][<span class=\"number\">1</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> r=<span class=\"number\">2</span>;r&lt;=n;r++)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=r;i&lt;=n;i++)&#123;</span><br><span class=\"line\">            <span class=\"type\">double</span> tplu=<span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"type\">int</span> k=<span class=\"number\">1</span>;k&lt;=r<span class=\"number\">-1</span>;k++)&#123;</span><br><span class=\"line\">                tplu+=L[r][k]*U[k][i];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            U[r][i]=A[r][i]-tplu;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(r!=n)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=r<span class=\"number\">+1</span>;i&lt;=n;i++)&#123;</span><br><span class=\"line\">                <span class=\"type\">double</span> tplu=<span class=\"number\">0</span>;</span><br><span class=\"line\">                <span class=\"keyword\">for</span>(<span class=\"type\">int</span> k=<span class=\"number\">1</span>;k&lt;=r<span class=\"number\">-1</span>;k++)&#123;</span><br><span class=\"line\">                    tplu+=L[i][k]*U[k][r];</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                L[i][r]=(A[i][r]-tplu)/U[r][r];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ansy[<span class=\"number\">1</span>]=A[<span class=\"number\">1</span>][n<span class=\"number\">+1</span>];</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">2</span>;i&lt;=n;i++)&#123;</span><br><span class=\"line\">        <span class=\"type\">double</span> tply=<span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> k=<span class=\"number\">1</span>;k&lt;=i<span class=\"number\">-1</span>;k++)&#123;</span><br><span class=\"line\">            tply+=L[i][k]*ansy[k];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        ansy[i]=A[i][n<span class=\"number\">+1</span>]-tply;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ans[n]=ansy[n]/U[n][n];</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=n<span class=\"number\">-1</span>;i&gt;=<span class=\"number\">1</span>;i--)&#123;</span><br><span class=\"line\">        <span class=\"type\">double</span> tpux=<span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> k=i<span class=\"number\">+1</span>;k&lt;=n;k++)&#123;</span><br><span class=\"line\">            tpux+=U[i][k]*ans[k];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        ans[i]=(ansy[i]-tpux)/U[i][i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">double</span> <span class=\"title\">gerandom</span><span class=\"params\">(<span class=\"type\">double</span> a,<span class=\"type\">double</span> b)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">static</span> random_device rd;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"type\">static</span> mt19937 <span class=\"title\">gen</span><span class=\"params\">(rd())</span></span>;</span><br><span class=\"line\">    <span class=\"function\">uniform_real_distribution&lt;<span class=\"type\">double</span>&gt; <span class=\"title\">dis</span><span class=\"params\">(a, b)</span></span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">dis</span>(gen);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"çº¿æ€§æ–¹ç¨‹ç»„çš„è¿­ä»£è§£æ³•\">çº¿æ€§æ–¹ç¨‹ç»„çš„è¿­ä»£è§£æ³•</h2>\n<p><strong>1. ç¼–å†™é«˜æ–¯-å¡å¾·å°”è¿­ä»£å’ŒSORè¿­ä»£çš„é€šç”¨ç¨‹åºã€‚</strong><br>\n<font color=red>è¾“å…¥</font>ï¼šçŸ©é˜µAå’Œå‘é‡bï¼Œè¿­ä»£åˆå€¼x0ï¼Œè¿­ä»£æœ€å¤§æ­¥æ•°Kï¼Œè¯¯å·®æ§åˆ¶ã€‚å¯¹äºè¶…æ¾å¼›è¿­ä»£ï¼Œè¿˜éœ€è¾“å…¥æ¾å¼›å› å­ã€‚<br>\n<font color=red>è¾“å‡º</font>ï¼šè¿­ä»£æ­¥æ•°åŠæ–¹ç¨‹ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mi>x</mi><mo>=</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">Ax=b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span> çš„æ ¹å€¼ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>x</mi><mo>âˆ—</mo></msup></mrow><annotation encoding=\"application/x-tex\">x^*</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6887em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">âˆ—</span></span></span></span></span></span></span></span></span></span></span>ã€‚<br>\n<font color=red>è¦æ±‚</font>ï¼š<br>\n(1)é€‰å–è¿›è¡Œæµ‹è¯•ï¼Œå–åˆå€¼x<sup>(0)</sup>=0ï¼Œè¯¯å·®æ§åˆ¶=10<sup>-8</sup>ï¼Œæ‰“å°å‡ºä¸¤ç§è¿­ä»£æ–¹æ³•çš„è¾“å‡ºã€‚<br>\n(2)å–æ¾å¼›å› å­ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>=</mo><mfrac><mi>i</mi><mn>50</mn></mfrac></mrow><annotation encoding=\"application/x-tex\">=\\frac{i}{50}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2007em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8557em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">50</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>=1,2,â€¦99,æ‰“å°è¿­ä»£æ­¥æ•°ï¼Œå¹¶ç»™å‡ºä¸€ä¸ªæœ€ä½³å€¼ã€‚</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;iostream&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;algorithm&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;cmath&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> maxn = <span class=\"number\">1000</span>;</span><br><span class=\"line\"><span class=\"type\">double</span> a[maxn][maxn];</span><br><span class=\"line\"><span class=\"type\">double</span> b[maxn];</span><br><span class=\"line\"><span class=\"type\">double</span> xk[maxn];</span><br><span class=\"line\"><span class=\"type\">double</span> xk1[maxn];</span><br><span class=\"line\"><span class=\"type\">int</span> n;</span><br><span class=\"line\"><span class=\"type\">int</span> K;</span><br><span class=\"line\"><span class=\"type\">double</span> w;</span><br><span class=\"line\"><span class=\"type\">double</span> eps;</span><br><span class=\"line\"><span class=\"type\">double</span> mf;</span><br><span class=\"line\"><span class=\"type\">double</span> nstep;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">setxk0</span><span class=\"params\">()</span></span>;<span class=\"comment\">//åˆå§‹åŒ–xk0</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">movk</span><span class=\"params\">()</span></span>;<span class=\"comment\">//å°†xk1èµ‹å€¼ç»™xk</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">double</span> <span class=\"title\">cntloss</span><span class=\"params\">()</span></span>;<span class=\"comment\">//è®¡ç®—detx</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">SOR</span><span class=\"params\">(<span class=\"type\">double</span> w)</span></span>;<span class=\"comment\">//è¶…æ¾å¼›è¿­ä»£æ³•</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">printx</span><span class=\"params\">()</span></span>;<span class=\"comment\">//æ‰“å°x</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">iscorrect</span><span class=\"params\">()</span></span>;<span class=\"comment\">//å›ä»£éªŒè¯ç­”æ¡ˆæ˜¯å¦æ­£ç¡®</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    cout&lt;&lt;<span class=\"string\">&quot;input max step K : &quot;</span>;</span><br><span class=\"line\">    cin&gt;&gt;K;</span><br><span class=\"line\">    cout&lt;&lt;<span class=\"string\">&quot;input eps  : &quot;</span>;</span><br><span class=\"line\">    cin&gt;&gt;eps;</span><br><span class=\"line\">    cout&lt;&lt;<span class=\"string\">&quot;input the size of A  : &quot;</span>;</span><br><span class=\"line\">    cin&gt;&gt;n;</span><br><span class=\"line\">    cout&lt;&lt;<span class=\"string\">&quot;matrix A :&quot;</span>&lt;&lt;endl;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">1</span>;j&lt;=n;j++)&#123;</span><br><span class=\"line\">            cin&gt;&gt;a[i][j];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout&lt;&lt;<span class=\"string\">&quot;vector b :&quot;</span>&lt;&lt;endl;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)&#123;</span><br><span class=\"line\">        cin&gt;&gt;b[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout&lt;&lt;<span class=\"string\">&quot;enter 1 if you want to test one w&quot;</span>&lt;&lt;endl;</span><br><span class=\"line\">    cout&lt;&lt;<span class=\"string\">&quot;or 2 if you want to find the best w&quot;</span>&lt;&lt;endl;</span><br><span class=\"line\">    cout&lt;&lt;<span class=\"string\">&quot;enter : &quot;</span>;</span><br><span class=\"line\">    cin&gt;&gt;mf;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(mf==<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">        cout&lt;&lt;<span class=\"string\">&quot;input Relaxation factor w  : &quot;</span>;</span><br><span class=\"line\">        cin&gt;&gt;w;</span><br><span class=\"line\">        <span class=\"built_in\">SOR</span>(w);</span><br><span class=\"line\">        <span class=\"built_in\">printx</span>();</span><br><span class=\"line\">        <span class=\"built_in\">iscorrect</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> bst=K<span class=\"number\">+1</span>;</span><br><span class=\"line\">        <span class=\"type\">double</span> bsw=<span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=<span class=\"number\">99</span>;i++)&#123;</span><br><span class=\"line\">            <span class=\"type\">double</span> ii = (<span class=\"type\">double</span>)i;</span><br><span class=\"line\">            <span class=\"type\">double</span> nw=ii/(<span class=\"type\">double</span>)<span class=\"number\">50</span>;</span><br><span class=\"line\">            cout&lt;&lt;<span class=\"string\">&quot;now i is &quot;</span>&lt;&lt;i&lt;&lt;endl;</span><br><span class=\"line\">            <span class=\"built_in\">SOR</span>(nw);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(nstep&lt;bst)&#123;</span><br><span class=\"line\">                bst = nstep;</span><br><span class=\"line\">                bsw=nw;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        cout&lt;&lt;<span class=\"string\">&quot;the best w is &quot;</span>&lt;&lt;bsw&lt;&lt;endl;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">setxk0</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)&#123;</span><br><span class=\"line\">        xk[i]=<span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">movk</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)&#123;</span><br><span class=\"line\">        xk[i]=xk1[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">double</span> <span class=\"title\">cntloss</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">double</span> res = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)&#123;</span><br><span class=\"line\">        <span class=\"type\">double</span> tp = <span class=\"built_in\">abs</span>(xk1[i]-xk[i]);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(tp&gt;res)&#123;</span><br><span class=\"line\">            res = tp;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">printx</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)&#123;</span><br><span class=\"line\">        cout&lt;&lt;xk1[i]&lt;&lt;<span class=\"string\">&quot; &quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout&lt;&lt;endl;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">iscorrect</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> flag = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)&#123;</span><br><span class=\"line\">        <span class=\"type\">double</span> s=<span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">1</span>;j&lt;=n;j++)&#123;</span><br><span class=\"line\">            s+=a[i][j]*xk1[j];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(<span class=\"built_in\">abs</span>(s-b[i])&gt;<span class=\"number\">1e-3</span>)&#123;</span><br><span class=\"line\">            flag=<span class=\"number\">0</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(flag)&#123;</span><br><span class=\"line\">        cout&lt;&lt;<span class=\"string\">&quot;answer is correct!&quot;</span>&lt;&lt;endl;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">        cout&lt;&lt;<span class=\"string\">&quot;answer is wrong!&quot;</span>&lt;&lt;endl;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">SOR</span><span class=\"params\">(<span class=\"type\">double</span> w)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">setxk0</span>();</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> step=<span class=\"number\">1</span>;step&lt;=K;step++)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)&#123;</span><br><span class=\"line\">            <span class=\"type\">double</span> s1 = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"type\">double</span> s2 = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=<span class=\"number\">1</span>;j&lt;=i<span class=\"number\">-1</span>;j++)&#123;</span><br><span class=\"line\">                s1+=a[i][j]*xk1[j];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j=i;j&lt;=n;j++)&#123;</span><br><span class=\"line\">                s2+=a[i][j]*xk[j];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            xk1[i]=xk[i]+w*(b[i]-s1-s2)/a[i][i];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(<span class=\"built_in\">cntloss</span>()&lt;eps)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(mf==<span class=\"number\">2</span>)&#123;</span><br><span class=\"line\">                nstep = step;</span><br><span class=\"line\">                cout&lt;&lt;<span class=\"string\">&quot;the step is &quot;</span>&lt;&lt;step&lt;&lt;endl;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">            <span class=\"built_in\">movk</span>();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"éçº¿æ€§æ–¹ç¨‹ï¼ˆç»„ï¼‰çš„æ•°å€¼è§£æ³•\">éçº¿æ€§æ–¹ç¨‹ï¼ˆç»„ï¼‰çš„æ•°å€¼è§£æ³•</h2>\n<p><strong>1. ç¼–å†™ä¸åŠ¨ç‚¹è¿­ä»£ã€æ–¯ç‰¹èŠ¬æ£®åŠ é€Ÿè¿­ä»£å’Œç‰›é¡¿è¿­ä»£çš„é€šç”¨ç¨‹åºã€‚</strong><br>\n<font color=red>è¦æ±‚</font>ï¼š<br>\n(1)è®¾è®¡ä¸€ç§ä¸åŠ¨ç‚¹è¿­ä»£æ ¼å¼ï¼Œæ±‚è§£å‡½æ•° <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>x</mi><mn>2</mn></msup><mo>âˆ’</mo><mn>3</mn><mi>x</mi><mo>+</mo><mn>2</mn><mo>âˆ’</mo><msup><mi>e</mi><mi>x</mi></msup></mrow><annotation encoding=\"application/x-tex\">f(x)=x^2-3x+2-e^x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8974em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">3</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span></span></span></span> å’Œ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>x</mi><mn>3</mn></msup><mo>+</mo><mn>2</mn><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mn>10</mn><mi>x</mi><mo>âˆ’</mo><mn>20</mn></mrow><annotation encoding=\"application/x-tex\">g(x)=x^3+2x^2+10x-20</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8974em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8974em;vertical-align:-0.0833em;\"></span><span class=\"mord\">2</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">10</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">20</span></span></span></span> çš„æ ¹ï¼Œè¦æ±‚è¯¥è¿­ä»£æ ¼å¼æ”¶æ•›ã€‚ç„¶åå†ä½¿ç”¨æ–¯ç‰¹èŠ¬æ£®åŠ é€Ÿè¿­ä»£ï¼Œè®¡ç®—åˆ° |x<sub>k</sub>-x<sub>k-1</sub>|&lt;10<sup>-8</sup> ä¸ºæ­¢ã€‚<br>\n(2)ç”¨ç‰›é¡¿è¿­ä»£ï¼ŒåŒæ ·è®¡ç®—åˆ° |x<sub>k</sub>-x<sub>k-1</sub>|&lt;10<sup>-8</sup> ã€‚è¾“å‡ºè¿­ä»£åˆå€¼ã€è¿­ä»£æ¬¡æ•°åŠå„æ¬¡è¿­ä»£å€¼ï¼Œæ¯”è¾ƒæ–¹æ³•ä¼˜åŠ£ã€‚</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><strong>2. æœ¬ç« è®¡ç®—å®ä¹ é¢˜3ã€‚</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>","tags":["Python","æ•°å€¼è®¡ç®—æ–¹æ³•","å®éªŒè®°å½•"]},{"title":"æ²ˆé˜³","url":"/post/7ef69597.html","content":""},{"title":"æ•°æ®åº“è¯¾ç¨‹å®è·µ","url":"/post/73de793a.html","content":"<hr>\n<ul>\n<li>å¤©æ´¥å¤§å­¦ 2024 æ•°æ®åº“è¯¾ç¨‹å®è·µ</li>\n<li>Lab Memberï¼šæµ·æ£ æœªé›¨ï¼Œæ¢¨èŠ±å…ˆé›ªï¼Œæµè¤æŸ“å¤</li>\n<li>æœ€ç»ˆæˆç»© 91 åˆ†æ ğŸ˜‹</li>\n</ul>\n<hr>\n<p>æŠ¥å‘Šå¦‚ä¸‹ï¼š</p>\n\n\n\t<div class=\"row\">\n    <embed src=\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/pdf/æ•°æ®åº“å®è·µ/æ•°æ®åº“å®è·µæŠ¥å‘Š.pdf\" width=\"100%\" height=\"550\" type=\"application/pdf\">\n\t</div>\n\n\n\n<p>ç­”è¾©PPTå¦‚ä¸‹ï¼š</p>\n\n\n\t<div class=\"row\">\n    <embed src=\"https://cdn.jsdelivr.net/gh/HaydenZHY/jsdelivr@main/pdf/æ•°æ®åº“å®è·µ/æ±‡æŠ¥PPT.pdf\" width=\"100%\" height=\"550\" type=\"application/pdf\">\n\t</div>\n\n\n\n<p>æºç å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">--å…ˆåˆ å…³ç³»è¡¨</span></span><br><span class=\"line\"><span class=\"comment\">--äº¤æ˜“ç³»ç»Ÿå…³ç³»è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> sell;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> hold_ ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> order_ ;</span><br><span class=\"line\"><span class=\"comment\">--ç”¨æˆ·ç³»ç»Ÿå…³ç³»è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> consumer_get_coupon ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> consumer_recieve_redpacket ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> consumer_register_address ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> friendship ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> fan ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> user_focus_user ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> manage_subaccount ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> shopping_cart ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> <span class=\"keyword\">collect</span> ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> watching_history ;</span><br><span class=\"line\"><span class=\"comment\">--èŠå¤©ç³»ç»Ÿå…³ç³»è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> friend_and_friend ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> seller_and_agent ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> consumer_and_agent ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> consumer_and_seller ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> member_and_member ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> group_members ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> friend_request ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> group_request ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> reply ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> consumer_give_evaluation ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> consumer_ask_question ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> consumer_reply_question ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> consumer_focus_question ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> consumer_have_archive ;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">--å†åˆ å®ä½“è¡¨</span></span><br><span class=\"line\"><span class=\"comment\">--äº¤æ˜“ç³»ç»Ÿå®ä½“è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> mark ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> logistics ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> food ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> cloth ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> ele_appliment ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> ele_product ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> makeup ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> sport ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> toy ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> daily_necessarity ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> discount ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> store ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> commodity ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> historical_price ;</span><br><span class=\"line\"><span class=\"comment\">--ç”¨æˆ·ç³»ç»Ÿå®ä½“è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> red_packet ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> taobao_history ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> address ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> archive ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> coupon ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> users ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> consumer ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> seller ;</span><br><span class=\"line\"><span class=\"comment\">--èŠå¤©ç³»ç»Ÿå®ä½“è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> official_agent ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> <span class=\"keyword\">groups</span> ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> message ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> conversation_message ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> group_message ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> request ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> evaluation ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> comments ;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> IF <span class=\"keyword\">EXISTS</span> question ;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">--åˆ›å»ºåº—é“ºè¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> store(</span><br><span class=\"line\">   store_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">   store_name <span class=\"type\">VARCHAR</span>(<span class=\"number\">30</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">   tag <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">   profile_photo  <span class=\"type\">VARCHAR</span>(<span class=\"number\">500</span>),</span><br><span class=\"line\">   seller_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">   address <span class=\"type\">VARCHAR</span>(<span class=\"number\">50</span>),</span><br><span class=\"line\">   sales <span class=\"type\">DOUBLE PRECISION</span>,</span><br><span class=\"line\">   vis_num <span class=\"type\">INT</span>,</span><br><span class=\"line\">   ord_num <span class=\"type\">INT</span>,</span><br><span class=\"line\">   tr_rate <span class=\"type\">INT</span>,</span><br><span class=\"line\">   candidate_num <span class=\"type\">INT</span>,</span><br><span class=\"line\">   Lv <span class=\"type\">INT</span>,</span><br><span class=\"line\">   credit <span class=\"type\">INT</span>,</span><br><span class=\"line\">   ct_time <span class=\"type\">TIMESTAMP</span>,</span><br><span class=\"line\">   sub_account <span class=\"type\">INT</span></span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">--åˆ›å»ºå•†å“è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> commodity(</span><br><span class=\"line\">    com_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">    com_name <span class=\"type\">VARCHAR</span>(<span class=\"number\">30</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    category <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    price <span class=\"type\">DOUBLE PRECISION</span>,</span><br><span class=\"line\">\tdis_price <span class=\"type\">DOUBLE PRECISION</span>,</span><br><span class=\"line\">    num <span class=\"type\">INT</span>,</span><br><span class=\"line\">    description <span class=\"type\">VARCHAR</span>(<span class=\"number\">500</span>),</span><br><span class=\"line\">    detail <span class=\"type\">VARCHAR</span>(<span class=\"number\">2000</span>),</span><br><span class=\"line\">    after_sale <span class=\"type\">VARCHAR</span>(<span class=\"number\">100</span>),</span><br><span class=\"line\">    up_time <span class=\"type\">TIMESTAMP</span>,</span><br><span class=\"line\">    com_image <span class=\"type\">VARCHAR</span>(<span class=\"number\">500</span>)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">--åˆ›å»ºæ´»åŠ¨è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> discount(</span><br><span class=\"line\">    dis_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">    st_time <span class=\"type\">TIMESTAMP</span>,</span><br><span class=\"line\">    end_time <span class=\"type\">TIMESTAMP</span>,</span><br><span class=\"line\">    allowance <span class=\"type\">DOUBLE PRECISION</span></span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">--åˆ›å»ºå•†å“å†å²ä»·æ ¼è¡¨ï¼ˆå¼±å®ä½“ï¼‰</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> historical_price(</span><br><span class=\"line\">\tcom_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">\t<span class=\"type\">time</span> <span class=\"type\">TIMESTAMP</span>,</span><br><span class=\"line\">\tprice <span class=\"type\">DOUBLE PRECISION</span></span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">--åˆ›å»ºåº—é“ºè¯„åˆ†ï¼ˆå¼±å®ä½“ï¼‰</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> mark(</span><br><span class=\"line\">    store_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">    quality <span class=\"type\">DOUBLE PRECISION</span>,</span><br><span class=\"line\">    service <span class=\"type\">DOUBLE PRECISION</span>,</span><br><span class=\"line\">    distribution <span class=\"type\">DOUBLE PRECISION</span>,</span><br><span class=\"line\">    com_score <span class=\"type\">DOUBLE PRECISION</span></span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">--åˆ›å»ºå•†å“ç‰©æµï¼ˆå¼±å®ä½“ï¼‰</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> logistics(</span><br><span class=\"line\">    com_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">    deadline <span class=\"type\">TIMESTAMP</span>,</span><br><span class=\"line\">    price <span class=\"type\">DOUBLE PRECISION</span>,</span><br><span class=\"line\">    comp_name <span class=\"type\">VARCHAR</span>(<span class=\"number\">100</span>),</span><br><span class=\"line\">    send_addr <span class=\"type\">VARCHAR</span>(<span class=\"number\">50</span>),</span><br><span class=\"line\">    receive_addr <span class=\"type\">VARCHAR</span>(<span class=\"number\">50</span>)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">--å•†å“å­ç±»è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> food(</span><br><span class=\"line\">    com_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">    com_name <span class=\"type\">VARCHAR</span>(<span class=\"number\">30</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    category <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    price <span class=\"type\">DOUBLE PRECISION</span>,</span><br><span class=\"line\">\tdis_price <span class=\"type\">DOUBLE PRECISION</span>,</span><br><span class=\"line\">    num <span class=\"type\">INT</span>,</span><br><span class=\"line\">    description <span class=\"type\">VARCHAR</span>(<span class=\"number\">500</span>),</span><br><span class=\"line\">    detail <span class=\"type\">VARCHAR</span>(<span class=\"number\">2000</span>),</span><br><span class=\"line\">    after_sale <span class=\"type\">VARCHAR</span>(<span class=\"number\">100</span>),</span><br><span class=\"line\">    up_time <span class=\"type\">TIMESTAMP</span>,</span><br><span class=\"line\">    com_image <span class=\"type\">VARCHAR</span>(<span class=\"number\">500</span>),</span><br><span class=\"line\">    shelf_life <span class=\"type\">INT</span>,</span><br><span class=\"line\">    weight <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    taste <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>)</span><br><span class=\"line\">);</span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">table</span> cloth(</span><br><span class=\"line\">    com_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">    com_name <span class=\"type\">VARCHAR</span>(<span class=\"number\">30</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    category <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    price <span class=\"type\">DOUBLE PRECISION</span>,</span><br><span class=\"line\">\tdis_price <span class=\"type\">DOUBLE PRECISION</span>,</span><br><span class=\"line\">    num <span class=\"type\">INT</span>,</span><br><span class=\"line\">    description <span class=\"type\">VARCHAR</span>(<span class=\"number\">500</span>),</span><br><span class=\"line\">    detail <span class=\"type\">VARCHAR</span>(<span class=\"number\">2000</span>),</span><br><span class=\"line\">    after_sale <span class=\"type\">VARCHAR</span>(<span class=\"number\">100</span>),</span><br><span class=\"line\">    up_time <span class=\"type\">TIMESTAMP</span>,</span><br><span class=\"line\">    com_image <span class=\"type\">VARCHAR</span>(<span class=\"number\">500</span>),</span><br><span class=\"line\">    type <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    size <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> ele_appliment(</span><br><span class=\"line\">    com_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">    com_name <span class=\"type\">VARCHAR</span>(<span class=\"number\">30</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    category <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    price <span class=\"type\">DOUBLE PRECISION</span>,</span><br><span class=\"line\">\tdis_price <span class=\"type\">DOUBLE PRECISION</span>,</span><br><span class=\"line\">    num <span class=\"type\">INT</span>,</span><br><span class=\"line\">    description <span class=\"type\">VARCHAR</span>(<span class=\"number\">500</span>),</span><br><span class=\"line\">    detail <span class=\"type\">VARCHAR</span>(<span class=\"number\">2000</span>),</span><br><span class=\"line\">    after_sale <span class=\"type\">VARCHAR</span>(<span class=\"number\">100</span>),</span><br><span class=\"line\">    up_time <span class=\"type\">TIMESTAMP</span>,</span><br><span class=\"line\">    com_image <span class=\"type\">VARCHAR</span>(<span class=\"number\">500</span>),</span><br><span class=\"line\">    paymentway <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    type <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    memory <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    safegaurd <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    net_type <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>)</span><br><span class=\"line\">);</span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> ele_product(</span><br><span class=\"line\">    com_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">    com_name <span class=\"type\">VARCHAR</span>(<span class=\"number\">30</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    category <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    price <span class=\"type\">DOUBLE PRECISION</span>,</span><br><span class=\"line\">\tdis_price <span class=\"type\">DOUBLE PRECISION</span>,</span><br><span class=\"line\">    num <span class=\"type\">INT</span>,</span><br><span class=\"line\">    description <span class=\"type\">VARCHAR</span>(<span class=\"number\">500</span>),</span><br><span class=\"line\">    detail <span class=\"type\">VARCHAR</span>(<span class=\"number\">2000</span>),</span><br><span class=\"line\">    after_sale <span class=\"type\">VARCHAR</span>(<span class=\"number\">100</span>),</span><br><span class=\"line\">    up_time <span class=\"type\">TIMESTAMP</span>,</span><br><span class=\"line\">    com_image <span class=\"type\">VARCHAR</span>(<span class=\"number\">500</span>),</span><br><span class=\"line\">    paymentway <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    type <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    safegaurd <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> makeup(</span><br><span class=\"line\">    com_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">    com_name <span class=\"type\">VARCHAR</span>(<span class=\"number\">30</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    category <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    price <span class=\"type\">DOUBLE PRECISION</span>,</span><br><span class=\"line\">\tdis_price <span class=\"type\">DOUBLE PRECISION</span>,</span><br><span class=\"line\">    num <span class=\"type\">INT</span>,</span><br><span class=\"line\">    description <span class=\"type\">VARCHAR</span>(<span class=\"number\">500</span>),</span><br><span class=\"line\">    detail <span class=\"type\">VARCHAR</span>(<span class=\"number\">2000</span>),</span><br><span class=\"line\">    after_sale <span class=\"type\">VARCHAR</span>(<span class=\"number\">100</span>),</span><br><span class=\"line\">    up_time <span class=\"type\">TIMESTAMP</span>,</span><br><span class=\"line\">    com_image <span class=\"type\">VARCHAR</span>(<span class=\"number\">500</span>),</span><br><span class=\"line\">    type <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    weight <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> sport(</span><br><span class=\"line\">    com_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">    com_name <span class=\"type\">VARCHAR</span>(<span class=\"number\">30</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    category <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    price <span class=\"type\">DOUBLE PRECISION</span>,</span><br><span class=\"line\">\tdis_price <span class=\"type\">DOUBLE PRECISION</span>,</span><br><span class=\"line\">    num <span class=\"type\">INT</span>,</span><br><span class=\"line\">    description <span class=\"type\">VARCHAR</span>(<span class=\"number\">500</span>),</span><br><span class=\"line\">    detail <span class=\"type\">VARCHAR</span>(<span class=\"number\">2000</span>),</span><br><span class=\"line\">    after_sale <span class=\"type\">VARCHAR</span>(<span class=\"number\">100</span>),</span><br><span class=\"line\">    up_time <span class=\"type\">TIMESTAMP</span>,</span><br><span class=\"line\">    com_image <span class=\"type\">VARCHAR</span>(<span class=\"number\">500</span>),</span><br><span class=\"line\">    type <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    size <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> toy(</span><br><span class=\"line\">    com_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">    com_name <span class=\"type\">VARCHAR</span>(<span class=\"number\">30</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    category <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    price <span class=\"type\">DOUBLE PRECISION</span>,</span><br><span class=\"line\">\tdis_price <span class=\"type\">DOUBLE PRECISION</span>,</span><br><span class=\"line\">    num <span class=\"type\">INT</span>,</span><br><span class=\"line\">    description <span class=\"type\">VARCHAR</span>(<span class=\"number\">500</span>),</span><br><span class=\"line\">    detail <span class=\"type\">VARCHAR</span>(<span class=\"number\">2000</span>),</span><br><span class=\"line\">    after_sale <span class=\"type\">VARCHAR</span>(<span class=\"number\">100</span>),</span><br><span class=\"line\">    up_time <span class=\"type\">TIMESTAMP</span>,</span><br><span class=\"line\">    com_image <span class=\"type\">VARCHAR</span>(<span class=\"number\">500</span>),</span><br><span class=\"line\">    type <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    suit_age <span class=\"type\">INT</span></span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> daily_necessarity(</span><br><span class=\"line\">    com_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">    com_name <span class=\"type\">VARCHAR</span>(<span class=\"number\">30</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    category <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    price <span class=\"type\">DOUBLE PRECISION</span>,</span><br><span class=\"line\">\tdis_price <span class=\"type\">DOUBLE PRECISION</span>,</span><br><span class=\"line\">    num <span class=\"type\">INT</span>,</span><br><span class=\"line\">    description <span class=\"type\">VARCHAR</span>(<span class=\"number\">500</span>),</span><br><span class=\"line\">    detail <span class=\"type\">VARCHAR</span>(<span class=\"number\">2000</span>),</span><br><span class=\"line\">    after_sale <span class=\"type\">VARCHAR</span>(<span class=\"number\">100</span>),</span><br><span class=\"line\">    up_time <span class=\"type\">TIMESTAMP</span>,</span><br><span class=\"line\">    com_image <span class=\"type\">VARCHAR</span>(<span class=\"number\">500</span>),</span><br><span class=\"line\">    type <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    weight <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> other(</span><br><span class=\"line\">    com_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">    com_name <span class=\"type\">VARCHAR</span>(<span class=\"number\">30</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    category <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    price <span class=\"type\">DOUBLE PRECISION</span>,</span><br><span class=\"line\">\tdis_price <span class=\"type\">DOUBLE PRECISION</span>,</span><br><span class=\"line\">    num <span class=\"type\">INT</span>,</span><br><span class=\"line\">    detail <span class=\"type\">VARCHAR</span>(<span class=\"number\">2000</span>),</span><br><span class=\"line\">    after_sale <span class=\"type\">VARCHAR</span>(<span class=\"number\">100</span>),</span><br><span class=\"line\">    up_time <span class=\"type\">TIMESTAMP</span>,</span><br><span class=\"line\">    com_image <span class=\"type\">VARCHAR</span>(<span class=\"number\">500</span>),</span><br><span class=\"line\">    description <span class=\"type\">VARCHAR</span>(<span class=\"number\">200</span>)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">--äº¤æ˜“ç³»ç»Ÿçš„å…³ç³»</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">--åº—é“ºå’Œå•†å“çš„å…³ç³»</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> sell(</span><br><span class=\"line\">    store_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    com_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    st_time <span class=\"type\">TIMESTAMP</span>,</span><br><span class=\"line\">    <span class=\"keyword\">PRIMARY</span> KEY (store_id,com_id),</span><br><span class=\"line\">    <span class=\"keyword\">FOREIGN</span> KEY (store_id) <span class=\"keyword\">REFERENCES</span> store (store_id),</span><br><span class=\"line\">    <span class=\"keyword\">FOREIGN</span> KEY (com_id) <span class=\"keyword\">REFERENCES</span> commodity (com_id)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">--å•†å“å’Œæ´»åŠ¨çš„å…³ç³»</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> hold_(</span><br><span class=\"line\">    com_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    dis_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    <span class=\"keyword\">PRIMARY</span> KEY (com_id,dis_id),</span><br><span class=\"line\">    <span class=\"keyword\">FOREIGN</span> KEY (com_id) <span class=\"keyword\">REFERENCES</span> commodity (com_id),</span><br><span class=\"line\">    <span class=\"keyword\">FOREIGN</span> KEY (dis_id) <span class=\"keyword\">REFERENCES</span> discount (dis_id)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">--åˆ›å»ºè®¢å•è¡¨</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> order_(</span><br><span class=\"line\">    order_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">    com_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    user_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    real_pay <span class=\"type\">DOUBLE PRECISION</span>,</span><br><span class=\"line\">    ct_time <span class=\"type\">TIMESTAMP</span>,</span><br><span class=\"line\">    pay_time <span class=\"type\">TIMESTAMP</span>,</span><br><span class=\"line\">    state <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    pickup_code <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    description <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    com_num <span class=\"type\">INT</span></span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- ç”¨æˆ·ç³»ç»Ÿ</span></span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºç”¨æˆ·è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> users (</span><br><span class=\"line\">    user_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">    user_name <span class=\"type\">VARCHAR</span>(<span class=\"number\">30</span>) <span class=\"keyword\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    password_ <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">CHECK</span> (LENGTH(password_) <span class=\"operator\">&gt;=</span> <span class=\"number\">8</span>),</span><br><span class=\"line\">    gender <span class=\"type\">CHAR</span>(<span class=\"number\">1</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">CHECK</span> (gender <span class=\"keyword\">IN</span> (<span class=\"string\">&#x27;M&#x27;</span>,<span class=\"string\">&#x27;F&#x27;</span>)),</span><br><span class=\"line\">    telephone <span class=\"type\">CHAR</span>(<span class=\"number\">11</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">\ttype_ <span class=\"type\">VARCHAR</span>(<span class=\"number\">10</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,<span class=\"keyword\">CHECK</span> (type_ <span class=\"keyword\">IN</span> (<span class=\"string\">&#x27;consumer&#x27;</span>,<span class=\"string\">&#x27;seller&#x27;</span>))\t</span><br><span class=\"line\">);</span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºæ¶ˆè´¹è€…è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> consumer (</span><br><span class=\"line\">    user_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">PRIMARY</span> KEY, </span><br><span class=\"line\">    user_name <span class=\"type\">VARCHAR</span>(<span class=\"number\">30</span>) <span class=\"keyword\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    password_ <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">CHECK</span> (LENGTH(password_) <span class=\"operator\">&gt;=</span> <span class=\"number\">8</span>),</span><br><span class=\"line\">    gender <span class=\"type\">CHAR</span>(<span class=\"number\">1</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">CHECK</span> (gender <span class=\"keyword\">IN</span> (<span class=\"string\">&#x27;M&#x27;</span>,<span class=\"string\">&#x27;F&#x27;</span>)),</span><br><span class=\"line\">    telephone <span class=\"type\">CHAR</span>(<span class=\"number\">11</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    membership <span class=\"type\">BOOLEAN</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    credit <span class=\"type\">INT</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">CHECK</span> (credit <span class=\"operator\">&gt;=</span> <span class=\"number\">0</span>),</span><br><span class=\"line\">    headshot <span class=\"type\">VARCHAR</span>(<span class=\"number\">500</span>) <span class=\"keyword\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">NULL</span>, <span class=\"comment\">-- å­˜å‚¨ç”¨æˆ·å¤´åƒçš„åœ°å€</span></span><br><span class=\"line\">    fan_number <span class=\"type\">INT</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">CHECK</span> (fan_number <span class=\"operator\">&gt;=</span> <span class=\"number\">0</span>),</span><br><span class=\"line\">    focus_number <span class=\"type\">INT</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">CHECK</span> (focus_number <span class=\"operator\">&gt;=</span> <span class=\"number\">0</span>),</span><br><span class=\"line\">    likes <span class=\"type\">INT</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">CHECK</span> (likes <span class=\"operator\">&gt;=</span> <span class=\"number\">0</span>),</span><br><span class=\"line\">    change <span class=\"type\">DOUBLE PRECISION</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">CHECK</span> (change <span class=\"operator\">&gt;=</span> <span class=\"number\">0</span>), <span class=\"comment\">-- é›¶é’±</span></span><br><span class=\"line\">    shopping_coin <span class=\"type\">INT</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">CHECK</span> (shopping_coin <span class=\"operator\">&gt;=</span> <span class=\"number\">0</span>),</span><br><span class=\"line\">    alipay <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">\ttype_ <span class=\"type\">VARCHAR</span>(<span class=\"number\">10</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,<span class=\"keyword\">CHECK</span> (type_ <span class=\"operator\">=</span> <span class=\"string\">&#x27;consumer&#x27;</span>),</span><br><span class=\"line\">\tshopping_cart <span class=\"type\">VARCHAR</span>(<span class=\"number\">3000</span>) <span class=\"keyword\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">NULL</span></span><br><span class=\"line\">);</span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºå–å®¶è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> seller (</span><br><span class=\"line\">    user_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">PRIMARY</span> KEY, </span><br><span class=\"line\">    user_name <span class=\"type\">VARCHAR</span>(<span class=\"number\">30</span>) <span class=\"keyword\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    password_ <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">CHECK</span> (LENGTH(password_) <span class=\"operator\">&gt;=</span> <span class=\"number\">8</span>),</span><br><span class=\"line\">    gender <span class=\"type\">CHAR</span>(<span class=\"number\">1</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">CHECK</span> (gender <span class=\"keyword\">IN</span> (<span class=\"string\">&#x27;M&#x27;</span>,<span class=\"string\">&#x27;F&#x27;</span>)),</span><br><span class=\"line\">    telephone <span class=\"type\">CHAR</span>(<span class=\"number\">11</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">\ttype_ <span class=\"type\">VARCHAR</span>(<span class=\"number\">10</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,<span class=\"keyword\">CHECK</span> (type_ <span class=\"operator\">=</span> <span class=\"string\">&#x27;seller&#x27;</span>),</span><br><span class=\"line\">    service_authority <span class=\"type\">BOOLEAN</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    operator_authority <span class=\"type\">BOOLEAN</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span></span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºçº¢åŒ…è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> red_packet (</span><br><span class=\"line\">    red_packet_id SERIAL <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">    name_ <span class=\"type\">VARCHAR</span>(<span class=\"number\">30</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    value_ <span class=\"type\">DOUBLE PRECISION</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    condition_ <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    end_date <span class=\"type\">DATE</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span></span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºä¼˜æƒ åˆ¸è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> coupon (</span><br><span class=\"line\">    coupon_id SERIAL <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">    store_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>, </span><br><span class=\"line\">    value_ <span class=\"type\">DOUBLE PRECISION</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    condition_ <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    end_date <span class=\"type\">DATE</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">\t<span class=\"keyword\">FOREIGN</span> KEY (store_id) <span class=\"keyword\">REFERENCES</span> store (store_id)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºæ·˜å®å†ç¨‹è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> taobao_history (</span><br><span class=\"line\">    user_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    register_date <span class=\"type\">DATE</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    total_days <span class=\"type\">INT</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">CHECK</span> (total_days <span class=\"operator\">&gt;=</span> <span class=\"number\">0</span>),</span><br><span class=\"line\">    save_money <span class=\"type\">DOUBLE PRECISION</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">CHECK</span> (save_money <span class=\"operator\">&gt;=</span> <span class=\"number\">0</span>),</span><br><span class=\"line\">    month_spend_money <span class=\"type\">DOUBLE PRECISION</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">CHECK</span> (month_spend_money <span class=\"operator\">&gt;=</span> <span class=\"number\">0</span>),</span><br><span class=\"line\">\t<span class=\"keyword\">PRIMARY</span> KEY (user_id),</span><br><span class=\"line\">    <span class=\"keyword\">FOREIGN</span> KEY (user_id) <span class=\"keyword\">REFERENCES</span> consumer (user_id)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºæ”¶è´§åœ°å€è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> address (</span><br><span class=\"line\">    address_id SERIAL <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">    name_ <span class=\"type\">VARCHAR</span>(<span class=\"number\">30</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    telephone <span class=\"type\">CHAR</span>(<span class=\"number\">11</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    address <span class=\"type\">VARCHAR</span>(<span class=\"number\">50</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span></span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºæ¡£æ¡ˆè¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> archive (</span><br><span class=\"line\">    archive_id SERIAL <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">    height <span class=\"type\">DOUBLE PRECISION</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">CHECK</span> (height <span class=\"operator\">&gt;</span> <span class=\"number\">0</span>),</span><br><span class=\"line\">    weight <span class=\"type\">DOUBLE PRECISION</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">CHECK</span> (weight <span class=\"operator\">&gt;</span> <span class=\"number\">0</span>),</span><br><span class=\"line\">    shoe_size <span class=\"type\">DOUBLE PRECISION</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">CHECK</span> (shoe_size <span class=\"operator\">&gt;=</span> <span class=\"number\">16</span> <span class=\"keyword\">and</span> shoe_size <span class=\"operator\">&lt;=</span> <span class=\"number\">45</span>)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºå¥½å‹å…³ç³»è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> friendship (</span><br><span class=\"line\">    user1_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    user2_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    accept_date <span class=\"type\">DATE</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    <span class=\"keyword\">PRIMARY</span> KEY (user1_id, user2_id),</span><br><span class=\"line\">\t<span class=\"keyword\">FOREIGN</span> KEY (user1_id) <span class=\"keyword\">REFERENCES</span> consumer (user_id),</span><br><span class=\"line\">\t<span class=\"keyword\">FOREIGN</span> KEY (user2_id) <span class=\"keyword\">REFERENCES</span> consumer (user_id)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºæ”¶è´§åœ°å€æ€»è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> consumer_register_address (</span><br><span class=\"line\">    user_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    address_id SERIAL <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">\tcommon_address <span class=\"type\">BOOLEAN</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">\t<span class=\"keyword\">PRIMARY</span> KEY (user_id, address_id),</span><br><span class=\"line\">    <span class=\"keyword\">FOREIGN</span> KEY (user_id) <span class=\"keyword\">REFERENCES</span> consumer (user_id),</span><br><span class=\"line\">    <span class=\"keyword\">FOREIGN</span> KEY (address_id) <span class=\"keyword\">REFERENCES</span> address (address_id)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºç²‰ä¸åˆ—è¡¨æ€»è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> fan (</span><br><span class=\"line\">    user_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    fan_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">\t<span class=\"keyword\">PRIMARY</span> KEY (user_id, fan_id),</span><br><span class=\"line\">    <span class=\"keyword\">FOREIGN</span> KEY (user_id) <span class=\"keyword\">REFERENCES</span> consumer (user_id),</span><br><span class=\"line\">    <span class=\"keyword\">FOREIGN</span> KEY (fan_id) <span class=\"keyword\">REFERENCES</span> consumer (user_id)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºå…³æ³¨åˆ—è¡¨æ€»è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> user_focus_user (</span><br><span class=\"line\">    user_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    focus_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">\t<span class=\"keyword\">PRIMARY</span> KEY (user_id, focus_id),</span><br><span class=\"line\">    <span class=\"keyword\">FOREIGN</span> KEY (user_id) <span class=\"keyword\">REFERENCES</span> consumer (user_id),</span><br><span class=\"line\">    <span class=\"keyword\">FOREIGN</span> KEY (focus_id) <span class=\"keyword\">REFERENCES</span> consumer (user_id)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºç”¨æˆ·çº¢åŒ…å…³ç³»è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> consumer_recieve_redpacket (</span><br><span class=\"line\">    user_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    red_packet_id SERIAL <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">\t<span class=\"keyword\">PRIMARY</span> KEY (user_id, red_packet_id),</span><br><span class=\"line\">    <span class=\"keyword\">FOREIGN</span> KEY (user_id) <span class=\"keyword\">REFERENCES</span> consumer (user_id),</span><br><span class=\"line\">    <span class=\"keyword\">FOREIGN</span> KEY (red_packet_id) <span class=\"keyword\">REFERENCES</span> red_packet (red_packet_id)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºç”¨æˆ·ä¼˜æƒ åˆ¸å…³ç³»è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> consumer_get_coupon (</span><br><span class=\"line\">    user_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    coupon_id SERIAL <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">\t<span class=\"keyword\">PRIMARY</span> KEY (user_id, coupon_id),</span><br><span class=\"line\">    <span class=\"keyword\">FOREIGN</span> KEY (user_id) <span class=\"keyword\">REFERENCES</span> consumer (user_id),</span><br><span class=\"line\">    <span class=\"keyword\">FOREIGN</span> KEY (coupon_id) <span class=\"keyword\">REFERENCES</span> coupon (coupon_id)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºä¸»è´¦å·å’Œå­è´¦å·å…³ç³»è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> manage_subaccount (</span><br><span class=\"line\">    main_user_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    sub_user_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">\t<span class=\"keyword\">PRIMARY</span> KEY (main_user_id,sub_user_id),</span><br><span class=\"line\">    <span class=\"keyword\">FOREIGN</span> KEY (main_user_id) <span class=\"keyword\">REFERENCES</span> seller (user_id),</span><br><span class=\"line\">    <span class=\"keyword\">FOREIGN</span> KEY (sub_user_id) <span class=\"keyword\">REFERENCES</span> seller (user_id)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">--ç”¨æˆ·æ¡£æ¡ˆç´¢å¼•è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> consumer_have_archive (</span><br><span class=\"line\">    user_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    archive_id SERIAL <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">\t<span class=\"keyword\">PRIMARY</span> KEY (user_id,archive_id),</span><br><span class=\"line\">    <span class=\"keyword\">FOREIGN</span> KEY (user_id) <span class=\"keyword\">REFERENCES</span> consumer (user_id),</span><br><span class=\"line\">    <span class=\"keyword\">FOREIGN</span> KEY (archive_id) <span class=\"keyword\">REFERENCES</span> archive (archive_id)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">--æ¶ˆè´¹è€…æ”¶è—è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> <span class=\"keyword\">collect</span> (</span><br><span class=\"line\">    user_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    com_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    collect_time <span class=\"type\">DATE</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    <span class=\"keyword\">PRIMARY</span> KEY (user_id,com_id),</span><br><span class=\"line\">    <span class=\"keyword\">FOREIGN</span> KEY (user_id) <span class=\"keyword\">REFERENCES</span> consumer (user_id),</span><br><span class=\"line\">    <span class=\"keyword\">FOREIGN</span> KEY (com_id) <span class=\"keyword\">REFERENCES</span> commodity (com_id)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">--æ¶ˆè´¹è€…æµè§ˆè®°å½•è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> watching_history (</span><br><span class=\"line\">    user_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    com_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    watch_time <span class=\"type\">DATE</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    <span class=\"keyword\">PRIMARY</span> KEY (user_id,com_id),</span><br><span class=\"line\">    <span class=\"keyword\">FOREIGN</span> KEY (user_id) <span class=\"keyword\">REFERENCES</span> consumer (user_id),</span><br><span class=\"line\">    <span class=\"keyword\">FOREIGN</span> KEY (com_id) <span class=\"keyword\">REFERENCES</span> commodity (com_id)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- èŠå¤©åé¦ˆç³»ç»Ÿ</span></span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºå®˜æ–¹å®¢æœæ€»è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> official_agent(</span><br><span class=\"line\">\tofficial_agent_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">\ttelephone <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">\tstart_date <span class=\"type\">TIMESTAMP</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">\tend_date <span class=\"type\">TIMESTAMP</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span></span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºç¾¤ç»„æ€»è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> <span class=\"keyword\">groups</span>(</span><br><span class=\"line\">\tgroup_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">\tgroup_name <span class=\"type\">VARCHAR</span>(<span class=\"number\">30</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">\tcreated_date <span class=\"type\">TIMESTAMP</span> <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">\tdescription <span class=\"type\">VARCHAR</span>(<span class=\"number\">100</span>) <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">\tmember_num <span class=\"type\">INT</span> <span class=\"keyword\">CHECK</span>(member_num <span class=\"operator\">&gt;=</span> <span class=\"number\">0</span>)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºæ¶ˆæ¯æ€»è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> message(</span><br><span class=\"line\">\tmessage_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">\tmessage_type <span class=\"type\">VARCHAR</span>(<span class=\"number\">10</span>) <span class=\"keyword\">CHECK</span> (message_type <span class=\"keyword\">IN</span> (<span class=\"string\">&#x27;æ–‡æœ¬&#x27;</span>,<span class=\"string\">&#x27;è¯­éŸ³&#x27;</span>,<span class=\"string\">&#x27;å›¾ç‰‡&#x27;</span>,<span class=\"string\">&#x27;è§†é¢‘&#x27;</span>)),</span><br><span class=\"line\">\tmessage_content <span class=\"type\">VARCHAR</span>(<span class=\"number\">500</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">\tmessage_date <span class=\"type\">TIMESTAMP</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span></span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºå¯¹è¯æ¶ˆæ¯æ€»è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> conversation_message(</span><br><span class=\"line\">\tmessage_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">\tmessage_type <span class=\"type\">VARCHAR</span>(<span class=\"number\">10</span>) <span class=\"keyword\">CHECK</span> (message_type <span class=\"keyword\">IN</span> (<span class=\"string\">&#x27;æ–‡æœ¬&#x27;</span>,<span class=\"string\">&#x27;è¯­éŸ³&#x27;</span>,<span class=\"string\">&#x27;å›¾ç‰‡&#x27;</span>,<span class=\"string\">&#x27;è§†é¢‘&#x27;</span>)),</span><br><span class=\"line\">\tmessage_content <span class=\"type\">VARCHAR</span>(<span class=\"number\">500</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">\tmessage_date <span class=\"type\">TIMESTAMP</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">\tisread <span class=\"type\">BOOLEAN</span>  <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span></span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºç¾¤ç»„æ¶ˆæ¯æ€»è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> group_message(</span><br><span class=\"line\">\tmessage_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">\tmessage_type <span class=\"type\">VARCHAR</span>(<span class=\"number\">10</span>) <span class=\"keyword\">CHECK</span> (message_type <span class=\"keyword\">IN</span> (<span class=\"string\">&#x27;æ–‡æœ¬&#x27;</span>,<span class=\"string\">&#x27;è¯­éŸ³&#x27;</span>,<span class=\"string\">&#x27;å›¾ç‰‡&#x27;</span>,<span class=\"string\">&#x27;è§†é¢‘&#x27;</span>)),</span><br><span class=\"line\">\tmessage_content <span class=\"type\">VARCHAR</span>(<span class=\"number\">500</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">\tmessage_date <span class=\"type\">TIMESTAMP</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span></span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºè¯·æ±‚æ€»è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> request(</span><br><span class=\"line\">\trequest_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">\trequest_status <span class=\"type\">VARCHAR</span>(<span class=\"number\">10</span>) <span class=\"keyword\">CHECK</span> (request_status <span class=\"keyword\">IN</span> (<span class=\"string\">&#x27;æœªå¤„ç†&#x27;</span>,<span class=\"string\">&#x27;å·²æ¥å—&#x27;</span>,<span class=\"string\">&#x27;å·²æ‹’ç»&#x27;</span>)),</span><br><span class=\"line\">\trequest_description <span class=\"type\">VARCHAR</span>(<span class=\"number\">100</span>) <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">\trequest_date <span class=\"type\">TIMESTAMP</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span></span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºç”¨æˆ·è¯„ä»·æ€»è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> evaluation(</span><br><span class=\"line\">\tevaluation_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">\tevaluation_content_type <span class=\"type\">VARCHAR</span>(<span class=\"number\">10</span>) <span class=\"keyword\">CHECK</span> (evaluation_content_type <span class=\"keyword\">IN</span> (<span class=\"string\">&#x27;æ–‡æœ¬&#x27;</span>,<span class=\"string\">&#x27;å›¾ç‰‡&#x27;</span>,<span class=\"string\">&#x27;è§†é¢‘&#x27;</span>)),</span><br><span class=\"line\">\tevaluation_content <span class=\"type\">VARCHAR</span>(<span class=\"number\">500</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">\tisanonymous <span class=\"type\">BOOLEAN</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">\tevaluation_type <span class=\"type\">CHAR</span>(<span class=\"number\">1</span>) <span class=\"keyword\">CHECK</span> (evaluation_type <span class=\"keyword\">IN</span> (<span class=\"string\">&#x27;å¥½&#x27;</span>,<span class=\"string\">&#x27;å·®&#x27;</span>)),</span><br><span class=\"line\">\tevaluated_date <span class=\"type\">TIMESTAMP</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">\tisfollow <span class=\"type\">BOOLEAN</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">\tlikes <span class=\"type\">INT</span> <span class=\"keyword\">CHECK</span> (likes <span class=\"operator\">&gt;=</span> <span class=\"number\">0</span>),</span><br><span class=\"line\">\tcomment_num <span class=\"type\">INT</span> <span class=\"keyword\">CHECK</span> (comment_num <span class=\"operator\">&gt;=</span><span class=\"number\">0</span>),</span><br><span class=\"line\">\tcomprehensive_evaluation <span class=\"type\">INT</span> <span class=\"keyword\">check</span>(comprehensive_evaluation <span class=\"keyword\">IN</span> (<span class=\"number\">0</span>,<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>)),</span><br><span class=\"line\">\tdescription_match <span class=\"type\">INT</span> <span class=\"keyword\">check</span>(description_match <span class=\"keyword\">IN</span> (<span class=\"number\">0</span>,<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>)),</span><br><span class=\"line\">\tlogistics_service <span class=\"type\">INT</span> <span class=\"keyword\">check</span>(logistics_service <span class=\"keyword\">IN</span> (<span class=\"number\">0</span>,<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>)),</span><br><span class=\"line\">\tservice_attitude <span class=\"type\">INT</span> <span class=\"keyword\">check</span>(service_attitude <span class=\"keyword\">IN</span> (<span class=\"number\">0</span>,<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>))</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºç”¨æˆ·è¯„è®ºæ€»è¡¨(å¼±å®ä½“)</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> comments(</span><br><span class=\"line\">\tevaluation_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\tuser_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">30</span>),</span><br><span class=\"line\">\tcomment_date <span class=\"type\">TIMESTAMP</span>,</span><br><span class=\"line\">\tcomment_type <span class=\"type\">VARCHAR</span>(<span class=\"number\">10</span>) <span class=\"keyword\">CHECK</span> (comment_type <span class=\"keyword\">IN</span> (<span class=\"string\">&#x27;æ–‡æœ¬&#x27;</span>,<span class=\"string\">&#x27;å›¾ç‰‡&#x27;</span>,<span class=\"string\">&#x27;è§†é¢‘&#x27;</span>)),</span><br><span class=\"line\">\tcomment_content <span class=\"type\">VARCHAR</span>(<span class=\"number\">500</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">\tlikes <span class=\"type\">INT</span>,</span><br><span class=\"line\">\t<span class=\"keyword\">PRIMARY</span> KEY(evaluation_id, user_id, comment_date),</span><br><span class=\"line\">\t<span class=\"keyword\">FOREIGN</span> KEY (evaluation_id) <span class=\"keyword\">REFERENCES</span> evaluation (evaluation_id),</span><br><span class=\"line\">    <span class=\"keyword\">FOREIGN</span> KEY (user_id) <span class=\"keyword\">REFERENCES</span> consumer (user_id)</span><br><span class=\"line\">);</span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºé—®é¢˜æ€»è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> question(</span><br><span class=\"line\">\tquestion_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">\tquestion_content <span class=\"type\">VARCHAR</span>(<span class=\"number\">500</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">\tquestion_date <span class=\"type\">TIMESTAMP</span> <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">\treply_num <span class=\"type\">INT</span> <span class=\"keyword\">CHECK</span>(reply_num <span class=\"operator\">&gt;=</span> <span class=\"number\">0</span>)</span><br><span class=\"line\">);</span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºå¥½å‹èŠå¤©æ¶ˆæ¯ç´¢å¼•è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> friend_and_friend(</span><br><span class=\"line\">\tsender_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\treceiver_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\tmessage_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\t<span class=\"keyword\">PRIMARY</span> KEY(sender_id, receiver_id, message_id),</span><br><span class=\"line\">\t<span class=\"keyword\">FOREIGN</span> KEY (sender_id) <span class=\"keyword\">REFERENCES</span> consumer (user_id),</span><br><span class=\"line\">    <span class=\"keyword\">FOREIGN</span> KEY (receiver_id) <span class=\"keyword\">REFERENCES</span> consumer (user_id),</span><br><span class=\"line\">\t<span class=\"keyword\">FOREIGN</span> KEY (message_id) <span class=\"keyword\">REFERENCES</span> conversation_message (message_id)</span><br><span class=\"line\">);</span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºå–å®¶å’Œå®¢æœæ¶ˆæ¯ç´¢å¼•è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> seller_and_agent(</span><br><span class=\"line\">\tseller_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\tofficial_agent_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\tmessage_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\tsender <span class=\"type\">BOOLEAN</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>, <span class=\"comment\">--0è¡¨ç¤ºå–å®¶å‘çš„ï¼Œ1è¡¨ç¤ºå®¢æœå‘çš„</span></span><br><span class=\"line\">\t<span class=\"keyword\">PRIMARY</span> KEY(seller_id, official_agent_id, message_id),</span><br><span class=\"line\">\t<span class=\"keyword\">FOREIGN</span> KEY (seller_id) <span class=\"keyword\">REFERENCES</span> seller (user_id),</span><br><span class=\"line\">    <span class=\"keyword\">FOREIGN</span> KEY (official_agent_id) <span class=\"keyword\">REFERENCES</span> official_agent (official_agent_id),</span><br><span class=\"line\">\t<span class=\"keyword\">FOREIGN</span> KEY (message_id) <span class=\"keyword\">REFERENCES</span> conversation_message (message_id)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºæ¶ˆè´¹è€…å’Œå®¢æœæ¶ˆæ¯ç´¢å¼•è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> consumer_and_agent(</span><br><span class=\"line\">\tconsumer_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\tofficial_agent_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\tmessage_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\tsender <span class=\"type\">BOOLEAN</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>, <span class=\"comment\">--0è¡¨ç¤ºæ¶ˆè´¹è€…å‘çš„ï¼Œ1è¡¨ç¤ºå®¢æœå‘çš„</span></span><br><span class=\"line\">\t<span class=\"keyword\">PRIMARY</span> KEY(consumer_id, official_agent_id, message_id),</span><br><span class=\"line\">\t<span class=\"keyword\">FOREIGN</span> KEY (consumer_id) <span class=\"keyword\">REFERENCES</span> consumer (user_id),</span><br><span class=\"line\">    <span class=\"keyword\">FOREIGN</span> KEY (official_agent_id) <span class=\"keyword\">REFERENCES</span> official_agent (official_agent_id),</span><br><span class=\"line\">\t<span class=\"keyword\">FOREIGN</span> KEY (message_id) <span class=\"keyword\">REFERENCES</span> conversation_message (message_id)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºæ¶ˆè´¹è€…å’Œå–å®¶æ¶ˆæ¯ç´¢å¼•è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> consumer_and_seller(</span><br><span class=\"line\">\tconsumer_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\tseller_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\tmessage_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\tsender <span class=\"type\">BOOLEAN</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>, <span class=\"comment\">--0è¡¨ç¤ºæ¶ˆè´¹è€…å‘çš„ï¼Œ1è¡¨ç¤ºå–å®¶å‘çš„</span></span><br><span class=\"line\">\t<span class=\"keyword\">PRIMARY</span> KEY(consumer_id, seller_id, message_id),</span><br><span class=\"line\">\t<span class=\"keyword\">FOREIGN</span> KEY (consumer_id) <span class=\"keyword\">REFERENCES</span> consumer (user_id),</span><br><span class=\"line\">    <span class=\"keyword\">FOREIGN</span> KEY (seller_id) <span class=\"keyword\">REFERENCES</span> seller (user_id),</span><br><span class=\"line\">\t<span class=\"keyword\">FOREIGN</span> KEY (message_id) <span class=\"keyword\">REFERENCES</span> conversation_message (message_id)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºç¾¤ç»„æ¶ˆæ¯ç´¢å¼•è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> member_and_member(</span><br><span class=\"line\">\tgroup_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\tsender_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\tmessage_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\t<span class=\"keyword\">PRIMARY</span> KEY(group_id, sender_id, message_id),</span><br><span class=\"line\">\t<span class=\"keyword\">FOREIGN</span> KEY (group_id) <span class=\"keyword\">REFERENCES</span> <span class=\"keyword\">groups</span> (group_id),</span><br><span class=\"line\">    <span class=\"keyword\">FOREIGN</span> KEY (sender_id) <span class=\"keyword\">REFERENCES</span> consumer (user_id),</span><br><span class=\"line\">\t<span class=\"keyword\">FOREIGN</span> KEY (message_id) <span class=\"keyword\">REFERENCES</span> group_message (message_id)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºç¾¤ç»„æˆå‘˜è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> group_members(</span><br><span class=\"line\">\tgroup_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\tuser_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\trole <span class=\"type\">VARCHAR</span>(<span class=\"number\">10</span>) <span class=\"keyword\">CHECK</span> (role <span class=\"keyword\">IN</span> (<span class=\"string\">&#x27;ç¾¤ä¸»&#x27;</span>,<span class=\"string\">&#x27;ç®¡ç†å‘˜&#x27;</span>,<span class=\"string\">&#x27;æ™®é€šæˆå‘˜&#x27;</span>)),</span><br><span class=\"line\">\t<span class=\"keyword\">PRIMARY</span> KEY(group_id, user_id),</span><br><span class=\"line\">\t<span class=\"keyword\">FOREIGN</span> KEY (group_id) <span class=\"keyword\">REFERENCES</span> <span class=\"keyword\">groups</span> (group_id),</span><br><span class=\"line\">    <span class=\"keyword\">FOREIGN</span> KEY (user_id) <span class=\"keyword\">REFERENCES</span> consumer (user_id)</span><br><span class=\"line\">);</span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºå¥½å‹è¯·æ±‚è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> friend_request(</span><br><span class=\"line\">\trequest_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\tsender_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\treceiver_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\t<span class=\"keyword\">PRIMARY</span> KEY(request_id, sender_id, receiver_id),</span><br><span class=\"line\">\t<span class=\"keyword\">FOREIGN</span> KEY (request_id) <span class=\"keyword\">REFERENCES</span> request (request_id),</span><br><span class=\"line\">    <span class=\"keyword\">FOREIGN</span> KEY (sender_id) <span class=\"keyword\">REFERENCES</span> consumer (user_id),</span><br><span class=\"line\">\t<span class=\"keyword\">FOREIGN</span> KEY (receiver_id) <span class=\"keyword\">REFERENCES</span> consumer (user_id)</span><br><span class=\"line\">);</span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºå…¥ç¾¤è¯·æ±‚è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> group_request(</span><br><span class=\"line\">\trequest_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\tgroup_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\tuser_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\t<span class=\"keyword\">PRIMARY</span> KEY(request_id, group_id, user_id),</span><br><span class=\"line\">\t<span class=\"keyword\">FOREIGN</span> KEY (request_id) <span class=\"keyword\">REFERENCES</span> request (request_id),</span><br><span class=\"line\">    <span class=\"keyword\">FOREIGN</span> KEY (group_id) <span class=\"keyword\">REFERENCES</span> <span class=\"keyword\">groups</span> (group_id),</span><br><span class=\"line\">\t<span class=\"keyword\">FOREIGN</span> KEY (user_id) <span class=\"keyword\">REFERENCES</span> consumer (user_id)</span><br><span class=\"line\">);</span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºå–å®¶å›è¯„è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> reply(</span><br><span class=\"line\">\tevaluation_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\tuser_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\treply_date <span class=\"type\">DATE</span>,</span><br><span class=\"line\">\treply_type <span class=\"type\">VARCHAR</span>(<span class=\"number\">10</span>) <span class=\"keyword\">CHECK</span> (reply_type <span class=\"keyword\">IN</span> (<span class=\"string\">&#x27;æ–‡æœ¬&#x27;</span>,<span class=\"string\">&#x27;å›¾ç‰‡&#x27;</span>,<span class=\"string\">&#x27;è§†é¢‘&#x27;</span>)),</span><br><span class=\"line\">\treply_content <span class=\"type\">VARCHAR</span>(<span class=\"number\">500</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">\tlikes <span class=\"type\">INT</span> <span class=\"keyword\">CHECK</span>(likes <span class=\"operator\">&gt;=</span> <span class=\"number\">0</span>),</span><br><span class=\"line\">\t<span class=\"keyword\">PRIMARY</span> KEY(evaluation_id, user_id, reply_date),</span><br><span class=\"line\">\t<span class=\"keyword\">FOREIGN</span> KEY (evaluation_id) <span class=\"keyword\">REFERENCES</span> evaluation (evaluation_id),</span><br><span class=\"line\">\t<span class=\"keyword\">FOREIGN</span> KEY (user_id) <span class=\"keyword\">REFERENCES</span> seller (user_id)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºæ¶ˆè´¹è€…è¯„ä»·å…³ç³»è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> consumer_give_evaluation(</span><br><span class=\"line\">\tevaluation_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\tuser_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\tcom_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\t<span class=\"keyword\">PRIMARY</span> KEY(evaluation_id, user_id, com_id),</span><br><span class=\"line\">\t<span class=\"keyword\">FOREIGN</span> KEY (evaluation_id) <span class=\"keyword\">REFERENCES</span> evaluation (evaluation_id),</span><br><span class=\"line\">\t<span class=\"keyword\">FOREIGN</span> KEY (user_id) <span class=\"keyword\">REFERENCES</span> consumer (user_id),</span><br><span class=\"line\">\t<span class=\"keyword\">FOREIGN</span> KEY (com_id) <span class=\"keyword\">REFERENCES</span> commodity (com_id)</span><br><span class=\"line\">);</span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºæ¶ˆè´¹è€…æé—®å…³ç³»è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> consumer_ask_question(</span><br><span class=\"line\">\tquestion_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\tuser_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\tcom_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\t<span class=\"keyword\">PRIMARY</span> KEY(question_id, user_id, com_id),</span><br><span class=\"line\">\t<span class=\"keyword\">FOREIGN</span> KEY (question_id) <span class=\"keyword\">REFERENCES</span> question (question_id),</span><br><span class=\"line\">\t<span class=\"keyword\">FOREIGN</span> KEY (user_id) <span class=\"keyword\">REFERENCES</span> consumer (user_id),</span><br><span class=\"line\">\t<span class=\"keyword\">FOREIGN</span> KEY (com_id) <span class=\"keyword\">REFERENCES</span> commodity (com_id)</span><br><span class=\"line\">);</span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºæ¶ˆè´¹è€…å›ç­”é—®é¢˜è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> consumer_reply_question(</span><br><span class=\"line\">\tquestion_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\tuser_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\treply_date <span class=\"type\">TIMESTAMP</span>,</span><br><span class=\"line\">\treply_content <span class=\"type\">VARCHAR</span>(<span class=\"number\">500</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">\t<span class=\"keyword\">PRIMARY</span> KEY(question_id, user_id, reply_date),</span><br><span class=\"line\">\t<span class=\"keyword\">FOREIGN</span> KEY (question_id) <span class=\"keyword\">REFERENCES</span> question (question_id),</span><br><span class=\"line\">\t<span class=\"keyword\">FOREIGN</span> KEY (user_id) <span class=\"keyword\">REFERENCES</span> consumer (user_id)</span><br><span class=\"line\">);</span><br><span class=\"line\"><span class=\"comment\">-- åˆ›å»ºæ¶ˆè´¹è€…å…³æ³¨é—®é¢˜è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> consumer_focus_question(</span><br><span class=\"line\">\tquestion_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\tuser_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\tfocus_date <span class=\"type\">TIMESTAMP</span> <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">\t<span class=\"keyword\">PRIMARY</span> KEY(question_id, user_id),</span><br><span class=\"line\">\t<span class=\"keyword\">FOREIGN</span> KEY (question_id) <span class=\"keyword\">REFERENCES</span> question (question_id),</span><br><span class=\"line\">\t<span class=\"keyword\">FOREIGN</span> KEY (user_id) <span class=\"keyword\">REFERENCES</span> consumer (user_id)</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">--è§†å›¾</span></span><br><span class=\"line\"><span class=\"comment\">--å•†å“å„ç§ç±»åˆ«çš„è§†å›¾</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">VIEW</span> com_food <span class=\"keyword\">AS</span> <span class=\"keyword\">SELECT</span> commodity.com_name, commodity.price, commodity.dis_price, commodity.description, commodity.detail, commodity.com_image, shelf_life, weight, taste</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">FROM</span> commodity <span class=\"keyword\">join</span> food <span class=\"keyword\">on</span> commodity.com_id <span class=\"operator\">=</span> food.com_id</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">where</span> commodity.category <span class=\"operator\">=</span> <span class=\"string\">&#x27;food&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">VIEW</span> com_food;</span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">VIEW</span> com_cloth <span class=\"keyword\">AS</span> <span class=\"keyword\">SELECT</span> commodity.com_name, commodity.price, commodity.dis_price, commodity.description, commodity.detail, commodity.com_image, type, size</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">FROM</span> commodity <span class=\"keyword\">join</span> cloth <span class=\"keyword\">on</span> commodity.com_id <span class=\"operator\">=</span> cloth.com_id</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">where</span> commodity.category <span class=\"operator\">=</span> <span class=\"string\">&#x27;cloth&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">VIEW</span> com_cloth;</span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">VIEW</span> com_ele_appliment <span class=\"keyword\">AS</span> <span class=\"keyword\">SELECT</span> commodity.com_name, commodity.price, commodity.dis_price, commodity.description, commodity.detail, commodity.com_image, paymentway, type, memory, safegaurd, net_type</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">FROM</span> commodity <span class=\"keyword\">join</span> ele_appliment <span class=\"keyword\">on</span> commodity.com_id <span class=\"operator\">=</span> ele_appliment.com_id</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">where</span> commodity.category <span class=\"operator\">=</span> <span class=\"string\">&#x27;ele_appliment&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">VIEW</span> com_ele_appliment;</span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">VIEW</span> com_ele_product <span class=\"keyword\">AS</span> <span class=\"keyword\">SELECT</span> commodity.com_name, commodity.price, commodity.dis_price, commodity.description, commodity.detail, commodity.com_image, paymentway, type, safegaurd</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">FROM</span> commodity <span class=\"keyword\">join</span> ele_product <span class=\"keyword\">on</span> commodity.com_id <span class=\"operator\">=</span> ele_product.com_id</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">where</span> commodity.category <span class=\"operator\">=</span> <span class=\"string\">&#x27;ele_product&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">VIEW</span> com_ele_product;</span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">VIEW</span> com_makeup <span class=\"keyword\">AS</span> <span class=\"keyword\">SELECT</span> commodity.com_name, commodity.price, commodity.dis_price, commodity.description, commodity.detail, commodity.com_image, type, weight</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">FROM</span> commodity <span class=\"keyword\">join</span> makeup <span class=\"keyword\">on</span> commodity.com_id <span class=\"operator\">=</span> makeup.com_id</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">where</span> commodity.category <span class=\"operator\">=</span> <span class=\"string\">&#x27;makeup&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">VIEW</span> com_makeup;</span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">VIEW</span> com_sport <span class=\"keyword\">AS</span> <span class=\"keyword\">SELECT</span> commodity.com_name, commodity.price, commodity.dis_price, commodity.description, commodity.detail, commodity.com_image, type, size</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">FROM</span> commodity <span class=\"keyword\">join</span> sport <span class=\"keyword\">on</span> commodity.com_id <span class=\"operator\">=</span> sport.com_id</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">where</span> commodity.category <span class=\"operator\">=</span> <span class=\"string\">&#x27;sport&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">VIEW</span> com_sport;</span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">VIEW</span> com_toy <span class=\"keyword\">AS</span> <span class=\"keyword\">SELECT</span> commodity.com_name, commodity.price, commodity.dis_price, commodity.description, commodity.detail, commodity.com_image, type, suit_age</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">FROM</span> commodity <span class=\"keyword\">join</span> toy <span class=\"keyword\">on</span> commodity.com_id <span class=\"operator\">=</span> toy.com_id</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">where</span> commodity.category <span class=\"operator\">=</span> <span class=\"string\">&#x27;toy&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">VIEW</span> com_toy;</span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">VIEW</span> com_daily_necessarity <span class=\"keyword\">AS</span> <span class=\"keyword\">SELECT</span> commodity.com_name, commodity.price, commodity.dis_price, commodity.description, commodity.detail, commodity.com_image, type, weight</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">FROM</span> commodity <span class=\"keyword\">join</span> daily_necessarity <span class=\"keyword\">on</span> commodity.com_id <span class=\"operator\">=</span> daily_necessarity.com_id</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">where</span> commodity.category <span class=\"operator\">=</span> <span class=\"string\">&#x27;daily_necessarity&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">VIEW</span> com_daily_necessarity;</span><br><span class=\"line\"><span class=\"comment\">--åº—é“ºæ‰€æ‹¥æœ‰çš„å•†å“åˆ›å»ºè§†å›¾ï¼ˆæ”¹store_idï¼‰</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">VIEW</span> com_of_store <span class=\"keyword\">AS</span> <span class=\"keyword\">SELECT</span> com_name, category, num, price, dis_price, description, detail, com_image, after_sale, up_time</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">FROM</span> commodity <span class=\"keyword\">join</span> sell <span class=\"keyword\">on</span> commodity.com_id <span class=\"operator\">=</span> sell.com_id</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">where</span> store_id <span class=\"operator\">=</span> <span class=\"string\">&#x27;012345678&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">VIEW</span> com_of_store;</span><br><span class=\"line\"><span class=\"comment\">--æ¯ä¸ªæ¶ˆè´¹è€…çš„æµè§ˆè®°å½•åˆ›å»ºè§†å›¾ï¼ˆæ”¹user_idï¼‰</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">VIEW</span> personal_browsing_history <span class=\"keyword\">AS</span> <span class=\"keyword\">SELECT</span> com_name, price, dis_price, description, detail, com_image, watch_time</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">FROM</span> commodity <span class=\"keyword\">join</span> watching_history <span class=\"keyword\">on</span> commodity.com_id <span class=\"operator\">=</span> watching_history.com_id</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">where</span> user_id <span class=\"operator\">=</span> <span class=\"string\">&#x27;000111111&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">VIEW</span> personal_browsing_history;</span><br><span class=\"line\"><span class=\"comment\">--æ¯ä¸ªå•†å“è¿‡å»30å¤©çš„å†å²ä»·æ ¼åˆ›å»ºè§†å›¾</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">VIEW</span> historical_commodity_price <span class=\"keyword\">AS</span> <span class=\"keyword\">SELECT</span> com_name, price, <span class=\"type\">time</span></span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">FROM</span> commodity <span class=\"keyword\">join</span> historical_price <span class=\"keyword\">on</span> commodity.com_id <span class=\"operator\">=</span> historical_price.com_id</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">where</span> com_id <span class=\"operator\">=</span> <span class=\"string\">&#x27;54645645645&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">VIEW</span> historical_commodity_price;</span><br><span class=\"line\"><span class=\"comment\">--æ¯ä¸ªæ¶ˆè´¹è€…çš„æ”¶è—è®°å½•åˆ›å»ºè§†å›¾ï¼ˆæ”¹user_idï¼‰</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">VIEW</span> personal_collect_history <span class=\"keyword\">AS</span> <span class=\"keyword\">SELECT</span> com_name, price, dis_price, description, detail, com_image, collect_time</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">FROM</span> commodity <span class=\"keyword\">join</span> <span class=\"keyword\">collect</span> <span class=\"keyword\">on</span> commodity.com_id <span class=\"operator\">=</span> collect.com_id</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">where</span> user_id <span class=\"operator\">=</span> <span class=\"string\">&#x27;000111111&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">VIEW</span> personal_collect_history;</span><br><span class=\"line\"><span class=\"comment\">--æ¯ä¸ªæ¶ˆè´¹è€…çš„è®¢å•åˆ›å»ºè§†å›¾ï¼ˆæ”¹user_idï¼‰</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">VIEW</span> personal_order <span class=\"keyword\">AS</span> <span class=\"keyword\">SELECT</span> com_name, real_pay, pay_time, order_.description, detail, com_image, com_num, pickup_code</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">FROM</span> order_ <span class=\"keyword\">join</span> commodity <span class=\"keyword\">on</span> commodity.com_id <span class=\"operator\">=</span> order_.com_id</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">where</span> user_id <span class=\"operator\">=</span> <span class=\"string\">&#x27;000111111&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">VIEW</span> personal_order;</span><br><span class=\"line\"><span class=\"comment\">--ä¸ºå¥½å‹çš„èŠå¤©è®°å½•åˆ›å»ºè§†å›¾(user_id)</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">VIEW</span> chat_history <span class=\"keyword\">AS</span> <span class=\"keyword\">SELECT</span> message_content, message_date</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">FROM</span> conversation_message <span class=\"keyword\">join</span> friend_and_friend <span class=\"keyword\">on</span> conversation_message.message_id <span class=\"operator\">=</span> friend_and_friend.message_id</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">where</span> (sender_id <span class=\"operator\">=</span> <span class=\"string\">&#x27;tb12345&#x27;</span> <span class=\"keyword\">AND</span> receiver_id <span class=\"operator\">=</span> <span class=\"string\">&#x27;tb12342&#x27;</span>) <span class=\"keyword\">OR</span>  (sender_id <span class=\"operator\">=</span> <span class=\"string\">&#x27;tb12342&#x27;</span> <span class=\"keyword\">AND</span> receiver_id <span class=\"operator\">=</span> <span class=\"string\">&#x27;tb12345&#x27;</span>)</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">order</span> <span class=\"keyword\">by</span> message_date;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">VIEW</span> chat_history;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> com_food;</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> com_cloth;</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> com_ele_appliment;</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> com_ele_product;</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> com_makeup;</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> com_sport;</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> com_toy;</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> com_daily_necessarity;</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> chat_history;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">--è®¢å•è¡¨ç‰©æµè¡¨è§¦å‘å™¨</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">OR</span> REPLACE <span class=\"keyword\">FUNCTION</span> order_insert_trigger()</span><br><span class=\"line\"><span class=\"keyword\">RETURNS</span> <span class=\"keyword\">TRIGGER</span> <span class=\"keyword\">AS</span> $$</span><br><span class=\"line\"><span class=\"keyword\">BEGIN</span></span><br><span class=\"line\">    <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> logistics (com_id)</span><br><span class=\"line\">    <span class=\"keyword\">VALUES</span> (NEW.com_id);</span><br><span class=\"line\">    <span class=\"keyword\">RETURN</span> <span class=\"keyword\">NEW</span>;</span><br><span class=\"line\"><span class=\"keyword\">END</span>;</span><br><span class=\"line\">$$ <span class=\"keyword\">LANGUAGE</span> plpgsql;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TRIGGER</span> insert_order_trigger</span><br><span class=\"line\">AFTER <span class=\"keyword\">INSERT</span> <span class=\"keyword\">ON</span> order_</span><br><span class=\"line\"><span class=\"keyword\">FOR</span> <span class=\"keyword\">EACH</span> <span class=\"type\">ROW</span></span><br><span class=\"line\"><span class=\"keyword\">EXECUTE</span> <span class=\"keyword\">FUNCTION</span> order_insert_trigger();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">--åˆ é™¤è§¦å‘å™¨</span></span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TRIGGER</span> insert_order_trigger <span class=\"keyword\">ON</span> order_</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">--å•†å“è¡¨å‘ç”Ÿå˜åŒ–å†å²ä»·æ ¼è¡¨å˜åŒ–è§¦å‘å™¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">OR</span> REPLACE <span class=\"keyword\">FUNCTION</span> history_insert_trigger()</span><br><span class=\"line\"><span class=\"keyword\">RETURNS</span> <span class=\"keyword\">TRIGGER</span> <span class=\"keyword\">AS</span> $$</span><br><span class=\"line\"><span class=\"keyword\">BEGIN</span> </span><br><span class=\"line\">    <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> historical_price (com_id,<span class=\"type\">time</span>,price)</span><br><span class=\"line\">    <span class=\"keyword\">VALUES</span> (NEW.com_id,NOW(),NEW.price);</span><br><span class=\"line\">    <span class=\"keyword\">RETURN</span> <span class=\"keyword\">NEW</span>;</span><br><span class=\"line\"><span class=\"keyword\">END</span>;</span><br><span class=\"line\">$$ <span class=\"keyword\">LANGUAGE</span> plpgsql;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TRIGGER</span> insert_history_trigger</span><br><span class=\"line\">AFTER <span class=\"keyword\">UPDATE</span> <span class=\"keyword\">ON</span> commodity</span><br><span class=\"line\"><span class=\"keyword\">FOR</span> <span class=\"keyword\">EACH</span> <span class=\"type\">ROW</span></span><br><span class=\"line\"><span class=\"keyword\">EXECUTE</span> <span class=\"keyword\">FUNCTION</span> history_insert_trigger();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">--åˆ é™¤è§¦å‘å™¨</span></span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TRIGGER</span> insert_history_trigger <span class=\"keyword\">ON</span> commodity</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">--å•†å“å¤§è¡¨ä¸å­è¡¨è§¦å‘å™¨</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">OR</span> REPLACE <span class=\"keyword\">FUNCTION</span> insert_comsubtable_function()</span><br><span class=\"line\">  <span class=\"keyword\">RETURNS</span> <span class=\"keyword\">TRIGGER</span> <span class=\"keyword\">AS</span> $$</span><br><span class=\"line\"><span class=\"keyword\">BEGIN</span></span><br><span class=\"line\">  <span class=\"comment\">-- åˆ¤æ–­å•†å“ç±»åˆ«</span></span><br><span class=\"line\">  IF NEW.category <span class=\"operator\">=</span> <span class=\"string\">&#x27;food&#x27;</span> <span class=\"keyword\">THEN</span></span><br><span class=\"line\">    <span class=\"comment\">-- æ›´æ–°food</span></span><br><span class=\"line\">    <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> food(com_id,com_name,category,price,dis_price,num,description,detail,after_sale,up_time,com_image)</span><br><span class=\"line\">    <span class=\"keyword\">VALUES</span> (NEW.com_id,NEW.com_name,NEW.category,NEW.price,NEW.dis_price,NEW.num,NEW.description,NEW.detail,NEW.after_sale,NEW.up_time,NEW.com_image);</span><br><span class=\"line\">  ELSIF NEW.category <span class=\"operator\">=</span> <span class=\"string\">&#x27;cloth&#x27;</span> <span class=\"keyword\">THEN</span></span><br><span class=\"line\">    <span class=\"comment\">-- æ›´æ–°cloth</span></span><br><span class=\"line\">    <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> cloth(com_id,com_name,category,price,dis_price,num,description,detail,after_sale,up_time,com_image)</span><br><span class=\"line\">    <span class=\"keyword\">VALUES</span> (NEW.com_id,NEW.com_name,NEW.category,NEW.price,NEW.dis_price,NEW.num,NEW.description,NEW.detail,NEW.after_sale,NEW.up_time,NEW.com_image);</span><br><span class=\"line\">  ELSIF NEW.category <span class=\"operator\">=</span> <span class=\"string\">&#x27;ele_appliment&#x27;</span> <span class=\"keyword\">THEN</span></span><br><span class=\"line\">    <span class=\"comment\">-- æ›´æ–°ele_appliment</span></span><br><span class=\"line\">    <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> ele_appliment(com_id,com_name,category,price,dis_price,num,description,detail,after_sale,up_time,com_image)</span><br><span class=\"line\">    <span class=\"keyword\">VALUES</span> (NEW.com_id,NEW.com_name,NEW.category,NEW.price,NEW.dis_price,NEW.num,NEW.description,NEW.detail,NEW.after_sale,NEW.up_time,NEW.com_image);</span><br><span class=\"line\">  ELSIF NEW.category <span class=\"operator\">=</span> <span class=\"string\">&#x27;ele_product&#x27;</span> <span class=\"keyword\">THEN</span></span><br><span class=\"line\">    <span class=\"comment\">-- æ›´æ–°ele_product</span></span><br><span class=\"line\">    <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> ele_product(com_id,com_name,category,price,dis_price,num,description,detail,after_sale,up_time,com_image)</span><br><span class=\"line\">    <span class=\"keyword\">VALUES</span> (NEW.com_id,NEW.com_name,NEW.category,NEW.price,NEW.dis_price,NEW.num,NEW.description,NEW.detail,NEW.after_sale,NEW.up_time,NEW.com_image);</span><br><span class=\"line\">  ELSIF NEW.category <span class=\"operator\">=</span> <span class=\"string\">&#x27;makeup&#x27;</span> <span class=\"keyword\">THEN</span></span><br><span class=\"line\">    <span class=\"comment\">-- æ›´æ–°makeup</span></span><br><span class=\"line\">    <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> makeup(com_id,com_name,category,price,dis_price,num,description,detail,after_sale,up_time,com_image)</span><br><span class=\"line\">    <span class=\"keyword\">VALUES</span> (NEW.com_id,NEW.com_name,NEW.category,NEW.price,NEW.dis_price,NEW.num,NEW.description,NEW.detail,NEW.after_sale,NEW.up_time,NEW.com_image);</span><br><span class=\"line\">  ELSIF NEW.category <span class=\"operator\">=</span> <span class=\"string\">&#x27;sport&#x27;</span> <span class=\"keyword\">THEN</span></span><br><span class=\"line\">    <span class=\"comment\">-- æ›´æ–°sport</span></span><br><span class=\"line\">    <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> sport(com_id,com_name,category,price,dis_price,num,description,detail,after_sale,up_time,com_image)</span><br><span class=\"line\">    <span class=\"keyword\">VALUES</span> (NEW.com_id,NEW.com_name,NEW.category,NEW.price,NEW.dis_price,NEW.num,NEW.description,NEW.detail,NEW.after_sale,NEW.up_time,NEW.com_image);</span><br><span class=\"line\">  ELSIF NEW.category <span class=\"operator\">=</span> <span class=\"string\">&#x27;toy&#x27;</span> <span class=\"keyword\">THEN</span></span><br><span class=\"line\">    <span class=\"comment\">-- æ›´æ–°toy</span></span><br><span class=\"line\">    <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> toy(com_id,com_name,category,price,dis_price,num,description,detail,after_sale,up_time,com_image)</span><br><span class=\"line\">    <span class=\"keyword\">VALUES</span> (NEW.com_id,NEW.com_name,NEW.category,NEW.price,NEW.dis_price,NEW.num,NEW.description,NEW.detail,NEW.after_sale,NEW.up_time,NEW.com_image);</span><br><span class=\"line\">  ELSIF NEW.category <span class=\"operator\">=</span> <span class=\"string\">&#x27;daily_necessarity&#x27;</span> <span class=\"keyword\">THEN</span></span><br><span class=\"line\">    <span class=\"comment\">-- æ›´æ–°daily_necessarity</span></span><br><span class=\"line\">    <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> daily_necessarity(com_id,com_name,category,price,dis_price,num,description,detail,after_sale,up_time,com_image)</span><br><span class=\"line\">    <span class=\"keyword\">VALUES</span> (NEW.com_id,NEW.com_name,NEW.category,NEW.price,NEW.dis_price,NEW.num,NEW.description,NEW.detail,NEW.after_sale,NEW.up_time,NEW.com_image);</span><br><span class=\"line\">  <span class=\"keyword\">ELSE</span> </span><br><span class=\"line\">    <span class=\"comment\">-- æ›´æ–°other</span></span><br><span class=\"line\">    <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> other(com_id,com_name,category,price,dis_price,num,description,detail,after_sale,up_time,com_image)</span><br><span class=\"line\">    <span class=\"keyword\">VALUES</span> (NEW.com_id,NEW.com_name,NEW.category,NEW.price,NEW.dis_price,NEW.num,NEW.description,NEW.detail,NEW.after_sale,NEW.up_time,NEW.com_image);</span><br><span class=\"line\">  <span class=\"keyword\">END</span> IF;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">RETURN</span> <span class=\"keyword\">NEW</span>;</span><br><span class=\"line\"><span class=\"keyword\">END</span>;</span><br><span class=\"line\">$$ <span class=\"keyword\">LANGUAGE</span> plpgsql;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TRIGGER</span> insert_comsubtable_trigger</span><br><span class=\"line\">AFTER <span class=\"keyword\">INSERT</span> <span class=\"keyword\">ON</span> commodity</span><br><span class=\"line\"><span class=\"keyword\">FOR</span> <span class=\"keyword\">EACH</span> <span class=\"type\">ROW</span></span><br><span class=\"line\"><span class=\"keyword\">EXECUTE</span> <span class=\"keyword\">FUNCTION</span> insert_comsubtable_function();</span><br><span class=\"line\">\t\t\t\t\t\t\t\t  </span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TRIGGER</span> insert_comsubtable_trigger <span class=\"keyword\">ON</span> commodity</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">OR</span> REPLACE <span class=\"keyword\">FUNCTION</span> update_comsubtable_function()</span><br><span class=\"line\">  <span class=\"keyword\">RETURNS</span> <span class=\"keyword\">TRIGGER</span> <span class=\"keyword\">AS</span> $$</span><br><span class=\"line\"><span class=\"keyword\">BEGIN</span></span><br><span class=\"line\">  <span class=\"comment\">-- åˆ¤æ–­å•†å“ç±»åˆ«</span></span><br><span class=\"line\">  IF OLD.category <span class=\"operator\">=</span> <span class=\"string\">&#x27;food&#x27;</span> <span class=\"keyword\">THEN</span></span><br><span class=\"line\">    <span class=\"comment\">-- æ›´æ–°food</span></span><br><span class=\"line\">    <span class=\"keyword\">UPDATE</span> food</span><br><span class=\"line\">    <span class=\"keyword\">SET</span> com_name<span class=\"operator\">=</span>NEW.com_name,category<span class=\"operator\">=</span>NEW.category,price<span class=\"operator\">=</span>NEW.price,dis_price<span class=\"operator\">=</span>NEW.dis_price,num<span class=\"operator\">=</span>NEW.num,</span><br><span class=\"line\">    description<span class=\"operator\">=</span>NEW.description,detail<span class=\"operator\">=</span>NEW.detail,after_sale<span class=\"operator\">=</span>NEW.after_sale,up_time<span class=\"operator\">=</span>NEW.up_time,com_image<span class=\"operator\">=</span>NEW.com_image</span><br><span class=\"line\">    <span class=\"keyword\">WHERE</span> com_id<span class=\"operator\">=</span>NEW.com_id;</span><br><span class=\"line\">  ELSIF OLD.category <span class=\"operator\">=</span> <span class=\"string\">&#x27;cloth&#x27;</span> <span class=\"keyword\">THEN</span></span><br><span class=\"line\">    <span class=\"comment\">-- æ›´æ–°cloth</span></span><br><span class=\"line\">    <span class=\"keyword\">UPDATE</span> cloth</span><br><span class=\"line\">    <span class=\"keyword\">SET</span> com_name<span class=\"operator\">=</span>NEW.com_name,category<span class=\"operator\">=</span>NEW.category,price<span class=\"operator\">=</span>NEW.price,dis_price<span class=\"operator\">=</span>NEW.dis_price,num<span class=\"operator\">=</span>NEW.num,</span><br><span class=\"line\">    description<span class=\"operator\">=</span>NEW.description,detail<span class=\"operator\">=</span>NEW.detail,after_sale<span class=\"operator\">=</span>NEW.after_sale,up_time<span class=\"operator\">=</span>NEW.up_time,com_image<span class=\"operator\">=</span>NEW.com_image</span><br><span class=\"line\">    <span class=\"keyword\">WHERE</span> com_id<span class=\"operator\">=</span>NEW.com_id;</span><br><span class=\"line\">  ELSIF OLD.category <span class=\"operator\">=</span> <span class=\"string\">&#x27;ele_appliment&#x27;</span> <span class=\"keyword\">THEN</span></span><br><span class=\"line\">    <span class=\"comment\">-- æ›´æ–°ele_appliment</span></span><br><span class=\"line\">    <span class=\"keyword\">UPDATE</span> ele_appliment</span><br><span class=\"line\">    <span class=\"keyword\">SET</span> com_name<span class=\"operator\">=</span>NEW.com_name,category<span class=\"operator\">=</span>NEW.category,price<span class=\"operator\">=</span>NEW.price,dis_price<span class=\"operator\">=</span>NEW.dis_price,num<span class=\"operator\">=</span>NEW.num,</span><br><span class=\"line\">    description<span class=\"operator\">=</span>NEW.description,detail<span class=\"operator\">=</span>NEW.detail,after_sale<span class=\"operator\">=</span>NEW.after_sale,up_time<span class=\"operator\">=</span>NEW.up_time,com_image<span class=\"operator\">=</span>NEW.com_image</span><br><span class=\"line\">    <span class=\"keyword\">WHERE</span> com_id<span class=\"operator\">=</span>NEW.com_id;</span><br><span class=\"line\">  ELSIF OLD.category <span class=\"operator\">=</span> <span class=\"string\">&#x27;ele_product&#x27;</span> <span class=\"keyword\">THEN</span></span><br><span class=\"line\">    <span class=\"comment\">-- æ›´æ–°ele_product</span></span><br><span class=\"line\">    <span class=\"keyword\">UPDATE</span> ele_product</span><br><span class=\"line\">    <span class=\"keyword\">SET</span> com_name<span class=\"operator\">=</span>NEW.com_name,category<span class=\"operator\">=</span>NEW.category,price<span class=\"operator\">=</span>NEW.price,dis_price<span class=\"operator\">=</span>NEW.dis_price,num<span class=\"operator\">=</span>NEW.num,</span><br><span class=\"line\">    description<span class=\"operator\">=</span>NEW.description,detail<span class=\"operator\">=</span>NEW.detail,after_sale<span class=\"operator\">=</span>NEW.after_sale,up_time<span class=\"operator\">=</span>NEW.up_time,com_image<span class=\"operator\">=</span>NEW.com_image</span><br><span class=\"line\">    <span class=\"keyword\">WHERE</span> com_id<span class=\"operator\">=</span>NEW.com_id;</span><br><span class=\"line\">  ELSIF OLD.category <span class=\"operator\">=</span> <span class=\"string\">&#x27;makeup&#x27;</span> <span class=\"keyword\">THEN</span></span><br><span class=\"line\">    <span class=\"comment\">-- æ›´æ–°makeup</span></span><br><span class=\"line\">    <span class=\"keyword\">UPDATE</span> makeup</span><br><span class=\"line\">    <span class=\"keyword\">SET</span> com_name<span class=\"operator\">=</span>NEW.com_name,category<span class=\"operator\">=</span>NEW.category,price<span class=\"operator\">=</span>NEW.price,dis_price<span class=\"operator\">=</span>NEW.dis_price,num<span class=\"operator\">=</span>NEW.num,</span><br><span class=\"line\">    description<span class=\"operator\">=</span>NEW.description,detail<span class=\"operator\">=</span>NEW.detail,after_sale<span class=\"operator\">=</span>NEW.after_sale,up_time<span class=\"operator\">=</span>NEW.up_time,com_image<span class=\"operator\">=</span>NEW.com_image</span><br><span class=\"line\">    <span class=\"keyword\">WHERE</span> com_id<span class=\"operator\">=</span>NEW.com_id;</span><br><span class=\"line\">  ELSIF OLD.category <span class=\"operator\">=</span> <span class=\"string\">&#x27;sport&#x27;</span> <span class=\"keyword\">THEN</span></span><br><span class=\"line\">    <span class=\"comment\">-- æ›´æ–°sport</span></span><br><span class=\"line\">    <span class=\"keyword\">UPDATE</span> sport</span><br><span class=\"line\">    <span class=\"keyword\">SET</span> com_name<span class=\"operator\">=</span>NEW.com_name,category<span class=\"operator\">=</span>NEW.category,price<span class=\"operator\">=</span>NEW.price,dis_price<span class=\"operator\">=</span>NEW.dis_price,num<span class=\"operator\">=</span>NEW.num,</span><br><span class=\"line\">    description<span class=\"operator\">=</span>NEW.description,detail<span class=\"operator\">=</span>NEW.detail,after_sale<span class=\"operator\">=</span>NEW.after_sale,up_time<span class=\"operator\">=</span>NEW.up_time,com_image<span class=\"operator\">=</span>NEW.com_image</span><br><span class=\"line\">    <span class=\"keyword\">WHERE</span> com_id<span class=\"operator\">=</span>NEW.com_id;</span><br><span class=\"line\">  ELSIF OLD.category <span class=\"operator\">=</span> <span class=\"string\">&#x27;toy&#x27;</span> <span class=\"keyword\">THEN</span></span><br><span class=\"line\">    <span class=\"comment\">-- æ›´æ–°toy</span></span><br><span class=\"line\">    <span class=\"keyword\">UPDATE</span> toy</span><br><span class=\"line\">    <span class=\"keyword\">SET</span> com_name<span class=\"operator\">=</span>NEW.com_name,category<span class=\"operator\">=</span>NEW.category,price<span class=\"operator\">=</span>NEW.price,dis_price<span class=\"operator\">=</span>NEW.dis_price,num<span class=\"operator\">=</span>NEW.num,</span><br><span class=\"line\">    description<span class=\"operator\">=</span>NEW.description,detail<span class=\"operator\">=</span>NEW.detail,after_sale<span class=\"operator\">=</span>NEW.after_sale,up_time<span class=\"operator\">=</span>NEW.up_time,com_image<span class=\"operator\">=</span>NEW.com_image</span><br><span class=\"line\">    <span class=\"keyword\">WHERE</span> com_id<span class=\"operator\">=</span>NEW.com_id;</span><br><span class=\"line\">  ELSIF OLD.category <span class=\"operator\">=</span> <span class=\"string\">&#x27;daily_necessarity&#x27;</span> <span class=\"keyword\">THEN</span></span><br><span class=\"line\">    <span class=\"comment\">-- æ›´æ–°daily_necessarity</span></span><br><span class=\"line\">    <span class=\"keyword\">UPDATE</span> daily_necessarity</span><br><span class=\"line\">    <span class=\"keyword\">SET</span> com_name<span class=\"operator\">=</span>NEW.com_name,category<span class=\"operator\">=</span>NEW.category,price<span class=\"operator\">=</span>NEW.price,dis_price<span class=\"operator\">=</span>NEW.dis_price,num<span class=\"operator\">=</span>NEW.num,</span><br><span class=\"line\">    description<span class=\"operator\">=</span>NEW.description,detail<span class=\"operator\">=</span>NEW.detail,after_sale<span class=\"operator\">=</span>NEW.after_sale,up_time<span class=\"operator\">=</span>NEW.up_time,com_image<span class=\"operator\">=</span>NEW.com_image</span><br><span class=\"line\">    <span class=\"keyword\">WHERE</span> com_id<span class=\"operator\">=</span>NEW.com_id;</span><br><span class=\"line\">  <span class=\"keyword\">ELSE</span> </span><br><span class=\"line\">    <span class=\"comment\">-- æ›´æ–°other</span></span><br><span class=\"line\">    <span class=\"keyword\">UPDATE</span> other</span><br><span class=\"line\">    <span class=\"keyword\">SET</span> com_name<span class=\"operator\">=</span>NEW.com_name,category<span class=\"operator\">=</span>NEW.category,price<span class=\"operator\">=</span>NEW.price,dis_price<span class=\"operator\">=</span>NEW.dis_price,num<span class=\"operator\">=</span>NEW.num,</span><br><span class=\"line\">    description<span class=\"operator\">=</span>NEW.description,detail<span class=\"operator\">=</span>NEW.detail,after_sale<span class=\"operator\">=</span>NEW.after_sale,up_time<span class=\"operator\">=</span>NEW.up_time,com_image<span class=\"operator\">=</span>NEW.com_image</span><br><span class=\"line\">    <span class=\"keyword\">WHERE</span> com_id<span class=\"operator\">=</span>NEW.com_id;</span><br><span class=\"line\">  <span class=\"keyword\">END</span> IF;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">RETURN</span> <span class=\"keyword\">NEW</span>;</span><br><span class=\"line\"><span class=\"keyword\">END</span>;</span><br><span class=\"line\">$$ <span class=\"keyword\">LANGUAGE</span> plpgsql;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TRIGGER</span> update_comsubtable_trigger</span><br><span class=\"line\">AFTER <span class=\"keyword\">UPDATE</span> <span class=\"keyword\">ON</span> commodity</span><br><span class=\"line\"><span class=\"keyword\">FOR</span> <span class=\"keyword\">EACH</span> <span class=\"type\">ROW</span></span><br><span class=\"line\"><span class=\"keyword\">EXECUTE</span> <span class=\"keyword\">FUNCTION</span> update_comsubtable_function();</span><br><span class=\"line\">\t\t\t\t\t\t\t\t  </span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TRIGGER</span> update_comsubtable_trigger <span class=\"keyword\">ON</span> commodity</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">OR</span> REPLACE <span class=\"keyword\">FUNCTION</span> delete_comsubtable_function()</span><br><span class=\"line\">  <span class=\"keyword\">RETURNS</span> <span class=\"keyword\">TRIGGER</span> <span class=\"keyword\">AS</span> $$</span><br><span class=\"line\"><span class=\"keyword\">BEGIN</span></span><br><span class=\"line\">  <span class=\"comment\">-- åˆ¤æ–­å•†å“ç±»åˆ«</span></span><br><span class=\"line\">  IF OLD.category <span class=\"operator\">=</span> <span class=\"string\">&#x27;food&#x27;</span> <span class=\"keyword\">THEN</span></span><br><span class=\"line\">    <span class=\"comment\">-- æ›´æ–°food</span></span><br><span class=\"line\">    <span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> food</span><br><span class=\"line\">    <span class=\"keyword\">WHERE</span> com_id<span class=\"operator\">=</span>OLD.com_id;</span><br><span class=\"line\">  ELSIF OLD.category <span class=\"operator\">=</span> <span class=\"string\">&#x27;cloth&#x27;</span> <span class=\"keyword\">THEN</span></span><br><span class=\"line\">    <span class=\"comment\">-- æ›´æ–°cloth</span></span><br><span class=\"line\">    <span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> cloth</span><br><span class=\"line\">    <span class=\"keyword\">WHERE</span> com_id<span class=\"operator\">=</span>OLD.com_id;</span><br><span class=\"line\">  ELSIF OLD.category <span class=\"operator\">=</span> <span class=\"string\">&#x27;ele_appliment&#x27;</span> <span class=\"keyword\">THEN</span></span><br><span class=\"line\">    <span class=\"comment\">-- æ›´æ–°ele_appliment</span></span><br><span class=\"line\">    <span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> ele_appliment</span><br><span class=\"line\">    <span class=\"keyword\">WHERE</span> com_id<span class=\"operator\">=</span>OLD.com_id;</span><br><span class=\"line\">  ELSIF OLD.category <span class=\"operator\">=</span> <span class=\"string\">&#x27;ele_product&#x27;</span> <span class=\"keyword\">THEN</span></span><br><span class=\"line\">    <span class=\"comment\">-- æ›´æ–°ele_product</span></span><br><span class=\"line\">    <span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> ele_product</span><br><span class=\"line\">    <span class=\"keyword\">WHERE</span> com_id<span class=\"operator\">=</span>OLD.com_id;</span><br><span class=\"line\">  ELSIF OLD.category <span class=\"operator\">=</span> <span class=\"string\">&#x27;makeup&#x27;</span> <span class=\"keyword\">THEN</span></span><br><span class=\"line\">    <span class=\"comment\">-- æ›´æ–°makeup</span></span><br><span class=\"line\">    <span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> makeup</span><br><span class=\"line\">    <span class=\"keyword\">WHERE</span> com_id<span class=\"operator\">=</span>OLD.com_id;</span><br><span class=\"line\">  ELSIF OLD.category <span class=\"operator\">=</span> <span class=\"string\">&#x27;sport&#x27;</span> <span class=\"keyword\">THEN</span></span><br><span class=\"line\">    <span class=\"comment\">-- æ›´æ–°sport</span></span><br><span class=\"line\">    <span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> sport</span><br><span class=\"line\">    <span class=\"keyword\">WHERE</span> com_id<span class=\"operator\">=</span>OLD.com_id;</span><br><span class=\"line\">  ELSIF OLD.category <span class=\"operator\">=</span> <span class=\"string\">&#x27;toy&#x27;</span> <span class=\"keyword\">THEN</span></span><br><span class=\"line\">    <span class=\"comment\">-- æ›´æ–°toy</span></span><br><span class=\"line\">    <span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> toy</span><br><span class=\"line\">    <span class=\"keyword\">WHERE</span> com_id<span class=\"operator\">=</span>OLD.com_id;</span><br><span class=\"line\">  ELSIF OLD.category <span class=\"operator\">=</span> <span class=\"string\">&#x27;daily_necessarity&#x27;</span> <span class=\"keyword\">THEN</span></span><br><span class=\"line\">    <span class=\"comment\">-- æ›´æ–°daily_necessarity</span></span><br><span class=\"line\">    <span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> daily_necessarity</span><br><span class=\"line\">    <span class=\"keyword\">WHERE</span> com_id<span class=\"operator\">=</span>OLD.com_id;</span><br><span class=\"line\">  <span class=\"keyword\">ELSE</span> </span><br><span class=\"line\">    <span class=\"comment\">-- æ›´æ–°other</span></span><br><span class=\"line\">    <span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> other</span><br><span class=\"line\">    <span class=\"keyword\">WHERE</span> com_id<span class=\"operator\">=</span>OLD.com_id;</span><br><span class=\"line\">  <span class=\"keyword\">END</span> IF;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">RETURN</span> <span class=\"keyword\">OLD</span>;</span><br><span class=\"line\"><span class=\"keyword\">END</span>;</span><br><span class=\"line\">$$ <span class=\"keyword\">LANGUAGE</span> plpgsql;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TRIGGER</span> delete_comsubtable_trigger</span><br><span class=\"line\">AFTER <span class=\"keyword\">DELETE</span> <span class=\"keyword\">ON</span> commodity</span><br><span class=\"line\"><span class=\"keyword\">FOR</span> <span class=\"keyword\">EACH</span> <span class=\"type\">ROW</span></span><br><span class=\"line\"><span class=\"keyword\">EXECUTE</span> <span class=\"keyword\">FUNCTION</span> delete_comsubtable_function();</span><br><span class=\"line\">\t\t\t\t\t\t\t\t  </span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TRIGGER</span> delete_comsubtable_trigger <span class=\"keyword\">ON</span> commodity</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- å‡½æ•°</span></span><br><span class=\"line\"><span class=\"comment\">-- è®¡ç®—å•†å“ä»·æ ¼</span></span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">FUNCTION</span> calculate_price( <span class=\"keyword\">IN</span> product_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),<span class=\"keyword\">IN</span> user_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),<span class=\"keyword\">INOUT</span> total_payment <span class=\"type\">DOUBLE PRECISION</span>);</span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">OR</span> REPLACE <span class=\"keyword\">FUNCTION</span> calculate_price(</span><br><span class=\"line\">    <span class=\"keyword\">IN</span> product_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    <span class=\"keyword\">IN</span> user_id2 <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    <span class=\"keyword\">INOUT</span> total_payment <span class=\"type\">DOUBLE PRECISION</span></span><br><span class=\"line\">) <span class=\"keyword\">AS</span> $$</span><br><span class=\"line\"><span class=\"keyword\">DECLARE</span></span><br><span class=\"line\">    product_price <span class=\"type\">DOUBLE PRECISION</span>;</span><br><span class=\"line\">\tdiscount_price <span class=\"type\">DOUBLE PRECISION</span>;</span><br><span class=\"line\">    red_packet_discount <span class=\"type\">DOUBLE PRECISION</span>;</span><br><span class=\"line\">    red_packet_id2 <span class=\"type\">INT</span>;</span><br><span class=\"line\"><span class=\"keyword\">BEGIN</span></span><br><span class=\"line\">    <span class=\"keyword\">SELECT</span> price <span class=\"keyword\">INTO</span> product_price <span class=\"keyword\">FROM</span> commodity <span class=\"keyword\">WHERE</span> com_id <span class=\"operator\">=</span> product_id;</span><br><span class=\"line\">\t<span class=\"keyword\">SELECT</span> dis_price <span class=\"keyword\">INTO</span> discount_price <span class=\"keyword\">FROM</span> commodity <span class=\"keyword\">WHERE</span> com_id <span class=\"operator\">=</span> product_id;</span><br><span class=\"line\">    <span class=\"keyword\">SELECT</span> red_packet_id <span class=\"keyword\">INTO</span> red_packet_id2 <span class=\"keyword\">FROM</span> consumer_recieve_redpacket <span class=\"keyword\">WHERE</span> user_id <span class=\"operator\">=</span> user_id2;</span><br><span class=\"line\">    <span class=\"keyword\">SELECT</span> value_ <span class=\"keyword\">INTO</span> red_packet_discount <span class=\"keyword\">FROM</span> red_packet <span class=\"keyword\">WHERE</span> red_packet_id <span class=\"operator\">=</span> red_packet_id2;</span><br><span class=\"line\">\tRAISE INFO <span class=\"string\">&#x27;origin price: %&#x27;</span>, product_price;</span><br><span class=\"line\">\tRAISE INFO <span class=\"string\">&#x27;discount_price: %&#x27;</span>, discount_price;</span><br><span class=\"line\">\tRAISE INFO <span class=\"string\">&#x27;red_packet_discount: %&#x27;</span>, red_packet_discount;</span><br><span class=\"line\">    total_payment :<span class=\"operator\">=</span> product_price <span class=\"operator\">-</span> red_packet_discount <span class=\"operator\">-</span> discount_price;</span><br><span class=\"line\">    <span class=\"comment\">-- æ›´æ–°çº¢åŒ…è¡¨</span></span><br><span class=\"line\">    <span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> consumer_recieve_redpacket <span class=\"keyword\">WHERE</span> user_id <span class=\"operator\">=</span> user_id;</span><br><span class=\"line\">    <span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> red_packet <span class=\"keyword\">WHERE</span> red_packet_id <span class=\"operator\">=</span> red_packet_id;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">RETURN</span>;</span><br><span class=\"line\"><span class=\"keyword\">END</span>;</span><br><span class=\"line\">$$ <span class=\"keyword\">LANGUAGE</span> plpgsql;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- ç›´æ¥è´­ä¹°å•†å“</span></span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">FUNCTION</span> buy_commodity_directly(<span class=\"keyword\">IN</span> product_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),<span class=\"keyword\">IN</span> user_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),<span class=\"keyword\">IN</span> order_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),<span class=\"keyword\">IN</span> buy_num <span class=\"type\">INT</span>);</span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">OR</span> REPLACE <span class=\"keyword\">FUNCTION</span> buy_commodity_directly(</span><br><span class=\"line\">    <span class=\"keyword\">IN</span> product_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    <span class=\"keyword\">IN</span> user_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\t<span class=\"keyword\">IN</span> order_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\t<span class=\"keyword\">IN</span> buy_num <span class=\"type\">INT</span></span><br><span class=\"line\">) <span class=\"keyword\">RETURNS</span> VOID <span class=\"keyword\">AS</span> $$</span><br><span class=\"line\"><span class=\"keyword\">DECLARE</span></span><br><span class=\"line\">    total_payment <span class=\"type\">DOUBLE PRECISION</span>;</span><br><span class=\"line\"><span class=\"keyword\">BEGIN</span></span><br><span class=\"line\">    <span class=\"keyword\">UPDATE</span> commodity <span class=\"keyword\">SET</span> num <span class=\"operator\">=</span> num <span class=\"operator\">-</span> buy_num <span class=\"keyword\">WHERE</span> com_id <span class=\"operator\">=</span> product_id;</span><br><span class=\"line\">\t<span class=\"keyword\">SELECT</span> calculate_price(product_id,user_id,total_payment) <span class=\"keyword\">INTO</span> total_payment;</span><br><span class=\"line\">\t<span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> order_ <span class=\"keyword\">VALUES</span> (order_id,product_id,user_id,total_payment,<span class=\"built_in\">CURRENT_TIMESTAMP</span>,<span class=\"built_in\">CURRENT_TIMESTAMP</span>,<span class=\"string\">&#x27;WAITDELIVER&#x27;</span>) ;</span><br><span class=\"line\">\tRAISE INFO <span class=\"string\">&#x27;Calculated Total Payment: %&#x27;</span>, total_payment;</span><br><span class=\"line\">\tRAISE INFO <span class=\"string\">&#x27;Insert order&#x27;</span>;</span><br><span class=\"line\">\tRAISE INFO <span class=\"string\">&#x27;update Commodity num&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">END</span>;</span><br><span class=\"line\">$$ <span class=\"keyword\">LANGUAGE</span> plpgsql;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> red_packet</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span>(<span class=\"number\">1</span>,<span class=\"string\">&#x27;æ— é—¨æ§›çº¢åŒ…&#x27;</span>,<span class=\"number\">2</span>,<span class=\"string\">&#x27;æ— é—¨æ§›&#x27;</span>,<span class=\"string\">&#x27;2023-12-25&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> consumer_recieve_redpacket</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;tb12345&#x27;</span>,<span class=\"number\">1</span>);</span><br><span class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> order_ <span class=\"keyword\">WHERE</span> order_id <span class=\"operator\">=</span> <span class=\"string\">&#x27;com12347tb12345&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> logistics <span class=\"keyword\">WHERE</span> com_id <span class=\"operator\">=</span> <span class=\"string\">&#x27;com12347&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">UPDATE</span> commodity <span class=\"keyword\">SET</span> num <span class=\"operator\">=</span> <span class=\"number\">1000</span> <span class=\"keyword\">WHERE</span> com_id <span class=\"operator\">=</span> <span class=\"string\">&#x27;com12347&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> buy_commodity_directly(<span class=\"string\">&#x27;com12347&#x27;</span>, <span class=\"string\">&#x27;tb12345&#x27;</span>, <span class=\"string\">&#x27;com12347tb12345&#x27;</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> order_;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> commodity <span class=\"keyword\">WHERE</span> com_id <span class=\"operator\">=</span> <span class=\"string\">&#x27;com12347&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> food <span class=\"keyword\">WHERE</span> com_id <span class=\"operator\">=</span> <span class=\"string\">&#x27;com12347&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> logistics;</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> red_packet;</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> consumer_recieve_redpacket;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- åº—é“ºä¸Šæ¶å•†å“</span></span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">FUNCTION</span> store_launch_commodity(<span class=\"keyword\">IN</span> product_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),<span class=\"keyword\">IN</span> user_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),<span class=\"keyword\">IN</span> launch_num <span class=\"type\">INT</span>);</span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">OR</span> REPLACE <span class=\"keyword\">FUNCTION</span> store_launch_commodity(</span><br><span class=\"line\">    <span class=\"keyword\">IN</span> product_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    <span class=\"keyword\">IN</span> store_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\t<span class=\"keyword\">IN</span> launch_num <span class=\"type\">INT</span></span><br><span class=\"line\">) <span class=\"keyword\">RETURNS</span> VOID <span class=\"keyword\">AS</span> $$</span><br><span class=\"line\"><span class=\"keyword\">BEGIN</span></span><br><span class=\"line\">    <span class=\"keyword\">UPDATE</span> commodity <span class=\"keyword\">SET</span> num <span class=\"operator\">=</span> num <span class=\"operator\">-</span> launch_num <span class=\"keyword\">WHERE</span> com_id <span class=\"operator\">=</span> product_id;</span><br><span class=\"line\">\t<span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> sell <span class=\"keyword\">VALUES</span> (store_id,com_id,<span class=\"built_in\">CURRENT_TIMESTAMP</span>) ;</span><br><span class=\"line\"><span class=\"keyword\">END</span>;</span><br><span class=\"line\">$$ <span class=\"keyword\">LANGUAGE</span> plpgsql;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- é€€è´§</span></span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">FUNCTION</span> return_commodity(<span class=\"keyword\">IN</span> product_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),<span class=\"keyword\">IN</span> user_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),<span class=\"keyword\">IN</span> buy_num <span class=\"type\">INT</span>);</span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">OR</span> REPLACE <span class=\"keyword\">FUNCTION</span> return_commodity(</span><br><span class=\"line\">    <span class=\"keyword\">IN</span> product_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    <span class=\"keyword\">IN</span> user_id <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">\t<span class=\"keyword\">IN</span> buy_num <span class=\"type\">INT</span></span><br><span class=\"line\">) <span class=\"keyword\">RETURNS</span> VOID <span class=\"keyword\">AS</span> $$</span><br><span class=\"line\"><span class=\"keyword\">DECLARE</span></span><br><span class=\"line\">    total_payment <span class=\"type\">DOUBLE PRECISION</span>;</span><br><span class=\"line\"><span class=\"keyword\">BEGIN</span></span><br><span class=\"line\">    <span class=\"keyword\">UPDATE</span> commodity <span class=\"keyword\">SET</span> num <span class=\"operator\">=</span> num <span class=\"operator\">+</span> buy_num <span class=\"keyword\">WHERE</span> com_id <span class=\"operator\">=</span> product_id;</span><br><span class=\"line\">\t<span class=\"keyword\">UPDATE</span> order_ <span class=\"keyword\">SET</span> state <span class=\"operator\">=</span> <span class=\"string\">&#x27;REFUNDING&#x27;</span> <span class=\"keyword\">WHERE</span> com_id <span class=\"operator\">=</span> product_id <span class=\"keyword\">AND</span> user_id <span class=\"operator\">=</span> user_id;</span><br><span class=\"line\"><span class=\"keyword\">END</span>;</span><br><span class=\"line\">$$ <span class=\"keyword\">LANGUAGE</span> plpgsql;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> users <span class=\"keyword\">WHERE</span> user_id <span class=\"operator\">=</span> <span class=\"string\">&#x27;tb12347&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> users</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;tb12345&#x27;</span>, <span class=\"string\">&#x27;Daming&#x27;</span>, <span class=\"string\">&#x27;123456789&#x27;</span>, <span class=\"string\">&#x27;F&#x27;</span>, <span class=\"string\">&#x27;13981367234&#x27;</span>, <span class=\"string\">&#x27;consumer&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> users</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;tb12342&#x27;</span>, <span class=\"string\">&#x27;Amy&#x27;</span>, <span class=\"string\">&#x27;a123456789&#x27;</span>, <span class=\"string\">&#x27;M&#x27;</span>, <span class=\"string\">&#x27;13981367555&#x27;</span>, <span class=\"string\">&#x27;consumer&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> users</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;tb12341&#x27;</span>, <span class=\"string\">&#x27;LingLing&#x27;</span>, <span class=\"string\">&#x27;l123456789&#x27;</span>, <span class=\"string\">&#x27;M&#x27;</span>, <span class=\"string\">&#x27;13221367234&#x27;</span>,<span class=\"string\">&#x27;consumer&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> users</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;tb12343&#x27;</span>, <span class=\"string\">&#x27;David&#x27;</span>, <span class=\"string\">&#x27;d123456789&#x27;</span>, <span class=\"string\">&#x27;F&#x27;</span>, <span class=\"string\">&#x27;13987767234&#x27;</span>, <span class=\"string\">&#x27;consumer&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> users</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;tb12344&#x27;</span>, <span class=\"string\">&#x27;sally&#x27;</span>, <span class=\"string\">&#x27;s123456789&#x27;</span>, <span class=\"string\">&#x27;M&#x27;</span>, <span class=\"string\">&#x27;13984467234&#x27;</span>, <span class=\"string\">&#x27;consumer&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> users</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;tb12347&#x27;</span>, <span class=\"string\">&#x27;Tom&#x27;</span>, <span class=\"string\">&#x27;t123456789&#x27;</span>, <span class=\"string\">&#x27;F&#x27;</span>, <span class=\"string\">&#x27;13984467234&#x27;</span>, <span class=\"string\">&#x27;seller&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> users</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;tb12346&#x27;</span>, <span class=\"string\">&#x27;Jerry&#x27;</span>, <span class=\"string\">&#x27;j123456789&#x27;</span>, <span class=\"string\">&#x27;M&#x27;</span>, <span class=\"string\">&#x27;13921367234&#x27;</span>, <span class=\"string\">&#x27;seller&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> users</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;tb12348&#x27;</span>, <span class=\"string\">&#x27;Jack&#x27;</span>, <span class=\"string\">&#x27;j1234567689&#x27;</span>, <span class=\"string\">&#x27;M&#x27;</span>, <span class=\"string\">&#x27;15581367234&#x27;</span>, <span class=\"string\">&#x27;seller&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> users</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;tb12349&#x27;</span>, <span class=\"string\">&#x27;Rose&#x27;</span>, <span class=\"string\">&#x27;r123456789&#x27;</span>, <span class=\"string\">&#x27;F&#x27;</span>, <span class=\"string\">&#x27;15481367234&#x27;</span>, <span class=\"string\">&#x27;seller&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> users</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;tb12340&#x27;</span>, <span class=\"string\">&#x27;Lily&#x27;</span>, <span class=\"string\">&#x27;l123456789&#x27;</span>, <span class=\"string\">&#x27;F&#x27;</span>, <span class=\"string\">&#x27;15681367234&#x27;</span>, <span class=\"string\">&#x27;seller&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">TABLE</span> consumer</span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">COLUMN</span> headshot TYPE <span class=\"type\">VARCHAR</span>(<span class=\"number\">500</span>); </span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> consumer</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;tb12345&#x27;</span>, <span class=\"string\">&#x27;Daming&#x27;</span>, <span class=\"string\">&#x27;123456789&#x27;</span>, <span class=\"string\">&#x27;F&#x27;</span>, <span class=\"string\">&#x27;13981367234&#x27;</span>, <span class=\"string\">&#x27;T&#x27;</span>, <span class=\"number\">5</span>, <span class=\"string\">&#x27;http://img.alicdn.com/sns_logo/i2/2212109088345/O1CN01rsPVu02BW3rihzm8e_!!2212109088345-0-ggpersonal.jpg&#x27;</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">5</span>, <span class=\"number\">10.5</span>, <span class=\"number\">500</span>, <span class=\"string\">&#x27;13981367234&#x27;</span>, <span class=\"string\">&#x27;consumer&#x27;</span>,<span class=\"string\">&#x27;com12347+1 com12348+1&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> consumer</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;tb12342&#x27;</span>, <span class=\"string\">&#x27;Amy&#x27;</span>, <span class=\"string\">&#x27;a123456789&#x27;</span>, <span class=\"string\">&#x27;M&#x27;</span>, <span class=\"string\">&#x27;13981367555&#x27;</span>, <span class=\"string\">&#x27;T&#x27;</span>, <span class=\"number\">5</span>, <span class=\"string\">&#x27;http://img.alicdn.com/sns_logo/i2/2212109088345/O1CN01rsPVu02BW3rihzm8e_!!2212109088345-0-ggpersonal.jpg&#x27;</span>, <span class=\"number\">5</span>, <span class=\"number\">5</span>, <span class=\"number\">5</span>, <span class=\"number\">20.5</span>, <span class=\"number\">50</span>, <span class=\"string\">&#x27;13981367555&#x27;</span>, <span class=\"string\">&#x27;consumer&#x27;</span>,<span class=\"string\">&#x27;com12349+2 com12348+2&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> consumer</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;tb12341&#x27;</span>, <span class=\"string\">&#x27;LingLing&#x27;</span>, <span class=\"string\">&#x27;l123456789&#x27;</span>, <span class=\"string\">&#x27;M&#x27;</span>, <span class=\"string\">&#x27;13221367234&#x27;</span>, <span class=\"string\">&#x27;T&#x27;</span>, <span class=\"number\">5</span>, <span class=\"string\">&#x27;http://img.alicdn.com/sns_logo/i2/2212109088345/O1CN01rsPVu02BW3rihzm8e_!!2212109088345-0-ggpersonal.jpg&#x27;</span>, <span class=\"number\">10</span>, <span class=\"number\">3</span>, <span class=\"number\">8</span>, <span class=\"number\">30.5</span>, <span class=\"number\">900</span>, <span class=\"string\">&#x27;13221367234&#x27;</span>, <span class=\"string\">&#x27;consumer&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> consumer</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;tb12343&#x27;</span>, <span class=\"string\">&#x27;David&#x27;</span>, <span class=\"string\">&#x27;d123456789&#x27;</span>, <span class=\"string\">&#x27;F&#x27;</span>, <span class=\"string\">&#x27;13987767234&#x27;</span>, <span class=\"string\">&#x27;T&#x27;</span>, <span class=\"number\">5</span>, <span class=\"string\">&#x27;http://img.alicdn.com/sns_logo/i2/2212109088345/O1CN01rsPVu02BW3rihzm8e_!!2212109088345-0-ggpersonal.jpg&#x27;</span>, <span class=\"number\">10</span>, <span class=\"number\">10</span>, <span class=\"number\">5</span>, <span class=\"number\">100.5</span>, <span class=\"number\">1500</span>, <span class=\"string\">&#x27;13987767234&#x27;</span>, <span class=\"string\">&#x27;consumer&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> consumer</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;tb12344&#x27;</span>, <span class=\"string\">&#x27;sally&#x27;</span>, <span class=\"string\">&#x27;s123456789&#x27;</span>, <span class=\"string\">&#x27;M&#x27;</span>, <span class=\"string\">&#x27;13984467234&#x27;</span>, <span class=\"string\">&#x27;T&#x27;</span>, <span class=\"number\">5</span>, <span class=\"string\">&#x27;http://img.alicdn.com/sns_logo/i2/2212109088345/O1CN01rsPVu02BW3rihzm8e_!!2212109088345-0-ggpersonal.jpg&#x27;</span>, <span class=\"number\">30</span>, <span class=\"number\">30</span>, <span class=\"number\">9</span>, <span class=\"number\">120.5</span>, <span class=\"number\">2500</span>, <span class=\"string\">&#x27;13984467234&#x27;</span>, <span class=\"string\">&#x27;consumer&#x27;</span>,<span class=\"string\">&#x27;com12347+1&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> consumer;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- ä¸»è´¦å·</span></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> seller</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;tb12347&#x27;</span>, <span class=\"string\">&#x27;Tom&#x27;</span>, <span class=\"string\">&#x27;t123456789&#x27;</span>, <span class=\"string\">&#x27;F&#x27;</span>, <span class=\"string\">&#x27;13984467234&#x27;</span>, <span class=\"string\">&#x27;seller&#x27;</span>,<span class=\"string\">&#x27;T&#x27;</span>,<span class=\"string\">&#x27;T&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> seller</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;tb12346&#x27;</span>, <span class=\"string\">&#x27;Jerry&#x27;</span>, <span class=\"string\">&#x27;j123456789&#x27;</span>, <span class=\"string\">&#x27;M&#x27;</span>, <span class=\"string\">&#x27;13921367234&#x27;</span>, <span class=\"string\">&#x27;seller&#x27;</span>,<span class=\"string\">&#x27;T&#x27;</span>,<span class=\"string\">&#x27;F&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> seller</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;tb12348&#x27;</span>, <span class=\"string\">&#x27;Jack&#x27;</span>, <span class=\"string\">&#x27;j1234567689&#x27;</span>, <span class=\"string\">&#x27;M&#x27;</span>, <span class=\"string\">&#x27;15581367234&#x27;</span>, <span class=\"string\">&#x27;seller&#x27;</span>,<span class=\"string\">&#x27;F&#x27;</span>,<span class=\"string\">&#x27;T&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> seller</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;tb12349&#x27;</span>, <span class=\"string\">&#x27;Rose&#x27;</span>, <span class=\"string\">&#x27;r123456789&#x27;</span>, <span class=\"string\">&#x27;F&#x27;</span>, <span class=\"string\">&#x27;15481367234&#x27;</span>, <span class=\"string\">&#x27;seller&#x27;</span>,<span class=\"string\">&#x27;T&#x27;</span>,<span class=\"string\">&#x27;F&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> seller</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;tb12340&#x27;</span>, <span class=\"string\">&#x27;Lily&#x27;</span>, <span class=\"string\">&#x27;l123456789&#x27;</span>, <span class=\"string\">&#x27;F&#x27;</span>, <span class=\"string\">&#x27;15681367234&#x27;</span>, <span class=\"string\">&#x27;seller&#x27;</span>,<span class=\"string\">&#x27;T&#x27;</span>,<span class=\"string\">&#x27;T&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> consumer;</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> users;</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> seller;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">--äº¤æ˜“ç³»ç»Ÿæ•°æ®æµ‹è¯•</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">--åº—é“ºå¤§è¡¨</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> store</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;400672256&#x27;</span>,<span class=\"string\">&#x27;Time food&#x27;</span>,<span class=\"string\">&#x27;food&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;https://img.alicdn.com/imgextra/i1/O1CN01pz5irY1bhDKceJor2_!!6000000003496-2-tps-144-144.png&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;tb12346&#x27;</span>,<span class=\"string\">&#x27;567 West Main Street, Oakville, Canada&#x27;</span>,</span><br><span class=\"line\"><span class=\"number\">1231234.23</span>,<span class=\"number\">421343</span>,<span class=\"number\">21344</span>,<span class=\"number\">67</span>,<span class=\"number\">123134</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"string\">&#x27;2018-05-15&#x27;</span>,<span class=\"number\">0</span></span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> store</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;400672257&#x27;</span>,<span class=\"string\">&#x27;Fashion women wear&#x27;</span>,<span class=\"string\">&#x27;cloth&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;https://img.alicdn.com/imgextra/i1/O1CN01pz5irY1bhDKceJor2_!!6000000003496-2-tps-144-144.png&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;tb12347&#x27;</span>,<span class=\"string\">&#x27;1234 Maple Street, Springfield, USA&#x27;</span>,</span><br><span class=\"line\"><span class=\"number\">141241.12</span>,<span class=\"number\">214120</span>,<span class=\"number\">12312</span>,<span class=\"number\">70</span>,<span class=\"number\">14223</span>,<span class=\"number\">3</span>,<span class=\"number\">5</span>,<span class=\"string\">&#x27;2020-01-10&#x27;</span>,<span class=\"number\">0</span></span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> store</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;400672258&#x27;</span>,<span class=\"string\">&#x27;happy toy&#x27;</span>,<span class=\"string\">&#x27;toy&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;https://img.alicdn.com/imgextra/i1/O1CN01pz5irY1bhDKceJor2_!!6000000003496-2-tps-144-144.png&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;tb12348&#x27;</span>,<span class=\"string\">&#x27;789 Elmwood Avenue, Portland, USA&#x27;</span>,</span><br><span class=\"line\"><span class=\"number\">412442.2</span>,<span class=\"number\">4124</span>,<span class=\"number\">423</span>,<span class=\"number\">40</span>,<span class=\"number\">2223</span>,<span class=\"number\">2</span>,<span class=\"number\">4</span>,<span class=\"string\">&#x27;2022-09-23&#x27;</span>,<span class=\"number\">0</span></span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">--å•†å“å¤§è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> commodity</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;com12347&#x27;</span>, <span class=\"string\">&#x27;cookie&#x27;</span>, <span class=\"string\">&#x27;food&#x27;</span>, <span class=\"number\">5.99</span>, <span class=\"number\">1</span>,<span class=\"number\">1000</span>,<span class=\"string\">&#x27;very delicious&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;Deliciously crisp and golden, these cookies are the perfect blend of sweetness and crunch. Each bite is filled with rich flavors, leaving a lingering vanilla aroma. Indulge in these irresistible treats that will surely satisfy your cravings. Enjoy them with a cup of tea or share them with friends for a delightful snack experience.&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;Seven days no reason to return&#x27;</span>,<span class=\"string\">&#x27;2023-07-01&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;https://img.alicdn.com/imgextra/i3/1408820149/O1CN01B67UhV1CyHv3krMdJ_!!0-saturn_solar.jpg_460x460q90.jpg_.webp&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> commodity</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;com12348&#x27;</span>, <span class=\"string\">&#x27;River snail rice noodle&#x27;</span>, <span class=\"string\">&#x27;food&#x27;</span>, <span class=\"number\">10.99</span>, <span class=\"number\">0</span>,<span class=\"number\">5000</span>,<span class=\"string\">&#x27;smelly but delicious&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;A popular dish from southern China, this bowl of noodles is filled with complex flavors and textures. The slippery rice noodles are topped with a savory sauce made from pickled bamboo shoots, spicy chili oil, minced pork, and fragrant herbs. Served with vinegar and peanuts for extra zing and crunch, this dish is a must-try for any food lover.&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;Seven days no reason to return&#x27;</span>,<span class=\"string\">&#x27;2023-05-20&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;https://img.alicdn.com/imgextra/i1/2485630119/O1CN01XjB5ap1CkY1ioEbec_!!0-saturn_solar.jpg_460x460q90.jpg_.webp&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> commodity</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;com12349&#x27;</span>, <span class=\"string\">&#x27;spicy strip&#x27;</span>, <span class=\"string\">&#x27;food&#x27;</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0</span>,<span class=\"number\">100000</span>,<span class=\"string\">&#x27;Taste of childhood&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;Spicy and addictive, these chewy strips pack a punch of flavor. Infused with a blend of fiery spices, they offer a satisfying kick with every bite. Whether you enjoy them as a snack on the go or as a zesty addition to your favorite dishes, these spicy sticks are sure to spice up your day.&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;Seven days no reason to return&#x27;</span>,<span class=\"string\">&#x27;2023-01-15&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;https://img.alicdn.com/imgextra/i4/101025137/O1CN014tAkX81nonUmjbfXL_!!0-saturn_solar.jpg_460x460q90.jpg_.webp&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> commodity</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;com12350&#x27;</span>, <span class=\"string\">&#x27;Braised beef noodles&#x27;</span>, <span class=\"string\">&#x27;food&#x27;</span>, <span class=\"number\">3.5</span>, <span class=\"number\">0</span>,<span class=\"number\">10000</span>,<span class=\"string\">&#x27;filling&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;Spicy and addictive, these chewy strips pack a punch of flavor. Infused with a blend of fiery spices, they offer a satisfying kick with every bite. Whether you enjoy them as a snack on the go or as a zesty addition to your favorite dishes, these spicy sticks are sure to spice up your day.&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;Seven days no reason to return&#x27;</span>,<span class=\"string\">&#x27;2023-10-02&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;https://g-search3.alicdn.com/img/bao/uploaded/i4/i1/2371566698/O1CN014qvI8h1zLjhoHxwEH_!!0-item_pic.jpg_460x460q90.jpg_.webp&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> commodity</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;com12351&#x27;</span>, <span class=\"string\">&#x27;jelly&#x27;</span>, <span class=\"string\">&#x27;food&#x27;</span>, <span class=\"number\">20.99</span>, <span class=\"number\">5.99</span>,<span class=\"number\">10000</span>,<span class=\"string\">&#x27;chewy and delicious&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;Delightfully wobbly and bursting with fruity sweetness, this jelly treat is a playful indulgence for all ages. Each colorful, translucent cube offers a refreshing burst of flavor, making it a fun and satisfying snack. Whether enjoyed on its own or as part of a dessert, this jiggly delight is sure to bring joy.&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;Seven days no reason to return&#x27;</span>,<span class=\"string\">&#x27;2023-11-01&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;https://img.alicdn.com/imgextra/i3/2908500146/O1CN01UEccf61CwujVuykdl_!!0-saturn_solar.jpg_460x460q90.jpg_.webp&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> commodity</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;com13310&#x27;</span>, <span class=\"string\">&#x27;Down jacket&#x27;</span>, <span class=\"string\">&#x27;cloth&#x27;</span>, <span class=\"number\">399</span>, <span class=\"number\">100</span>,<span class=\"number\">2000</span>,<span class=\"string\">&#x27;Fit like a glove&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;Designed for warmth and style, this down jacket is the ultimate winter companion. Filled with soft and insulating down feathers, it provides exceptional insulation against the cold. Its sleek and quilted design offers a trendy and modern look, while the cozy hood and zippered pockets add practicality. Stay snug and fashionable in this essential winter apparel.&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;Seven days no reason to return&#x27;</span>,<span class=\"string\">&#x27;2023-10-20&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;https://g-search1.alicdn.com/img/bao/uploaded/i4/i2/3422193418/O1CN01BV60Ej1b7UcX4Zjyz_!!3422193418.jpg_460x460q90.jpg_.webp&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> commodity</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;com13410&#x27;</span>, <span class=\"string\">&#x27;Midea air conditioner&#x27;</span>, <span class=\"string\">&#x27;ele_appliment&#x27;</span>, <span class=\"number\">2999</span>, <span class=\"number\">200</span>,<span class=\"number\">2000</span>,<span class=\"string\">&#x27;Very cool&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;This air conditioner is the perfect solution for keeping your home cool and comfortable. With its powerful cooling capabilities, it quickly cools down any room. Its sleek and compact design fits seamlessly into any space, while its energy-efficient technology ensures minimal electricity consumption. Control the temperature with ease using the remote control or programmable timer, making it a convenient and reliable option for hot summer months.&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;Seven days no reason to return&#x27;</span>,<span class=\"string\">&#x27;2023-02-27&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;https://img.alicdn.com/imgextra/i2/100532851/O1CN01CqyVgR1Wvo3NORkOs_!!2-saturn_solar.png_460x460q90.jpg_.webp&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> commodity</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;com13510&#x27;</span>, <span class=\"string\">&#x27;vivo mobile phone&#x27;</span>, <span class=\"string\">&#x27;ele_product&#x27;</span>, <span class=\"number\">99999</span>, <span class=\"number\">2000</span>,<span class=\"number\">2000</span>,<span class=\"string\">&#x27;Too expensive&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;Sleek and powerful, this smartphone is a technological marvel. Its high-resolution display brings visuals to life with vibrant colors and sharp details. With a lightning-fast processor and ample storage capacity, it effortlessly handles multitasking and stores all your important files. Capture stunning photos with its advanced camera system and stay connected with fast internet speeds. This phone merges style and functionality seamlessly, making it a must-have gadget.&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;Seven days no reason to return&#x27;</span>,<span class=\"string\">&#x27;2023-10-27&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;https://img.alicdn.com/imgextra/i2/14867192/O1CN01mHqjjR22zzPUyJaeD_!!0-saturn_solar.jpg_460x460q90.jpg_.webp&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> commodity</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;com13610&#x27;</span>, <span class=\"string\">&#x27;Liquid foundation&#x27;</span>, <span class=\"string\">&#x27;makeup&#x27;</span>, <span class=\"number\">49</span>, <span class=\"number\">0</span>,<span class=\"number\">2000</span>,<span class=\"string\">&#x27;Flawless coverage, radiant complexion&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;This foundation is a game-changer. It provides seamless coverage that blurs imperfections, leaving a natural and glowing complexion. Its lightweight formula blends effortlessly, ensuring a smooth and even finish. With long-lasting staying power, it keeps your skin looking flawless all day. Enhance your beauty with this exceptional foundation.&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;Seven days no reason to return&#x27;</span>,<span class=\"string\">&#x27;2023-11-27&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;https://img.alicdn.com/imgextra/i1/30321366/O1CN01GuqGrB1Lxfims8RoA_!!0-saturn_solar.jpg_460x460q90.jpg_.webp&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> commodity</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;com13710&#x27;</span>, <span class=\"string\">&#x27;Ultraman&#x27;</span>, <span class=\"string\">&#x27;toy&#x27;</span>, <span class=\"number\">20.3</span>, <span class=\"number\">0</span>,<span class=\"number\">5000</span>,<span class=\"string\">&#x27;Children like it very much&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;Unleash your creativity with this versatile toy. With endless possibilities, it sparks imagination and promotes hands-on learning. Its durable construction ensures long-lasting fun, while its vibrant colors and unique design capture attention. Whether building, stacking, or creating imaginative stories, this toy guarantees hours of entertainment for children of all ages.&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;Seven days no reason to return&#x27;</span>,<span class=\"string\">&#x27;2022-12-15&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;https://g-search1.alicdn.com/img/bao/uploaded/i4/i1/1898884903/O1CN01YPWF7r1m5coIGl8h2_!!1898884903.jpg_460x460q90.jpg_.webp&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">--é£Ÿå“å°è¡¨</span></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> food</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;com12347&#x27;</span>, <span class=\"string\">&#x27;cookie&#x27;</span>, <span class=\"string\">&#x27;food&#x27;</span>, <span class=\"number\">5.99</span>, <span class=\"number\">1</span>,<span class=\"number\">1000</span>,<span class=\"string\">&#x27;very delicious&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;Deliciously crisp and golden, these cookies are the perfect blend of sweetness and crunch. Each bite is filled with rich flavors, leaving a lingering vanilla aroma. Indulge in these irresistible treats that will surely satisfy your cravings. Enjoy them with a cup of tea or share them with friends for a delightful snack experience.&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;Seven days no reason to return&#x27;</span>,<span class=\"string\">&#x27;2023-07-01&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;https://img.alicdn.com/imgextra/i3/1408820149/O1CN01B67UhV1CyHv3krMdJ_!!0-saturn_solar.jpg_460x460q90.jpg_.webp&#x27;</span>,</span><br><span class=\"line\"><span class=\"number\">180</span>,<span class=\"string\">&#x27;1kg&#x27;</span>,<span class=\"string\">&#x27;Original taste&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> food</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;com12348&#x27;</span>, <span class=\"string\">&#x27;River snail rice noodle&#x27;</span>, <span class=\"string\">&#x27;food&#x27;</span>, <span class=\"number\">10.99</span>, <span class=\"number\">0</span>,<span class=\"number\">5000</span>,<span class=\"string\">&#x27;smelly but delicious&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;A popular dish from southern China, this bowl of noodles is filled with complex flavors and textures. The slippery rice noodles are topped with a savory sauce made from pickled bamboo shoots, spicy chili oil, minced pork, and fragrant herbs. Served with vinegar and peanuts for extra zing and crunch, this dish is a must-try for any food lover.&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;Seven days no reason to return&#x27;</span>,<span class=\"string\">&#x27;2023-05-20&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;https://img.alicdn.com/imgextra/i1/2485630119/O1CN01XjB5ap1CkY1ioEbec_!!0-saturn_solar.jpg_460x460q90.jpg_.webp&#x27;</span>,</span><br><span class=\"line\"><span class=\"number\">90</span>,<span class=\"string\">&#x27;225g&#x27;</span>,<span class=\"string\">&#x27;Original taste&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> food</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;com12349&#x27;</span>, <span class=\"string\">&#x27;spicy strip&#x27;</span>, <span class=\"string\">&#x27;food&#x27;</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0</span>,<span class=\"number\">100000</span>,<span class=\"string\">&#x27;Taste of childhood&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;Spicy and addictive, these chewy strips pack a punch of flavor. Infused with a blend of fiery spices, they offer a satisfying kick with every bite. Whether you enjoy them as a snack on the go or as a zesty addition to your favorite dishes, these spicy sticks are sure to spice up your day.&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;Seven days no reason to return&#x27;</span>,<span class=\"string\">&#x27;2023-01-15&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;https://img.alicdn.com/imgextra/i4/101025137/O1CN014tAkX81nonUmjbfXL_!!0-saturn_solar.jpg_460x460q90.jpg_.webp&#x27;</span>,</span><br><span class=\"line\"><span class=\"number\">360</span>,<span class=\"string\">&#x27;50g&#x27;</span>,<span class=\"string\">&#x27;Original taste&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> food</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;com12350&#x27;</span>, <span class=\"string\">&#x27;Braised beef noodles&#x27;</span>, <span class=\"string\">&#x27;food&#x27;</span>, <span class=\"number\">3.5</span>, <span class=\"number\">0</span>,<span class=\"number\">10000</span>,<span class=\"string\">&#x27;filling&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;Spicy and addictive, these chewy strips pack a punch of flavor. Infused with a blend of fiery spices, they offer a satisfying kick with every bite. Whether you enjoy them as a snack on the go or as a zesty addition to your favorite dishes, these spicy sticks are sure to spice up your day.&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;Seven days no reason to return&#x27;</span>,<span class=\"string\">&#x27;2023-10-02&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;https://g-search3.alicdn.com/img/bao/uploaded/i4/i1/2371566698/O1CN014qvI8h1zLjhoHxwEH_!!0-item_pic.jpg_460x460q90.jpg_.webp&#x27;</span>,</span><br><span class=\"line\"><span class=\"number\">90</span>,<span class=\"string\">&#x27;225g&#x27;</span>,<span class=\"string\">&#x27;Braised beef&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> food</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;com12351&#x27;</span>, <span class=\"string\">&#x27;jelly&#x27;</span>, <span class=\"string\">&#x27;food&#x27;</span>, <span class=\"number\">20.99</span>, <span class=\"number\">5.99</span>,<span class=\"number\">10000</span>,<span class=\"string\">&#x27;chewy and delicious&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;Delightfully wobbly and bursting with fruity sweetness, this jelly treat is a playful indulgence for all ages. Each colorful, translucent cube offers a refreshing burst of flavor, making it a fun and satisfying snack. Whether enjoyed on its own or as part of a dessert, this jiggly delight is sure to bring joy.&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;Seven days no reason to return&#x27;</span>,<span class=\"string\">&#x27;2023-11-01&#x27;</span>,</span><br><span class=\"line\"><span class=\"string\">&#x27;https://img.alicdn.com/imgextra/i3/2908500146/O1CN01UEccf61CwujVuykdl_!!0-saturn_solar.jpg_460x460q90.jpg_.webp&#x27;</span>,</span><br><span class=\"line\"><span class=\"number\">360</span>,<span class=\"string\">&#x27;100g&#x27;</span>,<span class=\"string\">&#x27;orange&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">--åº—é“ºå•†å“å…³ç³»è¡¨</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> sell</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;400672256&#x27;</span>,<span class=\"string\">&#x27;com12347&#x27;</span>,<span class=\"string\">&#x27;2023-08-01&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> sell</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;400672256&#x27;</span>,<span class=\"string\">&#x27;com12348&#x27;</span>,<span class=\"string\">&#x27;2023-05-30&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> sell</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;400672256&#x27;</span>,<span class=\"string\">&#x27;com12349&#x27;</span>,<span class=\"string\">&#x27;2023-02-18&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> sell</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;400672256&#x27;</span>,<span class=\"string\">&#x27;com12350&#x27;</span>,<span class=\"string\">&#x27;2023-10-07&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> sell</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;400672256&#x27;</span>,<span class=\"string\">&#x27;com12351&#x27;</span>,<span class=\"string\">&#x27;2023-11-10&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> commodity;</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> store;</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> food;</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> sell;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">--æŸ¥è¯¢ä¸€ä¸ªåº—é“ºçš„æ‰€æœ‰å•†å“</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> com_id <span class=\"keyword\">FROM</span> ((store <span class=\"keyword\">NATURAL</span> <span class=\"keyword\">JOIN</span> sell)<span class=\"keyword\">NATURAL</span> <span class=\"keyword\">JOIN</span> commodity)</span><br><span class=\"line\"><span class=\"keyword\">WHERE</span> store_id <span class=\"operator\">=</span> <span class=\"string\">&#x27;400672256&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">--èŠå¤©ç³»ç»Ÿçš„æ•°æ®æµ‹è¯•</span></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> message</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;ms0000000000001&#x27;</span>,<span class=\"string\">&#x27;æ–‡æœ¬&#x27;</span>,<span class=\"string\">&#x27;ä½ åƒé¥­äº†å—ï¼Ÿ&#x27;</span>,<span class=\"string\">&#x27;2022-01-10 12:00:00&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> message</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;ms0000000000002&#x27;</span>,<span class=\"string\">&#x27;æ–‡æœ¬&#x27;</span>,<span class=\"string\">&#x27;è¿˜æ²¡æœ‰&#x27;</span>,<span class=\"string\">&#x27;2022-01-10 12:00:30&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> message</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;ms0000000000003&#x27;</span>,<span class=\"string\">&#x27;æ–‡æœ¬&#x27;</span>,<span class=\"string\">&#x27;ä»Šå¤©å¸ƒç½®äº†ä»€ä¹ˆä½œä¸šäº†ï¼Ÿ&#x27;</span>,<span class=\"string\">&#x27;2022-01-12 18:00:00&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> message</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;ms0000000000004&#x27;</span>,<span class=\"string\">&#x27;æ–‡æœ¬&#x27;</span>,<span class=\"string\">&#x27;æ•°å€¼è®¡ç®—çš„ç¼–ç¨‹ä½œä¸š&#x27;</span>,<span class=\"string\">&#x27;2022-01-12 18:30:53&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> message</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;ms0000000000005&#x27;</span>,<span class=\"string\">&#x27;æ–‡æœ¬&#x27;</span>,<span class=\"string\">&#x27;edge detection&#x27;</span>,<span class=\"string\">&#x27;2022-01-12 18:44:24&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> message</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;ms0000000000006&#x27;</span>,<span class=\"string\">&#x27;æ–‡æœ¬&#x27;</span>,<span class=\"string\">&#x27;ä¸€ä¼šå»å“ªåƒï¼Ÿ&#x27;</span>,<span class=\"string\">&#x27;2022-01-10 12:00:47&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> message</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;ms0000000000007&#x27;</span>,<span class=\"string\">&#x27;æ–‡æœ¬&#x27;</span>,<span class=\"string\">&#x27;å…°å›­äºŒæ¥¼&#x27;</span>,<span class=\"string\">&#x27;2022-01-10 12:01:20&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> message</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;ms0000000000008&#x27;</span>,<span class=\"string\">&#x27;å›¾ç‰‡&#x27;</span>,<span class=\"string\">&#x27;D:\\image\\2.jpg&#x27;</span>,<span class=\"string\">&#x27;2022-01-12 18:50:55&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> message</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;ms0000000000009&#x27;</span>,<span class=\"string\">&#x27;è§†é¢‘&#x27;</span>,<span class=\"string\">&#x27;D:\\video\\2.mp4&#x27;</span>,<span class=\"string\">&#x27;2022-01-12 18:51:56&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--å¯¹è¯æ¶ˆæ¯æ€»è¡¨æ•°æ®</span></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> conversation_message</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;ms0000000000001&#x27;</span>,<span class=\"string\">&#x27;æ–‡æœ¬&#x27;</span>,<span class=\"string\">&#x27;ä½ åƒé¥­äº†å—ï¼Ÿ&#x27;</span>,<span class=\"string\">&#x27;2022-01-10 12:00:00&#x27;</span>, <span class=\"literal\">true</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> conversation_message</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;ms0000000000002&#x27;</span>,<span class=\"string\">&#x27;æ–‡æœ¬&#x27;</span>,<span class=\"string\">&#x27;è¿˜æ²¡æœ‰&#x27;</span>,<span class=\"string\">&#x27;2022-01-10 12:00:30&#x27;</span>, <span class=\"literal\">false</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> conversation_message</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;ms0000000000006&#x27;</span>,<span class=\"string\">&#x27;æ–‡æœ¬&#x27;</span>,<span class=\"string\">&#x27;ä¸€ä¼šå»å“ªåƒï¼Ÿ&#x27;</span>,<span class=\"string\">&#x27;2022-01-10 12:00:47&#x27;</span>, <span class=\"literal\">false</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> conversation_message</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;ms0000000000007&#x27;</span>,<span class=\"string\">&#x27;æ–‡æœ¬&#x27;</span>,<span class=\"string\">&#x27;å…°å›­äºŒæ¥¼&#x27;</span>,<span class=\"string\">&#x27;2022-01-10 12:01:20&#x27;</span>, <span class=\"literal\">false</span>);</span><br><span class=\"line\"><span class=\"comment\">--ç¾¤ç»„æ¶ˆæ¯æ€»è¡¨æ•°æ®</span></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> group_message</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;ms0000000000003&#x27;</span>,<span class=\"string\">&#x27;æ–‡æœ¬&#x27;</span>,<span class=\"string\">&#x27;ä»Šå¤©å¸ƒç½®äº†ä»€ä¹ˆä½œä¸šäº†ï¼Ÿ&#x27;</span>,<span class=\"string\">&#x27;2022-01-12 18:00:00&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> group_message</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;ms0000000000004&#x27;</span>,<span class=\"string\">&#x27;æ–‡æœ¬&#x27;</span>,<span class=\"string\">&#x27;æ•°å€¼è®¡ç®—çš„ç¼–ç¨‹ä½œä¸š&#x27;</span>,<span class=\"string\">&#x27;2022-01-12 18:30:53&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> group_message</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;ms0000000000005&#x27;</span>,<span class=\"string\">&#x27;æ–‡æœ¬&#x27;</span>,<span class=\"string\">&#x27;edge detection&#x27;</span>,<span class=\"string\">&#x27;2022-01-12 18:44:24&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> group_message</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;ms0000000000008&#x27;</span>,<span class=\"string\">&#x27;å›¾ç‰‡&#x27;</span>,<span class=\"string\">&#x27;D:\\image\\2.jpg&#x27;</span>,<span class=\"string\">&#x27;2022-01-12 18:50:55&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> group_message</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;ms0000000000009&#x27;</span>,<span class=\"string\">&#x27;è§†é¢‘&#x27;</span>,<span class=\"string\">&#x27;D:\\video\\2.mp4&#x27;</span>,<span class=\"string\">&#x27;2022-01-12 18:51:56&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> message;</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> group_message;</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> message;</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> conversation_message;</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> group_message;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">--è¯„ä»·æ¶ˆæ¯æ€»è¡¨æ•°æ®</span></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> evaluation</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;ev0000000000001&#x27;</span>,<span class=\"string\">&#x27;æ–‡æœ¬&#x27;</span>,<span class=\"string\">&#x27;è¿™ä»¶è¡£æœçš„æè´¨å¾ˆå¥½,ç©¿èµ·æ¥å¾ˆèˆ’æœ&#x27;</span>, <span class=\"literal\">false</span>, <span class=\"string\">&#x27;å¥½&#x27;</span>, <span class=\"string\">&#x27;2023-02-22 14:00:00&#x27;</span>,</span><br><span class=\"line\">\t   <span class=\"literal\">false</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">5</span>, <span class=\"number\">5</span>, <span class=\"number\">5</span>, <span class=\"number\">5</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> evaluation</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;ev0000000000002&#x27;</span>,<span class=\"string\">&#x27;æ–‡æœ¬&#x27;</span>,<span class=\"string\">&#x27;è¿™ä¸ªå……ç”µå®å……ç”µæ…¢ï¼Œè¿˜ä¼šæ¼ç”µ&#x27;</span>, <span class=\"literal\">false</span>, <span class=\"string\">&#x27;å·®&#x27;</span>, <span class=\"string\">&#x27;2023-03-12 15:30:53&#x27;</span>,</span><br><span class=\"line\">\t   <span class=\"literal\">false</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> evaluation</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;ev0000000000003&#x27;</span>,<span class=\"string\">&#x27;æ–‡æœ¬&#x27;</span>,<span class=\"string\">&#x27;è¿™ä¸ªè–¯ç‰‡å¾ˆå¥½åƒï¼Œå€¼å¾—ä¸€ä¹°&#x27;</span>, <span class=\"literal\">true</span>, <span class=\"string\">&#x27;å¥½&#x27;</span>, <span class=\"string\">&#x27;2023-04-11 08:12:22&#x27;</span>,</span><br><span class=\"line\">\t   <span class=\"literal\">false</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">5</span>, <span class=\"number\">5</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> evaluation</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;ev0000000000003&#x27;</span>,<span class=\"string\">&#x27;æ–‡æœ¬&#x27;</span>,<span class=\"string\">&#x27;è¿™ä¸ªè–¯ç‰‡å¾ˆå¥½åƒï¼Œå€¼å¾—ä¸€ä¹°&#x27;</span>, <span class=\"literal\">true</span>, <span class=\"string\">&#x27;å¥½&#x27;</span>, <span class=\"string\">&#x27;2023-04-11 08:12:22&#x27;</span>,</span><br><span class=\"line\">\t   <span class=\"literal\">false</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">5</span>, <span class=\"number\">5</span>, <span class=\"number\">4</span>, <span class=\"number\">2</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> evaluation</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;ev0000000000004&#x27;</span>,<span class=\"string\">&#x27;æ–‡æœ¬&#x27;</span>,<span class=\"string\">&#x27;è¿™ä»¶è¡£æœçœŸçš„å¾ˆå¥½çœ‹ï¼Œè¿˜ä¾¿å®œ&#x27;</span>, <span class=\"literal\">false</span>, <span class=\"string\">&#x27;å¥½&#x27;</span>, <span class=\"string\">&#x27;2023-02-23 10:10:55&#x27;</span>,</span><br><span class=\"line\">\t   <span class=\"literal\">true</span>, <span class=\"number\">25</span>, <span class=\"number\">30</span>, <span class=\"number\">5</span>, <span class=\"number\">5</span>, <span class=\"number\">5</span>, <span class=\"number\">5</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> evaluation</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;ev0000000000005&#x27;</span>,<span class=\"string\">&#x27;å›¾ç‰‡&#x27;</span>,<span class=\"string\">&#x27;D:\\image\\1.jpg&#x27;</span>, <span class=\"literal\">false</span>, <span class=\"string\">&#x27;å¥½&#x27;</span>, <span class=\"string\">&#x27;2023-03-23 11:25:35&#x27;</span>,</span><br><span class=\"line\">\t   <span class=\"literal\">false</span>, <span class=\"number\">10</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">4</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> evaluation</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;ev0000000000006&#x27;</span>,<span class=\"string\">&#x27;è§†é¢‘&#x27;</span>,<span class=\"string\">&#x27;D:\\video\\1.mp4&#x27;</span>, <span class=\"literal\">false</span>, <span class=\"string\">&#x27;å¥½&#x27;</span>, <span class=\"string\">&#x27;2023-01-25 16:55:45&#x27;</span>,</span><br><span class=\"line\">\t   <span class=\"literal\">false</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">5</span>, <span class=\"number\">5</span>, <span class=\"number\">5</span>, <span class=\"number\">5</span>);</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> evaluation;</span><br><span class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> evaluation <span class=\"keyword\">WHERE</span> evaluation_id <span class=\"operator\">=</span> <span class=\"string\">&#x27;ev0000000000005&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> evaluation;</span><br><span class=\"line\"><span class=\"comment\">--å¥½å‹æ¶ˆæ¯ç´¢å¼•è¡¨æ•°æ®</span></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> friend_and_friend</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;tb12345&#x27;</span>, <span class=\"string\">&#x27;tb12342&#x27;</span>, <span class=\"string\">&#x27;ms0000000000001&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> friend_and_friend</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;tb12342&#x27;</span>, <span class=\"string\">&#x27;tb12345&#x27;</span>, <span class=\"string\">&#x27;ms0000000000002&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> friend_and_friend</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;tb12345&#x27;</span>, <span class=\"string\">&#x27;tb12342&#x27;</span>, <span class=\"string\">&#x27;ms0000000000006&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> friend_and_friend</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span> (<span class=\"string\">&#x27;tb12342&#x27;</span>, <span class=\"string\">&#x27;tb12345&#x27;</span>, <span class=\"string\">&#x27;ms0000000000007&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> friend_and_friend;</span><br></pre></td></tr></table></figure>","tags":["æ•°æ®åº“","å®è·µ"]},{"title":"è„šæœ¬","url":"/post/72b5a919.html","content":"<p><strong>è„šæœ¬æ˜¯ä»€ä¹ˆï¼Ÿ</strong><br>\nè„šæœ¬ï¼ˆScriptï¼‰æ˜¯ä¸€ç§ç”±è®¡ç®—æœºæ‰§è¡Œçš„ç¨‹åºä»£ç ï¼Œé€šå¸¸ç”¨äºè‡ªåŠ¨åŒ–ä»»åŠ¡æˆ–æ§åˆ¶è½¯ä»¶è¡Œä¸ºã€‚å®ƒç”±ä¸€ç³»åˆ—æŒ‡ä»¤ç»„æˆï¼Œè§£é‡Šå™¨æˆ–è„šæœ¬å¼•æ“å¯ä»¥ç›´æ¥æ‰§è¡Œè¿™äº›æŒ‡ä»¤ï¼Œè€Œæ— éœ€ç¼–è¯‘æˆæœºå™¨ç ã€‚è„šæœ¬è¯­è¨€ï¼ˆå¦‚Pythonã€JavaScriptã€Bashç­‰ï¼‰å¸¸ç”¨äºç¼–å†™è„šæœ¬ã€‚</p>\n<h3 id=\"è„šæœ¬çš„ä¸»è¦ç‰¹ç‚¹ï¼š\">è„šæœ¬çš„ä¸»è¦ç‰¹ç‚¹ï¼š</h3>\n<ol>\n<li><strong>è§£é‡Šæ‰§è¡Œ</strong>ï¼šè„šæœ¬é€šå¸¸ç”±è§£é‡Šå™¨é€è¡Œæ‰§è¡Œï¼Œæ— éœ€ç¼–è¯‘ã€‚</li>\n<li><strong>è½»é‡çº§</strong>ï¼šé€‚åˆå¿«é€Ÿå¼€å‘å’Œå°å‹ä»»åŠ¡ã€‚</li>\n<li><strong>è·¨å¹³å°</strong>ï¼šè®¸å¤šè„šæœ¬è¯­è¨€å¯åœ¨å¤šä¸ªæ“ä½œç³»ç»Ÿä¸Šè¿è¡Œã€‚</li>\n<li><strong>è‡ªåŠ¨åŒ–</strong>ï¼šå¸¸ç”¨äºè‡ªåŠ¨åŒ–é‡å¤æ€§ä»»åŠ¡ï¼Œå¦‚æ–‡ä»¶å¤„ç†ã€ç³»ç»Ÿç®¡ç†ç­‰ã€‚</li>\n</ol>\n<h3 id=\"å¸¸è§è„šæœ¬è¯­è¨€ï¼š\">å¸¸è§è„šæœ¬è¯­è¨€ï¼š</h3>\n<ul>\n<li><strong>Python</strong>ï¼šå¹¿æ³›ç”¨äºè‡ªåŠ¨åŒ–ã€æ•°æ®å¤„ç†å’ŒWebå¼€å‘ã€‚</li>\n<li><strong>JavaScript</strong>ï¼šä¸»è¦ç”¨äºWebå‰ç«¯å’ŒNode.jsåç«¯å¼€å‘ã€‚</li>\n<li><strong>Bash</strong>ï¼šç”¨äºLinux/Unixç³»ç»Ÿçš„å‘½ä»¤è¡Œè„šæœ¬ã€‚</li>\n<li><strong>PowerShell</strong>ï¼šWindowsç³»ç»Ÿçš„è‡ªåŠ¨åŒ–è„šæœ¬è¯­è¨€ã€‚</li>\n<li><strong>Ruby</strong>ï¼šé€‚åˆWebå¼€å‘å’Œè„šæœ¬ç¼–å†™ã€‚</li>\n</ul>\n<h3 id=\"è„šæœ¬çš„åº”ç”¨åœºæ™¯ï¼š\">è„šæœ¬çš„åº”ç”¨åœºæ™¯ï¼š</h3>\n<ul>\n<li><strong>è‡ªåŠ¨åŒ–ä»»åŠ¡</strong>ï¼šå¦‚æ‰¹é‡æ–‡ä»¶å¤„ç†ã€å®šæ—¶ä»»åŠ¡ã€‚</li>\n<li><strong>ç³»ç»Ÿç®¡ç†</strong>ï¼šå¦‚é…ç½®æœåŠ¡å™¨ã€ç›‘æ§ç³»ç»Ÿã€‚</li>\n<li><strong>Webå¼€å‘</strong>ï¼šå¦‚å‰ç«¯äº¤äº’ã€åç«¯é€»è¾‘ã€‚</li>\n<li><strong>æ•°æ®å¤„ç†</strong>ï¼šå¦‚æ•°æ®æ¸…æ´—ã€åˆ†æã€‚</li>\n</ul>\n<h3 id=\"ç¤ºä¾‹ï¼š\">ç¤ºä¾‹ï¼š</h3>\n<ul>\n<li><strong>Pythonè„šæœ¬</strong>ï¼š<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;Hello, World!&quot;</span>)</span><br></pre></td></tr></table></figure>\n</li>\n<li><strong>Bashè„šæœ¬</strong>ï¼š<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/bash</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">&quot;Hello, World!&quot;</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>æ€»ç»“æ¥è¯´ï¼Œè„šæœ¬æ˜¯ä¸€ç§çµæ´»çš„å·¥å…·ï¼Œé€‚ç”¨äºå¿«é€Ÿå¼€å‘å’Œä»»åŠ¡è‡ªåŠ¨åŒ–ã€‚</p>\n<h3 id=\"åäº”ä¸ªPythonè„šæœ¬\">åäº”ä¸ªPythonè„šæœ¬</h3>\n<h4 id=\"1-Hello-World\">1. Hello, World!</h4>\n<p>æ‰€æœ‰ç¨‹åºå‘˜çš„ç»å…¸èµ·ç‚¹ï¼Œè¿™ä¸ªè„šæœ¬ä»‹ç»äº†Pythonè¯­æ³•çš„åŸºç¡€ã€‚</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;Hello, World!&quot;</span>)   </span><br></pre></td></tr></table></figure>\n<h4 id=\"2-ç®€æ˜“è®¡ç®—å™¨\">2. ç®€æ˜“è®¡ç®—å™¨</h4>\n<p>åˆ›å»ºä¸€ä¸ªåŸºæœ¬çš„è®¡ç®—å™¨ï¼Œæ‰§è¡ŒåŠ æ³•ã€å‡æ³•ã€ä¹˜æ³•å’Œé™¤æ³•ã€‚</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">calculator</span>():</span><br><span class=\"line\">    operation = <span class=\"built_in\">input</span>(<span class=\"string\">&quot;é€‰æ‹©æ“ä½œï¼ˆ+ï¼Œ-ï¼Œ*ï¼Œ/ï¼‰ï¼š&quot;</span>)</span><br><span class=\"line\">    num1 = <span class=\"built_in\">float</span>(<span class=\"built_in\">input</span>(<span class=\"string\">&quot;è¾“å…¥ç¬¬ä¸€ä¸ªæ•°å­—ï¼š&quot;</span>))</span><br><span class=\"line\">    num2 = <span class=\"built_in\">float</span>(<span class=\"built_in\">input</span>(<span class=\"string\">&quot;è¾“å…¥ç¬¬äºŒä¸ªæ•°å­—ï¼š&quot;</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> operation == <span class=\"string\">&#x27;+&#x27;</span>:</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">f&quot;<span class=\"subst\">&#123;num1&#125;</span> + <span class=\"subst\">&#123;num2&#125;</span> = <span class=\"subst\">&#123;num1 + num2&#125;</span>&quot;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">elif</span> operation == <span class=\"string\">&#x27;-&#x27;</span>:</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">f&quot;<span class=\"subst\">&#123;num1&#125;</span> - <span class=\"subst\">&#123;num2&#125;</span> = <span class=\"subst\">&#123;num1 - num2&#125;</span>&quot;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">elif</span> operation == <span class=\"string\">&#x27;*&#x27;</span>:</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">f&quot;<span class=\"subst\">&#123;num1&#125;</span> * <span class=\"subst\">&#123;num2&#125;</span> = <span class=\"subst\">&#123;num1 * num2&#125;</span>&quot;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">elif</span> operation == <span class=\"string\">&#x27;/&#x27;</span>:</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">f&quot;<span class=\"subst\">&#123;num1&#125;</span> / <span class=\"subst\">&#123;num2&#125;</span> = <span class=\"subst\">&#123;num1 / num2&#125;</span>&quot;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&quot;æ— æ•ˆæ“ä½œ&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">calculator()  </span><br></pre></td></tr></table></figure>\n<h4 id=\"3-çŒœæ•°å­—\">3. çŒœæ•°å­—</h4>\n<p>è¿™ä¸ªæ¸¸æˆéšæœºé€‰æ‹©ä¸€ä¸ª1åˆ°100ä¹‹é—´çš„æ•°å­—ï¼Œç©å®¶å¿…é¡»çŒœå‡ºå®ƒã€‚</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> PIL <span class=\"keyword\">import</span> Image   <span class=\"keyword\">import</span> os      <span class=\"keyword\">def</span> <span class=\"title function_\">batch_resiimport</span> random   <span class=\"keyword\">def</span> <span class=\"title function_\">guess_the_number</span>():       number_to_guess = random.randint(<span class=\"number\">1</span>, <span class=\"number\">100</span>)       guess = <span class=\"literal\">None</span>          <span class=\"keyword\">while</span> guess != number_to_guess:           guess = <span class=\"built_in\">int</span>(<span class=\"built_in\">input</span>(<span class=\"string\">&quot;çŒœä¸€ä¸ª1åˆ°100ä¹‹é—´çš„æ•°å­—ï¼š&quot;</span>))           <span class=\"keyword\">if</span> guess &lt; number_to_guess:               <span class=\"built_in\">print</span>(<span class=\"string\">&quot;å¤ªä½äº†ï¼&quot;</span>)           <span class=\"keyword\">elif</span> guess &gt; number_to_guess:               <span class=\"built_in\">print</span>(<span class=\"string\">&quot;å¤ªé«˜äº†ï¼&quot;</span>)           <span class=\"keyword\">else</span>:               <span class=\"built_in\">print</span>(<span class=\"string\">&quot;æ­å–œä½ ï¼ä½ çŒœå¯¹äº†ã€‚&quot;</span>)      guess_the_number()<span class=\"keyword\">import</span> random   <span class=\"keyword\">def</span> <span class=\"title function_\">guess_the_number</span>():       number_to_guess = random.randint(<span class=\"number\">1</span>, <span class=\"number\">100</span>)       guess = <span class=\"literal\">None</span>          <span class=\"keyword\">while</span> guess != number_to_guess:           guess = <span class=\"built_in\">int</span>(<span class=\"built_in\">input</span>(<span class=\"string\">&quot;çŒœä¸€ä¸ª1åˆ°100ä¹‹é—´çš„æ•°å­—ï¼š&quot;</span>))           <span class=\"keyword\">if</span> guess &lt; number_to_guess:               <span class=\"built_in\">print</span>(<span class=\"string\">&quot;å¤ªä½äº†ï¼&quot;</span>)           <span class=\"keyword\">elif</span> guess &gt; number_to_guess:               <span class=\"built_in\">print</span>(<span class=\"string\">&quot;å¤ªé«˜äº†ï¼&quot;</span>)           <span class=\"keyword\">else</span>:               <span class=\"built_in\">print</span>(<span class=\"string\">&quot;æ­å–œä½ ï¼ä½ çŒœå¯¹äº†ã€‚&quot;</span>)      guess_the_number()ze(folder, width, height):       <span class=\"keyword\">for</span> filename <span class=\"keyword\">in</span> os.listdir(folder):           <span class=\"keyword\">if</span> filename.endswith((<span class=\"string\">&#x27;.jpeg&#x27;</span>, <span class=\"string\">&#x27;.jpg&#x27;</span>, <span class=\"string\">&#x27;.png&#x27;</span>)):               img = Image.<span class=\"built_in\">open</span>(os.path.join(folder, filename))               img = img.resize((width, height))               img.save(os.path.join(folder, <span class=\"string\">f&quot;resized_<span class=\"subst\">&#123;filename&#125;</span>&quot;</span>))               <span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;è°ƒæ•´äº† <span class=\"subst\">&#123;filename&#125;</span> çš„å¤§å°&#x27;</span>)      batch_resize(<span class=\"string\">&#x27;/path/to/images&#x27;</span>, <span class=\"number\">800</span>, <span class=\"number\">600</span>)   </span><br></pre></td></tr></table></figure>\n<h4 id=\"4-çŸ³å¤´å‰ªåˆ€å¸ƒ\">4. çŸ³å¤´å‰ªåˆ€å¸ƒ</h4>\n<p>å®ç°ç»å…¸çš„çŸ³å¤´ã€å‰ªåˆ€ã€å¸ƒæ¸¸æˆã€‚</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> random   <span class=\"keyword\">def</span> <span class=\"title function_\">rock_paper_scissors</span>():       choices = [<span class=\"string\">&#x27;rock&#x27;</span>, <span class=\"string\">&#x27;paper&#x27;</span>, <span class=\"string\">&#x27;scissors&#x27;</span>]       computer_choice = random.choice(choices)       user_choice = <span class=\"built_in\">input</span>(<span class=\"string\">&quot;é€‰æ‹©çŸ³å¤´ã€å‰ªåˆ€æˆ–å¸ƒï¼š&quot;</span>).lower()          <span class=\"keyword\">if</span> user_choice <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> choices:           <span class=\"built_in\">print</span>(<span class=\"string\">&quot;æ— æ•ˆé€‰æ‹©&quot;</span>)           <span class=\"keyword\">return</span>          <span class=\"built_in\">print</span>(<span class=\"string\">f&quot;è®¡ç®—æœºé€‰æ‹©äº†ï¼š<span class=\"subst\">&#123;computer_choice&#125;</span>&quot;</span>)       <span class=\"keyword\">if</span> user_choice == computer_choice:           <span class=\"built_in\">print</span>(<span class=\"string\">&quot;å¹³å±€ï¼&quot;</span>)       <span class=\"keyword\">elif</span> (user_choice == <span class=\"string\">&#x27;rock&#x27;</span> <span class=\"keyword\">and</span> computer_choice == <span class=\"string\">&#x27;scissors&#x27;</span>) <span class=\"keyword\">or</span> \\            (user_choice == <span class=\"string\">&#x27;scissors&#x27;</span> <span class=\"keyword\">and</span> computer_choice == <span class=\"string\">&#x27;paper&#x27;</span>) <span class=\"keyword\">or</span> \\            (user_choice == <span class=\"string\">&#x27;paper&#x27;</span> <span class=\"keyword\">and</span> computer_choice == <span class=\"string\">&#x27;rock&#x27;</span>):           <span class=\"built_in\">print</span>(<span class=\"string\">&quot;ä½ èµ¢äº†ï¼&quot;</span>)       <span class=\"keyword\">else</span>:           <span class=\"built_in\">print</span>(<span class=\"string\">&quot;ä½ è¾“äº†ï¼&quot;</span>)      rock_paper_scissors()   </span><br></pre></td></tr></table></figure>\n<h4 id=\"5-å¾…åŠäº‹é¡¹åˆ—è¡¨\">5. å¾…åŠäº‹é¡¹åˆ—è¡¨</h4>\n<p>åˆ›å»ºä¸€ä¸ªç®€å•çš„å¾…åŠäº‹é¡¹åˆ—è¡¨åº”ç”¨ç¨‹åºã€‚</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">to_do_list</span>():       tasks = []          <span class=\"keyword\">while</span> <span class=\"literal\">True</span>:           action = <span class=\"built_in\">input</span>(<span class=\"string\">&quot;è¾“å…¥ &#x27;add&#x27; æ·»åŠ ä»»åŠ¡ï¼Œ&#x27;remove&#x27; åˆ é™¤ä»»åŠ¡ï¼Œ&#x27;view&#x27; æŸ¥çœ‹æ‰€æœ‰ä»»åŠ¡ï¼Œæˆ– &#x27;quit&#x27; é€€å‡ºï¼š&quot;</span>).lower()           <span class=\"keyword\">if</span> action == <span class=\"string\">&#x27;add&#x27;</span>:               task = <span class=\"built_in\">input</span>(<span class=\"string\">&quot;è¾“å…¥ä¸€ä¸ªä»»åŠ¡ï¼š&quot;</span>)               tasks.append(task)           <span class=\"keyword\">elif</span> action == <span class=\"string\">&#x27;remove&#x27;</span>:               task = <span class=\"built_in\">input</span>(<span class=\"string\">&quot;è¾“å…¥è¦åˆ é™¤çš„ä»»åŠ¡ï¼š&quot;</span>)               <span class=\"keyword\">if</span> task <span class=\"keyword\">in</span> tasks:                   tasks.remove(task)               <span class=\"keyword\">else</span>:                   <span class=\"built_in\">print</span>(<span class=\"string\">&quot;ä»»åŠ¡æœªæ‰¾åˆ°&quot;</span>)           <span class=\"keyword\">elif</span> action == <span class=\"string\">&#x27;view&#x27;</span>:               <span class=\"built_in\">print</span>(<span class=\"string\">&quot;ä»»åŠ¡ï¼š&quot;</span>, tasks)           <span class=\"keyword\">elif</span> action == <span class=\"string\">&#x27;quit&#x27;</span>:               <span class=\"keyword\">break</span>           <span class=\"keyword\">else</span>:               <span class=\"built_in\">print</span>(<span class=\"string\">&quot;æ— æ•ˆæ“ä½œ&quot;</span>)      to_do_list()   </span><br></pre></td></tr></table></figure>\n<h4 id=\"6-åŸºç¡€ç½‘é¡µæŠ“å–å™¨\">6. åŸºç¡€ç½‘é¡µæŠ“å–å™¨</h4>\n<p>å­¦ä¹ ä½¿ç”¨BeautifulSoupè¿›è¡ŒåŸºç¡€çš„ç½‘é¡µæŠ“å–ã€‚</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requests   <span class=\"keyword\">from</span> bs4 <span class=\"keyword\">import</span> BeautifulSoup      <span class=\"keyword\">def</span> <span class=\"title function_\">web_scraper</span>():       url = <span class=\"string\">&#x27;http://example.com&#x27;</span>       response = requests.get(url)       soup = BeautifulSoup(response.content, <span class=\"string\">&#x27;html.parser&#x27;</span>)       <span class=\"built_in\">print</span>(soup.prettify())   web_scraper()   </span><br></pre></td></tr></table></figure>\n<h4 id=\"7-å¤©æ°”åº”ç”¨\">7. å¤©æ°”åº”ç”¨</h4>\n<p>ä½¿ç”¨APIè·å–æŒ‡å®šåŸå¸‚çš„å¤©æ°”æ•°æ®ã€‚</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requests   <span class=\"keyword\">def</span> <span class=\"title function_\">weather_app</span>():       api_key = <span class=\"string\">&#x27;your_api_key&#x27;</span>       city = <span class=\"built_in\">input</span>(<span class=\"string\">&quot;è¾“å…¥åŸå¸‚åç§°ï¼š&quot;</span>)       url = <span class=\"string\">f&#x27;http://api.openweathermap.org/data/2.5/weather?q=<span class=\"subst\">&#123;city&#125;</span>&amp;appid=<span class=\"subst\">&#123;api_key&#125;</span>&#x27;</span>          response = requests.get(url)       data = response.json()          <span class=\"keyword\">if</span> data[<span class=\"string\">&#x27;cod&#x27;</span>] == <span class=\"number\">200</span>:           main = data[<span class=\"string\">&#x27;main&#x27;</span>]           temperature = main[<span class=\"string\">&#x27;temp&#x27;</span>]           weather = data[<span class=\"string\">&#x27;weather&#x27;</span>][<span class=\"number\">0</span>][<span class=\"string\">&#x27;description&#x27;</span>]           <span class=\"built_in\">print</span>(<span class=\"string\">f&quot;æ¸©åº¦ï¼š<span class=\"subst\">&#123;temperature&#125;</span>&quot;</span>)           <span class=\"built_in\">print</span>(<span class=\"string\">f&quot;å¤©æ°”ï¼š<span class=\"subst\">&#123;weather&#125;</span>&quot;</span>)       <span class=\"keyword\">else</span>:           <span class=\"built_in\">print</span>(<span class=\"string\">&quot;åŸå¸‚æœªæ‰¾åˆ°&quot;</span>)      weather_app()   </span><br></pre></td></tr></table></figure>\n<h4 id=\"8-å¡«è¯æ¸¸æˆç”Ÿæˆå™¨\">8. å¡«è¯æ¸¸æˆç”Ÿæˆå™¨</h4>\n<p>åˆ›å»ºä¸€ä¸ªæœ‰è¶£çš„å¡«è¯æ¸¸æˆï¼Œç”¨æˆ·é€šè¿‡è¾“å…¥å®Œæˆä¸€ä¸ªæ•…äº‹ã€‚</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">mad_libs</span>():       noun = <span class=\"built_in\">input</span>(<span class=\"string\">&quot;è¾“å…¥ä¸€ä¸ªåè¯ï¼š&quot;</span>)       adjective = <span class=\"built_in\">input</span>(<span class=\"string\">&quot;è¾“å…¥ä¸€ä¸ªå½¢å®¹è¯ï¼š&quot;</span>)       verb = <span class=\"built_in\">input</span>(<span class=\"string\">&quot;è¾“å…¥ä¸€ä¸ªåŠ¨è¯ï¼š&quot;</span>)       place = <span class=\"built_in\">input</span>(<span class=\"string\">&quot;è¾“å…¥ä¸€ä¸ªåœ°ç‚¹ï¼š&quot;</span>)          story = <span class=\"string\">f&quot;ä»å‰ï¼Œæœ‰ä¸€ä¸ªå–œæ¬¢åœ¨<span class=\"subst\">&#123;place&#125;</span>åš<span class=\"subst\">&#123;verb&#125;</span>çš„<span class=\"subst\">&#123;adjective&#125;</span> <span class=\"subst\">&#123;noun&#125;</span>ã€‚&quot;</span>       <span class=\"built_in\">print</span>(story)      mad_libs()   </span><br></pre></td></tr></table></figure>\n<h4 id=\"9-æ–æ³¢é‚£å¥‘æ•°åˆ—\">9. æ–æ³¢é‚£å¥‘æ•°åˆ—</h4>\n<p>ç”Ÿæˆåˆ°æŒ‡å®šæ•°å­—çš„æ–æ³¢é‚£å¥‘æ•°åˆ—ã€‚</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">fibonacci_sequence</span>(<span class=\"params\">n</span>):       sequence = [<span class=\"number\">0</span>, <span class=\"number\">1</span>]       <span class=\"keyword\">while</span> <span class=\"built_in\">len</span>(sequence) &lt; n:           sequence.append(sequence[-<span class=\"number\">1</span>] + sequence[-<span class=\"number\">2</span>])       <span class=\"built_in\">print</span>(sequence)   fibonacci_sequence(<span class=\"number\">10</span>)   </span><br></pre></td></tr></table></figure>\n<h4 id=\"10-å¯†ç ç”Ÿæˆå™¨\">10. å¯†ç ç”Ÿæˆå™¨</h4>\n<p>åˆ›å»ºä¸€ä¸ªè„šæœ¬ï¼Œç”Ÿæˆä¸€ä¸ªéšæœºçš„å®‰å…¨å¯†ç ã€‚</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> random   <span class=\"keyword\">import</span> string      <span class=\"keyword\">def</span> <span class=\"title function_\">password_generator</span>(<span class=\"params\">length=<span class=\"number\">12</span></span>):       characters = string.ascii_letters + string.digits + string.punctuation       password = <span class=\"string\">&#x27;&#x27;</span>.join(random.choice(characters) <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(length))       <span class=\"built_in\">print</span>(password)      password_generator()   </span><br></pre></td></tr></table></figure>\n<h4 id=\"11-åŠæ­»é¬¼æ¸¸æˆ\">11. åŠæ­»é¬¼æ¸¸æˆ</h4>\n<p>åˆ›å»ºä¸€ä¸ªç»å…¸çš„åŠæ­»é¬¼æ¸¸æˆï¼Œç©å®¶çŒœæµ‹å­—æ¯ä»¥æ­ç¤ºéšè—çš„å•è¯ã€‚</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> random   <span class=\"keyword\">def</span> <span class=\"title function_\">hangman</span>():       words = [<span class=\"string\">&#x27;python&#x27;</span>, <span class=\"string\">&#x27;java&#x27;</span>, <span class=\"string\">&#x27;swift&#x27;</span>, <span class=\"string\">&#x27;javascript&#x27;</span>]       word = random.choice(words)       guessed_letters = <span class=\"built_in\">set</span>()       attempts = <span class=\"number\">6</span>          <span class=\"keyword\">while</span> attempts &gt; <span class=\"number\">0</span>:           display_word = <span class=\"string\">&#x27;&#x27;</span>.join([letter <span class=\"keyword\">if</span> letter <span class=\"keyword\">in</span> guessed_letters <span class=\"keyword\">else</span> <span class=\"string\">&#x27;_&#x27;</span> <span class=\"keyword\">for</span> letter <span class=\"keyword\">in</span> word])           <span class=\"built_in\">print</span>(display_word)                      <span class=\"keyword\">if</span> <span class=\"string\">&#x27;_&#x27;</span> <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> display_word:               <span class=\"built_in\">print</span>(<span class=\"string\">&quot;æ­å–œä½ ï¼ä½ çŒœå¯¹äº†å•è¯ã€‚&quot;</span>)               <span class=\"keyword\">break</span>              guess = <span class=\"built_in\">input</span>(<span class=\"string\">&quot;çŒœä¸€ä¸ªå­—æ¯ï¼š&quot;</span>).lower()           <span class=\"keyword\">if</span> guess <span class=\"keyword\">in</span> guessed_letters:               <span class=\"built_in\">print</span>(<span class=\"string\">&quot;ä½ å·²ç»çŒœè¿‡é‚£ä¸ªå­—æ¯äº†ã€‚&quot;</span>)           <span class=\"keyword\">elif</span> guess <span class=\"keyword\">in</span> word:               guessed_letters.add(guess)           <span class=\"keyword\">else</span>:               attempts -= <span class=\"number\">1</span>               <span class=\"built_in\">print</span>(<span class=\"string\">f&quot;çŒœé”™äº†ã€‚ä½ è¿˜æœ‰<span class=\"subst\">&#123;attempts&#125;</span>æ¬¡æœºä¼šã€‚&quot;</span>)              <span class=\"keyword\">if</span> attempts == <span class=\"number\">0</span>:           <span class=\"built_in\">print</span>(<span class=\"string\">f&quot;æ¸¸æˆç»“æŸï¼å•è¯æ˜¯&#x27;<span class=\"subst\">&#123;word&#125;</span>&#x27;ã€‚&quot;</span>)      hangman()   </span><br></pre></td></tr></table></figure>\n<h4 id=\"12-è´¨æ•°æ£€æŸ¥å™¨\">12. è´¨æ•°æ£€æŸ¥å™¨</h4>\n<p>ç¼–å†™ä¸€ä¸ªè„šæœ¬ï¼Œæ£€æŸ¥ç»™å®šçš„æ•°å­—æ˜¯å¦ä¸ºè´¨æ•°ã€‚</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">is_prime</span>(<span class=\"params\">n</span>):       <span class=\"keyword\">if</span> n &lt;= <span class=\"number\">1</span>:           <span class=\"keyword\">return</span> <span class=\"literal\">False</span>       <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">2</span>, <span class=\"built_in\">int</span>(n**<span class=\"number\">0.5</span>) + <span class=\"number\">1</span>):           <span class=\"keyword\">if</span> n % i == <span class=\"number\">0</span>:               <span class=\"keyword\">return</span> <span class=\"literal\">False</span>       <span class=\"keyword\">return</span> <span class=\"literal\">True</span>      number = <span class=\"built_in\">int</span>(<span class=\"built_in\">input</span>(<span class=\"string\">&quot;è¾“å…¥ä¸€ä¸ªæ•°å­—ï¼š&quot;</span>))   <span class=\"keyword\">if</span> is_prime(number):       <span class=\"built_in\">print</span>(<span class=\"string\">f&quot;<span class=\"subst\">&#123;number&#125;</span> æ˜¯ä¸€ä¸ªè´¨æ•°ã€‚&quot;</span>)   <span class=\"keyword\">else</span>:       <span class=\"built_in\">print</span>(<span class=\"string\">f&quot;<span class=\"subst\">&#123;number&#125;</span> ä¸æ˜¯ä¸€ä¸ªè´¨æ•°ã€‚&quot;</span>)</span><br></pre></td></tr></table></figure>\n<h4 id=\"13-è´§å¸è½¬æ¢å™¨\">13. è´§å¸è½¬æ¢å™¨</h4>\n<p>åˆ›å»ºä¸€ä¸ªç®€å•çš„è´§å¸è½¬æ¢å™¨ï¼Œä½¿ç”¨ API è·å–æœ€æ–°çš„æ±‡ç‡ã€‚</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requests   <span class=\"keyword\">def</span> <span class=\"title function_\">currency_converter</span>():       api_key = <span class=\"string\">&#x27;your_api_key&#x27;</span>       base_currency = <span class=\"built_in\">input</span>(<span class=\"string\">&quot;è¾“å…¥åŸºå‡†è´§å¸ï¼ˆä¾‹å¦‚ï¼ŒUSDï¼‰ï¼š&quot;</span>).upper()       target_currency = <span class=\"built_in\">input</span>(<span class=\"string\">&quot;è¾“å…¥ç›®æ ‡è´§å¸ï¼ˆä¾‹å¦‚ï¼ŒEURï¼‰ï¼š&quot;</span>).upper()       amount = <span class=\"built_in\">float</span>(<span class=\"built_in\">input</span>(<span class=\"string\">&quot;è¾“å…¥é‡‘é¢ï¼š&quot;</span>))          url = <span class=\"string\">f&#x27;https://api.exchangerate-api.com/v4/latest/<span class=\"subst\">&#123;base_currency&#125;</span>&#x27;</span>       response = requests.get(url)       data = response.json()              <span class=\"keyword\">if</span> target_currency <span class=\"keyword\">in</span> data[<span class=\"string\">&#x27;rates&#x27;</span>]:           exchange_rate = data[<span class=\"string\">&#x27;rates&#x27;</span>][target_currency]           converted_amount = amount * exchange_rate           <span class=\"built_in\">print</span>(<span class=\"string\">f&quot;<span class=\"subst\">&#123;amount&#125;</span> <span class=\"subst\">&#123;base_currency&#125;</span> ç­‰äº <span class=\"subst\">&#123;converted_amount:<span class=\"number\">.2</span>f&#125;</span> <span class=\"subst\">&#123;target_currency&#125;</span>&quot;</span>)       <span class=\"keyword\">else</span>:           <span class=\"built_in\">print</span>(<span class=\"string\">&quot;è´§å¸ä¸æ”¯æŒã€‚&quot;</span>)      currency_converter()   </span><br></pre></td></tr></table></figure>\n<h4 id=\"14-BMIè®¡ç®—å™¨\">14. BMIè®¡ç®—å™¨</h4>\n<p>åˆ›å»ºä¸€ä¸ªè„šæœ¬ï¼Œæ ¹æ®ç”¨æˆ·è¾“å…¥è®¡ç®—èº«ä½“è´¨é‡æŒ‡æ•°ï¼ˆBMIï¼‰ã€‚</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">bmi_calculator</span>():       height = <span class=\"built_in\">float</span>(<span class=\"built_in\">input</span>(<span class=\"string\">&quot;è¾“å…¥èº«é«˜ï¼ˆç±³ï¼‰ï¼š&quot;</span>))       weight = <span class=\"built_in\">float</span>(<span class=\"built_in\">input</span>(<span class=\"string\">&quot;è¾“å…¥ä½“é‡ï¼ˆåƒå…‹ï¼‰ï¼š&quot;</span>))       bmi = weight / (height ** <span class=\"number\">2</span>)       <span class=\"built_in\">print</span>(<span class=\"string\">f&quot;ä½ çš„BMIæ˜¯ï¼š<span class=\"subst\">&#123;bmi:<span class=\"number\">.2</span>f&#125;</span>&quot;</span>)              <span class=\"keyword\">if</span> bmi &lt; <span class=\"number\">18.5</span>:           <span class=\"built_in\">print</span>(<span class=\"string\">&quot;ä½ ä½“é‡è¿‡è½»ã€‚&quot;</span>)       <span class=\"keyword\">elif</span> <span class=\"number\">18.5</span> &lt;= bmi &lt; <span class=\"number\">24.9</span>:           <span class=\"built_in\">print</span>(<span class=\"string\">&quot;ä½ ä½“é‡æ­£å¸¸ã€‚&quot;</span>)       <span class=\"keyword\">elif</span> <span class=\"number\">25</span> &lt;= bmi &lt; <span class=\"number\">29.9</span>:           <span class=\"built_in\">print</span>(<span class=\"string\">&quot;   </span></span><br></pre></td></tr></table></figure>\n<h4 id=\"15-äº•å­—æ£‹æ¸¸æˆ\">15. äº•å­—æ£‹æ¸¸æˆ</h4>\n<p>åˆ›å»ºä¸€ä¸ªå¯ä¾›ä¸¤äººæ¸¸ç©çš„äº•å­—æ£‹æ¸¸æˆã€‚</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">print_board</span>(<span class=\"params\">board</span>):       <span class=\"keyword\">for</span> row <span class=\"keyword\">in</span> board:           <span class=\"built_in\">print</span>(<span class=\"string\">&quot; | &quot;</span>.join(row))           <span class=\"built_in\">print</span>(<span class=\"string\">&quot;-&quot;</span> * <span class=\"number\">5</span>)   <span class=\"keyword\">def</span> <span class=\"title function_\">check_winner</span>(<span class=\"params\">board, player</span>):       <span class=\"keyword\">for</span> row <span class=\"keyword\">in</span> board:           <span class=\"keyword\">if</span> <span class=\"built_in\">all</span>([cell == player <span class=\"keyword\">for</span> cell <span class=\"keyword\">in</span> row]):               <span class=\"keyword\">return</span> <span class=\"literal\">True</span>       <span class=\"keyword\">for</span> col <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">3</span>):           <span class=\"keyword\">if</span> <span class=\"built_in\">all</span>([board[row][col] == player <span class=\"keyword\">for</span> row <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">3</span>)]):               <span class=\"keyword\">return</span> <span class=\"literal\">True</span>       <span class=\"keyword\">if</span> <span class=\"built_in\">all</span>([board[i][i] == player <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">3</span>)]) <span class=\"keyword\">or</span> <span class=\"built_in\">all</span>([board[i][<span class=\"number\">2</span>-i] == player <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">3</span>)]):           <span class=\"keyword\">return</span> <span class=\"literal\">True</span>       <span class=\"keyword\">return</span> <span class=\"literal\">False</span>   <span class=\"keyword\">def</span> <span class=\"title function_\">tic_tac_toe</span>():       board = [[<span class=\"string\">&#x27; &#x27;</span> <span class=\"keyword\">for</span> _ <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">3</span>)] <span class=\"keyword\">for</span> _ <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">3</span>)]       players = [<span class=\"string\">&#x27;X&#x27;</span>, <span class=\"string\">&#x27;O&#x27;</span>]       turn = <span class=\"number\">0</span>          <span class=\"keyword\">for</span> _ <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">9</span>):           print_board(board)           player = players[turn % <span class=\"number\">2</span>]           <span class=\"built_in\">print</span>(<span class=\"string\">f&quot;Player <span class=\"subst\">&#123;player&#125;</span>&#x27;s turn&quot;</span>)           row = <span class=\"built_in\">int</span>(<span class=\"built_in\">input</span>(<span class=\"string\">&quot;Enter row (0, 1, 2): &quot;</span>))           col = <span class=\"built_in\">int</span>(<span class=\"built_in\">input</span>(<span class=\"string\">&quot;Enter column (0, 1, 2): &quot;</span>))              <span class=\"keyword\">if</span> board[row][col] == <span class=\"string\">&#x27; &#x27;</span>:               board[row][col] = player               <span class=\"keyword\">if</span> check_winner(board, player):                   print_board(board)                   <span class=\"built_in\">print</span>(<span class=\"string\">f&quot;Player <span class=\"subst\">&#123;player&#125;</span> wins!&quot;</span>)                   <span class=\"keyword\">return</span>               turn += <span class=\"number\">1</span>           <span class=\"keyword\">else</span>:               <span class=\"built_in\">print</span>(<span class=\"string\">&quot;Cell already taken. Try again.&quot;</span>)          print_board(board)       <span class=\"built_in\">print</span>(<span class=\"string\">&quot;It&#x27;s a tie!&quot;</span>)      tic_tac_toe()   </span><br></pre></td></tr></table></figure>\n<h3 id=\"æ€»ç»“\">æ€»ç»“</h3>\n<p>è¿™åäº”ä¸ªè„šæœ¬æ¶µç›–äº†ä¸€ç³»åˆ—åŸºç¡€çš„Pythonæ¦‚å¿µï¼Œå¹¶ä¸ºåˆå­¦è€…æä¾›äº†åšå®çš„åŸºç¡€ã€‚é€šè¿‡è¿™äº›é¡¹ç›®çš„å®è·µï¼Œæ–°ç¨‹åºå‘˜å¯ä»¥å»ºç«‹èµ·ä¿¡å¿ƒï¼Œå¹¶é€æ¸è§£å†³Pythonä¸­æ›´å¤æ‚çš„é—®é¢˜ã€‚</p>\n","tags":["Script"]},{"title":"C/C++ è¯»å–EXCELæ•°æ®","url":"/post/undefined.html","content":"<ul>\n<li>æ‰“å¼€Excelæ–‡ä»¶ï¼Œç‚¹å‡»æ–‡ä»¶-å¦å­˜ä¸º</li>\n<li>åœ¨ä¿å­˜ç±»å‹è¿™é‡Œè®¾ç½®ä¿å­˜ä¸ºcsvæ ¼å¼</li>\n<li>é€‰æ‹©å¥½æƒ³ä¿å­˜çš„ç›®å½•åï¼Œç‚¹å‡»ä¿å­˜</li>\n<li>å›åˆ°å·¥ä½œç•Œé¢åï¼Œä¼šå¼¹å‡ºçª—å£ï¼Œé€‰æ‹©ç¡®å®šå°±å¯ä»¥äº†</li>\n</ul>\n<p><strong>æŒ‰è¡Œè¯»å–ã€‚</strong></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;iostream&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;fstream&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;string&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\">ifstream <span class=\"title\">file</span><span class=\"params\">(<span class=\"string\">&quot;01.csv&quot;</span>)</span></span>; <span class=\"comment\">// æ‰“å¼€CSVæ–‡ä»¶</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!file.<span class=\"built_in\">is_open</span>()) &#123;</span><br><span class=\"line\">        cout &lt;&lt; <span class=\"string\">&quot;æ— æ³•æ‰“å¼€æ–‡ä»¶ï¼&quot;</span> &lt;&lt; endl;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    string line;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (<span class=\"built_in\">getline</span>(file, line)) &#123; <span class=\"comment\">// é€è¡Œè¯»å–æ–‡ä»¶</span></span><br><span class=\"line\">        cout &lt;&lt; line &lt;&lt; endl; <span class=\"comment\">// æ‰“å°æ¯ä¸€è¡Œå†…å®¹</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    file.<span class=\"built_in\">close</span>(); <span class=\"comment\">// å…³é—­æ–‡ä»¶</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","tags":["c++"]},{"title":"è®¡ç®—æœºç½‘ç»œå®è·µè®°å½•","url":"/post/3f763db6.html","content":"<hr>\n<ul>\n<li>å¤©æ´¥å¤§å­¦ 2024 è®¡ç®—æœºç½‘ç»œ TCP è¯¾ç¨‹å®è·µ</li>\n<li>Lab Memberï¼šæµ·æ£ æœªé›¨ï¼Œæ¢¨èŠ±å…ˆé›ª</li>\n<li>æœ€ç»ˆæˆç»© 93 åˆ†æ ğŸ˜‹</li>\n</ul>\n<hr>\n<h1>æ–‡ä»¶ç»“æ„è¯´æ˜</h1>\n<figure class=\"highlight markdown\"><table><tr><td class=\"code\"><pre><span class=\"line\">tju<span class=\"emphasis\">_tcp ----------------- é¡¹ç›®æ ¹ç›®å½• </span></span><br><span class=\"line\"><span class=\"emphasis\">â”œâ”€ build ---------------- å­˜æ”¾æ‰€æœ‰ç¼–è¯‘çš„ä¸­é—´æ–‡ä»¶</span></span><br><span class=\"line\"><span class=\"emphasis\">â”‚  â”œâ”€ kernel.o</span></span><br><span class=\"line\"><span class=\"emphasis\">â”‚  â”œâ”€ tju_</span>packet.o  </span><br><span class=\"line\">â”‚  â””â”€ tju<span class=\"emphasis\">_tcp.o</span></span><br><span class=\"line\"><span class=\"emphasis\">â”œâ”€ inc ------------------ å­˜æ”¾æ‰€æœ‰å¤´æ–‡ä»¶</span></span><br><span class=\"line\"><span class=\"emphasis\">â”‚  â”œâ”€ global.h ---------- å®šä¹‰ä¸€äº›å…¨å±€éƒ½ä¼šç”¨åˆ°çš„å˜é‡å’Œç»“æ„</span></span><br><span class=\"line\"><span class=\"emphasis\">â”‚  â”œâ”€ kernel.h ---------- æ¨¡æ‹Ÿä¸€éƒ¨åˆ†linuxå†…æ ¸è¡Œä¸º æ¯”å¦‚å¦‚ä½•å‘é€æ•°æ®åˆ°ä¸‹ä¸€å±‚ æ ¹æ®äº”å…ƒç»„æŸ¥æ‰¾socketç­‰</span></span><br><span class=\"line\"><span class=\"emphasis\">â”‚  â”œâ”€ tju_</span>packet.h ------ å®šä¹‰TCPæ‰€ç”¨åˆ°çš„æ•°æ®åŒ…æ ¼å¼ æä¾›å„ç§æ•°æ®åŒ…çš„æ“ä½œ(åˆ›å»º è·å¾—å­—æ®µç­‰)</span><br><span class=\"line\">â”‚  â””â”€ tju<span class=\"emphasis\">_tcp.h --------- éœ€è¦å®ç°çš„TCPçš„å„ç§ç»“æ„å’ŒåŠŸèƒ½çš„å®šä¹‰</span></span><br><span class=\"line\"><span class=\"emphasis\">â”œâ”€ src ------------------ å­˜æ”¾æ‰€æœ‰æºä»£ç æ–‡ä»¶</span></span><br><span class=\"line\"><span class=\"emphasis\">â”‚  â”œâ”€ client.c ---------- å®¢æˆ·ç«¯ä¸»å‡½æ•°å®ç°</span></span><br><span class=\"line\"><span class=\"emphasis\">â”‚  â”œâ”€ server.c ---------- æœåŠ¡ç«¯ä¸»å‡½æ•°å®ç°</span></span><br><span class=\"line\"><span class=\"emphasis\">â”‚  â”œâ”€ kernel.c ---------- è™šæ‹Ÿå†…æ ¸å®ç°</span></span><br><span class=\"line\"><span class=\"emphasis\">â”‚  â”œâ”€ tju_</span>packet.c ------ å¯é å±‚åŒ…å°è£…å®ç°</span><br><span class=\"line\">â”‚  â””â”€ tju<span class=\"emphasis\">_tcp.c --------- å¯é å±‚å®ç°</span></span><br><span class=\"line\"><span class=\"emphasis\">â”œâ”€ Makefile ------------- ç”Ÿæˆè„šæœ¬</span></span><br><span class=\"line\"><span class=\"emphasis\">â”œâ”€ README.md ------------ æ–‡ä»¶è¯´æ˜</span></span><br><span class=\"line\"><span class=\"emphasis\">â””â”€ bin</span></span><br><span class=\"line\"><span class=\"emphasis\">   â”œâ”€ client</span></span><br><span class=\"line\"><span class=\"emphasis\">   â””â”€ server</span></span><br></pre></td></tr></table></figure>\n<hr>\n<h1>ç³»ç»Ÿç¯å¢ƒä¿¡æ¯</h1>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">neofetch</span><br><span class=\"line\">--------------</span><br><span class=\"line\">OS: Ubuntu 20.04.2 LTS x86_64</span><br><span class=\"line\">Host: Oracle Corporation VirtualBox</span><br><span class=\"line\">Kernel: 5.4.0-80-generic</span><br><span class=\"line\">Uptime: 3 mins</span><br><span class=\"line\">Packages: 676 (dpkg), 4 (snap)</span><br><span class=\"line\">Shell: bash 5.0.17</span><br><span class=\"line\">Resolution: 800x600</span><br><span class=\"line\">Terminal: /dev/pts/0</span><br><span class=\"line\">CPU: 11th Gen Intel i7-11800H (2) @ 2.304GHz</span><br><span class=\"line\">GPU: VirtualBox Graphics Adapter</span><br><span class=\"line\">Memory: 294MiB / 981MiB</span><br></pre></td></tr></table></figure>\n<hr>\n<h1>å…·ä½“å®éªŒè®°å½•</h1>\n<h2 id=\"è¿æ¥ç®¡ç†\">è¿æ¥ç®¡ç†</h2>\n<center>\n<img src=\"https://s2.loli.net/2024/10/11/t2LOxSBZgRkiblj.png\" width=\"60%\" />\n</center>\n<h3 id=\"ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¿æ¥\">ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¿æ¥</h3>\n<p><strong>1. tju_connect( )</strong><br>\n<code>tju_connect( )</code>å‡½æ•°æ˜¯ä¸‰æ¬¡æ¡æ‰‹çš„å¼€ç«¯ã€‚åœ¨è¯¥å‡½æ•°ä¸­ï¼Œå®¢æˆ·ç«¯çš„sockç»‘å®šå¥½æœ¬åœ°çš„ipå’Œportåå‘æœåŠ¡å™¨ç«¯å‘é€SYNåŒ…ï¼ŒåŒæ—¶æŠŠå½“å‰çš„çŠ¶æ€å˜åŒ–ä¸ºSYN_SENTã€‚æˆåŠŸå»ºç«‹è¿æ¥åå°†sockæ”¾å…¥ESTABLISHEDçš„hashè¡¨ä¸­ã€‚</p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">int</span> <span class=\"title function_\">tju_connect</span><span class=\"params\">(<span class=\"type\">tju_tcp_t</span>* sock, tju_sock_addr target_addr)</span>&#123;</span><br><span class=\"line\">    sock-&gt;established_remote_addr = target_addr;</span><br><span class=\"line\"></span><br><span class=\"line\">    tju_sock_addr local_addr;</span><br><span class=\"line\">    local_addr.ip = inet_network(CLIENT_IP);</span><br><span class=\"line\">    local_addr.port = <span class=\"number\">5678</span>; <span class=\"comment\">// è¿æ¥æ–¹è¿›è¡Œconnectè¿æ¥çš„æ—¶å€™ å†…æ ¸ä¸­æ˜¯éšæœºåˆ†é…ä¸€ä¸ªå¯ç”¨çš„ç«¯å£</span></span><br><span class=\"line\">    sock-&gt;established_local_addr = local_addr;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// è¿™é‡Œä¹Ÿä¸èƒ½ç›´æ¥å»ºç«‹è¿æ¥ éœ€è¦ç»è¿‡ä¸‰æ¬¡æ¡æ‰‹</span></span><br><span class=\"line\">    <span class=\"comment\">// å®é™…åœ¨linuxä¸­ connectè°ƒç”¨å ä¼šè¿›å…¥ä¸€ä¸ªwhileå¾ªç¯</span></span><br><span class=\"line\">    <span class=\"comment\">// å¾ªç¯è·³å‡ºçš„æ¡ä»¶æ˜¯socketçš„çŠ¶æ€å˜ä¸ºESTABLISHED è¡¨é¢çœ‹ä¸Šå»å°±æ˜¯ æ­£åœ¨è¿æ¥ä¸­ é˜»å¡</span></span><br><span class=\"line\">    <span class=\"comment\">// è€ŒçŠ¶æ€çš„æ”¹å˜åœ¨åˆ«çš„åœ°æ–¹è¿›è¡Œ åœ¨æˆ‘ä»¬è¿™å°±æ˜¯tju_handle_packet</span></span><br><span class=\"line\">    <span class=\"type\">uint32_t</span> seq = <span class=\"number\">0</span>;  <span class=\"comment\">// åºåˆ—å·</span></span><br><span class=\"line\">    <span class=\"type\">uint32_t</span> ack = <span class=\"number\">0</span>;  <span class=\"comment\">// ç¡®è®¤å·</span></span><br><span class=\"line\">    <span class=\"type\">uint8_t</span> flag=SYN_FLAG_MASK; <span class=\"comment\">//flagæ ‡è®°ä¸ºï¼šè¿æ¥çŠ¶æ€è¿›è¡Œåˆ°å“ªä¸€æ­¥</span></span><br><span class=\"line\">    <span class=\"type\">char</span> *SYN = create_packet_buf(sock-&gt;established_local_addr.port, sock-&gt;established_remote_addr.port,seq, ack, DEFAULT_HEADER_LEN, DEFAULT_HEADER_LEN, flag, <span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"literal\">NULL</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    sendToLayer3(SYN, DEFAULT_HEADER_LEN); <span class=\"comment\">//å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯å‘é€åŒæ­¥æŠ¥æ–‡--ç¬¬ä¸€æ¬¡æ¡æ‰‹</span></span><br><span class=\"line\">    change_sock_state(sock, SYN_SENT);</span><br><span class=\"line\">    <span class=\"comment\">// printf(&quot;clientå‘é€SYN\\n&quot;);</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    Timeout_retransmission(sock, ESTABLISHED, SYN, DEFAULT_HEADER_LEN); <span class=\"comment\">//é˜»å¡ç­‰å¾…ï¼Œç›´åˆ°sockè¢«å»ºç«‹</span></span><br><span class=\"line\">    <span class=\"type\">int</span> hashval = cal_hash(sock-&gt;established_local_addr.ip, sock-&gt;established_local_addr.port,sock-&gt;established_remote_addr.ip, sock-&gt;established_remote_addr.port);</span><br><span class=\"line\">    established_socks[hashval] = sock;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>2. Timeout_retransmission( )</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">Timeout_retransmission</span><span class=\"params\">(<span class=\"type\">tju_tcp_t</span>* sock, <span class=\"type\">int</span> exp_state, <span class=\"type\">char</span>* pkt, <span class=\"type\">int</span> pktlen)</span> &#123; <span class=\"comment\">//è¶…æ—¶é‡ä¼ å‘åŒ…å‡½æ•°</span></span><br><span class=\"line\">    <span class=\"comment\">//printf(&quot;bg1\\n&quot;);</span></span><br><span class=\"line\">    <span class=\"type\">long</span> timeout = <span class=\"number\">100000L</span>;</span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">timeval</span> <span class=\"title\">start_time</span>, <span class=\"title\">end_time</span>;</span></span><br><span class=\"line\">    gettimeofday(&amp;start_time, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (sock-&gt;state != exp_state)&#123;</span><br><span class=\"line\">        gettimeofday(&amp;end_time, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\">        <span class=\"type\">long</span> Time = <span class=\"number\">1000000L</span> * (end_time.tv_sec - start_time.tv_sec) + (end_time.tv_usec - start_time.tv_usec);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (Time &gt;= timeout) &#123; <span class=\"comment\">//è¶…æ—¶é‡ä¼ </span></span><br><span class=\"line\">            gettimeofday(&amp;start_time, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\">            sendToLayer3(pkt, pktlen);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//printf(&quot;ed1\\n&quot;);</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>3. change_sock_state( )</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">change_sock_state</span><span class=\"params\">(<span class=\"type\">tju_tcp_t</span>* sock, <span class=\"type\">int</span> state)</span> &#123;  <span class=\"comment\">//æ·»åŠ ï¼šsockçŠ¶æ€æ”¹å˜</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> (pthread_mutex_lock(&amp;(sock-&gt;state_lock)) != <span class=\"number\">0</span>) ; <span class=\"comment\">//æ”¹å˜sockçŠ¶æ€å‰å…ˆåŠ é”</span></span><br><span class=\"line\">    sock-&gt;state = state;  </span><br><span class=\"line\">    pthread_mutex_unlock(&amp;(sock-&gt;state_lock)); <span class=\"comment\">//è§£é”</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>4. tju_accept()</strong><br>\n<code>tju_accept( )</code>å‡½æ•°ä¸­æ·»åŠ äº†ä¸€ä¸ªé˜»å¡ï¼Œä½¿å¾—åªæœ‰å½“å…¨è¿æ¥hashè¡¨ä¸­å­˜åœ¨è¿™ä¸€ä¸ªsockï¼ŒæœåŠ¡å™¨ç«¯æ‰ç®—è¿æ¥å®Œæˆï¼Œæ‰èƒ½æŠŠæ–°çš„sockåŠ å…¥åˆ°ESTABLISHEDçš„hashè¡¨ä¸­ã€‚</p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">tju_tcp_t</span> *<span class=\"title function_\">tju_accept</span><span class=\"params\">(<span class=\"type\">tju_tcp_t</span> *listen_sock)</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (listen_sock-&gt;received_len &lt; DEFAULT_HEADER_LEN);</span><br><span class=\"line\">    <span class=\"type\">char</span> *header = <span class=\"built_in\">malloc</span>(DEFAULT_HEADER_LEN);</span><br><span class=\"line\">    <span class=\"built_in\">memcpy</span>(header, listen_sock-&gt;received_buf, DEFAULT_HEADER_LEN);</span><br><span class=\"line\">    <span class=\"built_in\">memset</span>(listen_sock-&gt;received_buf, <span class=\"number\">0</span>, DEFAULT_HEADER_LEN);</span><br><span class=\"line\">    listen_sock-&gt;received_buf = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">    listen_sock-&gt;received_len = listen_sock-&gt;received_len - DEFAULT_HEADER_LEN;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"type\">tju_tcp_t</span>* new_conn = (<span class=\"type\">tju_tcp_t</span>*)<span class=\"built_in\">malloc</span>(<span class=\"keyword\">sizeof</span>(<span class=\"type\">tju_tcp_t</span>));</span><br><span class=\"line\">    pthread_mutex_init(&amp;(new_conn-&gt;state_lock), <span class=\"literal\">NULL</span>);</span><br><span class=\"line\">    <span class=\"built_in\">memcpy</span>(new_conn, listen_sock, <span class=\"keyword\">sizeof</span>(<span class=\"type\">tju_tcp_t</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">    tju_sock_addr local_addr, remote_addr;</span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">     è¿™é‡Œæ¶‰åŠåˆ°TCPè¿æ¥çš„å»ºç«‹</span></span><br><span class=\"line\"><span class=\"comment\">     æ­£å¸¸æ¥è¯´åº”è¯¥æ˜¯æ”¶åˆ°å®¢æˆ·ç«¯å‘æ¥çš„SYNæŠ¥æ–‡</span></span><br><span class=\"line\"><span class=\"comment\">     ä»ä¸­æ‹¿åˆ°å¯¹ç«¯çš„IPå’ŒPORT</span></span><br><span class=\"line\"><span class=\"comment\">     æ¢å¥è¯è¯´ ä¸‹é¢çš„å¤„ç†æµç¨‹å…¶å®ä¸åº”è¯¥æ”¾åœ¨è¿™é‡Œ åº”è¯¥åœ¨tju_handle_packetä¸­</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    remote_addr.ip = inet_network(CLIENT_IP);  <span class=\"comment\">//å…·ä½“çš„IPåœ°å€</span></span><br><span class=\"line\">    remote_addr.port = <span class=\"number\">5678</span>;  <span class=\"comment\">//ç«¯å£</span></span><br><span class=\"line\"></span><br><span class=\"line\">    local_addr.ip = listen_sock-&gt;bind_addr.ip;  <span class=\"comment\">//å…·ä½“çš„IPåœ°å€</span></span><br><span class=\"line\">    local_addr.port = listen_sock-&gt;bind_addr.port;  <span class=\"comment\">//ç«¯å£</span></span><br><span class=\"line\"></span><br><span class=\"line\">    new_conn-&gt;established_local_addr = local_addr;</span><br><span class=\"line\">    new_conn-&gt;established_remote_addr = remote_addr;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">while</span> (listen_sock-&gt;state != ESTABLISHED) ;</span><br><span class=\"line\">    change_sock_state(new_conn, ESTABLISHED);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// å°†æ–°çš„connæ”¾åˆ°å†…æ ¸å»ºç«‹è¿æ¥çš„socketå“ˆå¸Œè¡¨ä¸­</span></span><br><span class=\"line\">    <span class=\"type\">int</span> hashval = cal_hash(local_addr.ip, local_addr.port, remote_addr.ip, remote_addr.port);</span><br><span class=\"line\">    established_socks[hashval] = new_conn;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> new_conn;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>5. tju_handle_packet( )</strong><br>\n<code>tju_handle_packet( )</code>å‡½æ•°ä¸­éœ€è¦è§£å†³å¯¹å„ç§æŠ¥æ–‡çš„è§£æã€‚<code>onTCPPocket( )</code>å‡½æ•°å¦‚æœä»established_hashæˆ–listen_hashä¸­æ‰¾åˆ°äº†å¯¹åº”çš„socketï¼Œå°±ä¼šè°ƒç”¨ <code>tju_handle_packet( )</code>å‡½æ•°å¯¹æ”¶åˆ°çš„æ•°æ®åŒ…è¿›è¡Œå¤„ç†ã€‚</p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">int</span> <span class=\"title function_\">tju_handle_packet</span><span class=\"params\">(<span class=\"type\">tju_tcp_t</span>* sock, <span class=\"type\">char</span>* pkt)</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (sock-&gt;state == LISTEN &amp;&amp; get_flags(pkt) == SYN_FLAG_MASK)&#123; <span class=\"comment\">//ç¬¬äºŒæ¬¡æ¡æ‰‹</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (pthread_mutex_lock(&amp;(sock-&gt;recv_lock)) != <span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (sock-&gt;received_buf == <span class=\"literal\">NULL</span>) sock-&gt;received_buf = <span class=\"built_in\">malloc</span>(DEFAULT_HEADER_LEN);</span><br><span class=\"line\">        <span class=\"keyword\">else</span> sock-&gt;received_buf = <span class=\"built_in\">realloc</span>(sock-&gt;received_buf, sock-&gt;received_len + DEFAULT_HEADER_LEN);</span><br><span class=\"line\">        <span class=\"built_in\">memcpy</span>(sock-&gt;received_buf + sock-&gt;received_len, pkt, DEFAULT_HEADER_LEN);</span><br><span class=\"line\">        sock-&gt;received_len += DEFAULT_HEADER_LEN;</span><br><span class=\"line\">        pthread_mutex_unlock(&amp;(sock-&gt;recv_lock));</span><br><span class=\"line\"></span><br><span class=\"line\">        tju_sock_addr remote;</span><br><span class=\"line\">        remote.ip = inet_network(CLIENT_IP);</span><br><span class=\"line\">        remote.port = get_src(pkt);</span><br><span class=\"line\"></span><br><span class=\"line\">        sock-&gt;established_local_addr = sock-&gt;bind_addr;</span><br><span class=\"line\">        sock-&gt;established_remote_addr = remote;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">int</span> hashval = cal_hash(sock-&gt;established_local_addr.ip, sock-&gt;established_local_addr.port, remote.ip, remote.port);</span><br><span class=\"line\">        half_connection[hashval] = sock;  <span class=\"comment\">//æ”¶åˆ°SYNæŠ¥æ–‡åæ”¾è¿›LISTENçš„åŠè¿æ¥é˜Ÿåˆ—ä¸­</span></span><br><span class=\"line\">        established_socks[hashval] = sock; <span class=\"comment\">//è¿˜ä¼šå°†è¯¥æ–°å»ºçš„socketæ”¾åˆ°ehashä¸­</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">uint32_t</span> seq = <span class=\"number\">0</span>;  </span><br><span class=\"line\">        <span class=\"type\">uint32_t</span> ack = get_seq(pkt) + <span class=\"number\">1</span>; <span class=\"comment\">//ç¡®è®¤å·æ˜¯SYNæŠ¥æ–‡åºåˆ—å·+1</span></span><br><span class=\"line\">        <span class=\"type\">uint8_t</span> flag = SYN_FLAG_MASK | ACK_FLAG_MASK; <span class=\"comment\">//çŠ¶æ€è®°ä¸ºSYN+ACKï¼Œè¿™é‡Œé‡‡ç”¨ä½è¿ç®—|</span></span><br><span class=\"line\">        <span class=\"type\">char</span> *SYNACK = create_packet_buf(sock-&gt;established_local_addr.port, sock-&gt;established_remote_addr.port, seq, ack, DEFAULT_HEADER_LEN, DEFAULT_HEADER_LEN, flag, <span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"literal\">NULL</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        sendToLayer3(SYNACK, DEFAULT_HEADER_LEN);</span><br><span class=\"line\">        change_sock_state(sock, SYN_RECV);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (sock-&gt;state == SYN_SENT &amp;&amp; get_flags(pkt) == (ACK_FLAG_MASK | SYN_FLAG_MASK))&#123; <span class=\"comment\">//ç¬¬ä¸‰æ¬¡æ¡æ‰‹</span></span><br><span class=\"line\">        <span class=\"comment\">//printf(&quot;clientæ”¶åˆ°SYCACK, å‡†å¤‡å‘é€ACK\\n&quot;);</span></span><br><span class=\"line\">        <span class=\"type\">uint32_t</span> seq = get_ack(pkt);</span><br><span class=\"line\">        <span class=\"type\">uint32_t</span> ack = get_seq(pkt) + <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"type\">uint8_t</span> flag = ACK_FLAG_MASK;</span><br><span class=\"line\">        sock-&gt;window.wnd_send-&gt;base = seq;</span><br><span class=\"line\">        sock-&gt;window.wnd_send-&gt;nextseq = seq;</span><br><span class=\"line\">        <span class=\"type\">char</span> *ACK = create_packet_buf(sock-&gt;established_local_addr.port, get_src(pkt), seq,ack, DEFAULT_HEADER_LEN, DEFAULT_HEADER_LEN, flag, <span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"literal\">NULL</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        sendToLayer3(ACK, DEFAULT_HEADER_LEN);</span><br><span class=\"line\">        change_sock_state(sock, ESTABLISHED);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (sock-&gt;state == SYN_SENT &amp;&amp; get_flags(pkt) == SYN_FLAG_MASK)&#123; <span class=\"comment\">//ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼ˆå¥‡æ€ªï¼‰</span></span><br><span class=\"line\">        <span class=\"comment\">// //printf(&quot;clientæ”¶åˆ°SYCACK, å‡†å¤‡å‘é€ACK\\n&quot;);</span></span><br><span class=\"line\">        <span class=\"type\">uint32_t</span> seq = get_ack(pkt);</span><br><span class=\"line\">        <span class=\"type\">uint32_t</span> ack = get_seq(pkt) + <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"type\">uint8_t</span> flag = ACK_FLAG_MASK;</span><br><span class=\"line\">        sock-&gt;window.wnd_send-&gt;base = seq;</span><br><span class=\"line\">        sock-&gt;window.wnd_send-&gt;nextseq = seq;</span><br><span class=\"line\">        <span class=\"type\">char</span> *ACK = create_packet_buf(sock-&gt;established_local_addr.port, get_src(pkt), seq,ack, DEFAULT_HEADER_LEN, DEFAULT_HEADER_LEN, flag, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"literal\">NULL</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        sendToLayer3(ACK, DEFAULT_HEADER_LEN);</span><br><span class=\"line\">        change_sock_state(sock, ESTABLISHED);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(sock-&gt;state == ESTABLISHED &amp;&amp; get_flags(pkt) == (SYN_FLAG_MASK | ACK_FLAG_MASK))&#123;  <span class=\"comment\">//ä¸‰æ¬¡æ¡æ‰‹ç¬¬ä¸‰ä¸ªåŒ…çš„é‡ä¼ </span></span><br><span class=\"line\">        <span class=\"type\">uint32_t</span> seq = get_ack(pkt);</span><br><span class=\"line\">        <span class=\"type\">uint32_t</span> ack = get_seq(pkt) + <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"type\">uint8_t</span> flag = ACK_FLAG_MASK;</span><br><span class=\"line\">        <span class=\"type\">char</span> *ACK = create_packet_buf(sock-&gt;established_local_addr.port, sock-&gt;established_remote_addr.port, seq, ack, DEFAULT_HEADER_LEN, DEFAULT_HEADER_LEN, flag, <span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"literal\">NULL</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        sendToLayer3(ACK, DEFAULT_HEADER_LEN);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (sock-&gt;state == SYN_RECV &amp;&amp; get_flags(pkt) == ACK_FLAG_MASK)&#123;</span><br><span class=\"line\">        <span class=\"comment\">// //printf(&quot;serveræ”¶åˆ°ACK\\n&quot;);</span></span><br><span class=\"line\">        sock-&gt;window.wnd_recv-&gt;expect_seq = get_seq(pkt) + get_plen(pkt) - DEFAULT_HEADER_LEN;</span><br><span class=\"line\">        <span class=\"type\">int</span> hash = cal_hash(sock-&gt;established_local_addr.ip, sock-&gt;established_local_addr.port,sock-&gt;established_remote_addr.ip, sock-&gt;established_remote_addr.port);</span><br><span class=\"line\">        com_connection[hash] = sock;</span><br><span class=\"line\">        half_connection[hash] = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">        change_sock_state(sock, ESTABLISHED);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (get_plen(pkt) &gt; DEFAULT_HEADER_LEN) &#123; <span class=\"comment\">//ACKåŒ…æºå¸¦ä¿¡æ¯</span></span><br><span class=\"line\">            pkt2buffer(sock, pkt);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n<p><strong>6. pkt2buffer( )</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">pkt2buffer</span><span class=\"params\">(<span class=\"type\">tju_tcp_t</span>* sock, <span class=\"type\">char</span>* pkt)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//printf(&quot;bg6\\n&quot;);</span></span><br><span class=\"line\">    <span class=\"type\">uint32_t</span> data_len = get_plen(pkt) - DEFAULT_HEADER_LEN;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">while</span> (pthread_mutex_lock(&amp;(sock-&gt;recv_lock)) != <span class=\"number\">0</span>); <span class=\"comment\">// åŠ é”</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (sock-&gt;received_buf == <span class=\"literal\">NULL</span>)&#123;</span><br><span class=\"line\">        sock-&gt;received_buf = <span class=\"built_in\">malloc</span>(data_len);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">        sock-&gt;received_buf = <span class=\"built_in\">realloc</span>(sock-&gt;received_buf, sock-&gt;received_len + data_len);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">memcpy</span>(sock-&gt;received_buf + sock-&gt;received_len, pkt + DEFAULT_HEADER_LEN, data_len);    </span><br><span class=\"line\">    sock-&gt;received_len += data_len;</span><br><span class=\"line\">    pthread_mutex_unlock(&amp;(sock-&gt;recv_lock)); <span class=\"comment\">// è§£é”</span></span><br><span class=\"line\">    <span class=\"comment\">//printf(&quot;ed6\\n&quot;);</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"å››æ¬¡æŒ¥æ‰‹å…³é—­è¿æ¥\">å››æ¬¡æŒ¥æ‰‹å…³é—­è¿æ¥</h3>\n<p><strong>1. tju_close ( )</strong><br>\nå››æ¬¡æŒ¥æ‰‹æœ‰ä¸¤ç§æƒ…å†µï¼Œåˆ†åˆ«ä¸ºå…ˆåå…³é—­å’ŒåŒæ—¶å…³é—­ï¼Œä¸¤ç§æ–¹å¼é¦–å…ˆéƒ½éœ€è¦è°ƒç”¨<code>tju_close( )</code>å‡½æ•°ï¼Œå› æ­¤ï¼Œåœ¨<code>tju_close( )</code>å‡½æ•°ä¸­ï¼Œéœ€è¦æ„é€ ä¸€ä¸ª FIN+ACK æŠ¥æ–‡ï¼Œseqå’Œackéƒ½æ˜¯å½“å‰æŠ¥æ–‡çª—å£çš„ä¸‹ä¸€ä¸ªæ•°å€¼ï¼Œå¹¶æŠŠè‡ªèº«çŠ¶æ€å˜ä¸º FIN-WAIT1ã€‚</p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">int</span> <span class=\"title function_\">tju_close</span> <span class=\"params\">(<span class=\"type\">tju_tcp_t</span>* sock)</span>&#123;</span><br><span class=\"line\">    <span class=\"type\">uint16_t</span> flag = FIN_FLAG_MASK | ACK_FLAG_MASK;</span><br><span class=\"line\">    <span class=\"type\">uint32_t</span> seq = sock-&gt;window.wnd_send-&gt;nextseq;</span><br><span class=\"line\">    <span class=\"type\">uint32_t</span> ack = sock-&gt;window.wnd_send-&gt;nextseq;</span><br><span class=\"line\">    <span class=\"type\">char</span>* FINACK = create_packet_buf(sock-&gt;established_local_addr.port, sock-&gt;established_remote_addr.port,seq, ack, DEFAULT_HEADER_LEN, DEFAULT_HEADER_LEN, flag, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"literal\">NULL</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    sendToLayer3(FINACK, DEFAULT_HEADER_LEN);</span><br><span class=\"line\">    change_sock_state(sock, FIN_WAIT_1);</span><br><span class=\"line\">    sock-&gt;window.wnd_send-&gt;nextseq++;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">while</span> (sock-&gt;state != CLOSED) ;</span><br><span class=\"line\">    <span class=\"comment\">//printf(&quot;è¿æ¥å®Œå…¨å…³é—­\\n&quot;);</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>2. tju_handle_packet( )</strong><br>\næ¥ä¸‹æ¥åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼Œä½†å¤„ç†è¿‡ç¨‹å‡åœ¨<code>tju_handle_packet( )</code>ä¸­å®Œæˆï¼Œ<code>tju_handle_packet( )</code>ä½œä¸ºå¯¹æ”¶åˆ°çš„åŒ…è¿›è¡Œå“åº”çš„å‡½æ•°ã€‚</p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">int</span> <span class=\"title function_\">tju_handle_packet</span><span class=\"params\">(<span class=\"type\">tju_tcp_t</span>* sock, <span class=\"type\">char</span>* pkt)</span>&#123;</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (sock-&gt;state == ESTABLISHED &amp;&amp; get_flags(pkt) == (FIN_FLAG_MASK | ACK_FLAG_MASK))&#123; <span class=\"comment\">// serveræ”¶åˆ°ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ï¼Œå¹¶è¿›è¡Œç¬¬äºŒæ¬¡æŒ¥æ‰‹å’Œç¬¬ä¸‰æ¬¡æŒ¥æ‰‹</span></span><br><span class=\"line\">        <span class=\"type\">uint32_t</span> seq = get_ack(pkt);</span><br><span class=\"line\">        <span class=\"type\">uint32_t</span> ack = get_seq(pkt) + <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"type\">uint16_t</span> flag = ACK_FLAG_MASK;</span><br><span class=\"line\">        <span class=\"type\">char</span> *ACK = create_packet_buf(sock-&gt;established_local_addr.port, sock-&gt;established_remote_addr.port, seq, ack, DEFAULT_HEADER_LEN, DEFAULT_HEADER_LEN, flag, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"literal\">NULL</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        sendToLayer3(ACK, DEFAULT_HEADER_LEN);</span><br><span class=\"line\">        <span class=\"comment\">//printf(&quot;å‘é€ç¬¬äºŒæ¬¡æŒ¥æ‰‹æŠ¥æ–‡\\n&quot;);</span></span><br><span class=\"line\">        change_sock_state(sock, CLOSE_WAIT);</span><br><span class=\"line\">        </span><br><span class=\"line\">        sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        flag = ACK_FLAG_MASK | FIN_FLAG_MASK;</span><br><span class=\"line\">        seq = sock-&gt;window.wnd_send-&gt;nextseq;</span><br><span class=\"line\">        ack = get_seq(pkt) + <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"type\">char</span> *FINACK = create_packet_buf(sock-&gt;established_local_addr.port, sock-&gt;established_remote_addr.port, seq, ack, DEFAULT_HEADER_LEN, DEFAULT_HEADER_LEN, flag, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"literal\">NULL</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        sendToLayer3(FINACK, DEFAULT_HEADER_LEN);</span><br><span class=\"line\">        <span class=\"comment\">//printf(&quot;å‘é€ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹æŠ¥æ–‡\\n&quot;);</span></span><br><span class=\"line\">        change_sock_state(sock, LAST_ACK);</span><br><span class=\"line\">        Timeout_retransmission(sock, CLOSED, FINACK, DEFAULT_HEADER_LEN);</span><br><span class=\"line\">    &#125; </span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (sock-&gt;state == ESTABLISHED &amp;&amp; get_flags(pkt) == FIN_FLAG_MASK)&#123; <span class=\"comment\">// serveræ”¶åˆ°ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ï¼Œå¹¶è¿›è¡Œç¬¬äºŒæ¬¡æŒ¥æ‰‹å’Œç¬¬ä¸‰æ¬¡æŒ¥æ‰‹</span></span><br><span class=\"line\">        <span class=\"type\">uint32_t</span> seq = get_ack(pkt);</span><br><span class=\"line\">        <span class=\"type\">uint32_t</span> ack = get_seq(pkt) + <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"type\">uint16_t</span> flag = ACK_FLAG_MASK;</span><br><span class=\"line\">        <span class=\"type\">char</span> *ACK = create_packet_buf(sock-&gt;established_local_addr.port, sock-&gt;established_remote_addr.port, seq, ack, DEFAULT_HEADER_LEN, DEFAULT_HEADER_LEN, flag, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"literal\">NULL</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        sendToLayer3(ACK, DEFAULT_HEADER_LEN);</span><br><span class=\"line\">        change_sock_state(sock, CLOSE_WAIT);</span><br><span class=\"line\">        <span class=\"comment\">//printf(&quot;å‘é€ç¬¬äºŒæ¬¡æŒ¥æ‰‹æŠ¥æ–‡\\n&quot;);</span></span><br><span class=\"line\"></span><br><span class=\"line\">        sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        flag = ACK_FLAG_MASK | FIN_FLAG_MASK;</span><br><span class=\"line\">        <span class=\"type\">char</span> *FINACK = create_packet_buf(sock-&gt;established_local_addr.port, sock-&gt;established_remote_addr.port, seq, ack, DEFAULT_HEADER_LEN, DEFAULT_HEADER_LEN, flag, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"literal\">NULL</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        sendToLayer3(FINACK, DEFAULT_HEADER_LEN);</span><br><span class=\"line\">        <span class=\"comment\">//printf(&quot;å‘é€ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹æŠ¥æ–‡\\n&quot;);</span></span><br><span class=\"line\">        change_sock_state(sock, LAST_ACK);</span><br><span class=\"line\">        Timeout_retransmission(sock, CLOSED, FINACK, DEFAULT_HEADER_LEN);</span><br><span class=\"line\">    &#125; </span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (sock-&gt;state == FIN_WAIT_1 &amp;&amp; get_flags(pkt) == ACK_FLAG_MASK)&#123; <span class=\"comment\">// clientæ”¶åˆ°ç¬¬äºŒæ¬¡æŒ¥æ‰‹</span></span><br><span class=\"line\">        change_sock_state(sock, FIN_WAIT_2);</span><br><span class=\"line\">        <span class=\"comment\">//printf(&quot;æ”¶åˆ°ç¬¬äºŒæ¬¡æŒ¥æ‰‹æŠ¥æ–‡\\n&quot;);</span></span><br><span class=\"line\">    &#125; </span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (sock-&gt;state == FIN_WAIT_2 &amp;&amp; (get_flags(pkt) == (ACK_FLAG_MASK | FIN_FLAG_MASK)))&#123; <span class=\"comment\">// clientæ”¶åˆ°ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹è¿›è¡Œç¬¬å››æ¬¡æŒ¥æ‰‹å¹¶å…³é—­è¿æ¥</span></span><br><span class=\"line\">        <span class=\"type\">uint32_t</span> seq = get_ack(pkt);</span><br><span class=\"line\">        <span class=\"type\">uint32_t</span> ack = get_seq(pkt) + <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"type\">uint32_t</span> flag = ACK_FLAG_MASK;</span><br><span class=\"line\">        <span class=\"type\">char</span> *ACK = create_packet_buf(sock-&gt;established_local_addr.port, sock-&gt;established_remote_addr.port, seq, ack, DEFAULT_HEADER_LEN, DEFAULT_HEADER_LEN,flag, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"literal\">NULL</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        sendToLayer3(ACK, DEFAULT_HEADER_LEN);</span><br><span class=\"line\">        <span class=\"comment\">//printf(&quot;æ”¶åˆ°ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹æŠ¥æ–‡, å¹¶å‘å‡ºç¬¬å››æ¬¡æŒ¥æ‰‹\\n&quot;);</span></span><br><span class=\"line\">        change_sock_state(sock, TIME_WAIT);</span><br><span class=\"line\">        <span class=\"type\">int</span> hash = cal_hash(sock-&gt;established_local_addr.ip, sock-&gt;established_local_addr.port,    sock-&gt;established_remote_addr.ip, sock-&gt;established_remote_addr.port);</span><br><span class=\"line\">        <span class=\"comment\">//è¿™é‡Œè¦ç­‰å¾…2MSL</span></span><br><span class=\"line\">        change_sock_state(sock, CLOSED);</span><br><span class=\"line\">        established_socks[hash] = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">        <span class=\"comment\">//printf(&quot;å…³é—­è¿æ¥\\n&quot;);</span></span><br><span class=\"line\">    &#125; </span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (sock-&gt;state == LAST_ACK &amp;&amp; (get_flags(pkt) == ACK_FLAG_MASK))&#123; <span class=\"comment\">// serveræ”¶åˆ°ç¬¬å››æ¬¡æŒ¥æ‰‹å¹¶å…³é—­è¿æ¥</span></span><br><span class=\"line\">        <span class=\"type\">int</span> hash = cal_hash(sock-&gt;established_local_addr.ip, sock-&gt;established_local_addr.port, sock-&gt;established_remote_addr.ip, sock-&gt;established_remote_addr.port);</span><br><span class=\"line\">        established_socks[hash] = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">        half_connection[hash] = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">        com_connection[hash] = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">        change_sock_state(sock, CLOSED);</span><br><span class=\"line\">        <span class=\"comment\">//printf(&quot;å…³é—­è¿æ¥\\n&quot;);</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (sock-&gt;state == FIN_WAIT_1 &amp;&amp; (get_flags(pkt) == (FIN_FLAG_MASK | ACK_FLAG_MASK)))&#123; <span class=\"comment\">// åŒæ—¶å…³é—­æ”¶åˆ°ç¬¬ä¸€æ¬¡æŒ¥æ‰‹</span></span><br><span class=\"line\">        change_sock_state(sock, CLOSING);</span><br><span class=\"line\">        <span class=\"type\">uint32_t</span> seq = get_ack(pkt) + <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"type\">uint32_t</span> ack = get_seq(pkt) + <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"type\">uint16_t</span> flag = ACK_FLAG_MASK;</span><br><span class=\"line\">        <span class=\"type\">char</span>* ACK = create_packet_buf(sock-&gt;established_local_addr.port,sock-&gt;established_remote_addr.port,seq,ack,DEFAULT_HEADER_LEN,DEFAULT_HEADER_LEN,flag,<span class=\"number\">0</span>,<span class=\"number\">0</span>,<span class=\"literal\">NULL</span>,<span class=\"number\">0</span>);</span><br><span class=\"line\">        sendToLayer3(ACK,DEFAULT_HEADER_LEN);</span><br><span class=\"line\">        Timeout_retransmission(sock, CLOSED, ACK, DEFAULT_HEADER_LEN);</span><br><span class=\"line\">        <span class=\"comment\">// //printf(&quot;åŒæ—¶å…³é—­å‘å‡ºACK\\n&quot;);</span></span><br><span class=\"line\">    &#125; </span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(sock-&gt;state == FIN_WAIT_1 &amp;&amp; get_flags(pkt) == FIN_FLAG_MASK)&#123; <span class=\"comment\">// åŒæ—¶å…³é—­æ”¶åˆ°ç¬¬ä¸€æ¬¡æŒ¥æ‰‹</span></span><br><span class=\"line\">        change_sock_state(sock, CLOSING);</span><br><span class=\"line\">        <span class=\"type\">uint32_t</span> seq = get_ack(pkt) + <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"type\">uint32_t</span> ack = get_seq(pkt) + <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"type\">uint16_t</span> flag = ACK_FLAG_MASK;</span><br><span class=\"line\">        <span class=\"type\">char</span>* ACK = create_packet_buf(sock-&gt;established_local_addr.port,sock-&gt;established_remote_addr.port,seq,ack,DEFAULT_HEADER_LEN,DEFAULT_HEADER_LEN,flag,<span class=\"number\">0</span>,<span class=\"number\">0</span>,<span class=\"literal\">NULL</span>,<span class=\"number\">0</span>);</span><br><span class=\"line\">        sendToLayer3(ACK, DEFAULT_HEADER_LEN);</span><br><span class=\"line\">        Timeout_retransmission(sock, CLOSED, ACK, DEFAULT_HEADER_LEN);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (sock-&gt;state == CLOSING &amp;&amp; get_flags(pkt) == ACK_FLAG_MASK)&#123; <span class=\"comment\">// åŒæ—¶å…³é—­æ—¶æ”¶åˆ°ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹</span></span><br><span class=\"line\">        change_sock_state(sock, TIME_WAIT);</span><br><span class=\"line\">        <span class=\"comment\">//ç­‰å¾…2MSL</span></span><br><span class=\"line\">        <span class=\"type\">int</span> hash = cal_hash(sock-&gt;established_local_addr.ip, sock-&gt;established_local_addr.port, sock-&gt;established_remote_addr.ip, sock-&gt;established_remote_addr.port);</span><br><span class=\"line\">        established_socks[hash] = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">        half_connection[hash] = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">        com_connection[hash] = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">        change_sock_state(sock, CLOSED);</span><br><span class=\"line\">        <span class=\"comment\">//printf(&quot;åŒæ—¶å…³é—­å½»åº•å…³é—­\\n&quot;);</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"å¯é æ•°æ®ä¼ è¾“\">å¯é æ•°æ®ä¼ è¾“</h2>\n<h3 id=\"å‘é€ç¼“å†²åŒºç®¡ç†\">å‘é€ç¼“å†²åŒºç®¡ç†</h3>\n<p><strong>1. <code>global.h</code> ä¸­å®å®šä¹‰ TCP å‘é€çª—å£å¤§å°ã€‚</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> TCP_SENDWN_SIZE 1000 </span></span><br></pre></td></tr></table></figure>\n<p><strong>2. <code>tju_packet.h</code> ä¸­ä¸ºå‘é€ç¼“å†²åŒºåˆ›å»º1000ä¸ªæŠ¥æ–‡é•¿åº¦çš„å¾ªç¯é˜Ÿåˆ—ï¼Œæ–¹ä¾¿æ•°æ®åŒ…è¶…æ—¶é‡ä¼ ã€‚</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// TCP æŠ¥æ–‡çš„ç»“æ„å®šä¹‰</span></span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"class\"><span class=\"keyword\">struct</span> &#123;</span></span><br><span class=\"line\">\t<span class=\"type\">tju_header_t</span> header;</span><br><span class=\"line\">\t<span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">timeval</span> <span class=\"title\">sent_time</span>;</span></span><br><span class=\"line\">\t<span class=\"type\">char</span>* data;</span><br><span class=\"line\">&#125; <span class=\"type\">tju_packet_t</span>;</span><br><span class=\"line\"><span class=\"type\">tju_packet_t</span>* pktlist[TCP_SENDWN_SIZE];</span><br></pre></td></tr></table></figure>\n<p><strong>3. tju_send( )</strong><br>\nä¸Šå±‚è°ƒç”¨ <code>tju_send( )</code> æ—¶ï¼Œæˆ‘ä»¬åœ¨ <code>tju_send( )</code>å‡½æ•°å†…åˆ›å»ºå‘é€çº¿ç¨‹å¹¶æŠŠå‘é€æ•°æ®å­˜å…¥ç¼“å†²åŒºä¸­ã€‚<br>\nâ€ƒè¿™é‡Œæˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹åˆ›å»ºçº¿ç¨‹ <code>pthread_create( )</code>å‡½æ•°ã€‚</p>\n<blockquote>\n<p>int pthread_create(pthread_t* restrict tidp,const pthread_attr_t* restrict_attr,void* (<em>start_rtn)(void</em>),void *restrict arg);</p>\n<ul>\n<li>tidpï¼šäº‹å…ˆåˆ›å»ºå¥½çš„pthread_tç±»å‹çš„å‚æ•°ã€‚æˆåŠŸæ—¶tidpæŒ‡å‘çš„å†…å­˜å•å…ƒè¢«è®¾ç½®ä¸ºæ–°åˆ›å»ºçº¿ç¨‹çš„çº¿ç¨‹IDã€‚</li>\n<li>attrï¼šç”¨äºå®šåˆ¶å„ç§ä¸åŒçš„çº¿ç¨‹å±æ€§ã€‚APUEçš„12.3èŠ‚è®¨è®ºäº†çº¿ç¨‹å±æ€§ã€‚é€šå¸¸ç›´æ¥è®¾ä¸ºNULLã€‚</li>\n<li>start_rtnï¼šæ–°åˆ›å»ºçº¿ç¨‹ä»æ­¤å‡½æ•°å¼€å§‹è¿è¡Œã€‚æ— å‚æ•°æ˜¯argè®¾ä¸ºNULLå³å¯ã€‚</li>\n<li>argï¼šstart_rtnå‡½æ•°çš„å‚æ•°ã€‚æ— å‚æ•°æ—¶è®¾ä¸ºNULLå³å¯ã€‚æœ‰å‚æ•°æ—¶è¾“å…¥å‚æ•°çš„åœ°å€ã€‚å½“å¤šäºä¸€ä¸ªå‚æ•°æ—¶åº”å½“ä½¿ç”¨ç»“æ„ä½“ä¼ å…¥ã€‚</li>\n<li>è¿”å›å€¼ä¸º 0ï¼ˆè¡¨ç¤ºçº¿ç¨‹æˆåŠŸåˆ›å»ºï¼‰ã€‚</li>\n</ul>\n</blockquote>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">int</span> send_thread_flag = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">int</span> <span class=\"title function_\">tju_send</span><span class=\"params\">(<span class=\"type\">tju_tcp_t</span>* sock, <span class=\"type\">const</span> <span class=\"type\">void</span> *buffer, <span class=\"type\">int</span> len)</span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// è¿™é‡Œå½“ç„¶ä¸èƒ½ç›´æ¥ç®€å•åœ°è°ƒç”¨sendToLayer</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!send_thread_flag)&#123;</span><br><span class=\"line\">        send_thread_flag = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"type\">pthread_t</span> sendthreadid;</span><br><span class=\"line\">        <span class=\"type\">int</span> ret = pthread_create(&amp;sendthreadid, <span class=\"literal\">NULL</span>, send_pkt, (<span class=\"type\">void</span> *)sock);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">while</span> (pthread_mutex_lock(&amp;(sock-&gt;send_lock)) != <span class=\"number\">0</span>) ;</span><br><span class=\"line\">    <span class=\"built_in\">memcpy</span>(sock-&gt;sending_buf + sock-&gt;index, (<span class=\"type\">char</span>*)buffer, len);</span><br><span class=\"line\">    sock-&gt;sending_len += len;</span><br><span class=\"line\">    sock-&gt;index += len;</span><br><span class=\"line\">    pthread_mutex_unlock(&amp;(sock-&gt;send_lock));</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>4. send_pkt( )</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">void</span> *<span class=\"title function_\">send_pkt</span><span class=\"params\">(<span class=\"type\">tju_tcp_t</span>* sock)</span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//printf(&quot;bg4\\n&quot;);</span></span><br><span class=\"line\">    <span class=\"comment\">//struct timeval start_time, now_time;</span></span><br><span class=\"line\">    <span class=\"comment\">//gettimeofday(&amp;start_time, NULL);</span></span><br><span class=\"line\">    <span class=\"comment\">//long deltatime = 0; //æ—¶é—´å·®</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> (<span class=\"number\">1</span>)&#123; <span class=\"comment\">//ä¸æ–­æ£€æŸ¥å’Œå‘é€æ•°æ®åŒ…</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (sock-&gt;window.wnd_send-&gt;nextseq &lt; sock-&gt;index)&#123; <span class=\"comment\">//æ£€æŸ¥å‘é€çª—å£ï¼šæ£€æŸ¥å½“å‰å‘é€åºåˆ—å·æ˜¯å¦å°äºç´¢å¼•ï¼Œç¡®ä¿æœ‰æ•°æ®éœ€è¦å‘é€ã€‚</span></span><br><span class=\"line\">            <span class=\"comment\">//gettimeofday(&amp;now_time, NULL);</span></span><br><span class=\"line\">            <span class=\"comment\">//deltatime = now_time.tv_sec - start_time.tv_sec;</span></span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">while</span> (pthread_mutex_lock(&amp;(sock-&gt;send_lock)) != <span class=\"number\">0</span>);</span><br><span class=\"line\">            <span class=\"type\">int</span> unlen = sock-&gt;sending_len - (sock-&gt;window.wnd_send-&gt;nextseq - sock-&gt;window.wnd_send-&gt;base); <span class=\"comment\">//è®¡ç®—å½“å‰æœªå‘é€çš„æ•°æ®é•¿åº¦ã€‚ </span></span><br><span class=\"line\">            <span class=\"type\">int</span> len = min(unlen, MAX_DLEN); <span class=\"comment\">//ç¡®å®šæœ¬æ¬¡å‘é€çš„é•¿åº¦ï¼Œå–æœªå‘é€é•¿åº¦å’Œæœ€å¤§æ•°æ®é•¿åº¦ä¸­çš„æœ€å°å€¼ã€‚ </span></span><br><span class=\"line\">            pthread_mutex_unlock(&amp;(sock-&gt;send_lock));</span><br><span class=\"line\">            <span class=\"type\">int</span> leftlen = sock-&gt;window.wnd_send-&gt;rwnd - (sock-&gt;window.wnd_send-&gt;nextseq - sock-&gt;window.wnd_send-&gt;base);</span><br><span class=\"line\">            len =len&gt;leftlen?leftlen:len;            </span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (sock-&gt;window.wnd_send-&gt;nextseq - sock-&gt;window.wnd_send-&gt;base + len &lt;= sock-&gt;window.wnd_send-&gt;rwnd) &#123; <span class=\"comment\">//æ£€æŸ¥çª—å£å¤§å°ï¼šæ£€æŸ¥å½“å‰å·²å‘é€çš„é•¿åº¦åŠ ä¸Šæœ¬æ¬¡å‘é€é•¿åº¦æ˜¯å¦åœ¨æ¥æ”¶çª—å£èŒƒå›´å†…ã€‚ </span></span><br><span class=\"line\">                <span class=\"type\">uint32_t</span> seq = sock-&gt;window.wnd_send-&gt;nextseq;</span><br><span class=\"line\">                <span class=\"type\">uint32_t</span> ack = seq + len; <span class=\"comment\">//ä¸ç†è§£ </span></span><br><span class=\"line\">                <span class=\"type\">uint8_t</span> flag = ACK_FLAG_MASK;</span><br><span class=\"line\">                <span class=\"type\">uint16_t</span> pkt_len = len + DEFAULT_HEADER_LEN;</span><br><span class=\"line\">                <span class=\"type\">char</span> *data = (<span class=\"type\">char</span> *)<span class=\"built_in\">malloc</span>(MAX_DLEN);</span><br><span class=\"line\">                <span class=\"built_in\">memcpy</span>(data, sock-&gt;sending_buf + sock-&gt;window.wnd_send-&gt;nextseq, len);</span><br><span class=\"line\">                <span class=\"type\">tju_packet_t</span> *datapacket = create_packet(sock-&gt;established_local_addr.port, sock-&gt;established_remote_addr.port,seq, ack, DEFAULT_HEADER_LEN, pkt_len, flag, <span class=\"number\">0</span>, <span class=\"number\">0</span>, data, len);</span><br><span class=\"line\">                <span class=\"type\">char</span> *ACK = create_packet_buf(sock-&gt;established_local_addr.port, sock-&gt;established_remote_addr.port,seq, ack, DEFAULT_HEADER_LEN, pkt_len, flag, <span class=\"number\">0</span>, <span class=\"number\">0</span>, data, len);</span><br><span class=\"line\"></span><br><span class=\"line\">                sendToLayer3(ACK, pkt_len);</span><br><span class=\"line\">                </span><br><span class=\"line\">                sock-&gt;window.wnd_send-&gt;nextseq += len;</span><br><span class=\"line\">                pktlist[sock-&gt;packetr] = datapacket;</span><br><span class=\"line\">                gettimeofday(&amp;pktlist[sock-&gt;packetr]-&gt;sent_time, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\">                sock-&gt;packetr = (sock-&gt;packetr + <span class=\"number\">1</span>) % TCP_SENDWN_SIZE;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (len == (<span class=\"type\">int</span>)(sock-&gt;window.wnd_send-&gt;nextseq - sock-&gt;window.wnd_send-&gt;base))&#123;</span><br><span class=\"line\">                    gettimeofday(&amp;(sock-&gt;window.wnd_send-&gt;send_time), <span class=\"literal\">NULL</span>);</span><br><span class=\"line\">                    </span><br><span class=\"line\">                    <span class=\"keyword\">while</span>(pthread_mutex_lock(&amp;(sock-&gt;window.wnd_send-&gt;ack_cnt_lock)) != <span class=\"number\">0</span>);</span><br><span class=\"line\">                    sock-&gt;window.wnd_send-&gt;ack_cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\">                    pthread_mutex_unlock(&amp;(sock-&gt;window.wnd_send-&gt;ack_cnt_lock));</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;ed4\\n&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"å¤±åºæŠ¥æ–‡æ•°ç»„çš„ç®¡ç†\">å¤±åºæŠ¥æ–‡æ•°ç»„çš„ç®¡ç†</h3>\n<p><strong>1. tju_handle_packet( )</strong><br>\n<code>tju_handle_packet( )</code>ä¸­æ·»åŠ å»ºç«‹è¿æ¥åæ”¶åˆ°æ•°æ®åŒ…çš„å¤„ç†ã€‚</p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">int</span> <span class=\"title function_\">tju_handle_packet</span><span class=\"params\">(<span class=\"type\">tju_tcp_t</span>* sock, <span class=\"type\">char</span>* pkt)</span>&#123;</span><br><span class=\"line\">    `````` å»ºç«‹è¿æ¥ ``````</span><br><span class=\"line\">    ````````````````````</span><br><span class=\"line\">    ````````````````````</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(sock-&gt;state == ESTABLISHED &amp;&amp; get_flags(pkt) == ACK_FLAG_MASK)&#123; <span class=\"comment\">//æ”¶åˆ°æ•°æ®åŒ…</span></span><br><span class=\"line\">        <span class=\"type\">char</span> hostname[<span class=\"number\">8</span>];</span><br><span class=\"line\">        gethostname(hostname, <span class=\"number\">8</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"built_in\">strcmp</span>(hostname, <span class=\"string\">&quot;server&quot;</span>) == <span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">            serverrdt(sock, pkt);</span><br><span class=\"line\">        &#125; </span><br><span class=\"line\">        <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">            clientrdt(sock, pkt);</span><br><span class=\"line\">        &#125; </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    `````` å…³é—­è¿æ¥ ``````</span><br><span class=\"line\">    ````````````````````</span><br><span class=\"line\">    ````````````````````</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>2. <code>tju_tcp_t</code> ç»“æ„ä½“ä¸­åˆ›å»ºç©ºé—´ç”¨æ¥å­˜å‚¨å¤±åºæŠ¥æ–‡å¹¶è®°å½•å¤±åºæŠ¥æ–‡çš„ä¸ªæ•°ã€‚</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// TJU_TCP ç»“æ„ä½“ ä¿å­˜TJU_TCPç”¨åˆ°çš„å„ç§æ•°æ®</span></span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"class\"><span class=\"keyword\">struct</span> &#123;</span></span><br><span class=\"line\">\t<span class=\"type\">char</span> unorder[<span class=\"number\">100</span>][MAX_LEN]; <span class=\"comment\">//å¤±åºæŠ¥æ–‡æ•°ç»„</span></span><br><span class=\"line\">\t<span class=\"type\">int</span> unolen; <span class=\"comment\">//å¤±åºæŠ¥æ–‡ä¸ªæ•°</span></span><br><span class=\"line\">&#125; <span class=\"type\">tju_tcp_t</span>;</span><br></pre></td></tr></table></figure>\n<p><strong>3. serverrdt( )</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">serverrdt</span><span class=\"params\">(<span class=\"type\">tju_tcp_t</span>* sock, <span class=\"type\">char</span>* pkt)</span>&#123; <span class=\"comment\">// æœåŠ¡å™¨ç«¯å¤„ç†æ•°æ®åŒ…</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (get_seq(pkt) &lt; (sock-&gt;window.wnd_recv-&gt;expect_seq))&#123; <span class=\"comment\">//å‡½æ•°å‘é€ä¸€ä¸ª ACK å“åº”å·²ç¡®è®¤æ¥æ”¶</span></span><br><span class=\"line\">        <span class=\"type\">uint32_t</span> seq = sock-&gt;window.wnd_send-&gt;nextseq;</span><br><span class=\"line\">        <span class=\"type\">uint32_t</span> ack = sock-&gt;window.wnd_recv-&gt;expect_seq;</span><br><span class=\"line\">        <span class=\"type\">uint8_t</span> flag = ACK_FLAG_MASK;</span><br><span class=\"line\">        <span class=\"type\">char</span> *ACK = create_packet_buf(sock-&gt;established_local_addr.port, sock-&gt;established_remote_addr.port, seq, ack, DEFAULT_HEADER_LEN, DEFAULT_HEADER_LEN, flag, TCP_RECVWN_SIZE-(sock-&gt;unolen)*MAX_DLEN, <span class=\"number\">0</span>, <span class=\"literal\">NULL</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        sendToLayer3(ACK, DEFAULT_HEADER_LEN);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(get_seq(pkt) &gt; (sock-&gt;window.wnd_recv-&gt;expect_seq))&#123; <span class=\"comment\">//æ•°æ®åŒ…ä¹±åºï¼Œå‡½æ•°å°†åŒ…æš‚å­˜ï¼Œå¹¶å‘é€ ACKï¼ŒåŒæ—¶æ›´æ–°æ¥æ”¶çª—å£</span></span><br><span class=\"line\">        <span class=\"type\">uint32_t</span> seq = sock-&gt;window.wnd_send-&gt;nextseq;</span><br><span class=\"line\">        <span class=\"type\">uint32_t</span> ack = sock-&gt;window.wnd_recv-&gt;expect_seq;</span><br><span class=\"line\">        <span class=\"type\">uint8_t</span> flag = ACK_FLAG_MASK;</span><br><span class=\"line\">        <span class=\"type\">char</span> *ACK = create_packet_buf(sock-&gt;established_local_addr.port, sock-&gt;established_remote_addr.port, seq, ack, DEFAULT_HEADER_LEN, DEFAULT_HEADER_LEN, flag, TCP_RECVWN_SIZE-(sock-&gt;unolen)*MAX_DLEN, <span class=\"number\">0</span>, <span class=\"literal\">NULL</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">        sendToLayer3(ACK, DEFAULT_HEADER_LEN);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span>((sock-&gt;unolen) &gt; MAX_PKT_IN_WINDOW)  <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        <span class=\"built_in\">memcpy</span>(sock-&gt;unorder[sock-&gt;unolen], pkt, get_plen(pkt));</span><br><span class=\"line\">        sock-&gt;unolen++;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span>&#123; <span class=\"comment\">//åˆšåˆšå¥½</span></span><br><span class=\"line\">        sock-&gt;window.wnd_send-&gt;nextseq=get_ack(pkt);</span><br><span class=\"line\">        sock-&gt;window.wnd_recv-&gt;expect_seq+=get_plen(pkt)-DEFAULT_HEADER_LEN;</span><br><span class=\"line\">        pkt2buffer(sock,pkt);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(sock-&gt;unolen == <span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">            <span class=\"type\">uint32_t</span> seq = sock-&gt;window.wnd_send-&gt;nextseq;</span><br><span class=\"line\">            <span class=\"type\">uint32_t</span> ack = sock-&gt;window.wnd_recv-&gt;expect_seq;</span><br><span class=\"line\">            <span class=\"type\">uint8_t</span> flag = ACK_FLAG_MASK;</span><br><span class=\"line\">            <span class=\"type\">char</span> *ACK = create_packet_buf(sock-&gt;established_local_addr.port, sock-&gt;established_remote_addr.port, seq, ack, DEFAULT_HEADER_LEN, DEFAULT_HEADER_LEN, flag,TCP_RECVWN_SIZE-(sock-&gt;unolen)*MAX_DLEN, <span class=\"number\">0</span>, <span class=\"literal\">NULL</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">            sendToLayer3(ACK, DEFAULT_HEADER_LEN);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> len = sock-&gt;unolen;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i = <span class=\"number\">0</span>; i &lt; len; i++)&#123;</span><br><span class=\"line\">                <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j = i + <span class=\"number\">1</span>; j &lt; len; j++)&#123;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span>(get_seq(sock-&gt;unorder[i])&gt;get_seq(sock-&gt;unorder[j]))&#123;</span><br><span class=\"line\">                        my_swap(&amp;sock-&gt;unorder[i], &amp;sock-&gt;unorder[j]);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"type\">int</span> index = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(; index &lt; len; index++)&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(get_seq(sock-&gt;unorder[index]) == sock-&gt;window.wnd_recv-&gt;expect_seq)&#123;</span><br><span class=\"line\">                    sock-&gt;window.wnd_send-&gt;nextseq = get_ack(sock-&gt;unorder[index]);</span><br><span class=\"line\">                    sock-&gt;window.wnd_recv-&gt;expect_seq += get_plen(sock-&gt;unorder[index]) - DEFAULT_HEADER_LEN;</span><br><span class=\"line\">                    pkt2buffer(sock, sock-&gt;unorder[index]);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(get_seq(sock-&gt;unorder[index]) &lt; (sock-&gt;window.wnd_recv-&gt;expect_seq)) <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">                <span class=\"keyword\">else</span> <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = index; i &lt; len; i++)&#123;</span><br><span class=\"line\">                <span class=\"built_in\">memcpy</span>(sock-&gt;unorder[i - index], sock-&gt;unorder[i], <span class=\"keyword\">sizeof</span>(sock-&gt;unorder[i]));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            sock-&gt;unolen -= index;</span><br><span class=\"line\">           </span><br><span class=\"line\">            <span class=\"type\">uint32_t</span> seq = sock-&gt;window.wnd_send-&gt;nextseq;</span><br><span class=\"line\">            <span class=\"type\">uint32_t</span> ack = sock-&gt;window.wnd_recv-&gt;expect_seq;</span><br><span class=\"line\">            <span class=\"type\">uint8_t</span> flag = ACK_FLAG_MASK;</span><br><span class=\"line\">            <span class=\"type\">char</span> *ACK = create_packet_buf(sock-&gt;established_local_addr.port, sock-&gt;established_remote_addr.port, seq, ack, DEFAULT_HEADER_LEN, DEFAULT_HEADER_LEN, flag, TCP_RECVWN_SIZE-(sock-&gt;unolen)*MAX_DLEN, <span class=\"number\">0</span>, <span class=\"literal\">NULL</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">            sendToLayer3(ACK, DEFAULT_HEADER_LEN);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>4. my_swap( )</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">my_swap</span><span class=\"params\">(<span class=\"type\">char</span>** a, <span class=\"type\">char</span>** b)</span>&#123;</span><br><span class=\"line\">    <span class=\"type\">char</span>* tem = (<span class=\"type\">char</span>*)<span class=\"built_in\">malloc</span>(MAX_LEN);</span><br><span class=\"line\">    <span class=\"built_in\">memcpy</span>(tem, a, get_plen(b));</span><br><span class=\"line\">    <span class=\"built_in\">memcpy</span>(a, b, get_plen(b));</span><br><span class=\"line\">    <span class=\"built_in\">memcpy</span>(b, tem, get_plen(tem));</span><br><span class=\"line\">    <span class=\"built_in\">free</span>(tem);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"å®ç°ç´¯è®¡åº”ç­”\">å®ç°ç´¯è®¡åº”ç­”</h3>\n<center>\n<img src=\"https://s2.loli.net/2024/10/11/vKkuC1ibGfmo2sM.png\" width=\"60%\" />\n<p>Figure 1. ç´¯è®¡åº”ç­”</p>\n</center>\n<p><strong>1. clientrdt( )</strong><br>\n<code>clientrdt( )</code>å‡½æ•°ä¸­æ·»åŠ ç´¯è®¡åº”ç­”å¤„ç†ã€‚å½“å‘é€æ–¹æ”¶åˆ°ä»»æ„å¤§äºå½“å‰baseçš„ackæŠ¥æ–‡åï¼Œç›´æ¥æŠŠå½“å‰baseè¿›è¡Œæ›´æ–°å³å¯ã€‚</p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">clientrdt</span><span class=\"params\">(<span class=\"type\">tju_tcp_t</span>* sock, <span class=\"type\">char</span>* pkt)</span>&#123; <span class=\"comment\">// å®¢æˆ·ç«¯å¤„ç†æ•°æ®åŒ…</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (sock-&gt;window.wnd_send-&gt;base == sock-&gt;window.wnd_send-&gt;nextseq) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (get_ack(pkt) &lt; sock-&gt;window.wnd_send-&gt;base) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(get_ack(pkt) &gt; sock-&gt;window.wnd_send-&gt;base)&#123;</span><br><span class=\"line\">        ``````</span><br><span class=\"line\">        ``````</span><br><span class=\"line\">        ``````</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(pthread_mutex_lock(&amp;(sock-&gt;send_lock)) != <span class=\"number\">0</span>); <span class=\"comment\">//åŠ é”</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span>(sock-&gt;window.wnd_send-&gt;base &lt; get_ack(pkt) &amp;&amp; sock-&gt;window.wnd_send-&gt;base &lt; sock-&gt;window.wnd_send-&gt;nextseq )&#123;   </span><br><span class=\"line\">            <span class=\"type\">int</span> pkt_len = pktlist[sock-&gt;packetl]-&gt;header.plen;</span><br><span class=\"line\">            <span class=\"type\">int</span> datalen = pkt_len - DEFAULT_HEADER_LEN;</span><br><span class=\"line\">            sock-&gt;sending_len -= datalen;</span><br><span class=\"line\">            sock-&gt;window.wnd_send-&gt;base += datalen;</span><br><span class=\"line\">            sock-&gt;packetl = (sock-&gt;packetl + <span class=\"number\">1</span>) % TCP_SENDWN_SIZE;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        pthread_mutex_unlock(&amp;(sock-&gt;send_lock)); <span class=\"comment\">//è§£é”</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"è¶…æ—¶é‡ä¼ \">è¶…æ—¶é‡ä¼ </h3>\n<p><strong>1. tju_send( )</strong><br>\n<code>tju_send( )</code> ä¸­åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„çº¿ç¨‹åˆ¤æ–­æ˜¯å¦è¦è¿›è¡Œé‡ä¼ ã€‚</p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">int</span> resend_thread_flag = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">int</span> <span class=\"title function_\">tju_send</span><span class=\"params\">(<span class=\"type\">tju_tcp_t</span>* sock, <span class=\"type\">const</span> <span class=\"type\">void</span> *buffer, <span class=\"type\">int</span> len)</span>&#123;</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!resend_thread_flag)&#123;</span><br><span class=\"line\">        resend_thread_flag = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"type\">pthread_t</span> resendthreadid;</span><br><span class=\"line\">        <span class=\"type\">int</span> ret = pthread_create(&amp;resendthreadid, <span class=\"literal\">NULL</span>,resend_pkt, (<span class=\"type\">void</span> *)sock);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>2. resend_pkt( )</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">void</span> *<span class=\"title function_\">resend_pkt</span><span class=\"params\">(<span class=\"type\">tju_tcp_t</span>* sock)</span>&#123;</span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">timeval</span> <span class=\"title\">start_time</span>,<span class=\"title\">now_time</span>;</span></span><br><span class=\"line\">    gettimeofday(&amp;start_time, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\">    <span class=\"type\">long</span> deltatime = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (sock-&gt;window.wnd_send-&gt;base &lt; sock-&gt;window.wnd_send-&gt;nextseq)&#123;</span><br><span class=\"line\">            gettimeofday(&amp;now_time, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\">            deltatime = now_time.tv_sec - start_time.tv_sec;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (deltatime &gt; <span class=\"number\">100</span>) <span class=\"keyword\">break</span>; <span class=\"comment\">//ä¸ç†è§£</span></span><br><span class=\"line\">            <span class=\"type\">long</span> nowtimeval = <span class=\"number\">1000000</span> * (now_time.tv_sec - sock-&gt;window.wnd_send-&gt;send_time.tv_sec) +  (now_time.tv_usec - sock-&gt;window.wnd_send-&gt;send_time.tv_usec);</span><br><span class=\"line\">            <span class=\"type\">long</span> timeoutval = <span class=\"number\">1000000</span> * (sock-&gt;window.wnd_send-&gt;timeout.tv_sec) + (sock-&gt;window.wnd_send-&gt;timeout.tv_usec);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (nowtimeval &gt; timeoutval)&#123; <span class=\"comment\">//è¶…æ—¶é‡ä¼ </span></span><br><span class=\"line\">                <span class=\"keyword\">while</span>(pktlist[sock-&gt;packetl] == <span class=\"literal\">NULL</span>);</span><br><span class=\"line\">                <span class=\"type\">uint32_t</span> seq = pktlist[sock-&gt;packetl]-&gt;header.seq_num;</span><br><span class=\"line\">                <span class=\"type\">uint32_t</span> ack = pktlist[sock-&gt;packetl]-&gt;header.ack_num;</span><br><span class=\"line\">                <span class=\"type\">uint8_t</span> flag = ACK_FLAG_MASK;</span><br><span class=\"line\">                <span class=\"type\">int</span> pkt_len = pktlist[sock-&gt;packetl]-&gt;header.plen;</span><br><span class=\"line\">                <span class=\"type\">char</span> *ACK = create_packet_buf(sock-&gt;established_local_addr.port, sock-&gt;established_remote_addr.port, seq, ack,DEFAULT_HEADER_LEN, pkt_len, flag, <span class=\"number\">0</span>, <span class=\"number\">0</span>, pktlist[sock-&gt;packetl]-&gt;data, pkt_len - DEFAULT_HEADER_LEN);</span><br><span class=\"line\">                sendToLayer3(ACK, pkt_len);</span><br><span class=\"line\">                gettimeofday(&amp;pktlist[sock-&gt;packetl]-&gt;sent_time, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\">                gettimeofday(&amp;sock-&gt;window.wnd_send-&gt;send_time, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>3. clientrdt( )</strong><br>\n<code>clientrdt( )</code> å‡½æ•°ä¸­æ·»åŠ åŠ¨æ€è®¾ç½®è¶…æ—¶é—´éš”çš„å®ç°ã€‚</p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">clientrdt</span><span class=\"params\">(<span class=\"type\">tju_tcp_t</span>* sock, <span class=\"type\">char</span>* pkt)</span>&#123; <span class=\"comment\">// å®¢æˆ·ç«¯å¤„ç†æ•°æ®åŒ…</span></span><br><span class=\"line\">    ``````</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(get_ack(pkt) &gt; sock-&gt;window.wnd_send-&gt;base)&#123;</span><br><span class=\"line\">        <span class=\"comment\">//æ›´æ–°RTO</span></span><br><span class=\"line\">        <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">timeval</span> <span class=\"title\">nowtime</span>;</span></span><br><span class=\"line\">        gettimeofday(&amp;nowtime, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\">        <span class=\"type\">long</span> ntime = <span class=\"number\">1000000</span> * nowtime.tv_sec + nowtime.tv_usec;</span><br><span class=\"line\">        <span class=\"type\">long</span> samplertt = <span class=\"number\">1000000</span> * (nowtime.tv_sec-pktlist[sock-&gt;packetl]-&gt;sent_time.tv_sec)+nowtime.tv_usec-pktlist[sock-&gt;packetl]-&gt;sent_time.tv_usec;</span><br><span class=\"line\">        <span class=\"type\">long</span> estmatedrtt = sock-&gt;window.wnd_send-&gt;estmated_rtt;</span><br><span class=\"line\">        <span class=\"type\">long</span> devrtt = sock-&gt;window.wnd_send-&gt;dev_rtt;</span><br><span class=\"line\">        estmatedrtt = <span class=\"number\">1.0</span> * estmatedrtt * <span class=\"number\">7</span> / <span class=\"number\">8</span> + samplertt / <span class=\"number\">8</span>;</span><br><span class=\"line\">        devrtt = <span class=\"number\">1.0</span> * devrtt * <span class=\"number\">3</span> / <span class=\"number\">4</span> + (samplertt &gt; <span class=\"number\">1.0</span> * estmatedrtt ? (samplertt - estmatedrtt) : (estmatedrtt - samplertt)) / <span class=\"number\">4</span>;</span><br><span class=\"line\">        sock-&gt;window.wnd_send-&gt;timeout.tv_usec = (estmatedrtt + <span class=\"number\">4</span> * devrtt) % <span class=\"number\">1000000</span>;</span><br><span class=\"line\">        sock-&gt;window.wnd_send-&gt;timeout.tv_sec = (estmatedrtt + <span class=\"number\">4</span> * devrtt) / <span class=\"number\">1000000</span>;</span><br><span class=\"line\">        sock-&gt;window.wnd_send-&gt;estmated_rtt = estmatedrtt;</span><br><span class=\"line\">        sock-&gt;window.wnd_send-&gt;dev_rtt = devrtt;</span><br><span class=\"line\">        <span class=\"type\">double</span> dsamplertt=(<span class=\"type\">double</span>)samplertt/(<span class=\"type\">double</span>)<span class=\"number\">1000000</span>;</span><br><span class=\"line\">        <span class=\"type\">double</span> destmatedrtt=(<span class=\"type\">double</span>)estmatedrtt/(<span class=\"type\">double</span>)<span class=\"number\">1000000</span>;</span><br><span class=\"line\">        <span class=\"type\">double</span> ddevrtt=(<span class=\"type\">double</span>)devrtt/(<span class=\"type\">double</span>)<span class=\"number\">1000000</span>;</span><br><span class=\"line\">        <span class=\"type\">double</span> dtimegap=(<span class=\"type\">double</span>)(estmatedrtt + <span class=\"number\">4</span> * devrtt)/(<span class=\"type\">double</span>)<span class=\"number\">1000000</span>;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">while</span>(pthread_mutex_lock(&amp;(sock-&gt;window.wnd_send-&gt;ack_cnt_lock)) != <span class=\"number\">0</span>);</span><br><span class=\"line\">        sock-&gt;window.wnd_send-&gt;ack_cnt = <span class=\"number\">1</span>;</span><br><span class=\"line\">        pthread_mutex_unlock(&amp;(sock-&gt;window.wnd_send-&gt;ack_cnt_lock));</span><br><span class=\"line\">        ``````</span><br><span class=\"line\">        ``````</span><br><span class=\"line\">        ``````</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"å¿«é€Ÿé‡ä¼ \">å¿«é€Ÿé‡ä¼ </h3>\n<center>\n<img src=\"https://s2.loli.net/2024/10/11/cj2PfZsz8abBVW9.png\" width=\"60%\" />\n<p>Figure 1. å¿«é€Ÿé‡ä¼ </p>\n</center>\n<p><strong>1. clientrdt( )</strong><br>\n<code>clientrdt( )</code> å‡½æ•°ä¸­æ·»åŠ å¿«é€Ÿé‡ä¼ çš„å®ç°ã€‚</p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">clientrdt</span><span class=\"params\">(<span class=\"type\">tju_tcp_t</span>* sock, <span class=\"type\">char</span>* pkt)</span>&#123; <span class=\"comment\">// å®¢æˆ·ç«¯å¤„ç†æ•°æ®åŒ…</span></span><br><span class=\"line\">    ``````</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(get_ack(pkt) == sock-&gt;window.wnd_send-&gt;base)&#123; <span class=\"comment\">//å†—ä½™ACK</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span>(pthread_mutex_lock(&amp;(sock-&gt;window.wnd_send-&gt;ack_cnt_lock)) != <span class=\"number\">0</span>);</span><br><span class=\"line\">        sock-&gt;window.wnd_send-&gt;ack_cnt++;</span><br><span class=\"line\">        pthread_mutex_unlock(&amp;(sock-&gt;window.wnd_send-&gt;ack_cnt_lock));</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span>(sock-&gt;window.wnd_send-&gt;ack_cnt == <span class=\"number\">3</span>)&#123; <span class=\"comment\">//å¿«é€Ÿé‡ä¼  </span></span><br><span class=\"line\">            ``````</span><br><span class=\"line\">            <span class=\"type\">uint32_t</span> seq = pktlist[sock-&gt;packetl]-&gt;header.seq_num;</span><br><span class=\"line\">            <span class=\"type\">uint32_t</span> ack = pktlist[sock-&gt;packetl]-&gt;header.ack_num;</span><br><span class=\"line\">            <span class=\"type\">uint8_t</span> flag = ACK_FLAG_MASK;</span><br><span class=\"line\">            <span class=\"type\">int</span> pkt_len = pktlist[sock-&gt;packetl]-&gt;header.plen;</span><br><span class=\"line\">            <span class=\"type\">char</span> *ACK = create_packet_buf(sock-&gt;established_local_addr.port, sock-&gt;established_remote_addr.port, seq, ack, DEFAULT_HEADER_LEN, pkt_len, ACK_FLAG_MASK, <span class=\"number\">0</span>, <span class=\"number\">0</span>, pktlist[sock-&gt;packetl]-&gt;data, pkt_len - DEFAULT_HEADER_LEN);</span><br><span class=\"line\">            sendToLayer3(ACK, pkt_len);</span><br><span class=\"line\">            sock-&gt;window.wnd_send-&gt;ack_cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\">            gettimeofday(&amp;pktlist[sock-&gt;packetl]-&gt;sent_time, <span class=\"literal\">NULL</span>);            </span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"æµé‡æ§åˆ¶\">æµé‡æ§åˆ¶</h2>\n<h3 id=\"æ¥æ”¶æ–¹è®¡ç®—æ¥å—ç¼“å†²åŒºå¤§å°\">æ¥æ”¶æ–¹è®¡ç®—æ¥å—ç¼“å†²åŒºå¤§å°</h3>\n<p><strong>1. serverrdt( )</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">serverrdt</span><span class=\"params\">(<span class=\"type\">tju_tcp_t</span>* sock, <span class=\"type\">char</span>* pkt)</span>&#123;<span class=\"comment\">// æœåŠ¡ç«¯å¤„ç†æ•°æ®åŒ…</span></span><br><span class=\"line\">    ``````</span><br><span class=\"line\">    <span class=\"type\">uint32_t</span> seq = sock-&gt;window.wnd_send-&gt;nextseq;</span><br><span class=\"line\">    <span class=\"type\">uint32_t</span> ack = sock-&gt;window.wnd_recv-&gt;expect_seq;</span><br><span class=\"line\">    <span class=\"type\">uint8_t</span> flag = ACK_FLAG_MASK;</span><br><span class=\"line\">    <span class=\"type\">char</span> *ACK = create_packet_buf(sock-&gt;established_local_addr.port, sock-&gt;established_remote_addr.port, seq, ack, DEFAULT_HEADER_LEN, DEFAULT_HEADER_LEN, flag, TCP_RECVWN_SIZE-(sock-&gt;unolen)*MAX_DLEN, <span class=\"number\">0</span>, <span class=\"literal\">NULL</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"å‘é€æ–¹è°ƒæ•´å‘é€ç¼“å†²åŒºå¤§å°\">å‘é€æ–¹è°ƒæ•´å‘é€ç¼“å†²åŒºå¤§å°</h3>\n<p><strong>1. clientrdt( )</strong><br>\n<code>clientrdt( )</code>å‡½æ•°ç¡®å®šwindow_sizeå¤§å°ã€‚</p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">clientrdt</span><span class=\"params\">(<span class=\"type\">tju_tcp_t</span> *sock, <span class=\"type\">char</span> *pkt)</span>&#123;</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">    ``````get_advertised_window(pkt)``````</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>2. get_advertised_window( )</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">uint16_t</span> <span class=\"title function_\">get_advertised_window</span><span class=\"params\">(<span class=\"type\">char</span>* msg)</span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> offset = <span class=\"number\">17</span>;</span><br><span class=\"line\">    <span class=\"type\">uint16_t</span> var;</span><br><span class=\"line\">    <span class=\"built_in\">memcpy</span>(&amp;var, msg+offset, SIZE16);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ntohs(var);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"0çª—å£æ¢æµ‹\">0çª—å£æ¢æµ‹</h3>\n<p><strong>1. send_pkt( )</strong><br>\n<code>send_pkt( )</code>å‘é€æ•°æ®çš„çº¿ç¨‹ä¸­åŠ å…¥ä¸€ä¸ªåˆ¤æ–­æ¡ä»¶ã€‚<br>\n0çª—å£æ¢æµ‹ç”¨äºåœ¨ADVERTISED WINDOWä¸º0çš„æƒ…å†µä¸‹ï¼Œå‘é€å¤§å°ä¸º1çš„æ•°æ®æŠ¥æ–‡ä»¥è·å¾—å®æ—¶çš„çª—å£è¿”å›å€¼ã€‚</p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">void</span> *<span class=\"title function_\">send_pkt</span><span class=\"params\">(<span class=\"type\">tju_tcp_t</span>* sock)</span>&#123;</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">    <span class=\"keyword\">if</span>((sock-&gt;window.wnd_send-&gt;nextseq &gt; sock-&gt;window.wnd_send-&gt;base)&amp;&amp;sock-&gt;window.wnd_send-&gt;rwnd == <span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">        len = <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (len &gt; <span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">        ``````</span><br><span class=\"line\">        ``````</span><br><span class=\"line\">        ``````        </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"æ‹¥å¡æ§åˆ¶\">æ‹¥å¡æ§åˆ¶</h2>\n<h3 id=\"æ…¢å¯åŠ¨\">æ…¢å¯åŠ¨</h3>\n<p><strong>1. å¥—æ¥å­—çš„åˆå§‹åŒ–ä½¿å¾—å‘é€æ–¹ä»å…¶ä»–çŠ¶æ€è¿›å…¥æ…¢å¯åŠ¨çŠ¶æ€ã€‚</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">tju_tcp_t</span>* <span class=\"title function_\">tju_socket</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">    sock-&gt;window.wnd_send-&gt;congestion_status = SLOW_START;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>2. <code>resend_pkt( )</code>å‡½æ•°è¶…æ—¶äº‹ä»¶ä½¿å¾—å‘é€æ–¹ä»å…¶ä»–çŠ¶æ€è¿›å…¥æ…¢å¯åŠ¨çŠ¶æ€ã€‚</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> (nowtimeval &gt; timeoutval)&#123;</span><br><span class=\"line\">    sock-&gt;window.wnd_send-&gt;congestion_status = SLOW_START;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>åœ¨æ…¢å¯åŠ¨çŠ¶æ€ä¸‹ï¼Œå‘é€æ–¹æ¯å½“æ¥æ”¶åˆ°æ­£ç¡®çš„ ACK æŠ¥æ–‡ï¼Œå°±ä¼šå°†å…¶æ‹¥å¡çª—å£å¢å¤§ 1 ä¸ª MSSï¼ˆMAX_DLENï¼‰ã€‚è™½ç„¶æ˜¯ä¸æ–­çš„è‡ªå¢ MSSï¼Œä½†æ˜¯ç”±äºæ‹¥å¡çª—å£çš„å¢å¤§ï¼ˆè¿›è€Œå¯¼è‡´å‘é€çª—å£çš„å¢å¤§ï¼‰ï¼Œæ¯æ¬¡è‡ªå¢çš„æ¬¡æ•°ä¸º 1-&gt;2-&gt;4-&gt;8 ç›´è‡³è¾¾åˆ°ssthreshï¼Œæ‰€ä»¥æ‹¥å¡çª—å£æ•´ä½“ä¸Šå‘ˆç°æŒ‡æ•°å¢é•¿çš„è¶‹åŠ¿ã€‚<br>\n<strong>3. clientrdt( )</strong><br>\n<code>clientrdt( )</code> å‡½æ•°ä¸­å‘é€æ–¹æ¯å½“æ¥æ”¶åˆ°æ­£ç¡®çš„ ACK æŠ¥æ–‡ï¼Œå°±ä¼šå°†å…¶æ‹¥å¡çª—å£å¢å¤§ 1 ä¸ª MSSã€‚</p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">clientrdt</span><span class=\"params\">(<span class=\"type\">tju_tcp_t</span> *sock, <span class=\"type\">char</span> *pkt)</span>&#123;   </span><br><span class=\"line\">    ``````</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(sock-&gt;window.wnd_send-&gt;congestion_status == SLOW_START)&#123; <span class=\"comment\">//æ…¢å¯åŠ¨</span></span><br><span class=\"line\">        ``````    </span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(get_ack(pkt) &gt; sock-&gt;window.wnd_send-&gt;base)&#123; <span class=\"comment\">// new ack</span></span><br><span class=\"line\">            sock-&gt;window.wnd_send-&gt;cwnd += MSS;</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"keyword\">while</span>(pthread_mutex_lock(&amp;(sock-&gt;window.wnd_send-&gt;ack_cnt_lock)) != <span class=\"number\">0</span>);</span><br><span class=\"line\">            sock-&gt;window.wnd_send-&gt;ack_cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\">            pthread_mutex_unlock(&amp;(sock-&gt;window.wnd_send-&gt;ack_cnt_lock));</span><br><span class=\"line\">            ``````</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        ``````</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>4. resend_pkt( )</strong><br>\n<code>resend_pkt( )</code> å‡½æ•°ä¸­å¤„ç†è¶…æ—¶é‡ä¼ å¯¼è‡´æ…¢å¯åŠ¨å‚æ•°å˜åŒ–ã€‚</p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">void</span> *<span class=\"title function_\">resend_pkt</span><span class=\"params\">(<span class=\"type\">tju_tcp_t</span>* sock)</span>&#123;</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (nowtimeval &gt; timeoutval)&#123;</span><br><span class=\"line\">        sock-&gt;window.wnd_send-&gt;ssthresh = sock-&gt;window.wnd_send-&gt;cwnd / <span class=\"number\">2</span>; <span class=\"comment\">//æ‹¥å¡é˜ˆå€¼å˜æˆæ‹¥å¡çª—å£å¤§å°çš„ä¸€åŠ</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>(sock-&gt;window.wnd_send-&gt;ssthresh &lt; MAX_DLEN) sock-&gt;window.wnd_send-&gt;ssthresh = MSS; <span class=\"comment\">//è°ƒæ•´</span></span><br><span class=\"line\">        sock-&gt;window.wnd_send-&gt;cwnd = MSS; <span class=\"comment\">//æ‹¥å¡çª—å£å˜æˆ1MSS</span></span><br><span class=\"line\">        sock-&gt;window.wnd_send-&gt;congestion_status = SLOW_START; <span class=\"comment\">//æ‹¥å¡çŠ¶æ€ä¸å˜</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"æ‹¥å¡é¿å…\">æ‹¥å¡é¿å…</h3>\n<p><strong>1. æ‹¥å¡çª—å£è¶…è¿‡ ssthresh è¿›å…¥æ‹¥å¡é¿å…çŠ¶æ€ã€‚</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">clientrdt</span><span class=\"params\">(<span class=\"type\">tju_tcp_t</span> *sock, <span class=\"type\">char</span> *pkt)</span>&#123; </span><br><span class=\"line\">    ``````</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(sock-&gt;window.wnd_send-&gt;congestion_status == SLOW_START)&#123; <span class=\"comment\">//æ…¢å¯åŠ¨</span></span><br><span class=\"line\">        ``````</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(sock-&gt;window.wnd_send-&gt;cwnd &gt;= sock-&gt;window.wnd_send-&gt;ssthresh)&#123; <span class=\"comment\">//cwndè¾¾åˆ°ssthreshï¼Œè½¬ä¸ºæ‹¥å¡é¿å…çŠ¶æ€</span></span><br><span class=\"line\">            sock-&gt;window.wnd_send-&gt;congestion_status = CONGESTION_AVOIDANCE;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        ``````</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>2. å¿«é€Ÿæ¢å¤é˜¶æ®µæ”¶åˆ°æ­£ç¡®çš„ ACK ä½¿å¾—å‘é€æ–¹ä»å…¶ä»–çŠ¶æ€è¿›å…¥æ‹¥å¡é¿å…çŠ¶æ€ã€‚</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">clientrdt</span><span class=\"params\">(<span class=\"type\">tju_tcp_t</span> *sock, <span class=\"type\">char</span> *pkt)</span>&#123; </span><br><span class=\"line\">    ``````</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (sock-&gt;window.wnd_send-&gt;congestion_status == FAST_RECOVERY)&#123; <span class=\"comment\">//å¿«é€Ÿæ¢å¤</span></span><br><span class=\"line\">        ``````</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(get_ack(pkt) &gt; sock-&gt;window.wnd_send-&gt;base)&#123; <span class=\"comment\">//new ack</span></span><br><span class=\"line\">            sock-&gt;window.wnd_send-&gt;cwnd = sock-&gt;window.wnd_send-&gt;ssthresh;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">while</span>(pthread_mutex_lock(&amp;(sock-&gt;window.wnd_send-&gt;ack_cnt_lock)) != <span class=\"number\">0</span>);</span><br><span class=\"line\">            sock-&gt;window.wnd_send-&gt;ack_cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\">            pthread_mutex_unlock(&amp;(sock-&gt;window.wnd_send-&gt;ack_cnt_lock));</span><br><span class=\"line\">          </span><br><span class=\"line\">            sock-&gt;window.wnd_send-&gt;window_size = min(get_advertised_window(pkt), sock-&gt;window.wnd_send-&gt;cwnd);</span><br><span class=\"line\"></span><br><span class=\"line\">            sock-&gt;window.wnd_send-&gt;congestion_status = CONGESTION_AVOIDANCE;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>3. åœ¨æ‹¥å¡é¿å…çŠ¶æ€ä¸‹ï¼Œå‘é€æ–¹æ¯å½“æ”¶åˆ°ä¸€ä¸ªæ­£ç¡®çš„ ACK æŠ¥æ–‡ï¼Œæ‹¥å¡çª—å£å°±ä¼šå¢å¤§ï¼ˆ1/cwndï¼‰ä¸ª MSSã€‚æ‹¥å¡çª—å£æ•´ä½“ä¸Šå‘ˆç°çº¿æ€§å¢é•¿çš„è¶‹åŠ¿ã€‚</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">clientrdt</span><span class=\"params\">(<span class=\"type\">tju_tcp_t</span> *sock, <span class=\"type\">char</span> *pkt)</span>&#123;   </span><br><span class=\"line\">    ``````</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (sock-&gt;window.wnd_send-&gt;congestion_status == CONGESTION_AVOIDANCE) &#123; <span class=\"comment\">//æ‹¥å¡é¿å…</span></span><br><span class=\"line\">        ``````</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(get_ack(pkt) &gt; sock-&gt;window.wnd_send-&gt;base)&#123; <span class=\"comment\">//new ack</span></span><br><span class=\"line\">            sock-&gt;window.wnd_send-&gt;cwnd += MSS * ((<span class=\"type\">double</span>)MSS / (<span class=\"type\">double</span>)sock-&gt;window.wnd_send-&gt;cwnd);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">while</span>(pthread_mutex_lock(&amp;(sock-&gt;window.wnd_send-&gt;ack_cnt_lock)) != <span class=\"number\">0</span>);</span><br><span class=\"line\">            sock-&gt;window.wnd_send-&gt;ack_cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\">            pthread_mutex_unlock(&amp;(sock-&gt;window.wnd_send-&gt;ack_cnt_lock));</span><br><span class=\"line\">            </span><br><span class=\"line\">            sock-&gt;window.wnd_send-&gt;window_size = min(get_advertised_window(pkt), sock-&gt;window.wnd_send-&gt;cwnd);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"å¿«é€Ÿæ¢å¤\">å¿«é€Ÿæ¢å¤</h3>\n<p><strong>1. <code>clientrdt( )</code> å‘é€æ–¹æ”¶åˆ° 3 ä¸ªå†—ä½™ ACK æ—¶ï¼Œè¿›å…¥å¿«é€Ÿæ¢å¤çŠ¶æ€ã€‚</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span>(sock-&gt;window.wnd_send-&gt;ack_cnt == <span class=\"number\">3</span>)&#123;  <span class=\"comment\">//å¿«é€Ÿé‡ä¼ </span></span><br><span class=\"line\">    sock-&gt;window.wnd_send-&gt;ssthresh = sock-&gt;window.wnd_send-&gt;cwnd / <span class=\"number\">2</span>;</span><br><span class=\"line\">    sock-&gt;window.wnd_send-&gt;cwnd = sock-&gt;window.wnd_send-&gt;ssthresh + <span class=\"number\">3</span> * MSS;</span><br><span class=\"line\">    sock-&gt;window.wnd_send-&gt;congestion_status = FAST_RECOVERY; <span class=\"comment\">//å¿«é€Ÿæ¢å¤</span></span><br><span class=\"line\">    ``````</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>2. åœ¨å¿«é€Ÿæ¢å¤çŠ¶æ€ä¸‹ï¼Œå¦‚æœè¿˜æ˜¯æ”¶åˆ°å†—ä½™ ACKï¼Œé‚£ä¹ˆä¾ç„¶åœ¨æ­¤çŠ¶æ€ï¼Œcwnd+=MSSï¼›å½“æ”¶åˆ°æ­£ç¡® ACK æ—¶ï¼Œåˆ™è¿›å…¥æ‹¥å¡é¿å…çŠ¶æ€ ï¼Œcwnd=ssthreshï¼›å½“è¶…æ—¶æ—¶ï¼Œå›åˆ°æ…¢å¯åŠ¨ï¼Œcwnd=1MSSã€‚</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">void</span> <span class=\"title function_\">clientrdt</span><span class=\"params\">(<span class=\"type\">tju_tcp_t</span> *sock, <span class=\"type\">char</span> *pkt)</span>&#123; </span><br><span class=\"line\">    ``````</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">    ``````    </span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (sock-&gt;window.wnd_send-&gt;congestion_status == FAST_RECOVERY)&#123; <span class=\"comment\">//å¿«é€Ÿæ¢å¤</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>(get_ack(pkt) == sock-&gt;window.wnd_send-&gt;base)&#123;<span class=\"comment\">//dup ack</span></span><br><span class=\"line\">            <span class=\"keyword\">while</span>(pthread_mutex_lock(&amp;(sock-&gt;window.wnd_send-&gt;ack_cnt_lock)) != <span class=\"number\">0</span>);</span><br><span class=\"line\">            sock-&gt;window.wnd_send-&gt;ack_cnt++;</span><br><span class=\"line\">            pthread_mutex_unlock(&amp;(sock-&gt;window.wnd_send-&gt;ack_cnt_lock));</span><br><span class=\"line\"></span><br><span class=\"line\">            sock-&gt;window.wnd_send-&gt;cwnd += MSS;</span><br><span class=\"line\">                        </span><br><span class=\"line\">            sock-&gt;window.wnd_send-&gt;window_size = min(get_advertised_window(pkt), sock-&gt;window.wnd_send-&gt;cwnd);</span><br><span class=\"line\"></span><br><span class=\"line\">            sock-&gt;window.wnd_send-&gt;congestion_status = FAST_RECOVERY;</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(get_ack(pkt) &gt; sock-&gt;window.wnd_send-&gt;base)&#123; <span class=\"comment\">//new ack</span></span><br><span class=\"line\">            sock-&gt;window.wnd_send-&gt;cwnd = sock-&gt;window.wnd_send-&gt;ssthresh;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">while</span>(pthread_mutex_lock(&amp;(sock-&gt;window.wnd_send-&gt;ack_cnt_lock)) != <span class=\"number\">0</span>);</span><br><span class=\"line\">            sock-&gt;window.wnd_send-&gt;ack_cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\">            pthread_mutex_unlock(&amp;(sock-&gt;window.wnd_send-&gt;ack_cnt_lock));  </span><br><span class=\"line\">         </span><br><span class=\"line\">            sock-&gt;window.wnd_send-&gt;window_size = min(get_advertised_window(pkt), sock-&gt;window.wnd_send-&gt;cwnd);</span><br><span class=\"line\"></span><br><span class=\"line\">            sock-&gt;window.wnd_send-&gt;congestion_status = CONGESTION_AVOIDANCE;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">    ``````</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","tags":["å®è·µ","è®¡ç®—æœºç½‘ç»œ"]},{"title":"é¢å‘æ™ºæ…§é©¾é©¶åº§èˆ±çš„æƒ…æ„Ÿäº¤äº’å¹³å°è®¾è®¡","url":"/post/1fd344c2.html","content":"<h2 id=\"å®‰å“ç«¯å¼€å‘\">å®‰å“ç«¯å¼€å‘</h2>\n<p><a href=\"https://developer.android.google.cn/studio?hl=zh-cn\">IDEä¸‹è½½</a><br>\n<strong>é…ç½®æ³¨æ„äº‹é¡¹</strong><br>\nâ‘  jdkæ”¹ä¸º11ç‰ˆæœ¬ã€‚<br>\nâ‘¡ åœ¨é¡¶å±‚build.gradleæ–‡ä»¶æ·»åŠ urlåŠ é€Ÿä¸‹è½½ ã€‚<br>\nâ‘¢ åˆ‡æ¢æ‘„åƒå¤´ä½¿å¾—è™šæ‹Ÿæœºèƒ½ç”¨ä¸Šç”µè„‘çš„æ‘„åƒå¤´ã€‚</p>\n","tags":["å¤§åˆ›"]},{"title":"è½¯ä»¶å·¥ç¨‹ç»¼åˆå®è·µ","url":"/post/7f61ed21.html","content":"<h2 id=\"æ•…äº‹åœºæ™¯\">æ•…äº‹åœºæ™¯</h2>\n<blockquote>\n<p>ä½ ä»¬æ˜¯å‡ ååˆ°æŸè½¯ä»¶å¼€å‘å…¬å¸ï¼ˆä»¥ä¸‹ç®€ç§°Tè½¯ï¼‰å®ä¹ çš„å­¦ç”Ÿã€‚ä¸Šç­ç¬¬ä¸€å¤©ï¼Œè€æ¿å‘Šè¯‰ä½ ä»¬ï¼Œå…¬å¸ç°åœ¨æœ‰ä¸ªç´§æ€¥é¡¹ç›®ï¼Œè¦æ±‚ä¸‰å‘¨åä¸Šçº¿ï¼Œä½†æ˜¯â€¦â€¦ä¸Šå‘¨æœ«ï¼Œè¿™ä¸ªé¡¹ç›®å”¯ä¸€çš„ç¨‹åºå‘˜ï¼Œå°ä¸œï¼Œå› ä¸æ»¡å…¬å¸çš„è–ªæ°´å¾…é‡è¿‡ä½è€Œç¦»èŒäº†ï¼Œç°åœ¨ç•™ä¸‹äº†ä¸€ä¸ªåŠæˆå“çš„çƒ‚æ‘Šå­ï¼Œé‡æ‹…è½åœ¨äº†ä½ ä»¬å‡ ä¸ªæ¯«æ— å¼€å‘ç»éªŒçš„å®ä¹ ç”Ÿèº«ä¸Šâ€¦â€¦</p>\n</blockquote>\n<h2 id=\"JDBC-é¡¹ç›®\">JDBC é¡¹ç›®</h2>\n<p><strong>ä¸»è¦ç›®æ ‡ï¼šè§£å†³â€œä½¿ç”¨ JDBC å°è£…æ•°æ®å±‚ï¼Œå¹¶å®ç°å¢åˆ æ”¹æŸ¥â€çš„é—®é¢˜ã€‚</strong></p>\n<h2 id=\"å‰ç«¯é¡¹ç›®\">å‰ç«¯é¡¹ç›®</h2>\n<p><strong>ä¸»è¦ç›®æ ‡ï¼šè§£å†³â€œä½¿ç”¨ HTML5+CSS3+JavaScript å¼€å‘ä¼ä¸šçº§å‰ç«¯é™æ€é¡µé¢â€çš„é—®é¢˜ã€‚</strong></p>\n<h2 id=\"JavaWeb-é¡¹ç›®\">JavaWeb é¡¹ç›®</h2>\n<p><strong>ä¸»è¦ç›®æ ‡ï¼šè§£å†³â€œä½¿ç”¨ Vueï¼ˆå‰ç«¯ï¼‰+Servletï¼ˆæœåŠ¡ç«¯ï¼‰å¼€å‘åŸºäºå‰åç«¯åˆ†ç¦»æ¶æ„åº”ç”¨ç¨‹åºâ€çš„é—®é¢˜ã€‚</strong></p>\n<h2 id=\"SpringBoot-é¡¹ç›®\">SpringBoot é¡¹ç›®</h2>\n<p><strong>ä¸»è¦ç›®æ ‡ï¼šè§£å†³â€œä½¿ç”¨ Vueï¼ˆå‰ç«¯ï¼‰+SpringBootï¼ˆæœåŠ¡ç«¯ï¼‰å¼€å‘åŸºäºå‰åç«¯åˆ†ç¦»æ¶æ„åº”ç”¨ç¨‹åºâ€çš„é—®é¢˜ã€‚</strong></p>\n<h2 id=\"SpringCloud-é¡¹ç›®\">SpringCloud é¡¹ç›®</h2>\n<p><strong>ä¸»è¦ç›®æ ‡ï¼šè§£å†³â€œä½¿ç”¨ Vueï¼ˆå‰ç«¯ï¼‰+SpringCloudï¼ˆæœåŠ¡ç«¯ï¼‰å¼€å‘åŸºäºå¾®æœåŠ¡çš„äº’è”ç½‘åº”ç”¨ç¨‹åºâ€çš„é—®é¢˜ã€‚</strong></p>\n","tags":["è½¯ä»¶å·¥ç¨‹","å®è·µ","å¼€å‘"]}]